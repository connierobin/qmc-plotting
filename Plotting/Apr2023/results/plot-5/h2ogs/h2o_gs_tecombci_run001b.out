Rank =    0  Free Memory = 79165 MB
Rank =    1  Free Memory = 79161 MB
Rank =    2  Free Memory = 79161 MB
Rank =    3  Free Memory = 79161 MB
Rank =    4  Free Memory = 79161 MB
Rank =    5  Free Memory = 79160 MB
Rank =    6  Free Memory = 79159 MB
Rank =    7  Free Memory = 79159 MB
Rank =    8  Free Memory = 79159 MB
Rank =    9  Free Memory = 79159 MB
Rank =   10  Free Memory = 79159 MB
Rank =   11  Free Memory = 79159 MB
Rank =   12  Free Memory = 79159 MB
Rank =   13  Free Memory = 79158 MB
Rank =   14  Free Memory = 79158 MB
Rank =   15  Free Memory = 79144 MB
Rank =   16  Free Memory = 79142 MB
Rank =   17  Free Memory = 79141 MB
Rank =   18  Free Memory = 79141 MB
Rank =   19  Free Memory = 79141 MB
Rank =   20  Free Memory = 79141 MB
Rank =   21  Free Memory = 79141 MB
Rank =   22  Free Memory = 79141 MB
Rank =   23  Free Memory = 79141 MB
Rank =   24  Free Memory = 79141 MB
Rank =   25  Free Memory = 79141 MB
Rank =   26  Free Memory = 79141 MB
Rank =   27  Free Memory = 79141 MB
Rank =   28  Free Memory = 79141 MB
Rank =   29  Free Memory = 79141 MB
Rank =   30  Free Memory = 79141 MB
Rank =   31  Free Memory = 79141 MB
Rank =   32  Free Memory = 79141 MB
Rank =   33  Free Memory = 79141 MB
Rank =   34  Free Memory = 79141 MB
Rank =   35  Free Memory = 79141 MB
Rank =   36  Free Memory = 79141 MB
Rank =   37  Free Memory = 79141 MB
Rank =   38  Free Memory = 79141 MB
Rank =   39  Free Memory = 79141 MB
Rank =   40  Free Memory = 69601 MB
Rank =   41  Free Memory = 69601 MB
Rank =   42  Free Memory = 69601 MB
Rank =   43  Free Memory = 69601 MB
Rank =   44  Free Memory = 69601 MB
Rank =   45  Free Memory = 69601 MB
Rank =   46  Free Memory = 69601 MB
Rank =   47  Free Memory = 69601 MB
Rank =   48  Free Memory = 69601 MB
Rank =   49  Free Memory = 69601 MB
Rank =   50  Free Memory = 69601 MB
Rank =   51  Free Memory = 69601 MB
Rank =   52  Free Memory = 69601 MB
Rank =   53  Free Memory = 69601 MB
Rank =   54  Free Memory = 69601 MB
Rank =   55  Free Memory = 69601 MB
Rank =   56  Free Memory = 69601 MB
Rank =   57  Free Memory = 69601 MB
Rank =   58  Free Memory = 69601 MB
Rank =   59  Free Memory = 69601 MB
Rank =   60  Free Memory = 69601 MB
Rank =   61  Free Memory = 69601 MB
Rank =   62  Free Memory = 69601 MB
Rank =   63  Free Memory = 69601 MB
Rank =   64  Free Memory = 69601 MB
Rank =   65  Free Memory = 69601 MB
Rank =   66  Free Memory = 69601 MB
Rank =   67  Free Memory = 69601 MB
Rank =   68  Free Memory = 69601 MB
Rank =   69  Free Memory = 69601 MB
Rank =   70  Free Memory = 69601 MB
Rank =   71  Free Memory = 69601 MB
Rank =   72  Free Memory = 69601 MB
Rank =   73  Free Memory = 69601 MB
Rank =   74  Free Memory = 69601 MB
Rank =   75  Free Memory = 69601 MB
Rank =   76  Free Memory = 69601 MB
Rank =   77  Free Memory = 69601 MB
Rank =   78  Free Memory = 69600 MB
Rank =   79  Free Memory = 69600 MB
Rank =   80  Free Memory = 76276 MB
Rank =   81  Free Memory = 76275 MB
Rank =   82  Free Memory = 76275 MB
Rank =   83  Free Memory = 76275 MB
Rank =   84  Free Memory = 76275 MB
Rank =   85  Free Memory = 76275 MB
Rank =   86  Free Memory = 76275 MB
Rank =   87  Free Memory = 76275 MB
Rank =   88  Free Memory = 76275 MB
Rank =   89  Free Memory = 76275 MB
Rank =   90  Free Memory = 76275 MB
Rank =   91  Free Memory = 76275 MB
Rank =   92  Free Memory = 76275 MB
Rank =   93  Free Memory = 76275 MB
Rank =   94  Free Memory = 76275 MB
Rank =   95  Free Memory = 76275 MB
Rank =   96  Free Memory = 76275 MB
Rank =   97  Free Memory = 76275 MB
Rank =   98  Free Memory = 76275 MB
Rank =   99  Free Memory = 76275 MB
Rank =  100  Free Memory = 76275 MB
Rank =  101  Free Memory = 76275 MB
Rank =  102  Free Memory = 76275 MB
Rank =  103  Free Memory = 76275 MB
Rank =  104  Free Memory = 76275 MB
Rank =  105  Free Memory = 76275 MB
Rank =  106  Free Memory = 76275 MB
Rank =  107  Free Memory = 76275 MB
Rank =  108  Free Memory = 76275 MB
Rank =  109  Free Memory = 76275 MB
Rank =  110  Free Memory = 76275 MB
Rank =  111  Free Memory = 76275 MB
Rank =  112  Free Memory = 76275 MB
Rank =  113  Free Memory = 76275 MB
Rank =  114  Free Memory = 76275 MB
Rank =  115  Free Memory = 76275 MB
Rank =  116  Free Memory = 76275 MB
Rank =  117  Free Memory = 76275 MB
Rank =  118  Free Memory = 76275 MB
Rank =  119  Free Memory = 76275 MB
Rank =  120  Free Memory = 74152 MB
Rank =  121  Free Memory = 74152 MB
Rank =  122  Free Memory = 74152 MB
Rank =  123  Free Memory = 74152 MB
Rank =  124  Free Memory = 74152 MB
Rank =  125  Free Memory = 74152 MB
  Input file(s): opt_h2o_gs_tecombci_run001b.xml 
Rank =  127  Free Memory = 74152 MB
Rank =  126  Free Memory = 74152 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tecombci_run001b.xml

  Project = H2O
  date    = 2023-04-17 11:08:15 PDT
  host    = n0126.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 783

  Range of prime numbers to use as seeds over processors and threads = 6011-7127


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.688314e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2918e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.182031
====================================================
  Execution time = 1.4599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9724e-01
  Total weights = 1.957884429e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284434398744
                                         uncertainty =       0.001455530930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284434398744
                                         uncertainty =       0.001455530930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377120698
  error estimate for blocks of size 2^( 2) =       0.000387838837
  error estimate for blocks of size 2^( 3) =       0.000397842733
  error estimate for blocks of size 2^( 4) =       0.000405888324
  error estimate for blocks of size 2^( 5) =       0.000410615437
  error estimate for blocks of size 2^( 6) =       0.000414446384
  error estimate for blocks of size 2^( 7) =       0.000415827613

      target function =      -0.916873168331
              le_mean =     -17.216149400128
             les_mean =     296.693038897792
             stat err =       0.000411694440
             autocorr =       1.191761264728
   target nu stat err =       0.000411694440
   target dn stat err =       0.002394391204
      target stat err =       0.003838264043
              std dev =       0.533329205301
             le_variance =       0.284440041227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721614940013e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916888248053       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917070048510       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917103919644       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917115086497       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917115773457       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917115917812       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917115882572       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917115884467       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917115810365       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917115810211       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.606647e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916888248053       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916943762765       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916953709483       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916956785072       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916956954064       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916956984252       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916956974157       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916956974955       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916956956153       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916956956310       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.638581e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916888248053       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916902939926       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916905539049       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916906326186       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916906367830       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916906374817       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916906372243       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916906372466       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916906367783       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916906367831       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.277322e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7140e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -3.944225e-02                3 1 ON  0
ci_002 -2.976761e-02                3 1 ON  1
ci_003 -2.453356e-02                3 1 ON  2
ci_004 2.191985e-02                 3 1 ON  3
ci_005 2.223114e-02                 3 1 ON  4
ci_006 -1.919758e-02                3 1 ON  5
ci_007 -1.916966e-02                3 1 ON  6
ci_008 -8.561224e-03                3 1 ON  7
ci_009 -1.451891e-02                3 1 ON  8
ci_010 -9.681993e-03                3 1 ON  9
ci_011 -1.002654e-02                3 1 ON  10
ci_012 -1.003459e-02                3 1 ON  11
ci_013 -1.979479e-02                3 1 ON  12
ci_014 1.163967e-02                 3 1 ON  13
ci_015 1.169970e-02                 3 1 ON  14
ci_016 1.618500e-02                 3 1 ON  15
ci_017 1.606209e-02                 3 1 ON  16
ci_018 9.613735e-03                 3 1 ON  17
ci_019 9.746050e-03                 3 1 ON  18
ci_020 1.540236e-02                 3 1 ON  19
ci_021 1.552892e-02                 3 1 ON  20
ci_022 8.827248e-03                 3 1 ON  21
ci_023 8.753659e-03                 3 1 ON  22
ci_024 9.206351e-03                 3 1 ON  23
ci_025 9.201311e-03                 3 1 ON  24
ci_026 1.034327e-02                 3 1 ON  25
ci_027 1.064063e-02                 3 1 ON  26
ci_028 -1.483503e-02                3 1 ON  27
ci_029 -1.535588e-02                3 1 ON  28
ci_030 -8.847283e-03                3 1 ON  29
ci_031 -8.937287e-03                3 1 ON  30
ci_032 -1.465943e-02                3 1 ON  31
ci_033 5.834558e-03                 3 1 ON  32
ci_034 5.532714e-03                 3 1 ON  33
ci_035 -3.869111e-03                3 1 ON  34
ci_036 -1.189564e-02                3 1 ON  35
ci_037 -1.202034e-02                3 1 ON  36
ci_038 1.436816e-03                 3 1 ON  37
ci_039 1.605476e-03                 3 1 ON  38
ci_040 -2.136389e-03                3 1 ON  39
ci_041 8.262867e-03                 3 1 ON  40
ci_042 8.229715e-03                 3 1 ON  41
ci_043 -2.849603e-03                3 1 ON  42
ci_044 -4.573692e-03                3 1 ON  43
ci_045 -2.338249e-03                3 1 ON  44
ci_046 5.179136e-03                 3 1 ON  45
ci_047 5.184264e-03                 3 1 ON  46
ci_048 -1.258589e-02                3 1 ON  47
ci_049 -1.267294e-02                3 1 ON  48
ci_050 3.316871e-03                 3 1 ON  49
ci_051 3.226293e-03                 3 1 ON  50
ci_052 -2.587825e-03                3 1 ON  51
ci_053 -2.688555e-03                3 1 ON  52
ci_054 -2.701103e-03                3 1 ON  53
ci_055 -2.907696e-03                3 1 ON  54
ci_056 4.887019e-03                 3 1 ON  55
ci_057 5.061132e-03                 3 1 ON  56
ci_058 -2.247805e-03                3 1 ON  57
ci_059 -2.328561e-03                3 1 ON  58
ci_060 5.166857e-03                 3 1 ON  59
ci_061 5.667502e-03                 3 1 ON  60
ci_062 -3.356981e-03                3 1 ON  61
ci_063 -3.274827e-03                3 1 ON  62
ci_064 -2.569509e-03                3 1 ON  63
ci_065 -3.619477e-03                3 1 ON  64
ci_066 4.201133e-03                 3 1 ON  65
ci_067 4.362243e-03                 3 1 ON  66
ci_068 -4.766150e-03                3 1 ON  67
ci_069 -4.541178e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2535
    reference variance = 9.46125
====================================================
  Execution time = 1.3744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0152e-01
  Total weights = 1.9578e+06
  Execution time = 1.8606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287344464157
                                         uncertainty =       0.001699692572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287344464157
                                         uncertainty =       0.001699692572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037260
  error estimate for blocks of size 2^( 2) =       0.000389826141
  error estimate for blocks of size 2^( 3) =       0.000399675644
  error estimate for blocks of size 2^( 4) =       0.000406917693
  error estimate for blocks of size 2^( 5) =       0.000411338854
  error estimate for blocks of size 2^( 6) =       0.000414612114
  error estimate for blocks of size 2^( 7) =       0.000417378008

      target function =      -0.909175029939
              le_mean =     -17.215923681602
             les_mean =     296.690199640312
             stat err =       0.000412561667
             autocorr =       1.184715140679
   target nu stat err =       0.000412561667
   target dn stat err =       0.002510795846
      target stat err =       0.003951112781
              std dev =       0.536039633865
             le_variance =       0.287338489074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287083172073
                                         uncertainty =       0.001682923759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287083172073
                                         uncertainty =       0.001682923759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378862810
  error estimate for blocks of size 2^( 2) =       0.000389720087
  error estimate for blocks of size 2^( 3) =       0.000399639684
  error estimate for blocks of size 2^( 4) =       0.000406942086
  error estimate for blocks of size 2^( 5) =       0.000411388716
  error estimate for blocks of size 2^( 6) =       0.000414701947
  error estimate for blocks of size 2^( 7) =       0.000417446740

      target function =      -0.910983567588
              le_mean =     -17.215927878491
             les_mean =     296.689180032672
             stat err =       0.000412619872
             autocorr =       1.186141029281
   target nu stat err =       0.000412619872
   target dn stat err =       0.002342063191
      target stat err =       0.003708761546
              std dev =       0.535792924257
             le_variance =       0.287074057684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287176720715
                                         uncertainty =       0.001689350621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287176720715
                                         uncertainty =       0.001689350621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378925230
  error estimate for blocks of size 2^( 2) =       0.000389755062
  error estimate for blocks of size 2^( 3) =       0.000399646465
  error estimate for blocks of size 2^( 4) =       0.000406924635
  error estimate for blocks of size 2^( 5) =       0.000411360861
  error estimate for blocks of size 2^( 6) =       0.000414658108
  error estimate for blocks of size 2^( 7) =       0.000417410833

      target function =      -0.910651102868
              le_mean =     -17.215924627583
             les_mean =     296.689281887654
             stat err =       0.000412588609
             autocorr =       1.185570601804
   target nu stat err =       0.000412588609
   target dn stat err =       0.002362296605
      target stat err =       0.003736939621
              std dev =       0.535881199583
             le_variance =       0.287168660067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287320369069
                                         uncertainty =       0.001698279923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287320369069
                                         uncertainty =       0.001698279923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379021173
  error estimate for blocks of size 2^( 2) =       0.000389815405
  error estimate for blocks of size 2^( 3) =       0.000399670387
  error estimate for blocks of size 2^( 4) =       0.000406917191
  error estimate for blocks of size 2^( 5) =       0.000411340307
  error estimate for blocks of size 2^( 6) =       0.000414616706
  error estimate for blocks of size 2^( 7) =       0.000417380820

      target function =      -0.909539380342
              le_mean =     -17.215923532189
             les_mean =     296.689959776303
             stat err =       0.000412563756
             autocorr =       1.184827708814
   target nu stat err =       0.000412563756
   target dn stat err =       0.002457503553
      target stat err =       0.003872977541
              std dev =       0.536016883083
             le_variance =       0.287314098950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909175029939        initial
     2.5000e-01     2.5000e+00             5.6066e-04        -0.910983567588  <--
     1.0000e+00     1.0000e+01             1.6386e-04        -0.910651102868
     4.0000e+00     4.0000e+01             4.2773e-05        -0.909539380342

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3157e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -3.904545e-02 3 1  ON 0
ci_002                -2.960377e-02 3 1  ON 1
ci_003                -2.428267e-02 3 1  ON 2
ci_004                 2.162447e-02 3 1  ON 3
ci_005                 2.195963e-02 3 1  ON 4
ci_006                -1.901493e-02 3 1  ON 5
ci_007                -1.900392e-02 3 1  ON 6
ci_008                -8.378419e-03 3 1  ON 7
ci_009                -1.454455e-02 3 1  ON 8
ci_010                -9.493928e-03 3 1  ON 9
ci_011                -9.984133e-03 3 1  ON 10
ci_012                -9.872984e-03 3 1  ON 11
ci_013                -1.975372e-02 3 1  ON 12
ci_014                 1.172003e-02 3 1  ON 13
ci_015                 1.137273e-02 3 1  ON 14
ci_016                 1.612033e-02 3 1  ON 15
ci_017                 1.583857e-02 3 1  ON 16
ci_018                 9.403596e-03 3 1  ON 17
ci_019                 9.526453e-03 3 1  ON 18
ci_020                 1.525366e-02 3 1  ON 19
ci_021                 1.549663e-02 3 1  ON 20
ci_022                 8.736286e-03 3 1  ON 21
ci_023                 8.741091e-03 3 1  ON 22
ci_024                 9.040575e-03 3 1  ON 23
ci_025                 9.166258e-03 3 1  ON 24
ci_026                 1.025214e-02 3 1  ON 25
ci_027                 1.065207e-02 3 1  ON 26
ci_028                -1.477449e-02 3 1  ON 27
ci_029                -1.539043e-02 3 1  ON 28
ci_030                -8.845377e-03 3 1  ON 29
ci_031                -8.808040e-03 3 1  ON 30
ci_032                -1.467606e-02 3 1  ON 31
ci_033                 5.735817e-03 3 1  ON 32
ci_034                 5.491802e-03 3 1  ON 33
ci_035                -3.773980e-03 3 1  ON 34
ci_036                -1.191015e-02 3 1  ON 35
ci_037                -1.194357e-02 3 1  ON 36
ci_038                 1.293142e-03 3 1  ON 37
ci_039                 1.503255e-03 3 1  ON 38
ci_040                -2.035397e-03 3 1  ON 39
ci_041                 8.293192e-03 3 1  ON 40
ci_042                 8.205899e-03 3 1  ON 41
ci_043                -2.758324e-03 3 1  ON 42
ci_044                -4.375950e-03 3 1  ON 43
ci_045                -2.173960e-03 3 1  ON 44
ci_046                 5.175040e-03 3 1  ON 45
ci_047                 5.133021e-03 3 1  ON 46
ci_048                -1.261036e-02 3 1  ON 47
ci_049                -1.256699e-02 3 1  ON 48
ci_050                 3.168321e-03 3 1  ON 49
ci_051                 3.071615e-03 3 1  ON 50
ci_052                -2.379263e-03 3 1  ON 51
ci_053                -2.618302e-03 3 1  ON 52
ci_054                -2.684382e-03 3 1  ON 53
ci_055                -2.767915e-03 3 1  ON 54
ci_056                 4.819188e-03 3 1  ON 55
ci_057                 5.018375e-03 3 1  ON 56
ci_058                -2.041054e-03 3 1  ON 57
ci_059                -2.299321e-03 3 1  ON 58
ci_060                 5.278788e-03 3 1  ON 59
ci_061                 5.650115e-03 3 1  ON 60
ci_062                -3.286736e-03 3 1  ON 61
ci_063                -3.048666e-03 3 1  ON 62
ci_064                -2.518954e-03 3 1  ON 63
ci_065                -3.575877e-03 3 1  ON 64
ci_066                 4.116090e-03 3 1  ON 65
ci_067                 4.364815e-03 3 1  ON 66
ci_068                -4.780480e-03 3 1  ON 67
ci_069                -4.651007e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7238e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.188799
====================================================
  Execution time = 1.3931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9964e-01
  Total weights = 1.957654887e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287616903595
                                         uncertainty =       0.001968398932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287616903595
                                         uncertainty =       0.001968398932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379214686
  error estimate for blocks of size 2^( 2) =       0.000390511393
  error estimate for blocks of size 2^( 3) =       0.000400675566
  error estimate for blocks of size 2^( 4) =       0.000407757510
  error estimate for blocks of size 2^( 5) =       0.000412449632
  error estimate for blocks of size 2^( 6) =       0.000414849724
  error estimate for blocks of size 2^( 7) =       0.000416118844

      target function =      -0.913144670306
              le_mean =     -17.215286347488
             les_mean =     296.665721280387
             stat err =       0.000412793927
             autocorr =       1.184939841565
   target nu stat err =       0.000412793927
   target dn stat err =       0.002521105685
      target stat err =       0.003996287636
              std dev =       0.536290552560
             le_variance =       0.287607556765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528634749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913161225799       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913574710247       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913678042684       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913718955804       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913725900051       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913726411237       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913726707316       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913726542077       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913726454066       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913726412721       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913726376794       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.499030e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913161225799       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913339127753       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913379670935       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913394440070       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913396547784       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913396647336       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913396710900       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913396648170       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913396622676       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913396611380       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913396601186       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.013163e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913161225799       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913215476683       residual = 2.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913227248013       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913231355006       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913231887299       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913231906612       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913231919461       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913231902201       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913231895775       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913231893130       residual = 9.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.772963e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6469e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -3.853079e-02 3 1  ON 0
ci_002                -2.926832e-02 3 1  ON 1
ci_003                -2.396488e-02 3 1  ON 2
ci_004                 2.130136e-02 3 1  ON 3
ci_005                 2.190285e-02 3 1  ON 4
ci_006                -1.887554e-02 3 1  ON 5
ci_007                -1.872955e-02 3 1  ON 6
ci_008                -8.088703e-03 3 1  ON 7
ci_009                -1.431155e-02 3 1  ON 8
ci_010                -9.499090e-03 3 1  ON 9
ci_011                -9.611099e-03 3 1  ON 10
ci_012                -9.761557e-03 3 1  ON 11
ci_013                -1.964299e-02 3 1  ON 12
ci_014                 1.142151e-02 3 1  ON 13
ci_015                 1.134690e-02 3 1  ON 14
ci_016                 1.602960e-02 3 1  ON 15
ci_017                 1.595165e-02 3 1  ON 16
ci_018                 9.406892e-03 3 1  ON 17
ci_019                 9.412354e-03 3 1  ON 18
ci_020                 1.497266e-02 3 1  ON 19
ci_021                 1.542323e-02 3 1  ON 20
ci_022                 8.569497e-03 3 1  ON 21
ci_023                 8.516369e-03 3 1  ON 22
ci_024                 8.439259e-03 3 1  ON 23
ci_025                 9.124620e-03 3 1  ON 24
ci_026                 1.015396e-02 3 1  ON 25
ci_027                 1.034799e-02 3 1  ON 26
ci_028                -1.462673e-02 3 1  ON 27
ci_029                -1.544607e-02 3 1  ON 28
ci_030                -8.879097e-03 3 1  ON 29
ci_031                -8.948705e-03 3 1  ON 30
ci_032                -1.456469e-02 3 1  ON 31
ci_033                 5.424082e-03 3 1  ON 32
ci_034                 5.269830e-03 3 1  ON 33
ci_035                -3.604138e-03 3 1  ON 34
ci_036                -1.198018e-02 3 1  ON 35
ci_037                -1.193559e-02 3 1  ON 36
ci_038                 1.164513e-03 3 1  ON 37
ci_039                 1.370362e-03 3 1  ON 38
ci_040                -1.950808e-03 3 1  ON 39
ci_041                 8.221604e-03 3 1  ON 40
ci_042                 8.418240e-03 3 1  ON 41
ci_043                -2.636558e-03 3 1  ON 42
ci_044                -4.079253e-03 3 1  ON 43
ci_045                -2.015992e-03 3 1  ON 44
ci_046                 4.964979e-03 3 1  ON 45
ci_047                 4.904258e-03 3 1  ON 46
ci_048                -1.267682e-02 3 1  ON 47
ci_049                -1.276874e-02 3 1  ON 48
ci_050                 3.117368e-03 3 1  ON 49
ci_051                 2.962152e-03 3 1  ON 50
ci_052                -2.266122e-03 3 1  ON 51
ci_053                -2.650643e-03 3 1  ON 52
ci_054                -2.429776e-03 3 1  ON 53
ci_055                -2.689762e-03 3 1  ON 54
ci_056                 4.771180e-03 3 1  ON 55
ci_057                 4.749359e-03 3 1  ON 56
ci_058                -2.136262e-03 3 1  ON 57
ci_059                -2.182490e-03 3 1  ON 58
ci_060                 4.956953e-03 3 1  ON 59
ci_061                 5.468881e-03 3 1  ON 60
ci_062                -3.230275e-03 3 1  ON 61
ci_063                -2.929866e-03 3 1  ON 62
ci_064                -2.512581e-03 3 1  ON 63
ci_065                -3.536622e-03 3 1  ON 64
ci_066                 4.133602e-03 3 1  ON 65
ci_067                 4.141092e-03 3 1  ON 66
ci_068                -4.340105e-03 3 1  ON 67
ci_069                -4.691119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.190023
====================================================
  Execution time = 1.3260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0359e-01
  Total weights = 1.9575e+06
  Execution time = 1.8656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288539270912
                                         uncertainty =       0.001731705861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288539270912
                                         uncertainty =       0.001731705861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379798814
  error estimate for blocks of size 2^( 2) =       0.000390623156
  error estimate for blocks of size 2^( 3) =       0.000401340944
  error estimate for blocks of size 2^( 4) =       0.000408894900
  error estimate for blocks of size 2^( 5) =       0.000413481576
  error estimate for blocks of size 2^( 6) =       0.000415897323
  error estimate for blocks of size 2^( 7) =       0.000419728350

      target function =      -0.727140684133
              le_mean =     -17.215740919220
             les_mean =     296.813862346411
             stat err =       0.000414500537
             autocorr =       1.191085638289
   target nu stat err =       0.000414500537
   target dn stat err =       0.110783664885
      target stat err =       0.112311281451
              std dev =       0.537116633249
             le_variance =       0.288494277713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288218225355
                                         uncertainty =       0.001756114531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288218225355
                                         uncertainty =       0.001756114531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379587499
  error estimate for blocks of size 2^( 2) =       0.000390547484
  error estimate for blocks of size 2^( 3) =       0.000401423619
  error estimate for blocks of size 2^( 4) =       0.000409097700
  error estimate for blocks of size 2^( 5) =       0.000413789243
  error estimate for blocks of size 2^( 6) =       0.000416271962
  error estimate for blocks of size 2^( 7) =       0.000420148973

      target function =      -0.852046401674
              le_mean =     -17.215772080729
             les_mean =     296.722420882204
             stat err =       0.000414826970
             autocorr =       1.194291016342
   target nu stat err =       0.000414826970
   target dn stat err =       0.034939034721
      target stat err =       0.047658060349
              std dev =       0.536817789226
             le_variance =       0.288173338829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288191940332
                                         uncertainty =       0.001752292532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288191940332
                                         uncertainty =       0.001752292532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379570239
  error estimate for blocks of size 2^( 2) =       0.000390507355
  error estimate for blocks of size 2^( 3) =       0.000401360873
  error estimate for blocks of size 2^( 4) =       0.000409015138
  error estimate for blocks of size 2^( 5) =       0.000413690810
  error estimate for blocks of size 2^( 6) =       0.000416153963
  error estimate for blocks of size 2^( 7) =       0.000420020992

      target function =      -0.906804126539
              le_mean =     -17.215757805672
             les_mean =     296.686028131338
             stat err =       0.000414720226
             autocorr =       1.193785023542
   target nu stat err =       0.000414720226
   target dn stat err =       0.002754805659
      target stat err =       0.004300523157
              std dev =       0.536793379572
             le_variance =       0.288147132352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288385798387
                                         uncertainty =       0.001739613933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288385798387
                                         uncertainty =       0.001739613933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379697873
  error estimate for blocks of size 2^( 2) =       0.000390534227
  error estimate for blocks of size 2^( 3) =       0.000401275745
  error estimate for blocks of size 2^( 4) =       0.000408843606
  error estimate for blocks of size 2^( 5) =       0.000413468301
  error estimate for blocks of size 2^( 6) =       0.000415892209
  error estimate for blocks of size 2^( 7) =       0.000419743711

      target function =      -0.893860707969
              le_mean =     -17.215743418940
             les_mean =     296.693995959182
             stat err =       0.000414486957
             autocorr =       1.191640922418
   target nu stat err =       0.000414486957
   target dn stat err =       0.006787230702
      target stat err =       0.010180702601
              std dev =       0.536973881534
             le_variance =       0.288340949450


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.727140684133        initial
     6.2500e-02     6.2500e-01             1.4990e-03        -0.852046401674
     2.5000e-01     2.5000e+00             6.0132e-04        -0.906804126539  <--
     1.0000e+00     1.0000e+01             1.7730e-04        -0.893860707969

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2834e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -3.853079e-02 3 1  ON 0
ci_002                -2.926832e-02 3 1  ON 1
ci_003                -2.396488e-02 3 1  ON 2
ci_004                 2.130136e-02 3 1  ON 3
ci_005                 2.190285e-02 3 1  ON 4
ci_006                -1.887554e-02 3 1  ON 5
ci_007                -1.872955e-02 3 1  ON 6
ci_008                -8.088703e-03 3 1  ON 7
ci_009                -1.431155e-02 3 1  ON 8
ci_010                -9.499090e-03 3 1  ON 9
ci_011                -9.611099e-03 3 1  ON 10
ci_012                -9.761557e-03 3 1  ON 11
ci_013                -1.964299e-02 3 1  ON 12
ci_014                 1.142151e-02 3 1  ON 13
ci_015                 1.134690e-02 3 1  ON 14
ci_016                 1.602960e-02 3 1  ON 15
ci_017                 1.595165e-02 3 1  ON 16
ci_018                 9.406892e-03 3 1  ON 17
ci_019                 9.412354e-03 3 1  ON 18
ci_020                 1.497266e-02 3 1  ON 19
ci_021                 1.542323e-02 3 1  ON 20
ci_022                 8.569497e-03 3 1  ON 21
ci_023                 8.516369e-03 3 1  ON 22
ci_024                 8.439259e-03 3 1  ON 23
ci_025                 9.124620e-03 3 1  ON 24
ci_026                 1.015396e-02 3 1  ON 25
ci_027                 1.034799e-02 3 1  ON 26
ci_028                -1.462673e-02 3 1  ON 27
ci_029                -1.544607e-02 3 1  ON 28
ci_030                -8.879097e-03 3 1  ON 29
ci_031                -8.948705e-03 3 1  ON 30
ci_032                -1.456469e-02 3 1  ON 31
ci_033                 5.424082e-03 3 1  ON 32
ci_034                 5.269830e-03 3 1  ON 33
ci_035                -3.604138e-03 3 1  ON 34
ci_036                -1.198018e-02 3 1  ON 35
ci_037                -1.193559e-02 3 1  ON 36
ci_038                 1.164513e-03 3 1  ON 37
ci_039                 1.370362e-03 3 1  ON 38
ci_040                -1.950808e-03 3 1  ON 39
ci_041                 8.221604e-03 3 1  ON 40
ci_042                 8.418240e-03 3 1  ON 41
ci_043                -2.636558e-03 3 1  ON 42
ci_044                -4.079253e-03 3 1  ON 43
ci_045                -2.015992e-03 3 1  ON 44
ci_046                 4.964979e-03 3 1  ON 45
ci_047                 4.904258e-03 3 1  ON 46
ci_048                -1.267682e-02 3 1  ON 47
ci_049                -1.276874e-02 3 1  ON 48
ci_050                 3.117368e-03 3 1  ON 49
ci_051                 2.962152e-03 3 1  ON 50
ci_052                -2.266122e-03 3 1  ON 51
ci_053                -2.650643e-03 3 1  ON 52
ci_054                -2.429776e-03 3 1  ON 53
ci_055                -2.689762e-03 3 1  ON 54
ci_056                 4.771180e-03 3 1  ON 55
ci_057                 4.749359e-03 3 1  ON 56
ci_058                -2.136262e-03 3 1  ON 57
ci_059                -2.182490e-03 3 1  ON 58
ci_060                 4.956953e-03 3 1  ON 59
ci_061                 5.468881e-03 3 1  ON 60
ci_062                -3.230275e-03 3 1  ON 61
ci_063                -2.929866e-03 3 1  ON 62
ci_064                -2.512581e-03 3 1  ON 63
ci_065                -3.536622e-03 3 1  ON 64
ci_066                 4.133602e-03 3 1  ON 65
ci_067                 4.141092e-03 3 1  ON 66
ci_068                -4.340105e-03 3 1  ON 67
ci_069                -4.691119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.134737
====================================================
  Execution time = 1.3703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0274e-01
  Total weights = 1.957622642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289179298506
                                         uncertainty =       0.001463827640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289179298506
                                         uncertainty =       0.001463827640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380226717
  error estimate for blocks of size 2^( 2) =       0.000391452378
  error estimate for blocks of size 2^( 3) =       0.000401855272
  error estimate for blocks of size 2^( 4) =       0.000409410046
  error estimate for blocks of size 2^( 5) =       0.000413836487
  error estimate for blocks of size 2^( 6) =       0.000416363771
  error estimate for blocks of size 2^( 7) =       0.000416000268

      target function =      -0.908351470531
              le_mean =     -17.214728417916
             les_mean =     296.649618876103
             stat err =       0.000413902643
             autocorr =       1.184980323507
   target nu stat err =       0.000413902643
   target dn stat err =       0.002377313922
      target stat err =       0.003733270939
              std dev =       0.537721780117
             le_variance =       0.289144712812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721472841792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908365951161       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908636179979       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908695753702       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908716611612       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908721970827       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908721514766       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908721946923       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908722137541       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908722141228       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908722125710       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908722154663       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.448484e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908365951161       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908480846486       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908503813789       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908511263864       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908513081893       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908512835718       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908512958405       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908513017132       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908513005219       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908513007832       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.906473e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908365951161       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908400773693       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908407383250       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908409446571       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908409936944       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908409860875       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908409887395       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908409904311       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908409901095       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908409901322       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.753896e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6243e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -3.807929e-02 3 1  ON 0
ci_002                -2.897606e-02 3 1  ON 1
ci_003                -2.369851e-02 3 1  ON 2
ci_004                 2.106132e-02 3 1  ON 3
ci_005                 2.192129e-02 3 1  ON 4
ci_006                -1.865099e-02 3 1  ON 5
ci_007                -1.867156e-02 3 1  ON 6
ci_008                -7.997498e-03 3 1  ON 7
ci_009                -1.429018e-02 3 1  ON 8
ci_010                -9.829816e-03 3 1  ON 9
ci_011                -9.413763e-03 3 1  ON 10
ci_012                -9.537999e-03 3 1  ON 11
ci_013                -1.955408e-02 3 1  ON 12
ci_014                 1.132612e-02 3 1  ON 13
ci_015                 1.119874e-02 3 1  ON 14
ci_016                 1.584157e-02 3 1  ON 15
ci_017                 1.578726e-02 3 1  ON 16
ci_018                 9.220817e-03 3 1  ON 17
ci_019                 9.336191e-03 3 1  ON 18
ci_020                 1.493071e-02 3 1  ON 19
ci_021                 1.521756e-02 3 1  ON 20
ci_022                 8.330531e-03 3 1  ON 21
ci_023                 8.407930e-03 3 1  ON 22
ci_024                 8.515515e-03 3 1  ON 23
ci_025                 8.867843e-03 3 1  ON 24
ci_026                 1.020201e-02 3 1  ON 25
ci_027                 1.024776e-02 3 1  ON 26
ci_028                -1.461046e-02 3 1  ON 27
ci_029                -1.542383e-02 3 1  ON 28
ci_030                -8.804640e-03 3 1  ON 29
ci_031                -8.671409e-03 3 1  ON 30
ci_032                -1.443527e-02 3 1  ON 31
ci_033                 5.267435e-03 3 1  ON 32
ci_034                 4.679183e-03 3 1  ON 33
ci_035                -3.507315e-03 3 1  ON 34
ci_036                -1.177101e-02 3 1  ON 35
ci_037                -1.170171e-02 3 1  ON 36
ci_038                 1.116943e-03 3 1  ON 37
ci_039                 1.313406e-03 3 1  ON 38
ci_040                -1.873428e-03 3 1  ON 39
ci_041                 8.163403e-03 3 1  ON 40
ci_042                 8.630903e-03 3 1  ON 41
ci_043                -2.559575e-03 3 1  ON 42
ci_044                -4.054258e-03 3 1  ON 43
ci_045                -2.067507e-03 3 1  ON 44
ci_046                 4.942052e-03 3 1  ON 45
ci_047                 4.802765e-03 3 1  ON 46
ci_048                -1.233725e-02 3 1  ON 47
ci_049                -1.276132e-02 3 1  ON 48
ci_050                 3.216635e-03 3 1  ON 49
ci_051                 3.115522e-03 3 1  ON 50
ci_052                -2.334174e-03 3 1  ON 51
ci_053                -2.549893e-03 3 1  ON 52
ci_054                -2.272559e-03 3 1  ON 53
ci_055                -2.680373e-03 3 1  ON 54
ci_056                 4.767759e-03 3 1  ON 55
ci_057                 4.747760e-03 3 1  ON 56
ci_058                -2.050704e-03 3 1  ON 57
ci_059                -2.078923e-03 3 1  ON 58
ci_060                 4.968367e-03 3 1  ON 59
ci_061                 5.303205e-03 3 1  ON 60
ci_062                -3.040818e-03 3 1  ON 61
ci_063                -2.897203e-03 3 1  ON 62
ci_064                -2.462398e-03 3 1  ON 63
ci_065                -3.488169e-03 3 1  ON 64
ci_066                 4.249126e-03 3 1  ON 65
ci_067                 4.068333e-03 3 1  ON 66
ci_068                -4.229512e-03 3 1  ON 67
ci_069                -4.714883e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.172239
====================================================
  Execution time = 1.3318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9950e-01
  Total weights = 1.9576e+06
  Execution time = 1.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285727913619
                                         uncertainty =       0.001864820610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285727913619
                                         uncertainty =       0.001864820610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377935190
  error estimate for blocks of size 2^( 2) =       0.000388740967
  error estimate for blocks of size 2^( 3) =       0.000399067904
  error estimate for blocks of size 2^( 4) =       0.000407253031
  error estimate for blocks of size 2^( 5) =       0.000412303303
  error estimate for blocks of size 2^( 6) =       0.000415771569
  error estimate for blocks of size 2^( 7) =       0.000417420885

      target function =      -0.911621081805
              le_mean =     -17.215079586602
             les_mean =     296.659586648690
             stat err =       0.000413187197
             autocorr =       1.195250814113
   target nu stat err =       0.000413187197
   target dn stat err =       0.002492527234
      target stat err =       0.003938031784
              std dev =       0.534481071710
             le_variance =       0.285670016016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285505252456
                                         uncertainty =       0.001840334250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285505252456
                                         uncertainty =       0.001840334250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377787495
  error estimate for blocks of size 2^( 2) =       0.000388706364
  error estimate for blocks of size 2^( 3) =       0.000399141102
  error estimate for blocks of size 2^( 4) =       0.000407384294
  error estimate for blocks of size 2^( 5) =       0.000412461149
  error estimate for blocks of size 2^( 6) =       0.000416047010
  error estimate for blocks of size 2^( 7) =       0.000417716868

      target function =      -0.895550526230
              le_mean =     -17.215069281399
             les_mean =     296.669547441143
             stat err =       0.000413402330
             autocorr =       1.197431514789
   target nu stat err =       0.000413402330
   target dn stat err =       0.011466268152
      target stat err =       0.017220430939
              std dev =       0.534272199243
             le_variance =       0.285446782884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285889032327
                                         uncertainty =       0.001871192716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285889032327
                                         uncertainty =       0.001871192716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378040985
  error estimate for blocks of size 2^( 2) =       0.000388927003
  error estimate for blocks of size 2^( 3) =       0.000399321517
  error estimate for blocks of size 2^( 4) =       0.000407556015
  error estimate for blocks of size 2^( 5) =       0.000412740406
  error estimate for blocks of size 2^( 6) =       0.000416296986
  error estimate for blocks of size 2^( 7) =       0.000418000253

      target function =      -0.806243886445
              le_mean =     -17.215084531391
             les_mean =     296.728955094898
             stat err =       0.000413648415
             autocorr =       1.197250308844
   target nu stat err =       0.000413648415
   target dn stat err =       0.069992768950
      target stat err =       0.086070945007
              std dev =       0.534630687582
             le_variance =       0.285829972105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285677140406
                                         uncertainty =       0.001861553658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285677140406
                                         uncertainty =       0.001861553658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377901560
  error estimate for blocks of size 2^( 2) =       0.000388720180
  error estimate for blocks of size 2^( 3) =       0.000399059431
  error estimate for blocks of size 2^( 4) =       0.000407251835
  error estimate for blocks of size 2^( 5) =       0.000412305776
  error estimate for blocks of size 2^( 6) =       0.000415783689
  error estimate for blocks of size 2^( 7) =       0.000417439180

      target function =      -0.912507705030
              le_mean =     -17.215076160056
             les_mean =     296.658899282623
             stat err =       0.000413195120
             autocorr =       1.195509405912
   target nu stat err =       0.000413195120
   target dn stat err =       0.002449434816
      target stat err =       0.003879532472
              std dev =       0.534433511671
             le_variance =       0.285619178397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911621081805        initial
     6.2500e-02     6.2500e-01             1.4485e-03        -0.895550526230
     2.5000e-01     2.5000e+00             5.9065e-04        -0.806243886445
     1.0000e+00     1.0000e+01             1.7539e-04        -0.912507705030  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2752e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -3.839930e-02 3 1  ON 0
ci_002                -2.918231e-02 3 1  ON 1
ci_003                -2.388844e-02 3 1  ON 2
ci_004                 2.122973e-02 3 1  ON 3
ci_005                 2.190781e-02 3 1  ON 4
ci_006                -1.880929e-02 3 1  ON 5
ci_007                -1.871188e-02 3 1  ON 6
ci_008                -8.061750e-03 3 1  ON 7
ci_009                -1.430522e-02 3 1  ON 8
ci_010                -9.598153e-03 3 1  ON 9
ci_011                -9.552005e-03 3 1  ON 10
ci_012                -9.694724e-03 3 1  ON 11
ci_013                -1.961694e-02 3 1  ON 12
ci_014                 1.139230e-02 3 1  ON 13
ci_015                 1.130228e-02 3 1  ON 14
ci_016                 1.597406e-02 3 1  ON 15
ci_017                 1.590251e-02 3 1  ON 16
ci_018                 9.351192e-03 3 1  ON 17
ci_019                 9.389190e-03 3 1  ON 18
ci_020                 1.496027e-02 3 1  ON 19
ci_021                 1.536331e-02 3 1  ON 20
ci_022                 8.498036e-03 3 1  ON 21
ci_023                 8.484258e-03 3 1  ON 22
ci_024                 8.463239e-03 3 1  ON 23
ci_025                 9.049797e-03 3 1  ON 24
ci_026                 1.016918e-02 3 1  ON 25
ci_027                 1.031708e-02 3 1  ON 26
ci_028                -1.462130e-02 3 1  ON 27
ci_029                -1.543752e-02 3 1  ON 28
ci_030                -8.857798e-03 3 1  ON 29
ci_031                -8.864930e-03 3 1  ON 30
ci_032                -1.452637e-02 3 1  ON 31
ci_033                 5.377995e-03 3 1  ON 32
ci_034                 5.094440e-03 3 1  ON 33
ci_035                -3.574899e-03 3 1  ON 34
ci_036                -1.191825e-02 3 1  ON 35
ci_037                -1.186620e-02 3 1  ON 36
ci_038                 1.150056e-03 3 1  ON 37
ci_039                 1.353083e-03 3 1  ON 38
ci_040                -1.927207e-03 3 1  ON 39
ci_041                 8.203543e-03 3 1  ON 40
ci_042                 8.482303e-03 3 1  ON 41
ci_043                -2.613308e-03 3 1  ON 42
ci_044                -4.071745e-03 3 1  ON 43
ci_045                -2.031661e-03 3 1  ON 44
ci_046                 4.958048e-03 3 1  ON 45
ci_047                 4.874084e-03 3 1  ON 46
ci_048                -1.257713e-02 3 1  ON 47
ci_049                -1.276685e-02 3 1  ON 48
ci_050                 3.147786e-03 3 1  ON 49
ci_051                 3.009152e-03 3 1  ON 50
ci_052                -2.286447e-03 3 1  ON 51
ci_053                -2.619276e-03 3 1  ON 52
ci_054                -2.383340e-03 3 1  ON 53
ci_055                -2.686601e-03 3 1  ON 54
ci_056                 4.770203e-03 3 1  ON 55
ci_057                 4.748793e-03 3 1  ON 56
ci_058                -2.109976e-03 3 1  ON 57
ci_059                -2.151031e-03 3 1  ON 58
ci_060                 4.960406e-03 3 1  ON 59
ci_061                 5.419700e-03 3 1  ON 60
ci_062                -3.173404e-03 3 1  ON 61
ci_063                -2.920706e-03 3 1  ON 62
ci_064                -2.497316e-03 3 1  ON 63
ci_065                -3.521902e-03 3 1  ON 64
ci_066                 4.168113e-03 3 1  ON 65
ci_067                 4.118127e-03 3 1  ON 66
ci_068                -4.306828e-03 3 1  ON 67
ci_069                -4.698113e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.270391
====================================================
  Execution time = 1.3607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0047e-01
  Total weights = 1.957763685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819479608
                                         uncertainty =       0.001692183414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286819479608
                                         uncertainty =       0.001692183414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378680865
  error estimate for blocks of size 2^( 2) =       0.000390031926
  error estimate for blocks of size 2^( 3) =       0.000400642903
  error estimate for blocks of size 2^( 4) =       0.000407839344
  error estimate for blocks of size 2^( 5) =       0.000413794536
  error estimate for blocks of size 2^( 6) =       0.000415421797
  error estimate for blocks of size 2^( 7) =       0.000418335337

      target function =      -0.911890264068
              le_mean =     -17.214160812309
             les_mean =     296.627803432972
             stat err =       0.000413847753
             autocorr =       1.194357889561
   target nu stat err =       0.000413847753
   target dn stat err =       0.002680060385
      target stat err =       0.004220568024
              std dev =       0.535535615250
             le_variance =       0.286798395201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721416081231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911908861682       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912083014643       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912113516404       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912119546251       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912122089511       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912122463657       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912122620630       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912122654484       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912122670157       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912122627384       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912122628739       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.937305e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911908861682       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911961862192       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911970747278       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911972398105       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911973094682       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911973183821       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911973222854       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911973230135       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911973233555       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911973222946       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.168867e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911908861682       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911922872940       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911925188707       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911925610442       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911925788504       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911925810261       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911925819917       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911925821656       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911925822449       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911925819827       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.065372e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6151e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -3.830705e-02 3 1  ON 0
ci_002                -2.912792e-02 3 1  ON 1
ci_003                -2.386562e-02 3 1  ON 2
ci_004                 2.118433e-02 3 1  ON 3
ci_005                 2.182575e-02 3 1  ON 4
ci_006                -1.870801e-02 3 1  ON 5
ci_007                -1.867046e-02 3 1  ON 6
ci_008                -8.017237e-03 3 1  ON 7
ci_009                -1.424786e-02 3 1  ON 8
ci_010                -9.562333e-03 3 1  ON 9
ci_011                -9.589225e-03 3 1  ON 10
ci_012                -9.605796e-03 3 1  ON 11
ci_013                -1.953069e-02 3 1  ON 12
ci_014                 1.133128e-02 3 1  ON 13
ci_015                 1.124751e-02 3 1  ON 14
ci_016                 1.596652e-02 3 1  ON 15
ci_017                 1.587757e-02 3 1  ON 16
ci_018                 9.336703e-03 3 1  ON 17
ci_019                 9.327459e-03 3 1  ON 18
ci_020                 1.492814e-02 3 1  ON 19
ci_021                 1.531958e-02 3 1  ON 20
ci_022                 8.546368e-03 3 1  ON 21
ci_023                 8.494895e-03 3 1  ON 22
ci_024                 8.580126e-03 3 1  ON 23
ci_025                 8.948567e-03 3 1  ON 24
ci_026                 1.019528e-02 3 1  ON 25
ci_027                 1.026399e-02 3 1  ON 26
ci_028                -1.456623e-02 3 1  ON 27
ci_029                -1.544733e-02 3 1  ON 28
ci_030                -8.770020e-03 3 1  ON 29
ci_031                -8.786388e-03 3 1  ON 30
ci_032                -1.450780e-02 3 1  ON 31
ci_033                 5.300126e-03 3 1  ON 32
ci_034                 5.146290e-03 3 1  ON 33
ci_035                -3.544580e-03 3 1  ON 34
ci_036                -1.188456e-02 3 1  ON 35
ci_037                -1.182707e-02 3 1  ON 36
ci_038                 1.114540e-03 3 1  ON 37
ci_039                 1.306817e-03 3 1  ON 38
ci_040                -1.885868e-03 3 1  ON 39
ci_041                 8.174789e-03 3 1  ON 40
ci_042                 8.411143e-03 3 1  ON 41
ci_043                -2.559725e-03 3 1  ON 42
ci_044                -4.033684e-03 3 1  ON 43
ci_045                -2.032350e-03 3 1  ON 44
ci_046                 4.913280e-03 3 1  ON 45
ci_047                 4.851470e-03 3 1  ON 46
ci_048                -1.254564e-02 3 1  ON 47
ci_049                -1.284068e-02 3 1  ON 48
ci_050                 3.100250e-03 3 1  ON 49
ci_051                 2.956881e-03 3 1  ON 50
ci_052                -2.217520e-03 3 1  ON 51
ci_053                -2.620471e-03 3 1  ON 52
ci_054                -2.385585e-03 3 1  ON 53
ci_055                -2.663252e-03 3 1  ON 54
ci_056                 4.797048e-03 3 1  ON 55
ci_057                 4.738437e-03 3 1  ON 56
ci_058                -2.025368e-03 3 1  ON 57
ci_059                -2.088972e-03 3 1  ON 58
ci_060                 4.924082e-03 3 1  ON 59
ci_061                 5.355560e-03 3 1  ON 60
ci_062                -3.103967e-03 3 1  ON 61
ci_063                -2.952248e-03 3 1  ON 62
ci_064                -2.478321e-03 3 1  ON 63
ci_065                -3.484897e-03 3 1  ON 64
ci_066                 4.150721e-03 3 1  ON 65
ci_067                 4.148403e-03 3 1  ON 66
ci_068                -4.269083e-03 3 1  ON 67
ci_069                -4.595862e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.637437
====================================================
  Execution time = 1.3314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9861e-01
  Total weights = 1.9579e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285705708439
                                         uncertainty =       0.001620808114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285705708439
                                         uncertainty =       0.001620808114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378010766
  error estimate for blocks of size 2^( 2) =       0.000389048287
  error estimate for blocks of size 2^( 3) =       0.000399727240
  error estimate for blocks of size 2^( 4) =       0.000407464812
  error estimate for blocks of size 2^( 5) =       0.000410717389
  error estimate for blocks of size 2^( 6) =       0.000413912396
  error estimate for blocks of size 2^( 7) =       0.000416451491

      target function =      -0.914602289454
              le_mean =     -17.214799424545
             les_mean =     296.648036431805
             stat err =       0.000412136522
             autocorr =       1.188704388515
   target nu stat err =       0.000412136522
   target dn stat err =       0.002405371088
      target stat err =       0.003826972829
              std dev =       0.534587951727
             le_variance =       0.285784278131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285693062541
                                         uncertainty =       0.001630950619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285693062541
                                         uncertainty =       0.001630950619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378002886
  error estimate for blocks of size 2^( 2) =       0.000389101035
  error estimate for blocks of size 2^( 3) =       0.000399827353
  error estimate for blocks of size 2^( 4) =       0.000407593015
  error estimate for blocks of size 2^( 5) =       0.000410868863
  error estimate for blocks of size 2^( 6) =       0.000414088516
  error estimate for blocks of size 2^( 7) =       0.000416591886

      target function =      -0.718798337437
              le_mean =     -17.214815429234
             les_mean =     296.783271642481
             stat err =       0.000412285570
             autocorr =       1.189613919911
   target nu stat err =       0.000412285570
   target dn stat err =       0.133206535316
      target stat err =       0.133073509564
              std dev =       0.534576808617
             le_variance =       0.285772364312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285632773047
                                         uncertainty =       0.001621819812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285632773047
                                         uncertainty =       0.001621819812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377962957
  error estimate for blocks of size 2^( 2) =       0.000389038590
  error estimate for blocks of size 2^( 3) =       0.000399749225
  error estimate for blocks of size 2^( 4) =       0.000407507244
  error estimate for blocks of size 2^( 5) =       0.000410770659
  error estimate for blocks of size 2^( 6) =       0.000413971334
  error estimate for blocks of size 2^( 7) =       0.000416501750

      target function =      -0.914697789500
              le_mean =     -17.214803444993
             les_mean =     296.648113656508
             stat err =       0.000412187747
             autocorr =       1.189300712693
   target nu stat err =       0.000412187747
   target dn stat err =       0.002409728788
      target stat err =       0.003834503416
              std dev =       0.534520339337
             le_variance =       0.285711993165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285694329521
                                         uncertainty =       0.001620937795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285694329521
                                         uncertainty =       0.001620937795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378003298
  error estimate for blocks of size 2^( 2) =       0.000389045869
  error estimate for blocks of size 2^( 3) =       0.000399728939
  error estimate for blocks of size 2^( 4) =       0.000407469140
  error estimate for blocks of size 2^( 5) =       0.000410723174
  error estimate for blocks of size 2^( 6) =       0.000413918960
  error estimate for blocks of size 2^( 7) =       0.000416456894

      target function =      -0.914668389434
              le_mean =     -17.214799745399
             les_mean =     296.648005212517
             stat err =       0.000412142042
             autocorr =       1.188783202679
   target nu stat err =       0.000412142042
   target dn stat err =       0.002404310523
      target stat err =       0.003825890236
              std dev =       0.534577390264
             le_variance =       0.285772986181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914602289454        initial
     2.5000e-01     2.5000e+00             3.9373e-04        -0.718798337437
     1.0000e+00     1.0000e+01             1.1689e-04        -0.914697789500  <--
     4.0000e+00     4.0000e+01             3.0654e-05        -0.914668389434

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2770e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -3.830705e-02 3 1  ON 0
ci_002                -2.912792e-02 3 1  ON 1
ci_003                -2.386562e-02 3 1  ON 2
ci_004                 2.118433e-02 3 1  ON 3
ci_005                 2.182575e-02 3 1  ON 4
ci_006                -1.870801e-02 3 1  ON 5
ci_007                -1.867046e-02 3 1  ON 6
ci_008                -8.017237e-03 3 1  ON 7
ci_009                -1.424786e-02 3 1  ON 8
ci_010                -9.562333e-03 3 1  ON 9
ci_011                -9.589225e-03 3 1  ON 10
ci_012                -9.605796e-03 3 1  ON 11
ci_013                -1.953069e-02 3 1  ON 12
ci_014                 1.133128e-02 3 1  ON 13
ci_015                 1.124751e-02 3 1  ON 14
ci_016                 1.596652e-02 3 1  ON 15
ci_017                 1.587757e-02 3 1  ON 16
ci_018                 9.336703e-03 3 1  ON 17
ci_019                 9.327459e-03 3 1  ON 18
ci_020                 1.492814e-02 3 1  ON 19
ci_021                 1.531958e-02 3 1  ON 20
ci_022                 8.546368e-03 3 1  ON 21
ci_023                 8.494895e-03 3 1  ON 22
ci_024                 8.580126e-03 3 1  ON 23
ci_025                 8.948567e-03 3 1  ON 24
ci_026                 1.019528e-02 3 1  ON 25
ci_027                 1.026399e-02 3 1  ON 26
ci_028                -1.456623e-02 3 1  ON 27
ci_029                -1.544733e-02 3 1  ON 28
ci_030                -8.770020e-03 3 1  ON 29
ci_031                -8.786388e-03 3 1  ON 30
ci_032                -1.450780e-02 3 1  ON 31
ci_033                 5.300126e-03 3 1  ON 32
ci_034                 5.146290e-03 3 1  ON 33
ci_035                -3.544580e-03 3 1  ON 34
ci_036                -1.188456e-02 3 1  ON 35
ci_037                -1.182707e-02 3 1  ON 36
ci_038                 1.114540e-03 3 1  ON 37
ci_039                 1.306817e-03 3 1  ON 38
ci_040                -1.885868e-03 3 1  ON 39
ci_041                 8.174789e-03 3 1  ON 40
ci_042                 8.411143e-03 3 1  ON 41
ci_043                -2.559725e-03 3 1  ON 42
ci_044                -4.033684e-03 3 1  ON 43
ci_045                -2.032350e-03 3 1  ON 44
ci_046                 4.913280e-03 3 1  ON 45
ci_047                 4.851470e-03 3 1  ON 46
ci_048                -1.254564e-02 3 1  ON 47
ci_049                -1.284068e-02 3 1  ON 48
ci_050                 3.100250e-03 3 1  ON 49
ci_051                 2.956881e-03 3 1  ON 50
ci_052                -2.217520e-03 3 1  ON 51
ci_053                -2.620471e-03 3 1  ON 52
ci_054                -2.385585e-03 3 1  ON 53
ci_055                -2.663252e-03 3 1  ON 54
ci_056                 4.797048e-03 3 1  ON 55
ci_057                 4.738437e-03 3 1  ON 56
ci_058                -2.025368e-03 3 1  ON 57
ci_059                -2.088972e-03 3 1  ON 58
ci_060                 4.924082e-03 3 1  ON 59
ci_061                 5.355560e-03 3 1  ON 60
ci_062                -3.103967e-03 3 1  ON 61
ci_063                -2.952248e-03 3 1  ON 62
ci_064                -2.478321e-03 3 1  ON 63
ci_065                -3.484897e-03 3 1  ON 64
ci_066                 4.150721e-03 3 1  ON 65
ci_067                 4.148403e-03 3 1  ON 66
ci_068                -4.269083e-03 3 1  ON 67
ci_069                -4.595862e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2061
    reference variance = 0.320584
====================================================
  Execution time = 1.3646e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0794e-01
  Total weights = 1.957430652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289256076415
                                         uncertainty =       0.002101779060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289256076415
                                         uncertainty =       0.002101779060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380341603
  error estimate for blocks of size 2^( 2) =       0.000391703243
  error estimate for blocks of size 2^( 3) =       0.000401463831
  error estimate for blocks of size 2^( 4) =       0.000409515448
  error estimate for blocks of size 2^( 5) =       0.000414153938
  error estimate for blocks of size 2^( 6) =       0.000416577967
  error estimate for blocks of size 2^( 7) =       0.000415234830

      target function =      -0.900375188332
              le_mean =     -17.214882434716
             les_mean =     296.660114658027
             stat err =       0.000413870546
             autocorr =       1.184080893613
   target nu stat err =       0.000413870546
   target dn stat err =       0.004079451458
      target stat err =       0.006222821869
              std dev =       0.537884253790
             le_variance =       0.289319470475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488243472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900417079434       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900742451596       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900784055667       residual = 7.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900800260583       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900801577023       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900802086915       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900802145382       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900802153612       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900802177007       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900802165895       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900802161270       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.190663e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900417079434       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900516260682       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900528485869       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900532995892       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900533337707       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900533463203       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900533481184       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900533481378       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900533487772       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900533484867       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.826247e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900417079434       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900443312441       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900446507676       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900447665981       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900447751910       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900447782857       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900447787646       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900447787560       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900447789173       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900447788443       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.780051e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6193e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -3.822908e-02 3 1  ON 0
ci_002                -2.911645e-02 3 1  ON 1
ci_003                -2.385043e-02 3 1  ON 2
ci_004                 2.119340e-02 3 1  ON 3
ci_005                 2.174972e-02 3 1  ON 4
ci_006                -1.874798e-02 3 1  ON 5
ci_007                -1.866096e-02 3 1  ON 6
ci_008                -7.885838e-03 3 1  ON 7
ci_009                -1.420972e-02 3 1  ON 8
ci_010                -9.476196e-03 3 1  ON 9
ci_011                -9.696331e-03 3 1  ON 10
ci_012                -9.511283e-03 3 1  ON 11
ci_013                -1.955823e-02 3 1  ON 12
ci_014                 1.129648e-02 3 1  ON 13
ci_015                 1.119694e-02 3 1  ON 14
ci_016                 1.588176e-02 3 1  ON 15
ci_017                 1.589382e-02 3 1  ON 16
ci_018                 9.231386e-03 3 1  ON 17
ci_019                 9.217152e-03 3 1  ON 18
ci_020                 1.500922e-02 3 1  ON 19
ci_021                 1.527620e-02 3 1  ON 20
ci_022                 8.474269e-03 3 1  ON 21
ci_023                 8.496474e-03 3 1  ON 22
ci_024                 8.397501e-03 3 1  ON 23
ci_025                 8.888268e-03 3 1  ON 24
ci_026                 1.004931e-02 3 1  ON 25
ci_027                 1.018774e-02 3 1  ON 26
ci_028                -1.449139e-02 3 1  ON 27
ci_029                -1.543514e-02 3 1  ON 28
ci_030                -8.722833e-03 3 1  ON 29
ci_031                -8.646970e-03 3 1  ON 30
ci_032                -1.452976e-02 3 1  ON 31
ci_033                 5.276228e-03 3 1  ON 32
ci_034                 5.124344e-03 3 1  ON 33
ci_035                -3.525220e-03 3 1  ON 34
ci_036                -1.181328e-02 3 1  ON 35
ci_037                -1.171078e-02 3 1  ON 36
ci_038                 1.094487e-03 3 1  ON 37
ci_039                 1.305926e-03 3 1  ON 38
ci_040                -1.882948e-03 3 1  ON 39
ci_041                 8.155994e-03 3 1  ON 40
ci_042                 8.355353e-03 3 1  ON 41
ci_043                -2.555189e-03 3 1  ON 42
ci_044                -4.075052e-03 3 1  ON 43
ci_045                -2.016843e-03 3 1  ON 44
ci_046                 4.857716e-03 3 1  ON 45
ci_047                 4.808930e-03 3 1  ON 46
ci_048                -1.256480e-02 3 1  ON 47
ci_049                -1.285321e-02 3 1  ON 48
ci_050                 3.049705e-03 3 1  ON 49
ci_051                 2.912068e-03 3 1  ON 50
ci_052                -2.165471e-03 3 1  ON 51
ci_053                -2.459470e-03 3 1  ON 52
ci_054                -2.410426e-03 3 1  ON 53
ci_055                -2.661726e-03 3 1  ON 54
ci_056                 4.778654e-03 3 1  ON 55
ci_057                 4.778296e-03 3 1  ON 56
ci_058                -2.025885e-03 3 1  ON 57
ci_059                -1.969224e-03 3 1  ON 58
ci_060                 4.898407e-03 3 1  ON 59
ci_061                 5.235408e-03 3 1  ON 60
ci_062                -3.140252e-03 3 1  ON 61
ci_063                -2.959380e-03 3 1  ON 62
ci_064                -2.455076e-03 3 1  ON 63
ci_065                -3.474258e-03 3 1  ON 64
ci_066                 4.122646e-03 3 1  ON 65
ci_067                 4.166546e-03 3 1  ON 66
ci_068                -4.273075e-03 3 1  ON 67
ci_069                -4.442670e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.338631
====================================================
  Execution time = 1.3358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9938e-01
  Total weights = 1.9577e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285152702964
                                         uncertainty =       0.001508355805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285152702964
                                         uncertainty =       0.001508355805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377655829
  error estimate for blocks of size 2^( 2) =       0.000388614177
  error estimate for blocks of size 2^( 3) =       0.000398728294
  error estimate for blocks of size 2^( 4) =       0.000406048884
  error estimate for blocks of size 2^( 5) =       0.000410777087
  error estimate for blocks of size 2^( 6) =       0.000414346836
  error estimate for blocks of size 2^( 7) =       0.000415166352

      target function =      -0.912435454347
              le_mean =     -17.215069345781
             les_mean =     296.658700483536
             stat err =       0.000411584790
             autocorr =       1.187753312019
   target nu stat err =       0.000411584790
   target dn stat err =       0.003510830540
      target stat err =       0.005512079379
              std dev =       0.534085994910
             le_variance =       0.285247849959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285157595584
                                         uncertainty =       0.001516368754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285157595584
                                         uncertainty =       0.001516368754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377658409
  error estimate for blocks of size 2^( 2) =       0.000388692638
  error estimate for blocks of size 2^( 3) =       0.000398879091
  error estimate for blocks of size 2^( 4) =       0.000406255530
  error estimate for blocks of size 2^( 5) =       0.000411011753
  error estimate for blocks of size 2^( 6) =       0.000414598105
  error estimate for blocks of size 2^( 7) =       0.000415452947

      target function =      -0.909799187349
              le_mean =     -17.215065932219
             les_mean =     296.660270807010
             stat err =       0.000411829584
             autocorr =       1.189150335100
   target nu stat err =       0.000411829584
   target dn stat err =       0.004282885716
      target stat err =       0.006667919203
              std dev =       0.534089644416
             le_variance =       0.285251748272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285135964267
                                         uncertainty =       0.001512204954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285135964267
                                         uncertainty =       0.001512204954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377644361
  error estimate for blocks of size 2^( 2) =       0.000388648252
  error estimate for blocks of size 2^( 3) =       0.000398805829
  error estimate for blocks of size 2^( 4) =       0.000406158843
  error estimate for blocks of size 2^( 5) =       0.000410904386
  error estimate for blocks of size 2^( 6) =       0.000414486653
  error estimate for blocks of size 2^( 7) =       0.000415327745

      target function =      -0.906900477187
              le_mean =     -17.215065891972
             les_mean =     296.662141023991
             stat err =       0.000411719407
             autocorr =       1.188602581701
   target nu stat err =       0.000411719407
   target dn stat err =       0.004728147772
      target stat err =       0.007307326423
              std dev =       0.534069776397
             le_variance =       0.285230526061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285147177403
                                         uncertainty =       0.001508731847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285147177403
                                         uncertainty =       0.001508731847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377652121
  error estimate for blocks of size 2^( 2) =       0.000388616292
  error estimate for blocks of size 2^( 3) =       0.000398736002
  error estimate for blocks of size 2^( 4) =       0.000406061177
  error estimate for blocks of size 2^( 5) =       0.000410791456
  error estimate for blocks of size 2^( 6) =       0.000414362052
  error estimate for blocks of size 2^( 7) =       0.000415184850

      target function =      -0.913706408085
              le_mean =     -17.215068386713
             les_mean =     296.657852939805
             stat err =       0.000411599884
             autocorr =       1.187863750058
   target nu stat err =       0.000411599884
   target dn stat err =       0.003465998167
      target stat err =       0.005457878097
              std dev =       0.534080752082
             le_variance =       0.285242249745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912435454347        initial
     2.5000e-01     2.5000e+00             6.1907e-04        -0.909799187349
     1.0000e+00     1.0000e+01             1.8262e-04        -0.906900477187
     4.0000e+00     4.0000e+01             4.7801e-05        -0.913706408085  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2872e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -3.828672e-02 3 1  ON 0
ci_002                -2.912489e-02 3 1  ON 1
ci_003                -2.386194e-02 3 1  ON 2
ci_004                 2.118693e-02 3 1  ON 3
ci_005                 2.180593e-02 3 1  ON 4
ci_006                -1.871836e-02 3 1  ON 5
ci_007                -1.866794e-02 3 1  ON 6
ci_008                -7.982502e-03 3 1  ON 7
ci_009                -1.423783e-02 3 1  ON 8
ci_010                -9.539660e-03 3 1  ON 9
ci_011                -9.617400e-03 3 1  ON 10
ci_012                -9.580885e-03 3 1  ON 11
ci_013                -1.953786e-02 3 1  ON 12
ci_014                 1.132201e-02 3 1  ON 13
ci_015                 1.123425e-02 3 1  ON 14
ci_016                 1.594439e-02 3 1  ON 15
ci_017                 1.588176e-02 3 1  ON 16
ci_018                 9.308940e-03 3 1  ON 17
ci_019                 9.298233e-03 3 1  ON 18
ci_020                 1.494941e-02 3 1  ON 19
ci_021                 1.530841e-02 3 1  ON 20
ci_022                 8.527265e-03 3 1  ON 21
ci_023                 8.495209e-03 3 1  ON 22
ci_024                 8.532325e-03 3 1  ON 23
ci_025                 8.932825e-03 3 1  ON 24
ci_026                 1.015672e-02 3 1  ON 25
ci_027                 1.024394e-02 3 1  ON 26
ci_028                -1.454666e-02 3 1  ON 27
ci_029                -1.544416e-02 3 1  ON 28
ci_030                -8.757524e-03 3 1  ON 29
ci_031                -8.749518e-03 3 1  ON 30
ci_032                -1.451354e-02 3 1  ON 31
ci_033                 5.293856e-03 3 1  ON 32
ci_034                 5.140602e-03 3 1  ON 33
ci_035                -3.539476e-03 3 1  ON 34
ci_036                -1.186589e-02 3 1  ON 35
ci_037                -1.179646e-02 3 1  ON 36
ci_038                 1.109250e-03 3 1  ON 37
ci_039                 1.306587e-03 3 1  ON 38
ci_040                -1.885109e-03 3 1  ON 39
ci_041                 8.169900e-03 3 1  ON 40
ci_042                 8.396400e-03 3 1  ON 41
ci_043                -2.558529e-03 3 1  ON 42
ci_044                -4.044570e-03 3 1  ON 43
ci_045                -2.028262e-03 3 1  ON 44
ci_046                 4.898706e-03 3 1  ON 45
ci_047                 4.840309e-03 3 1  ON 46
ci_048                -1.255066e-02 3 1  ON 47
ci_049                -1.284414e-02 3 1  ON 48
ci_050                 3.086848e-03 3 1  ON 49
ci_051                 2.945003e-03 3 1  ON 50
ci_052                -2.203777e-03 3 1  ON 51
ci_053                -2.577889e-03 3 1  ON 52
ci_054                -2.392202e-03 3 1  ON 53
ci_055                -2.662879e-03 3 1  ON 54
ci_056                 4.792209e-03 3 1  ON 55
ci_057                 4.748933e-03 3 1  ON 56
ci_058                -2.025452e-03 3 1  ON 57
ci_059                -2.057312e-03 3 1  ON 58
ci_060                 4.917354e-03 3 1  ON 59
ci_061                 5.324028e-03 3 1  ON 60
ci_062                -3.113631e-03 3 1  ON 61
ci_063                -2.954159e-03 3 1  ON 62
ci_064                -2.472155e-03 3 1  ON 63
ci_065                -3.482089e-03 3 1  ON 64
ci_066                 4.143322e-03 3 1  ON 65
ci_067                 4.153173e-03 3 1  ON 66
ci_068                -4.270104e-03 3 1  ON 67
ci_069                -4.555663e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.598573
====================================================
  Execution time = 1.3893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0158e-01
  Total weights = 1.957247255e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287359322695
                                         uncertainty =       0.001828574269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287359322695
                                         uncertainty =       0.001828574269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379111716
  error estimate for blocks of size 2^( 2) =       0.000390178017
  error estimate for blocks of size 2^( 3) =       0.000400426498
  error estimate for blocks of size 2^( 4) =       0.000407936742
  error estimate for blocks of size 2^( 5) =       0.000412081083
  error estimate for blocks of size 2^( 6) =       0.000415330711
  error estimate for blocks of size 2^( 7) =       0.000416401108

      target function =      -0.910162845690
              le_mean =     -17.214266031798
             les_mean =     296.632534834959
             stat err =       0.000412937411
             autocorr =       1.186407955572
   target nu stat err =       0.000412937411
   target dn stat err =       0.002983498634
      target stat err =       0.004668935080
              std dev =       0.536144930004
             le_variance =       0.287451385969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426603180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910185840776       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910280352966       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910291126086       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910294125045       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910294630414       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910294573483       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910294578931       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910294594100       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910294605944       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910294603177       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.172434e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910185840776       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910210821437       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910213632832       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910214401182       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910214529524       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910214513732       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910214514927       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910214518760       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910214521710       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910214521012       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 5.708530e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910185840776       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910192176606       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910192887220       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910193080472       residual = 9.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910193112678       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910193108626       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910193108913       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910193109874       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910193110610       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910193110435       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.445598e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6442e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -3.825391e-02 3 1  ON 0
ci_002                -2.911353e-02 3 1  ON 1
ci_003                -2.387257e-02 3 1  ON 2
ci_004                 2.115689e-02 3 1  ON 3
ci_005                 2.179780e-02 3 1  ON 4
ci_006                -1.870208e-02 3 1  ON 5
ci_007                -1.866080e-02 3 1  ON 6
ci_008                -7.980518e-03 3 1  ON 7
ci_009                -1.420528e-02 3 1  ON 8
ci_010                -9.527945e-03 3 1  ON 9
ci_011                -9.597291e-03 3 1  ON 10
ci_012                -9.583050e-03 3 1  ON 11
ci_013                -1.952718e-02 3 1  ON 12
ci_014                 1.130124e-02 3 1  ON 13
ci_015                 1.122760e-02 3 1  ON 14
ci_016                 1.594189e-02 3 1  ON 15
ci_017                 1.588363e-02 3 1  ON 16
ci_018                 9.302309e-03 3 1  ON 17
ci_019                 9.293857e-03 3 1  ON 18
ci_020                 1.496182e-02 3 1  ON 19
ci_021                 1.528996e-02 3 1  ON 20
ci_022                 8.516334e-03 3 1  ON 21
ci_023                 8.480805e-03 3 1  ON 22
ci_024                 8.578959e-03 3 1  ON 23
ci_025                 8.922687e-03 3 1  ON 24
ci_026                 1.015512e-02 3 1  ON 25
ci_027                 1.023275e-02 3 1  ON 26
ci_028                -1.453802e-02 3 1  ON 27
ci_029                -1.544628e-02 3 1  ON 28
ci_030                -8.746641e-03 3 1  ON 29
ci_031                -8.755674e-03 3 1  ON 30
ci_032                -1.450250e-02 3 1  ON 31
ci_033                 5.256776e-03 3 1  ON 32
ci_034                 5.083517e-03 3 1  ON 33
ci_035                -3.540731e-03 3 1  ON 34
ci_036                -1.181386e-02 3 1  ON 35
ci_037                -1.178689e-02 3 1  ON 36
ci_038                 1.115229e-03 3 1  ON 37
ci_039                 1.298780e-03 3 1  ON 38
ci_040                -1.859408e-03 3 1  ON 39
ci_041                 8.178386e-03 3 1  ON 40
ci_042                 8.387540e-03 3 1  ON 41
ci_043                -2.545909e-03 3 1  ON 42
ci_044                -4.054652e-03 3 1  ON 43
ci_045                -2.013779e-03 3 1  ON 44
ci_046                 4.887485e-03 3 1  ON 45
ci_047                 4.840147e-03 3 1  ON 46
ci_048                -1.255877e-02 3 1  ON 47
ci_049                -1.284167e-02 3 1  ON 48
ci_050                 3.077892e-03 3 1  ON 49
ci_051                 2.957916e-03 3 1  ON 50
ci_052                -2.216424e-03 3 1  ON 51
ci_053                -2.571446e-03 3 1  ON 52
ci_054                -2.387030e-03 3 1  ON 53
ci_055                -2.664018e-03 3 1  ON 54
ci_056                 4.783507e-03 3 1  ON 55
ci_057                 4.753819e-03 3 1  ON 56
ci_058                -2.031430e-03 3 1  ON 57
ci_059                -2.046634e-03 3 1  ON 58
ci_060                 4.914056e-03 3 1  ON 59
ci_061                 5.329062e-03 3 1  ON 60
ci_062                -3.073975e-03 3 1  ON 61
ci_063                -2.968388e-03 3 1  ON 62
ci_064                -2.472805e-03 3 1  ON 63
ci_065                -3.482357e-03 3 1  ON 64
ci_066                 4.140706e-03 3 1  ON 65
ci_067                 4.129732e-03 3 1  ON 66
ci_068                -4.295546e-03 3 1  ON 67
ci_069                -4.544309e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3038
    reference variance = 0.251041
====================================================
  Execution time = 1.5635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2042e-01
  Total weights = 1.9573e+06
  Execution time = 1.8613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285987112859
                                         uncertainty =       0.001561877037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285987112859
                                         uncertainty =       0.001561877037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378157236
  error estimate for blocks of size 2^( 2) =       0.000389360591
  error estimate for blocks of size 2^( 3) =       0.000399630998
  error estimate for blocks of size 2^( 4) =       0.000407660183
  error estimate for blocks of size 2^( 5) =       0.000411284598
  error estimate for blocks of size 2^( 6) =       0.000413588920
  error estimate for blocks of size 2^( 7) =       0.000415434704

      target function =      -0.877346485749
              le_mean =     -17.214675152880
             les_mean =     296.667723000995
             stat err =       0.000411992101
             autocorr =       1.186951435451
   target nu stat err =       0.000411992101
   target dn stat err =       0.023281426876
      target stat err =       0.033549354550
              std dev =       0.534795091684
             le_variance =       0.286005790089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285938111098
                                         uncertainty =       0.001554342235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285938111098
                                         uncertainty =       0.001554342235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378125462
  error estimate for blocks of size 2^( 2) =       0.000389341877
  error estimate for blocks of size 2^( 3) =       0.000399626306
  error estimate for blocks of size 2^( 4) =       0.000407667025
  error estimate for blocks of size 2^( 5) =       0.000411296660
  error estimate for blocks of size 2^( 6) =       0.000413604529
  error estimate for blocks of size 2^( 7) =       0.000415441226

      target function =      -0.888291447842
              le_mean =     -17.214675892865
             les_mean =     296.660675458585
             stat err =       0.000412002360
             autocorr =       1.187210048339
   target nu stat err =       0.000412002360
   target dn stat err =       0.016430015922
      target stat err =       0.024258055867
              std dev =       0.534750155963
             le_variance =       0.285957729303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285958913153
                                         uncertainty =       0.001557767736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285958913153
                                         uncertainty =       0.001557767736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378138918
  error estimate for blocks of size 2^( 2) =       0.000389348556
  error estimate for blocks of size 2^( 3) =       0.000399626264
  error estimate for blocks of size 2^( 4) =       0.000407661411
  error estimate for blocks of size 2^( 5) =       0.000411288809
  error estimate for blocks of size 2^( 6) =       0.000413594878
  error estimate for blocks of size 2^( 7) =       0.000415435054

      target function =      -0.876045958971
              le_mean =     -17.214675276743
             les_mean =     296.668875289628
             stat err =       0.000411995038
             autocorr =       1.187083360694
   target nu stat err =       0.000411995038
   target dn stat err =       0.019870629640
      target stat err =       0.028540222031
              std dev =       0.534769185894
             le_variance =       0.285978082182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285983207536
                                         uncertainty =       0.001561337780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285983207536
                                         uncertainty =       0.001561337780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378154695
  error estimate for blocks of size 2^( 2) =       0.000389358921
  error estimate for blocks of size 2^( 3) =       0.000399630252
  error estimate for blocks of size 2^( 4) =       0.000407660208
  error estimate for blocks of size 2^( 5) =       0.000411284971
  error estimate for blocks of size 2^( 6) =       0.000413589546
  error estimate for blocks of size 2^( 7) =       0.000415434730

      target function =      -0.878281587701
              le_mean =     -17.214675165775
             les_mean =     296.667117212619
             stat err =       0.000411992364
             autocorr =       1.186968900833
   target nu stat err =       0.000411992364
   target dn stat err =       0.022699313782
      target stat err =       0.032778336498
              std dev =       0.534791498022
             le_variance =       0.286001946357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877346485749        initial
     1.0000e+00     1.0000e+01             2.1724e-04        -0.888291447842  <--
     4.0000e+00     4.0000e+01             5.7085e-05        -0.876045958971
     1.6000e+01     1.6000e+02             1.4456e-05        -0.878281587701

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.5064e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -3.816086e-02 3 1  ON 0
ci_002                -2.908138e-02 3 1  ON 1
ci_003                -2.390118e-02 3 1  ON 2
ci_004                 2.107207e-02 3 1  ON 3
ci_005                 2.177459e-02 3 1  ON 4
ci_006                -1.865608e-02 3 1  ON 5
ci_007                -1.864059e-02 3 1  ON 6
ci_008                -7.974728e-03 3 1  ON 7
ci_009                -1.411427e-02 3 1  ON 8
ci_010                -9.494897e-03 3 1  ON 9
ci_011                -9.540957e-03 3 1  ON 10
ci_012                -9.589044e-03 3 1  ON 11
ci_013                -1.949694e-02 3 1  ON 12
ci_014                 1.124303e-02 3 1  ON 13
ci_015                 1.120885e-02 3 1  ON 14
ci_016                 1.593513e-02 3 1  ON 15
ci_017                 1.588925e-02 3 1  ON 16
ci_018                 9.283555e-03 3 1  ON 17
ci_019                 9.281850e-03 3 1  ON 18
ci_020                 1.499690e-02 3 1  ON 19
ci_021                 1.523786e-02 3 1  ON 20
ci_022                 8.485676e-03 3 1  ON 21
ci_023                 8.440104e-03 3 1  ON 22
ci_024                 8.709308e-03 3 1  ON 23
ci_025                 8.894275e-03 3 1  ON 24
ci_026                 1.015021e-02 3 1  ON 25
ci_027                 1.020150e-02 3 1  ON 26
ci_028                -1.451400e-02 3 1  ON 27
ci_029                -1.545232e-02 3 1  ON 28
ci_030                -8.716540e-03 3 1  ON 29
ci_031                -8.772928e-03 3 1  ON 30
ci_032                -1.447141e-02 3 1  ON 31
ci_033                 5.152502e-03 3 1  ON 32
ci_034                 4.923359e-03 3 1  ON 33
ci_035                -3.544258e-03 3 1  ON 34
ci_036                -1.166912e-02 3 1  ON 35
ci_037                -1.176008e-02 3 1  ON 36
ci_038                 1.131933e-03 3 1  ON 37
ci_039                 1.277018e-03 3 1  ON 38
ci_040                -1.787964e-03 3 1  ON 39
ci_041                 8.201970e-03 3 1  ON 40
ci_042                 8.362977e-03 3 1  ON 41
ci_043                -2.510656e-03 3 1  ON 42
ci_044                -4.082757e-03 3 1  ON 43
ci_045                -1.973426e-03 3 1  ON 44
ci_046                 4.855949e-03 3 1  ON 45
ci_047                 4.839707e-03 3 1  ON 46
ci_048                -1.258180e-02 3 1  ON 47
ci_049                -1.283512e-02 3 1  ON 48
ci_050                 3.053072e-03 3 1  ON 49
ci_051                 2.993739e-03 3 1  ON 50
ci_052                -2.251842e-03 3 1  ON 51
ci_053                -2.553569e-03 3 1  ON 52
ci_054                -2.372630e-03 3 1  ON 53
ci_055                -2.667062e-03 3 1  ON 54
ci_056                 4.759191e-03 3 1  ON 55
ci_057                 4.767464e-03 3 1  ON 56
ci_058                -2.048161e-03 3 1  ON 57
ci_059                -2.017023e-03 3 1  ON 58
ci_060                 4.904878e-03 3 1  ON 59
ci_061                 5.343184e-03 3 1  ON 60
ci_062                -2.963554e-03 3 1  ON 61
ci_063                -3.008172e-03 3 1  ON 62
ci_064                -2.474592e-03 3 1  ON 63
ci_065                -3.483120e-03 3 1  ON 64
ci_066                 4.133685e-03 3 1  ON 65
ci_067                 4.064711e-03 3 1  ON 66
ci_068                -4.367127e-03 3 1  ON 67
ci_069                -4.512474e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2233
    reference variance = 0.679265
====================================================
  Execution time = 1.3588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0194e-01
  Total weights = 1.957673327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287689613633
                                         uncertainty =       0.002127384757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287689613633
                                         uncertainty =       0.002127384757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379282481
  error estimate for blocks of size 2^( 2) =       0.000390710840
  error estimate for blocks of size 2^( 3) =       0.000401252843
  error estimate for blocks of size 2^( 4) =       0.000408994082
  error estimate for blocks of size 2^( 5) =       0.000414633652
  error estimate for blocks of size 2^( 6) =       0.000416950810
  error estimate for blocks of size 2^( 7) =       0.000417203068

      target function =      -0.909598328604
              le_mean =     -17.214579256904
             les_mean =     296.643676441205
             stat err =       0.000414445403
             autocorr =       1.194013087476
   target nu stat err =       0.000414445403
   target dn stat err =       0.002831974732
      target stat err =       0.004434866942
              std dev =       0.536386428537
             le_variance =       0.287710400719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721457925690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909618940551       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909761472959       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909787189784       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909793975261       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909794298597       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909794638238       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909794790631       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909794779320       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909794745207       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909794739842       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.956156e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909618940551       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909662352023       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909669880631       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909671783343       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909671854877       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909671938328       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909671977917       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909671977701       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909671967523       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909671966082       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.485758e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909618940551       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909630419774       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909632385284       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909632875298       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909632892210       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909632912753       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909632922741       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909632922878       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909632920243       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909632919887       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.908920e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6118e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -3.806735e-02 3 1  ON 0
ci_002                -2.901913e-02 3 1  ON 1
ci_003                -2.388837e-02 3 1  ON 2
ci_004                 2.107976e-02 3 1  ON 3
ci_005                 2.176265e-02 3 1  ON 4
ci_006                -1.863858e-02 3 1  ON 5
ci_007                -1.863748e-02 3 1  ON 6
ci_008                -7.937934e-03 3 1  ON 7
ci_009                -1.412110e-02 3 1  ON 8
ci_010                -9.346321e-03 3 1  ON 9
ci_011                -9.496828e-03 3 1  ON 10
ci_012                -9.537858e-03 3 1  ON 11
ci_013                -1.945083e-02 3 1  ON 12
ci_014                 1.122722e-02 3 1  ON 13
ci_015                 1.118627e-02 3 1  ON 14
ci_016                 1.596572e-02 3 1  ON 15
ci_017                 1.586100e-02 3 1  ON 16
ci_018                 9.232430e-03 3 1  ON 17
ci_019                 9.268705e-03 3 1  ON 18
ci_020                 1.503972e-02 3 1  ON 19
ci_021                 1.528644e-02 3 1  ON 20
ci_022                 8.446163e-03 3 1  ON 21
ci_023                 8.421473e-03 3 1  ON 22
ci_024                 8.728598e-03 3 1  ON 23
ci_025                 8.861033e-03 3 1  ON 24
ci_026                 1.015739e-02 3 1  ON 25
ci_027                 1.008056e-02 3 1  ON 26
ci_028                -1.449243e-02 3 1  ON 27
ci_029                -1.535455e-02 3 1  ON 28
ci_030                -8.682675e-03 3 1  ON 29
ci_031                -8.718660e-03 3 1  ON 30
ci_032                -1.446915e-02 3 1  ON 31
ci_033                 5.048406e-03 3 1  ON 32
ci_034                 4.913822e-03 3 1  ON 33
ci_035                -3.514978e-03 3 1  ON 34
ci_036                -1.157923e-02 3 1  ON 35
ci_037                -1.169809e-02 3 1  ON 36
ci_038                 1.103763e-03 3 1  ON 37
ci_039                 1.287991e-03 3 1  ON 38
ci_040                -1.752854e-03 3 1  ON 39
ci_041                 8.231291e-03 3 1  ON 40
ci_042                 8.319034e-03 3 1  ON 41
ci_043                -2.503288e-03 3 1  ON 42
ci_044                -4.109475e-03 3 1  ON 43
ci_045                -1.953291e-03 3 1  ON 44
ci_046                 4.858769e-03 3 1  ON 45
ci_047                 4.810134e-03 3 1  ON 46
ci_048                -1.251541e-02 3 1  ON 47
ci_049                -1.284735e-02 3 1  ON 48
ci_050                 2.983735e-03 3 1  ON 49
ci_051                 2.925622e-03 3 1  ON 50
ci_052                -2.274382e-03 3 1  ON 51
ci_053                -2.503316e-03 3 1  ON 52
ci_054                -2.396252e-03 3 1  ON 53
ci_055                -2.608604e-03 3 1  ON 54
ci_056                 4.748109e-03 3 1  ON 55
ci_057                 4.767814e-03 3 1  ON 56
ci_058                -2.089236e-03 3 1  ON 57
ci_059                -2.071985e-03 3 1  ON 58
ci_060                 4.901881e-03 3 1  ON 59
ci_061                 5.329296e-03 3 1  ON 60
ci_062                -2.932349e-03 3 1  ON 61
ci_063                -2.992299e-03 3 1  ON 62
ci_064                -2.413724e-03 3 1  ON 63
ci_065                -3.471940e-03 3 1  ON 64
ci_066                 4.111870e-03 3 1  ON 65
ci_067                 4.079509e-03 3 1  ON 66
ci_068                -4.374706e-03 3 1  ON 67
ci_069                -4.380582e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.248681
====================================================
  Execution time = 1.3261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9801e-01
  Total weights = 1.9580e+06
  Execution time = 1.8660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284956395078
                                         uncertainty =       0.001635036393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284956395078
                                         uncertainty =       0.001635036393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377476161
  error estimate for blocks of size 2^( 2) =       0.000388856902
  error estimate for blocks of size 2^( 3) =       0.000399354190
  error estimate for blocks of size 2^( 4) =       0.000406932273
  error estimate for blocks of size 2^( 5) =       0.000412225771
  error estimate for blocks of size 2^( 6) =       0.000414191670
  error estimate for blocks of size 2^( 7) =       0.000416049546

      target function =      -0.915389739330
              le_mean =     -17.215026600963
             les_mean =     296.655350604808
             stat err =       0.000412349815
             autocorr =       1.193307989642
   target nu stat err =       0.000412349815
   target dn stat err =       0.002290859652
      target stat err =       0.003658901725
              std dev =       0.533831906976
             le_variance =       0.284976504906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284901567676
                                         uncertainty =       0.001629398381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284901567676
                                         uncertainty =       0.001629398381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377439727
  error estimate for blocks of size 2^( 2) =       0.000388872484
  error estimate for blocks of size 2^( 3) =       0.000399413980
  error estimate for blocks of size 2^( 4) =       0.000407022526
  error estimate for blocks of size 2^( 5) =       0.000412315568
  error estimate for blocks of size 2^( 6) =       0.000414301273
  error estimate for blocks of size 2^( 7) =       0.000416140409

      target function =      -0.915710653717
              le_mean =     -17.215025544259
             les_mean =     296.655109631651
             stat err =       0.000412444944
             autocorr =       1.194089142869
   target nu stat err =       0.000412444944
   target dn stat err =       0.002279111304
      target stat err =       0.003643366891
              std dev =       0.533780380906
             le_variance =       0.284921495040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284915729816
                                         uncertainty =       0.001631495264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284915729816
                                         uncertainty =       0.001631495264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377449151
  error estimate for blocks of size 2^( 2) =       0.000388860991
  error estimate for blocks of size 2^( 3) =       0.000399384728
  error estimate for blocks of size 2^( 4) =       0.000406980968
  error estimate for blocks of size 2^( 5) =       0.000412273935
  error estimate for blocks of size 2^( 6) =       0.000414251965
  error estimate for blocks of size 2^( 7) =       0.000416098472

      target function =      -0.915544332732
              le_mean =     -17.215025041279
             les_mean =     296.655198365614
             stat err =       0.000412401335
             autocorr =       1.193777030066
   target nu stat err =       0.000412401335
   target dn stat err =       0.002283525623
      target stat err =       0.003648839895
              std dev =       0.533793708703
             le_variance =       0.284935723451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284949749341
                                         uncertainty =       0.001634532831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284949749341
                                         uncertainty =       0.001634532831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377471749
  error estimate for blocks of size 2^( 2) =       0.000388856710
  error estimate for blocks of size 2^( 3) =       0.000399357570
  error estimate for blocks of size 2^( 4) =       0.000406938243
  error estimate for blocks of size 2^( 5) =       0.000412231693
  error estimate for blocks of size 2^( 6) =       0.000414199297
  error estimate for blocks of size 2^( 7) =       0.000416055364

      target function =      -0.905007465211
              le_mean =     -17.215026378604
             les_mean =     296.661984359920
             stat err =       0.000412356149
             autocorr =       1.193372547663
   target nu stat err =       0.000412356149
   target dn stat err =       0.006364538333
      target stat err =       0.009775234310
              std dev =       0.533825667365
             le_variance =       0.284969843138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915389739330        initial
     2.5000e-01     2.5000e+00             4.9562e-04        -0.915710653717  <--
     1.0000e+00     1.0000e+01             1.4858e-04        -0.915544332732
     4.0000e+00     4.0000e+01             3.9089e-05        -0.905007465211

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2687e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -3.784004e-02 3 1  ON 0
ci_002                -2.887013e-02 3 1  ON 1
ci_003                -2.384922e-02 3 1  ON 2
ci_004                 2.110140e-02 3 1  ON 3
ci_005                 2.172629e-02 3 1  ON 4
ci_006                -1.859732e-02 3 1  ON 5
ci_007                -1.863190e-02 3 1  ON 6
ci_008                -7.852210e-03 3 1  ON 7
ci_009                -1.413679e-02 3 1  ON 8
ci_010                -8.999281e-03 3 1  ON 9
ci_011                -9.394613e-03 3 1  ON 10
ci_012                -9.418148e-03 3 1  ON 11
ci_013                -1.933807e-02 3 1  ON 12
ci_014                 1.118769e-02 3 1  ON 13
ci_015                 1.113107e-02 3 1  ON 14
ci_016                 1.604209e-02 3 1  ON 15
ci_017                 1.579386e-02 3 1  ON 16
ci_018                 9.117837e-03 3 1  ON 17
ci_019                 9.241734e-03 3 1  ON 18
ci_020                 1.514487e-02 3 1  ON 19
ci_021                 1.540156e-02 3 1  ON 20
ci_022                 8.355706e-03 3 1  ON 21
ci_023                 8.377321e-03 3 1  ON 22
ci_024                 8.772589e-03 3 1  ON 23
ci_025                 8.779412e-03 3 1  ON 24
ci_026                 1.017558e-02 3 1  ON 25
ci_027                 9.801325e-03 3 1  ON 26
ci_028                -1.444343e-02 3 1  ON 27
ci_029                -1.511747e-02 3 1  ON 28
ci_030                -8.600067e-03 3 1  ON 29
ci_031                -8.596139e-03 3 1  ON 30
ci_032                -1.446439e-02 3 1  ON 31
ci_033                 4.802323e-03 3 1  ON 32
ci_034                 4.891057e-03 3 1  ON 33
ci_035                -3.447283e-03 3 1  ON 34
ci_036                -1.137004e-02 3 1  ON 35
ci_037                -1.155319e-02 3 1  ON 36
ci_038                 1.038902e-03 3 1  ON 37
ci_039                 1.313111e-03 3 1  ON 38
ci_040                -1.672603e-03 3 1  ON 39
ci_041                 8.298535e-03 3 1  ON 40
ci_042                 8.213234e-03 3 1  ON 41
ci_043                -2.486482e-03 3 1  ON 42
ci_044                -4.172738e-03 3 1  ON 43
ci_045                -1.907321e-03 3 1  ON 44
ci_046                 4.865406e-03 3 1  ON 45
ci_047                 4.740544e-03 3 1  ON 46
ci_048                -1.235546e-02 3 1  ON 47
ci_049                -1.287457e-02 3 1  ON 48
ci_050                 2.827174e-03 3 1  ON 49
ci_051                 2.771690e-03 3 1  ON 50
ci_052                -2.326777e-03 3 1  ON 51
ci_053                -2.389160e-03 3 1  ON 52
ci_054                -2.450106e-03 3 1  ON 53
ci_055                -2.471936e-03 3 1  ON 54
ci_056                 4.722572e-03 3 1  ON 55
ci_057                 4.768481e-03 3 1  ON 56
ci_058                -2.184463e-03 3 1  ON 57
ci_059                -2.198861e-03 3 1  ON 58
ci_060                 4.895398e-03 3 1  ON 59
ci_061                 5.296504e-03 3 1  ON 60
ci_062                -2.860295e-03 3 1  ON 61
ci_063                -2.953946e-03 3 1  ON 62
ci_064                -2.274830e-03 3 1  ON 63
ci_065                -3.446372e-03 3 1  ON 64
ci_066                 4.063704e-03 3 1  ON 65
ci_067                 4.114297e-03 3 1  ON 66
ci_068                -4.393341e-03 3 1  ON 67
ci_069                -4.069879e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2956
    reference variance = 0.184746
====================================================
  Execution time = 1.3703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9882e-01
  Total weights = 1.957900746e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285196790725
                                         uncertainty =       0.001612567522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285196790725
                                         uncertainty =       0.001612567522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377595179
  error estimate for blocks of size 2^( 2) =       0.000389156544
  error estimate for blocks of size 2^( 3) =       0.000399519334
  error estimate for blocks of size 2^( 4) =       0.000407515249
  error estimate for blocks of size 2^( 5) =       0.000411603831
  error estimate for blocks of size 2^( 6) =       0.000414138969
  error estimate for blocks of size 2^( 7) =       0.000416435967

      target function =      -0.914413800265
              le_mean =     -17.215762524773
             les_mean =     296.681295150450
             stat err =       0.000412423504
             autocorr =       1.192982121758
   target nu stat err =       0.000412423504
   target dn stat err =       0.002148486993
      target stat err =       0.003437816164
              std dev =       0.534000222730
             le_variance =       0.285156237876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721576252477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914425888857       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914704524516       residual = 9.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914741023529       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914754237271       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914757894052       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914757811638       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914758175507       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914758219182       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914758252595       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914758258633       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.152411e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914425888857       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914544809335       residual = 8.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914559024859       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914563958426       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914565191366       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914565112051       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914565240108       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914565253270       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914565265400       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914565266190       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.647927e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914425888857       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914462002113       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914466116870       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914467514601       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914467846831       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914467818599       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914467853642       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914467857120       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914467860420       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914467860523       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.375625e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6254e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -3.779959e-02 3 1  ON 0
ci_002                -2.864435e-02 3 1  ON 1
ci_003                -2.391313e-02 3 1  ON 2
ci_004                 2.096790e-02 3 1  ON 3
ci_005                 2.164396e-02 3 1  ON 4
ci_006                -1.828834e-02 3 1  ON 5
ci_007                -1.855228e-02 3 1  ON 6
ci_008                -7.842565e-03 3 1  ON 7
ci_009                -1.367995e-02 3 1  ON 8
ci_010                -8.885191e-03 3 1  ON 9
ci_011                -9.155924e-03 3 1  ON 10
ci_012                -9.556847e-03 3 1  ON 11
ci_013                -1.940187e-02 3 1  ON 12
ci_014                 1.131203e-02 3 1  ON 13
ci_015                 1.107384e-02 3 1  ON 14
ci_016                 1.597810e-02 3 1  ON 15
ci_017                 1.580188e-02 3 1  ON 16
ci_018                 8.913420e-03 3 1  ON 17
ci_019                 9.307917e-03 3 1  ON 18
ci_020                 1.530621e-02 3 1  ON 19
ci_021                 1.539274e-02 3 1  ON 20
ci_022                 8.313976e-03 3 1  ON 21
ci_023                 8.267306e-03 3 1  ON 22
ci_024                 8.307796e-03 3 1  ON 23
ci_025                 8.668037e-03 3 1  ON 24
ci_026                 1.007667e-02 3 1  ON 25
ci_027                 9.981090e-03 3 1  ON 26
ci_028                -1.456460e-02 3 1  ON 27
ci_029                -1.512593e-02 3 1  ON 28
ci_030                -8.534880e-03 3 1  ON 29
ci_031                -8.793277e-03 3 1  ON 30
ci_032                -1.426149e-02 3 1  ON 31
ci_033                 4.853613e-03 3 1  ON 32
ci_034                 4.868848e-03 3 1  ON 33
ci_035                -3.337176e-03 3 1  ON 34
ci_036                -1.150901e-02 3 1  ON 35
ci_037                -1.142249e-02 3 1  ON 36
ci_038                 9.301727e-04 3 1  ON 37
ci_039                 1.213030e-03 3 1  ON 38
ci_040                -1.530026e-03 3 1  ON 39
ci_041                 8.132536e-03 3 1  ON 40
ci_042                 8.341514e-03 3 1  ON 41
ci_043                -2.415981e-03 3 1  ON 42
ci_044                -4.186529e-03 3 1  ON 43
ci_045                -1.916846e-03 3 1  ON 44
ci_046                 4.902005e-03 3 1  ON 45
ci_047                 4.635380e-03 3 1  ON 46
ci_048                -1.240674e-02 3 1  ON 47
ci_049                -1.279760e-02 3 1  ON 48
ci_050                 2.777349e-03 3 1  ON 49
ci_051                 2.811050e-03 3 1  ON 50
ci_052                -2.078942e-03 3 1  ON 51
ci_053                -2.204868e-03 3 1  ON 52
ci_054                -2.218922e-03 3 1  ON 53
ci_055                -2.224308e-03 3 1  ON 54
ci_056                 4.892835e-03 3 1  ON 55
ci_057                 4.732040e-03 3 1  ON 56
ci_058                -2.146643e-03 3 1  ON 57
ci_059                -2.241533e-03 3 1  ON 58
ci_060                 4.899609e-03 3 1  ON 59
ci_061                 5.271004e-03 3 1  ON 60
ci_062                -2.938293e-03 3 1  ON 61
ci_063                -2.794118e-03 3 1  ON 62
ci_064                -2.349677e-03 3 1  ON 63
ci_065                -3.461418e-03 3 1  ON 64
ci_066                 4.087563e-03 3 1  ON 65
ci_067                 4.159850e-03 3 1  ON 66
ci_068                -4.204600e-03 3 1  ON 67
ci_069                -4.093132e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.220969
====================================================
  Execution time = 1.3269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0839e-01
  Total weights = 1.9576e+06
  Execution time = 1.8675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0107516
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291112264495
                                         uncertainty =       0.003036131164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291112264495
                                         uncertainty =       0.003036131164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381506939
  error estimate for blocks of size 2^( 2) =       0.000392794517
  error estimate for blocks of size 2^( 3) =       0.000402797884
  error estimate for blocks of size 2^( 4) =       0.000410374732
  error estimate for blocks of size 2^( 5) =       0.000415250649
  error estimate for blocks of size 2^( 6) =       0.000418607699
  error estimate for blocks of size 2^( 7) =       0.000419617924

      target function =      -0.898805259162
              le_mean =     -17.213945034406
             les_mean =     296.628920611222
             stat err =       0.000415962751
             autocorr =       1.188786874677
   target nu stat err =       0.000415962751
   target dn stat err =       0.003864580686
      target stat err =       0.005868970978
              std dev =       0.539532286834
             le_variance =       0.291095088537

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00246654
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291032006345
                                         uncertainty =       0.002979279723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291032006345
                                         uncertainty =       0.002979279723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381453518
  error estimate for blocks of size 2^( 2) =       0.000392794035
  error estimate for blocks of size 2^( 3) =       0.000402866307
  error estimate for blocks of size 2^( 4) =       0.000410500409
  error estimate for blocks of size 2^( 5) =       0.000415384721
  error estimate for blocks of size 2^( 6) =       0.000418697858
  error estimate for blocks of size 2^( 7) =       0.000419709496

      target function =      -0.839414165456
              le_mean =     -17.213957626907
             les_mean =     296.669358297960
             stat err =       0.000416073121
             autocorr =       1.189750983871
   target nu stat err =       0.000416073121
   target dn stat err =       0.037381557488
      target stat err =       0.049336989761
              std dev =       0.539456737981
             le_variance =       0.291013572153

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0109357
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291174677739
                                         uncertainty =       0.002972647805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291174677739
                                         uncertainty =       0.002972647805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381547186
  error estimate for blocks of size 2^( 2) =       0.000392885063
  error estimate for blocks of size 2^( 3) =       0.000402957696
  error estimate for blocks of size 2^( 4) =       0.000410563670
  error estimate for blocks of size 2^( 5) =       0.000415428943
  error estimate for blocks of size 2^( 6) =       0.000418735275
  error estimate for blocks of size 2^( 7) =       0.000419715266

      target function =      -0.664064489248
              le_mean =     -17.213939356834
             les_mean =     296.806475162680
             stat err =       0.000416110789
             autocorr =       1.189382218623
   target nu stat err =       0.000416110789
   target dn stat err =       0.159857365306
      target stat err =       0.137183620403
              std dev =       0.539589205634
             le_variance =       0.291156510836

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0392167
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291078182994
                                         uncertainty =       0.003028146701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291078182994
                                         uncertainty =       0.003028146701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381484495
  error estimate for blocks of size 2^( 2) =       0.000392778901
  error estimate for blocks of size 2^( 3) =       0.000402790838
  error estimate for blocks of size 2^( 4) =       0.000410374681
  error estimate for blocks of size 2^( 5) =       0.000415251102
  error estimate for blocks of size 2^( 6) =       0.000418601978
  error estimate for blocks of size 2^( 7) =       0.000419613784

      target function =      -0.896497327574
              le_mean =     -17.213944586896
             les_mean =     296.630434032818
             stat err =       0.000415960386
             autocorr =       1.188913237848
   target nu stat err =       0.000415960386
   target dn stat err =       0.004291876032
      target stat err =       0.006476024982
              std dev =       0.539500546754
             le_variance =       0.291060839947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898805259162        initial  <--
     6.2500e-02     6.2500e-01             1.1524e-03        -0.839414165456
     2.5000e-01     2.5000e+00             4.6479e-04        -0.664064489248
     1.0000e+00     1.0000e+01             1.3756e-04        -0.896497327574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7285
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -3.784004e-02 3 1  ON 0
ci_002                -2.887013e-02 3 1  ON 1
ci_003                -2.384922e-02 3 1  ON 2
ci_004                 2.110140e-02 3 1  ON 3
ci_005                 2.172629e-02 3 1  ON 4
ci_006                -1.859732e-02 3 1  ON 5
ci_007                -1.863190e-02 3 1  ON 6
ci_008                -7.852210e-03 3 1  ON 7
ci_009                -1.413679e-02 3 1  ON 8
ci_010                -8.999281e-03 3 1  ON 9
ci_011                -9.394613e-03 3 1  ON 10
ci_012                -9.418148e-03 3 1  ON 11
ci_013                -1.933807e-02 3 1  ON 12
ci_014                 1.118769e-02 3 1  ON 13
ci_015                 1.113107e-02 3 1  ON 14
ci_016                 1.604209e-02 3 1  ON 15
ci_017                 1.579386e-02 3 1  ON 16
ci_018                 9.117837e-03 3 1  ON 17
ci_019                 9.241734e-03 3 1  ON 18
ci_020                 1.514487e-02 3 1  ON 19
ci_021                 1.540156e-02 3 1  ON 20
ci_022                 8.355706e-03 3 1  ON 21
ci_023                 8.377321e-03 3 1  ON 22
ci_024                 8.772589e-03 3 1  ON 23
ci_025                 8.779412e-03 3 1  ON 24
ci_026                 1.017558e-02 3 1  ON 25
ci_027                 9.801325e-03 3 1  ON 26
ci_028                -1.444343e-02 3 1  ON 27
ci_029                -1.511747e-02 3 1  ON 28
ci_030                -8.600067e-03 3 1  ON 29
ci_031                -8.596139e-03 3 1  ON 30
ci_032                -1.446439e-02 3 1  ON 31
ci_033                 4.802323e-03 3 1  ON 32
ci_034                 4.891057e-03 3 1  ON 33
ci_035                -3.447283e-03 3 1  ON 34
ci_036                -1.137004e-02 3 1  ON 35
ci_037                -1.155319e-02 3 1  ON 36
ci_038                 1.038902e-03 3 1  ON 37
ci_039                 1.313111e-03 3 1  ON 38
ci_040                -1.672603e-03 3 1  ON 39
ci_041                 8.298535e-03 3 1  ON 40
ci_042                 8.213234e-03 3 1  ON 41
ci_043                -2.486482e-03 3 1  ON 42
ci_044                -4.172738e-03 3 1  ON 43
ci_045                -1.907321e-03 3 1  ON 44
ci_046                 4.865406e-03 3 1  ON 45
ci_047                 4.740544e-03 3 1  ON 46
ci_048                -1.235546e-02 3 1  ON 47
ci_049                -1.287457e-02 3 1  ON 48
ci_050                 2.827174e-03 3 1  ON 49
ci_051                 2.771690e-03 3 1  ON 50
ci_052                -2.326777e-03 3 1  ON 51
ci_053                -2.389160e-03 3 1  ON 52
ci_054                -2.450106e-03 3 1  ON 53
ci_055                -2.471936e-03 3 1  ON 54
ci_056                 4.722572e-03 3 1  ON 55
ci_057                 4.768481e-03 3 1  ON 56
ci_058                -2.184463e-03 3 1  ON 57
ci_059                -2.198861e-03 3 1  ON 58
ci_060                 4.895398e-03 3 1  ON 59
ci_061                 5.296504e-03 3 1  ON 60
ci_062                -2.860295e-03 3 1  ON 61
ci_063                -2.953946e-03 3 1  ON 62
ci_064                -2.274830e-03 3 1  ON 63
ci_065                -3.446372e-03 3 1  ON 64
ci_066                 4.063704e-03 3 1  ON 65
ci_067                 4.114297e-03 3 1  ON 66
ci_068                -4.393341e-03 3 1  ON 67
ci_069                -4.069879e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.0775
    reference variance = 1.16917
====================================================
  Execution time = 1.3619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9848e-01
  Total weights = 1.957704425e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285570844192
                                         uncertainty =       0.001631791334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285570844192
                                         uncertainty =       0.001631791334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377962757
  error estimate for blocks of size 2^( 2) =       0.000389274236
  error estimate for blocks of size 2^( 3) =       0.000399720782
  error estimate for blocks of size 2^( 4) =       0.000407525252
  error estimate for blocks of size 2^( 5) =       0.000412164959
  error estimate for blocks of size 2^( 6) =       0.000413741771
  error estimate for blocks of size 2^( 7) =       0.000412442886

      target function =      -0.914987558486
              le_mean =     -17.214485392262
             les_mean =     296.636987993060
             stat err =       0.000411468717
             autocorr =       1.185156294243
   target nu stat err =       0.000411468717
   target dn stat err =       0.002061247502
      target stat err =       0.003300041473
              std dev =       0.534520057546
             le_variance =       0.285711691918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721448539226e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998536773       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915039447369       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915043733731       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915045830559       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915046049176       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915046166255       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915046178492       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915046165111       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915046158173       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915046155426       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.674498e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998536773       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915009700558       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915010844468       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915011392707       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915011448031       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915011477321       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915011480457       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915011477001       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915011475470       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915011474691       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 4.509004e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998536773       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915001393076       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915001683933       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915001822538       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915001836398       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915001843711       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915001844502       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915001843632       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915001843262       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915001843062       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.149425e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6151e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -3.783703e-02 3 1  ON 0
ci_002                -2.885395e-02 3 1  ON 1
ci_003                -2.385716e-02 3 1  ON 2
ci_004                 2.110711e-02 3 1  ON 3
ci_005                 2.171910e-02 3 1  ON 4
ci_006                -1.861056e-02 3 1  ON 5
ci_007                -1.863740e-02 3 1  ON 6
ci_008                -7.844839e-03 3 1  ON 7
ci_009                -1.412645e-02 3 1  ON 8
ci_010                -9.012583e-03 3 1  ON 9
ci_011                -9.396447e-03 3 1  ON 10
ci_012                -9.426851e-03 3 1  ON 11
ci_013                -1.932629e-02 3 1  ON 12
ci_014                 1.114260e-02 3 1  ON 13
ci_015                 1.113040e-02 3 1  ON 14
ci_016                 1.605707e-02 3 1  ON 15
ci_017                 1.579114e-02 3 1  ON 16
ci_018                 9.115668e-03 3 1  ON 17
ci_019                 9.255812e-03 3 1  ON 18
ci_020                 1.511328e-02 3 1  ON 19
ci_021                 1.538426e-02 3 1  ON 20
ci_022                 8.349181e-03 3 1  ON 21
ci_023                 8.389277e-03 3 1  ON 22
ci_024                 8.761422e-03 3 1  ON 23
ci_025                 8.817604e-03 3 1  ON 24
ci_026                 1.015321e-02 3 1  ON 25
ci_027                 9.789028e-03 3 1  ON 26
ci_028                -1.444161e-02 3 1  ON 27
ci_029                -1.511041e-02 3 1  ON 28
ci_030                -8.629644e-03 3 1  ON 29
ci_031                -8.602565e-03 3 1  ON 30
ci_032                -1.443986e-02 3 1  ON 31
ci_033                 4.784533e-03 3 1  ON 32
ci_034                 4.886502e-03 3 1  ON 33
ci_035                -3.442225e-03 3 1  ON 34
ci_036                -1.134905e-02 3 1  ON 35
ci_037                -1.154680e-02 3 1  ON 36
ci_038                 1.038783e-03 3 1  ON 37
ci_039                 1.285537e-03 3 1  ON 38
ci_040                -1.672620e-03 3 1  ON 39
ci_041                 8.287141e-03 3 1  ON 40
ci_042                 8.197197e-03 3 1  ON 41
ci_043                -2.481190e-03 3 1  ON 42
ci_044                -4.157308e-03 3 1  ON 43
ci_045                -1.901057e-03 3 1  ON 44
ci_046                 4.886940e-03 3 1  ON 45
ci_047                 4.731935e-03 3 1  ON 46
ci_048                -1.236417e-02 3 1  ON 47
ci_049                -1.286300e-02 3 1  ON 48
ci_050                 2.856238e-03 3 1  ON 49
ci_051                 2.784460e-03 3 1  ON 50
ci_052                -2.345337e-03 3 1  ON 51
ci_053                -2.381951e-03 3 1  ON 52
ci_054                -2.434620e-03 3 1  ON 53
ci_055                -2.458875e-03 3 1  ON 54
ci_056                 4.715107e-03 3 1  ON 55
ci_057                 4.755145e-03 3 1  ON 56
ci_058                -2.197500e-03 3 1  ON 57
ci_059                -2.190080e-03 3 1  ON 58
ci_060                 4.903588e-03 3 1  ON 59
ci_061                 5.257263e-03 3 1  ON 60
ci_062                -2.848712e-03 3 1  ON 61
ci_063                -2.941979e-03 3 1  ON 62
ci_064                -2.272595e-03 3 1  ON 63
ci_065                -3.434438e-03 3 1  ON 64
ci_066                 4.063149e-03 3 1  ON 65
ci_067                 4.105253e-03 3 1  ON 66
ci_068                -4.391858e-03 3 1  ON 67
ci_069                -4.067950e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.222386
====================================================
  Execution time = 1.3602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9659e-01
  Total weights = 1.9575e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284779626948
                                         uncertainty =       0.001371138615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284779626948
                                         uncertainty =       0.001371138615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377330876
  error estimate for blocks of size 2^( 2) =       0.000389008253
  error estimate for blocks of size 2^( 3) =       0.000399075509
  error estimate for blocks of size 2^( 4) =       0.000406947101
  error estimate for blocks of size 2^( 5) =       0.000412753140
  error estimate for blocks of size 2^( 6) =       0.000415712155
  error estimate for blocks of size 2^( 7) =       0.000417656034

      target function =      -0.917862563060
              le_mean =     -17.214795202518
             les_mean =     296.645816227142
             stat err =       0.000413267107
             autocorr =       1.199546240167
   target nu stat err =       0.000413267107
   target dn stat err =       0.002065672532
      target stat err =       0.003329730092
              std dev =       0.533626442042
             le_variance =       0.284757179647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284765794059
                                         uncertainty =       0.001372426888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284765794059
                                         uncertainty =       0.001372426888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377321497
  error estimate for blocks of size 2^( 2) =       0.000389000957
  error estimate for blocks of size 2^( 3) =       0.000399071111
  error estimate for blocks of size 2^( 4) =       0.000406942848
  error estimate for blocks of size 2^( 5) =       0.000412748998
  error estimate for blocks of size 2^( 6) =       0.000415712124
  error estimate for blocks of size 2^( 7) =       0.000417655321

      target function =      -0.917733187925
              le_mean =     -17.214795278374
             les_mean =     296.645901179752
             stat err =       0.000413264823
             autocorr =       1.199592612598
   target nu stat err =       0.000413264823
   target dn stat err =       0.002040263533
      target stat err =       0.003289733640
              std dev =       0.533613178113
             le_variance =       0.284743023856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284771040763
                                         uncertainty =       0.001371836268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284771040763
                                         uncertainty =       0.001371836268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377325070
  error estimate for blocks of size 2^( 2) =       0.000389003544
  error estimate for blocks of size 2^( 3) =       0.000399072411
  error estimate for blocks of size 2^( 4) =       0.000406944053
  error estimate for blocks of size 2^( 5) =       0.000412750160
  error estimate for blocks of size 2^( 6) =       0.000415711363
  error estimate for blocks of size 2^( 7) =       0.000417654811

      target function =      -0.918005662095
              le_mean =     -17.214795139395
             les_mean =     296.645723335811
             stat err =       0.000413265097
             autocorr =       1.199571485165
   target nu stat err =       0.000413265097
   target dn stat err =       0.002047593354
      target stat err =       0.003302919019
              std dev =       0.533618230858
             le_variance =       0.284748416304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778383473
                                         uncertainty =       0.001371226950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778383473
                                         uncertainty =       0.001371226950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377330037
  error estimate for blocks of size 2^( 2) =       0.000389007539
  error estimate for blocks of size 2^( 3) =       0.000399075005
  error estimate for blocks of size 2^( 4) =       0.000406946603
  error estimate for blocks of size 2^( 5) =       0.000412752634
  error estimate for blocks of size 2^( 6) =       0.000415711926
  error estimate for blocks of size 2^( 7) =       0.000417655731

      target function =      -0.917770278703
              le_mean =     -17.214795188479
             les_mean =     296.645874351307
             stat err =       0.000413266723
             autocorr =       1.199549343936
   target nu stat err =       0.000413266723
   target dn stat err =       0.002064945277
      target stat err =       0.003327956605
              std dev =       0.533625255698
             le_variance =       0.284755913519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917862563060        initial
     6.2500e-01     6.2500e+00             1.6745e-04        -0.917733187925
     2.5000e+00     2.5000e+01             4.5090e-05        -0.918005662095  <--
     1.0000e+01     1.0000e+02             1.1494e-05        -0.917770278703

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3061e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -3.783703e-02 3 1  ON 0
ci_002                -2.885395e-02 3 1  ON 1
ci_003                -2.385716e-02 3 1  ON 2
ci_004                 2.110711e-02 3 1  ON 3
ci_005                 2.171910e-02 3 1  ON 4
ci_006                -1.861056e-02 3 1  ON 5
ci_007                -1.863740e-02 3 1  ON 6
ci_008                -7.844839e-03 3 1  ON 7
ci_009                -1.412645e-02 3 1  ON 8
ci_010                -9.012583e-03 3 1  ON 9
ci_011                -9.396447e-03 3 1  ON 10
ci_012                -9.426851e-03 3 1  ON 11
ci_013                -1.932629e-02 3 1  ON 12
ci_014                 1.114260e-02 3 1  ON 13
ci_015                 1.113040e-02 3 1  ON 14
ci_016                 1.605707e-02 3 1  ON 15
ci_017                 1.579114e-02 3 1  ON 16
ci_018                 9.115668e-03 3 1  ON 17
ci_019                 9.255812e-03 3 1  ON 18
ci_020                 1.511328e-02 3 1  ON 19
ci_021                 1.538426e-02 3 1  ON 20
ci_022                 8.349181e-03 3 1  ON 21
ci_023                 8.389277e-03 3 1  ON 22
ci_024                 8.761422e-03 3 1  ON 23
ci_025                 8.817604e-03 3 1  ON 24
ci_026                 1.015321e-02 3 1  ON 25
ci_027                 9.789028e-03 3 1  ON 26
ci_028                -1.444161e-02 3 1  ON 27
ci_029                -1.511041e-02 3 1  ON 28
ci_030                -8.629644e-03 3 1  ON 29
ci_031                -8.602565e-03 3 1  ON 30
ci_032                -1.443986e-02 3 1  ON 31
ci_033                 4.784533e-03 3 1  ON 32
ci_034                 4.886502e-03 3 1  ON 33
ci_035                -3.442225e-03 3 1  ON 34
ci_036                -1.134905e-02 3 1  ON 35
ci_037                -1.154680e-02 3 1  ON 36
ci_038                 1.038783e-03 3 1  ON 37
ci_039                 1.285537e-03 3 1  ON 38
ci_040                -1.672620e-03 3 1  ON 39
ci_041                 8.287141e-03 3 1  ON 40
ci_042                 8.197197e-03 3 1  ON 41
ci_043                -2.481190e-03 3 1  ON 42
ci_044                -4.157308e-03 3 1  ON 43
ci_045                -1.901057e-03 3 1  ON 44
ci_046                 4.886940e-03 3 1  ON 45
ci_047                 4.731935e-03 3 1  ON 46
ci_048                -1.236417e-02 3 1  ON 47
ci_049                -1.286300e-02 3 1  ON 48
ci_050                 2.856238e-03 3 1  ON 49
ci_051                 2.784460e-03 3 1  ON 50
ci_052                -2.345337e-03 3 1  ON 51
ci_053                -2.381951e-03 3 1  ON 52
ci_054                -2.434620e-03 3 1  ON 53
ci_055                -2.458875e-03 3 1  ON 54
ci_056                 4.715107e-03 3 1  ON 55
ci_057                 4.755145e-03 3 1  ON 56
ci_058                -2.197500e-03 3 1  ON 57
ci_059                -2.190080e-03 3 1  ON 58
ci_060                 4.903588e-03 3 1  ON 59
ci_061                 5.257263e-03 3 1  ON 60
ci_062                -2.848712e-03 3 1  ON 61
ci_063                -2.941979e-03 3 1  ON 62
ci_064                -2.272595e-03 3 1  ON 63
ci_065                -3.434438e-03 3 1  ON 64
ci_066                 4.063149e-03 3 1  ON 65
ci_067                 4.105253e-03 3 1  ON 66
ci_068                -4.391858e-03 3 1  ON 67
ci_069                -4.067950e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9245e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.235052
====================================================
  Execution time = 1.3878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0210e-01
  Total weights = 1.957627387e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288041502907
                                         uncertainty =       0.001901284514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288041502907
                                         uncertainty =       0.001901284514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379461896
  error estimate for blocks of size 2^( 2) =       0.000390589896
  error estimate for blocks of size 2^( 3) =       0.000401378956
  error estimate for blocks of size 2^( 4) =       0.000408729440
  error estimate for blocks of size 2^( 5) =       0.000412322592
  error estimate for blocks of size 2^( 6) =       0.000414005487
  error estimate for blocks of size 2^( 7) =       0.000414923962

      target function =      -0.909349883231
              le_mean =     -17.214351720138
             les_mean =     296.636009585269
             stat err =       0.000412495370
             autocorr =       1.181685242238
   target nu stat err =       0.000412495370
   target dn stat err =       0.002855458717
      target stat err =       0.004465889899
              std dev =       0.536640159958
             le_variance =       0.287982661279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721435172014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909371070510       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909471958718       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909482233015       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909487208710       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909488006007       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909488151529       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909488188728       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909488195614       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909488187168       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909488182386       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 2.535203e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909371070510       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909398621826       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909401366002       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909402663827       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909402867725       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909402904338       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909402913776       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909402915396       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909402913310       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909402912155       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 6.935367e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909371070510       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909378121102       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909378819002       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909379146889       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909379198131       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909379207290       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909379209658       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909379210055       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909379209536       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909379209250       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.775674e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6420e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -3.780035e-02 3 1  ON 0
ci_002                -2.886291e-02 3 1  ON 1
ci_003                -2.381924e-02 3 1  ON 2
ci_004                 2.111565e-02 3 1  ON 3
ci_005                 2.170661e-02 3 1  ON 4
ci_006                -1.864757e-02 3 1  ON 5
ci_007                -1.860532e-02 3 1  ON 6
ci_008                -7.834914e-03 3 1  ON 7
ci_009                -1.412290e-02 3 1  ON 8
ci_010                -9.008964e-03 3 1  ON 9
ci_011                -9.363732e-03 3 1  ON 10
ci_012                -9.413731e-03 3 1  ON 11
ci_013                -1.931446e-02 3 1  ON 12
ci_014                 1.113302e-02 3 1  ON 13
ci_015                 1.113932e-02 3 1  ON 14
ci_016                 1.603570e-02 3 1  ON 15
ci_017                 1.577458e-02 3 1  ON 16
ci_018                 9.112277e-03 3 1  ON 17
ci_019                 9.243783e-03 3 1  ON 18
ci_020                 1.509545e-02 3 1  ON 19
ci_021                 1.535916e-02 3 1  ON 20
ci_022                 8.343443e-03 3 1  ON 21
ci_023                 8.387671e-03 3 1  ON 22
ci_024                 8.719386e-03 3 1  ON 23
ci_025                 8.770941e-03 3 1  ON 24
ci_026                 1.011227e-02 3 1  ON 25
ci_027                 9.737890e-03 3 1  ON 26
ci_028                -1.445872e-02 3 1  ON 27
ci_029                -1.507740e-02 3 1  ON 28
ci_030                -8.641924e-03 3 1  ON 29
ci_031                -8.618646e-03 3 1  ON 30
ci_032                -1.443446e-02 3 1  ON 31
ci_033                 4.778030e-03 3 1  ON 32
ci_034                 4.857918e-03 3 1  ON 33
ci_035                -3.435114e-03 3 1  ON 34
ci_036                -1.141840e-02 3 1  ON 35
ci_037                -1.156029e-02 3 1  ON 36
ci_038                 1.016817e-03 3 1  ON 37
ci_039                 1.266328e-03 3 1  ON 38
ci_040                -1.659410e-03 3 1  ON 39
ci_041                 8.283541e-03 3 1  ON 40
ci_042                 8.227434e-03 3 1  ON 41
ci_043                -2.475516e-03 3 1  ON 42
ci_044                -4.148252e-03 3 1  ON 43
ci_045                -1.934014e-03 3 1  ON 44
ci_046                 4.872610e-03 3 1  ON 45
ci_047                 4.738796e-03 3 1  ON 46
ci_048                -1.236155e-02 3 1  ON 47
ci_049                -1.285569e-02 3 1  ON 48
ci_050                 2.851358e-03 3 1  ON 49
ci_051                 2.781987e-03 3 1  ON 50
ci_052                -2.362207e-03 3 1  ON 51
ci_053                -2.349434e-03 3 1  ON 52
ci_054                -2.427490e-03 3 1  ON 53
ci_055                -2.450975e-03 3 1  ON 54
ci_056                 4.683654e-03 3 1  ON 55
ci_057                 4.729103e-03 3 1  ON 56
ci_058                -2.186654e-03 3 1  ON 57
ci_059                -2.183302e-03 3 1  ON 58
ci_060                 4.858661e-03 3 1  ON 59
ci_061                 5.249606e-03 3 1  ON 60
ci_062                -2.872059e-03 3 1  ON 61
ci_063                -2.925314e-03 3 1  ON 62
ci_064                -2.264910e-03 3 1  ON 63
ci_065                -3.432570e-03 3 1  ON 64
ci_066                 4.061290e-03 3 1  ON 65
ci_067                 4.110565e-03 3 1  ON 66
ci_068                -4.390864e-03 3 1  ON 67
ci_069                -4.066973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1134
    reference variance = 0.803658
====================================================
  Execution time = 1.3597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0758e-01
  Total weights = 1.9574e+06
  Execution time = 1.8726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292439374171
                                         uncertainty =       0.004896767467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292439374171
                                         uncertainty =       0.004896767467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382417623
  error estimate for blocks of size 2^( 2) =       0.000393913486
  error estimate for blocks of size 2^( 3) =       0.000404339414
  error estimate for blocks of size 2^( 4) =       0.000412283586
  error estimate for blocks of size 2^( 5) =       0.000417066282
  error estimate for blocks of size 2^( 6) =       0.000420700493
  error estimate for blocks of size 2^( 7) =       0.000420836523

      target function =      -0.900817405762
              le_mean =     -17.214051032325
             les_mean =     296.631188914012
             stat err =       0.000417721721
             autocorr =       1.193158999964
   target nu stat err =       0.000417721721
   target dn stat err =       0.006458684356
      target stat err =       0.009810465948
              std dev =       0.540820189032
             le_variance =       0.292486476864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292393407603
                                         uncertainty =       0.004899393702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292393407603
                                         uncertainty =       0.004899393702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382387556
  error estimate for blocks of size 2^( 2) =       0.000393899102
  error estimate for blocks of size 2^( 3) =       0.000404340708
  error estimate for blocks of size 2^( 4) =       0.000412297729
  error estimate for blocks of size 2^( 5) =       0.000417080591
  error estimate for blocks of size 2^( 6) =       0.000420728034
  error estimate for blocks of size 2^( 7) =       0.000420865747

      target function =      -0.900832013073
              le_mean =     -17.214055001633
             les_mean =     296.631315799631
             stat err =       0.000417743025
             autocorr =       1.193468369378
   target nu stat err =       0.000417743025
   target dn stat err =       0.006457347732
      target stat err =       0.009808838220
              std dev =       0.540777668146
             le_variance =       0.292440486365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292411540804
                                         uncertainty =       0.004897808757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292411540804
                                         uncertainty =       0.004897808757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382399420
  error estimate for blocks of size 2^( 2) =       0.000393903795
  error estimate for blocks of size 2^( 3) =       0.000404338179
  error estimate for blocks of size 2^( 4) =       0.000412289323
  error estimate for blocks of size 2^( 5) =       0.000417071978
  error estimate for blocks of size 2^( 6) =       0.000420713337
  error estimate for blocks of size 2^( 7) =       0.000420850025

      target function =      -0.900935405640
              le_mean =     -17.214052832976
             les_mean =     296.631172994381
             stat err =       0.000417731166
             autocorr =       1.193326557732
   target nu stat err =       0.000417731166
   target dn stat err =       0.006456356389
      target stat err =       0.009809544439
              std dev =       0.540794446211
             le_variance =       0.292458633052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292435464142
                                         uncertainty =       0.004896885621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292435464142
                                         uncertainty =       0.004896885621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382415066
  error estimate for blocks of size 2^( 2) =       0.000393912018
  error estimate for blocks of size 2^( 3) =       0.000404339023
  error estimate for blocks of size 2^( 4) =       0.000412284090
  error estimate for blocks of size 2^( 5) =       0.000417066780
  error estimate for blocks of size 2^( 6) =       0.000420701905
  error estimate for blocks of size 2^( 7) =       0.000420837997

      target function =      -0.900842219545
              le_mean =     -17.214051221035
             les_mean =     296.631179032323
             stat err =       0.000417722693
             autocorr =       1.193180509506
   target nu stat err =       0.000417722693
   target dn stat err =       0.006458210532
      target stat err =       0.009810292447
              std dev =       0.540816573148
             le_variance =       0.292482565792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900817405762        initial
     6.2500e-01     6.2500e+00             2.5352e-04        -0.900832013073
     2.5000e+00     2.5000e+01             6.9354e-05        -0.900935405640  <--
     1.0000e+01     1.0000e+02             1.7757e-05        -0.900842219545

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3058e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -3.780035e-02 3 1  ON 0
ci_002                -2.886291e-02 3 1  ON 1
ci_003                -2.381924e-02 3 1  ON 2
ci_004                 2.111565e-02 3 1  ON 3
ci_005                 2.170661e-02 3 1  ON 4
ci_006                -1.864757e-02 3 1  ON 5
ci_007                -1.860532e-02 3 1  ON 6
ci_008                -7.834914e-03 3 1  ON 7
ci_009                -1.412290e-02 3 1  ON 8
ci_010                -9.008964e-03 3 1  ON 9
ci_011                -9.363732e-03 3 1  ON 10
ci_012                -9.413731e-03 3 1  ON 11
ci_013                -1.931446e-02 3 1  ON 12
ci_014                 1.113302e-02 3 1  ON 13
ci_015                 1.113932e-02 3 1  ON 14
ci_016                 1.603570e-02 3 1  ON 15
ci_017                 1.577458e-02 3 1  ON 16
ci_018                 9.112277e-03 3 1  ON 17
ci_019                 9.243783e-03 3 1  ON 18
ci_020                 1.509545e-02 3 1  ON 19
ci_021                 1.535916e-02 3 1  ON 20
ci_022                 8.343443e-03 3 1  ON 21
ci_023                 8.387671e-03 3 1  ON 22
ci_024                 8.719386e-03 3 1  ON 23
ci_025                 8.770941e-03 3 1  ON 24
ci_026                 1.011227e-02 3 1  ON 25
ci_027                 9.737890e-03 3 1  ON 26
ci_028                -1.445872e-02 3 1  ON 27
ci_029                -1.507740e-02 3 1  ON 28
ci_030                -8.641924e-03 3 1  ON 29
ci_031                -8.618646e-03 3 1  ON 30
ci_032                -1.443446e-02 3 1  ON 31
ci_033                 4.778030e-03 3 1  ON 32
ci_034                 4.857918e-03 3 1  ON 33
ci_035                -3.435114e-03 3 1  ON 34
ci_036                -1.141840e-02 3 1  ON 35
ci_037                -1.156029e-02 3 1  ON 36
ci_038                 1.016817e-03 3 1  ON 37
ci_039                 1.266328e-03 3 1  ON 38
ci_040                -1.659410e-03 3 1  ON 39
ci_041                 8.283541e-03 3 1  ON 40
ci_042                 8.227434e-03 3 1  ON 41
ci_043                -2.475516e-03 3 1  ON 42
ci_044                -4.148252e-03 3 1  ON 43
ci_045                -1.934014e-03 3 1  ON 44
ci_046                 4.872610e-03 3 1  ON 45
ci_047                 4.738796e-03 3 1  ON 46
ci_048                -1.236155e-02 3 1  ON 47
ci_049                -1.285569e-02 3 1  ON 48
ci_050                 2.851358e-03 3 1  ON 49
ci_051                 2.781987e-03 3 1  ON 50
ci_052                -2.362207e-03 3 1  ON 51
ci_053                -2.349434e-03 3 1  ON 52
ci_054                -2.427490e-03 3 1  ON 53
ci_055                -2.450975e-03 3 1  ON 54
ci_056                 4.683654e-03 3 1  ON 55
ci_057                 4.729103e-03 3 1  ON 56
ci_058                -2.186654e-03 3 1  ON 57
ci_059                -2.183302e-03 3 1  ON 58
ci_060                 4.858661e-03 3 1  ON 59
ci_061                 5.249606e-03 3 1  ON 60
ci_062                -2.872059e-03 3 1  ON 61
ci_063                -2.925314e-03 3 1  ON 62
ci_064                -2.264910e-03 3 1  ON 63
ci_065                -3.432570e-03 3 1  ON 64
ci_066                 4.061290e-03 3 1  ON 65
ci_067                 4.110565e-03 3 1  ON 66
ci_068                -4.390864e-03 3 1  ON 67
ci_069                -4.066973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1547
    reference variance = 0.211994
====================================================
  Execution time = 1.3817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0483e-01
  Total weights = 1.957970124e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289328446686
                                         uncertainty =       0.001826762519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289328446686
                                         uncertainty =       0.001826762519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380332702
  error estimate for blocks of size 2^( 2) =       0.000391963831
  error estimate for blocks of size 2^( 3) =       0.000402366639
  error estimate for blocks of size 2^( 4) =       0.000410471721
  error estimate for blocks of size 2^( 5) =       0.000415596746
  error estimate for blocks of size 2^( 6) =       0.000419254643
  error estimate for blocks of size 2^( 7) =       0.000420418228

      target function =      -0.905134789130
              le_mean =     -17.214612027640
             les_mean =     296.647702102685
             stat err =       0.000416435334
             autocorr =       1.198858165467
   target nu stat err =       0.000416435334
   target dn stat err =       0.003106375595
      target stat err =       0.004807987942
              std dev =       0.537871666052
             le_variance =       0.289305929142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721461202764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905159357244       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905250889208       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905270290048       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905275407668       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905276551311       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905276954649       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905276987801       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905277070816       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905277047621       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905277056129       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905277048782       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 3.258177e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905159357244       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905184342120       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905189537961       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905190873853       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905191162982       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905191264755       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905191271811       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905191292693       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905191286987       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905191288923       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 8.819918e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905159357244       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905165750253       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905167072665       residual = 6.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905167410246       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905167482652       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905167508135       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905167509812       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905167515034       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905167513617       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905167514086       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 2.251430e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6368e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -3.780420e-02 3 1  ON 0
ci_002                -2.883656e-02 3 1  ON 1
ci_003                -2.378329e-02 3 1  ON 2
ci_004                 2.111705e-02 3 1  ON 3
ci_005                 2.169188e-02 3 1  ON 4
ci_006                -1.861518e-02 3 1  ON 5
ci_007                -1.862608e-02 3 1  ON 6
ci_008                -7.809970e-03 3 1  ON 7
ci_009                -1.409486e-02 3 1  ON 8
ci_010                -9.033485e-03 3 1  ON 9
ci_011                -9.275533e-03 3 1  ON 10
ci_012                -9.380049e-03 3 1  ON 11
ci_013                -1.934824e-02 3 1  ON 12
ci_014                 1.110077e-02 3 1  ON 13
ci_015                 1.112401e-02 3 1  ON 14
ci_016                 1.603839e-02 3 1  ON 15
ci_017                 1.575173e-02 3 1  ON 16
ci_018                 9.101062e-03 3 1  ON 17
ci_019                 9.186658e-03 3 1  ON 18
ci_020                 1.505328e-02 3 1  ON 19
ci_021                 1.535105e-02 3 1  ON 20
ci_022                 8.339770e-03 3 1  ON 21
ci_023                 8.369005e-03 3 1  ON 22
ci_024                 8.736090e-03 3 1  ON 23
ci_025                 8.741144e-03 3 1  ON 24
ci_026                 1.007187e-02 3 1  ON 25
ci_027                 9.732584e-03 3 1  ON 26
ci_028                -1.447509e-02 3 1  ON 27
ci_029                -1.505770e-02 3 1  ON 28
ci_030                -8.636782e-03 3 1  ON 29
ci_031                -8.615865e-03 3 1  ON 30
ci_032                -1.444070e-02 3 1  ON 31
ci_033                 4.779581e-03 3 1  ON 32
ci_034                 4.857444e-03 3 1  ON 33
ci_035                -3.420068e-03 3 1  ON 34
ci_036                -1.142497e-02 3 1  ON 35
ci_037                -1.154848e-02 3 1  ON 36
ci_038                 1.021026e-03 3 1  ON 37
ci_039                 1.253877e-03 3 1  ON 38
ci_040                -1.686033e-03 3 1  ON 39
ci_041                 8.297618e-03 3 1  ON 40
ci_042                 8.242006e-03 3 1  ON 41
ci_043                -2.471951e-03 3 1  ON 42
ci_044                -4.100635e-03 3 1  ON 43
ci_045                -1.935364e-03 3 1  ON 44
ci_046                 4.837779e-03 3 1  ON 45
ci_047                 4.737814e-03 3 1  ON 46
ci_048                -1.240008e-02 3 1  ON 47
ci_049                -1.286575e-02 3 1  ON 48
ci_050                 2.831244e-03 3 1  ON 49
ci_051                 2.742252e-03 3 1  ON 50
ci_052                -2.365302e-03 3 1  ON 51
ci_053                -2.317693e-03 3 1  ON 52
ci_054                -2.431713e-03 3 1  ON 53
ci_055                -2.479726e-03 3 1  ON 54
ci_056                 4.682152e-03 3 1  ON 55
ci_057                 4.728675e-03 3 1  ON 56
ci_058                -2.168054e-03 3 1  ON 57
ci_059                -2.153975e-03 3 1  ON 58
ci_060                 4.842581e-03 3 1  ON 59
ci_061                 5.234362e-03 3 1  ON 60
ci_062                -2.869926e-03 3 1  ON 61
ci_063                -2.949218e-03 3 1  ON 62
ci_064                -2.263424e-03 3 1  ON 63
ci_065                -3.431984e-03 3 1  ON 64
ci_066                 4.066824e-03 3 1  ON 65
ci_067                 4.117117e-03 3 1  ON 66
ci_068                -4.368792e-03 3 1  ON 67
ci_069                -4.078421e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.305206
====================================================
  Execution time = 1.3372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9498e-01
  Total weights = 1.9580e+06
  Execution time = 1.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283302517311
                                         uncertainty =       0.001692432598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283302517311
                                         uncertainty =       0.001692432598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376336714
  error estimate for blocks of size 2^( 2) =       0.000387739139
  error estimate for blocks of size 2^( 3) =       0.000397692617
  error estimate for blocks of size 2^( 4) =       0.000405401248
  error estimate for blocks of size 2^( 5) =       0.000409895220
  error estimate for blocks of size 2^( 6) =       0.000411723729
  error estimate for blocks of size 2^( 7) =       0.000413174418

      target function =      -0.920514003632
              le_mean =     -17.214619984717
             les_mean =     296.638107699100
             stat err =       0.000410048654
             autocorr =       1.187182822239
   target nu stat err =       0.000410048654
   target dn stat err =       0.002078391613
      target stat err =       0.003365982166
              std dev =       0.532220484800
             le_variance =       0.283258644440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283265165263
                                         uncertainty =       0.001689072606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283265165263
                                         uncertainty =       0.001689072606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376311976
  error estimate for blocks of size 2^( 2) =       0.000387740372
  error estimate for blocks of size 2^( 3) =       0.000397720588
  error estimate for blocks of size 2^( 4) =       0.000405444396
  error estimate for blocks of size 2^( 5) =       0.000409946968
  error estimate for blocks of size 2^( 6) =       0.000411786158
  error estimate for blocks of size 2^( 7) =       0.000413235235

      target function =      -0.918136345041
              le_mean =     -17.214623232932
             les_mean =     296.639721591884
             stat err =       0.000410103189
             autocorr =       1.187654759922
   target nu stat err =       0.000410103189
   target dn stat err =       0.002496183894
      target stat err =       0.003994947050
              std dev =       0.532185499960
             le_variance =       0.283221406367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283279698642
                                         uncertainty =       0.001690481388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283279698642
                                         uncertainty =       0.001690481388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376321598
  error estimate for blocks of size 2^( 2) =       0.000387738147
  error estimate for blocks of size 2^( 3) =       0.000397706140
  error estimate for blocks of size 2^( 4) =       0.000405422991
  error estimate for blocks of size 2^( 5) =       0.000409921718
  error estimate for blocks of size 2^( 6) =       0.000411755921
  error estimate for blocks of size 2^( 7) =       0.000413205796

      target function =      -0.920199209141
              le_mean =     -17.214621360101
             les_mean =     296.638353811976
             stat err =       0.000410076607
             autocorr =       1.187440075382
   target nu stat err =       0.000410076607
   target dn stat err =       0.002089987996
      target stat err =       0.003381695403
              std dev =       0.532199107476
             le_variance =       0.283235889998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283299259796
                                         uncertainty =       0.001692169797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283299259796
                                         uncertainty =       0.001692169797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376334556
  error estimate for blocks of size 2^( 2) =       0.000387738779
  error estimate for blocks of size 2^( 3) =       0.000397694109
  error estimate for blocks of size 2^( 4) =       0.000405403783
  error estimate for blocks of size 2^( 5) =       0.000409898358
  error estimate for blocks of size 2^( 6) =       0.000411727618
  error estimate for blocks of size 2^( 7) =       0.000413178206

      target function =      -0.920513550719
              le_mean =     -17.214620119454
             les_mean =     296.638112619789
             stat err =       0.000410051991
             autocorr =       1.187215765892
   target nu stat err =       0.000410051991
   target dn stat err =       0.002078687815
      target stat err =       0.003366439624
              std dev =       0.532217432492
             le_variance =       0.283255395448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920514003632        initial  <--
     6.2500e-01     6.2500e+00             3.2582e-04        -0.918136345041
     2.5000e+00     2.5000e+01             8.8199e-05        -0.920199209141
     1.0000e+01     1.0000e+02             2.2514e-05        -0.920513550719

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9107
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -3.780035e-02 3 1  ON 0
ci_002                -2.886291e-02 3 1  ON 1
ci_003                -2.381924e-02 3 1  ON 2
ci_004                 2.111565e-02 3 1  ON 3
ci_005                 2.170661e-02 3 1  ON 4
ci_006                -1.864757e-02 3 1  ON 5
ci_007                -1.860532e-02 3 1  ON 6
ci_008                -7.834914e-03 3 1  ON 7
ci_009                -1.412290e-02 3 1  ON 8
ci_010                -9.008964e-03 3 1  ON 9
ci_011                -9.363732e-03 3 1  ON 10
ci_012                -9.413731e-03 3 1  ON 11
ci_013                -1.931446e-02 3 1  ON 12
ci_014                 1.113302e-02 3 1  ON 13
ci_015                 1.113932e-02 3 1  ON 14
ci_016                 1.603570e-02 3 1  ON 15
ci_017                 1.577458e-02 3 1  ON 16
ci_018                 9.112277e-03 3 1  ON 17
ci_019                 9.243783e-03 3 1  ON 18
ci_020                 1.509545e-02 3 1  ON 19
ci_021                 1.535916e-02 3 1  ON 20
ci_022                 8.343443e-03 3 1  ON 21
ci_023                 8.387671e-03 3 1  ON 22
ci_024                 8.719386e-03 3 1  ON 23
ci_025                 8.770941e-03 3 1  ON 24
ci_026                 1.011227e-02 3 1  ON 25
ci_027                 9.737890e-03 3 1  ON 26
ci_028                -1.445872e-02 3 1  ON 27
ci_029                -1.507740e-02 3 1  ON 28
ci_030                -8.641924e-03 3 1  ON 29
ci_031                -8.618646e-03 3 1  ON 30
ci_032                -1.443446e-02 3 1  ON 31
ci_033                 4.778030e-03 3 1  ON 32
ci_034                 4.857918e-03 3 1  ON 33
ci_035                -3.435114e-03 3 1  ON 34
ci_036                -1.141840e-02 3 1  ON 35
ci_037                -1.156029e-02 3 1  ON 36
ci_038                 1.016817e-03 3 1  ON 37
ci_039                 1.266328e-03 3 1  ON 38
ci_040                -1.659410e-03 3 1  ON 39
ci_041                 8.283541e-03 3 1  ON 40
ci_042                 8.227434e-03 3 1  ON 41
ci_043                -2.475516e-03 3 1  ON 42
ci_044                -4.148252e-03 3 1  ON 43
ci_045                -1.934014e-03 3 1  ON 44
ci_046                 4.872610e-03 3 1  ON 45
ci_047                 4.738796e-03 3 1  ON 46
ci_048                -1.236155e-02 3 1  ON 47
ci_049                -1.285569e-02 3 1  ON 48
ci_050                 2.851358e-03 3 1  ON 49
ci_051                 2.781987e-03 3 1  ON 50
ci_052                -2.362207e-03 3 1  ON 51
ci_053                -2.349434e-03 3 1  ON 52
ci_054                -2.427490e-03 3 1  ON 53
ci_055                -2.450975e-03 3 1  ON 54
ci_056                 4.683654e-03 3 1  ON 55
ci_057                 4.729103e-03 3 1  ON 56
ci_058                -2.186654e-03 3 1  ON 57
ci_059                -2.183302e-03 3 1  ON 58
ci_060                 4.858661e-03 3 1  ON 59
ci_061                 5.249606e-03 3 1  ON 60
ci_062                -2.872059e-03 3 1  ON 61
ci_063                -2.925314e-03 3 1  ON 62
ci_064                -2.264910e-03 3 1  ON 63
ci_065                -3.432570e-03 3 1  ON 64
ci_066                 4.061290e-03 3 1  ON 65
ci_067                 4.110565e-03 3 1  ON 66
ci_068                -4.390864e-03 3 1  ON 67
ci_069                -4.066973e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2507
    reference variance = 0.346855
====================================================
  Execution time = 1.3834e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9596e-01
  Total weights = 1.957582786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284102329441
                                         uncertainty =       0.001648878611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284102329441
                                         uncertainty =       0.001648878611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376884282
  error estimate for blocks of size 2^( 2) =       0.000387948807
  error estimate for blocks of size 2^( 3) =       0.000398500700
  error estimate for blocks of size 2^( 4) =       0.000406604828
  error estimate for blocks of size 2^( 5) =       0.000411260963
  error estimate for blocks of size 2^( 6) =       0.000414364740
  error estimate for blocks of size 2^( 7) =       0.000417674508

      target function =      -0.918942955151
              le_mean =     -17.214536964577
             les_mean =     296.636245304630
             stat err =       0.000412476260
             autocorr =       1.197793255450
   target nu stat err =       0.000412476260
   target dn stat err =       0.001992043580
      target stat err =       0.003222057913
              std dev =       0.532994863512
             le_variance =       0.284083524530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721453696458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918953252023       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918956384047       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918957180363       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918957387863       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918957428775       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918957437531       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918957434247       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918957433824       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918957434136       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918957433420       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.716404e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918953252023       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918954042323       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918954242822       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918954294907       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918954305161       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918954307349       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918954306523       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918954306419       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918954306496       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918954306317       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.323530e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918953252023       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918953450059       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918953500273       residual = 2.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918953513308       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918953515873       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918953516419       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918953516213       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918953516187       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918953516206       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918953516161       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.082935e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6372e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -3.779768e-02 3 1  ON 0
ci_002                -2.886326e-02 3 1  ON 1
ci_003                -2.381693e-02 3 1  ON 2
ci_004                 2.111482e-02 3 1  ON 3
ci_005                 2.170445e-02 3 1  ON 4
ci_006                -1.864838e-02 3 1  ON 5
ci_007                -1.860401e-02 3 1  ON 6
ci_008                -7.835004e-03 3 1  ON 7
ci_009                -1.412100e-02 3 1  ON 8
ci_010                -9.008653e-03 3 1  ON 9
ci_011                -9.361189e-03 3 1  ON 10
ci_012                -9.412127e-03 3 1  ON 11
ci_013                -1.931048e-02 3 1  ON 12
ci_014                 1.113407e-02 3 1  ON 13
ci_015                 1.113690e-02 3 1  ON 14
ci_016                 1.603344e-02 3 1  ON 15
ci_017                 1.577458e-02 3 1  ON 16
ci_018                 9.111037e-03 3 1  ON 17
ci_019                 9.242017e-03 3 1  ON 18
ci_020                 1.509428e-02 3 1  ON 19
ci_021                 1.535664e-02 3 1  ON 20
ci_022                 8.342722e-03 3 1  ON 21
ci_023                 8.388125e-03 3 1  ON 22
ci_024                 8.719562e-03 3 1  ON 23
ci_025                 8.766618e-03 3 1  ON 24
ci_026                 1.011063e-02 3 1  ON 25
ci_027                 9.739120e-03 3 1  ON 26
ci_028                -1.445814e-02 3 1  ON 27
ci_029                -1.507584e-02 3 1  ON 28
ci_030                -8.642036e-03 3 1  ON 29
ci_031                -8.616444e-03 3 1  ON 30
ci_032                -1.443597e-02 3 1  ON 31
ci_033                 4.779999e-03 3 1  ON 32
ci_034                 4.859732e-03 3 1  ON 33
ci_035                -3.435127e-03 3 1  ON 34
ci_036                -1.141773e-02 3 1  ON 35
ci_037                -1.155917e-02 3 1  ON 36
ci_038                 1.015491e-03 3 1  ON 37
ci_039                 1.264215e-03 3 1  ON 38
ci_040                -1.659166e-03 3 1  ON 39
ci_041                 8.281197e-03 3 1  ON 40
ci_042                 8.225094e-03 3 1  ON 41
ci_043                -2.474407e-03 3 1  ON 42
ci_044                -4.149280e-03 3 1  ON 43
ci_045                -1.933527e-03 3 1  ON 44
ci_046                 4.872032e-03 3 1  ON 45
ci_047                 4.739049e-03 3 1  ON 46
ci_048                -1.236033e-02 3 1  ON 47
ci_049                -1.285940e-02 3 1  ON 48
ci_050                 2.853030e-03 3 1  ON 49
ci_051                 2.782929e-03 3 1  ON 50
ci_052                -2.361603e-03 3 1  ON 51
ci_053                -2.350576e-03 3 1  ON 52
ci_054                -2.426725e-03 3 1  ON 53
ci_055                -2.451592e-03 3 1  ON 54
ci_056                 4.683532e-03 3 1  ON 55
ci_057                 4.728969e-03 3 1  ON 56
ci_058                -2.186377e-03 3 1  ON 57
ci_059                -2.183945e-03 3 1  ON 58
ci_060                 4.862353e-03 3 1  ON 59
ci_061                 5.248030e-03 3 1  ON 60
ci_062                -2.871993e-03 3 1  ON 61
ci_063                -2.925523e-03 3 1  ON 62
ci_064                -2.263094e-03 3 1  ON 63
ci_065                -3.431730e-03 3 1  ON 64
ci_066                 4.062454e-03 3 1  ON 65
ci_067                 4.111494e-03 3 1  ON 66
ci_068                -4.391273e-03 3 1  ON 67
ci_069                -4.068205e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.3037
    reference variance = 0.235271
====================================================
  Execution time = 1.3401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9557e-01
  Total weights = 1.9576e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284054296346
                                         uncertainty =       0.001540155622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284054296346
                                         uncertainty =       0.001540155622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376839655
  error estimate for blocks of size 2^( 2) =       0.000388097704
  error estimate for blocks of size 2^( 3) =       0.000398038544
  error estimate for blocks of size 2^( 4) =       0.000404796777
  error estimate for blocks of size 2^( 5) =       0.000408770547
  error estimate for blocks of size 2^( 6) =       0.000411671457
  error estimate for blocks of size 2^( 7) =       0.000411915862

      target function =      -0.919581570191
              le_mean =     -17.213794700465
             les_mean =     296.610297289944
             stat err =       0.000409288661
             autocorr =       1.179631144188
   target nu stat err =       0.000409288661
   target dn stat err =       0.002103983520
      target stat err =       0.003393367616
              std dev =       0.532931751211
             le_variance =       0.284016251449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284050771173
                                         uncertainty =       0.001539971139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284050771173
                                         uncertainty =       0.001539971139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376837327
  error estimate for blocks of size 2^( 2) =       0.000388096079
  error estimate for blocks of size 2^( 3) =       0.000398038046
  error estimate for blocks of size 2^( 4) =       0.000404797073
  error estimate for blocks of size 2^( 5) =       0.000408771388
  error estimate for blocks of size 2^( 6) =       0.000411672344
  error estimate for blocks of size 2^( 7) =       0.000411916836

      target function =      -0.919593278932
              le_mean =     -17.213794803209
             les_mean =     296.610293414450
             stat err =       0.000409289410
             autocorr =       1.179650041074
   target nu stat err =       0.000409289410
   target dn stat err =       0.002102694623
      target stat err =       0.003391463286
              std dev =       0.532928458490
             le_variance =       0.284012741869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284052507075
                                         uncertainty =       0.001540062535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284052507075
                                         uncertainty =       0.001540062535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376838473
  error estimate for blocks of size 2^( 2) =       0.000388096877
  error estimate for blocks of size 2^( 3) =       0.000398038285
  error estimate for blocks of size 2^( 4) =       0.000404796918
  error estimate for blocks of size 2^( 5) =       0.000408770962
  error estimate for blocks of size 2^( 6) =       0.000411671897
  error estimate for blocks of size 2^( 7) =       0.000411916345

      target function =      -0.919589757970
              le_mean =     -17.213794750945
             les_mean =     296.610293842784
             stat err =       0.000409289031
             autocorr =       1.179640674377
   target nu stat err =       0.000409289030
   target dn stat err =       0.002103323121
      target stat err =       0.003392407673
              std dev =       0.532930079884
             le_variance =       0.284014470045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284054070848
                                         uncertainty =       0.001540143943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284054070848
                                         uncertainty =       0.001540143943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376839506
  error estimate for blocks of size 2^( 2) =       0.000388097600
  error estimate for blocks of size 2^( 3) =       0.000398038511
  error estimate for blocks of size 2^( 4) =       0.000404796794
  error estimate for blocks of size 2^( 5) =       0.000408770598
  error estimate for blocks of size 2^( 6) =       0.000411671511
  error estimate for blocks of size 2^( 7) =       0.000411915921

      target function =      -0.919582776057
              le_mean =     -17.213794706625
             les_mean =     296.610296738295
             stat err =       0.000409288706
             autocorr =       1.179632338180
   target nu stat err =       0.000409288706
   target dn stat err =       0.002103899629
      target stat err =       0.003393246870
              std dev =       0.532931540572
             le_variance =       0.284016026937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919581570191        initial
     6.2500e+00     6.2500e+01             1.7164e-05        -0.919593278932  <--
     2.5000e+01     2.5000e+02             4.3235e-06        -0.919589757970
     1.0000e+02     1.0000e+03             1.0829e-06        -0.919582776057

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2810e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -3.778974e-02 3 1  ON 0
ci_002                -2.886430e-02 3 1  ON 1
ci_003                -2.381008e-02 3 1  ON 2
ci_004                 2.111234e-02 3 1  ON 3
ci_005                 2.169805e-02 3 1  ON 4
ci_006                -1.865078e-02 3 1  ON 5
ci_007                -1.860013e-02 3 1  ON 6
ci_008                -7.835265e-03 3 1  ON 7
ci_009                -1.411535e-02 3 1  ON 8
ci_010                -9.007733e-03 3 1  ON 9
ci_011                -9.353645e-03 3 1  ON 10
ci_012                -9.407368e-03 3 1  ON 11
ci_013                -1.929862e-02 3 1  ON 12
ci_014                 1.113721e-02 3 1  ON 13
ci_015                 1.112972e-02 3 1  ON 14
ci_016                 1.602671e-02 3 1  ON 15
ci_017                 1.577459e-02 3 1  ON 16
ci_018                 9.107355e-03 3 1  ON 17
ci_019                 9.236783e-03 3 1  ON 18
ci_020                 1.509080e-02 3 1  ON 19
ci_021                 1.534916e-02 3 1  ON 20
ci_022                 8.340579e-03 3 1  ON 21
ci_023                 8.389474e-03 3 1  ON 22
ci_024                 8.720083e-03 3 1  ON 23
ci_025                 8.753777e-03 3 1  ON 24
ci_026                 1.010577e-02 3 1  ON 25
ci_027                 9.742762e-03 3 1  ON 26
ci_028                -1.445639e-02 3 1  ON 27
ci_029                -1.507121e-02 3 1  ON 28
ci_030                -8.642369e-03 3 1  ON 29
ci_031                -8.609931e-03 3 1  ON 30
ci_032                -1.444046e-02 3 1  ON 31
ci_033                 4.785840e-03 3 1  ON 32
ci_034                 4.865110e-03 3 1  ON 33
ci_035                -3.435169e-03 3 1  ON 34
ci_036                -1.141572e-02 3 1  ON 35
ci_037                -1.155585e-02 3 1  ON 36
ci_038                 1.011561e-03 3 1  ON 37
ci_039                 1.257953e-03 3 1  ON 38
ci_040                -1.658444e-03 3 1  ON 39
ci_041                 8.274249e-03 3 1  ON 40
ci_042                 8.218153e-03 3 1  ON 41
ci_043                -2.471121e-03 3 1  ON 42
ci_044                -4.152332e-03 3 1  ON 43
ci_045                -1.932086e-03 3 1  ON 44
ci_046                 4.870316e-03 3 1  ON 45
ci_047                 4.739801e-03 3 1  ON 46
ci_048                -1.235672e-02 3 1  ON 47
ci_049                -1.287044e-02 3 1  ON 48
ci_050                 2.857982e-03 3 1  ON 49
ci_051                 2.785719e-03 3 1  ON 50
ci_052                -2.359813e-03 3 1  ON 51
ci_053                -2.353963e-03 3 1  ON 52
ci_054                -2.424449e-03 3 1  ON 53
ci_055                -2.453425e-03 3 1  ON 54
ci_056                 4.683169e-03 3 1  ON 55
ci_057                 4.728572e-03 3 1  ON 56
ci_058                -2.185562e-03 3 1  ON 57
ci_059                -2.185847e-03 3 1  ON 58
ci_060                 4.873313e-03 3 1  ON 59
ci_061                 5.243356e-03 3 1  ON 60
ci_062                -2.871799e-03 3 1  ON 61
ci_063                -2.926138e-03 3 1  ON 62
ci_064                -2.257713e-03 3 1  ON 63
ci_065                -3.429239e-03 3 1  ON 64
ci_066                 4.065903e-03 3 1  ON 65
ci_067                 4.114244e-03 3 1  ON 66
ci_068                -4.392491e-03 3 1  ON 67
ci_069                -4.071861e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1775
    reference variance = 0.240374
====================================================
  Execution time = 1.3865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9758e-01
  Total weights = 1.957869924e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285924230312
                                         uncertainty =       0.001614087676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285924230312
                                         uncertainty =       0.001614087676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378173049
  error estimate for blocks of size 2^( 2) =       0.000389433952
  error estimate for blocks of size 2^( 3) =       0.000399568940
  error estimate for blocks of size 2^( 4) =       0.000407251005
  error estimate for blocks of size 2^( 5) =       0.000412471483
  error estimate for blocks of size 2^( 6) =       0.000415367243
  error estimate for blocks of size 2^( 7) =       0.000417129385

      target function =      -0.916391956269
              le_mean =     -17.214466304711
             les_mean =     296.635434152372
             stat err =       0.000413054779
             autocorr =       1.192982716476
   target nu stat err =       0.000413054779
   target dn stat err =       0.002139734795
      target stat err =       0.003430814546
              std dev =       0.534817455341
             le_variance =       0.286029710537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721446630471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916403910052       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916418752016       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916421255091       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916421939101       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916421896978       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916421892127       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916421900404       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916421900168       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916421892841       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916421893318       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.570893e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916403910052       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916407756673       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916408398585       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916408572844       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916408561763       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916408560294       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916408562396       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916408562332       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916408560507       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916408560629       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.690925e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916403910052       residual = 5.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916404880609       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916405042126       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916405085897       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916405083091       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916405082707       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916405083234       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916405083218       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916405082762       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 4.262027e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6420e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -3.777993e-02 3 1  ON 0
ci_002                -2.886269e-02 3 1  ON 1
ci_003                -2.379870e-02 3 1  ON 2
ci_004                 2.110890e-02 3 1  ON 3
ci_005                 2.168893e-02 3 1  ON 4
ci_006                -1.864045e-02 3 1  ON 5
ci_007                -1.859535e-02 3 1  ON 6
ci_008                -7.840631e-03 3 1  ON 7
ci_009                -1.411183e-02 3 1  ON 8
ci_010                -9.002468e-03 3 1  ON 9
ci_011                -9.337641e-03 3 1  ON 10
ci_012                -9.406932e-03 3 1  ON 11
ci_013                -1.930467e-02 3 1  ON 12
ci_014                 1.113987e-02 3 1  ON 13
ci_015                 1.111528e-02 3 1  ON 14
ci_016                 1.601970e-02 3 1  ON 15
ci_017                 1.576947e-02 3 1  ON 16
ci_018                 9.111180e-03 3 1  ON 17
ci_019                 9.236108e-03 3 1  ON 18
ci_020                 1.508431e-02 3 1  ON 19
ci_021                 1.534371e-02 3 1  ON 20
ci_022                 8.344784e-03 3 1  ON 21
ci_023                 8.382075e-03 3 1  ON 22
ci_024                 8.703174e-03 3 1  ON 23
ci_025                 8.742615e-03 3 1  ON 24
ci_026                 1.009675e-02 3 1  ON 25
ci_027                 9.746110e-03 3 1  ON 26
ci_028                -1.446763e-02 3 1  ON 27
ci_029                -1.505770e-02 3 1  ON 28
ci_030                -8.647906e-03 3 1  ON 29
ci_031                -8.618904e-03 3 1  ON 30
ci_032                -1.444405e-02 3 1  ON 31
ci_033                 4.784447e-03 3 1  ON 32
ci_034                 4.870057e-03 3 1  ON 33
ci_035                -3.433862e-03 3 1  ON 34
ci_036                -1.141156e-02 3 1  ON 35
ci_037                -1.155816e-02 3 1  ON 36
ci_038                 1.004506e-03 3 1  ON 37
ci_039                 1.253728e-03 3 1  ON 38
ci_040                -1.651788e-03 3 1  ON 39
ci_041                 8.269739e-03 3 1  ON 40
ci_042                 8.214779e-03 3 1  ON 41
ci_043                -2.466954e-03 3 1  ON 42
ci_044                -4.150114e-03 3 1  ON 43
ci_045                -1.937469e-03 3 1  ON 44
ci_046                 4.860992e-03 3 1  ON 45
ci_047                 4.738232e-03 3 1  ON 46
ci_048                -1.235660e-02 3 1  ON 47
ci_049                -1.286857e-02 3 1  ON 48
ci_050                 2.857073e-03 3 1  ON 49
ci_051                 2.788875e-03 3 1  ON 50
ci_052                -2.359445e-03 3 1  ON 51
ci_053                -2.354698e-03 3 1  ON 52
ci_054                -2.417053e-03 3 1  ON 53
ci_055                -2.449376e-03 3 1  ON 54
ci_056                 4.680915e-03 3 1  ON 55
ci_057                 4.727843e-03 3 1  ON 56
ci_058                -2.175983e-03 3 1  ON 57
ci_059                -2.191480e-03 3 1  ON 58
ci_060                 4.864495e-03 3 1  ON 59
ci_061                 5.245573e-03 3 1  ON 60
ci_062                -2.866931e-03 3 1  ON 61
ci_063                -2.921512e-03 3 1  ON 62
ci_064                -2.260537e-03 3 1  ON 63
ci_065                -3.431037e-03 3 1  ON 64
ci_066                 4.069154e-03 3 1  ON 65
ci_067                 4.115676e-03 3 1  ON 66
ci_068                -4.391438e-03 3 1  ON 67
ci_069                -4.063988e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2514
    reference variance = 0.309654
====================================================
  Execution time = 1.3881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0521e-01
  Total weights = 1.9575e+06
  Execution time = 1.8768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287075577370
                                         uncertainty =       0.001799820726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287075577370
                                         uncertainty =       0.001799820726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378898733
  error estimate for blocks of size 2^( 2) =       0.000390220752
  error estimate for blocks of size 2^( 3) =       0.000400566541
  error estimate for blocks of size 2^( 4) =       0.000407741624
  error estimate for blocks of size 2^( 5) =       0.000412092931
  error estimate for blocks of size 2^( 6) =       0.000414768969
  error estimate for blocks of size 2^( 7) =       0.000416439888

      target function =      -0.904441972056
              le_mean =     -17.214606762413
             les_mean =     296.647946134560
             stat err =       0.000412760853
             autocorr =       1.186726652970
   target nu stat err =       0.000412760853
   target dn stat err =       0.005110619924
      target stat err =       0.007844166387
              std dev =       0.535843726954
             le_variance =       0.287128499716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047268010
                                         uncertainty =       0.001797842005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287047268010
                                         uncertainty =       0.001797842005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378880067
  error estimate for blocks of size 2^( 2) =       0.000390206466
  error estimate for blocks of size 2^( 3) =       0.000400557474
  error estimate for blocks of size 2^( 4) =       0.000407735875
  error estimate for blocks of size 2^( 5) =       0.000412089620
  error estimate for blocks of size 2^( 6) =       0.000414765147
  error estimate for blocks of size 2^( 7) =       0.000416438292

      target function =      -0.904609547449
              le_mean =     -17.214606240830
             les_mean =     296.647819118320
             stat err =       0.000412757233
             autocorr =       1.186822774401
   target nu stat err =       0.000412757233
   target dn stat err =       0.005079741225
      target stat err =       0.007800010568
              std dev =       0.535817328701
             le_variance =       0.287100209736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287060672443
                                         uncertainty =       0.001798757211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287060672443
                                         uncertainty =       0.001798757211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378888906
  error estimate for blocks of size 2^( 2) =       0.000390213181
  error estimate for blocks of size 2^( 3) =       0.000400561656
  error estimate for blocks of size 2^( 4) =       0.000407738446
  error estimate for blocks of size 2^( 5) =       0.000412091020
  error estimate for blocks of size 2^( 6) =       0.000414766792
  error estimate for blocks of size 2^( 7) =       0.000416438867

      target function =      -0.904585415858
              le_mean =     -17.214606467914
             les_mean =     296.647842475251
             stat err =       0.000412758781
             autocorr =       1.186776301108
   target nu stat err =       0.000412758781
   target dn stat err =       0.005093416310
      target stat err =       0.007820432037
              std dev =       0.535829829073
             le_variance =       0.287113605724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287073668930
                                         uncertainty =       0.001799683480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287073668930
                                         uncertainty =       0.001799683480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378897475
  error estimate for blocks of size 2^( 2) =       0.000390219778
  error estimate for blocks of size 2^( 3) =       0.000400565905
  error estimate for blocks of size 2^( 4) =       0.000407741203
  error estimate for blocks of size 2^( 5) =       0.000412092671
  error estimate for blocks of size 2^( 6) =       0.000414768675
  error estimate for blocks of size 2^( 7) =       0.000416439740

      target function =      -0.904461611295
              le_mean =     -17.214606722166
             les_mean =     296.647931941857
             stat err =       0.000412760572
             autocorr =       1.186732919444
   target nu stat err =       0.000412760572
   target dn stat err =       0.005108338501
      target stat err =       0.007841030431
              std dev =       0.535841947464
             le_variance =       0.287126592662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904441972056        initial
     1.5625e+00     1.5625e+01             6.5709e-05        -0.904609547449  <--
     6.2500e+00     6.2500e+01             1.6909e-05        -0.904585415858
     2.5000e+01     2.5000e+02             4.2620e-06        -0.904461611295

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3357e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -3.775156e-02 3 1  ON 0
ci_002                -2.885808e-02 3 1  ON 1
ci_003                -2.376593e-02 3 1  ON 2
ci_004                 2.109889e-02 3 1  ON 3
ci_005                 2.166268e-02 3 1  ON 4
ci_006                -1.861063e-02 3 1  ON 5
ci_007                -1.858164e-02 3 1  ON 6
ci_008                -7.855900e-03 3 1  ON 7
ci_009                -1.410175e-02 3 1  ON 8
ci_010                -8.987374e-03 3 1  ON 9
ci_011                -9.291711e-03 3 1  ON 10
ci_012                -9.405686e-03 3 1  ON 11
ci_013                -1.932220e-02 3 1  ON 12
ci_014                 1.114751e-02 3 1  ON 13
ci_015                 1.107382e-02 3 1  ON 14
ci_016                 1.599956e-02 3 1  ON 15
ci_017                 1.575472e-02 3 1  ON 16
ci_018                 9.122075e-03 3 1  ON 17
ci_019                 9.234113e-03 3 1  ON 18
ci_020                 1.506561e-02 3 1  ON 19
ci_021                 1.532812e-02 3 1  ON 20
ci_022                 8.356882e-03 3 1  ON 21
ci_023                 8.360829e-03 3 1  ON 22
ci_024                 8.654374e-03 3 1  ON 23
ci_025                 8.710393e-03 3 1  ON 24
ci_026                 1.007091e-02 3 1  ON 25
ci_027                 9.755590e-03 3 1  ON 26
ci_028                -1.450005e-02 3 1  ON 27
ci_029                -1.501873e-02 3 1  ON 28
ci_030                -8.663759e-03 3 1  ON 29
ci_031                -8.644556e-03 3 1  ON 30
ci_032                -1.445438e-02 3 1  ON 31
ci_033                 4.780406e-03 3 1  ON 32
ci_034                 4.884275e-03 3 1  ON 33
ci_035                -3.430126e-03 3 1  ON 34
ci_036                -1.139957e-02 3 1  ON 35
ci_037                -1.156463e-02 3 1  ON 36
ci_038                 9.843327e-04 3 1  ON 37
ci_039                 1.241644e-03 3 1  ON 38
ci_040                -1.632761e-03 3 1  ON 39
ci_041                 8.256993e-03 3 1  ON 40
ci_042                 8.205002e-03 3 1  ON 41
ci_043                -2.455021e-03 3 1  ON 42
ci_044                -4.143755e-03 3 1  ON 43
ci_045                -1.952863e-03 3 1  ON 44
ci_046                 4.834185e-03 3 1  ON 45
ci_047                 4.733728e-03 3 1  ON 46
ci_048                -1.235640e-02 3 1  ON 47
ci_049                -1.286344e-02 3 1  ON 48
ci_050                 2.854477e-03 3 1  ON 49
ci_051                 2.797874e-03 3 1  ON 50
ci_052                -2.358446e-03 3 1  ON 51
ci_053                -2.356763e-03 3 1  ON 52
ci_054                -2.395891e-03 3 1  ON 53
ci_055                -2.437794e-03 3 1  ON 54
ci_056                 4.674466e-03 3 1  ON 55
ci_057                 4.725754e-03 3 1  ON 56
ci_058                -2.148726e-03 3 1  ON 57
ci_059                -2.207568e-03 3 1  ON 58
ci_060                 4.839132e-03 3 1  ON 59
ci_061                 5.251953e-03 3 1  ON 60
ci_062                -2.852861e-03 3 1  ON 61
ci_063                -2.908170e-03 3 1  ON 62
ci_064                -2.268597e-03 3 1  ON 63
ci_065                -3.436178e-03 3 1  ON 64
ci_066                 4.078475e-03 3 1  ON 65
ci_067                 4.119764e-03 3 1  ON 66
ci_068                -4.388430e-03 3 1  ON 67
ci_069                -4.041385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9786e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2361
    reference variance = 0.226139
====================================================
  Execution time = 1.6123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9947e-01
  Total weights = 1.957595548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286467852032
                                         uncertainty =       0.001579676685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286467852032
                                         uncertainty =       0.001579676685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378475350
  error estimate for blocks of size 2^( 2) =       0.000389848411
  error estimate for blocks of size 2^( 3) =       0.000400808449
  error estimate for blocks of size 2^( 4) =       0.000409046721
  error estimate for blocks of size 2^( 5) =       0.000414473721
  error estimate for blocks of size 2^( 6) =       0.000417927391
  error estimate for blocks of size 2^( 7) =       0.000419272073

      target function =      -0.913428416937
              le_mean =     -17.214669440389
             les_mean =     296.644315479032
             stat err =       0.000415179977
             autocorr =       1.203365627383
   target nu stat err =       0.000415179977
   target dn stat err =       0.002473077440
      target stat err =       0.003921154558
              std dev =       0.535244972565
             le_variance =       0.286487180656


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466944039e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913444206549       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913612811018       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913629616557       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913630907164       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913631277437       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913630956870       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913630946548       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913630933117       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913630920794       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913630912697       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.470204e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913444206549       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913492555715       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913497206418       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913497530213       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913497624080       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913497537004       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913497533527       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913497530575       residual = 9.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913497527485       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913497525568       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 9.979625e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913444206549       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913456755050       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913457949334       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913458030023       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913458053516       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913458031289       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913458030352       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913458029648       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913458028877       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913458028407       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.592217e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8655e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -3.771191e-02 3 1  ON 0
ci_002                -2.878546e-02 3 1  ON 1
ci_003                -2.372990e-02 3 1  ON 2
ci_004                 2.110666e-02 3 1  ON 3
ci_005                 2.163668e-02 3 1  ON 4
ci_006                -1.858871e-02 3 1  ON 5
ci_007                -1.858393e-02 3 1  ON 6
ci_008                -7.867846e-03 3 1  ON 7
ci_009                -1.405807e-02 3 1  ON 8
ci_010                -8.959223e-03 3 1  ON 9
ci_011                -9.243439e-03 3 1  ON 10
ci_012                -9.319200e-03 3 1  ON 11
ci_013                -1.933019e-02 3 1  ON 12
ci_014                 1.123584e-02 3 1  ON 13
ci_015                 1.107546e-02 3 1  ON 14
ci_016                 1.600823e-02 3 1  ON 15
ci_017                 1.574011e-02 3 1  ON 16
ci_018                 9.032613e-03 3 1  ON 17
ci_019                 9.193558e-03 3 1  ON 18
ci_020                 1.502585e-02 3 1  ON 19
ci_021                 1.534501e-02 3 1  ON 20
ci_022                 8.318581e-03 3 1  ON 21
ci_023                 8.368417e-03 3 1  ON 22
ci_024                 8.661225e-03 3 1  ON 23
ci_025                 8.688601e-03 3 1  ON 24
ci_026                 1.013830e-02 3 1  ON 25
ci_027                 9.739098e-03 3 1  ON 26
ci_028                -1.452301e-02 3 1  ON 27
ci_029                -1.503945e-02 3 1  ON 28
ci_030                -8.672657e-03 3 1  ON 29
ci_031                -8.689893e-03 3 1  ON 30
ci_032                -1.443570e-02 3 1  ON 31
ci_033                 4.783731e-03 3 1  ON 32
ci_034                 4.869754e-03 3 1  ON 33
ci_035                -3.411792e-03 3 1  ON 34
ci_036                -1.140730e-02 3 1  ON 35
ci_037                -1.154621e-02 3 1  ON 36
ci_038                 9.963821e-04 3 1  ON 37
ci_039                 1.236409e-03 3 1  ON 38
ci_040                -1.627628e-03 3 1  ON 39
ci_041                 8.226010e-03 3 1  ON 40
ci_042                 8.245203e-03 3 1  ON 41
ci_043                -2.452069e-03 3 1  ON 42
ci_044                -4.104737e-03 3 1  ON 43
ci_045                -1.927361e-03 3 1  ON 44
ci_046                 4.822858e-03 3 1  ON 45
ci_047                 4.742809e-03 3 1  ON 46
ci_048                -1.238118e-02 3 1  ON 47
ci_049                -1.285656e-02 3 1  ON 48
ci_050                 2.853835e-03 3 1  ON 49
ci_051                 2.795719e-03 3 1  ON 50
ci_052                -2.341918e-03 3 1  ON 51
ci_053                -2.279011e-03 3 1  ON 52
ci_054                -2.349169e-03 3 1  ON 53
ci_055                -2.455587e-03 3 1  ON 54
ci_056                 4.660446e-03 3 1  ON 55
ci_057                 4.739064e-03 3 1  ON 56
ci_058                -2.087123e-03 3 1  ON 57
ci_059                -2.307364e-03 3 1  ON 58
ci_060                 4.804003e-03 3 1  ON 59
ci_061                 5.225149e-03 3 1  ON 60
ci_062                -2.839168e-03 3 1  ON 61
ci_063                -2.901622e-03 3 1  ON 62
ci_064                -2.261973e-03 3 1  ON 63
ci_065                -3.435712e-03 3 1  ON 64
ci_066                 4.083941e-03 3 1  ON 65
ci_067                 4.110703e-03 3 1  ON 66
ci_068                -4.364908e-03 3 1  ON 67
ci_069                -4.082178e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2775
    reference variance = 0.258055
====================================================
  Execution time = 1.3976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9976e-01
  Total weights = 1.9577e+06
  Execution time = 1.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288103805358
                                         uncertainty =       0.001818032861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288103805358
                                         uncertainty =       0.001818032861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379513037
  error estimate for blocks of size 2^( 2) =       0.000391108693
  error estimate for blocks of size 2^( 3) =       0.000401505180
  error estimate for blocks of size 2^( 4) =       0.000408589279
  error estimate for blocks of size 2^( 5) =       0.000413949143
  error estimate for blocks of size 2^( 6) =       0.000415724849
  error estimate for blocks of size 2^( 7) =       0.000417558212

      target function =      -0.909278812761
              le_mean =     -17.214505582339
             les_mean =     296.641340079164
             stat err =       0.000413955371
             autocorr =       1.189744330100
   target nu stat err =       0.000413955371
   target dn stat err =       0.003631168768
      target stat err =       0.005653487431
              std dev =       0.536712484387
             le_variance =       0.288060290896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288086927232
                                         uncertainty =       0.001815924857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288086927232
                                         uncertainty =       0.001815924857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379501836
  error estimate for blocks of size 2^( 2) =       0.000391118710
  error estimate for blocks of size 2^( 3) =       0.000401534388
  error estimate for blocks of size 2^( 4) =       0.000408634916
  error estimate for blocks of size 2^( 5) =       0.000413992021
  error estimate for blocks of size 2^( 6) =       0.000415768356
  error estimate for blocks of size 2^( 7) =       0.000417610390

      target function =      -0.903763022548
              le_mean =     -17.214509523372
             les_mean =     296.645020348049
             stat err =       0.000414001421
             autocorr =       1.190079298481
   target nu stat err =       0.000414001421
   target dn stat err =       0.006440251514
      target stat err =       0.009854508223
              std dev =       0.536696643313
             le_variance =       0.288043286944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085073152
                                         uncertainty =       0.001817419278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288085073152
                                         uncertainty =       0.001817419278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379500647
  error estimate for blocks of size 2^( 2) =       0.000391108668
  error estimate for blocks of size 2^( 3) =       0.000401516412
  error estimate for blocks of size 2^( 4) =       0.000408610621
  error estimate for blocks of size 2^( 5) =       0.000413969807
  error estimate for blocks of size 2^( 6) =       0.000415743440
  error estimate for blocks of size 2^( 7) =       0.000417582292

      target function =      -0.913295716471
              le_mean =     -17.214508208005
             les_mean =     296.638854146357
             stat err =       0.000413976540
             autocorr =       1.189943712703
   target nu stat err =       0.000413976540
   target dn stat err =       0.002390406133
      target stat err =       0.003791817333
              std dev =       0.536694962223
             le_variance =       0.288041482475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288100456347
                                         uncertainty =       0.001817960640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288100456347
                                         uncertainty =       0.001817960640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379510825
  error estimate for blocks of size 2^( 2) =       0.000391108136
  error estimate for blocks of size 2^( 3) =       0.000401506077
  error estimate for blocks of size 2^( 4) =       0.000408591522
  error estimate for blocks of size 2^( 5) =       0.000413951312
  error estimate for blocks of size 2^( 6) =       0.000415727241
  error estimate for blocks of size 2^( 7) =       0.000417560915

      target function =      -0.911472209913
              le_mean =     -17.214505908377
             les_mean =     296.639944430626
             stat err =       0.000413957747
             autocorr =       1.189771863701
   target nu stat err =       0.000413957747
   target dn stat err =       0.002739217647
      target stat err =       0.004310071630
              std dev =       0.536709355663
             le_variance =       0.288056932456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909278812761        initial
     3.9062e-01     3.9062e+00             3.4702e-04        -0.903763022548
     1.5625e+00     1.5625e+01             9.9796e-05        -0.913295716471  <--
     6.2500e+00     6.2500e+01             2.5922e-05        -0.911472209913

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3459e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -3.771191e-02 3 1  ON 0
ci_002                -2.878546e-02 3 1  ON 1
ci_003                -2.372990e-02 3 1  ON 2
ci_004                 2.110666e-02 3 1  ON 3
ci_005                 2.163668e-02 3 1  ON 4
ci_006                -1.858871e-02 3 1  ON 5
ci_007                -1.858393e-02 3 1  ON 6
ci_008                -7.867846e-03 3 1  ON 7
ci_009                -1.405807e-02 3 1  ON 8
ci_010                -8.959223e-03 3 1  ON 9
ci_011                -9.243439e-03 3 1  ON 10
ci_012                -9.319200e-03 3 1  ON 11
ci_013                -1.933019e-02 3 1  ON 12
ci_014                 1.123584e-02 3 1  ON 13
ci_015                 1.107546e-02 3 1  ON 14
ci_016                 1.600823e-02 3 1  ON 15
ci_017                 1.574011e-02 3 1  ON 16
ci_018                 9.032613e-03 3 1  ON 17
ci_019                 9.193558e-03 3 1  ON 18
ci_020                 1.502585e-02 3 1  ON 19
ci_021                 1.534501e-02 3 1  ON 20
ci_022                 8.318581e-03 3 1  ON 21
ci_023                 8.368417e-03 3 1  ON 22
ci_024                 8.661225e-03 3 1  ON 23
ci_025                 8.688601e-03 3 1  ON 24
ci_026                 1.013830e-02 3 1  ON 25
ci_027                 9.739098e-03 3 1  ON 26
ci_028                -1.452301e-02 3 1  ON 27
ci_029                -1.503945e-02 3 1  ON 28
ci_030                -8.672657e-03 3 1  ON 29
ci_031                -8.689893e-03 3 1  ON 30
ci_032                -1.443570e-02 3 1  ON 31
ci_033                 4.783731e-03 3 1  ON 32
ci_034                 4.869754e-03 3 1  ON 33
ci_035                -3.411792e-03 3 1  ON 34
ci_036                -1.140730e-02 3 1  ON 35
ci_037                -1.154621e-02 3 1  ON 36
ci_038                 9.963821e-04 3 1  ON 37
ci_039                 1.236409e-03 3 1  ON 38
ci_040                -1.627628e-03 3 1  ON 39
ci_041                 8.226010e-03 3 1  ON 40
ci_042                 8.245203e-03 3 1  ON 41
ci_043                -2.452069e-03 3 1  ON 42
ci_044                -4.104737e-03 3 1  ON 43
ci_045                -1.927361e-03 3 1  ON 44
ci_046                 4.822858e-03 3 1  ON 45
ci_047                 4.742809e-03 3 1  ON 46
ci_048                -1.238118e-02 3 1  ON 47
ci_049                -1.285656e-02 3 1  ON 48
ci_050                 2.853835e-03 3 1  ON 49
ci_051                 2.795719e-03 3 1  ON 50
ci_052                -2.341918e-03 3 1  ON 51
ci_053                -2.279011e-03 3 1  ON 52
ci_054                -2.349169e-03 3 1  ON 53
ci_055                -2.455587e-03 3 1  ON 54
ci_056                 4.660446e-03 3 1  ON 55
ci_057                 4.739064e-03 3 1  ON 56
ci_058                -2.087123e-03 3 1  ON 57
ci_059                -2.307364e-03 3 1  ON 58
ci_060                 4.804003e-03 3 1  ON 59
ci_061                 5.225149e-03 3 1  ON 60
ci_062                -2.839168e-03 3 1  ON 61
ci_063                -2.901622e-03 3 1  ON 62
ci_064                -2.261973e-03 3 1  ON 63
ci_065                -3.435712e-03 3 1  ON 64
ci_066                 4.083941e-03 3 1  ON 65
ci_067                 4.110703e-03 3 1  ON 66
ci_068                -4.364908e-03 3 1  ON 67
ci_069                -4.082178e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1669
    reference variance = 0.332583
====================================================
  Execution time = 1.3973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9820e-01
  Total weights = 1.957524274e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286492775387
                                         uncertainty =       0.001910392097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286492775387
                                         uncertainty =       0.001910392097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378496450
  error estimate for blocks of size 2^( 2) =       0.000389785686
  error estimate for blocks of size 2^( 3) =       0.000400356917
  error estimate for blocks of size 2^( 4) =       0.000408623018
  error estimate for blocks of size 2^( 5) =       0.000414102338
  error estimate for blocks of size 2^( 6) =       0.000418621994
  error estimate for blocks of size 2^( 7) =       0.000419079106

      target function =      -0.915436685563
              le_mean =     -17.214147171950
             les_mean =     296.625060625480
             stat err =       0.000415106614
             autocorr =       1.202806272743
   target nu stat err =       0.000415106614
   target dn stat err =       0.002477839805
      target stat err =       0.003941601439
              std dev =       0.535274813413
             le_variance =       0.286519125874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721414717195e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915452689125       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915509808219       residual = 8.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915519967744       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915523267381       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915523633375       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915523748788       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915523844695       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915523839111       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915523863671       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915523867455       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.389920e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915452689125       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915468984673       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915471797633       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915472684132       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915472777409       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915472805547       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915472831075       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915472829639       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915472835867       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915472836780       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 6.623150e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915452689125       residual = 6.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915456912032       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915457634581       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915457860272       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915457883651       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915457890615       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915457897095       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915457896735       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915457898294       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915457898519       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.701951e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6495e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -3.775312e-02 3 1  ON 0
ci_002                -2.877832e-02 3 1  ON 1
ci_003                -2.370041e-02 3 1  ON 2
ci_004                 2.104043e-02 3 1  ON 3
ci_005                 2.159498e-02 3 1  ON 4
ci_006                -1.857929e-02 3 1  ON 5
ci_007                -1.858711e-02 3 1  ON 6
ci_008                -7.866675e-03 3 1  ON 7
ci_009                -1.404091e-02 3 1  ON 8
ci_010                -8.975638e-03 3 1  ON 9
ci_011                -9.242419e-03 3 1  ON 10
ci_012                -9.323471e-03 3 1  ON 11
ci_013                -1.930280e-02 3 1  ON 12
ci_014                 1.121143e-02 3 1  ON 13
ci_015                 1.107699e-02 3 1  ON 14
ci_016                 1.598633e-02 3 1  ON 15
ci_017                 1.568431e-02 3 1  ON 16
ci_018                 9.001065e-03 3 1  ON 17
ci_019                 9.202124e-03 3 1  ON 18
ci_020                 1.501511e-02 3 1  ON 19
ci_021                 1.535703e-02 3 1  ON 20
ci_022                 8.349764e-03 3 1  ON 21
ci_023                 8.374050e-03 3 1  ON 22
ci_024                 8.599501e-03 3 1  ON 23
ci_025                 8.631580e-03 3 1  ON 24
ci_026                 1.010767e-02 3 1  ON 25
ci_027                 9.758627e-03 3 1  ON 26
ci_028                -1.452103e-02 3 1  ON 27
ci_029                -1.503420e-02 3 1  ON 28
ci_030                -8.635276e-03 3 1  ON 29
ci_031                -8.658956e-03 3 1  ON 30
ci_032                -1.444503e-02 3 1  ON 31
ci_033                 4.761014e-03 3 1  ON 32
ci_034                 4.880930e-03 3 1  ON 33
ci_035                -3.410981e-03 3 1  ON 34
ci_036                -1.141505e-02 3 1  ON 35
ci_037                -1.150298e-02 3 1  ON 36
ci_038                 9.667770e-04 3 1  ON 37
ci_039                 1.208686e-03 3 1  ON 38
ci_040                -1.563108e-03 3 1  ON 39
ci_041                 8.212236e-03 3 1  ON 40
ci_042                 8.228175e-03 3 1  ON 41
ci_043                -2.452347e-03 3 1  ON 42
ci_044                -4.101584e-03 3 1  ON 43
ci_045                -1.924199e-03 3 1  ON 44
ci_046                 4.782563e-03 3 1  ON 45
ci_047                 4.737014e-03 3 1  ON 46
ci_048                -1.240062e-02 3 1  ON 47
ci_049                -1.282040e-02 3 1  ON 48
ci_050                 2.864694e-03 3 1  ON 49
ci_051                 2.807650e-03 3 1  ON 50
ci_052                -2.351778e-03 3 1  ON 51
ci_053                -2.280401e-03 3 1  ON 52
ci_054                -2.347352e-03 3 1  ON 53
ci_055                -2.445214e-03 3 1  ON 54
ci_056                 4.665106e-03 3 1  ON 55
ci_057                 4.723393e-03 3 1  ON 56
ci_058                -2.072693e-03 3 1  ON 57
ci_059                -2.322014e-03 3 1  ON 58
ci_060                 4.771711e-03 3 1  ON 59
ci_061                 5.211480e-03 3 1  ON 60
ci_062                -2.846168e-03 3 1  ON 61
ci_063                -2.919836e-03 3 1  ON 62
ci_064                -2.238851e-03 3 1  ON 63
ci_065                -3.428053e-03 3 1  ON 64
ci_066                 4.086759e-03 3 1  ON 65
ci_067                 4.118464e-03 3 1  ON 66
ci_068                -4.412160e-03 3 1  ON 67
ci_069                -4.055730e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.15063
====================================================
  Execution time = 1.3592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0270e-01
  Total weights = 1.9576e+06
  Execution time = 1.8599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288586275968
                                         uncertainty =       0.001820966105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288586275968
                                         uncertainty =       0.001820966105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379829162
  error estimate for blocks of size 2^( 2) =       0.000391222937
  error estimate for blocks of size 2^( 3) =       0.000401958875
  error estimate for blocks of size 2^( 4) =       0.000409813775
  error estimate for blocks of size 2^( 5) =       0.000415291545
  error estimate for blocks of size 2^( 6) =       0.000418768429
  error estimate for blocks of size 2^( 7) =       0.000420262985

      target function =      -0.898375188246
              le_mean =     -17.214636343339
             les_mean =     296.652915646718
             stat err =       0.000416034184
             autocorr =       1.199724204141
   target nu stat err =       0.000416034184
   target dn stat err =       0.007200181934
      target stat err =       0.010884229735
              std dev =       0.537159552627
             le_variance =       0.288540384979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288556617937
                                         uncertainty =       0.001814036181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288556617937
                                         uncertainty =       0.001814036181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379809880
  error estimate for blocks of size 2^( 2) =       0.000391212672
  error estimate for blocks of size 2^( 3) =       0.000401958405
  error estimate for blocks of size 2^( 4) =       0.000409826782
  error estimate for blocks of size 2^( 5) =       0.000415310799
  error estimate for blocks of size 2^( 6) =       0.000418800777
  error estimate for blocks of size 2^( 7) =       0.000420296190

      target function =      -0.908201016949
              le_mean =     -17.214633910612
             les_mean =     296.646459681248
             stat err =       0.000416058637
             autocorr =       1.199987072053
   target nu stat err =       0.000416058637
   target dn stat err =       0.003011390588
      target stat err =       0.004695559507
              std dev =       0.537132283987
             le_variance =       0.288511090501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288566680023
                                         uncertainty =       0.001817031091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288566680023
                                         uncertainty =       0.001817031091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379816401
  error estimate for blocks of size 2^( 2) =       0.000391215249
  error estimate for blocks of size 2^( 3) =       0.000401956718
  error estimate for blocks of size 2^( 4) =       0.000409819269
  error estimate for blocks of size 2^( 5) =       0.000415300677
  error estimate for blocks of size 2^( 6) =       0.000418784984
  error estimate for blocks of size 2^( 7) =       0.000420280176

      target function =      -0.908221149526
              le_mean =     -17.214634645220
             les_mean =     296.646470636555
             stat err =       0.000416046276
             autocorr =       1.199874570198
   target nu stat err =       0.000416046276
   target dn stat err =       0.003131576198
      target stat err =       0.004879029669
              std dev =       0.537141506187
             le_variance =       0.288520997669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288583331937
                                         uncertainty =       0.001820455152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288583331937
                                         uncertainty =       0.001820455152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379827243
  error estimate for blocks of size 2^( 2) =       0.000391221670
  error estimate for blocks of size 2^( 3) =       0.000401958333
  error estimate for blocks of size 2^( 4) =       0.000409814260
  error estimate for blocks of size 2^( 5) =       0.000415292603
  error estimate for blocks of size 2^( 6) =       0.000418770317
  error estimate for blocks of size 2^( 7) =       0.000420265006

      target function =      -0.908286914925
              le_mean =     -17.214636024129
             les_mean =     296.646473405990
             stat err =       0.000416035546
             autocorr =       1.199744190924
   target nu stat err =       0.000416035546
   target dn stat err =       0.003314763212
      target stat err =       0.005159388218
              std dev =       0.537156837750
             le_variance =       0.288537468341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898375188246        initial
     3.9062e-01     3.9062e+00             2.3899e-04        -0.908201016949
     1.5625e+00     1.5625e+01             6.6232e-05        -0.908221149526
     6.2500e+00     6.2500e+01             1.7020e-05        -0.908286914925  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3004e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -3.772247e-02 3 1  ON 0
ci_002                -2.878362e-02 3 1  ON 1
ci_003                -2.372232e-02 3 1  ON 2
ci_004                 2.108964e-02 3 1  ON 3
ci_005                 2.162592e-02 3 1  ON 4
ci_006                -1.858627e-02 3 1  ON 5
ci_007                -1.858473e-02 3 1  ON 6
ci_008                -7.867554e-03 3 1  ON 7
ci_009                -1.405363e-02 3 1  ON 8
ci_010                -8.963470e-03 3 1  ON 9
ci_011                -9.243180e-03 3 1  ON 10
ci_012                -9.320307e-03 3 1  ON 11
ci_013                -1.932317e-02 3 1  ON 12
ci_014                 1.122955e-02 3 1  ON 13
ci_015                 1.107584e-02 3 1  ON 14
ci_016                 1.600260e-02 3 1  ON 15
ci_017                 1.572576e-02 3 1  ON 16
ci_018                 9.024423e-03 3 1  ON 17
ci_019                 9.195780e-03 3 1  ON 18
ci_020                 1.502307e-02 3 1  ON 19
ci_021                 1.534812e-02 3 1  ON 20
ci_022                 8.326619e-03 3 1  ON 21
ci_023                 8.369874e-03 3 1  ON 22
ci_024                 8.645318e-03 3 1  ON 23
ci_025                 8.673893e-03 3 1  ON 24
ci_026                 1.013042e-02 3 1  ON 25
ci_027                 9.744185e-03 3 1  ON 26
ci_028                -1.452250e-02 3 1  ON 27
ci_029                -1.503810e-02 3 1  ON 28
ci_030                -8.662961e-03 3 1  ON 29
ci_031                -8.681909e-03 3 1  ON 30
ci_032                -1.443811e-02 3 1  ON 31
ci_033                 4.777873e-03 3 1  ON 32
ci_034                 4.872636e-03 3 1  ON 33
ci_035                -3.411581e-03 3 1  ON 34
ci_036                -1.140934e-02 3 1  ON 35
ci_037                -1.153502e-02 3 1  ON 36
ci_038                 9.887120e-04 3 1  ON 37
ci_039                 1.229229e-03 3 1  ON 38
ci_040                -1.610903e-03 3 1  ON 39
ci_041                 8.222436e-03 3 1  ON 40
ci_042                 8.240790e-03 3 1  ON 41
ci_043                -2.452140e-03 3 1  ON 42
ci_044                -4.103915e-03 3 1  ON 43
ci_045                -1.926540e-03 3 1  ON 44
ci_046                 4.812460e-03 3 1  ON 45
ci_047                 4.741308e-03 3 1  ON 46
ci_048                -1.238620e-02 3 1  ON 47
ci_049                -1.284728e-02 3 1  ON 48
ci_050                 2.856651e-03 3 1  ON 49
ci_051                 2.798817e-03 3 1  ON 50
ci_052                -2.344475e-03 3 1  ON 51
ci_053                -2.279389e-03 3 1  ON 52
ci_054                -2.348700e-03 3 1  ON 53
ci_055                -2.452926e-03 3 1  ON 54
ci_056                 4.661650e-03 3 1  ON 55
ci_057                 4.735011e-03 3 1  ON 56
ci_058                -2.083386e-03 3 1  ON 57
ci_059                -2.311143e-03 3 1  ON 58
ci_060                 4.795672e-03 3 1  ON 59
ci_061                 5.221623e-03 3 1  ON 60
ci_062                -2.840999e-03 3 1  ON 61
ci_063                -2.906354e-03 3 1  ON 62
ci_064                -2.255975e-03 3 1  ON 63
ci_065                -3.433728e-03 3 1  ON 64
ci_066                 4.084664e-03 3 1  ON 65
ci_067                 4.112714e-03 3 1  ON 66
ci_068                -4.377112e-03 3 1  ON 67
ci_069                -4.075352e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1822
    reference variance = 0.194225
====================================================
  Execution time = 1.3703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0459e-01
  Total weights = 1.957647526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289912912235
                                         uncertainty =       0.002790142547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289912912235
                                         uncertainty =       0.002790142547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380729959
  error estimate for blocks of size 2^( 2) =       0.000392075266
  error estimate for blocks of size 2^( 3) =       0.000402355294
  error estimate for blocks of size 2^( 4) =       0.000410345847
  error estimate for blocks of size 2^( 5) =       0.000414646598
  error estimate for blocks of size 2^( 6) =       0.000418476891
  error estimate for blocks of size 2^( 7) =       0.000420019387

      target function =      -0.905482655014
              le_mean =     -17.214712457112
             les_mean =     296.650919410558
             stat err =       0.000415872181
             autocorr =       1.193124146640
   target nu stat err =       0.000415872181
   target dn stat err =       0.003921300882
      target stat err =       0.006050744797
              std dev =       0.538433471580
             le_variance =       0.289910603318


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471245711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905522339477       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905551128005       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905557636388       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905558469676       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905558600725       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905558665811       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905558702880       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905558704942       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905558701354       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905558701893       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.498703e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905522339477       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905529799311       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905531469641       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905531680299       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905531712605       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905531728767       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905531738040       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905531738543       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905531737645       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905531737786       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.874049e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905522339477       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905524221610       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905524641977       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905524694784       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905524702829       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905524706862       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905524709180       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905524709305       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905524709080       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905524709116       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.768081e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6251e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -3.771547e-02 3 1  ON 0
ci_002                -2.879050e-02 3 1  ON 1
ci_003                -2.372106e-02 3 1  ON 2
ci_004                 2.107160e-02 3 1  ON 3
ci_005                 2.161365e-02 3 1  ON 4
ci_006                -1.857868e-02 3 1  ON 5
ci_007                -1.857471e-02 3 1  ON 6
ci_008                -7.856691e-03 3 1  ON 7
ci_009                -1.406443e-02 3 1  ON 8
ci_010                -8.959952e-03 3 1  ON 9
ci_011                -9.241794e-03 3 1  ON 10
ci_012                -9.299256e-03 3 1  ON 11
ci_013                -1.931238e-02 3 1  ON 12
ci_014                 1.122942e-02 3 1  ON 13
ci_015                 1.107258e-02 3 1  ON 14
ci_016                 1.599621e-02 3 1  ON 15
ci_017                 1.571582e-02 3 1  ON 16
ci_018                 9.022375e-03 3 1  ON 17
ci_019                 9.191657e-03 3 1  ON 18
ci_020                 1.502070e-02 3 1  ON 19
ci_021                 1.533913e-02 3 1  ON 20
ci_022                 8.321489e-03 3 1  ON 21
ci_023                 8.378230e-03 3 1  ON 22
ci_024                 8.643683e-03 3 1  ON 23
ci_025                 8.681950e-03 3 1  ON 24
ci_026                 1.011745e-02 3 1  ON 25
ci_027                 9.740771e-03 3 1  ON 26
ci_028                -1.452793e-02 3 1  ON 27
ci_029                -1.504339e-02 3 1  ON 28
ci_030                -8.675495e-03 3 1  ON 29
ci_031                -8.675689e-03 3 1  ON 30
ci_032                -1.444648e-02 3 1  ON 31
ci_033                 4.754001e-03 3 1  ON 32
ci_034                 4.865159e-03 3 1  ON 33
ci_035                -3.415534e-03 3 1  ON 34
ci_036                -1.140167e-02 3 1  ON 35
ci_037                -1.153668e-02 3 1  ON 36
ci_038                 9.877937e-04 3 1  ON 37
ci_039                 1.234524e-03 3 1  ON 38
ci_040                -1.609238e-03 3 1  ON 39
ci_041                 8.219011e-03 3 1  ON 40
ci_042                 8.231371e-03 3 1  ON 41
ci_043                -2.446026e-03 3 1  ON 42
ci_044                -4.065175e-03 3 1  ON 43
ci_045                -1.919645e-03 3 1  ON 44
ci_046                 4.807281e-03 3 1  ON 45
ci_047                 4.730323e-03 3 1  ON 46
ci_048                -1.239212e-02 3 1  ON 47
ci_049                -1.286418e-02 3 1  ON 48
ci_050                 2.856370e-03 3 1  ON 49
ci_051                 2.804769e-03 3 1  ON 50
ci_052                -2.348554e-03 3 1  ON 51
ci_053                -2.272257e-03 3 1  ON 52
ci_054                -2.352649e-03 3 1  ON 53
ci_055                -2.441685e-03 3 1  ON 54
ci_056                 4.666664e-03 3 1  ON 55
ci_057                 4.731496e-03 3 1  ON 56
ci_058                -2.089965e-03 3 1  ON 57
ci_059                -2.295929e-03 3 1  ON 58
ci_060                 4.789590e-03 3 1  ON 59
ci_061                 5.218592e-03 3 1  ON 60
ci_062                -2.838675e-03 3 1  ON 61
ci_063                -2.906153e-03 3 1  ON 62
ci_064                -2.255359e-03 3 1  ON 63
ci_065                -3.433063e-03 3 1  ON 64
ci_066                 4.086406e-03 3 1  ON 65
ci_067                 4.115614e-03 3 1  ON 66
ci_068                -4.377293e-03 3 1  ON 67
ci_069                -4.072533e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1987
    reference variance = 0.193278
====================================================
  Execution time = 1.3560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9876e-01
  Total weights = 1.9577e+06
  Execution time = 1.8572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287036664325
                                         uncertainty =       0.001928119623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287036664325
                                         uncertainty =       0.001928119623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378800447
  error estimate for blocks of size 2^( 2) =       0.000389654897
  error estimate for blocks of size 2^( 3) =       0.000399293972
  error estimate for blocks of size 2^( 4) =       0.000406959793
  error estimate for blocks of size 2^( 5) =       0.000412065903
  error estimate for blocks of size 2^( 6) =       0.000414604046
  error estimate for blocks of size 2^( 7) =       0.000414727527

      target function =      -0.914522663968
              le_mean =     -17.214453380168
             les_mean =     296.636182659192
             stat err =       0.000412089317
             autocorr =       1.183482243454
   target nu stat err =       0.000412089317
   target dn stat err =       0.002256953429
      target stat err =       0.003596133902
              std dev =       0.535704730013
             le_variance =       0.286979557758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028266269
                                         uncertainty =       0.001926970911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287028266269
                                         uncertainty =       0.001926970911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378794876
  error estimate for blocks of size 2^( 2) =       0.000389655467
  error estimate for blocks of size 2^( 3) =       0.000399299958
  error estimate for blocks of size 2^( 4) =       0.000406971285
  error estimate for blocks of size 2^( 5) =       0.000412078065
  error estimate for blocks of size 2^( 6) =       0.000414618079
  error estimate for blocks of size 2^( 7) =       0.000414744211

      target function =      -0.914576520471
              le_mean =     -17.214454257945
             les_mean =     296.636178413739
             stat err =       0.000412102910
             autocorr =       1.183595134264
   target nu stat err =       0.000412102910
   target dn stat err =       0.002254454904
      target stat err =       0.003592730860
              std dev =       0.535696851010
             le_variance =       0.286971116182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287031966617
                                         uncertainty =       0.001927521909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287031966617
                                         uncertainty =       0.001927521909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378797332
  error estimate for blocks of size 2^( 2) =       0.000389654953
  error estimate for blocks of size 2^( 3) =       0.000399296821
  error estimate for blocks of size 2^( 4) =       0.000406965487
  error estimate for blocks of size 2^( 5) =       0.000412071943
  error estimate for blocks of size 2^( 6) =       0.000414611052
  error estimate for blocks of size 2^( 7) =       0.000414735919

      target function =      -0.914569440334
              le_mean =     -17.214453789601
             les_mean =     296.636166823138
             stat err =       0.000412096100
             autocorr =       1.183540670318
   target nu stat err =       0.000412096100
   target dn stat err =       0.002255370311
      target stat err =       0.003594073680
              std dev =       0.535700324367
             le_variance =       0.286974837527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287036028900
                                         uncertainty =       0.001928043782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287036028900
                                         uncertainty =       0.001928043782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378800026
  error estimate for blocks of size 2^( 2) =       0.000389654876
  error estimate for blocks of size 2^( 3) =       0.000399294302
  error estimate for blocks of size 2^( 4) =       0.000406960482
  error estimate for blocks of size 2^( 5) =       0.000412066636
  error estimate for blocks of size 2^( 6) =       0.000414604900
  error estimate for blocks of size 2^( 7) =       0.000414728555

      target function =      -0.914532693036
              le_mean =     -17.214453426500
             les_mean =     296.636177836751
             stat err =       0.000412090143
             autocorr =       1.183489619723
   target nu stat err =       0.000412090143
   target dn stat err =       0.002256690338
      target stat err =       0.003595808703
              std dev =       0.535704134305
             le_variance =       0.286978919511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914522663968        initial
     1.5625e+00     1.5625e+01             1.4987e-04        -0.914576520471  <--
     6.2500e+00     6.2500e+01             3.8740e-05        -0.914569440334
     2.5000e+01     2.5000e+02             9.7681e-06        -0.914532693036

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2892e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -3.769523e-02 3 1  ON 0
ci_002                -2.881041e-02 3 1  ON 1
ci_003                -2.371729e-02 3 1  ON 2
ci_004                 2.101924e-02 3 1  ON 3
ci_005                 2.157809e-02 3 1  ON 4
ci_006                -1.855672e-02 3 1  ON 5
ci_007                -1.854581e-02 3 1  ON 6
ci_008                -7.825668e-03 3 1  ON 7
ci_009                -1.409539e-02 3 1  ON 8
ci_010                -8.949856e-03 3 1  ON 9
ci_011                -9.237804e-03 3 1  ON 10
ci_012                -9.238825e-03 3 1  ON 11
ci_013                -1.928107e-02 3 1  ON 12
ci_014                 1.122923e-02 3 1  ON 13
ci_015                 1.106317e-02 3 1  ON 14
ci_016                 1.597774e-02 3 1  ON 15
ci_017                 1.568716e-02 3 1  ON 16
ci_018                 9.016412e-03 3 1  ON 17
ci_019                 9.179838e-03 3 1  ON 18
ci_020                 1.501381e-02 3 1  ON 19
ci_021                 1.531317e-02 3 1  ON 20
ci_022                 8.306813e-03 3 1  ON 21
ci_023                 8.402261e-03 3 1  ON 22
ci_024                 8.638959e-03 3 1  ON 23
ci_025                 8.705242e-03 3 1  ON 24
ci_026                 1.008010e-02 3 1  ON 25
ci_027                 9.730846e-03 3 1  ON 26
ci_028                -1.454362e-02 3 1  ON 27
ci_029                -1.505857e-02 3 1  ON 28
ci_030                -8.711445e-03 3 1  ON 29
ci_031                -8.658186e-03 3 1  ON 30
ci_032                -1.447058e-02 3 1  ON 31
ci_033                 4.685290e-03 3 1  ON 32
ci_034                 4.843605e-03 3 1  ON 33
ci_035                -3.426863e-03 3 1  ON 34
ci_036                -1.137969e-02 3 1  ON 35
ci_037                -1.154131e-02 3 1  ON 36
ci_038                 9.851676e-04 3 1  ON 37
ci_039                 1.249682e-03 3 1  ON 38
ci_040                -1.604481e-03 3 1  ON 39
ci_041                 8.209310e-03 3 1  ON 40
ci_042                 8.204519e-03 3 1  ON 41
ci_043                -2.428506e-03 3 1  ON 42
ci_044                -3.954045e-03 3 1  ON 43
ci_045                -1.899929e-03 3 1  ON 44
ci_046                 4.792381e-03 3 1  ON 45
ci_047                 4.698729e-03 3 1  ON 46
ci_048                -1.240960e-02 3 1  ON 47
ci_049                -1.291304e-02 3 1  ON 48
ci_050                 2.855565e-03 3 1  ON 49
ci_051                 2.821742e-03 3 1  ON 50
ci_052                -2.360144e-03 3 1  ON 51
ci_053                -2.251898e-03 3 1  ON 52
ci_054                -2.363882e-03 3 1  ON 53
ci_055                -2.409485e-03 3 1  ON 54
ci_056                 4.681032e-03 3 1  ON 55
ci_057                 4.721404e-03 3 1  ON 56
ci_058                -2.108813e-03 3 1  ON 57
ci_059                -2.252428e-03 3 1  ON 58
ci_060                 4.772093e-03 3 1  ON 59
ci_061                 5.209879e-03 3 1  ON 60
ci_062                -2.831999e-03 3 1  ON 61
ci_063                -2.905620e-03 3 1  ON 62
ci_064                -2.253601e-03 3 1  ON 63
ci_065                -3.431157e-03 3 1  ON 64
ci_066                 4.091506e-03 3 1  ON 65
ci_067                 4.123959e-03 3 1  ON 66
ci_068                -4.377833e-03 3 1  ON 67
ci_069                -4.064442e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2957
    reference variance = 0.477105
====================================================
  Execution time = 1.4571e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0218e-01
  Total weights = 1.957675066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288068204216
                                         uncertainty =       0.003074441698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288068204216
                                         uncertainty =       0.003074441698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379531780
  error estimate for blocks of size 2^( 2) =       0.000390981614
  error estimate for blocks of size 2^( 3) =       0.000401397971
  error estimate for blocks of size 2^( 4) =       0.000408901672
  error estimate for blocks of size 2^( 5) =       0.000413836570
  error estimate for blocks of size 2^( 6) =       0.000416949981
  error estimate for blocks of size 2^( 7) =       0.000417386268

      target function =      -0.909148511529
              le_mean =     -17.214888802307
             les_mean =     296.654579769880
             stat err =       0.000414268623
             autocorr =       1.191427956485
   target nu stat err =       0.000414268623
   target dn stat err =       0.005390383645
      target stat err =       0.008360953799
              std dev =       0.536738990427
             le_variance =       0.288088743845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488880231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909224702864       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909345668601       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909353873976       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909356602634       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909357345484       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909357237086       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909357208782       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909357173653       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909357181213       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909357175279       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 3.375881e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909224702864       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909259179122       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909261427295       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909262149250       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909262345000       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909262314712       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909262306262       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909262297340       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909262299483       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 9.673785e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909224702864       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909233634571       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909234210258       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909234393205       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909234442763       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909234434971       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909234432763       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909234430531       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909234431083       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.510511e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7099e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -3.767328e-02 3 1  ON 0
ci_002                -2.879649e-02 3 1  ON 1
ci_003                -2.376616e-02 3 1  ON 2
ci_004                 2.097694e-02 3 1  ON 3
ci_005                 2.160257e-02 3 1  ON 4
ci_006                -1.854188e-02 3 1  ON 5
ci_007                -1.853519e-02 3 1  ON 6
ci_008                -7.812130e-03 3 1  ON 7
ci_009                -1.409704e-02 3 1  ON 8
ci_010                -8.911932e-03 3 1  ON 9
ci_011                -9.210830e-03 3 1  ON 10
ci_012                -9.221869e-03 3 1  ON 11
ci_013                -1.926883e-02 3 1  ON 12
ci_014                 1.122750e-02 3 1  ON 13
ci_015                 1.104149e-02 3 1  ON 14
ci_016                 1.594787e-02 3 1  ON 15
ci_017                 1.571366e-02 3 1  ON 16
ci_018                 9.008400e-03 3 1  ON 17
ci_019                 9.083100e-03 3 1  ON 18
ci_020                 1.508309e-02 3 1  ON 19
ci_021                 1.528918e-02 3 1  ON 20
ci_022                 8.301083e-03 3 1  ON 21
ci_023                 8.459868e-03 3 1  ON 22
ci_024                 8.611514e-03 3 1  ON 23
ci_025                 8.708059e-03 3 1  ON 24
ci_026                 1.005529e-02 3 1  ON 25
ci_027                 9.706109e-03 3 1  ON 26
ci_028                -1.458220e-02 3 1  ON 27
ci_029                -1.502758e-02 3 1  ON 28
ci_030                -8.714108e-03 3 1  ON 29
ci_031                -8.607431e-03 3 1  ON 30
ci_032                -1.445427e-02 3 1  ON 31
ci_033                 4.600312e-03 3 1  ON 32
ci_034                 4.863776e-03 3 1  ON 33
ci_035                -3.401856e-03 3 1  ON 34
ci_036                -1.132777e-02 3 1  ON 35
ci_037                -1.153631e-02 3 1  ON 36
ci_038                 9.720833e-04 3 1  ON 37
ci_039                 1.238281e-03 3 1  ON 38
ci_040                -1.602929e-03 3 1  ON 39
ci_041                 8.214409e-03 3 1  ON 40
ci_042                 8.200196e-03 3 1  ON 41
ci_043                -2.400152e-03 3 1  ON 42
ci_044                -3.998234e-03 3 1  ON 43
ci_045                -1.878955e-03 3 1  ON 44
ci_046                 4.796592e-03 3 1  ON 45
ci_047                 4.684770e-03 3 1  ON 46
ci_048                -1.244672e-02 3 1  ON 47
ci_049                -1.292090e-02 3 1  ON 48
ci_050                 2.869665e-03 3 1  ON 49
ci_051                 2.813951e-03 3 1  ON 50
ci_052                -2.332913e-03 3 1  ON 51
ci_053                -2.274313e-03 3 1  ON 52
ci_054                -2.344088e-03 3 1  ON 53
ci_055                -2.428535e-03 3 1  ON 54
ci_056                 4.685282e-03 3 1  ON 55
ci_057                 4.715290e-03 3 1  ON 56
ci_058                -2.072254e-03 3 1  ON 57
ci_059                -2.202738e-03 3 1  ON 58
ci_060                 4.719382e-03 3 1  ON 59
ci_061                 5.150647e-03 3 1  ON 60
ci_062                -2.834635e-03 3 1  ON 61
ci_063                -2.873667e-03 3 1  ON 62
ci_064                -2.243769e-03 3 1  ON 63
ci_065                -3.425906e-03 3 1  ON 64
ci_066                 4.023336e-03 3 1  ON 65
ci_067                 4.124905e-03 3 1  ON 66
ci_068                -4.346023e-03 3 1  ON 67
ci_069                -4.050719e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2597
    reference variance = 0.245294
====================================================
  Execution time = 1.4139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9903e-01
  Total weights = 1.9577e+06
  Execution time = 1.8622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286483701316
                                         uncertainty =       0.001566467189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286483701316
                                         uncertainty =       0.001566467189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378481961
  error estimate for blocks of size 2^( 2) =       0.000389812696
  error estimate for blocks of size 2^( 3) =       0.000400179394
  error estimate for blocks of size 2^( 4) =       0.000407232952
  error estimate for blocks of size 2^( 5) =       0.000412131050
  error estimate for blocks of size 2^( 6) =       0.000414371181
  error estimate for blocks of size 2^( 7) =       0.000414915215

      target function =      -0.911497482499
              le_mean =     -17.213932214635
             les_mean =     296.620192875468
             stat err =       0.000412162599
             autocorr =       1.185896506038
   target nu stat err =       0.000412162599
   target dn stat err =       0.002611901287
      target stat err =       0.004110518184
              std dev =       0.535254322826
             le_variance =       0.286497190104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286489594945
                                         uncertainty =       0.001562228621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286489594945
                                         uncertainty =       0.001562228621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378488621
  error estimate for blocks of size 2^( 2) =       0.000389843700
  error estimate for blocks of size 2^( 3) =       0.000400228670
  error estimate for blocks of size 2^( 4) =       0.000407297516
  error estimate for blocks of size 2^( 5) =       0.000412205206
  error estimate for blocks of size 2^( 6) =       0.000414436859
  error estimate for blocks of size 2^( 7) =       0.000414971479

      target function =      -0.913899216662
              le_mean =     -17.213935303192
             les_mean =     296.618757450772
             stat err =       0.000412227765
             autocorr =       1.186229783221
   target nu stat err =       0.000412227765
   target dn stat err =       0.002236492410
      target stat err =       0.003556627256
              std dev =       0.535263741607
             le_variance =       0.286507273079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286482556729
                                         uncertainty =       0.001563985916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286482556729
                                         uncertainty =       0.001563985916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378482773
  error estimate for blocks of size 2^( 2) =       0.000389827263
  error estimate for blocks of size 2^( 3) =       0.000400204321
  error estimate for blocks of size 2^( 4) =       0.000407266471
  error estimate for blocks of size 2^( 5) =       0.000412170117
  error estimate for blocks of size 2^( 6) =       0.000414405269
  error estimate for blocks of size 2^( 7) =       0.000414944006

      target function =      -0.914156288151
              le_mean =     -17.213933330164
             les_mean =     296.618524726423
             stat err =       0.000412196466
             autocorr =       1.186086309297
   target nu stat err =       0.000412196466
   target dn stat err =       0.002233368454
      target stat err =       0.003553789183
              std dev =       0.535255470756
             le_variance =       0.286498418975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286482932799
                                         uncertainty =       0.001566143842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286482932799
                                         uncertainty =       0.001566143842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378481654
  error estimate for blocks of size 2^( 2) =       0.000389814148
  error estimate for blocks of size 2^( 3) =       0.000400181749
  error estimate for blocks of size 2^( 4) =       0.000407236526
  error estimate for blocks of size 2^( 5) =       0.000412136052
  error estimate for blocks of size 2^( 6) =       0.000414375548
  error estimate for blocks of size 2^( 7) =       0.000414919510

      target function =      -0.911473498230
              le_mean =     -17.213931978756
             les_mean =     296.620199410696
             stat err =       0.000412166909
             autocorr =       1.185923232399
   target nu stat err =       0.000412166909
   target dn stat err =       0.002704738087
      target stat err =       0.004252225330
              std dev =       0.535253887940
             le_variance =       0.286496724555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911497482499        initial
     3.9062e-01     3.9062e+00             3.3759e-04        -0.913899216662
     1.5625e+00     1.5625e+01             9.6738e-05        -0.914156288151  <--
     6.2500e+00     6.2500e+01             2.5105e-05        -0.911473498230

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3507e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -3.767328e-02 3 1  ON 0
ci_002                -2.879649e-02 3 1  ON 1
ci_003                -2.376616e-02 3 1  ON 2
ci_004                 2.097694e-02 3 1  ON 3
ci_005                 2.160257e-02 3 1  ON 4
ci_006                -1.854188e-02 3 1  ON 5
ci_007                -1.853519e-02 3 1  ON 6
ci_008                -7.812130e-03 3 1  ON 7
ci_009                -1.409704e-02 3 1  ON 8
ci_010                -8.911932e-03 3 1  ON 9
ci_011                -9.210830e-03 3 1  ON 10
ci_012                -9.221869e-03 3 1  ON 11
ci_013                -1.926883e-02 3 1  ON 12
ci_014                 1.122750e-02 3 1  ON 13
ci_015                 1.104149e-02 3 1  ON 14
ci_016                 1.594787e-02 3 1  ON 15
ci_017                 1.571366e-02 3 1  ON 16
ci_018                 9.008400e-03 3 1  ON 17
ci_019                 9.083100e-03 3 1  ON 18
ci_020                 1.508309e-02 3 1  ON 19
ci_021                 1.528918e-02 3 1  ON 20
ci_022                 8.301083e-03 3 1  ON 21
ci_023                 8.459868e-03 3 1  ON 22
ci_024                 8.611514e-03 3 1  ON 23
ci_025                 8.708059e-03 3 1  ON 24
ci_026                 1.005529e-02 3 1  ON 25
ci_027                 9.706109e-03 3 1  ON 26
ci_028                -1.458220e-02 3 1  ON 27
ci_029                -1.502758e-02 3 1  ON 28
ci_030                -8.714108e-03 3 1  ON 29
ci_031                -8.607431e-03 3 1  ON 30
ci_032                -1.445427e-02 3 1  ON 31
ci_033                 4.600312e-03 3 1  ON 32
ci_034                 4.863776e-03 3 1  ON 33
ci_035                -3.401856e-03 3 1  ON 34
ci_036                -1.132777e-02 3 1  ON 35
ci_037                -1.153631e-02 3 1  ON 36
ci_038                 9.720833e-04 3 1  ON 37
ci_039                 1.238281e-03 3 1  ON 38
ci_040                -1.602929e-03 3 1  ON 39
ci_041                 8.214409e-03 3 1  ON 40
ci_042                 8.200196e-03 3 1  ON 41
ci_043                -2.400152e-03 3 1  ON 42
ci_044                -3.998234e-03 3 1  ON 43
ci_045                -1.878955e-03 3 1  ON 44
ci_046                 4.796592e-03 3 1  ON 45
ci_047                 4.684770e-03 3 1  ON 46
ci_048                -1.244672e-02 3 1  ON 47
ci_049                -1.292090e-02 3 1  ON 48
ci_050                 2.869665e-03 3 1  ON 49
ci_051                 2.813951e-03 3 1  ON 50
ci_052                -2.332913e-03 3 1  ON 51
ci_053                -2.274313e-03 3 1  ON 52
ci_054                -2.344088e-03 3 1  ON 53
ci_055                -2.428535e-03 3 1  ON 54
ci_056                 4.685282e-03 3 1  ON 55
ci_057                 4.715290e-03 3 1  ON 56
ci_058                -2.072254e-03 3 1  ON 57
ci_059                -2.202738e-03 3 1  ON 58
ci_060                 4.719382e-03 3 1  ON 59
ci_061                 5.150647e-03 3 1  ON 60
ci_062                -2.834635e-03 3 1  ON 61
ci_063                -2.873667e-03 3 1  ON 62
ci_064                -2.243769e-03 3 1  ON 63
ci_065                -3.425906e-03 3 1  ON 64
ci_066                 4.023336e-03 3 1  ON 65
ci_067                 4.124905e-03 3 1  ON 66
ci_068                -4.346023e-03 3 1  ON 67
ci_069                -4.050719e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0619e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2335
    reference variance = 0.158826
====================================================
  Execution time = 1.5263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9871e-01
  Total weights = 1.957936114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286045309802
                                         uncertainty =       0.001654092755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286045309802
                                         uncertainty =       0.001654092755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378140967
  error estimate for blocks of size 2^( 2) =       0.000389475795
  error estimate for blocks of size 2^( 3) =       0.000399813266
  error estimate for blocks of size 2^( 4) =       0.000407558351
  error estimate for blocks of size 2^( 5) =       0.000411106373
  error estimate for blocks of size 2^( 6) =       0.000412534203
  error estimate for blocks of size 2^( 7) =       0.000413018396

      target function =      -0.914632651746
              le_mean =     -17.214336130073
             les_mean =     296.632078601742
             stat err =       0.000411054331
             autocorr =       1.181655814024
   target nu stat err =       0.000411054331
   target dn stat err =       0.002182466060
      target stat err =       0.003481771021
              std dev =       0.534772083499
             le_variance =       0.285981181290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721433613007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914644939450       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914726130328       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914733080796       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914736914386       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914737804421       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914738014307       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914738100005       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914738142036       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914738181540       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914738175060       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 2.923818e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914644939450       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914668165124       residual = 8.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914670083292       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914671107257       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914671347265       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914671398870       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914671420928       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914671431373       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914671441595       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914671439924       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 8.374025e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914644939450       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914650963077       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914651455249       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914651715455       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914651776643       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914651789443       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914651794985       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914651797589       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914651800160       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914651799740       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.172602e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7796e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -3.768223e-02 3 1  ON 0
ci_002                -2.875132e-02 3 1  ON 1
ci_003                -2.379282e-02 3 1  ON 2
ci_004                 2.100069e-02 3 1  ON 3
ci_005                 2.155205e-02 3 1  ON 4
ci_006                -1.851375e-02 3 1  ON 5
ci_007                -1.852347e-02 3 1  ON 6
ci_008                -7.795079e-03 3 1  ON 7
ci_009                -1.410878e-02 3 1  ON 8
ci_010                -8.896300e-03 3 1  ON 9
ci_011                -9.194280e-03 3 1  ON 10
ci_012                -9.265346e-03 3 1  ON 11
ci_013                -1.922126e-02 3 1  ON 12
ci_014                 1.121558e-02 3 1  ON 13
ci_015                 1.101507e-02 3 1  ON 14
ci_016                 1.595602e-02 3 1  ON 15
ci_017                 1.569081e-02 3 1  ON 16
ci_018                 9.013922e-03 3 1  ON 17
ci_019                 9.095011e-03 3 1  ON 18
ci_020                 1.510298e-02 3 1  ON 19
ci_021                 1.524555e-02 3 1  ON 20
ci_022                 8.339882e-03 3 1  ON 21
ci_023                 8.410697e-03 3 1  ON 22
ci_024                 8.620208e-03 3 1  ON 23
ci_025                 8.655597e-03 3 1  ON 24
ci_026                 1.003529e-02 3 1  ON 25
ci_027                 9.739731e-03 3 1  ON 26
ci_028                -1.458402e-02 3 1  ON 27
ci_029                -1.506557e-02 3 1  ON 28
ci_030                -8.705270e-03 3 1  ON 29
ci_031                -8.616568e-03 3 1  ON 30
ci_032                -1.442918e-02 3 1  ON 31
ci_033                 4.577906e-03 3 1  ON 32
ci_034                 4.872075e-03 3 1  ON 33
ci_035                -3.389311e-03 3 1  ON 34
ci_036                -1.137637e-02 3 1  ON 35
ci_037                -1.153511e-02 3 1  ON 36
ci_038                 9.873728e-04 3 1  ON 37
ci_039                 1.218880e-03 3 1  ON 38
ci_040                -1.605848e-03 3 1  ON 39
ci_041                 8.197389e-03 3 1  ON 40
ci_042                 8.116456e-03 3 1  ON 41
ci_043                -2.395423e-03 3 1  ON 42
ci_044                -3.959391e-03 3 1  ON 43
ci_045                -1.895739e-03 3 1  ON 44
ci_046                 4.779202e-03 3 1  ON 45
ci_047                 4.646653e-03 3 1  ON 46
ci_048                -1.244104e-02 3 1  ON 47
ci_049                -1.292316e-02 3 1  ON 48
ci_050                 2.872813e-03 3 1  ON 49
ci_051                 2.818395e-03 3 1  ON 50
ci_052                -2.282876e-03 3 1  ON 51
ci_053                -2.295936e-03 3 1  ON 52
ci_054                -2.327794e-03 3 1  ON 53
ci_055                -2.420704e-03 3 1  ON 54
ci_056                 4.688064e-03 3 1  ON 55
ci_057                 4.700966e-03 3 1  ON 56
ci_058                -2.103702e-03 3 1  ON 57
ci_059                -2.205066e-03 3 1  ON 58
ci_060                 4.726995e-03 3 1  ON 59
ci_061                 5.132148e-03 3 1  ON 60
ci_062                -2.851648e-03 3 1  ON 61
ci_063                -2.870480e-03 3 1  ON 62
ci_064                -2.231561e-03 3 1  ON 63
ci_065                -3.417230e-03 3 1  ON 64
ci_066                 4.018468e-03 3 1  ON 65
ci_067                 4.107589e-03 3 1  ON 66
ci_068                -4.313611e-03 3 1  ON 67
ci_069                -4.015535e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.298339
====================================================
  Execution time = 1.4226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0288e-01
  Total weights = 1.9576e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288323488733
                                         uncertainty =       0.001719072614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288323488733
                                         uncertainty =       0.001719072614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379659551
  error estimate for blocks of size 2^( 2) =       0.000391170942
  error estimate for blocks of size 2^( 3) =       0.000401614502
  error estimate for blocks of size 2^( 4) =       0.000409223448
  error estimate for blocks of size 2^( 5) =       0.000414258701
  error estimate for blocks of size 2^( 6) =       0.000418297508
  error estimate for blocks of size 2^( 7) =       0.000418164381

      target function =      -0.908154657700
              le_mean =     -17.214319432807
             les_mean =     296.635675071478
             stat err =       0.000414986009
             autocorr =       1.194753337148
   target nu stat err =       0.000414986009
   target dn stat err =       0.002731947832
      target stat err =       0.004266922220
              std dev =       0.536919685433
             le_variance =       0.288282748606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288313273755
                                         uncertainty =       0.001719937488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288313273755
                                         uncertainty =       0.001719937488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379652780
  error estimate for blocks of size 2^( 2) =       0.000391174905
  error estimate for blocks of size 2^( 3) =       0.000401629237
  error estimate for blocks of size 2^( 4) =       0.000409245260
  error estimate for blocks of size 2^( 5) =       0.000414285156
  error estimate for blocks of size 2^( 6) =       0.000418322497
  error estimate for blocks of size 2^( 7) =       0.000418201207

      target function =      -0.907932297123
              le_mean =     -17.214316720422
             les_mean =     296.635726268959
             stat err =       0.000415013530
             autocorr =       1.194954424836
   target nu stat err =       0.000415013530
   target dn stat err =       0.002721711587
      target stat err =       0.004249302810
              std dev =       0.536910111089
             le_variance =       0.288272467389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288315293722
                                         uncertainty =       0.001719559454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288315293722
                                         uncertainty =       0.001719559454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379654129
  error estimate for blocks of size 2^( 2) =       0.000391171504
  error estimate for blocks of size 2^( 3) =       0.000401621266
  error estimate for blocks of size 2^( 4) =       0.000409234261
  error estimate for blocks of size 2^( 5) =       0.000414272630
  error estimate for blocks of size 2^( 6) =       0.000418311176
  error estimate for blocks of size 2^( 7) =       0.000418185772

      target function =      -0.895835033062
              le_mean =     -17.214317280569
             les_mean =     296.643604491644
             stat err =       0.000415000960
             autocorr =       1.194873550935
   target nu stat err =       0.000415000960
   target dn stat err =       0.008356449675
      target stat err =       0.012547261701
              std dev =       0.536912017730
             le_variance =       0.288274514783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288321977073
                                         uncertainty =       0.001719132899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288321977073
                                         uncertainty =       0.001719132899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379658552
  error estimate for blocks of size 2^( 2) =       0.000391170721
  error estimate for blocks of size 2^( 3) =       0.000401615074
  error estimate for blocks of size 2^( 4) =       0.000409224532
  error estimate for blocks of size 2^( 5) =       0.000414260167
  error estimate for blocks of size 2^( 6) =       0.000418298850
  error estimate for blocks of size 2^( 7) =       0.000418166553

      target function =      -0.908122239352
              le_mean =     -17.214319148577
             les_mean =     296.635686355858
             stat err =       0.000414987525
             autocorr =       1.194768351066
   target nu stat err =       0.000414987525
   target dn stat err =       0.002730484812
      target stat err =       0.004264397115
              std dev =       0.536918273337
             le_variance =       0.288281232243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908154657700        initial  <--
     3.9062e-01     3.9062e+00             2.9238e-04        -0.907932297123
     1.5625e+00     1.5625e+01             8.3740e-05        -0.895835033062
     6.2500e+00     6.2500e+01             2.1726e-05        -0.908122239352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5529
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -3.767328e-02 3 1  ON 0
ci_002                -2.879649e-02 3 1  ON 1
ci_003                -2.376616e-02 3 1  ON 2
ci_004                 2.097694e-02 3 1  ON 3
ci_005                 2.160257e-02 3 1  ON 4
ci_006                -1.854188e-02 3 1  ON 5
ci_007                -1.853519e-02 3 1  ON 6
ci_008                -7.812130e-03 3 1  ON 7
ci_009                -1.409704e-02 3 1  ON 8
ci_010                -8.911932e-03 3 1  ON 9
ci_011                -9.210830e-03 3 1  ON 10
ci_012                -9.221869e-03 3 1  ON 11
ci_013                -1.926883e-02 3 1  ON 12
ci_014                 1.122750e-02 3 1  ON 13
ci_015                 1.104149e-02 3 1  ON 14
ci_016                 1.594787e-02 3 1  ON 15
ci_017                 1.571366e-02 3 1  ON 16
ci_018                 9.008400e-03 3 1  ON 17
ci_019                 9.083100e-03 3 1  ON 18
ci_020                 1.508309e-02 3 1  ON 19
ci_021                 1.528918e-02 3 1  ON 20
ci_022                 8.301083e-03 3 1  ON 21
ci_023                 8.459868e-03 3 1  ON 22
ci_024                 8.611514e-03 3 1  ON 23
ci_025                 8.708059e-03 3 1  ON 24
ci_026                 1.005529e-02 3 1  ON 25
ci_027                 9.706109e-03 3 1  ON 26
ci_028                -1.458220e-02 3 1  ON 27
ci_029                -1.502758e-02 3 1  ON 28
ci_030                -8.714108e-03 3 1  ON 29
ci_031                -8.607431e-03 3 1  ON 30
ci_032                -1.445427e-02 3 1  ON 31
ci_033                 4.600312e-03 3 1  ON 32
ci_034                 4.863776e-03 3 1  ON 33
ci_035                -3.401856e-03 3 1  ON 34
ci_036                -1.132777e-02 3 1  ON 35
ci_037                -1.153631e-02 3 1  ON 36
ci_038                 9.720833e-04 3 1  ON 37
ci_039                 1.238281e-03 3 1  ON 38
ci_040                -1.602929e-03 3 1  ON 39
ci_041                 8.214409e-03 3 1  ON 40
ci_042                 8.200196e-03 3 1  ON 41
ci_043                -2.400152e-03 3 1  ON 42
ci_044                -3.998234e-03 3 1  ON 43
ci_045                -1.878955e-03 3 1  ON 44
ci_046                 4.796592e-03 3 1  ON 45
ci_047                 4.684770e-03 3 1  ON 46
ci_048                -1.244672e-02 3 1  ON 47
ci_049                -1.292090e-02 3 1  ON 48
ci_050                 2.869665e-03 3 1  ON 49
ci_051                 2.813951e-03 3 1  ON 50
ci_052                -2.332913e-03 3 1  ON 51
ci_053                -2.274313e-03 3 1  ON 52
ci_054                -2.344088e-03 3 1  ON 53
ci_055                -2.428535e-03 3 1  ON 54
ci_056                 4.685282e-03 3 1  ON 55
ci_057                 4.715290e-03 3 1  ON 56
ci_058                -2.072254e-03 3 1  ON 57
ci_059                -2.202738e-03 3 1  ON 58
ci_060                 4.719382e-03 3 1  ON 59
ci_061                 5.150647e-03 3 1  ON 60
ci_062                -2.834635e-03 3 1  ON 61
ci_063                -2.873667e-03 3 1  ON 62
ci_064                -2.243769e-03 3 1  ON 63
ci_065                -3.425906e-03 3 1  ON 64
ci_066                 4.023336e-03 3 1  ON 65
ci_067                 4.124905e-03 3 1  ON 66
ci_068                -4.346023e-03 3 1  ON 67
ci_069                -4.050719e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.160077
====================================================
  Execution time = 1.4436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9943e-01
  Total weights = 1.957844887e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286316456772
                                         uncertainty =       0.001537397650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286316456772
                                         uncertainty =       0.001537397650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378419691
  error estimate for blocks of size 2^( 2) =       0.000390040627
  error estimate for blocks of size 2^( 3) =       0.000400506143
  error estimate for blocks of size 2^( 4) =       0.000408234683
  error estimate for blocks of size 2^( 5) =       0.000412176463
  error estimate for blocks of size 2^( 6) =       0.000414780665
  error estimate for blocks of size 2^( 7) =       0.000415449019

      target function =      -0.913484817018
              le_mean =     -17.214812552166
             les_mean =     296.649202861181
             stat err =       0.000412660207
             autocorr =       1.189152983613
   target nu stat err =       0.000412660207
   target dn stat err =       0.002488069031
      target stat err =       0.003944914636
              std dev =       0.535166259851
             le_variance =       0.286402925683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721481255217e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913500884179       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913506358042       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913507880389       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913508388505       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913508435777       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913508453089       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913508455010       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913508454278       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913508455094       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913508453809       residual = 2.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 3.416222e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913500884179       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913502272887       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913502657567       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913502785478       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913502797321       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913502801640       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913502802124       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913502801934       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913502802138       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913502801819       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 8.645221e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913500884179       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913501232644       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913501329074       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913501361107       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913501364069       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913501365148       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913501365269       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913501365221       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913501365272       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913501365192       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 2.167948e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6944e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -3.767084e-02 3 1  ON 0
ci_002                -2.879561e-02 3 1  ON 1
ci_003                -2.376779e-02 3 1  ON 2
ci_004                 2.097984e-02 3 1  ON 3
ci_005                 2.159705e-02 3 1  ON 4
ci_006                -1.853847e-02 3 1  ON 5
ci_007                -1.853514e-02 3 1  ON 6
ci_008                -7.809581e-03 3 1  ON 7
ci_009                -1.409488e-02 3 1  ON 8
ci_010                -8.907717e-03 3 1  ON 9
ci_011                -9.212522e-03 3 1  ON 10
ci_012                -9.221740e-03 3 1  ON 11
ci_013                -1.926624e-02 3 1  ON 12
ci_014                 1.122750e-02 3 1  ON 13
ci_015                 1.103992e-02 3 1  ON 14
ci_016                 1.595251e-02 3 1  ON 15
ci_017                 1.571093e-02 3 1  ON 16
ci_018                 9.007933e-03 3 1  ON 17
ci_019                 9.082071e-03 3 1  ON 18
ci_020                 1.507669e-02 3 1  ON 19
ci_021                 1.528451e-02 3 1  ON 20
ci_022                 8.301967e-03 3 1  ON 21
ci_023                 8.458655e-03 3 1  ON 22
ci_024                 8.602869e-03 3 1  ON 23
ci_025                 8.700973e-03 3 1  ON 24
ci_026                 1.005338e-02 3 1  ON 25
ci_027                 9.706204e-03 3 1  ON 26
ci_028                -1.457821e-02 3 1  ON 27
ci_029                -1.503277e-02 3 1  ON 28
ci_030                -8.711713e-03 3 1  ON 29
ci_031                -8.607864e-03 3 1  ON 30
ci_032                -1.445509e-02 3 1  ON 31
ci_033                 4.602104e-03 3 1  ON 32
ci_034                 4.867442e-03 3 1  ON 33
ci_035                -3.400961e-03 3 1  ON 34
ci_036                -1.132467e-02 3 1  ON 35
ci_037                -1.153375e-02 3 1  ON 36
ci_038                 9.711658e-04 3 1  ON 37
ci_039                 1.238384e-03 3 1  ON 38
ci_040                -1.603452e-03 3 1  ON 39
ci_041                 8.214768e-03 3 1  ON 40
ci_042                 8.202187e-03 3 1  ON 41
ci_043                -2.399472e-03 3 1  ON 42
ci_044                -3.993726e-03 3 1  ON 43
ci_045                -1.877848e-03 3 1  ON 44
ci_046                 4.796594e-03 3 1  ON 45
ci_047                 4.682289e-03 3 1  ON 46
ci_048                -1.244634e-02 3 1  ON 47
ci_049                -1.292316e-02 3 1  ON 48
ci_050                 2.873741e-03 3 1  ON 49
ci_051                 2.816057e-03 3 1  ON 50
ci_052                -2.330585e-03 3 1  ON 51
ci_053                -2.274998e-03 3 1  ON 52
ci_054                -2.340979e-03 3 1  ON 53
ci_055                -2.427522e-03 3 1  ON 54
ci_056                 4.683245e-03 3 1  ON 55
ci_057                 4.712889e-03 3 1  ON 56
ci_058                -2.072791e-03 3 1  ON 57
ci_059                -2.201222e-03 3 1  ON 58
ci_060                 4.719187e-03 3 1  ON 59
ci_061                 5.152076e-03 3 1  ON 60
ci_062                -2.834793e-03 3 1  ON 61
ci_063                -2.873847e-03 3 1  ON 62
ci_064                -2.241736e-03 3 1  ON 63
ci_065                -3.427174e-03 3 1  ON 64
ci_066                 4.027159e-03 3 1  ON 65
ci_067                 4.124467e-03 3 1  ON 66
ci_068                -4.344611e-03 3 1  ON 67
ci_069                -4.052679e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2082
    reference variance = 0.199848
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0070e-01
  Total weights = 1.9576e+06
  Execution time = 1.8499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564096984
                                         uncertainty =       0.001701592679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564096984
                                         uncertainty =       0.001701592679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379141202
  error estimate for blocks of size 2^( 2) =       0.000390581672
  error estimate for blocks of size 2^( 3) =       0.000400433820
  error estimate for blocks of size 2^( 4) =       0.000407983778
  error estimate for blocks of size 2^( 5) =       0.000413787045
  error estimate for blocks of size 2^( 6) =       0.000415033458
  error estimate for blocks of size 2^( 7) =       0.000417486796

      target function =      -0.910665895860
              le_mean =     -17.214177716308
             les_mean =     296.629178495456
             stat err =       0.000413572769
             autocorr =       1.189876555605
   target nu stat err =       0.000413572769
   target dn stat err =       0.002213461646
      target stat err =       0.003499104076
              std dev =       0.536186629454
             le_variance =       0.287496101605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287559389064
                                         uncertainty =       0.001701384912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287559389064
                                         uncertainty =       0.001701384912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379138100
  error estimate for blocks of size 2^( 2) =       0.000390579545
  error estimate for blocks of size 2^( 3) =       0.000400433122
  error estimate for blocks of size 2^( 4) =       0.000407984059
  error estimate for blocks of size 2^( 5) =       0.000413788616
  error estimate for blocks of size 2^( 6) =       0.000415035993
  error estimate for blocks of size 2^( 7) =       0.000417490465

      target function =      -0.911570609036
              le_mean =     -17.214177467268
             les_mean =     296.628586847876
             stat err =       0.000413574783
             autocorr =       1.189907614545
   target nu stat err =       0.000413574783
   target dn stat err =       0.002135623038
      target stat err =       0.003387683862
              std dev =       0.536182242669
             le_variance =       0.287491397353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287561679525
                                         uncertainty =       0.001701486698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287561679525
                                         uncertainty =       0.001701486698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379139609
  error estimate for blocks of size 2^( 2) =       0.000390580578
  error estimate for blocks of size 2^( 3) =       0.000400433447
  error estimate for blocks of size 2^( 4) =       0.000407983903
  error estimate for blocks of size 2^( 5) =       0.000413787832
  error estimate for blocks of size 2^( 6) =       0.000415034729
  error estimate for blocks of size 2^( 7) =       0.000417488642

      target function =      -0.911565882975
              le_mean =     -17.214177589572
             les_mean =     296.628594103574
             stat err =       0.000413573777
             autocorr =       1.189892348630
   target nu stat err =       0.000413573777
   target dn stat err =       0.002135297802
      target stat err =       0.003387156271
              std dev =       0.536184376877
             le_variance =       0.287493686007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563789954
                                         uncertainty =       0.001701579278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563789954
                                         uncertainty =       0.001701579278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379140999
  error estimate for blocks of size 2^( 2) =       0.000390581537
  error estimate for blocks of size 2^( 3) =       0.000400433774
  error estimate for blocks of size 2^( 4) =       0.000407983797
  error estimate for blocks of size 2^( 5) =       0.000413787154
  error estimate for blocks of size 2^( 6) =       0.000415033623
  error estimate for blocks of size 2^( 7) =       0.000417487032

      target function =      -0.911325583106
              le_mean =     -17.214177703197
             les_mean =     296.628752883392
             stat err =       0.000413572902
             autocorr =       1.189878586487
   target nu stat err =       0.000413572902
   target dn stat err =       0.002141039304
      target stat err =       0.003394119887
              std dev =       0.536186343364
             le_variance =       0.287495794810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910665895860        initial
     3.9062e+00     3.9062e+01             3.4162e-05        -0.911570609036  <--
     1.5625e+01     1.5625e+02             8.6452e-06        -0.911565882975
     6.2500e+01     6.2500e+02             2.1679e-06        -0.911325583106

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3516e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -3.766362e-02 3 1  ON 0
ci_002                -2.879303e-02 3 1  ON 1
ci_003                -2.377256e-02 3 1  ON 2
ci_004                 2.098839e-02 3 1  ON 3
ci_005                 2.158077e-02 3 1  ON 4
ci_006                -1.852838e-02 3 1  ON 5
ci_007                -1.853501e-02 3 1  ON 6
ci_008                -7.802085e-03 3 1  ON 7
ci_009                -1.408853e-02 3 1  ON 8
ci_010                -8.895297e-03 3 1  ON 9
ci_011                -9.217506e-03 3 1  ON 10
ci_012                -9.221360e-03 3 1  ON 11
ci_013                -1.925855e-02 3 1  ON 12
ci_014                 1.122748e-02 3 1  ON 13
ci_015                 1.103529e-02 3 1  ON 14
ci_016                 1.596622e-02 3 1  ON 15
ci_017                 1.570288e-02 3 1  ON 16
ci_018                 9.006538e-03 3 1  ON 17
ci_019                 9.079009e-03 3 1  ON 18
ci_020                 1.505779e-02 3 1  ON 19
ci_021                 1.527073e-02 3 1  ON 20
ci_022                 8.304572e-03 3 1  ON 21
ci_023                 8.455082e-03 3 1  ON 22
ci_024                 8.577352e-03 3 1  ON 23
ci_025                 8.680058e-03 3 1  ON 24
ci_026                 1.004777e-02 3 1  ON 25
ci_027                 9.706455e-03 3 1  ON 26
ci_028                -1.456644e-02 3 1  ON 27
ci_029                -1.504811e-02 3 1  ON 28
ci_030                -8.704662e-03 3 1  ON 29
ci_031                -8.609140e-03 3 1  ON 30
ci_032                -1.445752e-02 3 1  ON 31
ci_033                 4.607379e-03 3 1  ON 32
ci_034                 4.878253e-03 3 1  ON 33
ci_035                -3.398327e-03 3 1  ON 34
ci_036                -1.131556e-02 3 1  ON 35
ci_037                -1.152621e-02 3 1  ON 36
ci_038                 9.684661e-04 3 1  ON 37
ci_039                 1.238687e-03 3 1  ON 38
ci_040                -1.604992e-03 3 1  ON 39
ci_041                 8.215814e-03 3 1  ON 40
ci_042                 8.208074e-03 3 1  ON 41
ci_043                -2.397469e-03 3 1  ON 42
ci_044                -3.980452e-03 3 1  ON 43
ci_045                -1.874594e-03 3 1  ON 44
ci_046                 4.796603e-03 3 1  ON 45
ci_047                 4.674972e-03 3 1  ON 46
ci_048                -1.244523e-02 3 1  ON 47
ci_049                -1.292985e-02 3 1  ON 48
ci_050                 2.885723e-03 3 1  ON 49
ci_051                 2.822247e-03 3 1  ON 50
ci_052                -2.323741e-03 3 1  ON 51
ci_053                -2.277012e-03 3 1  ON 52
ci_054                -2.331814e-03 3 1  ON 53
ci_055                -2.424532e-03 3 1  ON 54
ci_056                 4.677247e-03 3 1  ON 55
ci_057                 4.705819e-03 3 1  ON 56
ci_058                -2.074379e-03 3 1  ON 57
ci_059                -2.196765e-03 3 1  ON 58
ci_060                 4.718614e-03 3 1  ON 59
ci_061                 5.156288e-03 3 1  ON 60
ci_062                -2.835240e-03 3 1  ON 61
ci_063                -2.874359e-03 3 1  ON 62
ci_064                -2.235758e-03 3 1  ON 63
ci_065                -3.430905e-03 3 1  ON 64
ci_066                 4.038413e-03 3 1  ON 65
ci_067                 4.123171e-03 3 1  ON 66
ci_068                -4.340454e-03 3 1  ON 67
ci_069                -4.058460e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2243
    reference variance = 0.167949
====================================================
  Execution time = 1.4542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9744e-01
  Total weights = 1.957493694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285051904790
                                         uncertainty =       0.001390395373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285051904790
                                         uncertainty =       0.001390395373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377504586
  error estimate for blocks of size 2^( 2) =       0.000389105311
  error estimate for blocks of size 2^( 3) =       0.000399353104
  error estimate for blocks of size 2^( 4) =       0.000407209073
  error estimate for blocks of size 2^( 5) =       0.000413168343
  error estimate for blocks of size 2^( 6) =       0.000414986548
  error estimate for blocks of size 2^( 7) =       0.000416394235

      target function =      -0.916594526502
              le_mean =     -17.215221601040
             les_mean =     296.661295199209
             stat err =       0.000412939550
             autocorr =       1.196543509348
   target nu stat err =       0.000412939550
   target dn stat err =       0.001912905966
      target stat err =       0.003089079858
              std dev =       0.533872105823
             le_variance =       0.285019425376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522160104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916604047601       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916627353160       residual = 8.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916629778385       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916631059727       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916631190905       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916631245845       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916631264804       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916631271112       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916631273772       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 8.881584e-05

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916604047601       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916610220151       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916610853708       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916611184559       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916611218204       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916611231969       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916611236746       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916611238226       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916611238866       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.348901e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916604047601       residual = 7.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916605614004       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916605774188       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916605857576       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916605866042       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916605869483       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916605870679       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916605871042       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916605871200       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 5.958486e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7031e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -3.765664e-02 3 1  ON 0
ci_002                -2.879007e-02 3 1  ON 1
ci_003                -2.375778e-02 3 1  ON 2
ci_004                 2.099165e-02 3 1  ON 3
ci_005                 2.156695e-02 3 1  ON 4
ci_006                -1.852215e-02 3 1  ON 5
ci_007                -1.852841e-02 3 1  ON 6
ci_008                -7.816597e-03 3 1  ON 7
ci_009                -1.408703e-02 3 1  ON 8
ci_010                -8.910649e-03 3 1  ON 9
ci_011                -9.220173e-03 3 1  ON 10
ci_012                -9.227140e-03 3 1  ON 11
ci_013                -1.925865e-02 3 1  ON 12
ci_014                 1.122254e-02 3 1  ON 13
ci_015                 1.102728e-02 3 1  ON 14
ci_016                 1.595923e-02 3 1  ON 15
ci_017                 1.569565e-02 3 1  ON 16
ci_018                 9.009239e-03 3 1  ON 17
ci_019                 9.076608e-03 3 1  ON 18
ci_020                 1.507217e-02 3 1  ON 19
ci_021                 1.526650e-02 3 1  ON 20
ci_022                 8.306590e-03 3 1  ON 21
ci_023                 8.443870e-03 3 1  ON 22
ci_024                 8.560727e-03 3 1  ON 23
ci_025                 8.679656e-03 3 1  ON 24
ci_026                 1.004655e-02 3 1  ON 25
ci_027                 9.711969e-03 3 1  ON 26
ci_028                -1.456579e-02 3 1  ON 27
ci_029                -1.504383e-02 3 1  ON 28
ci_030                -8.725340e-03 3 1  ON 29
ci_031                -8.602388e-03 3 1  ON 30
ci_032                -1.445787e-02 3 1  ON 31
ci_033                 4.623957e-03 3 1  ON 32
ci_034                 4.875838e-03 3 1  ON 33
ci_035                -3.391413e-03 3 1  ON 34
ci_036                -1.132435e-02 3 1  ON 35
ci_037                -1.153366e-02 3 1  ON 36
ci_038                 9.525124e-04 3 1  ON 37
ci_039                 1.235474e-03 3 1  ON 38
ci_040                -1.604437e-03 3 1  ON 39
ci_041                 8.207411e-03 3 1  ON 40
ci_042                 8.207181e-03 3 1  ON 41
ci_043                -2.398508e-03 3 1  ON 42
ci_044                -3.991597e-03 3 1  ON 43
ci_045                -1.880473e-03 3 1  ON 44
ci_046                 4.796983e-03 3 1  ON 45
ci_047                 4.659921e-03 3 1  ON 46
ci_048                -1.243618e-02 3 1  ON 47
ci_049                -1.291520e-02 3 1  ON 48
ci_050                 2.878304e-03 3 1  ON 49
ci_051                 2.839116e-03 3 1  ON 50
ci_052                -2.328515e-03 3 1  ON 51
ci_053                -2.300501e-03 3 1  ON 52
ci_054                -2.317694e-03 3 1  ON 53
ci_055                -2.411419e-03 3 1  ON 54
ci_056                 4.674974e-03 3 1  ON 55
ci_057                 4.699431e-03 3 1  ON 56
ci_058                -2.074367e-03 3 1  ON 57
ci_059                -2.197964e-03 3 1  ON 58
ci_060                 4.719775e-03 3 1  ON 59
ci_061                 5.159625e-03 3 1  ON 60
ci_062                -2.845049e-03 3 1  ON 61
ci_063                -2.876235e-03 3 1  ON 62
ci_064                -2.244742e-03 3 1  ON 63
ci_065                -3.429530e-03 3 1  ON 64
ci_066                 4.046488e-03 3 1  ON 65
ci_067                 4.124533e-03 3 1  ON 66
ci_068                -4.330961e-03 3 1  ON 67
ci_069                -4.078561e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.204
    reference variance = 0.652485
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9680e-01
  Total weights = 1.9580e+06
  Execution time = 1.8516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285224800471
                                         uncertainty =       0.001535590558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285224800471
                                         uncertainty =       0.001535590558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377675365
  error estimate for blocks of size 2^( 2) =       0.000389475482
  error estimate for blocks of size 2^( 3) =       0.000399945917
  error estimate for blocks of size 2^( 4) =       0.000408196804
  error estimate for blocks of size 2^( 5) =       0.000412527558
  error estimate for blocks of size 2^( 6) =       0.000413604890
  error estimate for blocks of size 2^( 7) =       0.000414322741

      target function =      -0.917582442870
              le_mean =     -17.215372974271
             les_mean =     296.665875273086
             stat err =       0.000412162999
             autocorr =       1.190969630750
   target nu stat err =       0.000412162999
   target dn stat err =       0.002025587309
      target stat err =       0.003269245403
              std dev =       0.534113622937
             le_variance =       0.285277362207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285217341604
                                         uncertainty =       0.001537249750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285217341604
                                         uncertainty =       0.001537249750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377670453
  error estimate for blocks of size 2^( 2) =       0.000389467699
  error estimate for blocks of size 2^( 3) =       0.000399936498
  error estimate for blocks of size 2^( 4) =       0.000408185002
  error estimate for blocks of size 2^( 5) =       0.000412515222
  error estimate for blocks of size 2^( 6) =       0.000413591724
  error estimate for blocks of size 2^( 7) =       0.000414310754

      target function =      -0.917571319541
              le_mean =     -17.215374038454
             les_mean =     296.665918933985
             stat err =       0.000412150675
             autocorr =       1.190929388033
   target nu stat err =       0.000412150675
   target dn stat err =       0.002027921301
      target stat err =       0.003272760483
              std dev =       0.534106677226
             le_variance =       0.285269942658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285220420996
                                         uncertainty =       0.001536463173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285220420996
                                         uncertainty =       0.001536463173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377672480
  error estimate for blocks of size 2^( 2) =       0.000389471071
  error estimate for blocks of size 2^( 3) =       0.000399940630
  error estimate for blocks of size 2^( 4) =       0.000408190266
  error estimate for blocks of size 2^( 5) =       0.000412520742
  error estimate for blocks of size 2^( 6) =       0.000413597628
  error estimate for blocks of size 2^( 7) =       0.000414316071

      target function =      -0.917602338696
              le_mean =     -17.215373489260
             les_mean =     296.665880360476
             stat err =       0.000412156177
             autocorr =       1.190948399114
   target nu stat err =       0.000412156177
   target dn stat err =       0.002026478337
      target stat err =       0.003270755279
              std dev =       0.534109543518
             le_variance =       0.285273004477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285224188663
                                         uncertainty =       0.001535700675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285224188663
                                         uncertainty =       0.001535700675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377674962
  error estimate for blocks of size 2^( 2) =       0.000389474885
  error estimate for blocks of size 2^( 3) =       0.000399945208
  error estimate for blocks of size 2^( 4) =       0.000408195937
  error estimate for blocks of size 2^( 5) =       0.000412526657
  error estimate for blocks of size 2^( 6) =       0.000413603933
  error estimate for blocks of size 2^( 7) =       0.000414321857

      target function =      -0.917587668555
              le_mean =     -17.215373033397
             les_mean =     296.665873990590
             stat err =       0.000412162096
             autocorr =       1.190966957874
   target nu stat err =       0.000412162096
   target dn stat err =       0.002025656623
      target stat err =       0.003269388426
              std dev =       0.534113052830
             le_variance =       0.285276753203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917582442870        initial
     9.7656e-01     9.7656e+00             8.8816e-05        -0.917571319541
     3.9062e+00     3.9062e+01             2.3489e-05        -0.917602338696  <--
     1.5625e+01     1.5625e+02             5.9585e-06        -0.917587668555

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3423e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -3.765664e-02 3 1  ON 0
ci_002                -2.879007e-02 3 1  ON 1
ci_003                -2.375778e-02 3 1  ON 2
ci_004                 2.099165e-02 3 1  ON 3
ci_005                 2.156695e-02 3 1  ON 4
ci_006                -1.852215e-02 3 1  ON 5
ci_007                -1.852841e-02 3 1  ON 6
ci_008                -7.816597e-03 3 1  ON 7
ci_009                -1.408703e-02 3 1  ON 8
ci_010                -8.910649e-03 3 1  ON 9
ci_011                -9.220173e-03 3 1  ON 10
ci_012                -9.227140e-03 3 1  ON 11
ci_013                -1.925865e-02 3 1  ON 12
ci_014                 1.122254e-02 3 1  ON 13
ci_015                 1.102728e-02 3 1  ON 14
ci_016                 1.595923e-02 3 1  ON 15
ci_017                 1.569565e-02 3 1  ON 16
ci_018                 9.009239e-03 3 1  ON 17
ci_019                 9.076608e-03 3 1  ON 18
ci_020                 1.507217e-02 3 1  ON 19
ci_021                 1.526650e-02 3 1  ON 20
ci_022                 8.306590e-03 3 1  ON 21
ci_023                 8.443870e-03 3 1  ON 22
ci_024                 8.560727e-03 3 1  ON 23
ci_025                 8.679656e-03 3 1  ON 24
ci_026                 1.004655e-02 3 1  ON 25
ci_027                 9.711969e-03 3 1  ON 26
ci_028                -1.456579e-02 3 1  ON 27
ci_029                -1.504383e-02 3 1  ON 28
ci_030                -8.725340e-03 3 1  ON 29
ci_031                -8.602388e-03 3 1  ON 30
ci_032                -1.445787e-02 3 1  ON 31
ci_033                 4.623957e-03 3 1  ON 32
ci_034                 4.875838e-03 3 1  ON 33
ci_035                -3.391413e-03 3 1  ON 34
ci_036                -1.132435e-02 3 1  ON 35
ci_037                -1.153366e-02 3 1  ON 36
ci_038                 9.525124e-04 3 1  ON 37
ci_039                 1.235474e-03 3 1  ON 38
ci_040                -1.604437e-03 3 1  ON 39
ci_041                 8.207411e-03 3 1  ON 40
ci_042                 8.207181e-03 3 1  ON 41
ci_043                -2.398508e-03 3 1  ON 42
ci_044                -3.991597e-03 3 1  ON 43
ci_045                -1.880473e-03 3 1  ON 44
ci_046                 4.796983e-03 3 1  ON 45
ci_047                 4.659921e-03 3 1  ON 46
ci_048                -1.243618e-02 3 1  ON 47
ci_049                -1.291520e-02 3 1  ON 48
ci_050                 2.878304e-03 3 1  ON 49
ci_051                 2.839116e-03 3 1  ON 50
ci_052                -2.328515e-03 3 1  ON 51
ci_053                -2.300501e-03 3 1  ON 52
ci_054                -2.317694e-03 3 1  ON 53
ci_055                -2.411419e-03 3 1  ON 54
ci_056                 4.674974e-03 3 1  ON 55
ci_057                 4.699431e-03 3 1  ON 56
ci_058                -2.074367e-03 3 1  ON 57
ci_059                -2.197964e-03 3 1  ON 58
ci_060                 4.719775e-03 3 1  ON 59
ci_061                 5.159625e-03 3 1  ON 60
ci_062                -2.845049e-03 3 1  ON 61
ci_063                -2.876235e-03 3 1  ON 62
ci_064                -2.244742e-03 3 1  ON 63
ci_065                -3.429530e-03 3 1  ON 64
ci_066                 4.046488e-03 3 1  ON 65
ci_067                 4.124533e-03 3 1  ON 66
ci_068                -4.330961e-03 3 1  ON 67
ci_069                -4.078561e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2338
    reference variance = 0.337567
====================================================
  Execution time = 1.4435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0032e-01
  Total weights = 1.957873256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288377429210
                                         uncertainty =       0.002349359158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288377429210
                                         uncertainty =       0.002349359158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379764560
  error estimate for blocks of size 2^( 2) =       0.000391411547
  error estimate for blocks of size 2^( 3) =       0.000401595895
  error estimate for blocks of size 2^( 4) =       0.000409265275
  error estimate for blocks of size 2^( 5) =       0.000414069023
  error estimate for blocks of size 2^( 6) =       0.000417721774
  error estimate for blocks of size 2^( 7) =       0.000420657798

      target function =      -0.912080941661
              le_mean =     -17.215286611462
             les_mean =     296.666408768099
             stat err =       0.000415428467
             autocorr =       1.196640341022
   target nu stat err =       0.000415428467
   target dn stat err =       0.002954367982
      target stat err =       0.004653183512
              std dev =       0.537068191275
             le_variance =       0.288442242079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528661146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912103949131       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912158897855       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912167368987       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912169696423       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912169910030       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912170058281       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912170069681       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912170072745       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912170069035       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912170069875       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.761126e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912103949131       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912118498854       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912120708417       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912121307449       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912121360950       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912121398527       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912121401239       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912121401961       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912121401038       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912121401236       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 4.640121e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912103949131       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912107641153       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912108199567       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912108350418       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912108363793       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912108373217       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912108373886       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912108374064       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912108373833       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912108373882       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.175873e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6942e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -3.763311e-02 3 1  ON 0
ci_002                -2.878766e-02 3 1  ON 1
ci_003                -2.378630e-02 3 1  ON 2
ci_004                 2.096745e-02 3 1  ON 3
ci_005                 2.156051e-02 3 1  ON 4
ci_006                -1.850155e-02 3 1  ON 5
ci_007                -1.850249e-02 3 1  ON 6
ci_008                -7.822564e-03 3 1  ON 7
ci_009                -1.408212e-02 3 1  ON 8
ci_010                -8.915040e-03 3 1  ON 9
ci_011                -9.176597e-03 3 1  ON 10
ci_012                -9.215836e-03 3 1  ON 11
ci_013                -1.925822e-02 3 1  ON 12
ci_014                 1.121789e-02 3 1  ON 13
ci_015                 1.101672e-02 3 1  ON 14
ci_016                 1.594194e-02 3 1  ON 15
ci_017                 1.570048e-02 3 1  ON 16
ci_018                 9.003290e-03 3 1  ON 17
ci_019                 9.080037e-03 3 1  ON 18
ci_020                 1.507800e-02 3 1  ON 19
ci_021                 1.525384e-02 3 1  ON 20
ci_022                 8.310740e-03 3 1  ON 21
ci_023                 8.420690e-03 3 1  ON 22
ci_024                 8.583819e-03 3 1  ON 23
ci_025                 8.664212e-03 3 1  ON 24
ci_026                 1.004068e-02 3 1  ON 25
ci_027                 9.718046e-03 3 1  ON 26
ci_028                -1.457054e-02 3 1  ON 27
ci_029                -1.504324e-02 3 1  ON 28
ci_030                -8.746035e-03 3 1  ON 29
ci_031                -8.602271e-03 3 1  ON 30
ci_032                -1.444388e-02 3 1  ON 31
ci_033                 4.597436e-03 3 1  ON 32
ci_034                 4.871929e-03 3 1  ON 33
ci_035                -3.382860e-03 3 1  ON 34
ci_036                -1.134366e-02 3 1  ON 35
ci_037                -1.155802e-02 3 1  ON 36
ci_038                 9.551357e-04 3 1  ON 37
ci_039                 1.220567e-03 3 1  ON 38
ci_040                -1.601002e-03 3 1  ON 39
ci_041                 8.195940e-03 3 1  ON 40
ci_042                 8.198685e-03 3 1  ON 41
ci_043                -2.403434e-03 3 1  ON 42
ci_044                -3.945196e-03 3 1  ON 43
ci_045                -1.872567e-03 3 1  ON 44
ci_046                 4.790815e-03 3 1  ON 45
ci_047                 4.653392e-03 3 1  ON 46
ci_048                -1.243184e-02 3 1  ON 47
ci_049                -1.290401e-02 3 1  ON 48
ci_050                 2.851307e-03 3 1  ON 49
ci_051                 2.841970e-03 3 1  ON 50
ci_052                -2.309527e-03 3 1  ON 51
ci_053                -2.317571e-03 3 1  ON 52
ci_054                -2.310237e-03 3 1  ON 53
ci_055                -2.410373e-03 3 1  ON 54
ci_056                 4.673689e-03 3 1  ON 55
ci_057                 4.687502e-03 3 1  ON 56
ci_058                -2.065215e-03 3 1  ON 57
ci_059                -2.224291e-03 3 1  ON 58
ci_060                 4.715723e-03 3 1  ON 59
ci_061                 5.142642e-03 3 1  ON 60
ci_062                -2.821958e-03 3 1  ON 61
ci_063                -2.872112e-03 3 1  ON 62
ci_064                -2.242053e-03 3 1  ON 63
ci_065                -3.432107e-03 3 1  ON 64
ci_066                 4.038352e-03 3 1  ON 65
ci_067                 4.123436e-03 3 1  ON 66
ci_068                -4.330007e-03 3 1  ON 67
ci_069                -4.083313e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.221322
====================================================
  Execution time = 1.6343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0072e-01
  Total weights = 1.9578e+06
  Execution time = 1.8644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287175621682
                                         uncertainty =       0.001796815016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287175621682
                                         uncertainty =       0.001796815016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378929527
  error estimate for blocks of size 2^( 2) =       0.000389718275
  error estimate for blocks of size 2^( 3) =       0.000400640691
  error estimate for blocks of size 2^( 4) =       0.000408113946
  error estimate for blocks of size 2^( 5) =       0.000412422176
  error estimate for blocks of size 2^( 6) =       0.000414705785
  error estimate for blocks of size 2^( 7) =       0.000413466236

      target function =      -0.911519851263
              le_mean =     -17.214600487536
             les_mean =     296.643165967169
             stat err =       0.000412177036
             autocorr =       1.183179637991
   target nu stat err =       0.000412177036
   target dn stat err =       0.002879235540
      target stat err =       0.004525437790
              std dev =       0.535887276913
             le_variance =       0.287175173558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287143844062
                                         uncertainty =       0.001790057494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287143844062
                                         uncertainty =       0.001790057494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378908744
  error estimate for blocks of size 2^( 2) =       0.000389706926
  error estimate for blocks of size 2^( 3) =       0.000400636878
  error estimate for blocks of size 2^( 4) =       0.000408116381
  error estimate for blocks of size 2^( 5) =       0.000412433193
  error estimate for blocks of size 2^( 6) =       0.000414717533
  error estimate for blocks of size 2^( 7) =       0.000413483395

      target function =      -0.910717054997
              le_mean =     -17.214598768034
             les_mean =     296.643620787018
             stat err =       0.000412187625
             autocorr =       1.183370241918
   target nu stat err =       0.000412187625
   target dn stat err =       0.003219492922
      target stat err =       0.005039243938
              std dev =       0.535857884632
             le_variance =       0.287143672522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287157817366
                                         uncertainty =       0.001793252003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287157817366
                                         uncertainty =       0.001793252003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378917878
  error estimate for blocks of size 2^( 2) =       0.000389711556
  error estimate for blocks of size 2^( 3) =       0.000400637922
  error estimate for blocks of size 2^( 4) =       0.000408114502
  error estimate for blocks of size 2^( 5) =       0.000412427296
  error estimate for blocks of size 2^( 6) =       0.000414711258
  error estimate for blocks of size 2^( 7) =       0.000413474596

      target function =      -0.909692563080
              le_mean =     -17.214599447129
             les_mean =     296.644306490709
             stat err =       0.000412181913
             autocorr =       1.183280391884
   target nu stat err =       0.000412181913
   target dn stat err =       0.003164678571
      target stat err =       0.004944092968
              std dev =       0.535870802432
             le_variance =       0.287157516899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287173233216
                                         uncertainty =       0.001796360634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287173233216
                                         uncertainty =       0.001796360634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378927964
  error estimate for blocks of size 2^( 2) =       0.000389717327
  error estimate for blocks of size 2^( 3) =       0.000400640246
  error estimate for blocks of size 2^( 4) =       0.000408113912
  error estimate for blocks of size 2^( 5) =       0.000412422719
  error estimate for blocks of size 2^( 6) =       0.000414706371
  error estimate for blocks of size 2^( 7) =       0.000413467191

      target function =      -0.911573568998
              le_mean =     -17.214600345507
             les_mean =     296.643126376115
             stat err =       0.000412177548
             autocorr =       1.183192341044
   target nu stat err =       0.000412177548
   target dn stat err =       0.002890345447
      target stat err =       0.004543009044
              std dev =       0.535885065993
             le_variance =       0.287172803954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911519851263        initial
     9.7656e-01     9.7656e+00             1.7611e-04        -0.910717054997
     3.9062e+00     3.9062e+01             4.6401e-05        -0.909692563080
     1.5625e+01     1.5625e+02             1.1759e-05        -0.911573568998  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.5716e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -3.765069e-02 3 1  ON 0
ci_002                -2.878946e-02 3 1  ON 1
ci_003                -2.376498e-02 3 1  ON 2
ci_004                 2.098552e-02 3 1  ON 3
ci_005                 2.156532e-02 3 1  ON 4
ci_006                -1.851694e-02 3 1  ON 5
ci_007                -1.852186e-02 3 1  ON 6
ci_008                -7.818105e-03 3 1  ON 7
ci_009                -1.408578e-02 3 1  ON 8
ci_010                -8.911760e-03 3 1  ON 9
ci_011                -9.209128e-03 3 1  ON 10
ci_012                -9.224274e-03 3 1  ON 11
ci_013                -1.925854e-02 3 1  ON 12
ci_014                 1.122137e-02 3 1  ON 13
ci_015                 1.102460e-02 3 1  ON 14
ci_016                 1.595485e-02 3 1  ON 15
ci_017                 1.569687e-02 3 1  ON 16
ci_018                 9.007734e-03 3 1  ON 17
ci_019                 9.077476e-03 3 1  ON 18
ci_020                 1.507365e-02 3 1  ON 19
ci_021                 1.526330e-02 3 1  ON 20
ci_022                 8.307644e-03 3 1  ON 21
ci_023                 8.437995e-03 3 1  ON 22
ci_024                 8.566577e-03 3 1  ON 23
ci_025                 8.675749e-03 3 1  ON 24
ci_026                 1.004507e-02 3 1  ON 25
ci_027                 9.713512e-03 3 1  ON 26
ci_028                -1.456700e-02 3 1  ON 27
ci_029                -1.504368e-02 3 1  ON 28
ci_030                -8.730588e-03 3 1  ON 29
ci_031                -8.602362e-03 3 1  ON 30
ci_032                -1.445433e-02 3 1  ON 31
ci_033                 4.617240e-03 3 1  ON 32
ci_034                 4.874847e-03 3 1  ON 33
ci_035                -3.389245e-03 3 1  ON 34
ci_036                -1.132924e-02 3 1  ON 35
ci_037                -1.153983e-02 3 1  ON 36
ci_038                 9.531779e-04 3 1  ON 37
ci_039                 1.231693e-03 3 1  ON 38
ci_040                -1.603566e-03 3 1  ON 39
ci_041                 8.204501e-03 3 1  ON 40
ci_042                 8.205027e-03 3 1  ON 41
ci_043                -2.399757e-03 3 1  ON 42
ci_044                -3.979838e-03 3 1  ON 43
ci_045                -1.878468e-03 3 1  ON 44
ci_046                 4.795421e-03 3 1  ON 45
ci_047                 4.658267e-03 3 1  ON 46
ci_048                -1.243507e-02 3 1  ON 47
ci_049                -1.291236e-02 3 1  ON 48
ci_050                 2.871448e-03 3 1  ON 49
ci_051                 2.839841e-03 3 1  ON 50
ci_052                -2.323692e-03 3 1  ON 51
ci_053                -2.304832e-03 3 1  ON 52
ci_054                -2.315803e-03 3 1  ON 53
ci_055                -2.411150e-03 3 1  ON 54
ci_056                 4.674648e-03 3 1  ON 55
ci_057                 4.696408e-03 3 1  ON 56
ci_058                -2.072043e-03 3 1  ON 57
ci_059                -2.204643e-03 3 1  ON 58
ci_060                 4.718750e-03 3 1  ON 59
ci_061                 5.155324e-03 3 1  ON 60
ci_062                -2.839193e-03 3 1  ON 61
ci_063                -2.875192e-03 3 1  ON 62
ci_064                -2.244059e-03 3 1  ON 63
ci_065                -3.430183e-03 3 1  ON 64
ci_066                 4.044421e-03 3 1  ON 65
ci_067                 4.124253e-03 3 1  ON 66
ci_068                -4.330718e-03 3 1  ON 67
ci_069                -4.079763e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2386
    reference variance = 0.451562
====================================================
  Execution time = 1.4763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0211e-01
  Total weights = 1.957509211e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288667271175
                                         uncertainty =       0.002000075091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288667271175
                                         uncertainty =       0.002000075091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379940148
  error estimate for blocks of size 2^( 2) =       0.000390977845
  error estimate for blocks of size 2^( 3) =       0.000401854982
  error estimate for blocks of size 2^( 4) =       0.000409768019
  error estimate for blocks of size 2^( 5) =       0.000414098190
  error estimate for blocks of size 2^( 6) =       0.000417533350
  error estimate for blocks of size 2^( 7) =       0.000419651874

      target function =      -0.909337390391
              le_mean =     -17.214527808347
             les_mean =     296.642076935471
             stat err =       0.000415262858
             autocorr =       1.194581551847
   target nu stat err =       0.000415262858
   target dn stat err =       0.002671388969
      target stat err =       0.004187371942
              std dev =       0.537316509800
             le_variance =       0.288709031703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721452780835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909355689042       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909368300834       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909369427119       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909369771878       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909369839707       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909369840131       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909369844150       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909369844649       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909369840433       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909369839630       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 3.005182e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909355689042       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909358888804       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909359173372       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909359260072       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909359277044       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909359277143       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909359278126       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909359278259       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909359277204       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909359277005       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 7.612911e-06

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909355689042       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909356491963       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909356563294       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909356585001       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909356589245       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909356589269       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909356589514       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909356589548       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909356589283       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909356589234       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 1.909581e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7319e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -3.764898e-02 3 1  ON 0
ci_002                -2.878700e-02 3 1  ON 1
ci_003                -2.376081e-02 3 1  ON 2
ci_004                 2.098539e-02 3 1  ON 3
ci_005                 2.156255e-02 3 1  ON 4
ci_006                -1.851032e-02 3 1  ON 5
ci_007                -1.851962e-02 3 1  ON 6
ci_008                -7.819931e-03 3 1  ON 7
ci_009                -1.408294e-02 3 1  ON 8
ci_010                -8.909558e-03 3 1  ON 9
ci_011                -9.205835e-03 3 1  ON 10
ci_012                -9.219230e-03 3 1  ON 11
ci_013                -1.925558e-02 3 1  ON 12
ci_014                 1.122328e-02 3 1  ON 13
ci_015                 1.102140e-02 3 1  ON 14
ci_016                 1.595823e-02 3 1  ON 15
ci_017                 1.569828e-02 3 1  ON 16
ci_018                 9.009899e-03 3 1  ON 17
ci_019                 9.077279e-03 3 1  ON 18
ci_020                 1.507348e-02 3 1  ON 19
ci_021                 1.526158e-02 3 1  ON 20
ci_022                 8.308036e-03 3 1  ON 21
ci_023                 8.430382e-03 3 1  ON 22
ci_024                 8.562672e-03 3 1  ON 23
ci_025                 8.670524e-03 3 1  ON 24
ci_026                 1.003782e-02 3 1  ON 25
ci_027                 9.707341e-03 3 1  ON 26
ci_028                -1.456800e-02 3 1  ON 27
ci_029                -1.504472e-02 3 1  ON 28
ci_030                -8.728003e-03 3 1  ON 29
ci_031                -8.602975e-03 3 1  ON 30
ci_032                -1.445218e-02 3 1  ON 31
ci_033                 4.612306e-03 3 1  ON 32
ci_034                 4.876354e-03 3 1  ON 33
ci_035                -3.388857e-03 3 1  ON 34
ci_036                -1.132772e-02 3 1  ON 35
ci_037                -1.153434e-02 3 1  ON 36
ci_038                 9.514001e-04 3 1  ON 37
ci_039                 1.227879e-03 3 1  ON 38
ci_040                -1.599733e-03 3 1  ON 39
ci_041                 8.202122e-03 3 1  ON 40
ci_042                 8.205656e-03 3 1  ON 41
ci_043                -2.396460e-03 3 1  ON 42
ci_044                -3.975403e-03 3 1  ON 43
ci_045                -1.878965e-03 3 1  ON 44
ci_046                 4.793004e-03 3 1  ON 45
ci_047                 4.656266e-03 3 1  ON 46
ci_048                -1.243845e-02 3 1  ON 47
ci_049                -1.291073e-02 3 1  ON 48
ci_050                 2.869956e-03 3 1  ON 49
ci_051                 2.837308e-03 3 1  ON 50
ci_052                -2.318362e-03 3 1  ON 51
ci_053                -2.300443e-03 3 1  ON 52
ci_054                -2.313789e-03 3 1  ON 53
ci_055                -2.410811e-03 3 1  ON 54
ci_056                 4.674271e-03 3 1  ON 55
ci_057                 4.693695e-03 3 1  ON 56
ci_058                -2.067145e-03 3 1  ON 57
ci_059                -2.201451e-03 3 1  ON 58
ci_060                 4.720389e-03 3 1  ON 59
ci_061                 5.158212e-03 3 1  ON 60
ci_062                -2.839019e-03 3 1  ON 61
ci_063                -2.876689e-03 3 1  ON 62
ci_064                -2.245491e-03 3 1  ON 63
ci_065                -3.427029e-03 3 1  ON 64
ci_066                 4.040411e-03 3 1  ON 65
ci_067                 4.124499e-03 3 1  ON 66
ci_068                -4.331439e-03 3 1  ON 67
ci_069                -4.084039e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.338655
====================================================
  Execution time = 1.4225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0116e-01
  Total weights = 1.9578e+06
  Execution time = 1.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285703852225
                                         uncertainty =       0.001606326982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285703852225
                                         uncertainty =       0.001606326982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378152052
  error estimate for blocks of size 2^( 2) =       0.000389557692
  error estimate for blocks of size 2^( 3) =       0.000399945145
  error estimate for blocks of size 2^( 4) =       0.000407474722
  error estimate for blocks of size 2^( 5) =       0.000412905632
  error estimate for blocks of size 2^( 6) =       0.000415829032
  error estimate for blocks of size 2^( 7) =       0.000416665959

      target function =      -0.910753816889
              le_mean =     -17.215459662174
             les_mean =     296.673216686615
             stat err =       0.000413218837
             autocorr =       1.194063157090
   target nu stat err =       0.000413218837
   target dn stat err =       0.002872449482
      target stat err =       0.004515059908
              std dev =       0.534787760640
             le_variance =       0.285997948931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698787426
                                         uncertainty =       0.001606428586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285698787426
                                         uncertainty =       0.001606428586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378148356
  error estimate for blocks of size 2^( 2) =       0.000389557236
  error estimate for blocks of size 2^( 3) =       0.000399947383
  error estimate for blocks of size 2^( 4) =       0.000407479636
  error estimate for blocks of size 2^( 5) =       0.000412912243
  error estimate for blocks of size 2^( 6) =       0.000415835640
  error estimate for blocks of size 2^( 7) =       0.000416673780

      target function =      -0.910766857809
              le_mean =     -17.215459848276
             les_mean =     296.673214696768
             stat err =       0.000413225325
             autocorr =       1.194123999196
   target nu stat err =       0.000413225325
   target dn stat err =       0.002871713471
      target stat err =       0.004514062111
              std dev =       0.534782533194
             le_variance =       0.285992357809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701236068
                                         uncertainty =       0.001606376962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285701236068
                                         uncertainty =       0.001606376962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378150146
  error estimate for blocks of size 2^( 2) =       0.000389557428
  error estimate for blocks of size 2^( 3) =       0.000399946245
  error estimate for blocks of size 2^( 4) =       0.000407477177
  error estimate for blocks of size 2^( 5) =       0.000412908948
  error estimate for blocks of size 2^( 6) =       0.000415832345
  error estimate for blocks of size 2^( 7) =       0.000416669885

      target function =      -0.910762234836
              le_mean =     -17.215459749443
             les_mean =     296.673214270961
             stat err =       0.000413222089
             autocorr =       1.194093987662
   target nu stat err =       0.000413222089
   target dn stat err =       0.002872042003
      target stat err =       0.004514519013
              std dev =       0.534785065610
             le_variance =       0.285995066399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285703518104
                                         uncertainty =       0.001606333057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285703518104
                                         uncertainty =       0.001606333057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378151809
  error estimate for blocks of size 2^( 2) =       0.000389557655
  error estimate for blocks of size 2^( 3) =       0.000399945279
  error estimate for blocks of size 2^( 4) =       0.000407475026
  error estimate for blocks of size 2^( 5) =       0.000412906044
  error estimate for blocks of size 2^( 6) =       0.000415829444
  error estimate for blocks of size 2^( 7) =       0.000416666447

      target function =      -0.910755052106
              le_mean =     -17.215459672325
             les_mean =     296.673216240779
             stat err =       0.000413219240
             autocorr =       1.194067024332
   target nu stat err =       0.000413219240
   target dn stat err =       0.002872393953
      target stat err =       0.004514987036
              std dev =       0.534787417024
             le_variance =       0.285997581407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910753816889        initial
     3.9062e+00     3.9062e+01             3.0052e-05        -0.910766857809  <--
     1.5625e+01     1.5625e+02             7.6129e-06        -0.910762234836
     6.2500e+01     6.2500e+02             1.9096e-06        -0.910755052106

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.3587e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -3.764393e-02 3 1  ON 0
ci_002                -2.877972e-02 3 1  ON 1
ci_003                -2.374846e-02 3 1  ON 2
ci_004                 2.098495e-02 3 1  ON 3
ci_005                 2.155432e-02 3 1  ON 4
ci_006                -1.849077e-02 3 1  ON 5
ci_007                -1.851300e-02 3 1  ON 6
ci_008                -7.825281e-03 3 1  ON 7
ci_009                -1.407456e-02 3 1  ON 8
ci_010                -8.903072e-03 3 1  ON 9
ci_011                -9.196124e-03 3 1  ON 10
ci_012                -9.204366e-03 3 1  ON 11
ci_013                -1.924684e-02 3 1  ON 12
ci_014                 1.122893e-02 3 1  ON 13
ci_015                 1.101198e-02 3 1  ON 14
ci_016                 1.596825e-02 3 1  ON 15
ci_017                 1.570247e-02 3 1  ON 16
ci_018                 9.016263e-03 3 1  ON 17
ci_019                 9.076700e-03 3 1  ON 18
ci_020                 1.507297e-02 3 1  ON 19
ci_021                 1.525653e-02 3 1  ON 20
ci_022                 8.309204e-03 3 1  ON 21
ci_023                 8.407943e-03 3 1  ON 22
ci_024                 8.551144e-03 3 1  ON 23
ci_025                 8.655103e-03 3 1  ON 24
ci_026                 1.001650e-02 3 1  ON 25
ci_027                 9.689162e-03 3 1  ON 26
ci_028                -1.457096e-02 3 1  ON 27
ci_029                -1.504781e-02 3 1  ON 28
ci_030                -8.720417e-03 3 1  ON 29
ci_031                -8.604773e-03 3 1  ON 30
ci_032                -1.444585e-02 3 1  ON 31
ci_033                 4.597756e-03 3 1  ON 32
ci_034                 4.880794e-03 3 1  ON 33
ci_035                -3.387718e-03 3 1  ON 34
ci_036                -1.132321e-02 3 1  ON 35
ci_037                -1.151816e-02 3 1  ON 36
ci_038                 9.461685e-04 3 1  ON 37
ci_039                 1.216653e-03 3 1  ON 38
ci_040                -1.588460e-03 3 1  ON 39
ci_041                 8.195134e-03 3 1  ON 40
ci_042                 8.207518e-03 3 1  ON 41
ci_043                -2.386754e-03 3 1  ON 42
ci_044                -3.962337e-03 3 1  ON 43
ci_045                -1.880430e-03 3 1  ON 44
ci_046                 4.785877e-03 3 1  ON 45
ci_047                 4.650368e-03 3 1  ON 46
ci_048                -1.244845e-02 3 1  ON 47
ci_049                -1.290591e-02 3 1  ON 48
ci_050                 2.865573e-03 3 1  ON 49
ci_051                 2.829861e-03 3 1  ON 50
ci_052                -2.302710e-03 3 1  ON 51
ci_053                -2.287528e-03 3 1  ON 52
ci_054                -2.307858e-03 3 1  ON 53
ci_055                -2.409803e-03 3 1  ON 54
ci_056                 4.673159e-03 3 1  ON 55
ci_057                 4.685706e-03 3 1  ON 56
ci_058                -2.052741e-03 3 1  ON 57
ci_059                -2.192049e-03 3 1  ON 58
ci_060                 4.725224e-03 3 1  ON 59
ci_061                 5.166723e-03 3 1  ON 60
ci_062                -2.838495e-03 3 1  ON 61
ci_063                -2.881085e-03 3 1  ON 62
ci_064                -2.249704e-03 3 1  ON 63
ci_065                -3.417749e-03 3 1  ON 64
ci_066                 4.028612e-03 3 1  ON 65
ci_067                 4.125223e-03 3 1  ON 66
ci_068                -4.333571e-03 3 1  ON 67
ci_069                -4.096651e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2911
    reference variance = 0.284643
====================================================
  Execution time = 1.4726e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0030e-01
  Total weights = 1.957727735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287633714830
                                         uncertainty =       0.001793984973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287633714830
                                         uncertainty =       0.001793984973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379287353
  error estimate for blocks of size 2^( 2) =       0.000390291671
  error estimate for blocks of size 2^( 3) =       0.000400802716
  error estimate for blocks of size 2^( 4) =       0.000408268810
  error estimate for blocks of size 2^( 5) =       0.000412605569
  error estimate for blocks of size 2^( 6) =       0.000414302340
  error estimate for blocks of size 2^( 7) =       0.000416702388

      target function =      -0.912143587139
              le_mean =     -17.214444167221
             les_mean =     296.637389434888
             stat err =       0.000412969777
             autocorr =       1.185495236403
   target nu stat err =       0.000412969777
   target dn stat err =       0.002586076715
      target stat err =       0.004080887737
              std dev =       0.536393319206
             le_variance =       0.287717792889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721444416722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912160935517       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912199916128       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912203492234       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912204533777       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912204629273       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912204800336       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912204826784       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912204838390       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912204835522       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 9.962608e-05

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912160935517       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912171256998       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912172190627       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912172459485       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912172481697       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912172525504       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912172532405       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912172535259       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912172534544       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 2.619082e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912160935517       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912163554609       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912163790621       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912163858382       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912163863817       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912163874834       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912163876578       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912163877288       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912163877109       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 6.633257e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7241e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -3.763957e-02 3 1  ON 0
ci_002                -2.877416e-02 3 1  ON 1
ci_003                -2.372968e-02 3 1  ON 2
ci_004                 2.097885e-02 3 1  ON 3
ci_005                 2.155532e-02 3 1  ON 4
ci_006                -1.849279e-02 3 1  ON 5
ci_007                -1.850394e-02 3 1  ON 6
ci_008                -7.807624e-03 3 1  ON 7
ci_009                -1.405987e-02 3 1  ON 8
ci_010                -8.895332e-03 3 1  ON 9
ci_011                -9.182268e-03 3 1  ON 10
ci_012                -9.182377e-03 3 1  ON 11
ci_013                -1.924402e-02 3 1  ON 12
ci_014                 1.121595e-02 3 1  ON 13
ci_015                 1.101788e-02 3 1  ON 14
ci_016                 1.596998e-02 3 1  ON 15
ci_017                 1.569392e-02 3 1  ON 16
ci_018                 9.033341e-03 3 1  ON 17
ci_019                 9.051798e-03 3 1  ON 18
ci_020                 1.507097e-02 3 1  ON 19
ci_021                 1.523947e-02 3 1  ON 20
ci_022                 8.296034e-03 3 1  ON 21
ci_023                 8.395930e-03 3 1  ON 22
ci_024                 8.559597e-03 3 1  ON 23
ci_025                 8.639438e-03 3 1  ON 24
ci_026                 1.001976e-02 3 1  ON 25
ci_027                 9.676146e-03 3 1  ON 26
ci_028                -1.458500e-02 3 1  ON 27
ci_029                -1.503775e-02 3 1  ON 28
ci_030                -8.740621e-03 3 1  ON 29
ci_031                -8.593930e-03 3 1  ON 30
ci_032                -1.444418e-02 3 1  ON 31
ci_033                 4.586322e-03 3 1  ON 32
ci_034                 4.890084e-03 3 1  ON 33
ci_035                -3.377301e-03 3 1  ON 34
ci_036                -1.130703e-02 3 1  ON 35
ci_037                -1.151570e-02 3 1  ON 36
ci_038                 9.393683e-04 3 1  ON 37
ci_039                 1.218521e-03 3 1  ON 38
ci_040                -1.592392e-03 3 1  ON 39
ci_041                 8.191001e-03 3 1  ON 40
ci_042                 8.220207e-03 3 1  ON 41
ci_043                -2.386505e-03 3 1  ON 42
ci_044                -3.951403e-03 3 1  ON 43
ci_045                -1.877758e-03 3 1  ON 44
ci_046                 4.782108e-03 3 1  ON 45
ci_047                 4.649111e-03 3 1  ON 46
ci_048                -1.244260e-02 3 1  ON 47
ci_049                -1.289963e-02 3 1  ON 48
ci_050                 2.854578e-03 3 1  ON 49
ci_051                 2.826357e-03 3 1  ON 50
ci_052                -2.295467e-03 3 1  ON 51
ci_053                -2.266738e-03 3 1  ON 52
ci_054                -2.311423e-03 3 1  ON 53
ci_055                -2.400480e-03 3 1  ON 54
ci_056                 4.669869e-03 3 1  ON 55
ci_057                 4.682996e-03 3 1  ON 56
ci_058                -2.050822e-03 3 1  ON 57
ci_059                -2.172533e-03 3 1  ON 58
ci_060                 4.727375e-03 3 1  ON 59
ci_061                 5.170512e-03 3 1  ON 60
ci_062                -2.835789e-03 3 1  ON 61
ci_063                -2.854894e-03 3 1  ON 62
ci_064                -2.240160e-03 3 1  ON 63
ci_065                -3.412522e-03 3 1  ON 64
ci_066                 4.037682e-03 3 1  ON 65
ci_067                 4.134633e-03 3 1  ON 66
ci_068                -4.350507e-03 3 1  ON 67
ci_069                -4.101382e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1999
    reference variance = 0.180148
====================================================
  Execution time = 1.4111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0002e-01
  Total weights = 1.9580e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287204313215
                                         uncertainty =       0.002153824259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287204313215
                                         uncertainty =       0.002153824259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378957100
  error estimate for blocks of size 2^( 2) =       0.000389928718
  error estimate for blocks of size 2^( 3) =       0.000400168602
  error estimate for blocks of size 2^( 4) =       0.000408125349
  error estimate for blocks of size 2^( 5) =       0.000413426524
  error estimate for blocks of size 2^( 6) =       0.000416252509
  error estimate for blocks of size 2^( 7) =       0.000416885041

      target function =      -0.912530970793
              le_mean =     -17.214916010433
             les_mean =     296.653371117923
             stat err =       0.000413672356
             autocorr =       1.191606608614
   target nu stat err =       0.000413672356
   target dn stat err =       0.002828518704
      target stat err =       0.004460438029
              std dev =       0.535926270262
             le_variance =       0.287216967157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287175164069
                                         uncertainty =       0.002149615844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287175164069
                                         uncertainty =       0.002149615844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378937696
  error estimate for blocks of size 2^( 2) =       0.000389921097
  error estimate for blocks of size 2^( 3) =       0.000400171907
  error estimate for blocks of size 2^( 4) =       0.000408134305
  error estimate for blocks of size 2^( 5) =       0.000413441003
  error estimate for blocks of size 2^( 6) =       0.000416266247
  error estimate for blocks of size 2^( 7) =       0.000416900174

      target function =      -0.912625379978
              le_mean =     -17.214917867813
             les_mean =     296.653374583489
             stat err =       0.000413685432
             autocorr =       1.191803992163
   target nu stat err =       0.000413685432
   target dn stat err =       0.002808379057
      target stat err =       0.004430399344
              std dev =       0.535898828390
             le_variance =       0.287187554269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287188386753
                                         uncertainty =       0.002151601067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287188386753
                                         uncertainty =       0.002151601067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378946501
  error estimate for blocks of size 2^( 2) =       0.000389924333
  error estimate for blocks of size 2^( 3) =       0.000400169989
  error estimate for blocks of size 2^( 4) =       0.000408129729
  error estimate for blocks of size 2^( 5) =       0.000413433776
  error estimate for blocks of size 2^( 6) =       0.000416259356
  error estimate for blocks of size 2^( 7) =       0.000416892640

      target function =      -0.912247128808
              le_mean =     -17.214916936083
             les_mean =     296.653585341302
             stat err =       0.000413678875
             autocorr =       1.191710825555
   target nu stat err =       0.000413678875
   target dn stat err =       0.002825997075
      target stat err =       0.004453833189
              std dev =       0.535911281716
             le_variance =       0.287200901870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287202218943
                                         uncertainty =       0.002153541369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287202218943
                                         uncertainty =       0.002153541369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378955707
  error estimate for blocks of size 2^( 2) =       0.000389928110
  error estimate for blocks of size 2^( 3) =       0.000400168723
  error estimate for blocks of size 2^( 4) =       0.000408125848
  error estimate for blocks of size 2^( 5) =       0.000413427390
  error estimate for blocks of size 2^( 6) =       0.000416253325
  error estimate for blocks of size 2^( 7) =       0.000416885948

      target function =      -0.912539346823
              le_mean =     -17.214916116266
             les_mean =     296.653369392889
             stat err =       0.000413673128
             autocorr =       1.191619815741
   target nu stat err =       0.000413673128
   target dn stat err =       0.002827123016
      target stat err =       0.004458374036
              std dev =       0.535924299993
             le_variance =       0.287214855323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912530970793        initial
     9.7656e-01     9.7656e+00             9.9626e-05        -0.912625379978  <--
     3.9062e+00     3.9062e+01             2.6191e-05        -0.912247128808
     1.5625e+01     1.5625e+02             6.6333e-06        -0.912539346823

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3460e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1643
    reference variance = 0.331087
====================================================
  Execution time = 1.4588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0091e-01
  Total weights = 1.957920730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286642840004
                                         uncertainty =       0.001522598238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286642840004
                                         uncertainty =       0.001522598238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378531321
  error estimate for blocks of size 2^( 2) =       0.000389814378
  error estimate for blocks of size 2^( 3) =       0.000400332509
  error estimate for blocks of size 2^( 4) =       0.000408215895
  error estimate for blocks of size 2^( 5) =       0.000412573245
  error estimate for blocks of size 2^( 6) =       0.000415017891
  error estimate for blocks of size 2^( 7) =       0.000416227511

      target function =      -0.911198432103
              le_mean =     -17.214530140696
             les_mean =     296.640953048651
             stat err =       0.000413008636
             autocorr =       1.190459498521
   target nu stat err =       0.000413008636
   target dn stat err =       0.002871523431
      target stat err =       0.004510091419
              std dev =       0.535324127770
             le_variance =       0.286571921773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721453014070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911220004179       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911369643860       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911401776793       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911406068590       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911408417923       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911409052641       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911409063547       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911409024202       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911409043841       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911409055753       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911409054796       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-01 is 6.122988e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911220004179       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911265915160       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911275369579       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911276546572       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911277192661       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911277348400       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911277349226       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911277338721       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911277343790       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911277346792       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 1.847106e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911220004179       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911232173136       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911234645034       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911234945771       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911235111095       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911235149459       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911235149526       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911235146867       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911235148146       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911235148888       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 4.869514e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123246 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7117e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.756100e-02 3 1  ON 0
ci_002                -2.871941e-02 3 1  ON 1
ci_003                -2.375937e-02 3 1  ON 2
ci_004                 2.099717e-02 3 1  ON 3
ci_005                 2.148608e-02 3 1  ON 4
ci_006                -1.848466e-02 3 1  ON 5
ci_007                -1.850501e-02 3 1  ON 6
ci_008                -7.750147e-03 3 1  ON 7
ci_009                -1.412695e-02 3 1  ON 8
ci_010                -8.931784e-03 3 1  ON 9
ci_011                -9.167085e-03 3 1  ON 10
ci_012                -8.936148e-03 3 1  ON 11
ci_013                -1.916725e-02 3 1  ON 12
ci_014                 1.114865e-02 3 1  ON 13
ci_015                 1.099573e-02 3 1  ON 14
ci_016                 1.599214e-02 3 1  ON 15
ci_017                 1.562429e-02 3 1  ON 16
ci_018                 9.058164e-03 3 1  ON 17
ci_019                 8.878267e-03 3 1  ON 18
ci_020                 1.505422e-02 3 1  ON 19
ci_021                 1.510730e-02 3 1  ON 20
ci_022                 8.211827e-03 3 1  ON 21
ci_023                 8.368499e-03 3 1  ON 22
ci_024                 8.636633e-03 3 1  ON 23
ci_025                 8.561862e-03 3 1  ON 24
ci_026                 1.007382e-02 3 1  ON 25
ci_027                 9.555804e-03 3 1  ON 26
ci_028                -1.459785e-02 3 1  ON 27
ci_029                -1.502826e-02 3 1  ON 28
ci_030                -8.858053e-03 3 1  ON 29
ci_031                -8.478968e-03 3 1  ON 30
ci_032                -1.444268e-02 3 1  ON 31
ci_033                 4.580389e-03 3 1  ON 32
ci_034                 4.865950e-03 3 1  ON 33
ci_035                -3.351273e-03 3 1  ON 34
ci_036                -1.124125e-02 3 1  ON 35
ci_037                -1.147038e-02 3 1  ON 36
ci_038                 9.044423e-04 3 1  ON 37
ci_039                 1.181329e-03 3 1  ON 38
ci_040                -1.597292e-03 3 1  ON 39
ci_041                 8.177566e-03 3 1  ON 40
ci_042                 8.220199e-03 3 1  ON 41
ci_043                -2.375344e-03 3 1  ON 42
ci_044                -3.861465e-03 3 1  ON 43
ci_045                -1.816884e-03 3 1  ON 44
ci_046                 4.737434e-03 3 1  ON 45
ci_047                 4.631697e-03 3 1  ON 46
ci_048                -1.244530e-02 3 1  ON 47
ci_049                -1.293956e-02 3 1  ON 48
ci_050                 2.814681e-03 3 1  ON 49
ci_051                 2.862292e-03 3 1  ON 50
ci_052                -2.250469e-03 3 1  ON 51
ci_053                -2.240143e-03 3 1  ON 52
ci_054                -2.341281e-03 3 1  ON 53
ci_055                -2.349553e-03 3 1  ON 54
ci_056                 4.700076e-03 3 1  ON 55
ci_057                 4.667326e-03 3 1  ON 56
ci_058                -1.995672e-03 3 1  ON 57
ci_059                -2.084811e-03 3 1  ON 58
ci_060                 4.749245e-03 3 1  ON 59
ci_061                 5.206027e-03 3 1  ON 60
ci_062                -2.812876e-03 3 1  ON 61
ci_063                -2.779738e-03 3 1  ON 62
ci_064                -2.235475e-03 3 1  ON 63
ci_065                -3.393489e-03 3 1  ON 64
ci_066                 4.063775e-03 3 1  ON 65
ci_067                 4.136101e-03 3 1  ON 66
ci_068                -4.323775e-03 3 1  ON 67
ci_069                -4.006077e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.206804
====================================================
  Execution time = 1.4126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.9577e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288448941703
                                         uncertainty =       0.004073355309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288448941703
                                         uncertainty =       0.004073355309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379781093
  error estimate for blocks of size 2^( 2) =       0.000390842364
  error estimate for blocks of size 2^( 3) =       0.000401397378
  error estimate for blocks of size 2^( 4) =       0.000409374828
  error estimate for blocks of size 2^( 5) =       0.000413636809
  error estimate for blocks of size 2^( 6) =       0.000415776069
  error estimate for blocks of size 2^( 7) =       0.000417837059

      target function =      -0.910389202622
              le_mean =     -17.214816430847
             les_mean =     296.651300985743
             stat err =       0.000414156191
             autocorr =       1.189218444497
   target nu stat err =       0.000414156191
   target dn stat err =       0.004641435237
      target stat err =       0.007226614045
              std dev =       0.537091572068
             le_variance =       0.288467356786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288501792182
                                         uncertainty =       0.004097578181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288501792182
                                         uncertainty =       0.004097578181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379816045
  error estimate for blocks of size 2^( 2) =       0.000390888177
  error estimate for blocks of size 2^( 3) =       0.000401464825
  error estimate for blocks of size 2^( 4) =       0.000409467032
  error estimate for blocks of size 2^( 5) =       0.000413732232
  error estimate for blocks of size 2^( 6) =       0.000415860590
  error estimate for blocks of size 2^( 7) =       0.000417907075

      target function =      -0.909852655857
              le_mean =     -17.214826701639
             les_mean =     296.651998810626
             stat err =       0.000414241732
             autocorr =       1.189490790221
   target nu stat err =       0.000414241732
   target dn stat err =       0.004765723940
      target stat err =       0.007409790041
              std dev =       0.537141002356
             le_variance =       0.288520456412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288471412947
                                         uncertainty =       0.004087751329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288471412947
                                         uncertainty =       0.004087751329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379795988
  error estimate for blocks of size 2^( 2) =       0.000390863434
  error estimate for blocks of size 2^( 3) =       0.000401431521
  error estimate for blocks of size 2^( 4) =       0.000409424153
  error estimate for blocks of size 2^( 5) =       0.000413687971
  error estimate for blocks of size 2^( 6) =       0.000415821628
  error estimate for blocks of size 2^( 7) =       0.000417873699

      target function =      -0.910066118307
              le_mean =     -17.214821746544
             les_mean =     296.651691784581
             stat err =       0.000414201863
             autocorr =       1.189387447393
   target nu stat err =       0.000414201863
   target dn stat err =       0.004682523059
      target stat err =       0.007284919553
              std dev =       0.537112636628
             le_variance =       0.288489984425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288555958604
                                         uncertainty =       0.004071477733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288555958604
                                         uncertainty =       0.004071477733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379851143
  error estimate for blocks of size 2^( 2) =       0.000390906940
  error estimate for blocks of size 2^( 3) =       0.000401466648
  error estimate for blocks of size 2^( 4) =       0.000409445126
  error estimate for blocks of size 2^( 5) =       0.000413700643
  error estimate for blocks of size 2^( 6) =       0.000415877314
  error estimate for blocks of size 2^( 7) =       0.000417924880

      target function =      -0.138040177221
              le_mean =     -17.214809761052
             les_mean =     298.518071532966
             stat err =       0.000414236991
             autocorr =       1.189243760678
   target nu stat err =       0.000414236991
   target dn stat err =       1.868103457183
      target stat err =       0.105060468966
              std dev =       0.537190637820
             le_variance =       0.288573781361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910389202622        initial  <--
     2.4414e-01     2.4414e+00             6.1230e-04        -0.909852655857
     9.7656e-01     9.7656e+00             1.8471e-04        -0.910066118307
     3.9062e+00     3.9062e+01             4.8695e-05        -0.138040177221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4462
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1888
    reference variance = 0.236428
====================================================
  Execution time = 1.4560e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0175e-01
  Total weights = 1.957770871e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287768711521
                                         uncertainty =       0.001626461822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287768711521
                                         uncertainty =       0.001626461822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379340211
  error estimate for blocks of size 2^( 2) =       0.000390510275
  error estimate for blocks of size 2^( 3) =       0.000400957081
  error estimate for blocks of size 2^( 4) =       0.000408653023
  error estimate for blocks of size 2^( 5) =       0.000413668467
  error estimate for blocks of size 2^( 6) =       0.000416547966
  error estimate for blocks of size 2^( 7) =       0.000419255088

      target function =      -0.909878151222
              le_mean =     -17.214894701161
             les_mean =     296.654351329403
             stat err =       0.000414531136
             autocorr =       1.194143589066
   target nu stat err =       0.000414531136
   target dn stat err =       0.002316301815
      target stat err =       0.003654257274
              std dev =       0.536468070594
             le_variance =       0.287797990767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721489470116e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909891952914       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909906209474       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909908841080       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909909763624       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909909992716       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909910012229       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909910007679       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909910009512       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909910007514       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909910006967       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 5.405610e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909891952914       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909895602649       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909896271755       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909896505042       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909896562851       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909896567539       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909896566388       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909896566831       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909896566348       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909896566203       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.378571e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909891952914       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909892870859       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909893038849       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909893097337       residual = 7.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909893111823       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909893112983       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909893112694       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909893112804       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909893112685       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909893112647       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 3.463856e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.130387 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7094e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -3.761871e-02 3 1  ON 0
ci_002                -2.875489e-02 3 1  ON 1
ci_003                -2.366801e-02 3 1  ON 2
ci_004                 2.095865e-02 3 1  ON 3
ci_005                 2.154828e-02 3 1  ON 4
ci_006                -1.849975e-02 3 1  ON 5
ci_007                -1.847476e-02 3 1  ON 6
ci_008                -7.754660e-03 3 1  ON 7
ci_009                -1.402275e-02 3 1  ON 8
ci_010                -8.875443e-03 3 1  ON 9
ci_011                -9.144780e-03 3 1  ON 10
ci_012                -9.114721e-03 3 1  ON 11
ci_013                -1.923846e-02 3 1  ON 12
ci_014                 1.117140e-02 3 1  ON 13
ci_015                 1.102614e-02 3 1  ON 14
ci_016                 1.597222e-02 3 1  ON 15
ci_017                 1.568095e-02 3 1  ON 16
ci_018                 9.083200e-03 3 1  ON 17
ci_019                 8.981378e-03 3 1  ON 18
ci_020                 1.506420e-02 3 1  ON 19
ci_021                 1.518432e-02 3 1  ON 20
ci_022                 8.262120e-03 3 1  ON 21
ci_023                 8.358833e-03 3 1  ON 22
ci_024                 8.584649e-03 3 1  ON 23
ci_025                 8.581048e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.640435e-03 3 1  ON 26
ci_028                -1.462729e-02 3 1  ON 27
ci_029                -1.500616e-02 3 1  ON 28
ci_030                -8.805412e-03 3 1  ON 29
ci_031                -8.571705e-03 3 1  ON 30
ci_032                -1.443456e-02 3 1  ON 31
ci_033                 4.557830e-03 3 1  ON 32
ci_034                 4.919902e-03 3 1  ON 33
ci_035                -3.348270e-03 3 1  ON 34
ci_036                -1.126216e-02 3 1  ON 35
ci_037                -1.150782e-02 3 1  ON 36
ci_038                 9.213062e-04 3 1  ON 37
ci_039                 1.218329e-03 3 1  ON 38
ci_040                -1.603673e-03 3 1  ON 39
ci_041                 8.175274e-03 3 1  ON 40
ci_042                 8.249452e-03 3 1  ON 41
ci_043                -2.381526e-03 3 1  ON 42
ci_044                -3.930003e-03 3 1  ON 43
ci_045                -1.872982e-03 3 1  ON 44
ci_046                 4.766996e-03 3 1  ON 45
ci_047                 4.640938e-03 3 1  ON 46
ci_048                -1.242184e-02 3 1  ON 47
ci_049                -1.288551e-02 3 1  ON 48
ci_050                 2.832320e-03 3 1  ON 49
ci_051                 2.823015e-03 3 1  ON 50
ci_052                -2.270784e-03 3 1  ON 51
ci_053                -2.203728e-03 3 1  ON 52
ci_054                -2.320506e-03 3 1  ON 53
ci_055                -2.376037e-03 3 1  ON 54
ci_056                 4.661016e-03 3 1  ON 55
ci_057                 4.675026e-03 3 1  ON 56
ci_058                -2.041508e-03 3 1  ON 57
ci_059                -2.116785e-03 3 1  ON 58
ci_060                 4.731475e-03 3 1  ON 59
ci_061                 5.171718e-03 3 1  ON 60
ci_062                -2.826644e-03 3 1  ON 61
ci_063                -2.784527e-03 3 1  ON 62
ci_064                -2.217784e-03 3 1  ON 63
ci_065                -3.396373e-03 3 1  ON 64
ci_066                 4.062154e-03 3 1  ON 65
ci_067                 4.161126e-03 3 1  ON 66
ci_068                -4.398418e-03 3 1  ON 67
ci_069                -4.119998e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.201599
====================================================
  Execution time = 1.4151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0018e-01
  Total weights = 1.9578e+06
  Execution time = 1.8351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286880877460
                                         uncertainty =       0.001758169484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286880877460
                                         uncertainty =       0.001758169484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378706218
  error estimate for blocks of size 2^( 2) =       0.000390160917
  error estimate for blocks of size 2^( 3) =       0.000400617557
  error estimate for blocks of size 2^( 4) =       0.000408071068
  error estimate for blocks of size 2^( 5) =       0.000413231839
  error estimate for blocks of size 2^( 6) =       0.000417179782
  error estimate for blocks of size 2^( 7) =       0.000418805629

      target function =      -0.912395629926
              le_mean =     -17.214432590965
             les_mean =     296.636831914258
             stat err =       0.000414322080
             autocorr =       1.196936980062
   target nu stat err =       0.000414322080
   target dn stat err =       0.002238334044
      target stat err =       0.003551971701
              std dev =       0.535571469123
             le_variance =       0.286836798539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286870215388
                                         uncertainty =       0.001757955356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286870215388
                                         uncertainty =       0.001757955356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378699170
  error estimate for blocks of size 2^( 2) =       0.000390155268
  error estimate for blocks of size 2^( 3) =       0.000400614798
  error estimate for blocks of size 2^( 4) =       0.000408071121
  error estimate for blocks of size 2^( 5) =       0.000413232348
  error estimate for blocks of size 2^( 6) =       0.000417179182
  error estimate for blocks of size 2^( 7) =       0.000418804424

      target function =      -0.912128401231
              le_mean =     -17.214433614824
             les_mean =     296.637038867572
             stat err =       0.000414321769
             autocorr =       1.196979733806
   target nu stat err =       0.000414321769
   target dn stat err =       0.002258485436
      target stat err =       0.003580640952
              std dev =       0.535561502324
             le_variance =       0.286826122771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286875301676
                                         uncertainty =       0.001758058760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286875301676
                                         uncertainty =       0.001758058760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378702532
  error estimate for blocks of size 2^( 2) =       0.000390157943
  error estimate for blocks of size 2^( 3) =       0.000400616056
  error estimate for blocks of size 2^( 4) =       0.000408071008
  error estimate for blocks of size 2^( 5) =       0.000413232012
  error estimate for blocks of size 2^( 6) =       0.000417179385
  error estimate for blocks of size 2^( 7) =       0.000418804917

      target function =      -0.912283323080
              le_mean =     -17.214433100694
             les_mean =     296.636921609268
             stat err =       0.000414321831
             autocorr =       1.196958836840
   target nu stat err =       0.000414321831
   target dn stat err =       0.002246935460
      target stat err =       0.003564225861
              std dev =       0.535566257185
             le_variance =       0.286831215835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286880161863
                                         uncertainty =       0.001758155411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286880161863
                                         uncertainty =       0.001758155411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378705745
  error estimate for blocks of size 2^( 2) =       0.000390160533
  error estimate for blocks of size 2^( 3) =       0.000400617358
  error estimate for blocks of size 2^( 4) =       0.000408071050
  error estimate for blocks of size 2^( 5) =       0.000413231852
  error estimate for blocks of size 2^( 6) =       0.000417179723
  error estimate for blocks of size 2^( 7) =       0.000418805529

      target function =      -0.912383555698
              le_mean =     -17.214432653550
             les_mean =     296.636841824284
             stat err =       0.000414322038
             autocorr =       1.196939731766
   target nu stat err =       0.000414322038
   target dn stat err =       0.002239273349
      target stat err =       0.003553311610
              std dev =       0.535570800251
             le_variance =       0.286836082081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912395629926        initial  <--
     2.4414e+00     2.4414e+01             5.4056e-05        -0.912128401231
     9.7656e+00     9.7656e+01             1.3786e-05        -0.912283323080
     3.9062e+01     3.9062e+02             3.4639e-06        -0.912383555698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4239
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.234
    reference variance = 0.247346
====================================================
  Execution time = 1.4466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9866e-01
  Total weights = 1.957692046e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285694138104
                                         uncertainty =       0.001572123967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285694138104
                                         uncertainty =       0.001572123967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377948980
  error estimate for blocks of size 2^( 2) =       0.000389389613
  error estimate for blocks of size 2^( 3) =       0.000399413358
  error estimate for blocks of size 2^( 4) =       0.000406967229
  error estimate for blocks of size 2^( 5) =       0.000411362778
  error estimate for blocks of size 2^( 6) =       0.000414895645
  error estimate for blocks of size 2^( 7) =       0.000417431064

      target function =      -0.914680664576
              le_mean =     -17.215072736924
             les_mean =     296.657392346356
             stat err =       0.000412664179
             autocorr =       1.192139808576
   target nu stat err =       0.000412664179
   target dn stat err =       0.002079614949
      target stat err =       0.003330022714
              std dev =       0.534500572729
             le_variance =       0.285690862248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721507273692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914691941583       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914693653113       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914693878714       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914693977859       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914693985127       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914693986346       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914693986435       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914693986268       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914693986260       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914693986307       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 7.315353e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914691941583       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914692370530       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914692427043       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914692451862       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914692453677       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914692453982       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914692454003       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914692453961       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914692453960       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914692453971       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 1.832758e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914691941583       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914692048886       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914692063022       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914692069228       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914692069683       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914692069758       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914692069764       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914692069753       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914692069752       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914692069755       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 4.584352e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6986e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -3.762692e-02 3 1  ON 0
ci_002                -2.875802e-02 3 1  ON 1
ci_003                -2.367646e-02 3 1  ON 2
ci_004                 2.096127e-02 3 1  ON 3
ci_005                 2.155741e-02 3 1  ON 4
ci_006                -1.849872e-02 3 1  ON 5
ci_007                -1.847818e-02 3 1  ON 6
ci_008                -7.758777e-03 3 1  ON 7
ci_009                -1.401874e-02 3 1  ON 8
ci_010                -8.873136e-03 3 1  ON 9
ci_011                -9.143545e-03 3 1  ON 10
ci_012                -9.120564e-03 3 1  ON 11
ci_013                -1.923598e-02 3 1  ON 12
ci_014                 1.117915e-02 3 1  ON 13
ci_015                 1.103486e-02 3 1  ON 14
ci_016                 1.597461e-02 3 1  ON 15
ci_017                 1.566981e-02 3 1  ON 16
ci_018                 9.081316e-03 3 1  ON 17
ci_019                 8.983704e-03 3 1  ON 18
ci_020                 1.506298e-02 3 1  ON 19
ci_021                 1.519142e-02 3 1  ON 20
ci_022                 8.259880e-03 3 1  ON 21
ci_023                 8.362623e-03 3 1  ON 22
ci_024                 8.583615e-03 3 1  ON 23
ci_025                 8.594312e-03 3 1  ON 24
ci_026                 1.002870e-02 3 1  ON 25
ci_027                 9.639793e-03 3 1  ON 26
ci_028                -1.462439e-02 3 1  ON 27
ci_029                -1.500905e-02 3 1  ON 28
ci_030                -8.796490e-03 3 1  ON 29
ci_031                -8.563740e-03 3 1  ON 30
ci_032                -1.443946e-02 3 1  ON 31
ci_033                 4.554940e-03 3 1  ON 32
ci_034                 4.916300e-03 3 1  ON 33
ci_035                -3.348219e-03 3 1  ON 34
ci_036                -1.126212e-02 3 1  ON 35
ci_037                -1.150862e-02 3 1  ON 36
ci_038                 9.204378e-04 3 1  ON 37
ci_039                 1.223417e-03 3 1  ON 38
ci_040                -1.602785e-03 3 1  ON 39
ci_041                 8.179663e-03 3 1  ON 40
ci_042                 8.254916e-03 3 1  ON 41
ci_043                -2.386057e-03 3 1  ON 42
ci_044                -3.921148e-03 3 1  ON 43
ci_045                -1.870447e-03 3 1  ON 44
ci_046                 4.770912e-03 3 1  ON 45
ci_047                 4.645329e-03 3 1  ON 46
ci_048                -1.242682e-02 3 1  ON 47
ci_049                -1.288204e-02 3 1  ON 48
ci_050                 2.823985e-03 3 1  ON 49
ci_051                 2.816559e-03 3 1  ON 50
ci_052                -2.276460e-03 3 1  ON 51
ci_053                -2.209823e-03 3 1  ON 52
ci_054                -2.321697e-03 3 1  ON 53
ci_055                -2.374719e-03 3 1  ON 54
ci_056                 4.660646e-03 3 1  ON 55
ci_057                 4.675072e-03 3 1  ON 56
ci_058                -2.045339e-03 3 1  ON 57
ci_059                -2.117987e-03 3 1  ON 58
ci_060                 4.733864e-03 3 1  ON 59
ci_061                 5.181303e-03 3 1  ON 60
ci_062                -2.828372e-03 3 1  ON 61
ci_063                -2.781577e-03 3 1  ON 62
ci_064                -2.213784e-03 3 1  ON 63
ci_065                -3.397868e-03 3 1  ON 64
ci_066                 4.063363e-03 3 1  ON 65
ci_067                 4.161131e-03 3 1  ON 66
ci_068                -4.397499e-03 3 1  ON 67
ci_069                -4.114698e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1431
    reference variance = 0.170008
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1340e-01
  Total weights = 1.9577e+06
  Execution time = 1.8325e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297591861072
                                         uncertainty =       0.008276808036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297591861072
                                         uncertainty =       0.008276808036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385683113
  error estimate for blocks of size 2^( 2) =       0.000396693189
  error estimate for blocks of size 2^( 3) =       0.000406169223
  error estimate for blocks of size 2^( 4) =       0.000414153802
  error estimate for blocks of size 2^( 5) =       0.000419893288
  error estimate for blocks of size 2^( 6) =       0.000423581348
  error estimate for blocks of size 2^( 7) =       0.000426262868

      target function =      -0.892092743103
              le_mean =     -17.214155419629
             les_mean =     296.640536537803
             stat err =       0.000420972826
             autocorr =       1.191370600721
   target nu stat err =       0.000420972826
   target dn stat err =       0.008786510933
      target stat err =       0.013078039155
              std dev =       0.545438288983
             le_variance =       0.297502927088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297614579527
                                         uncertainty =       0.008298233165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297614579527
                                         uncertainty =       0.008298233165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385697788
  error estimate for blocks of size 2^( 2) =       0.000396707381
  error estimate for blocks of size 2^( 3) =       0.000406182609
  error estimate for blocks of size 2^( 4) =       0.000414167086
  error estimate for blocks of size 2^( 5) =       0.000419906578
  error estimate for blocks of size 2^( 6) =       0.000423594690
  error estimate for blocks of size 2^( 7) =       0.000426276215

      target function =      -0.892055055758
              le_mean =     -17.214155325446
             les_mean =     296.640558074160
             stat err =       0.000420986142
             autocorr =       1.191355308000
   target nu stat err =       0.000420986142
   target dn stat err =       0.008806962753
      target stat err =       0.013107298330
              std dev =       0.545459042473
             le_variance =       0.297525567015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297603232133
                                         uncertainty =       0.008287532056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297603232133
                                         uncertainty =       0.008287532056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385690458
  error estimate for blocks of size 2^( 2) =       0.000396700292
  error estimate for blocks of size 2^( 3) =       0.000406175923
  error estimate for blocks of size 2^( 4) =       0.000414160451
  error estimate for blocks of size 2^( 5) =       0.000419899940
  error estimate for blocks of size 2^( 6) =       0.000423588026
  error estimate for blocks of size 2^( 7) =       0.000426269548

      target function =      -0.892074250261
              le_mean =     -17.214155372290
             les_mean =     296.640547060941
             stat err =       0.000420979491
             autocorr =       1.191362946126
   target nu stat err =       0.000420979491
   target dn stat err =       0.008796745772
      target stat err =       0.013092692883
              std dev =       0.545448676637
             le_variance =       0.297514258845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297593281769
                                         uncertainty =       0.008278147935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297593281769
                                         uncertainty =       0.008278147935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385684031
  error estimate for blocks of size 2^( 2) =       0.000396694076
  error estimate for blocks of size 2^( 3) =       0.000406170060
  error estimate for blocks of size 2^( 4) =       0.000414154632
  error estimate for blocks of size 2^( 5) =       0.000419894119
  error estimate for blocks of size 2^( 6) =       0.000423582182
  error estimate for blocks of size 2^( 7) =       0.000426263702

      target function =      -0.892090471300
              le_mean =     -17.214155413693
             les_mean =     296.640537825781
             stat err =       0.000420973659
             autocorr =       1.191369644352
   target nu stat err =       0.000420973659
   target dn stat err =       0.008787789493
      target stat err =       0.013079870921
              std dev =       0.545439586824
             le_variance =       0.297504342875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.892092743103        initial  <--
     2.4414e+01     2.4414e+02             7.3154e-06        -0.892055055758
     9.7656e+01     9.7656e+02             1.8328e-06        -0.892074250261
     3.9062e+02     3.9062e+03             4.5844e-07        -0.892090471300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4256
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.181849
====================================================
  Execution time = 1.4463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9737e-01
  Total weights = 1.957619854e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285651348529
                                         uncertainty =       0.001562517980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285651348529
                                         uncertainty =       0.001562517980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377911512
  error estimate for blocks of size 2^( 2) =       0.000389294640
  error estimate for blocks of size 2^( 3) =       0.000399586534
  error estimate for blocks of size 2^( 4) =       0.000406287605
  error estimate for blocks of size 2^( 5) =       0.000409809674
  error estimate for blocks of size 2^( 6) =       0.000412668270
  error estimate for blocks of size 2^( 7) =       0.000415520949

      target function =      -0.916734714199
              le_mean =     -17.214346023633
             les_mean =     296.631077797602
             stat err =       0.000411071624
             autocorr =       1.183190721757
   target nu stat err =       0.000411071624
   target dn stat err =       0.002038922089
      target stat err =       0.003277125768
              std dev =       0.534447585226
             le_variance =       0.285634221354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721434602363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916745521598       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916745653440       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916745668135       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916745673051       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916745673357       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916745673577       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916745673540       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916745673619       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916745673621       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 4.543207e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916745521598       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916745554566       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916745558241       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916745559470       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916745559547       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916745559601       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916745559592       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916745559612       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916745559613       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.136060e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916745521598       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916745529841       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916745530759       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916745531067       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916745531086       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916745531100       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916745531096       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916745531101       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916745531098       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 2.840311e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6992e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875844e-02 3 1  ON 1
ci_003                -2.367628e-02 3 1  ON 2
ci_004                 2.096183e-02 3 1  ON 3
ci_005                 2.155790e-02 3 1  ON 4
ci_006                -1.849848e-02 3 1  ON 5
ci_007                -1.847843e-02 3 1  ON 6
ci_008                -7.758457e-03 3 1  ON 7
ci_009                -1.401876e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143496e-03 3 1  ON 10
ci_012                -9.120798e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103458e-02 3 1  ON 14
ci_016                 1.597501e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080589e-03 3 1  ON 17
ci_019                 8.982483e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259345e-03 3 1  ON 21
ci_023                 8.362198e-03 3 1  ON 22
ci_024                 8.583225e-03 3 1  ON 23
ci_025                 8.594863e-03 3 1  ON 24
ci_026                 1.002869e-02 3 1  ON 25
ci_027                 9.639923e-03 3 1  ON 26
ci_028                -1.462474e-02 3 1  ON 27
ci_029                -1.500986e-02 3 1  ON 28
ci_030                -8.796750e-03 3 1  ON 29
ci_031                -8.563694e-03 3 1  ON 30
ci_032                -1.443946e-02 3 1  ON 31
ci_033                 4.554172e-03 3 1  ON 32
ci_034                 4.916114e-03 3 1  ON 33
ci_035                -3.348281e-03 3 1  ON 34
ci_036                -1.126161e-02 3 1  ON 35
ci_037                -1.150830e-02 3 1  ON 36
ci_038                 9.204269e-04 3 1  ON 37
ci_039                 1.223690e-03 3 1  ON 38
ci_040                -1.603389e-03 3 1  ON 39
ci_041                 8.179735e-03 3 1  ON 40
ci_042                 8.255443e-03 3 1  ON 41
ci_043                -2.385810e-03 3 1  ON 42
ci_044                -3.920764e-03 3 1  ON 43
ci_045                -1.870296e-03 3 1  ON 44
ci_046                 4.771492e-03 3 1  ON 45
ci_047                 4.645520e-03 3 1  ON 46
ci_048                -1.242676e-02 3 1  ON 47
ci_049                -1.288166e-02 3 1  ON 48
ci_050                 2.824185e-03 3 1  ON 49
ci_051                 2.816643e-03 3 1  ON 50
ci_052                -2.275522e-03 3 1  ON 51
ci_053                -2.209132e-03 3 1  ON 52
ci_054                -2.321335e-03 3 1  ON 53
ci_055                -2.374659e-03 3 1  ON 54
ci_056                 4.660695e-03 3 1  ON 55
ci_057                 4.675416e-03 3 1  ON 56
ci_058                -2.045535e-03 3 1  ON 57
ci_059                -2.118350e-03 3 1  ON 58
ci_060                 4.733525e-03 3 1  ON 59
ci_061                 5.181121e-03 3 1  ON 60
ci_062                -2.828323e-03 3 1  ON 61
ci_063                -2.781455e-03 3 1  ON 62
ci_064                -2.213690e-03 3 1  ON 63
ci_065                -3.397952e-03 3 1  ON 64
ci_066                 4.063119e-03 3 1  ON 65
ci_067                 4.160823e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114712e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.221401
====================================================
  Execution time = 1.4231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9950e-01
  Total weights = 1.9576e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175061796
                                         uncertainty =       0.001920123655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175061796
                                         uncertainty =       0.001920123655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378273928
  error estimate for blocks of size 2^( 2) =       0.000389779785
  error estimate for blocks of size 2^( 3) =       0.000400366827
  error estimate for blocks of size 2^( 4) =       0.000407954288
  error estimate for blocks of size 2^( 5) =       0.000413508347
  error estimate for blocks of size 2^( 6) =       0.000417565587
  error estimate for blocks of size 2^( 7) =       0.000418871786

      target function =      -0.913345464763
              le_mean =     -17.215425480623
             les_mean =     296.670378331702
             stat err =       0.000414475002
             autocorr =       1.200559988290
   target nu stat err =       0.000414475002
   target dn stat err =       0.002655326555
      target stat err =       0.004205988944
              std dev =       0.534960119413
             le_variance =       0.286182329363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286174974634
                                         uncertainty =       0.001920107697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286174974634
                                         uncertainty =       0.001920107697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378273871
  error estimate for blocks of size 2^( 2) =       0.000389779753
  error estimate for blocks of size 2^( 3) =       0.000400366820
  error estimate for blocks of size 2^( 4) =       0.000407954305
  error estimate for blocks of size 2^( 5) =       0.000413508375
  error estimate for blocks of size 2^( 6) =       0.000417565632
  error estimate for blocks of size 2^( 7) =       0.000418871841

      target function =      -0.913345009381
              le_mean =     -17.215425477982
             les_mean =     296.670378532587
             stat err =       0.000414475038
             autocorr =       1.200560566580
   target nu stat err =       0.000414475038
   target dn stat err =       0.002655320177
      target stat err =       0.004205974984
              std dev =       0.534960038088
             le_variance =       0.286182242351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175018195
                                         uncertainty =       0.001920115674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175018195
                                         uncertainty =       0.001920115674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378273899
  error estimate for blocks of size 2^( 2) =       0.000389779769
  error estimate for blocks of size 2^( 3) =       0.000400366824
  error estimate for blocks of size 2^( 4) =       0.000407954296
  error estimate for blocks of size 2^( 5) =       0.000413508361
  error estimate for blocks of size 2^( 6) =       0.000417565609
  error estimate for blocks of size 2^( 7) =       0.000418871813

      target function =      -0.913345238530
              le_mean =     -17.215425479301
             les_mean =     296.670378431148
             stat err =       0.000414475020
             autocorr =       1.200560277512
   target nu stat err =       0.000414475020
   target dn stat err =       0.002655323352
      target stat err =       0.004205981955
              std dev =       0.534960078732
             le_variance =       0.286182285837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175056344
                                         uncertainty =       0.001920122657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286175056344
                                         uncertainty =       0.001920122657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378273925
  error estimate for blocks of size 2^( 2) =       0.000389779783
  error estimate for blocks of size 2^( 3) =       0.000400366827
  error estimate for blocks of size 2^( 4) =       0.000407954289
  error estimate for blocks of size 2^( 5) =       0.000413508348
  error estimate for blocks of size 2^( 6) =       0.000417565589
  error estimate for blocks of size 2^( 7) =       0.000418871789

      target function =      -0.913345436647
              le_mean =     -17.215425480458
             les_mean =     296.670378344022
             stat err =       0.000414475004
             autocorr =       1.200560024454
   target nu stat err =       0.000414475004
   target dn stat err =       0.002655326153
      target stat err =       0.004205988070
              std dev =       0.534960114326
             le_variance =       0.286182323920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913345464763        initial  <--
     2.4414e+02     2.4414e+03             4.5432e-07        -0.913345009381
     9.7656e+02     9.7656e+03             1.1361e-07        -0.913345238530
     3.9062e+03     3.9062e+04             2.8403e-08        -0.913345436647

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6038
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.167817
====================================================
  Execution time = 1.4619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0077e-01
  Total weights = 1.957580640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287731510597
                                         uncertainty =       0.001845116014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287731510597
                                         uncertainty =       0.001845116014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379280029
  error estimate for blocks of size 2^( 2) =       0.000390629760
  error estimate for blocks of size 2^( 3) =       0.000400984272
  error estimate for blocks of size 2^( 4) =       0.000408478474
  error estimate for blocks of size 2^( 5) =       0.000413170414
  error estimate for blocks of size 2^( 6) =       0.000414996917
  error estimate for blocks of size 2^( 7) =       0.000416478710

      target function =      -0.911449395275
              le_mean =     -17.213702986677
             les_mean =     296.612336523000
             stat err =       0.000413281129
             autocorr =       1.187329336562
   target nu stat err =       0.000413281129
   target dn stat err =       0.002770638908
      target stat err =       0.004351269075
              std dev =       0.536382961289
             le_variance =       0.287706681161


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721370298668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911469110453       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911469137280       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911469140534       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911469141170       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911469141054       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911469141092       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911469141084       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911469141087       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911469141089       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911469141091       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 7.758035e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911469110453       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911469117160       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911469117974       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911469118133       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911469118103       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911469118113       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911469118121       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911469118107       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911469118104       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911469118113       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 1.939554e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911469110453       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911469112130       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911469112333       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911469112374       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911469112375       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911469112368       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911469112415       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911469112481       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911469112368       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911469112431       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 4.848912e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7136e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875847e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758489e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873672e-03 3 1  ON 9
ci_011                -9.143513e-03 3 1  ON 10
ci_012                -9.120845e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080583e-03 3 1  ON 17
ci_019                 8.982500e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519178e-02 3 1  ON 20
ci_022                 8.259334e-03 3 1  ON 21
ci_023                 8.362256e-03 3 1  ON 22
ci_024                 8.583321e-03 3 1  ON 23
ci_025                 8.594829e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639941e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796773e-03 3 1  ON 29
ci_031                -8.563702e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554125e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348259e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204455e-04 3 1  ON 37
ci_039                 1.223719e-03 3 1  ON 38
ci_040                -1.603331e-03 3 1  ON 39
ci_041                 8.179798e-03 3 1  ON 40
ci_042                 8.255422e-03 3 1  ON 41
ci_043                -2.385824e-03 3 1  ON 42
ci_044                -3.920808e-03 3 1  ON 43
ci_045                -1.870339e-03 3 1  ON 44
ci_046                 4.771533e-03 3 1  ON 45
ci_047                 4.645593e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824149e-03 3 1  ON 49
ci_051                 2.816599e-03 3 1  ON 50
ci_052                -2.275523e-03 3 1  ON 51
ci_053                -2.209121e-03 3 1  ON 52
ci_054                -2.321356e-03 3 1  ON 53
ci_055                -2.374652e-03 3 1  ON 54
ci_056                 4.660674e-03 3 1  ON 55
ci_057                 4.675422e-03 3 1  ON 56
ci_058                -2.045441e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733444e-03 3 1  ON 59
ci_061                 5.181149e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781462e-03 3 1  ON 62
ci_064                -2.213661e-03 3 1  ON 63
ci_065                -3.397978e-03 3 1  ON 64
ci_066                 4.063108e-03 3 1  ON 65
ci_067                 4.160840e-03 3 1  ON 66
ci_068                -4.398034e-03 3 1  ON 67
ci_069                -4.114760e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2585
    reference variance = 0.15133
====================================================
  Execution time = 1.5155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9716e-01
  Total weights = 1.9575e+06
  Execution time = 2.3811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938018691
                                         uncertainty =       0.001437385033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938018691
                                         uncertainty =       0.001437385033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377416161
  error estimate for blocks of size 2^( 2) =       0.000389061026
  error estimate for blocks of size 2^( 3) =       0.000398899310
  error estimate for blocks of size 2^( 4) =       0.000406949774
  error estimate for blocks of size 2^( 5) =       0.000411174098
  error estimate for blocks of size 2^( 6) =       0.000412748316
  error estimate for blocks of size 2^( 7) =       0.000414732143

      target function =      -0.917041502475
              le_mean =     -17.214770680361
             les_mean =     296.645494240192
             stat err =       0.000411401083
             autocorr =       1.188200891766
   target nu stat err =       0.000411401083
   target dn stat err =       0.002066924274
      target stat err =       0.003325000924
              std dev =       0.533747054074
             le_variance =       0.284885917732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938011925
                                         uncertainty =       0.001437384823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938011925
                                         uncertainty =       0.001437384823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377416157
  error estimate for blocks of size 2^( 2) =       0.000389061028
  error estimate for blocks of size 2^( 3) =       0.000398899318
  error estimate for blocks of size 2^( 4) =       0.000406949788
  error estimate for blocks of size 2^( 5) =       0.000411174114
  error estimate for blocks of size 2^( 6) =       0.000412748333
  error estimate for blocks of size 2^( 7) =       0.000414732161

      target function =      -0.917041255678
              le_mean =     -17.214770680725
             les_mean =     296.645494409683
             stat err =       0.000411401099
             autocorr =       1.188201014766
   target nu stat err =       0.000411401099
   target dn stat err =       0.002066924782
      target stat err =       0.003324999963
              std dev =       0.533747047718
             le_variance =       0.284885910948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938015308
                                         uncertainty =       0.001437384928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938015308
                                         uncertainty =       0.001437384928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377416159
  error estimate for blocks of size 2^( 2) =       0.000389061027
  error estimate for blocks of size 2^( 3) =       0.000398899314
  error estimate for blocks of size 2^( 4) =       0.000406949781
  error estimate for blocks of size 2^( 5) =       0.000411174106
  error estimate for blocks of size 2^( 6) =       0.000412748325
  error estimate for blocks of size 2^( 7) =       0.000414732152

      target function =      -0.917041380101
              le_mean =     -17.214770680543
             les_mean =     296.645494324285
             stat err =       0.000411401091
             autocorr =       1.188200953270
   target nu stat err =       0.000411401091
   target dn stat err =       0.002066924525
      target stat err =       0.003325000447
              std dev =       0.533747050896
             le_variance =       0.284885914340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938018268
                                         uncertainty =       0.001437385020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284938018268
                                         uncertainty =       0.001437385020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377416161
  error estimate for blocks of size 2^( 2) =       0.000389061026
  error estimate for blocks of size 2^( 3) =       0.000398899310
  error estimate for blocks of size 2^( 4) =       0.000406949774
  error estimate for blocks of size 2^( 5) =       0.000411174099
  error estimate for blocks of size 2^( 6) =       0.000412748317
  error estimate for blocks of size 2^( 7) =       0.000414732144

      target function =      -0.917041487289
              le_mean =     -17.214770680384
             les_mean =     296.645494250634
             stat err =       0.000411401084
             autocorr =       1.188200899450
   target nu stat err =       0.000411401084
   target dn stat err =       0.002066924305
      target stat err =       0.003325000864
              std dev =       0.533747053676
             le_variance =       0.284885917308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917041502475        initial  <--
     2.4414e+03     2.4414e+04             7.7580e-08        -0.917041255678
     9.7656e+03     9.7656e+04             1.9396e-08        -0.917041380101
     3.9062e+04     3.9062e+05             4.8489e-09        -0.917041487289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.9794
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120859e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554120e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348263e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204494e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824147e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275530e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118456e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181146e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.250826
====================================================
  Execution time = 1.4737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0166e-01
  Total weights = 1.957386915e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288534923335
                                         uncertainty =       0.002160578483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288534923335
                                         uncertainty =       0.002160578483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379842291
  error estimate for blocks of size 2^( 2) =       0.000390933705
  error estimate for blocks of size 2^( 3) =       0.000401363549
  error estimate for blocks of size 2^( 4) =       0.000408475032
  error estimate for blocks of size 2^( 5) =       0.000414698824
  error estimate for blocks of size 2^( 6) =       0.000417154453
  error estimate for blocks of size 2^( 7) =       0.000420391268

      target function =      -0.910019112359
              le_mean =     -17.214585269445
             les_mean =     296.643607452950
             stat err =       0.000415179894
             autocorr =       1.194719612059
   target nu stat err =       0.000415179894
   target dn stat err =       0.003201705060
      target stat err =       0.005004924852
              std dev =       0.537178120172
             le_variance =       0.288560332791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721458526944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910045605730       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910045606794       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910045606961       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910045607007       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910045606995       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910045607017       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910045607015       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910045607013       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910045607045       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910045607034       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 3.354576e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910045605730       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910045605996       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910045606038       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910045606049       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910045606078       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910045606040       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910045606024       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910045606411       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910045606105       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910045606089       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 8.386457e-10

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910045605730       residual = 7.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910045605796       residual = 6.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910045605807       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910045605809       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910045605375       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910045605922       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910045606133       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910045605393       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910045605661       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910045605753       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 2.096615e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7246e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873667e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120858e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982499e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583322e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639936e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796772e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554119e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348262e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204487e-04 3 1  ON 37
ci_039                 1.223718e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816612e-03 3 1  ON 50
ci_052                -2.275531e-03 3 1  ON 51
ci_053                -2.209123e-03 3 1  ON 52
ci_054                -2.321354e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660670e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118455e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181145e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397981e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160839e-03 3 1  ON 66
ci_068                -4.398036e-03 3 1  ON 67
ci_069                -4.114758e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1291
    reference variance = 0.169796
====================================================
  Execution time = 1.4366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9262e-01
  Total weights = 1.9581e+06
  Execution time = 1.8267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236828
                                         uncertainty =       0.001661555244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236828
                                         uncertainty =       0.001661555244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375105319
  error estimate for blocks of size 2^( 2) =       0.000386877951
  error estimate for blocks of size 2^( 3) =       0.000397315528
  error estimate for blocks of size 2^( 4) =       0.000404230732
  error estimate for blocks of size 2^( 5) =       0.000409349753
  error estimate for blocks of size 2^( 6) =       0.000410714062
  error estimate for blocks of size 2^( 7) =       0.000413335194

      target function =      -0.924260523701
              le_mean =     -17.214056167723
             les_mean =     296.616346942803
             stat err =       0.000409407435
             autocorr =       1.191255736912
   target nu stat err =       0.000409407435
   target dn stat err =       0.001956326170
      target stat err =       0.003198893396
              std dev =       0.530479030006
             le_variance =       0.281408001276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236620
                                         uncertainty =       0.001661555248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236620
                                         uncertainty =       0.001661555248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375105319
  error estimate for blocks of size 2^( 2) =       0.000386877951
  error estimate for blocks of size 2^( 3) =       0.000397315528
  error estimate for blocks of size 2^( 4) =       0.000404230732
  error estimate for blocks of size 2^( 5) =       0.000409349753
  error estimate for blocks of size 2^( 6) =       0.000410714063
  error estimate for blocks of size 2^( 7) =       0.000413335195

      target function =      -0.924260566594
              le_mean =     -17.214056167819
             les_mean =     296.616346919222
             stat err =       0.000409407436
             autocorr =       1.191255742484
   target nu stat err =       0.000409407436
   target dn stat err =       0.001956325271
      target stat err =       0.003198892289
              std dev =       0.530479029810
             le_variance =       0.281408001068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236724
                                         uncertainty =       0.001661555246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236724
                                         uncertainty =       0.001661555246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375105319
  error estimate for blocks of size 2^( 2) =       0.000386877951
  error estimate for blocks of size 2^( 3) =       0.000397315528
  error estimate for blocks of size 2^( 4) =       0.000404230732
  error estimate for blocks of size 2^( 5) =       0.000409349753
  error estimate for blocks of size 2^( 6) =       0.000410714063
  error estimate for blocks of size 2^( 7) =       0.000413335195

      target function =      -0.924260545153
              le_mean =     -17.214056167771
             les_mean =     296.616346931010
             stat err =       0.000409407436
             autocorr =       1.191255739702
   target nu stat err =       0.000409407436
   target dn stat err =       0.001956325720
      target stat err =       0.003198892842
              std dev =       0.530479029908
             le_variance =       0.281408001172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236815
                                         uncertainty =       0.001661555244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281456236815
                                         uncertainty =       0.001661555244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375105319
  error estimate for blocks of size 2^( 2) =       0.000386877951
  error estimate for blocks of size 2^( 3) =       0.000397315528
  error estimate for blocks of size 2^( 4) =       0.000404230732
  error estimate for blocks of size 2^( 5) =       0.000409349753
  error estimate for blocks of size 2^( 6) =       0.000410714062
  error estimate for blocks of size 2^( 7) =       0.000413335194

      target function =      -0.924260526383
              le_mean =     -17.214056167729
             les_mean =     296.616346941329
             stat err =       0.000409407435
             autocorr =       1.191255737263
   target nu stat err =       0.000409407435
   target dn stat err =       0.001956326113
      target stat err =       0.003198893326
              std dev =       0.530479029993
             le_variance =       0.281408001263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.924260523701        initial
     2.4414e+04     2.4414e+05             3.3546e-09        -0.924260566594  <--
     9.7656e+04     9.7656e+05             8.3865e-10        -0.924260545153
     3.9062e+05     3.9062e+06             2.0966e-10        -0.924260526383

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 2.3604e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758499e-03 3 1  ON 7
ci_009                -1.401887e-02 3 1  ON 8
ci_010                -8.873666e-03 3 1  ON 9
ci_011                -9.143521e-03 3 1  ON 10
ci_012                -9.120857e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080592e-03 3 1  ON 17
ci_019                 8.982500e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259336e-03 3 1  ON 21
ci_023                 8.362265e-03 3 1  ON 22
ci_024                 8.583320e-03 3 1  ON 23
ci_025                 8.594834e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639934e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796774e-03 3 1  ON 29
ci_031                -8.563705e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554117e-03 3 1  ON 32
ci_034                 4.916125e-03 3 1  ON 33
ci_035                -3.348261e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223716e-03 3 1  ON 38
ci_040                -1.603336e-03 3 1  ON 39
ci_041                 8.179809e-03 3 1  ON 40
ci_042                 8.255429e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920808e-03 3 1  ON 43
ci_045                -1.870342e-03 3 1  ON 44
ci_046                 4.771534e-03 3 1  ON 45
ci_047                 4.645589e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824145e-03 3 1  ON 49
ci_051                 2.816611e-03 3 1  ON 50
ci_052                -2.275532e-03 3 1  ON 51
ci_053                -2.209125e-03 3 1  ON 52
ci_054                -2.321353e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660669e-03 3 1  ON 55
ci_057                 4.675422e-03 3 1  ON 56
ci_058                -2.045438e-03 3 1  ON 57
ci_059                -2.118453e-03 3 1  ON 58
ci_060                 4.733448e-03 3 1  ON 59
ci_061                 5.181142e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213663e-03 3 1  ON 63
ci_065                -3.397980e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160838e-03 3 1  ON 66
ci_068                -4.398035e-03 3 1  ON 67
ci_069                -4.114759e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0859e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2047
    reference variance = 0.18647
====================================================
  Execution time = 1.4870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0236e-01
  Total weights = 1.957889580e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289384786638
                                         uncertainty =       0.001820794978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289384786638
                                         uncertainty =       0.001820794978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380442473
  error estimate for blocks of size 2^( 2) =       0.000391694132
  error estimate for blocks of size 2^( 3) =       0.000402258033
  error estimate for blocks of size 2^( 4) =       0.000410043003
  error estimate for blocks of size 2^( 5) =       0.000414360185
  error estimate for blocks of size 2^( 6) =       0.000416476053
  error estimate for blocks of size 2^( 7) =       0.000418769730

      target function =      -0.908977864968
              le_mean =     -17.213962998436
             les_mean =     296.622881562672
             stat err =       0.000414912243
             autocorr =       1.189418001949
   target nu stat err =       0.000414912243
   target dn stat err =       0.002578926883
      target stat err =       0.004039102035
              std dev =       0.538026904818
             le_variance =       0.289472950308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721396299844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908994733691       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908994737574       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908994738194       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908994738318       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908994738353       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908994738363       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908994738367       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908994738367       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908994738367       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 1.707694e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908994733691       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908994734662       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908994734816       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908994734872       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908994734856       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908994734895       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908994734860       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908994734860       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908994734860       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 4.269268e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908994733691       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908994733933       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908994733972       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908994734023       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908994733982       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908994733983       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908994734006       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908994733857       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908994734052       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 1.067319e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7402e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -3.762733e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096186e-02 3 1  ON 3
ci_005                 2.155788e-02 3 1  ON 4
ci_006                -1.849851e-02 3 1  ON 5
ci_007                -1.847840e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873664e-03 3 1  ON 9
ci_011                -9.143518e-03 3 1  ON 10
ci_012                -9.120856e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103455e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982498e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519177e-02 3 1  ON 20
ci_022                 8.259337e-03 3 1  ON 21
ci_023                 8.362261e-03 3 1  ON 22
ci_024                 8.583319e-03 3 1  ON 23
ci_025                 8.594829e-03 3 1  ON 24
ci_026                 1.002875e-02 3 1  ON 25
ci_027                 9.639935e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.796775e-03 3 1  ON 29
ci_031                -8.563704e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554119e-03 3 1  ON 32
ci_034                 4.916122e-03 3 1  ON 33
ci_035                -3.348260e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223715e-03 3 1  ON 38
ci_040                -1.603334e-03 3 1  ON 39
ci_041                 8.179809e-03 3 1  ON 40
ci_042                 8.255429e-03 3 1  ON 41
ci_043                -2.385826e-03 3 1  ON 42
ci_044                -3.920808e-03 3 1  ON 43
ci_045                -1.870344e-03 3 1  ON 44
ci_046                 4.771533e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824145e-03 3 1  ON 49
ci_051                 2.816611e-03 3 1  ON 50
ci_052                -2.275531e-03 3 1  ON 51
ci_053                -2.209124e-03 3 1  ON 52
ci_054                -2.321353e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660669e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118452e-03 3 1  ON 58
ci_060                 4.733449e-03 3 1  ON 59
ci_061                 5.181145e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397980e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160837e-03 3 1  ON 66
ci_068                -4.398039e-03 3 1  ON 67
ci_069                -4.114759e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.170853
====================================================
  Execution time = 1.4273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0297e-01
  Total weights = 1.9577e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826477185
                                         uncertainty =       0.001790633811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826477185
                                         uncertainty =       0.001790633811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332822
  error estimate for blocks of size 2^( 2) =       0.000390846354
  error estimate for blocks of size 2^( 3) =       0.000401287643
  error estimate for blocks of size 2^( 4) =       0.000409220364
  error estimate for blocks of size 2^( 5) =       0.000412865788
  error estimate for blocks of size 2^( 6) =       0.000414747166
  error estimate for blocks of size 2^( 7) =       0.000416334922

      target function =      -0.907992078774
              le_mean =     -17.214824058316
             les_mean =     296.653134122318
             stat err =       0.000413292060
             autocorr =       1.187061663457
   target nu stat err =       0.000413292060
   target dn stat err =       0.003200048667
      target stat err =       0.004982119116
              std dev =       0.536457621676
             le_variance =       0.287786779854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826473011
                                         uncertainty =       0.001790633567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826473011
                                         uncertainty =       0.001790633567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332819
  error estimate for blocks of size 2^( 2) =       0.000390846352
  error estimate for blocks of size 2^( 3) =       0.000401287642
  error estimate for blocks of size 2^( 4) =       0.000409220365
  error estimate for blocks of size 2^( 5) =       0.000412865790
  error estimate for blocks of size 2^( 6) =       0.000414747168
  error estimate for blocks of size 2^( 7) =       0.000416334923

      target function =      -0.907992091724
              le_mean =     -17.214824058347
             les_mean =     296.653134115003
             stat err =       0.000413292061
             autocorr =       1.187061688238
   target nu stat err =       0.000413292061
   target dn stat err =       0.003200045045
      target stat err =       0.004982113731
              std dev =       0.536457617776
             le_variance =       0.287786775670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826475098
                                         uncertainty =       0.001790633689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826475098
                                         uncertainty =       0.001790633689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332821
  error estimate for blocks of size 2^( 2) =       0.000390846353
  error estimate for blocks of size 2^( 3) =       0.000401287642
  error estimate for blocks of size 2^( 4) =       0.000409220364
  error estimate for blocks of size 2^( 5) =       0.000412865789
  error estimate for blocks of size 2^( 6) =       0.000414747167
  error estimate for blocks of size 2^( 7) =       0.000416334922

      target function =      -0.907992085267
              le_mean =     -17.214824058331
             les_mean =     296.653134118649
             stat err =       0.000413292061
             autocorr =       1.187061675854
   target nu stat err =       0.000413292061
   target dn stat err =       0.003200046856
      target stat err =       0.004982116423
              std dev =       0.536457619726
             le_variance =       0.287786777762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826476924
                                         uncertainty =       0.001790633796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287826476924
                                         uncertainty =       0.001790633796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379332822
  error estimate for blocks of size 2^( 2) =       0.000390846354
  error estimate for blocks of size 2^( 3) =       0.000401287643
  error estimate for blocks of size 2^( 4) =       0.000409220364
  error estimate for blocks of size 2^( 5) =       0.000412865788
  error estimate for blocks of size 2^( 6) =       0.000414747166
  error estimate for blocks of size 2^( 7) =       0.000416334922

      target function =      -0.907992079588
              le_mean =     -17.214824058318
             les_mean =     296.653134121858
             stat err =       0.000413292060
             autocorr =       1.187061665010
   target nu stat err =       0.000413292060
   target dn stat err =       0.003200048440
      target stat err =       0.004982118779
              std dev =       0.536457621432
             le_variance =       0.287786779593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907992078774        initial
     6.1035e+03     6.1035e+04             1.7077e-08        -0.907992091724  <--
     2.4414e+04     2.4414e+05             4.2693e-09        -0.907992085267
     9.7656e+04     9.7656e+05             1.0673e-09        -0.907992079588

*****************************************************************************
Applying the update for shift_i =   6.1035e+03     and shift_s =   6.1035e+04
*****************************************************************************

  Execution time = 2.3524e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.155318
====================================================
  Execution time = 1.4774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0203e-01
  Total weights = 1.957471150e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289078893418
                                         uncertainty =       0.001605316781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289078893418
                                         uncertainty =       0.001605316781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380176979
  error estimate for blocks of size 2^( 2) =       0.000391559497
  error estimate for blocks of size 2^( 3) =       0.000402209967
  error estimate for blocks of size 2^( 4) =       0.000410110423
  error estimate for blocks of size 2^( 5) =       0.000414288176
  error estimate for blocks of size 2^( 6) =       0.000416412898
  error estimate for blocks of size 2^( 7) =       0.000416535196

      target function =      -0.909465109916
              le_mean =     -17.214411052326
             les_mean =     296.637981432248
             stat err =       0.000414336673
             autocorr =       1.187777565962
   target nu stat err =       0.000414336673
   target dn stat err =       0.002251223583
      target stat err =       0.003549022694
              std dev =       0.537651440026
             le_variance =       0.289069070962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721441105233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909477934764       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909477962992       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909477966163       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909477968208       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909477968411       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909477968325       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909477968307       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909477968315       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909477968321       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909477968318       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 8.997374e-08

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909477934764       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909477941822       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909477942614       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909477943125       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909477943177       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909477943154       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909477943151       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909477943160       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909477943152       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909477943152       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 2.249422e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909477934764       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909477936529       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909477936727       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909477936855       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909477936865       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909477936831       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909477936845       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909477936878       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909477936857       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909477936851       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 5.623604e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161072 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7247e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875845e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155785e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847838e-02 3 1  ON 6
ci_008                -7.758486e-03 3 1  ON 7
ci_009                -1.401885e-02 3 1  ON 8
ci_010                -8.873649e-03 3 1  ON 9
ci_011                -9.143498e-03 3 1  ON 10
ci_012                -9.120832e-03 3 1  ON 11
ci_013                -1.923606e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597495e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080595e-03 3 1  ON 17
ci_019                 8.982474e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259346e-03 3 1  ON 21
ci_023                 8.362242e-03 3 1  ON 22
ci_024                 8.583319e-03 3 1  ON 23
ci_025                 8.594799e-03 3 1  ON 24
ci_026                 1.002873e-02 3 1  ON 25
ci_027                 9.639922e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.796776e-03 3 1  ON 29
ci_031                -8.563697e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554125e-03 3 1  ON 32
ci_034                 4.916111e-03 3 1  ON 33
ci_035                -3.348255e-03 3 1  ON 34
ci_036                -1.126158e-02 3 1  ON 35
ci_037                -1.150832e-02 3 1  ON 36
ci_038                 9.204441e-04 3 1  ON 37
ci_039                 1.223708e-03 3 1  ON 38
ci_040                -1.603325e-03 3 1  ON 39
ci_041                 8.179813e-03 3 1  ON 40
ci_042                 8.255423e-03 3 1  ON 41
ci_043                -2.385823e-03 3 1  ON 42
ci_044                -3.920806e-03 3 1  ON 43
ci_045                -1.870352e-03 3 1  ON 44
ci_046                 4.771526e-03 3 1  ON 45
ci_047                 4.645590e-03 3 1  ON 46
ci_048                -1.242676e-02 3 1  ON 47
ci_049                -1.288171e-02 3 1  ON 48
ci_050                 2.824150e-03 3 1  ON 49
ci_051                 2.816598e-03 3 1  ON 50
ci_052                -2.275515e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321346e-03 3 1  ON 53
ci_055                -2.374642e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675434e-03 3 1  ON 56
ci_058                -2.045429e-03 3 1  ON 57
ci_059                -2.118443e-03 3 1  ON 58
ci_060                 4.733456e-03 3 1  ON 59
ci_061                 5.181143e-03 3 1  ON 60
ci_062                -2.828325e-03 3 1  ON 61
ci_063                -2.781468e-03 3 1  ON 62
ci_064                -2.213662e-03 3 1  ON 63
ci_065                -3.397984e-03 3 1  ON 64
ci_066                 4.063110e-03 3 1  ON 65
ci_067                 4.160833e-03 3 1  ON 66
ci_068                -4.398045e-03 3 1  ON 67
ci_069                -4.114766e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1054
    reference variance = 0.244014
====================================================
  Execution time = 1.4207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0071e-01
  Total weights = 1.9578e+06
  Execution time = 1.8309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876106063
                                         uncertainty =       0.001655075207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876106063
                                         uncertainty =       0.001655075207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378706804
  error estimate for blocks of size 2^( 2) =       0.000389946762
  error estimate for blocks of size 2^( 3) =       0.000400473456
  error estimate for blocks of size 2^( 4) =       0.000407659796
  error estimate for blocks of size 2^( 5) =       0.000412631288
  error estimate for blocks of size 2^( 6) =       0.000413998664
  error estimate for blocks of size 2^( 7) =       0.000416100042

      target function =      -0.911467312204
              le_mean =     -17.215321106743
             les_mean =     296.667993762013
             stat err =       0.000412597447
             autocorr =       1.186989447974
   target nu stat err =       0.000412597447
   target dn stat err =       0.002562330440
      target stat err =       0.004045146220
              std dev =       0.535572298082
             le_variance =       0.286837686473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876095277
                                         uncertainty =       0.001655074230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876095277
                                         uncertainty =       0.001655074230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378706797
  error estimate for blocks of size 2^( 2) =       0.000389946762
  error estimate for blocks of size 2^( 3) =       0.000400473465
  error estimate for blocks of size 2^( 4) =       0.000407659812
  error estimate for blocks of size 2^( 5) =       0.000412631308
  error estimate for blocks of size 2^( 6) =       0.000413998690
  error estimate for blocks of size 2^( 7) =       0.000416100076

      target function =      -0.911466878207
              le_mean =     -17.215321106981
             les_mean =     296.667994049312
             stat err =       0.000412597472
             autocorr =       1.186989633596
   target nu stat err =       0.000412597472
   target dn stat err =       0.002562339390
      target stat err =       0.004045156138
              std dev =       0.535572287973
             le_variance =       0.286837675644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876100669
                                         uncertainty =       0.001655074718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876100669
                                         uncertainty =       0.001655074718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378706800
  error estimate for blocks of size 2^( 2) =       0.000389946762
  error estimate for blocks of size 2^( 3) =       0.000400473461
  error estimate for blocks of size 2^( 4) =       0.000407659804
  error estimate for blocks of size 2^( 5) =       0.000412631298
  error estimate for blocks of size 2^( 6) =       0.000413998677
  error estimate for blocks of size 2^( 7) =       0.000416100059

      target function =      -0.911467095421
              le_mean =     -17.215321106862
             les_mean =     296.667993905522
             stat err =       0.000412597460
             autocorr =       1.186989540785
   target nu stat err =       0.000412597460
   target dn stat err =       0.002562334913
      target stat err =       0.004045151178
              std dev =       0.535572293027
             le_variance =       0.286837681058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876105389
                                         uncertainty =       0.001655075146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876105389
                                         uncertainty =       0.001655075146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378706803
  error estimate for blocks of size 2^( 2) =       0.000389946762
  error estimate for blocks of size 2^( 3) =       0.000400473457
  error estimate for blocks of size 2^( 4) =       0.000407659797
  error estimate for blocks of size 2^( 5) =       0.000412631289
  error estimate for blocks of size 2^( 6) =       0.000413998665
  error estimate for blocks of size 2^( 7) =       0.000416100044

      target function =      -0.911467285130
              le_mean =     -17.215321106758
             les_mean =     296.667993779936
             stat err =       0.000412597449
             autocorr =       1.186989459579
   target nu stat err =       0.000412597449
   target dn stat err =       0.002562330998
      target stat err =       0.004045146839
              std dev =       0.535572297451
             le_variance =       0.286837685796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911467312204        initial  <--
     1.5259e+03     1.5259e+04             8.9974e-08        -0.911466878207
     6.1035e+03     6.1035e+04             2.2494e-08        -0.911467095421
     2.4414e+04     2.4414e+05             5.6236e-09        -0.911467285130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4581
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.245303
====================================================
  Execution time = 1.4733e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0457e-01
  Total weights = 1.957839792e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289233185935
                                         uncertainty =       0.003450660172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289233185935
                                         uncertainty =       0.003450660172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380258245
  error estimate for blocks of size 2^( 2) =       0.000391769265
  error estimate for blocks of size 2^( 3) =       0.000402357044
  error estimate for blocks of size 2^( 4) =       0.000410570403
  error estimate for blocks of size 2^( 5) =       0.000414736432
  error estimate for blocks of size 2^( 6) =       0.000417692509
  error estimate for blocks of size 2^( 7) =       0.000418517800

      target function =      -0.905495346126
              le_mean =     -17.214714014338
             les_mean =     296.650952642564
             stat err =       0.000415379286
             autocorr =       1.193252604449
   target nu stat err =       0.000415379286
   target dn stat err =       0.004752984023
      target stat err =       0.007318499611
              std dev =       0.537766367489
             le_variance =       0.289192666002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471401434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905553497022       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905553502875       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905553503634       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905553503816       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905553503849       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905553503844       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905553503848       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905553503840       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905553503859       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905553503861       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.137096e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905553497022       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905553498485       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905553498675       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905553498719       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905553498897       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905553498836       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905553498755       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905553498744       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905553498699       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905553498641       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 2.842749e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905553497022       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905553497388       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905553497435       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905553497434       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905553497588       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905553497229       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905553497945       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905553497075       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905553497516       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905553497324       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 7.106880e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164446 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7266e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758501e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873656e-03 3 1  ON 9
ci_011                -9.143507e-03 3 1  ON 10
ci_012                -9.120853e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080598e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259343e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594817e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796776e-03 3 1  ON 29
ci_031                -8.563699e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916113e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204471e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603330e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255428e-03 3 1  ON 41
ci_043                -2.385827e-03 3 1  ON 42
ci_044                -3.920809e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771528e-03 3 1  ON 45
ci_047                 4.645587e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824144e-03 3 1  ON 49
ci_051                 2.816607e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209120e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660668e-03 3 1  ON 55
ci_057                 4.675425e-03 3 1  ON 56
ci_058                -2.045436e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733452e-03 3 1  ON 59
ci_061                 5.181151e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781458e-03 3 1  ON 62
ci_064                -2.213659e-03 3 1  ON 63
ci_065                -3.397980e-03 3 1  ON 64
ci_066                 4.063104e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114755e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2679
    reference variance = 0.151793
====================================================
  Execution time = 1.4309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0032e-01
  Total weights = 1.9579e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915923
                                         uncertainty =       0.001928769047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915923
                                         uncertainty =       0.001928769047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379657526
  error estimate for blocks of size 2^( 2) =       0.000391121889
  error estimate for blocks of size 2^( 3) =       0.000401157864
  error estimate for blocks of size 2^( 4) =       0.000408492959
  error estimate for blocks of size 2^( 5) =       0.000413341894
  error estimate for blocks of size 2^( 6) =       0.000414765714
  error estimate for blocks of size 2^( 7) =       0.000417763748

      target function =      -0.912093143709
              le_mean =     -17.215042556021
             les_mean =     296.658010826457
             stat err =       0.000413591079
             autocorr =       1.186747425522
   target nu stat err =       0.000413591079
   target dn stat err =       0.002275075338
      target stat err =       0.003609514135
              std dev =       0.536916822160
             le_variance =       0.288279673918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285914209
                                         uncertainty =       0.001928768602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285914209
                                         uncertainty =       0.001928768602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379657525
  error estimate for blocks of size 2^( 2) =       0.000391121888
  error estimate for blocks of size 2^( 3) =       0.000401157864
  error estimate for blocks of size 2^( 4) =       0.000408492960
  error estimate for blocks of size 2^( 5) =       0.000413341895
  error estimate for blocks of size 2^( 6) =       0.000414765715
  error estimate for blocks of size 2^( 7) =       0.000417763750

      target function =      -0.912093103040
              le_mean =     -17.215042556065
             les_mean =     296.658010854137
             stat err =       0.000413591080
             autocorr =       1.186747440120
   target nu stat err =       0.000413591080
   target dn stat err =       0.002275075046
      target stat err =       0.003609513374
              std dev =       0.536916820559
             le_variance =       0.288279672199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915066
                                         uncertainty =       0.001928768824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915066
                                         uncertainty =       0.001928768824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379657525
  error estimate for blocks of size 2^( 2) =       0.000391121888
  error estimate for blocks of size 2^( 3) =       0.000401157864
  error estimate for blocks of size 2^( 4) =       0.000408492960
  error estimate for blocks of size 2^( 5) =       0.000413341895
  error estimate for blocks of size 2^( 6) =       0.000414765714
  error estimate for blocks of size 2^( 7) =       0.000417763749

      target function =      -0.912093123389
              le_mean =     -17.215042556043
             les_mean =     296.658010840288
             stat err =       0.000413591079
             autocorr =       1.186747432820
   target nu stat err =       0.000413591079
   target dn stat err =       0.002275075192
      target stat err =       0.003609513754
              std dev =       0.536916821359
             le_variance =       0.288279673058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915816
                                         uncertainty =       0.001928769019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288285915816
                                         uncertainty =       0.001928769019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379657526
  error estimate for blocks of size 2^( 2) =       0.000391121889
  error estimate for blocks of size 2^( 3) =       0.000401157864
  error estimate for blocks of size 2^( 4) =       0.000408492959
  error estimate for blocks of size 2^( 5) =       0.000413341894
  error estimate for blocks of size 2^( 6) =       0.000414765714
  error estimate for blocks of size 2^( 7) =       0.000417763748

      target function =      -0.912093141170
              le_mean =     -17.215042556023
             les_mean =     296.658010828185
             stat err =       0.000413591079
             autocorr =       1.186747426439
   target nu stat err =       0.000413591079
   target dn stat err =       0.002275075320
      target stat err =       0.003609514087
              std dev =       0.536916822059
             le_variance =       0.288279673810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912093143709        initial  <--
     1.5259e+04     1.5259e+05             1.1371e-08        -0.912093103040
     6.1035e+04     6.1035e+05             2.8427e-09        -0.912093123389
     2.4414e+05     2.4414e+06             7.1069e-10        -0.912093141170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5254
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2323
    reference variance = 0.255217
====================================================
  Execution time = 1.4709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9847e-01
  Total weights = 1.957299666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286925132448
                                         uncertainty =       0.001873045427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286925132448
                                         uncertainty =       0.001873045427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378757717
  error estimate for blocks of size 2^( 2) =       0.000390308090
  error estimate for blocks of size 2^( 3) =       0.000400785247
  error estimate for blocks of size 2^( 4) =       0.000408591207
  error estimate for blocks of size 2^( 5) =       0.000413217824
  error estimate for blocks of size 2^( 6) =       0.000416093939
  error estimate for blocks of size 2^( 7) =       0.000416566153

      target function =      -0.914982902798
              le_mean =     -17.214860880732
             les_mean =     296.649907532181
             stat err =       0.000413617281
             autocorr =       1.192543887582
   target nu stat err =       0.000413617281
   target dn stat err =       0.002403742584
      target stat err =       0.003828507306
              std dev =       0.535644299872
             le_variance =       0.286914815985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721486088073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998099269       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914998099446       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914998099470       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914998099480       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914998099698       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914998099465       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914998099530       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914998099603       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914998099468       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914998099404       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+05 is 8.934809e-10

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998099269       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914998099313       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914998099319       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914998099321       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914998099380       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914998098865       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914998098511       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914998098656       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914998097285       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914998098576       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+05 is 2.233703e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914998099269       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914998099280       residual = 7.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914998099281       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914998099282       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914998099278       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914998099075       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914998098612       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914998097604       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914998100936       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914998102212       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+06 is 5.584262e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7194e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118448e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1484
    reference variance = 0.299722
====================================================
  Execution time = 1.4574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0053e-01
  Total weights = 1.9578e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473625
                                         uncertainty =       0.001907861134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473625
                                         uncertainty =       0.001907861134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378875562
  error estimate for blocks of size 2^( 2) =       0.000390154929
  error estimate for blocks of size 2^( 3) =       0.000400491108
  error estimate for blocks of size 2^( 4) =       0.000408387033
  error estimate for blocks of size 2^( 5) =       0.000413267278
  error estimate for blocks of size 2^( 6) =       0.000416330976
  error estimate for blocks of size 2^( 7) =       0.000417653369

      target function =      -0.911804223674
              le_mean =     -17.214165279988
             les_mean =     296.628014752995
             stat err =       0.000413909664
             autocorr =       1.193487696325
   target nu stat err =       0.000413909664
   target dn stat err =       0.002430929778
      target stat err =       0.003839040773
              std dev =       0.535810957907
             le_variance =       0.287093382614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473493
                                         uncertainty =       0.001907861140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473493
                                         uncertainty =       0.001907861140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378875562
  error estimate for blocks of size 2^( 2) =       0.000390154929
  error estimate for blocks of size 2^( 3) =       0.000400491108
  error estimate for blocks of size 2^( 4) =       0.000408387033
  error estimate for blocks of size 2^( 5) =       0.000413267278
  error estimate for blocks of size 2^( 6) =       0.000416330976
  error estimate for blocks of size 2^( 7) =       0.000417653369

      target function =      -0.911804223659
              le_mean =     -17.214165279991
             les_mean =     296.628014753076
             stat err =       0.000413909664
             autocorr =       1.193487697211
   target nu stat err =       0.000413909664
   target dn stat err =       0.002430929754
      target stat err =       0.003839040736
              std dev =       0.535810957783
             le_variance =       0.287093382480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473559
                                         uncertainty =       0.001907861137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473559
                                         uncertainty =       0.001907861137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378875562
  error estimate for blocks of size 2^( 2) =       0.000390154929
  error estimate for blocks of size 2^( 3) =       0.000400491108
  error estimate for blocks of size 2^( 4) =       0.000408387033
  error estimate for blocks of size 2^( 5) =       0.000413267278
  error estimate for blocks of size 2^( 6) =       0.000416330976
  error estimate for blocks of size 2^( 7) =       0.000417653369

      target function =      -0.911804223666
              le_mean =     -17.214165279989
             les_mean =     296.628014753035
             stat err =       0.000413909664
             autocorr =       1.193487696768
   target nu stat err =       0.000413909664
   target dn stat err =       0.002430929766
      target stat err =       0.003839040755
              std dev =       0.535810957845
             le_variance =       0.287093382547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473617
                                         uncertainty =       0.001907861134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287119473617
                                         uncertainty =       0.001907861134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378875562
  error estimate for blocks of size 2^( 2) =       0.000390154929
  error estimate for blocks of size 2^( 3) =       0.000400491108
  error estimate for blocks of size 2^( 4) =       0.000408387033
  error estimate for blocks of size 2^( 5) =       0.000413267278
  error estimate for blocks of size 2^( 6) =       0.000416330976
  error estimate for blocks of size 2^( 7) =       0.000417653369

      target function =      -0.911804223673
              le_mean =     -17.214165279989
             les_mean =     296.628014753000
             stat err =       0.000413909664
             autocorr =       1.193487696387
   target nu stat err =       0.000413909664
   target dn stat err =       0.002430929777
      target stat err =       0.003839040771
              std dev =       0.535810957899
             le_variance =       0.287093382605


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911804223674        initial  <--
     1.5259e+05     1.5259e+06             8.9348e-10        -0.911804223659
     6.1035e+05     6.1035e+06             2.2337e-10        -0.911804223666
     2.4414e+06     2.4414e+07             5.5843e-11        -0.911804223673

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8155
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.169213
====================================================
  Execution time = 1.4576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9551e-01
  Total weights = 1.957655951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283861725573
                                         uncertainty =       0.001744507598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283861725573
                                         uncertainty =       0.001744507598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376792724
  error estimate for blocks of size 2^( 2) =       0.000388115721
  error estimate for blocks of size 2^( 3) =       0.000398521441
  error estimate for blocks of size 2^( 4) =       0.000406531060
  error estimate for blocks of size 2^( 5) =       0.000410854364
  error estimate for blocks of size 2^( 6) =       0.000415164685
  error estimate for blocks of size 2^( 7) =       0.000416911968

      target function =      -0.919645647765
              le_mean =     -17.214863314655
             les_mean =     296.647025175506
             stat err =       0.000412365519
             autocorr =       1.197732051718
   target nu stat err =       0.000412365519
   target dn stat err =       0.002693678411
      target stat err =       0.004318115214
              std dev =       0.532865380887
             le_variance =       0.283945514148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721486331466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919664681100       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919664681147       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919664681152       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919664680966       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919664680548       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919664679110       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919664679174       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919664678299       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919664682052       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919664681441       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 1.114548e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919664681100       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919664681112       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919664681113       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919664681110       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919664683014       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919664682147       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919664676955       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919664696092       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919664681010       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919664675418       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 2.786370e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919664681100       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919664681103       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919664681103       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919664681103       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919664681441       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919664662111       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919664663266       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919664688328       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919664669642       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919664694319       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+07 is 6.965945e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7088e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2711
    reference variance = 0.217326
====================================================
  Execution time = 1.4223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0018e-01
  Total weights = 1.9577e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794921
                                         uncertainty =       0.001557828823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794921
                                         uncertainty =       0.001557828823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377724599
  error estimate for blocks of size 2^( 2) =       0.000388741048
  error estimate for blocks of size 2^( 3) =       0.000399396407
  error estimate for blocks of size 2^( 4) =       0.000407378805
  error estimate for blocks of size 2^( 5) =       0.000411305290
  error estimate for blocks of size 2^( 6) =       0.000412929547
  error estimate for blocks of size 2^( 7) =       0.000415514811

      target function =      -0.912334793049
              le_mean =     -17.214251401032
             les_mean =     296.630632565864
             stat err =       0.000411782113
             autocorr =       1.188459590064
   target nu stat err =       0.000411782113
   target dn stat err =       0.002818870629
      target stat err =       0.004437690465
              std dev =       0.534183250336
             le_variance =       0.285351744940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794896
                                         uncertainty =       0.001557828818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794896
                                         uncertainty =       0.001557828818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377724599
  error estimate for blocks of size 2^( 2) =       0.000388741048
  error estimate for blocks of size 2^( 3) =       0.000399396407
  error estimate for blocks of size 2^( 4) =       0.000407378805
  error estimate for blocks of size 2^( 5) =       0.000411305290
  error estimate for blocks of size 2^( 6) =       0.000412929547
  error estimate for blocks of size 2^( 7) =       0.000415514811

      target function =      -0.912334793337
              le_mean =     -17.214251401031
             les_mean =     296.630632565653
             stat err =       0.000411782113
             autocorr =       1.188459590173
   target nu stat err =       0.000411782113
   target dn stat err =       0.002818870585
      target stat err =       0.004437690400
              std dev =       0.534183250313
             le_variance =       0.285351744915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794908
                                         uncertainty =       0.001557828821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794908
                                         uncertainty =       0.001557828821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377724599
  error estimate for blocks of size 2^( 2) =       0.000388741048
  error estimate for blocks of size 2^( 3) =       0.000399396407
  error estimate for blocks of size 2^( 4) =       0.000407378805
  error estimate for blocks of size 2^( 5) =       0.000411305290
  error estimate for blocks of size 2^( 6) =       0.000412929547
  error estimate for blocks of size 2^( 7) =       0.000415514811

      target function =      -0.912334793193
              le_mean =     -17.214251401031
             les_mean =     296.630632565759
             stat err =       0.000411782113
             autocorr =       1.188459590120
   target nu stat err =       0.000411782113
   target dn stat err =       0.002818870607
      target stat err =       0.004437690432
              std dev =       0.534183250324
             le_variance =       0.285351744927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794919
                                         uncertainty =       0.001557828823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285332794919
                                         uncertainty =       0.001557828823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377724599
  error estimate for blocks of size 2^( 2) =       0.000388741048
  error estimate for blocks of size 2^( 3) =       0.000399396407
  error estimate for blocks of size 2^( 4) =       0.000407378805
  error estimate for blocks of size 2^( 5) =       0.000411305290
  error estimate for blocks of size 2^( 6) =       0.000412929547
  error estimate for blocks of size 2^( 7) =       0.000415514811

      target function =      -0.912334793067
              le_mean =     -17.214251401031
             les_mean =     296.630632565850
             stat err =       0.000411782113
             autocorr =       1.188459590066
   target nu stat err =       0.000411782113
   target dn stat err =       0.002818870626
      target stat err =       0.004437690461
              std dev =       0.534183250335
             le_variance =       0.285351744938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912334793049        initial
     1.5259e+06     1.5259e+07             1.1145e-10        -0.912334793337  <--
     6.1035e+06     6.1035e+07             2.7864e-11        -0.912334793193
     2.4414e+07     2.4414e+08             6.9659e-12        -0.912334793067

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 2.3454e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.204
    reference variance = 0.299361
====================================================
  Execution time = 1.4615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1927e-01
  Total weights = 1.957376684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292860786653
                                         uncertainty =       0.004873511379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292860786653
                                         uncertainty =       0.004873511379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382678259
  error estimate for blocks of size 2^( 2) =       0.000394073180
  error estimate for blocks of size 2^( 3) =       0.000404036757
  error estimate for blocks of size 2^( 4) =       0.000411780503
  error estimate for blocks of size 2^( 5) =       0.000416697131
  error estimate for blocks of size 2^( 6) =       0.000420223086
  error estimate for blocks of size 2^( 7) =       0.000420579062

      target function =      -0.882851792178
              le_mean =     -17.214552336487
             les_mean =     296.660079729433
             stat err =       0.000417319945
             autocorr =       1.189243273846
   target nu stat err =       0.000417319945
   target dn stat err =       0.017596713306
      target stat err =       0.025658961077
              std dev =       0.541188784406
             le_variance =       0.292885300367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721455233649e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883593067321       residual = 4.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883593070109       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883593070358       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883593070383       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883593070226       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883593070402       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883593070661       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883593070401       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883593069997       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883593070335       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883593070402       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+05 is 2.852326e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883593067321       residual = 4.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883593068018       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883593068081       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883593068090       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883593068091       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883593068092       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883593068091       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883593068091       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883593068092       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883593065529       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883593068091       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+06 is 7.130817e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883593067321       residual = 4.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883593067496       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883593067511       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883593067514       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883593067514       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883593067514       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883593073940       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883593067514       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883593067514       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883593067514       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883593067514       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+06 is 1.782704e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7128e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873656e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916111e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118448e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1377
    reference variance = 0.240317
====================================================
  Execution time = 1.4296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0018e-01
  Total weights = 1.9575e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878273
                                         uncertainty =       0.001835987393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878273
                                         uncertainty =       0.001835987393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379224035
  error estimate for blocks of size 2^( 2) =       0.000391016158
  error estimate for blocks of size 2^( 3) =       0.000401538159
  error estimate for blocks of size 2^( 4) =       0.000409545773
  error estimate for blocks of size 2^( 5) =       0.000414636266
  error estimate for blocks of size 2^( 6) =       0.000417428663
  error estimate for blocks of size 2^( 7) =       0.000418412955

      target function =      -0.912356473482
              le_mean =     -17.213883248866
             les_mean =     296.617958087238
             stat err =       0.000415005914
             autocorr =       1.197613995719
   target nu stat err =       0.000415005914
   target dn stat err =       0.002209423606
      target stat err =       0.003504261488
              std dev =       0.536303773022
             le_variance =       0.287621736957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878253
                                         uncertainty =       0.001835987382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878253
                                         uncertainty =       0.001835987382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379224035
  error estimate for blocks of size 2^( 2) =       0.000391016158
  error estimate for blocks of size 2^( 3) =       0.000401538159
  error estimate for blocks of size 2^( 4) =       0.000409545773
  error estimate for blocks of size 2^( 5) =       0.000414636266
  error estimate for blocks of size 2^( 6) =       0.000417428663
  error estimate for blocks of size 2^( 7) =       0.000418412955

      target function =      -0.912356472602
              le_mean =     -17.213883248867
             les_mean =     296.617958087855
             stat err =       0.000415005915
             autocorr =       1.197613997502
   target nu stat err =       0.000415005915
   target dn stat err =       0.002209423620
      target stat err =       0.003504261503
              std dev =       0.536303773003
             le_variance =       0.287621736937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878263
                                         uncertainty =       0.001835987388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878263
                                         uncertainty =       0.001835987388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379224035
  error estimate for blocks of size 2^( 2) =       0.000391016158
  error estimate for blocks of size 2^( 3) =       0.000401538159
  error estimate for blocks of size 2^( 4) =       0.000409545773
  error estimate for blocks of size 2^( 5) =       0.000414636266
  error estimate for blocks of size 2^( 6) =       0.000417428663
  error estimate for blocks of size 2^( 7) =       0.000418412955

      target function =      -0.912356473042
              le_mean =     -17.213883248867
             les_mean =     296.617958087547
             stat err =       0.000415005914
             autocorr =       1.197613996608
   target nu stat err =       0.000415005914
   target dn stat err =       0.002209423613
      target stat err =       0.003504261495
              std dev =       0.536303773013
             le_variance =       0.287621736947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878272
                                         uncertainty =       0.001835987393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287694878272
                                         uncertainty =       0.001835987393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379224035
  error estimate for blocks of size 2^( 2) =       0.000391016158
  error estimate for blocks of size 2^( 3) =       0.000401538159
  error estimate for blocks of size 2^( 4) =       0.000409545773
  error estimate for blocks of size 2^( 5) =       0.000414636266
  error estimate for blocks of size 2^( 6) =       0.000417428663
  error estimate for blocks of size 2^( 7) =       0.000418412955

      target function =      -0.912356473427
              le_mean =     -17.213883248866
             les_mean =     296.617958087277
             stat err =       0.000415005914
             autocorr =       1.197613995822
   target nu stat err =       0.000415005914
   target dn stat err =       0.002209423607
      target stat err =       0.003504261489
              std dev =       0.536303773021
             le_variance =       0.287621736956


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912356473482        initial  <--
     3.8147e+05     3.8147e+06             2.8523e-09        -0.912356472602
     1.5259e+06     1.5259e+07             7.1308e-10        -0.912356473042
     6.1035e+06     6.1035e+07             1.7827e-10        -0.912356473427

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5687
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0706e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.224189
====================================================
  Execution time = 1.6706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9465e-01
  Total weights = 1.957439730e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283514036224
                                         uncertainty =       0.001535653606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283514036224
                                         uncertainty =       0.001535653606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376484774
  error estimate for blocks of size 2^( 2) =       0.000388078438
  error estimate for blocks of size 2^( 3) =       0.000399076605
  error estimate for blocks of size 2^( 4) =       0.000406991739
  error estimate for blocks of size 2^( 5) =       0.000411325952
  error estimate for blocks of size 2^( 6) =       0.000413300147
  error estimate for blocks of size 2^( 7) =       0.000416127914

      target function =      -0.921017738597
              le_mean =     -17.214294485206
             les_mean =     296.626588681979
             stat err =       0.000411936438
             autocorr =       1.197196900997
   target nu stat err =       0.000411936438
   target dn stat err =       0.001994014069
      target stat err =       0.003237649258
              std dev =       0.532429873829
             le_variance =       0.283481570546


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429448521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921028178318       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921028178323       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921028178324       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921028178324       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921028176947       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921028175304       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921028178597       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921028181087       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921028178450       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 3.284748e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921028178318       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921028178319       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921028178319       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921028178319       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921028176384       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921028178319       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921028178319       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921028143211       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921028168935       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 8.211877e-12

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.921028178318       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921028178318       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921028178318       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921028178318       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921028178208       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921028183281       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921028339692       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921028167584       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921028080597       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+07 is 2.052972e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9211e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2453
    reference variance = 0.190862
====================================================
  Execution time = 1.4493e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0448e-01
  Total weights = 1.9578e+06
  Execution time = 1.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286372
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286372
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379268996
  error estimate for blocks of size 2^( 2) =       0.000390500092
  error estimate for blocks of size 2^( 3) =       0.000400889912
  error estimate for blocks of size 2^( 4) =       0.000408406598
  error estimate for blocks of size 2^( 5) =       0.000412369582
  error estimate for blocks of size 2^( 6) =       0.000414115221
  error estimate for blocks of size 2^( 7) =       0.000416572781

      target function =      -0.905651724866
              le_mean =     -17.214535062749
             les_mean =     296.644698588248
             stat err =       0.000412866045
             autocorr =       1.185014460205
   target nu stat err =       0.000412866045
   target dn stat err =       0.004562394519
      target stat err =       0.007027404404
              std dev =       0.536367358577
             le_variance =       0.287689943346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286369
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286369
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379268996
  error estimate for blocks of size 2^( 2) =       0.000390500092
  error estimate for blocks of size 2^( 3) =       0.000400889912
  error estimate for blocks of size 2^( 4) =       0.000408406598
  error estimate for blocks of size 2^( 5) =       0.000412369582
  error estimate for blocks of size 2^( 6) =       0.000414115221
  error estimate for blocks of size 2^( 7) =       0.000416572781

      target function =      -0.905651724927
              le_mean =     -17.214535062749
             les_mean =     296.644698588218
             stat err =       0.000412866045
             autocorr =       1.185014460221
   target nu stat err =       0.000412866045
   target dn stat err =       0.004562394511
      target stat err =       0.007027404394
              std dev =       0.536367358575
             le_variance =       0.287689943344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286371
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286371
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379268996
  error estimate for blocks of size 2^( 2) =       0.000390500092
  error estimate for blocks of size 2^( 3) =       0.000400889912
  error estimate for blocks of size 2^( 4) =       0.000408406598
  error estimate for blocks of size 2^( 5) =       0.000412369582
  error estimate for blocks of size 2^( 6) =       0.000414115221
  error estimate for blocks of size 2^( 7) =       0.000416572781

      target function =      -0.905651724897
              le_mean =     -17.214535062749
             les_mean =     296.644698588233
             stat err =       0.000412866045
             autocorr =       1.185014460214
   target nu stat err =       0.000412866045
   target dn stat err =       0.004562394515
      target stat err =       0.007027404399
              std dev =       0.536367358576
             le_variance =       0.287689943345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286372
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287748286372
                                         uncertainty =       0.001812732648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379268996
  error estimate for blocks of size 2^( 2) =       0.000390500092
  error estimate for blocks of size 2^( 3) =       0.000400889912
  error estimate for blocks of size 2^( 4) =       0.000408406598
  error estimate for blocks of size 2^( 5) =       0.000412369582
  error estimate for blocks of size 2^( 6) =       0.000414115221
  error estimate for blocks of size 2^( 7) =       0.000416572781

      target function =      -0.905651724870
              le_mean =     -17.214535062749
             les_mean =     296.644698588246
             stat err =       0.000412866045
             autocorr =       1.185014460205
   target nu stat err =       0.000412866045
   target dn stat err =       0.004562394518
      target stat err =       0.007027404404
              std dev =       0.536367358577
             le_variance =       0.287689943346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905651724866        initial
     3.8147e+06     3.8147e+07             3.2847e-11        -0.905651724927  <--
     1.5259e+07     1.5259e+08             8.2119e-12        -0.905651724897
     6.1035e+07     6.1035e+08             2.0530e-12        -0.905651724870

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.3755e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1837
    reference variance = 0.358723
====================================================
  Execution time = 1.4486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0377e-01
  Total weights = 1.957854032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288597955845
                                         uncertainty =       0.002051665482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288597955845
                                         uncertainty =       0.002051665482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379915938
  error estimate for blocks of size 2^( 2) =       0.000391307272
  error estimate for blocks of size 2^( 3) =       0.000401456730
  error estimate for blocks of size 2^( 4) =       0.000408596634
  error estimate for blocks of size 2^( 5) =       0.000413675648
  error estimate for blocks of size 2^( 6) =       0.000416079770
  error estimate for blocks of size 2^( 7) =       0.000418223288

      target function =      -0.906774706391
              le_mean =     -17.214422585398
             les_mean =     296.640118735874
             stat err =       0.000414143835
             autocorr =       1.188303499816
   target nu stat err =       0.000414143835
   target dn stat err =       0.002909657910
      target stat err =       0.004524201809
              std dev =       0.537282271524
             le_variance =       0.288672239294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721442258540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906796305930       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906796305987       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906796305993       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906796306048       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906796306415       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906796305746       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906796305314       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906796302859       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906796304680       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906796306104       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+05 is 1.627323e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906796305930       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906796305944       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906796305946       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906796305946       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906796305854       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906796308605       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906796305567       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906796307512       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906796309256       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906796304441       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+06 is 4.068309e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906796305930       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906796305933       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906796305934       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906796308436       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906796306634       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906796298153       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906796314127       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906796296380       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906796264802       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906796300893       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+07 is 1.017077e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6987e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204467e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.274633
====================================================
  Execution time = 1.4162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0195e-01
  Total weights = 1.9575e+06
  Execution time = 1.8393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298704
                                         uncertainty =       0.001798680562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298704
                                         uncertainty =       0.001798680562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392755
  error estimate for blocks of size 2^( 2) =       0.000390771757
  error estimate for blocks of size 2^( 3) =       0.000401194781
  error estimate for blocks of size 2^( 4) =       0.000409101098
  error estimate for blocks of size 2^( 5) =       0.000414077505
  error estimate for blocks of size 2^( 6) =       0.000416179557
  error estimate for blocks of size 2^( 7) =       0.000418347729

      target function =      -0.909580590369
              le_mean =     -17.214702237001
             les_mean =     296.647920820013
             stat err =       0.000414426472
             autocorr =       1.193210072375
   target nu stat err =       0.000414426472
   target dn stat err =       0.002574672355
      target stat err =       0.004043344808
              std dev =       0.536542380068
             le_variance =       0.287877725609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298668
                                         uncertainty =       0.001798680558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298668
                                         uncertainty =       0.001798680558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392755
  error estimate for blocks of size 2^( 2) =       0.000390771757
  error estimate for blocks of size 2^( 3) =       0.000401194781
  error estimate for blocks of size 2^( 4) =       0.000409101098
  error estimate for blocks of size 2^( 5) =       0.000414077505
  error estimate for blocks of size 2^( 6) =       0.000416179557
  error estimate for blocks of size 2^( 7) =       0.000418347729

      target function =      -0.909580589786
              le_mean =     -17.214702237001
             les_mean =     296.647920820372
             stat err =       0.000414426472
             autocorr =       1.193210072559
   target nu stat err =       0.000414426472
   target dn stat err =       0.002574672431
      target stat err =       0.004043344917
              std dev =       0.536542380035
             le_variance =       0.287877725573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298686
                                         uncertainty =       0.001798680560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298686
                                         uncertainty =       0.001798680560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392755
  error estimate for blocks of size 2^( 2) =       0.000390771757
  error estimate for blocks of size 2^( 3) =       0.000401194781
  error estimate for blocks of size 2^( 4) =       0.000409101098
  error estimate for blocks of size 2^( 5) =       0.000414077505
  error estimate for blocks of size 2^( 6) =       0.000416179557
  error estimate for blocks of size 2^( 7) =       0.000418347729

      target function =      -0.909580590078
              le_mean =     -17.214702237001
             les_mean =     296.647920820193
             stat err =       0.000414426472
             autocorr =       1.193210072471
   target nu stat err =       0.000414426472
   target dn stat err =       0.002574672393
      target stat err =       0.004043344862
              std dev =       0.536542380051
             le_variance =       0.287877725591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298702
                                         uncertainty =       0.001798680561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961298702
                                         uncertainty =       0.001798680561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392755
  error estimate for blocks of size 2^( 2) =       0.000390771757
  error estimate for blocks of size 2^( 3) =       0.000401194781
  error estimate for blocks of size 2^( 4) =       0.000409101098
  error estimate for blocks of size 2^( 5) =       0.000414077505
  error estimate for blocks of size 2^( 6) =       0.000416179557
  error estimate for blocks of size 2^( 7) =       0.000418347729

      target function =      -0.909580590333
              le_mean =     -17.214702237001
             les_mean =     296.647920820036
             stat err =       0.000414426472
             autocorr =       1.193210072393
   target nu stat err =       0.000414426472
   target dn stat err =       0.002574672360
      target stat err =       0.004043344815
              std dev =       0.536542380066
             le_variance =       0.287877725607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909580590369        initial  <--
     9.5367e+05     9.5367e+06             1.6273e-10        -0.909580589786
     3.8147e+06     3.8147e+07             4.0683e-11        -0.909580590078
     1.5259e+07     1.5259e+08             1.0171e-11        -0.909580590333

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5834
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1854
    reference variance = 0.977561
====================================================
  Execution time = 1.4450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9835e-01
  Total weights = 1.957791720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285129192876
                                         uncertainty =       0.001718401168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285129192876
                                         uncertainty =       0.001718401168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377574694
  error estimate for blocks of size 2^( 2) =       0.000388530193
  error estimate for blocks of size 2^( 3) =       0.000399085381
  error estimate for blocks of size 2^( 4) =       0.000407273181
  error estimate for blocks of size 2^( 5) =       0.000412490499
  error estimate for blocks of size 2^( 6) =       0.000414504457
  error estimate for blocks of size 2^( 7) =       0.000415963687

      target function =      -0.915189791311
              le_mean =     -17.214259566516
             les_mean =     296.629086133499
             stat err =       0.000412557956
             autocorr =       1.193889617646
   target nu stat err =       0.000412557956
   target dn stat err =       0.002417904224
      target stat err =       0.003847348443
              std dev =       0.533971253048
             le_variance =       0.285125299081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721425956652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915204936864       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915204936874       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915204936874       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915204936876       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915204936880       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915204928086       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915204927754       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915204929782       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915204949818       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915204936900       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 2.473744e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915204936864       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915204936867       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915204936867       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915204936851       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915204937155       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915204912691       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915204898474       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915204983549       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915204967234       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915204931925       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 6.184389e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915204936864       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915204936865       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915204936865       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915204957901       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915204924745       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915204784085       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915204903354       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915204847836       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915204932880       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915204891110       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+08 is 1.546089e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6970e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2756
    reference variance = 0.207034
====================================================
  Execution time = 1.4148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0112e-01
  Total weights = 1.9578e+06
  Execution time = 1.8347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348100
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348100
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380008799
  error estimate for blocks of size 2^( 2) =       0.000391376688
  error estimate for blocks of size 2^( 3) =       0.000401186255
  error estimate for blocks of size 2^( 4) =       0.000408970152
  error estimate for blocks of size 2^( 5) =       0.000415308588
  error estimate for blocks of size 2^( 6) =       0.000417371756
  error estimate for blocks of size 2^( 7) =       0.000417726955

      target function =      -0.910837690272
              le_mean =     -17.214882654935
             les_mean =     296.653300739003
             stat err =       0.000414844363
             autocorr =       1.191744293594
   target nu stat err =       0.000414844363
   target dn stat err =       0.003903313764
      target stat err =       0.006096071262
              std dev =       0.537413596880
             le_variance =       0.288813374111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348098
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348098
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380008799
  error estimate for blocks of size 2^( 2) =       0.000391376688
  error estimate for blocks of size 2^( 3) =       0.000401186255
  error estimate for blocks of size 2^( 4) =       0.000408970152
  error estimate for blocks of size 2^( 5) =       0.000415308588
  error estimate for blocks of size 2^( 6) =       0.000417371756
  error estimate for blocks of size 2^( 7) =       0.000417726955

      target function =      -0.910837690302
              le_mean =     -17.214882654935
             les_mean =     296.653300738986
             stat err =       0.000414844363
             autocorr =       1.191744293592
   target nu stat err =       0.000414844363
   target dn stat err =       0.003903313762
      target stat err =       0.006096071260
              std dev =       0.537413596878
             le_variance =       0.288813374109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348099
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348099
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380008799
  error estimate for blocks of size 2^( 2) =       0.000391376688
  error estimate for blocks of size 2^( 3) =       0.000401186255
  error estimate for blocks of size 2^( 4) =       0.000408970152
  error estimate for blocks of size 2^( 5) =       0.000415308588
  error estimate for blocks of size 2^( 6) =       0.000417371756
  error estimate for blocks of size 2^( 7) =       0.000417726955

      target function =      -0.910837690287
              le_mean =     -17.214882654935
             les_mean =     296.653300738994
             stat err =       0.000414844363
             autocorr =       1.191744293584
   target nu stat err =       0.000414844363
   target dn stat err =       0.003903313763
      target stat err =       0.006096071261
              std dev =       0.537413596879
             le_variance =       0.288813374110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348100
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288884348100
                                         uncertainty =       0.002468803810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380008799
  error estimate for blocks of size 2^( 2) =       0.000391376688
  error estimate for blocks of size 2^( 3) =       0.000401186255
  error estimate for blocks of size 2^( 4) =       0.000408970152
  error estimate for blocks of size 2^( 5) =       0.000415308588
  error estimate for blocks of size 2^( 6) =       0.000417371756
  error estimate for blocks of size 2^( 7) =       0.000417726955

      target function =      -0.910837690274
              le_mean =     -17.214882654935
             les_mean =     296.653300739002
             stat err =       0.000414844363
             autocorr =       1.191744293584
   target nu stat err =       0.000414844363
   target dn stat err =       0.003903313764
      target stat err =       0.006096071262
              std dev =       0.537413596880
             le_variance =       0.288813374111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910837690272        initial
     9.5367e+06     9.5367e+07             2.4737e-11        -0.910837690302  <--
     3.8147e+07     3.8147e+08             6.1844e-12        -0.910837690287
     1.5259e+08     1.5259e+09             1.5461e-12        -0.910837690274

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 2.3416e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1808
    reference variance = 0.230516
====================================================
  Execution time = 1.4975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9855e-01
  Total weights = 1.957809765e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285521706133
                                         uncertainty =       0.001649542381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285521706133
                                         uncertainty =       0.001649542381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377829514
  error estimate for blocks of size 2^( 2) =       0.000389435997
  error estimate for blocks of size 2^( 3) =       0.000399702807
  error estimate for blocks of size 2^( 4) =       0.000407184071
  error estimate for blocks of size 2^( 5) =       0.000412251512
  error estimate for blocks of size 2^( 6) =       0.000414494460
  error estimate for blocks of size 2^( 7) =       0.000415087628

      target function =      -0.914882719662
              le_mean =     -17.214194657849
             les_mean =     296.627049951304
             stat err =       0.000412254418
             autocorr =       1.190525982108
   target nu stat err =       0.000412254418
   target dn stat err =       0.002323656645
      target stat err =       0.003699527787
              std dev =       0.534331622590
             le_variance =       0.285510282900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721419465785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914896735956       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914896735973       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914896735975       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914896735958       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914896734079       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914896737081       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914896732033       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914896740772       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914896735976       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914896735976       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 5.591867e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914896735956       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914896735961       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914896735961       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914896735961       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914896735961       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914896735961       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914896735961       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914896735961       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914896735961       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914896735961       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 1.397967e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914896735956       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914896735957       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914896735958       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914896735958       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914896735958       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914896735958       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914896735958       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914896735958       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914896735958       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914896735958       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+07 is 3.494917e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7505e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.542517
====================================================
  Execution time = 1.4244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9983e-01
  Total weights = 1.9578e+06
  Execution time = 1.8241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083052
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083052
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378929433
  error estimate for blocks of size 2^( 2) =       0.000390358031
  error estimate for blocks of size 2^( 3) =       0.000400545942
  error estimate for blocks of size 2^( 4) =       0.000408469181
  error estimate for blocks of size 2^( 5) =       0.000412963158
  error estimate for blocks of size 2^( 6) =       0.000414199105
  error estimate for blocks of size 2^( 7) =       0.000416513122

      target function =      -0.912884848130
              le_mean =     -17.214233029780
             les_mean =     296.629651286851
             stat err =       0.000413036141
             autocorr =       1.188117602650
   target nu stat err =       0.000413036141
   target dn stat err =       0.002306107753
      target stat err =       0.003657393720
              std dev =       0.535887143057
             le_variance =       0.287175030094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083046
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083046
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378929433
  error estimate for blocks of size 2^( 2) =       0.000390358031
  error estimate for blocks of size 2^( 3) =       0.000400545942
  error estimate for blocks of size 2^( 4) =       0.000408469181
  error estimate for blocks of size 2^( 5) =       0.000412963158
  error estimate for blocks of size 2^( 6) =       0.000414199105
  error estimate for blocks of size 2^( 7) =       0.000416513122

      target function =      -0.912884850742
              le_mean =     -17.214233029780
             les_mean =     296.629651285172
             stat err =       0.000413036141
             autocorr =       1.188117602679
   target nu stat err =       0.000413036141
   target dn stat err =       0.002306107717
      target stat err =       0.003657393687
              std dev =       0.535887143052
             le_variance =       0.287175030089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083049
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083049
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378929433
  error estimate for blocks of size 2^( 2) =       0.000390358031
  error estimate for blocks of size 2^( 3) =       0.000400545942
  error estimate for blocks of size 2^( 4) =       0.000408469181
  error estimate for blocks of size 2^( 5) =       0.000412963158
  error estimate for blocks of size 2^( 6) =       0.000414199105
  error estimate for blocks of size 2^( 7) =       0.000416513122

      target function =      -0.912884849436
              le_mean =     -17.214233029780
             les_mean =     296.629651286012
             stat err =       0.000413036141
             autocorr =       1.188117602655
   target nu stat err =       0.000413036141
   target dn stat err =       0.002306107735
      target stat err =       0.003657393703
              std dev =       0.535887143055
             le_variance =       0.287175030091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083051
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287167083051
                                         uncertainty =       0.001894821414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378929433
  error estimate for blocks of size 2^( 2) =       0.000390358031
  error estimate for blocks of size 2^( 3) =       0.000400545942
  error estimate for blocks of size 2^( 4) =       0.000408469181
  error estimate for blocks of size 2^( 5) =       0.000412963158
  error estimate for blocks of size 2^( 6) =       0.000414199105
  error estimate for blocks of size 2^( 7) =       0.000416513122

      target function =      -0.912884848294
              le_mean =     -17.214233029780
             les_mean =     296.629651286747
             stat err =       0.000413036141
             autocorr =       1.188117602660
   target nu stat err =       0.000413036141
   target dn stat err =       0.002306107751
      target stat err =       0.003657393718
              std dev =       0.535887143057
             le_variance =       0.287175030094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912884848130        initial
     2.3842e+06     2.3842e+07             5.5919e-11        -0.912884850742  <--
     9.5367e+06     9.5367e+07             1.3980e-11        -0.912884849436
     3.8147e+07     3.8147e+08             3.4949e-12        -0.912884848294

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 2.3469e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0998e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.0992
    reference variance = 0.24458
====================================================
  Execution time = 1.4606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9965e-01
  Total weights = 1.957771864e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286906817626
                                         uncertainty =       0.001630022400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286906817626
                                         uncertainty =       0.001630022400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378776688
  error estimate for blocks of size 2^( 2) =       0.000389827893
  error estimate for blocks of size 2^( 3) =       0.000400555127
  error estimate for blocks of size 2^( 4) =       0.000408195388
  error estimate for blocks of size 2^( 5) =       0.000414130762
  error estimate for blocks of size 2^( 6) =       0.000415606681
  error estimate for blocks of size 2^( 7) =       0.000417378961

      target function =      -0.913124249376
              le_mean =     -17.215474984865
             les_mean =     296.672226562780
             stat err =       0.000413827948
             autocorr =       1.193639410830
   target nu stat err =       0.000413827948
   target dn stat err =       0.002245310578
      target stat err =       0.003574981406
              std dev =       0.535671129911
             le_variance =       0.286943559421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721547498486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913137286263       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913137286316       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913137286325       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913137286327       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913137286327       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913137286328       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913137286336       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913137286038       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913137285660       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+05 is 2.341564e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913137286263       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913137286277       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913137286279       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913137286279       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913137286279       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913137286279       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913137284616       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913137285314       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913137286280       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+06 is 5.853911e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913137286263       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913137286267       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913137286267       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913137286267       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913137286267       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913137286267       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913137286267       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913137296320       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913137286267       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+06 is 1.463478e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7103e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2675
    reference variance = 0.272766
====================================================
  Execution time = 1.4198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0434e-01
  Total weights = 1.9573e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618062
                                         uncertainty =       0.002573155523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618062
                                         uncertainty =       0.002573155523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380496604
  error estimate for blocks of size 2^( 2) =       0.000391869806
  error estimate for blocks of size 2^( 3) =       0.000402601879
  error estimate for blocks of size 2^( 4) =       0.000410247014
  error estimate for blocks of size 2^( 5) =       0.000414106197
  error estimate for blocks of size 2^( 6) =       0.000417229289
  error estimate for blocks of size 2^( 7) =       0.000418437447

      target function =      -0.905907432562
              le_mean =     -17.214236658232
             les_mean =     296.634285715818
             stat err =       0.000415004987
             autocorr =       1.189611248562
   target nu stat err =       0.000415004987
   target dn stat err =       0.003211747845
      target stat err =       0.004972214751
              std dev =       0.538103457199
             le_variance =       0.289555330649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618056
                                         uncertainty =       0.002573155522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618056
                                         uncertainty =       0.002573155522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380496604
  error estimate for blocks of size 2^( 2) =       0.000391869806
  error estimate for blocks of size 2^( 3) =       0.000402601879
  error estimate for blocks of size 2^( 4) =       0.000410247014
  error estimate for blocks of size 2^( 5) =       0.000414106197
  error estimate for blocks of size 2^( 6) =       0.000417229289
  error estimate for blocks of size 2^( 7) =       0.000418437447

      target function =      -0.905907432515
              le_mean =     -17.214236658229
             les_mean =     296.634285715746
             stat err =       0.000415004987
             autocorr =       1.189611248674
   target nu stat err =       0.000415004987
   target dn stat err =       0.003211747838
      target stat err =       0.004972214740
              std dev =       0.538103457192
             le_variance =       0.289555330642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618059
                                         uncertainty =       0.002573155522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618059
                                         uncertainty =       0.002573155522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380496604
  error estimate for blocks of size 2^( 2) =       0.000391869806
  error estimate for blocks of size 2^( 3) =       0.000402601879
  error estimate for blocks of size 2^( 4) =       0.000410247014
  error estimate for blocks of size 2^( 5) =       0.000414106197
  error estimate for blocks of size 2^( 6) =       0.000417229289
  error estimate for blocks of size 2^( 7) =       0.000418437447

      target function =      -0.905907432538
              le_mean =     -17.214236658231
             les_mean =     296.634285715782
             stat err =       0.000415004987
             autocorr =       1.189611248625
   target nu stat err =       0.000415004987
   target dn stat err =       0.003211747842
      target stat err =       0.004972214746
              std dev =       0.538103457196
             le_variance =       0.289555330646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618062
                                         uncertainty =       0.002573155523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289503618062
                                         uncertainty =       0.002573155523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380496604
  error estimate for blocks of size 2^( 2) =       0.000391869806
  error estimate for blocks of size 2^( 3) =       0.000402601879
  error estimate for blocks of size 2^( 4) =       0.000410247014
  error estimate for blocks of size 2^( 5) =       0.000414106197
  error estimate for blocks of size 2^( 6) =       0.000417229289
  error estimate for blocks of size 2^( 7) =       0.000418437447

      target function =      -0.905907432559
              le_mean =     -17.214236658232
             les_mean =     296.634285715814
             stat err =       0.000415004987
             autocorr =       1.189611248573
   target nu stat err =       0.000415004987
   target dn stat err =       0.003211747845
      target stat err =       0.004972214751
              std dev =       0.538103457198
             le_variance =       0.289555330649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905907432562        initial  <--
     5.9605e+05     5.9605e+06             2.3416e-10        -0.905907432515
     2.3842e+06     2.3842e+07             5.8539e-11        -0.905907432538
     9.5367e+06     9.5367e+07             1.4635e-11        -0.905907432559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.4869
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.269303
====================================================
  Execution time = 1.4551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0105e-01
  Total weights = 1.957735568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285989894137
                                         uncertainty =       0.001815692500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285989894137
                                         uncertainty =       0.001815692500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378160074
  error estimate for blocks of size 2^( 2) =       0.000389391398
  error estimate for blocks of size 2^( 3) =       0.000399881160
  error estimate for blocks of size 2^( 4) =       0.000407490247
  error estimate for blocks of size 2^( 5) =       0.000412841840
  error estimate for blocks of size 2^( 6) =       0.000414844332
  error estimate for blocks of size 2^( 7) =       0.000416458836

      target function =      -0.910962206019
              le_mean =     -17.214738250927
             les_mean =     296.648264103593
             stat err =       0.000412908813
             autocorr =       1.192221522779
   target nu stat err =       0.000412908813
   target dn stat err =       0.002944665098
      target stat err =       0.004621618342
              std dev =       0.534799105069
             le_variance =       0.286010082783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721473825093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910984702092       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910984702105       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910984702107       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910984702105       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910984702705       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910984710764       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910984694768       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910984704300       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910984694567       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910984710129       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+06 is 3.063290e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910984702092       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910984702095       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910984702096       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910984702096       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910984702106       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910984665352       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910984728796       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910984692919       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910984709842       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910984739256       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+07 is 7.658243e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910984702092       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910984702093       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910984702093       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910984702092       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910984715835       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910984690845       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910984573965       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910984826596       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910984517818       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910984601846       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+07 is 1.914550e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194537 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7062e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.168744
====================================================
  Execution time = 1.4126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9982e-01
  Total weights = 1.9573e+06
  Execution time = 1.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377933638
  error estimate for blocks of size 2^( 2) =       0.000389666442
  error estimate for blocks of size 2^( 3) =       0.000400073117
  error estimate for blocks of size 2^( 4) =       0.000407967147
  error estimate for blocks of size 2^( 5) =       0.000413591491
  error estimate for blocks of size 2^( 6) =       0.000416730523
  error estimate for blocks of size 2^( 7) =       0.000417849725

      target function =      -0.912869402886
              le_mean =     -17.214982776455
             les_mean =     296.655449508406
             stat err =       0.000414034722
             autocorr =       1.200169072473
   target nu stat err =       0.000414034722
   target dn stat err =       0.002968132561
      target stat err =       0.004679332725
              std dev =       0.534478876242
             le_variance =       0.285667669149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853493
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853493
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377933638
  error estimate for blocks of size 2^( 2) =       0.000389666442
  error estimate for blocks of size 2^( 3) =       0.000400073117
  error estimate for blocks of size 2^( 4) =       0.000407967147
  error estimate for blocks of size 2^( 5) =       0.000413591491
  error estimate for blocks of size 2^( 6) =       0.000416730523
  error estimate for blocks of size 2^( 7) =       0.000417849725

      target function =      -0.912869402674
              le_mean =     -17.214982776454
             les_mean =     296.655449508529
             stat err =       0.000414034722
             autocorr =       1.200169072482
   target nu stat err =       0.000414034722
   target dn stat err =       0.002968132631
      target stat err =       0.004679332831
              std dev =       0.534478876243
             le_variance =       0.285667669150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377933638
  error estimate for blocks of size 2^( 2) =       0.000389666442
  error estimate for blocks of size 2^( 3) =       0.000400073117
  error estimate for blocks of size 2^( 4) =       0.000407967147
  error estimate for blocks of size 2^( 5) =       0.000413591491
  error estimate for blocks of size 2^( 6) =       0.000416730523
  error estimate for blocks of size 2^( 7) =       0.000417849725

      target function =      -0.912869402780
              le_mean =     -17.214982776454
             les_mean =     296.655449508467
             stat err =       0.000414034722
             autocorr =       1.200169072476
   target nu stat err =       0.000414034722
   target dn stat err =       0.002968132596
      target stat err =       0.004679332778
              std dev =       0.534478876243
             le_variance =       0.285667669150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285670853492
                                         uncertainty =       0.001871237892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377933638
  error estimate for blocks of size 2^( 2) =       0.000389666442
  error estimate for blocks of size 2^( 3) =       0.000400073117
  error estimate for blocks of size 2^( 4) =       0.000407967147
  error estimate for blocks of size 2^( 5) =       0.000413591491
  error estimate for blocks of size 2^( 6) =       0.000416730523
  error estimate for blocks of size 2^( 7) =       0.000417849725

      target function =      -0.912869402873
              le_mean =     -17.214982776455
             les_mean =     296.655449508414
             stat err =       0.000414034722
             autocorr =       1.200169072474
   target nu stat err =       0.000414034722
   target dn stat err =       0.002968132565
      target stat err =       0.004679332732
              std dev =       0.534478876242
             le_variance =       0.285667669149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912869402886        initial  <--
     5.9605e+06     5.9605e+07             3.0633e-11        -0.912869402674
     2.3842e+07     2.3842e+08             7.6582e-12        -0.912869402780
     9.5367e+07     9.5367e+08             1.9146e-12        -0.912869402873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3392
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2354
    reference variance = 0.171839
====================================================
  Execution time = 1.4744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9518e-01
  Total weights = 1.957794749e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284441066019
                                         uncertainty =       0.001439708425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284441066019
                                         uncertainty =       0.001439708425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377096821
  error estimate for blocks of size 2^( 2) =       0.000388552972
  error estimate for blocks of size 2^( 3) =       0.000399060498
  error estimate for blocks of size 2^( 4) =       0.000406438557
  error estimate for blocks of size 2^( 5) =       0.000410876481
  error estimate for blocks of size 2^( 6) =       0.000414238047
  error estimate for blocks of size 2^( 7) =       0.000416147539

      target function =      -0.920167639084
              le_mean =     -17.215228087760
             les_mean =     296.659254316876
             stat err =       0.000411925156
             autocorr =       1.193248477319
   target nu stat err =       0.000411925156
   target dn stat err =       0.001869238792
      target stat err =       0.003044899816
              std dev =       0.533295437909
             le_variance =       0.284404024094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522808776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920176815518       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920176815519       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920176815519       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920176815519       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920176793425       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920176815519       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920176757866       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920176740648       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920176742566       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 2.194125e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920176815518       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920176815518       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920176815518       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920176888376       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920176815518       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920176699816       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920176494637       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920176957195       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920176901472       residual = 8.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 5.485199e-13

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920176815518       residual = 4.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920176815518       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920176815518       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920176815518       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920176404938       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920176815518       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920175203886       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920176144986       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920177481470       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+08 is 1.371275e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7214e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.3042
    reference variance = 0.172612
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0284e-01
  Total weights = 1.9577e+06
  Execution time = 1.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380539936
  error estimate for blocks of size 2^( 2) =       0.000392047403
  error estimate for blocks of size 2^( 3) =       0.000402303803
  error estimate for blocks of size 2^( 4) =       0.000410125372
  error estimate for blocks of size 2^( 5) =       0.000415583863
  error estimate for blocks of size 2^( 6) =       0.000416586729
  error estimate for blocks of size 2^( 7) =       0.000420054105

      target function =      -0.908166439430
              le_mean =     -17.214989842072
             les_mean =     296.658719565686
             stat err =       0.000415587517
             autocorr =       1.192681568544
   target nu stat err =       0.000415587517
   target dn stat err =       0.003552811143
      target stat err =       0.005525322032
              std dev =       0.538164738067
             le_variance =       0.289621285299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380539936
  error estimate for blocks of size 2^( 2) =       0.000392047403
  error estimate for blocks of size 2^( 3) =       0.000402303803
  error estimate for blocks of size 2^( 4) =       0.000410125372
  error estimate for blocks of size 2^( 5) =       0.000415583863
  error estimate for blocks of size 2^( 6) =       0.000416586729
  error estimate for blocks of size 2^( 7) =       0.000420054105

      target function =      -0.908166439430
              le_mean =     -17.214989842072
             les_mean =     296.658719565686
             stat err =       0.000415587517
             autocorr =       1.192681568537
   target nu stat err =       0.000415587517
   target dn stat err =       0.003552811143
      target stat err =       0.005525322033
              std dev =       0.538164738067
             le_variance =       0.289621285298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380539936
  error estimate for blocks of size 2^( 2) =       0.000392047403
  error estimate for blocks of size 2^( 3) =       0.000402303803
  error estimate for blocks of size 2^( 4) =       0.000410125372
  error estimate for blocks of size 2^( 5) =       0.000415583863
  error estimate for blocks of size 2^( 6) =       0.000416586729
  error estimate for blocks of size 2^( 7) =       0.000420054105

      target function =      -0.908166439430
              le_mean =     -17.214989842072
             les_mean =     296.658719565686
             stat err =       0.000415587517
             autocorr =       1.192681568532
   target nu stat err =       0.000415587517
   target dn stat err =       0.003552811143
      target stat err =       0.005525322032
              std dev =       0.538164738067
             le_variance =       0.289621285299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289642107185
                                         uncertainty =       0.002427881050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380539936
  error estimate for blocks of size 2^( 2) =       0.000392047403
  error estimate for blocks of size 2^( 3) =       0.000402303803
  error estimate for blocks of size 2^( 4) =       0.000410125372
  error estimate for blocks of size 2^( 5) =       0.000415583863
  error estimate for blocks of size 2^( 6) =       0.000416586729
  error estimate for blocks of size 2^( 7) =       0.000420054105

      target function =      -0.908166439430
              le_mean =     -17.214989842072
             les_mean =     296.658719565686
             stat err =       0.000415587517
             autocorr =       1.192681568538
   target nu stat err =       0.000415587517
   target dn stat err =       0.003552811143
      target stat err =       0.005525322032
              std dev =       0.538164738067
             le_variance =       0.289621285299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908166439430        initial
     5.9605e+07     5.9605e+08             2.1941e-12        -0.908166439430  <--
     2.3842e+08     2.3842e+09             5.4852e-13        -0.908166439430
     9.5367e+08     9.5367e+09             1.3713e-13        -0.908166439430

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 2.3469e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.277648
====================================================
  Execution time = 1.4578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0816e-01
  Total weights = 1.957820896e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290663881004
                                         uncertainty =       0.002647089240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290663881004
                                         uncertainty =       0.002647089240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381202483
  error estimate for blocks of size 2^( 2) =       0.000392572533
  error estimate for blocks of size 2^( 3) =       0.000403028088
  error estimate for blocks of size 2^( 4) =       0.000410737891
  error estimate for blocks of size 2^( 5) =       0.000415889429
  error estimate for blocks of size 2^( 6) =       0.000419128370
  error estimate for blocks of size 2^( 7) =       0.000421968833

      target function =      -0.899978133777
              le_mean =     -17.214945831708
             les_mean =     296.662524767377
             stat err =       0.000416931131
             autocorr =       1.196236929256
   target nu stat err =       0.000416931131
   target dn stat err =       0.005965580545
      target stat err =       0.009063502845
              std dev =       0.539101721369
             le_variance =       0.290630665983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721494583171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900068580494       residual = 9.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900068580513       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900068580515       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900068580515       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900068583602       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900068550440       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900068584435       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900068605352       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900068560381       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900068601690       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 2.166420e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900068580494       residual = 9.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900068580499       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900068580499       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900068580499       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900068581677       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900068488650       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900068635339       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900068591382       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900068574892       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900068585590       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 5.416063e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900068580494       residual = 9.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900068580495       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900068580495       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900068621721       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900068663190       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900068678355       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900068279480       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900068393825       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900069219273       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900069401041       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+08 is 1.353983e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0436e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1333
    reference variance = 0.221577
====================================================
  Execution time = 1.4425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9909e-01
  Total weights = 1.9575e+06
  Execution time = 1.8322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377737001
  error estimate for blocks of size 2^( 2) =       0.000389228310
  error estimate for blocks of size 2^( 3) =       0.000399590735
  error estimate for blocks of size 2^( 4) =       0.000407249868
  error estimate for blocks of size 2^( 5) =       0.000413510680
  error estimate for blocks of size 2^( 6) =       0.000415355477
  error estimate for blocks of size 2^( 7) =       0.000416365441

      target function =      -0.914031832011
              le_mean =     -17.214478200067
             les_mean =     296.637350226219
             stat err =       0.000413120366
             autocorr =       1.196118357479
   target nu stat err =       0.000413120366
   target dn stat err =       0.002329923017
      target stat err =       0.003704614309
              std dev =       0.534200789740
             le_variance =       0.285370483759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377737001
  error estimate for blocks of size 2^( 2) =       0.000389228310
  error estimate for blocks of size 2^( 3) =       0.000399590735
  error estimate for blocks of size 2^( 4) =       0.000407249868
  error estimate for blocks of size 2^( 5) =       0.000413510680
  error estimate for blocks of size 2^( 6) =       0.000415355477
  error estimate for blocks of size 2^( 7) =       0.000416365441

      target function =      -0.914031832036
              le_mean =     -17.214478200067
             les_mean =     296.637350226205
             stat err =       0.000413120366
             autocorr =       1.196118357487
   target nu stat err =       0.000413120366
   target dn stat err =       0.002329923016
      target stat err =       0.003704614309
              std dev =       0.534200789740
             le_variance =       0.285370483759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377737001
  error estimate for blocks of size 2^( 2) =       0.000389228310
  error estimate for blocks of size 2^( 3) =       0.000399590735
  error estimate for blocks of size 2^( 4) =       0.000407249868
  error estimate for blocks of size 2^( 5) =       0.000413510680
  error estimate for blocks of size 2^( 6) =       0.000415355477
  error estimate for blocks of size 2^( 7) =       0.000416365441

      target function =      -0.914031832023
              le_mean =     -17.214478200067
             les_mean =     296.637350226212
             stat err =       0.000413120366
             autocorr =       1.196118357486
   target nu stat err =       0.000413120366
   target dn stat err =       0.002329923016
      target stat err =       0.003704614309
              std dev =       0.534200789740
             le_variance =       0.285370483759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285315825631
                                         uncertainty =       0.001764310433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377737001
  error estimate for blocks of size 2^( 2) =       0.000389228310
  error estimate for blocks of size 2^( 3) =       0.000399590735
  error estimate for blocks of size 2^( 4) =       0.000407249868
  error estimate for blocks of size 2^( 5) =       0.000413510680
  error estimate for blocks of size 2^( 6) =       0.000415355477
  error estimate for blocks of size 2^( 7) =       0.000416365441

      target function =      -0.914031832012
              le_mean =     -17.214478200067
             les_mean =     296.637350226218
             stat err =       0.000413120366
             autocorr =       1.196118357481
   target nu stat err =       0.000413120366
   target dn stat err =       0.002329923017
      target stat err =       0.003704614309
              std dev =       0.534200789740
             le_variance =       0.285370483759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914031832011        initial
     1.4901e+07     1.4901e+08             2.1664e-11        -0.914031832036  <--
     5.9605e+07     5.9605e+08             5.4161e-12        -0.914031832023
     2.3842e+08     2.3842e+09             1.3540e-12        -0.914031832012

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.3676e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.386379
====================================================
  Execution time = 1.4893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0144e-01
  Total weights = 1.957640095e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288202465645
                                         uncertainty =       0.002075257830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288202465645
                                         uncertainty =       0.002075257830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379620611
  error estimate for blocks of size 2^( 2) =       0.000390899814
  error estimate for blocks of size 2^( 3) =       0.000401643477
  error estimate for blocks of size 2^( 4) =       0.000410015585
  error estimate for blocks of size 2^( 5) =       0.000415313777
  error estimate for blocks of size 2^( 6) =       0.000418081834
  error estimate for blocks of size 2^( 7) =       0.000419144341

      target function =      -0.910404198824
              le_mean =     -17.213853608120
             les_mean =     296.618191288837
             stat err =       0.000415638884
             autocorr =       1.198761462606
   target nu stat err =       0.000415638884
   target dn stat err =       0.002991233774
      target stat err =       0.004680305732
              std dev =       0.536864616694
             le_variance =       0.288223616658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721385360812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910426858566       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910426858586       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910426858588       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910426858589       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910426862243       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910426861035       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910426856692       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910426860918       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910426861023       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910426857086       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 4.863893e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910426858566       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910426858571       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910426858572       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910426858572       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910426856808       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910426858572       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910426858572       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910426831568       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910426865104       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910426898114       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 1.215974e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910426858566       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910426858568       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910426858568       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910426858569       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910426856686       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910426758353       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910426782082       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910426859037       residual = 7.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910427081849       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910426861375       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+07 is 3.039920e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7380e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.256
    reference variance = 0.271106
====================================================
  Execution time = 1.4240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0090e-01
  Total weights = 1.9577e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853069
                                         uncertainty =       0.002241163176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853069
                                         uncertainty =       0.002241163176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379695065
  error estimate for blocks of size 2^( 2) =       0.000390935654
  error estimate for blocks of size 2^( 3) =       0.000401250965
  error estimate for blocks of size 2^( 4) =       0.000408601871
  error estimate for blocks of size 2^( 5) =       0.000413149167
  error estimate for blocks of size 2^( 6) =       0.000415722726
  error estimate for blocks of size 2^( 7) =       0.000417983165

      target function =      -0.911201562869
              le_mean =     -17.214555544076
             les_mean =     296.641823113239
             stat err =       0.000413864232
             autocorr =       1.188080543095
   target nu stat err =       0.000413864232
   target dn stat err =       0.003055668992
      target stat err =       0.004792980494
              std dev =       0.536969911153
             le_variance =       0.288336685484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853049
                                         uncertainty =       0.002241163170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853049
                                         uncertainty =       0.002241163170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379695065
  error estimate for blocks of size 2^( 2) =       0.000390935654
  error estimate for blocks of size 2^( 3) =       0.000401250965
  error estimate for blocks of size 2^( 4) =       0.000408601871
  error estimate for blocks of size 2^( 5) =       0.000413149167
  error estimate for blocks of size 2^( 6) =       0.000415722726
  error estimate for blocks of size 2^( 7) =       0.000417983165

      target function =      -0.911201562933
              le_mean =     -17.214555544075
             les_mean =     296.641823113174
             stat err =       0.000413864232
             autocorr =       1.188080543147
   target nu stat err =       0.000413864232
   target dn stat err =       0.003055668981
      target stat err =       0.004792980479
              std dev =       0.536969911134
             le_variance =       0.288336685463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853059
                                         uncertainty =       0.002241163173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853059
                                         uncertainty =       0.002241163173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379695065
  error estimate for blocks of size 2^( 2) =       0.000390935654
  error estimate for blocks of size 2^( 3) =       0.000401250965
  error estimate for blocks of size 2^( 4) =       0.000408601871
  error estimate for blocks of size 2^( 5) =       0.000413149167
  error estimate for blocks of size 2^( 6) =       0.000415722726
  error estimate for blocks of size 2^( 7) =       0.000417983165

      target function =      -0.911201562901
              le_mean =     -17.214555544075
             les_mean =     296.641823113207
             stat err =       0.000413864232
             autocorr =       1.188080543118
   target nu stat err =       0.000413864232
   target dn stat err =       0.003055668986
      target stat err =       0.004792980486
              std dev =       0.536969911143
             le_variance =       0.288336685473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853068
                                         uncertainty =       0.002241163176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393853068
                                         uncertainty =       0.002241163176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379695065
  error estimate for blocks of size 2^( 2) =       0.000390935654
  error estimate for blocks of size 2^( 3) =       0.000401250965
  error estimate for blocks of size 2^( 4) =       0.000408601871
  error estimate for blocks of size 2^( 5) =       0.000413149167
  error estimate for blocks of size 2^( 6) =       0.000415722726
  error estimate for blocks of size 2^( 7) =       0.000417983165

      target function =      -0.911201562873
              le_mean =     -17.214555544076
             les_mean =     296.641823113235
             stat err =       0.000413864232
             autocorr =       1.188080543098
   target nu stat err =       0.000413864232
   target dn stat err =       0.003055668991
      target stat err =       0.004792980493
              std dev =       0.536969911152
             le_variance =       0.288336685482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911201562869        initial
     3.7253e+06     3.7253e+07             4.8639e-11        -0.911201562933  <--
     1.4901e+07     1.4901e+08             1.2160e-11        -0.911201562901
     5.9605e+07     5.9605e+08             3.0399e-12        -0.911201562873

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 2.3497e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.447322
====================================================
  Execution time = 1.4535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9772e-01
  Total weights = 1.957853913e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284633545114
                                         uncertainty =       0.001340450176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284633545114
                                         uncertainty =       0.001340450176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377223519
  error estimate for blocks of size 2^( 2) =       0.000388153217
  error estimate for blocks of size 2^( 3) =       0.000398522267
  error estimate for blocks of size 2^( 4) =       0.000406871771
  error estimate for blocks of size 2^( 5) =       0.000412223891
  error estimate for blocks of size 2^( 6) =       0.000415450187
  error estimate for blocks of size 2^( 7) =       0.000417022290

      target function =      -0.916200970052
              le_mean =     -17.213828687406
             les_mean =     296.613616933436
             stat err =       0.000412892035
             autocorr =       1.198051498188
   target nu stat err =       0.000412892035
   target dn stat err =       0.002125856486
      target stat err =       0.003404006604
              std dev =       0.533474616091
             le_variance =       0.284595166014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721382868741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916212675824       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916212675860       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916212675866       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916212675867       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916212675868       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916212675868       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916212675868       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916212675868       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916212675868       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916212675868       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 1.827733e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916212675824       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916212675833       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916212675834       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916212675834       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916212675835       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916212675835       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916212675835       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916212675835       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916212675835       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916212675835       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 4.569333e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916212675824       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916212675826       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916212675826       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916212675826       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916212689429       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916212675826       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916212675826       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916212668078       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916212690921       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916212679647       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+07 is 1.142335e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7041e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1703
    reference variance = 0.400616
====================================================
  Execution time = 1.4295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9851e-01
  Total weights = 1.9581e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376945512
  error estimate for blocks of size 2^( 2) =       0.000388266690
  error estimate for blocks of size 2^( 3) =       0.000398642399
  error estimate for blocks of size 2^( 4) =       0.000406913258
  error estimate for blocks of size 2^( 5) =       0.000411407547
  error estimate for blocks of size 2^( 6) =       0.000413868509
  error estimate for blocks of size 2^( 7) =       0.000415236831

      target function =      -0.914933790884
              le_mean =     -17.214434279680
             les_mean =     296.635261083657
             stat err =       0.000411856536
             autocorr =       1.193808787105
   target nu stat err =       0.000411856536
   target dn stat err =       0.002414841798
      target stat err =       0.003841559817
              std dev =       0.533081455709
             le_variance =       0.284175838421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376945512
  error estimate for blocks of size 2^( 2) =       0.000388266690
  error estimate for blocks of size 2^( 3) =       0.000398642399
  error estimate for blocks of size 2^( 4) =       0.000406913258
  error estimate for blocks of size 2^( 5) =       0.000411407547
  error estimate for blocks of size 2^( 6) =       0.000413868509
  error estimate for blocks of size 2^( 7) =       0.000415236831

      target function =      -0.914933790944
              le_mean =     -17.214434279680
             les_mean =     296.635261083598
             stat err =       0.000411856536
             autocorr =       1.193808787189
   target nu stat err =       0.000411856536
   target dn stat err =       0.002414841805
      target stat err =       0.003841559827
              std dev =       0.533081455709
             le_variance =       0.284175838421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376945512
  error estimate for blocks of size 2^( 2) =       0.000388266690
  error estimate for blocks of size 2^( 3) =       0.000398642399
  error estimate for blocks of size 2^( 4) =       0.000406913258
  error estimate for blocks of size 2^( 5) =       0.000411407547
  error estimate for blocks of size 2^( 6) =       0.000413868509
  error estimate for blocks of size 2^( 7) =       0.000415236831

      target function =      -0.914933790914
              le_mean =     -17.214434279680
             les_mean =     296.635261083627
             stat err =       0.000411856536
             autocorr =       1.193808787147
   target nu stat err =       0.000411856536
   target dn stat err =       0.002414841801
      target stat err =       0.003841559822
              std dev =       0.533081455709
             le_variance =       0.284175838421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284161642230
                                         uncertainty =       0.001612946431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376945512
  error estimate for blocks of size 2^( 2) =       0.000388266690
  error estimate for blocks of size 2^( 3) =       0.000398642399
  error estimate for blocks of size 2^( 4) =       0.000406913258
  error estimate for blocks of size 2^( 5) =       0.000411407547
  error estimate for blocks of size 2^( 6) =       0.000413868509
  error estimate for blocks of size 2^( 7) =       0.000415236831

      target function =      -0.914933790887
              le_mean =     -17.214434279680
             les_mean =     296.635261083653
             stat err =       0.000411856536
             autocorr =       1.193808787107
   target nu stat err =       0.000411856536
   target dn stat err =       0.002414841798
      target stat err =       0.003841559817
              std dev =       0.533081455709
             le_variance =       0.284175838421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914933790884        initial
     9.3132e+05     9.3132e+06             1.8277e-10        -0.914933790944  <--
     3.7253e+06     3.7253e+07             4.5693e-11        -0.914933790914
     1.4901e+07     1.4901e+08             1.1423e-11        -0.914933790887

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.3558e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2396
    reference variance = 0.275403
====================================================
  Execution time = 1.4502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9662e-01
  Total weights = 1.957938664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284539539369
                                         uncertainty =       0.001573866950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284539539369
                                         uncertainty =       0.001573866950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377239791
  error estimate for blocks of size 2^( 2) =       0.000388546104
  error estimate for blocks of size 2^( 3) =       0.000398653582
  error estimate for blocks of size 2^( 4) =       0.000406053664
  error estimate for blocks of size 2^( 5) =       0.000411120298
  error estimate for blocks of size 2^( 6) =       0.000413097240
  error estimate for blocks of size 2^( 7) =       0.000414555731

      target function =      -0.917915146167
              le_mean =     -17.214402751117
             les_mean =     296.632278796831
             stat err =       0.000411206733
             autocorr =       1.188188772719
   target nu stat err =       0.000411206733
   target dn stat err =       0.002030574808
      target stat err =       0.003272942561
              std dev =       0.533497628304
             le_variance =       0.284619719405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721440275112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917925942808       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917925942889       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917925942902       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917925942908       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917925943150       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917925943097       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917925942762       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917925943385       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917925942908       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 4.230607e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917925942808       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917925942828       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917925942832       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917925942832       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917925942553       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917925942806       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917925942131       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917925943748       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917925942943       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 1.057651e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917925942808       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917925942813       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917925942814       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917925942818       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917925944180       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917925943167       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917925939969       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917925949991       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917925938358       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+06 is 2.644130e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7014e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758502e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204466e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2659
    reference variance = 0.343412
====================================================
  Execution time = 1.4487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9813e-01
  Total weights = 1.9579e+06
  Execution time = 1.8517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026516
                                         uncertainty =       0.002028276029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026516
                                         uncertainty =       0.002028276029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378923922
  error estimate for blocks of size 2^( 2) =       0.000390329630
  error estimate for blocks of size 2^( 3) =       0.000400173186
  error estimate for blocks of size 2^( 4) =       0.000407352315
  error estimate for blocks of size 2^( 5) =       0.000410709950
  error estimate for blocks of size 2^( 6) =       0.000414220656
  error estimate for blocks of size 2^( 7) =       0.000415666535

      target function =      -0.915514254387
              le_mean =     -17.214815922574
             les_mean =     296.648018967053
             stat err =       0.000411987364
             autocorr =       1.182125934085
   target nu stat err =       0.000411987364
   target dn stat err =       0.002583489541
      target stat err =       0.004109235809
              std dev =       0.535879348931
             le_variance =       0.287166676611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026458
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026458
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378923921
  error estimate for blocks of size 2^( 2) =       0.000390329630
  error estimate for blocks of size 2^( 3) =       0.000400173186
  error estimate for blocks of size 2^( 4) =       0.000407352315
  error estimate for blocks of size 2^( 5) =       0.000410709950
  error estimate for blocks of size 2^( 6) =       0.000414220656
  error estimate for blocks of size 2^( 7) =       0.000415666535

      target function =      -0.915514254490
              le_mean =     -17.214815922578
             les_mean =     296.648018967127
             stat err =       0.000411987364
             autocorr =       1.182125934144
   target nu stat err =       0.000411987364
   target dn stat err =       0.002583489548
      target stat err =       0.004109235821
              std dev =       0.535879348877
             le_variance =       0.287166676552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026487
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026487
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378923922
  error estimate for blocks of size 2^( 2) =       0.000390329630
  error estimate for blocks of size 2^( 3) =       0.000400173186
  error estimate for blocks of size 2^( 4) =       0.000407352315
  error estimate for blocks of size 2^( 5) =       0.000410709950
  error estimate for blocks of size 2^( 6) =       0.000414220656
  error estimate for blocks of size 2^( 7) =       0.000415666535

      target function =      -0.915514254439
              le_mean =     -17.214815922576
             les_mean =     296.648018967090
             stat err =       0.000411987364
             autocorr =       1.182125934112
   target nu stat err =       0.000411987364
   target dn stat err =       0.002583489545
      target stat err =       0.004109235815
              std dev =       0.535879348904
             le_variance =       0.287166676582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026512
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287212026512
                                         uncertainty =       0.002028276030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378923922
  error estimate for blocks of size 2^( 2) =       0.000390329630
  error estimate for blocks of size 2^( 3) =       0.000400173186
  error estimate for blocks of size 2^( 4) =       0.000407352315
  error estimate for blocks of size 2^( 5) =       0.000410709950
  error estimate for blocks of size 2^( 6) =       0.000414220656
  error estimate for blocks of size 2^( 7) =       0.000415666535

      target function =      -0.915514254394
              le_mean =     -17.214815922574
             les_mean =     296.648018967058
             stat err =       0.000411987364
             autocorr =       1.182125934083
   target nu stat err =       0.000411987364
   target dn stat err =       0.002583489542
      target stat err =       0.004109235810
              std dev =       0.535879348928
             le_variance =       0.287166676608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915514254387        initial
     2.3283e+05     2.3283e+06             4.2306e-10        -0.915514254490  <--
     9.3132e+05     9.3132e+06             1.0577e-10        -0.915514254439
     3.7253e+06     3.7253e+07             2.6441e-11        -0.915514254394

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.3835e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758502e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080597e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362251e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204465e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645587e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816608e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0859e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.324811
====================================================
  Execution time = 1.4619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9920e-01
  Total weights = 1.957655048e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286742618933
                                         uncertainty =       0.001481225544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286742618933
                                         uncertainty =       0.001481225544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378709399
  error estimate for blocks of size 2^( 2) =       0.000390101931
  error estimate for blocks of size 2^( 3) =       0.000400428321
  error estimate for blocks of size 2^( 4) =       0.000408528359
  error estimate for blocks of size 2^( 5) =       0.000413895244
  error estimate for blocks of size 2^( 6) =       0.000417574323
  error estimate for blocks of size 2^( 7) =       0.000419055409

      target function =      -0.913862176554
              le_mean =     -17.214679761549
             les_mean =     296.644394868438
             stat err =       0.000414763334
             autocorr =       1.199467667932
   target nu stat err =       0.000414763334
   target dn stat err =       0.002177419367
      target stat err =       0.003471831071
              std dev =       0.535575967843
             le_variance =       0.286841617331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721467976155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913874367467       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913874368164       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913874368261       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913874368290       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913874368278       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913874368333       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913874368287       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913874368190       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913874368356       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 2.803753e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913874367467       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913874367641       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913874367666       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913874367673       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913874367275       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913874367674       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913874367677       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913874367295       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913874367919       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 7.009388e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913874367467       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913874367511       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913874367517       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913874367517       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913874368086       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913874368342       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913874368823       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913874367519       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913874367128       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 1.752347e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7136e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873657e-03 3 1  ON 9
ci_011                -9.143509e-03 3 1  ON 10
ci_012                -9.120854e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259342e-03 3 1  ON 21
ci_023                 8.362250e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594816e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639937e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563700e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554126e-03 3 1  ON 32
ci_034                 4.916112e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204464e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870351e-03 3 1  ON 44
ci_046                 4.771529e-03 3 1  ON 45
ci_047                 4.645587e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816609e-03 3 1  ON 50
ci_052                -2.275526e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374654e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181152e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.295302
====================================================
  Execution time = 1.4224e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1009e-01
  Total weights = 1.9577e+06
  Execution time = 1.8487e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654970052
                                         uncertainty =       0.004420431155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654970052
                                         uncertainty =       0.004420431155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379893527
  error estimate for blocks of size 2^( 2) =       0.000391094001
  error estimate for blocks of size 2^( 3) =       0.000401437062
  error estimate for blocks of size 2^( 4) =       0.000409115924
  error estimate for blocks of size 2^( 5) =       0.000413026229
  error estimate for blocks of size 2^( 6) =       0.000415448856
  error estimate for blocks of size 2^( 7) =       0.000417232539

      target function =      -0.896566781823
              le_mean =     -17.215083792440
             les_mean =     296.669199030090
             stat err =       0.000413705887
             autocorr =       1.185931527210
   target nu stat err =       0.000413705887
   target dn stat err =       0.015281932105
      target stat err =       0.023002118599
              std dev =       0.537250577815
             le_variance =       0.288638183363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654966581
                                         uncertainty =       0.004420428127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654966581
                                         uncertainty =       0.004420428127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379893524
  error estimate for blocks of size 2^( 2) =       0.000391093999
  error estimate for blocks of size 2^( 3) =       0.000401437060
  error estimate for blocks of size 2^( 4) =       0.000409115922
  error estimate for blocks of size 2^( 5) =       0.000413026227
  error estimate for blocks of size 2^( 6) =       0.000415448854
  error estimate for blocks of size 2^( 7) =       0.000417232537

      target function =      -0.896566799033
              le_mean =     -17.215083792492
             les_mean =     296.669199021066
             stat err =       0.000413705885
             autocorr =       1.185931530056
   target nu stat err =       0.000413705885
   target dn stat err =       0.015281920122
      target stat err =       0.023002101440
              std dev =       0.537250574592
             le_variance =       0.288638179900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654968316
                                         uncertainty =       0.004420429641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654968316
                                         uncertainty =       0.004420429641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379893526
  error estimate for blocks of size 2^( 2) =       0.000391094000
  error estimate for blocks of size 2^( 3) =       0.000401437061
  error estimate for blocks of size 2^( 4) =       0.000409115923
  error estimate for blocks of size 2^( 5) =       0.000413026228
  error estimate for blocks of size 2^( 6) =       0.000415448855
  error estimate for blocks of size 2^( 7) =       0.000417232538

      target function =      -0.896566790428
              le_mean =     -17.215083792466
             les_mean =     296.669199025578
             stat err =       0.000413705886
             autocorr =       1.185931528637
   target nu stat err =       0.000413705886
   target dn stat err =       0.015281926113
      target stat err =       0.023002110020
              std dev =       0.537250576204
             le_variance =       0.288638181631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654969835
                                         uncertainty =       0.004420430966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654969835
                                         uncertainty =       0.004420430966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379893527
  error estimate for blocks of size 2^( 2) =       0.000391094001
  error estimate for blocks of size 2^( 3) =       0.000401437062
  error estimate for blocks of size 2^( 4) =       0.000409115924
  error estimate for blocks of size 2^( 5) =       0.000413026229
  error estimate for blocks of size 2^( 6) =       0.000415448856
  error estimate for blocks of size 2^( 7) =       0.000417232538

      target function =      -0.896566782898
              le_mean =     -17.215083792443
             les_mean =     296.669199029526
             stat err =       0.000413705887
             autocorr =       1.185931527380
   target nu stat err =       0.000413705887
   target dn stat err =       0.015281931356
      target stat err =       0.023002117527
              std dev =       0.537250577614
             le_variance =       0.288638183147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896566781823        initial
     5.8208e+04     5.8208e+05             2.8038e-09        -0.896566799033  <--
     2.3283e+05     2.3283e+06             7.0094e-10        -0.896566790428
     9.3132e+05     9.3132e+06             1.7523e-10        -0.896566782898

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.3545e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -3.762732e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873656e-03 3 1  ON 9
ci_011                -9.143507e-03 3 1  ON 10
ci_012                -9.120853e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259343e-03 3 1  ON 21
ci_023                 8.362250e-03 3 1  ON 22
ci_024                 8.583316e-03 3 1  ON 23
ci_025                 8.594814e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639938e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796778e-03 3 1  ON 29
ci_031                -8.563699e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554125e-03 3 1  ON 32
ci_034                 4.916111e-03 3 1  ON 33
ci_035                -3.348258e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204461e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255430e-03 3 1  ON 41
ci_043                -2.385828e-03 3 1  ON 42
ci_044                -3.920810e-03 3 1  ON 43
ci_045                -1.870352e-03 3 1  ON 44
ci_046                 4.771528e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242674e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816610e-03 3 1  ON 50
ci_052                -2.275527e-03 3 1  ON 51
ci_053                -2.209119e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374654e-03 3 1  ON 54
ci_056                 4.660671e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045438e-03 3 1  ON 57
ci_059                -2.118448e-03 3 1  ON 58
ci_060                 4.733450e-03 3 1  ON 59
ci_061                 5.181153e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781460e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397980e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398050e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1584
    reference variance = 0.157237
====================================================
  Execution time = 1.4628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9830e-01
  Total weights = 1.957738280e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286377640162
                                         uncertainty =       0.001829342587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286377640162
                                         uncertainty =       0.001829342587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378408104
  error estimate for blocks of size 2^( 2) =       0.000389657904
  error estimate for blocks of size 2^( 3) =       0.000400116825
  error estimate for blocks of size 2^( 4) =       0.000407423385
  error estimate for blocks of size 2^( 5) =       0.000410949307
  error estimate for blocks of size 2^( 6) =       0.000414577215
  error estimate for blocks of size 2^( 7) =       0.000416890802

      target function =      -0.915268232182
              le_mean =     -17.214454177976
             les_mean =     296.635732140150
             stat err =       0.000412460177
             autocorr =       1.188073175217
   target nu stat err =       0.000412460177
   target dn stat err =       0.002391469440
      target stat err =       0.003808699679
              std dev =       0.535149872876
             le_variance =       0.286385386439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721445417798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915283105300       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915283107909       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915283108266       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915283108376       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915283108382       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915283108388       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915283108387       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915283108397       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915283108383       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.118565e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915283105300       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915283105952       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915283106042       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915283106069       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915283106035       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915283106055       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915283106077       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915283105990       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915283106051       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 2.796422e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915283105300       residual = 9.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915283105463       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915283105485       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915283105492       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915283105570       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915283105451       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915283105298       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915283105620       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915283105497       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 6.991060e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7136e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -3.762731e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847839e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873655e-03 3 1  ON 9
ci_011                -9.143507e-03 3 1  ON 10
ci_012                -9.120852e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080596e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259343e-03 3 1  ON 21
ci_023                 8.362250e-03 3 1  ON 22
ci_024                 8.583315e-03 3 1  ON 23
ci_025                 8.594812e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639939e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796777e-03 3 1  ON 29
ci_031                -8.563699e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554125e-03 3 1  ON 32
ci_034                 4.916111e-03 3 1  ON 33
ci_035                -3.348257e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204463e-04 3 1  ON 37
ci_039                 1.223714e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179810e-03 3 1  ON 40
ci_042                 8.255428e-03 3 1  ON 41
ci_043                -2.385827e-03 3 1  ON 42
ci_044                -3.920807e-03 3 1  ON 43
ci_045                -1.870352e-03 3 1  ON 44
ci_046                 4.771528e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242675e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824146e-03 3 1  ON 49
ci_051                 2.816611e-03 3 1  ON 50
ci_052                -2.275527e-03 3 1  ON 51
ci_053                -2.209121e-03 3 1  ON 52
ci_054                -2.321352e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660670e-03 3 1  ON 55
ci_057                 4.675424e-03 3 1  ON 56
ci_058                -2.045438e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181150e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781459e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063103e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398052e-03 3 1  ON 67
ci_069                -4.114757e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2479
    reference variance = 0.291643
====================================================
  Execution time = 1.4303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9574e-01
  Total weights = 1.9575e+06
  Execution time = 1.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629176832
                                         uncertainty =       0.001575337018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629176832
                                         uncertainty =       0.001575337018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377231276
  error estimate for blocks of size 2^( 2) =       0.000388693217
  error estimate for blocks of size 2^( 3) =       0.000399097787
  error estimate for blocks of size 2^( 4) =       0.000406827852
  error estimate for blocks of size 2^( 5) =       0.000411585324
  error estimate for blocks of size 2^( 6) =       0.000414674078
  error estimate for blocks of size 2^( 7) =       0.000416750321

      target function =      -0.919250857404
              le_mean =     -17.215828029207
             les_mean =     296.680477683798
             stat err =       0.000412459394
             autocorr =       1.195492931275
   target nu stat err =       0.000412459394
   target dn stat err =       0.002005756689
      target stat err =       0.003253134349
              std dev =       0.533485586876
             le_variance =       0.284606871404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629175078
                                         uncertainty =       0.001575336980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629175078
                                         uncertainty =       0.001575336980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377231275
  error estimate for blocks of size 2^( 2) =       0.000388693217
  error estimate for blocks of size 2^( 3) =       0.000399097786
  error estimate for blocks of size 2^( 4) =       0.000406827853
  error estimate for blocks of size 2^( 5) =       0.000411585324
  error estimate for blocks of size 2^( 6) =       0.000414674078
  error estimate for blocks of size 2^( 7) =       0.000416750321

      target function =      -0.919250860937
              le_mean =     -17.215828029209
             les_mean =     296.680477681662
             stat err =       0.000412459394
             autocorr =       1.195492940420
   target nu stat err =       0.000412459394
   target dn stat err =       0.002005756371
      target stat err =       0.003253133883
              std dev =       0.533485585237
             le_variance =       0.284606869656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629175955
                                         uncertainty =       0.001575336999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629175955
                                         uncertainty =       0.001575336999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377231276
  error estimate for blocks of size 2^( 2) =       0.000388693217
  error estimate for blocks of size 2^( 3) =       0.000399097786
  error estimate for blocks of size 2^( 4) =       0.000406827853
  error estimate for blocks of size 2^( 5) =       0.000411585324
  error estimate for blocks of size 2^( 6) =       0.000414674078
  error estimate for blocks of size 2^( 7) =       0.000416750321

      target function =      -0.919250859171
              le_mean =     -17.215828029208
             les_mean =     296.680477682730
             stat err =       0.000412459394
             autocorr =       1.195492935851
   target nu stat err =       0.000412459394
   target dn stat err =       0.002005756530
      target stat err =       0.003253134116
              std dev =       0.533485586057
             le_variance =       0.284606870530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629176722
                                         uncertainty =       0.001575337016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284629176722
                                         uncertainty =       0.001575337016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377231276
  error estimate for blocks of size 2^( 2) =       0.000388693217
  error estimate for blocks of size 2^( 3) =       0.000399097787
  error estimate for blocks of size 2^( 4) =       0.000406827853
  error estimate for blocks of size 2^( 5) =       0.000411585324
  error estimate for blocks of size 2^( 6) =       0.000414674078
  error estimate for blocks of size 2^( 7) =       0.000416750321

      target function =      -0.919250857625
              le_mean =     -17.215828029207
             les_mean =     296.680477683665
             stat err =       0.000412459394
             autocorr =       1.195492931844
   target nu stat err =       0.000412459394
   target dn stat err =       0.002005756669
      target stat err =       0.003253134320
              std dev =       0.533485586773
             le_variance =       0.284606871295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.919250857404        initial
     1.4552e+04     1.4552e+05             1.1186e-08        -0.919250860937  <--
     5.8208e+04     5.8208e+05             2.7964e-09        -0.919250859171
     2.3283e+05     2.3283e+06             6.9911e-10        -0.919250857625

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.3917e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -3.762731e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155787e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847838e-02 3 1  ON 6
ci_008                -7.758503e-03 3 1  ON 7
ci_009                -1.401885e-02 3 1  ON 8
ci_010                -8.873649e-03 3 1  ON 9
ci_011                -9.143507e-03 3 1  ON 10
ci_012                -9.120850e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080594e-03 3 1  ON 17
ci_019                 8.982492e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259345e-03 3 1  ON 21
ci_023                 8.362250e-03 3 1  ON 22
ci_024                 8.583312e-03 3 1  ON 23
ci_025                 8.594808e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639942e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.796774e-03 3 1  ON 29
ci_031                -8.563699e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554125e-03 3 1  ON 32
ci_034                 4.916111e-03 3 1  ON 33
ci_035                -3.348256e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204469e-04 3 1  ON 37
ci_039                 1.223713e-03 3 1  ON 38
ci_040                -1.603327e-03 3 1  ON 39
ci_041                 8.179808e-03 3 1  ON 40
ci_042                 8.255423e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920798e-03 3 1  ON 43
ci_045                -1.870352e-03 3 1  ON 44
ci_046                 4.771526e-03 3 1  ON 45
ci_047                 4.645588e-03 3 1  ON 46
ci_048                -1.242675e-02 3 1  ON 47
ci_049                -1.288171e-02 3 1  ON 48
ci_050                 2.824148e-03 3 1  ON 49
ci_051                 2.816614e-03 3 1  ON 50
ci_052                -2.275528e-03 3 1  ON 51
ci_053                -2.209125e-03 3 1  ON 52
ci_054                -2.321351e-03 3 1  ON 53
ci_055                -2.374655e-03 3 1  ON 54
ci_056                 4.660668e-03 3 1  ON 55
ci_057                 4.675423e-03 3 1  ON 56
ci_058                -2.045437e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733451e-03 3 1  ON 59
ci_061                 5.181144e-03 3 1  ON 60
ci_062                -2.828321e-03 3 1  ON 61
ci_063                -2.781458e-03 3 1  ON 62
ci_064                -2.213661e-03 3 1  ON 63
ci_065                -3.397979e-03 3 1  ON 64
ci_066                 4.063102e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398055e-03 3 1  ON 67
ci_069                -4.114756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1061e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.272646
====================================================
  Execution time = 1.3802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0165e-01
  Total weights = 1.957676970e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286113546783
                                         uncertainty =       0.001883347444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286113546783
                                         uncertainty =       0.001883347444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378270877
  error estimate for blocks of size 2^( 2) =       0.000389505987
  error estimate for blocks of size 2^( 3) =       0.000399702896
  error estimate for blocks of size 2^( 4) =       0.000407032233
  error estimate for blocks of size 2^( 5) =       0.000410401012
  error estimate for blocks of size 2^( 6) =       0.000412464218
  error estimate for blocks of size 2^( 7) =       0.000415615903

      target function =      -0.910039051763
              le_mean =     -17.214540194106
             les_mean =     296.642046779521
             stat err =       0.000411378342
             autocorr =       1.182706637201
   target nu stat err =       0.000411378342
   target dn stat err =       0.002929808019
      target stat err =       0.004587536317
              std dev =       0.534955804138
             le_variance =       0.286177712381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721454019411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910061164318       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910061173964       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910061176513       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910061177055       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910061177190       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910061177193       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910061177214       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910061177217       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910061177211       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910061177226       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 4.039627e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910061164318       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910061166730       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910061167367       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910061167503       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910061167534       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910061167527       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910061167547       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910061167545       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910061167556       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910061167523       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.009921e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910061164318       residual = 9.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910061164921       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910061165081       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910061165114       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910061165225       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910061165018       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910061165021       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910061165165       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910061165155       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910061165097       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 2.524812e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6313e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -3.762731e-02 3 1  ON 0
ci_002                -2.875846e-02 3 1  ON 1
ci_003                -2.367631e-02 3 1  ON 2
ci_004                 2.096187e-02 3 1  ON 3
ci_005                 2.155786e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847838e-02 3 1  ON 6
ci_008                -7.758500e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873647e-03 3 1  ON 9
ci_011                -9.143502e-03 3 1  ON 10
ci_012                -9.120845e-03 3 1  ON 11
ci_013                -1.923608e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103454e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080594e-03 3 1  ON 17
ci_019                 8.982493e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259344e-03 3 1  ON 21
ci_023                 8.362250e-03 3 1  ON 22
ci_024                 8.583305e-03 3 1  ON 23
ci_025                 8.594809e-03 3 1  ON 24
ci_026                 1.002874e-02 3 1  ON 25
ci_027                 9.639943e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.796769e-03 3 1  ON 29
ci_031                -8.563699e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554124e-03 3 1  ON 32
ci_034                 4.916101e-03 3 1  ON 33
ci_035                -3.348255e-03 3 1  ON 34
ci_036                -1.126159e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204482e-04 3 1  ON 37
ci_039                 1.223712e-03 3 1  ON 38
ci_040                -1.603329e-03 3 1  ON 39
ci_041                 8.179804e-03 3 1  ON 40
ci_042                 8.255427e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920796e-03 3 1  ON 43
ci_045                -1.870350e-03 3 1  ON 44
ci_046                 4.771525e-03 3 1  ON 45
ci_047                 4.645587e-03 3 1  ON 46
ci_048                -1.242676e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824152e-03 3 1  ON 49
ci_051                 2.816616e-03 3 1  ON 50
ci_052                -2.275524e-03 3 1  ON 51
ci_053                -2.209124e-03 3 1  ON 52
ci_054                -2.321349e-03 3 1  ON 53
ci_055                -2.374651e-03 3 1  ON 54
ci_056                 4.660668e-03 3 1  ON 55
ci_057                 4.675419e-03 3 1  ON 56
ci_058                -2.045436e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733454e-03 3 1  ON 59
ci_061                 5.181139e-03 3 1  ON 60
ci_062                -2.828319e-03 3 1  ON 61
ci_063                -2.781458e-03 3 1  ON 62
ci_064                -2.213664e-03 3 1  ON 63
ci_065                -3.397976e-03 3 1  ON 64
ci_066                 4.063102e-03 3 1  ON 65
ci_067                 4.160834e-03 3 1  ON 66
ci_068                -4.398056e-03 3 1  ON 67
ci_069                -4.114763e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2381
    reference variance = 0.253928
====================================================
  Execution time = 1.3582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0087e-01
  Total weights = 1.9576e+06
  Execution time = 1.8499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959010286
                                         uncertainty =       0.002165859830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959010286
                                         uncertainty =       0.002165859830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379433261
  error estimate for blocks of size 2^( 2) =       0.000390852889
  error estimate for blocks of size 2^( 3) =       0.000400879403
  error estimate for blocks of size 2^( 4) =       0.000407724502
  error estimate for blocks of size 2^( 5) =       0.000413258829
  error estimate for blocks of size 2^( 6) =       0.000417112947
  error estimate for blocks of size 2^( 7) =       0.000419228224

      target function =      -0.911242517962
              le_mean =     -17.214871349232
             les_mean =     296.652662332318
             stat err =       0.000414331126
             autocorr =       1.192406468982
   target nu stat err =       0.000414331126
   target dn stat err =       0.002932234584
      target stat err =       0.004606877738
              std dev =       0.536599663373
             le_variance =       0.287939198732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959004533
                                         uncertainty =       0.002165859895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959004533
                                         uncertainty =       0.002165859895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379433257
  error estimate for blocks of size 2^( 2) =       0.000390852888
  error estimate for blocks of size 2^( 3) =       0.000400879403
  error estimate for blocks of size 2^( 4) =       0.000407724504
  error estimate for blocks of size 2^( 5) =       0.000413258831
  error estimate for blocks of size 2^( 6) =       0.000417112948
  error estimate for blocks of size 2^( 7) =       0.000419228224

      target function =      -0.911242622589
              le_mean =     -17.214871349338
             les_mean =     296.652662268562
             stat err =       0.000414331127
             autocorr =       1.192406499524
   target nu stat err =       0.000414331127
   target dn stat err =       0.002932233665
      target stat err =       0.004606877374
              std dev =       0.536599657995
             le_variance =       0.287939192961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959007409
                                         uncertainty =       0.002165859863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959007409
                                         uncertainty =       0.002165859863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379433259
  error estimate for blocks of size 2^( 2) =       0.000390852888
  error estimate for blocks of size 2^( 3) =       0.000400879403
  error estimate for blocks of size 2^( 4) =       0.000407724503
  error estimate for blocks of size 2^( 5) =       0.000413258830
  error estimate for blocks of size 2^( 6) =       0.000417112948
  error estimate for blocks of size 2^( 7) =       0.000419228224

      target function =      -0.911242570292
              le_mean =     -17.214871349285
             les_mean =     296.652662300429
             stat err =       0.000414331126
             autocorr =       1.192406484246
   target nu stat err =       0.000414331126
   target dn stat err =       0.002932234125
      target stat err =       0.004606877556
              std dev =       0.536599660684
             le_variance =       0.287939195846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959009926
                                         uncertainty =       0.002165859835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287959009926
                                         uncertainty =       0.002165859835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379433261
  error estimate for blocks of size 2^( 2) =       0.000390852889
  error estimate for blocks of size 2^( 3) =       0.000400879403
  error estimate for blocks of size 2^( 4) =       0.000407724502
  error estimate for blocks of size 2^( 5) =       0.000413258829
  error estimate for blocks of size 2^( 6) =       0.000417112947
  error estimate for blocks of size 2^( 7) =       0.000419228224

      target function =      -0.911242524505
              le_mean =     -17.214871349239
             les_mean =     296.652662328331
             stat err =       0.000414331126
             autocorr =       1.192406470887
   target nu stat err =       0.000414331126
   target dn stat err =       0.002932234527
      target stat err =       0.004606877715
              std dev =       0.536599663037
             le_variance =       0.287939198371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911242517962        initial
     3.6380e+03     3.6380e+04             4.0396e-08        -0.911242622589  <--
     1.4552e+04     1.4552e+05             1.0099e-08        -0.911242570292
     5.8208e+04     5.8208e+05             2.5248e-09        -0.911242524505

*****************************************************************************
Applying the update for shift_i =   3.6380e+03     and shift_s =   3.6380e+04
*****************************************************************************

  Execution time = 2.2934e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -3.762730e-02 3 1  ON 0
ci_002                -2.875845e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096189e-02 3 1  ON 3
ci_005                 2.155783e-02 3 1  ON 4
ci_006                -1.849849e-02 3 1  ON 5
ci_007                -1.847838e-02 3 1  ON 6
ci_008                -7.758490e-03 3 1  ON 7
ci_009                -1.401886e-02 3 1  ON 8
ci_010                -8.873642e-03 3 1  ON 9
ci_011                -9.143488e-03 3 1  ON 10
ci_012                -9.120832e-03 3 1  ON 11
ci_013                -1.923609e-02 3 1  ON 12
ci_014                 1.117976e-02 3 1  ON 13
ci_015                 1.103452e-02 3 1  ON 14
ci_016                 1.597496e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080593e-03 3 1  ON 17
ci_019                 8.982497e-03 3 1  ON 18
ci_020                 1.506482e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259339e-03 3 1  ON 21
ci_023                 8.362249e-03 3 1  ON 22
ci_024                 8.583281e-03 3 1  ON 23
ci_025                 8.594811e-03 3 1  ON 24
ci_026                 1.002873e-02 3 1  ON 25
ci_027                 9.639945e-03 3 1  ON 26
ci_028                -1.462471e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.796756e-03 3 1  ON 29
ci_031                -8.563698e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554122e-03 3 1  ON 32
ci_034                 4.916071e-03 3 1  ON 33
ci_035                -3.348251e-03 3 1  ON 34
ci_036                -1.126160e-02 3 1  ON 35
ci_037                -1.150834e-02 3 1  ON 36
ci_038                 9.204521e-04 3 1  ON 37
ci_039                 1.223710e-03 3 1  ON 38
ci_040                -1.603333e-03 3 1  ON 39
ci_041                 8.179790e-03 3 1  ON 40
ci_042                 8.255439e-03 3 1  ON 41
ci_043                -2.385825e-03 3 1  ON 42
ci_044                -3.920791e-03 3 1  ON 43
ci_045                -1.870341e-03 3 1  ON 44
ci_046                 4.771524e-03 3 1  ON 45
ci_047                 4.645582e-03 3 1  ON 46
ci_048                -1.242678e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824165e-03 3 1  ON 49
ci_051                 2.816622e-03 3 1  ON 50
ci_052                -2.275512e-03 3 1  ON 51
ci_053                -2.209122e-03 3 1  ON 52
ci_054                -2.321343e-03 3 1  ON 53
ci_055                -2.374641e-03 3 1  ON 54
ci_056                 4.660666e-03 3 1  ON 55
ci_057                 4.675405e-03 3 1  ON 56
ci_058                -2.045433e-03 3 1  ON 57
ci_059                -2.118450e-03 3 1  ON 58
ci_060                 4.733462e-03 3 1  ON 59
ci_061                 5.181127e-03 3 1  ON 60
ci_062                -2.828314e-03 3 1  ON 61
ci_063                -2.781461e-03 3 1  ON 62
ci_064                -2.213672e-03 3 1  ON 63
ci_065                -3.397967e-03 3 1  ON 64
ci_066                 4.063101e-03 3 1  ON 65
ci_067                 4.160835e-03 3 1  ON 66
ci_068                -4.398057e-03 3 1  ON 67
ci_069                -4.114784e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9255e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.555429
====================================================
  Execution time = 1.3717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9945e-01
  Total weights = 1.957685370e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286462743983
                                         uncertainty =       0.001584898075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286462743983
                                         uncertainty =       0.001584898075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378513034
  error estimate for blocks of size 2^( 2) =       0.000389823106
  error estimate for blocks of size 2^( 3) =       0.000399856730
  error estimate for blocks of size 2^( 4) =       0.000406982182
  error estimate for blocks of size 2^( 5) =       0.000412619269
  error estimate for blocks of size 2^( 6) =       0.000415729914
  error estimate for blocks of size 2^( 7) =       0.000416859720

      target function =      -0.913477669337
              le_mean =     -17.214341134861
             les_mean =     296.632992014126
             stat err =       0.000413047771
             autocorr =       1.190800173708
   target nu stat err =       0.000413047771
   target dn stat err =       0.002025260676
      target stat err =       0.003234329984
              std dev =       0.535298265965
             le_variance =       0.286544233545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721434113486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913488186528       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913488220773       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913488225210       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913488226321       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913488226524       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913488226609       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913488226619       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913488226621       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913488226608       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913488226613       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.476751e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913488186528       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913488195090       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913488196199       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913488196477       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913488196527       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913488196547       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913488196551       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913488196549       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913488196551       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913488196551       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 3.692092e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913488186528       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913488188668       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913488188945       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913488189014       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913488189009       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913488189049       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913488189045       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913488189036       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913488189029       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913488189045       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 9.230362e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6217e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -3.762729e-02 3 1  ON 0
ci_002                -2.875844e-02 3 1  ON 1
ci_003                -2.367632e-02 3 1  ON 2
ci_004                 2.096188e-02 3 1  ON 3
ci_005                 2.155781e-02 3 1  ON 4
ci_006                -1.849850e-02 3 1  ON 5
ci_007                -1.847837e-02 3 1  ON 6
ci_008                -7.758499e-03 3 1  ON 7
ci_009                -1.401883e-02 3 1  ON 8
ci_010                -8.873605e-03 3 1  ON 9
ci_011                -9.143486e-03 3 1  ON 10
ci_012                -9.120818e-03 3 1  ON 11
ci_013                -1.923610e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103451e-02 3 1  ON 14
ci_016                 1.597495e-02 3 1  ON 15
ci_017                 1.566980e-02 3 1  ON 16
ci_018                 9.080595e-03 3 1  ON 17
ci_019                 8.982491e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259337e-03 3 1  ON 21
ci_023                 8.362263e-03 3 1  ON 22
ci_024                 8.583274e-03 3 1  ON 23
ci_025                 8.594818e-03 3 1  ON 24
ci_026                 1.002872e-02 3 1  ON 25
ci_027                 9.639956e-03 3 1  ON 26
ci_028                -1.462472e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.796762e-03 3 1  ON 29
ci_031                -8.563691e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554132e-03 3 1  ON 32
ci_034                 4.916073e-03 3 1  ON 33
ci_035                -3.348249e-03 3 1  ON 34
ci_036                -1.126162e-02 3 1  ON 35
ci_037                -1.150833e-02 3 1  ON 36
ci_038                 9.204431e-04 3 1  ON 37
ci_039                 1.223700e-03 3 1  ON 38
ci_040                -1.603328e-03 3 1  ON 39
ci_041                 8.179765e-03 3 1  ON 40
ci_042                 8.255415e-03 3 1  ON 41
ci_043                -2.385822e-03 3 1  ON 42
ci_044                -3.920797e-03 3 1  ON 43
ci_045                -1.870339e-03 3 1  ON 44
ci_046                 4.771513e-03 3 1  ON 45
ci_047                 4.645573e-03 3 1  ON 46
ci_048                -1.242676e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824167e-03 3 1  ON 49
ci_051                 2.816614e-03 3 1  ON 50
ci_052                -2.275517e-03 3 1  ON 51
ci_053                -2.209108e-03 3 1  ON 52
ci_054                -2.321326e-03 3 1  ON 53
ci_055                -2.374637e-03 3 1  ON 54
ci_056                 4.660672e-03 3 1  ON 55
ci_057                 4.675406e-03 3 1  ON 56
ci_058                -2.045425e-03 3 1  ON 57
ci_059                -2.118449e-03 3 1  ON 58
ci_060                 4.733464e-03 3 1  ON 59
ci_061                 5.181124e-03 3 1  ON 60
ci_062                -2.828320e-03 3 1  ON 61
ci_063                -2.781460e-03 3 1  ON 62
ci_064                -2.213666e-03 3 1  ON 63
ci_065                -3.397962e-03 3 1  ON 64
ci_066                 4.063095e-03 3 1  ON 65
ci_067                 4.160844e-03 3 1  ON 66
ci_068                -4.398060e-03 3 1  ON 67
ci_069                -4.114813e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2214
    reference variance = 0.141327
====================================================
  Execution time = 1.5198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0241e-01
  Total weights = 1.9578e+06
  Execution time = 1.9545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508027640
                                         uncertainty =       0.001964738531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508027640
                                         uncertainty =       0.001964738531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380434286
  error estimate for blocks of size 2^( 2) =       0.000391724554
  error estimate for blocks of size 2^( 3) =       0.000401888284
  error estimate for blocks of size 2^( 4) =       0.000409851103
  error estimate for blocks of size 2^( 5) =       0.000413874517
  error estimate for blocks of size 2^( 6) =       0.000416278575
  error estimate for blocks of size 2^( 7) =       0.000418513035

      target function =      -0.908875827579
              le_mean =     -17.214587306812
             les_mean =     296.644422694865
             stat err =       0.000414629307
             autocorr =       1.187847512515
   target nu stat err =       0.000414629307
   target dn stat err =       0.002639800154
      target stat err =       0.004135406081
              std dev =       0.538015326814
             le_variance =       0.289460491887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289507999466
                                         uncertainty =       0.001964729809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289507999466
                                         uncertainty =       0.001964729809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380434268
  error estimate for blocks of size 2^( 2) =       0.000391724543
  error estimate for blocks of size 2^( 3) =       0.000401888281
  error estimate for blocks of size 2^( 4) =       0.000409851108
  error estimate for blocks of size 2^( 5) =       0.000413874525
  error estimate for blocks of size 2^( 6) =       0.000416278581
  error estimate for blocks of size 2^( 7) =       0.000418513046

      target function =      -0.908876011908
              le_mean =     -17.214587307210
             les_mean =     296.644422589311
             stat err =       0.000414629315
             autocorr =       1.187847670241
   target nu stat err =       0.000414629315
   target dn stat err =       0.002639783960
      target stat err =       0.004135383106
              std dev =       0.538015300696
             le_variance =       0.289460463783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508013552
                                         uncertainty =       0.001964734170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508013552
                                         uncertainty =       0.001964734170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380434277
  error estimate for blocks of size 2^( 2) =       0.000391724548
  error estimate for blocks of size 2^( 3) =       0.000401888283
  error estimate for blocks of size 2^( 4) =       0.000409851106
  error estimate for blocks of size 2^( 5) =       0.000413874521
  error estimate for blocks of size 2^( 6) =       0.000416278578
  error estimate for blocks of size 2^( 7) =       0.000418513040

      target function =      -0.908875919787
              le_mean =     -17.214587307011
             les_mean =     296.644422642057
             stat err =       0.000414629311
             autocorr =       1.187847591380
   target nu stat err =       0.000414629311
   target dn stat err =       0.002639792056
      target stat err =       0.004135394592
              std dev =       0.538015313754
             le_variance =       0.289460477833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508025879
                                         uncertainty =       0.001964737986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289508025879
                                         uncertainty =       0.001964737986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380434285
  error estimate for blocks of size 2^( 2) =       0.000391724553
  error estimate for blocks of size 2^( 3) =       0.000401888284
  error estimate for blocks of size 2^( 4) =       0.000409851104
  error estimate for blocks of size 2^( 5) =       0.000413874517
  error estimate for blocks of size 2^( 6) =       0.000416278576
  error estimate for blocks of size 2^( 7) =       0.000418513035

      target function =      -0.908875839110
              le_mean =     -17.214587306837
             les_mean =     296.644422688260
             stat err =       0.000414629308
             autocorr =       1.187847522367
   target nu stat err =       0.000414629308
   target dn stat err =       0.002639799141
      target stat err =       0.004135404645
              std dev =       0.538015325182
             le_variance =       0.289460490130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908875827579        initial
     9.0949e+02     9.0949e+03             1.4768e-07        -0.908876011908  <--
     3.6380e+03     3.6380e+04             3.6921e-08        -0.908875919787
     1.4552e+04     1.4552e+05             9.2304e-09        -0.908875839110

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.4657e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -3.762728e-02 3 1  ON 0
ci_002                -2.875844e-02 3 1  ON 1
ci_003                -2.367633e-02 3 1  ON 2
ci_004                 2.096184e-02 3 1  ON 3
ci_005                 2.155775e-02 3 1  ON 4
ci_006                -1.849853e-02 3 1  ON 5
ci_007                -1.847834e-02 3 1  ON 6
ci_008                -7.758525e-03 3 1  ON 7
ci_009                -1.401876e-02 3 1  ON 8
ci_010                -8.873495e-03 3 1  ON 9
ci_011                -9.143482e-03 3 1  ON 10
ci_012                -9.120777e-03 3 1  ON 11
ci_013                -1.923615e-02 3 1  ON 12
ci_014                 1.117981e-02 3 1  ON 13
ci_015                 1.103447e-02 3 1  ON 14
ci_016                 1.597492e-02 3 1  ON 15
ci_017                 1.566974e-02 3 1  ON 16
ci_018                 9.080600e-03 3 1  ON 17
ci_019                 8.982472e-03 3 1  ON 18
ci_020                 1.506478e-02 3 1  ON 19
ci_021                 1.519176e-02 3 1  ON 20
ci_022                 8.259332e-03 3 1  ON 21
ci_023                 8.362302e-03 3 1  ON 22
ci_024                 8.583254e-03 3 1  ON 23
ci_025                 8.594842e-03 3 1  ON 24
ci_026                 1.002869e-02 3 1  ON 25
ci_027                 9.639986e-03 3 1  ON 26
ci_028                -1.462477e-02 3 1  ON 27
ci_029                -1.500991e-02 3 1  ON 28
ci_030                -8.796781e-03 3 1  ON 29
ci_031                -8.563670e-03 3 1  ON 30
ci_032                -1.443950e-02 3 1  ON 31
ci_033                 4.554161e-03 3 1  ON 32
ci_034                 4.916080e-03 3 1  ON 33
ci_035                -3.348243e-03 3 1  ON 34
ci_036                -1.126165e-02 3 1  ON 35
ci_037                -1.150829e-02 3 1  ON 36
ci_038                 9.204163e-04 3 1  ON 37
ci_039                 1.223671e-03 3 1  ON 38
ci_040                -1.603313e-03 3 1  ON 39
ci_041                 8.179690e-03 3 1  ON 40
ci_042                 8.255345e-03 3 1  ON 41
ci_043                -2.385814e-03 3 1  ON 42
ci_044                -3.920814e-03 3 1  ON 43
ci_045                -1.870332e-03 3 1  ON 44
ci_046                 4.771478e-03 3 1  ON 45
ci_047                 4.645547e-03 3 1  ON 46
ci_048                -1.242672e-02 3 1  ON 47
ci_049                -1.288171e-02 3 1  ON 48
ci_050                 2.824172e-03 3 1  ON 49
ci_051                 2.816591e-03 3 1  ON 50
ci_052                -2.275531e-03 3 1  ON 51
ci_053                -2.209066e-03 3 1  ON 52
ci_054                -2.321273e-03 3 1  ON 53
ci_055                -2.374625e-03 3 1  ON 54
ci_056                 4.660690e-03 3 1  ON 55
ci_057                 4.675410e-03 3 1  ON 56
ci_058                -2.045401e-03 3 1  ON 57
ci_059                -2.118446e-03 3 1  ON 58
ci_060                 4.733470e-03 3 1  ON 59
ci_061                 5.181113e-03 3 1  ON 60
ci_062                -2.828336e-03 3 1  ON 61
ci_063                -2.781458e-03 3 1  ON 62
ci_064                -2.213649e-03 3 1  ON 63
ci_065                -3.397947e-03 3 1  ON 64
ci_066                 4.063078e-03 3 1  ON 65
ci_067                 4.160872e-03 3 1  ON 66
ci_068                -4.398067e-03 3 1  ON 67
ci_069                -4.114900e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.128484
====================================================
  Execution time = 1.3539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9806e-01
  Total weights = 1.957625664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285934797250
                                         uncertainty =       0.001701121810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285934797250
                                         uncertainty =       0.001701121810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378092176
  error estimate for blocks of size 2^( 2) =       0.000389294475
  error estimate for blocks of size 2^( 3) =       0.000399681954
  error estimate for blocks of size 2^( 4) =       0.000407286863
  error estimate for blocks of size 2^( 5) =       0.000413299426
  error estimate for blocks of size 2^( 6) =       0.000414553791
  error estimate for blocks of size 2^( 7) =       0.000417014539

      target function =      -0.915633821357
              le_mean =     -17.214621202735
             les_mean =     296.641246740143
             stat err =       0.000413038655
             autocorr =       1.193399943545
   target nu stat err =       0.000413038655
   target dn stat err =       0.002240245580
      target stat err =       0.003580492071
              std dev =       0.534703083706
             le_variance =       0.285907387724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462120273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915646780578       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915646894887       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915646921151       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915646928684       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915646929793       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915646929553       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915646929612       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915646929498       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915646929517       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915646929528       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 5.116591e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915646780578       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915646809162       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915646815730       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915646817613       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915646817890       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915646817830       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915646817845       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915646817817       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915646817822       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915646817824       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.279379e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915646780578       residual = 6.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915646787724       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915646789366       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915646789837       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915646789907       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915646789894       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915646789896       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915646789886       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915646789886       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915646789894       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 3.198591e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6069e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875840e-02 3 1  ON 1
ci_003                -2.367628e-02 3 1  ON 2
ci_004                 2.096181e-02 3 1  ON 3
ci_005                 2.155776e-02 3 1  ON 4
ci_006                -1.849854e-02 3 1  ON 5
ci_007                -1.847830e-02 3 1  ON 6
ci_008                -7.758546e-03 3 1  ON 7
ci_009                -1.401864e-02 3 1  ON 8
ci_010                -8.873611e-03 3 1  ON 9
ci_011                -9.143451e-03 3 1  ON 10
ci_012                -9.120804e-03 3 1  ON 11
ci_013                -1.923602e-02 3 1  ON 12
ci_014                 1.117986e-02 3 1  ON 13
ci_015                 1.103443e-02 3 1  ON 14
ci_016                 1.597482e-02 3 1  ON 15
ci_017                 1.566977e-02 3 1  ON 16
ci_018                 9.080631e-03 3 1  ON 17
ci_019                 8.982465e-03 3 1  ON 18
ci_020                 1.506466e-02 3 1  ON 19
ci_021                 1.519170e-02 3 1  ON 20
ci_022                 8.259264e-03 3 1  ON 21
ci_023                 8.362255e-03 3 1  ON 22
ci_024                 8.583230e-03 3 1  ON 23
ci_025                 8.594889e-03 3 1  ON 24
ci_026                 1.002868e-02 3 1  ON 25
ci_027                 9.639947e-03 3 1  ON 26
ci_028                -1.462475e-02 3 1  ON 27
ci_029                -1.500985e-02 3 1  ON 28
ci_030                -8.796740e-03 3 1  ON 29
ci_031                -8.563654e-03 3 1  ON 30
ci_032                -1.443951e-02 3 1  ON 31
ci_033                 4.554191e-03 3 1  ON 32
ci_034                 4.915970e-03 3 1  ON 33
ci_035                -3.348242e-03 3 1  ON 34
ci_036                -1.126166e-02 3 1  ON 35
ci_037                -1.150823e-02 3 1  ON 36
ci_038                 9.204052e-04 3 1  ON 37
ci_039                 1.223637e-03 3 1  ON 38
ci_040                -1.603266e-03 3 1  ON 39
ci_041                 8.179726e-03 3 1  ON 40
ci_042                 8.255395e-03 3 1  ON 41
ci_043                -2.385829e-03 3 1  ON 42
ci_044                -3.920870e-03 3 1  ON 43
ci_045                -1.870347e-03 3 1  ON 44
ci_046                 4.771440e-03 3 1  ON 45
ci_047                 4.645517e-03 3 1  ON 46
ci_048                -1.242670e-02 3 1  ON 47
ci_049                -1.288171e-02 3 1  ON 48
ci_050                 2.824248e-03 3 1  ON 49
ci_051                 2.816623e-03 3 1  ON 50
ci_052                -2.275525e-03 3 1  ON 51
ci_053                -2.209077e-03 3 1  ON 52
ci_054                -2.321298e-03 3 1  ON 53
ci_055                -2.374645e-03 3 1  ON 54
ci_056                 4.660704e-03 3 1  ON 55
ci_057                 4.675395e-03 3 1  ON 56
ci_058                -2.045380e-03 3 1  ON 57
ci_059                -2.118468e-03 3 1  ON 58
ci_060                 4.733415e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828336e-03 3 1  ON 61
ci_063                -2.781421e-03 3 1  ON 62
ci_064                -2.213648e-03 3 1  ON 63
ci_065                -3.397957e-03 3 1  ON 64
ci_066                 4.063101e-03 3 1  ON 65
ci_067                 4.160837e-03 3 1  ON 66
ci_068                -4.398018e-03 3 1  ON 67
ci_069                -4.114912e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.254439
====================================================
  Execution time = 1.3659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0075e-01
  Total weights = 1.9578e+06
  Execution time = 1.8512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174783575
                                         uncertainty =       0.001569617186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174783575
                                         uncertainty =       0.001569617186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379568363
  error estimate for blocks of size 2^( 2) =       0.000390694101
  error estimate for blocks of size 2^( 3) =       0.000400995777
  error estimate for blocks of size 2^( 4) =       0.000408450200
  error estimate for blocks of size 2^( 5) =       0.000412195059
  error estimate for blocks of size 2^( 6) =       0.000413990364
  error estimate for blocks of size 2^( 7) =       0.000415171301

      target function =      -0.911435800191
              le_mean =     -17.214607685123
             les_mean =     296.643471429822
             stat err =       0.000412451731
             autocorr =       1.180772545697
   target nu stat err =       0.000412451731
   target dn stat err =       0.002483461976
      target stat err =       0.003918914894
              std dev =       0.536790727447
             le_variance =       0.288144285073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174771729
                                         uncertainty =       0.001569618912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174771729
                                         uncertainty =       0.001569618912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379568356
  error estimate for blocks of size 2^( 2) =       0.000390694100
  error estimate for blocks of size 2^( 3) =       0.000400995786
  error estimate for blocks of size 2^( 4) =       0.000408450227
  error estimate for blocks of size 2^( 5) =       0.000412195103
  error estimate for blocks of size 2^( 6) =       0.000413990404
  error estimate for blocks of size 2^( 7) =       0.000415171340

      target function =      -0.911454131242
              le_mean =     -17.214607684195
             les_mean =     296.643459594294
             stat err =       0.000412451769
             autocorr =       1.180772808957
   target nu stat err =       0.000412451769
   target dn stat err =       0.002482942814
      target stat err =       0.003918277034
              std dev =       0.536790716297
             le_variance =       0.288144273103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174777633
                                         uncertainty =       0.001569618050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174777633
                                         uncertainty =       0.001569618050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379568360
  error estimate for blocks of size 2^( 2) =       0.000390694101
  error estimate for blocks of size 2^( 3) =       0.000400995781
  error estimate for blocks of size 2^( 4) =       0.000408450214
  error estimate for blocks of size 2^( 5) =       0.000412195081
  error estimate for blocks of size 2^( 6) =       0.000413990384
  error estimate for blocks of size 2^( 7) =       0.000415171321

      target function =      -0.911445312678
              le_mean =     -17.214607684656
             les_mean =     296.643465288542
             stat err =       0.000412451750
             autocorr =       1.180772677363
   target nu stat err =       0.000412451750
   target dn stat err =       0.002483184377
      target stat err =       0.003918571385
              std dev =       0.536790721855
             le_variance =       0.288144279069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174782831
                                         uncertainty =       0.001569617294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288174782831
                                         uncertainty =       0.001569617294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379568363
  error estimate for blocks of size 2^( 2) =       0.000390694101
  error estimate for blocks of size 2^( 3) =       0.000400995777
  error estimate for blocks of size 2^( 4) =       0.000408450202
  error estimate for blocks of size 2^( 5) =       0.000412195061
  error estimate for blocks of size 2^( 6) =       0.000413990367
  error estimate for blocks of size 2^( 7) =       0.000415171304

      target function =      -0.911437029424
              le_mean =     -17.214607685064
             les_mean =     296.643470636283
             stat err =       0.000412451733
             autocorr =       1.180772562153
   target nu stat err =       0.000412451733
   target dn stat err =       0.002483425121
      target stat err =       0.003918869005
              std dev =       0.536790726747
             le_variance =       0.288144284321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911435800191        initial
     2.2737e+02     2.2737e+03             5.1166e-07        -0.911454131242  <--
     9.0949e+02     9.0949e+03             1.2794e-07        -0.911445312678
     3.6380e+03     3.6380e+04             3.1986e-08        -0.911437029424

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 2.3000e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -3.762711e-02 3 1  ON 0
ci_002                -2.875826e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096171e-02 3 1  ON 3
ci_005                 2.155779e-02 3 1  ON 4
ci_006                -1.849857e-02 3 1  ON 5
ci_007                -1.847818e-02 3 1  ON 6
ci_008                -7.758608e-03 3 1  ON 7
ci_009                -1.401829e-02 3 1  ON 8
ci_010                -8.873960e-03 3 1  ON 9
ci_011                -9.143358e-03 3 1  ON 10
ci_012                -9.120884e-03 3 1  ON 11
ci_013                -1.923564e-02 3 1  ON 12
ci_014                 1.118004e-02 3 1  ON 13
ci_015                 1.103432e-02 3 1  ON 14
ci_016                 1.597455e-02 3 1  ON 15
ci_017                 1.566986e-02 3 1  ON 16
ci_018                 9.080724e-03 3 1  ON 17
ci_019                 8.982444e-03 3 1  ON 18
ci_020                 1.506432e-02 3 1  ON 19
ci_021                 1.519152e-02 3 1  ON 20
ci_022                 8.259059e-03 3 1  ON 21
ci_023                 8.362112e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.595032e-03 3 1  ON 24
ci_026                 1.002864e-02 3 1  ON 25
ci_027                 9.639830e-03 3 1  ON 26
ci_028                -1.462470e-02 3 1  ON 27
ci_029                -1.500966e-02 3 1  ON 28
ci_030                -8.796617e-03 3 1  ON 29
ci_031                -8.563607e-03 3 1  ON 30
ci_032                -1.443954e-02 3 1  ON 31
ci_033                 4.554280e-03 3 1  ON 32
ci_034                 4.915638e-03 3 1  ON 33
ci_035                -3.348241e-03 3 1  ON 34
ci_036                -1.126170e-02 3 1  ON 35
ci_037                -1.150806e-02 3 1  ON 36
ci_038                 9.203716e-04 3 1  ON 37
ci_039                 1.223536e-03 3 1  ON 38
ci_040                -1.603124e-03 3 1  ON 39
ci_041                 8.179833e-03 3 1  ON 40
ci_042                 8.255546e-03 3 1  ON 41
ci_043                -2.385874e-03 3 1  ON 42
ci_044                -3.921038e-03 3 1  ON 43
ci_045                -1.870394e-03 3 1  ON 44
ci_046                 4.771323e-03 3 1  ON 45
ci_047                 4.645428e-03 3 1  ON 46
ci_048                -1.242664e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824477e-03 3 1  ON 49
ci_051                 2.816716e-03 3 1  ON 50
ci_052                -2.275508e-03 3 1  ON 51
ci_053                -2.209108e-03 3 1  ON 52
ci_054                -2.321373e-03 3 1  ON 53
ci_055                -2.374707e-03 3 1  ON 54
ci_056                 4.660747e-03 3 1  ON 55
ci_057                 4.675348e-03 3 1  ON 56
ci_058                -2.045318e-03 3 1  ON 57
ci_059                -2.118534e-03 3 1  ON 58
ci_060                 4.733253e-03 3 1  ON 59
ci_061                 5.181355e-03 3 1  ON 60
ci_062                -2.828335e-03 3 1  ON 61
ci_063                -2.781312e-03 3 1  ON 62
ci_064                -2.213645e-03 3 1  ON 63
ci_065                -3.397984e-03 3 1  ON 64
ci_066                 4.063169e-03 3 1  ON 65
ci_067                 4.160732e-03 3 1  ON 66
ci_068                -4.397873e-03 3 1  ON 67
ci_069                -4.114948e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1376
    reference variance = 0.238539
====================================================
  Execution time = 1.3640e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9776e-01
  Total weights = 1.957896404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286091118523
                                         uncertainty =       0.001693154357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286091118523
                                         uncertainty =       0.001693154357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378190202
  error estimate for blocks of size 2^( 2) =       0.000389834836
  error estimate for blocks of size 2^( 3) =       0.000399996824
  error estimate for blocks of size 2^( 4) =       0.000407461872
  error estimate for blocks of size 2^( 5) =       0.000412102743
  error estimate for blocks of size 2^( 6) =       0.000414940177
  error estimate for blocks of size 2^( 7) =       0.000416063512

      target function =      -0.916094904928
              le_mean =     -17.214832527238
             les_mean =     296.648221925055
             stat err =       0.000412642076
             autocorr =       1.190491976650
   target nu stat err =       0.000412642076
   target dn stat err =       0.002461686552
      target stat err =       0.003926546597
              std dev =       0.534841713230
             le_variance =       0.286055658211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721483252724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916110862186       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916111275837       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916111339534       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916111365216       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916111369928       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916111369640       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916111370136       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916111370041       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916111370108       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 1.757768e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916110862186       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916110965705       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916110981642       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916110988065       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916110989243       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916110989172       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916110989296       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916110989272       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916110989289       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 4.398628e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916110862186       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916110888072       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916110892057       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916110893664       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916110893957       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916110893940       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916110893971       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916110893965       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916110893969       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.099920e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229503 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6164e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -3.762688e-02 3 1  ON 0
ci_002                -2.875858e-02 3 1  ON 1
ci_003                -2.367599e-02 3 1  ON 2
ci_004                 2.096190e-02 3 1  ON 3
ci_005                 2.155781e-02 3 1  ON 4
ci_006                -1.849857e-02 3 1  ON 5
ci_007                -1.847796e-02 3 1  ON 6
ci_008                -7.758432e-03 3 1  ON 7
ci_009                -1.401785e-02 3 1  ON 8
ci_010                -8.873909e-03 3 1  ON 9
ci_011                -9.143367e-03 3 1  ON 10
ci_012                -9.121018e-03 3 1  ON 11
ci_013                -1.923556e-02 3 1  ON 12
ci_014                 1.118006e-02 3 1  ON 13
ci_015                 1.103431e-02 3 1  ON 14
ci_016                 1.597459e-02 3 1  ON 15
ci_017                 1.566980e-02 3 1  ON 16
ci_018                 9.080798e-03 3 1  ON 17
ci_019                 8.982305e-03 3 1  ON 18
ci_020                 1.506396e-02 3 1  ON 19
ci_021                 1.519142e-02 3 1  ON 20
ci_022                 8.258634e-03 3 1  ON 21
ci_023                 8.362193e-03 3 1  ON 22
ci_024                 8.582908e-03 3 1  ON 23
ci_025                 8.595111e-03 3 1  ON 24
ci_026                 1.002826e-02 3 1  ON 25
ci_027                 9.639777e-03 3 1  ON 26
ci_028                -1.462483e-02 3 1  ON 27
ci_029                -1.500979e-02 3 1  ON 28
ci_030                -8.796389e-03 3 1  ON 29
ci_031                -8.563607e-03 3 1  ON 30
ci_032                -1.443946e-02 3 1  ON 31
ci_033                 4.554343e-03 3 1  ON 32
ci_034                 4.915501e-03 3 1  ON 33
ci_035                -3.348101e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150799e-02 3 1  ON 36
ci_038                 9.202241e-04 3 1  ON 37
ci_039                 1.223346e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.179831e-03 3 1  ON 40
ci_042                 8.255148e-03 3 1  ON 41
ci_043                -2.385801e-03 3 1  ON 42
ci_044                -3.921363e-03 3 1  ON 43
ci_045                -1.870422e-03 3 1  ON 44
ci_046                 4.771436e-03 3 1  ON 45
ci_047                 4.645564e-03 3 1  ON 46
ci_048                -1.242661e-02 3 1  ON 47
ci_049                -1.288184e-02 3 1  ON 48
ci_050                 2.824659e-03 3 1  ON 49
ci_051                 2.816813e-03 3 1  ON 50
ci_052                -2.275416e-03 3 1  ON 51
ci_053                -2.209010e-03 3 1  ON 52
ci_054                -2.321253e-03 3 1  ON 53
ci_055                -2.374728e-03 3 1  ON 54
ci_056                 4.660616e-03 3 1  ON 55
ci_057                 4.675356e-03 3 1  ON 56
ci_058                -2.045375e-03 3 1  ON 57
ci_059                -2.118404e-03 3 1  ON 58
ci_060                 4.732986e-03 3 1  ON 59
ci_061                 5.181500e-03 3 1  ON 60
ci_062                -2.828281e-03 3 1  ON 61
ci_063                -2.781357e-03 3 1  ON 62
ci_064                -2.213823e-03 3 1  ON 63
ci_065                -3.398024e-03 3 1  ON 64
ci_066                 4.063209e-03 3 1  ON 65
ci_067                 4.160721e-03 3 1  ON 66
ci_068                -4.397799e-03 3 1  ON 67
ci_069                -4.114902e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1755
    reference variance = 0.193343
====================================================
  Execution time = 1.3359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9786e-01
  Total weights = 1.9578e+06
  Execution time = 1.8787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188660887
                                         uncertainty =       0.001383656655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188660887
                                         uncertainty =       0.001383656655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378291816
  error estimate for blocks of size 2^( 2) =       0.000389775347
  error estimate for blocks of size 2^( 3) =       0.000400465000
  error estimate for blocks of size 2^( 4) =       0.000408737707
  error estimate for blocks of size 2^( 5) =       0.000413659074
  error estimate for blocks of size 2^( 6) =       0.000416415265
  error estimate for blocks of size 2^( 7) =       0.000418123467

      target function =      -0.915956846917
              le_mean =     -17.214531502202
             les_mean =     296.637954051717
             stat err =       0.000414233878
             autocorr =       1.199050121245
   target nu stat err =       0.000414233878
   target dn stat err =       0.002266697756
      target stat err =       0.003623431722
              std dev =       0.534985417381
             le_variance =       0.286209396810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188324976
                                         uncertainty =       0.001383629549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188324976
                                         uncertainty =       0.001383629549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378291594
  error estimate for blocks of size 2^( 2) =       0.000389775211
  error estimate for blocks of size 2^( 3) =       0.000400464979
  error estimate for blocks of size 2^( 4) =       0.000408737718
  error estimate for blocks of size 2^( 5) =       0.000413659068
  error estimate for blocks of size 2^( 6) =       0.000416415273
  error estimate for blocks of size 2^( 7) =       0.000418123523

      target function =      -0.915953704286
              le_mean =     -17.214531490089
             les_mean =     296.637955639911
             stat err =       0.000414233896
             autocorr =       1.199051630761
   target nu stat err =       0.000414233895
   target dn stat err =       0.002266670455
      target stat err =       0.003623365284
              std dev =       0.534985102778
             le_variance =       0.286209060194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188492637
                                         uncertainty =       0.001383643090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188492637
                                         uncertainty =       0.001383643090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378291705
  error estimate for blocks of size 2^( 2) =       0.000389775279
  error estimate for blocks of size 2^( 3) =       0.000400464990
  error estimate for blocks of size 2^( 4) =       0.000408737712
  error estimate for blocks of size 2^( 5) =       0.000413659071
  error estimate for blocks of size 2^( 6) =       0.000416415269
  error estimate for blocks of size 2^( 7) =       0.000418123495

      target function =      -0.915955298944
              le_mean =     -17.214531496127
             les_mean =     296.637954830297
             stat err =       0.000414233887
             autocorr =       1.199050876634
   target nu stat err =       0.000414233887
   target dn stat err =       0.002266683351
      target stat err =       0.003623397524
              std dev =       0.534985259803
             le_variance =       0.286209228206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188639835
                                         uncertainty =       0.001383654959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286188639835
                                         uncertainty =       0.001383654959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378291803
  error estimate for blocks of size 2^( 2) =       0.000389775339
  error estimate for blocks of size 2^( 3) =       0.000400464999
  error estimate for blocks of size 2^( 4) =       0.000408737707
  error estimate for blocks of size 2^( 5) =       0.000413659074
  error estimate for blocks of size 2^( 6) =       0.000416415266
  error estimate for blocks of size 2^( 7) =       0.000418123471

      target function =      -0.915956656040
              le_mean =     -17.214531501441
             les_mean =     296.637954147312
             stat err =       0.000414233879
             autocorr =       1.199050215682
   target nu stat err =       0.000414233879
   target dn stat err =       0.002266695876
      target stat err =       0.003623427345
              std dev =       0.534985397665
             le_variance =       0.286209375714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915956846917        initial  <--
     5.6843e+01     5.6843e+02             1.7578e-06        -0.915953704286
     2.2737e+02     2.2737e+03             4.3986e-07        -0.915955298944
     9.0949e+02     9.0949e+03             1.0999e-07        -0.915956656040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7839
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -3.762711e-02 3 1  ON 0
ci_002                -2.875826e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096171e-02 3 1  ON 3
ci_005                 2.155779e-02 3 1  ON 4
ci_006                -1.849857e-02 3 1  ON 5
ci_007                -1.847818e-02 3 1  ON 6
ci_008                -7.758608e-03 3 1  ON 7
ci_009                -1.401829e-02 3 1  ON 8
ci_010                -8.873960e-03 3 1  ON 9
ci_011                -9.143358e-03 3 1  ON 10
ci_012                -9.120884e-03 3 1  ON 11
ci_013                -1.923564e-02 3 1  ON 12
ci_014                 1.118004e-02 3 1  ON 13
ci_015                 1.103432e-02 3 1  ON 14
ci_016                 1.597455e-02 3 1  ON 15
ci_017                 1.566986e-02 3 1  ON 16
ci_018                 9.080724e-03 3 1  ON 17
ci_019                 8.982444e-03 3 1  ON 18
ci_020                 1.506432e-02 3 1  ON 19
ci_021                 1.519152e-02 3 1  ON 20
ci_022                 8.259059e-03 3 1  ON 21
ci_023                 8.362112e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.595032e-03 3 1  ON 24
ci_026                 1.002864e-02 3 1  ON 25
ci_027                 9.639830e-03 3 1  ON 26
ci_028                -1.462470e-02 3 1  ON 27
ci_029                -1.500966e-02 3 1  ON 28
ci_030                -8.796617e-03 3 1  ON 29
ci_031                -8.563607e-03 3 1  ON 30
ci_032                -1.443954e-02 3 1  ON 31
ci_033                 4.554280e-03 3 1  ON 32
ci_034                 4.915638e-03 3 1  ON 33
ci_035                -3.348241e-03 3 1  ON 34
ci_036                -1.126170e-02 3 1  ON 35
ci_037                -1.150806e-02 3 1  ON 36
ci_038                 9.203716e-04 3 1  ON 37
ci_039                 1.223536e-03 3 1  ON 38
ci_040                -1.603124e-03 3 1  ON 39
ci_041                 8.179833e-03 3 1  ON 40
ci_042                 8.255546e-03 3 1  ON 41
ci_043                -2.385874e-03 3 1  ON 42
ci_044                -3.921038e-03 3 1  ON 43
ci_045                -1.870394e-03 3 1  ON 44
ci_046                 4.771323e-03 3 1  ON 45
ci_047                 4.645428e-03 3 1  ON 46
ci_048                -1.242664e-02 3 1  ON 47
ci_049                -1.288172e-02 3 1  ON 48
ci_050                 2.824477e-03 3 1  ON 49
ci_051                 2.816716e-03 3 1  ON 50
ci_052                -2.275508e-03 3 1  ON 51
ci_053                -2.209108e-03 3 1  ON 52
ci_054                -2.321373e-03 3 1  ON 53
ci_055                -2.374707e-03 3 1  ON 54
ci_056                 4.660747e-03 3 1  ON 55
ci_057                 4.675348e-03 3 1  ON 56
ci_058                -2.045318e-03 3 1  ON 57
ci_059                -2.118534e-03 3 1  ON 58
ci_060                 4.733253e-03 3 1  ON 59
ci_061                 5.181355e-03 3 1  ON 60
ci_062                -2.828335e-03 3 1  ON 61
ci_063                -2.781312e-03 3 1  ON 62
ci_064                -2.213645e-03 3 1  ON 63
ci_065                -3.397984e-03 3 1  ON 64
ci_066                 4.063169e-03 3 1  ON 65
ci_067                 4.160732e-03 3 1  ON 66
ci_068                -4.397873e-03 3 1  ON 67
ci_069                -4.114948e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.277803
====================================================
  Execution time = 1.4116e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9825e-01
  Total weights = 1.957783623e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285993918066
                                         uncertainty =       0.001962875080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285993918066
                                         uncertainty =       0.001962875080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378139696
  error estimate for blocks of size 2^( 2) =       0.000389526766
  error estimate for blocks of size 2^( 3) =       0.000400001830
  error estimate for blocks of size 2^( 4) =       0.000407912564
  error estimate for blocks of size 2^( 5) =       0.000412263090
  error estimate for blocks of size 2^( 6) =       0.000415084449
  error estimate for blocks of size 2^( 7) =       0.000419119823

      target function =      -0.915300225441
              le_mean =     -17.215747366544
             les_mean =     296.680205915791
             stat err =       0.000413594982
             autocorr =       1.196316190564
   target nu stat err =       0.000413594982
   target dn stat err =       0.002431065983
      target stat err =       0.003879612393
              std dev =       0.534770286032
             le_variance =       0.285979258822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721574736654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915315751423       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915315848679       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915315857458       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915315859638       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915315860223       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915315860220       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915315860231       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915315860236       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915315860268       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915315860276       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 2.586728e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915315751423       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915315775740       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915315777935       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915315778480       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915315778626       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915315778631       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915315778629       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915315778630       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915315778637       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915315778638       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 6.467455e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915315751423       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915315757503       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915315758051       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915315758189       residual = 6.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915315758238       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915315758234       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915315758222       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915315758216       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915315758240       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915315758234       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+03 is 1.616903e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232945 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6688e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -3.762711e-02 3 1  ON 0
ci_002                -2.875825e-02 3 1  ON 1
ci_003                -2.367610e-02 3 1  ON 2
ci_004                 2.096170e-02 3 1  ON 3
ci_005                 2.155779e-02 3 1  ON 4
ci_006                -1.849852e-02 3 1  ON 5
ci_007                -1.847817e-02 3 1  ON 6
ci_008                -7.758610e-03 3 1  ON 7
ci_009                -1.401826e-02 3 1  ON 8
ci_010                -8.873955e-03 3 1  ON 9
ci_011                -9.143303e-03 3 1  ON 10
ci_012                -9.120863e-03 3 1  ON 11
ci_013                -1.923561e-02 3 1  ON 12
ci_014                 1.118004e-02 3 1  ON 13
ci_015                 1.103434e-02 3 1  ON 14
ci_016                 1.597456e-02 3 1  ON 15
ci_017                 1.566988e-02 3 1  ON 16
ci_018                 9.080733e-03 3 1  ON 17
ci_019                 8.982465e-03 3 1  ON 18
ci_020                 1.506430e-02 3 1  ON 19
ci_021                 1.519150e-02 3 1  ON 20
ci_022                 8.259079e-03 3 1  ON 21
ci_023                 8.362104e-03 3 1  ON 22
ci_024                 8.583219e-03 3 1  ON 23
ci_025                 8.594999e-03 3 1  ON 24
ci_026                 1.002863e-02 3 1  ON 25
ci_027                 9.639830e-03 3 1  ON 26
ci_028                -1.462474e-02 3 1  ON 27
ci_029                -1.500967e-02 3 1  ON 28
ci_030                -8.796582e-03 3 1  ON 29
ci_031                -8.563578e-03 3 1  ON 30
ci_032                -1.443952e-02 3 1  ON 31
ci_033                 4.554264e-03 3 1  ON 32
ci_034                 4.915604e-03 3 1  ON 33
ci_035                -3.348241e-03 3 1  ON 34
ci_036                -1.126171e-02 3 1  ON 35
ci_037                -1.150802e-02 3 1  ON 36
ci_038                 9.203679e-04 3 1  ON 37
ci_039                 1.223522e-03 3 1  ON 38
ci_040                -1.603128e-03 3 1  ON 39
ci_041                 8.179804e-03 3 1  ON 40
ci_042                 8.255554e-03 3 1  ON 41
ci_043                -2.385869e-03 3 1  ON 42
ci_044                -3.920994e-03 3 1  ON 43
ci_045                -1.870396e-03 3 1  ON 44
ci_046                 4.771306e-03 3 1  ON 45
ci_047                 4.645409e-03 3 1  ON 46
ci_048                -1.242666e-02 3 1  ON 47
ci_049                -1.288171e-02 3 1  ON 48
ci_050                 2.824472e-03 3 1  ON 49
ci_051                 2.816715e-03 3 1  ON 50
ci_052                -2.275498e-03 3 1  ON 51
ci_053                -2.209092e-03 3 1  ON 52
ci_054                -2.321386e-03 3 1  ON 53
ci_055                -2.374742e-03 3 1  ON 54
ci_056                 4.660762e-03 3 1  ON 55
ci_057                 4.675283e-03 3 1  ON 56
ci_058                -2.045345e-03 3 1  ON 57
ci_059                -2.118527e-03 3 1  ON 58
ci_060                 4.733199e-03 3 1  ON 59
ci_061                 5.181344e-03 3 1  ON 60
ci_062                -2.828310e-03 3 1  ON 61
ci_063                -2.781332e-03 3 1  ON 62
ci_064                -2.213660e-03 3 1  ON 63
ci_065                -3.397992e-03 3 1  ON 64
ci_066                 4.063171e-03 3 1  ON 65
ci_067                 4.160733e-03 3 1  ON 66
ci_068                -4.397895e-03 3 1  ON 67
ci_069                -4.114952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1556
    reference variance = 0.273377
====================================================
  Execution time = 1.3728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0057e-01
  Total weights = 1.9575e+06
  Execution time = 1.8647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836400794
                                         uncertainty =       0.001722648601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836400794
                                         uncertainty =       0.001722648601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378709216
  error estimate for blocks of size 2^( 2) =       0.000390223577
  error estimate for blocks of size 2^( 3) =       0.000401042074
  error estimate for blocks of size 2^( 4) =       0.000409215369
  error estimate for blocks of size 2^( 5) =       0.000413859111
  error estimate for blocks of size 2^( 6) =       0.000415743288
  error estimate for blocks of size 2^( 7) =       0.000416981417

      target function =      -0.911695634785
              le_mean =     -17.214795611535
             les_mean =     296.649758591121
             stat err =       0.000413949796
             autocorr =       1.194768046261
   target nu stat err =       0.000413949796
   target dn stat err =       0.003516561803
      target stat err =       0.005509750494
              std dev =       0.535575708976
             le_variance =       0.286841340045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836343321
                                         uncertainty =       0.001722649007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836343321
                                         uncertainty =       0.001722649007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378709178
  error estimate for blocks of size 2^( 2) =       0.000390223554
  error estimate for blocks of size 2^( 3) =       0.000401042063
  error estimate for blocks of size 2^( 4) =       0.000409215370
  error estimate for blocks of size 2^( 5) =       0.000413859121
  error estimate for blocks of size 2^( 6) =       0.000415743306
  error estimate for blocks of size 2^( 7) =       0.000416981430

      target function =      -0.911697567581
              le_mean =     -17.214795610896
             les_mean =     296.649757328294
             stat err =       0.000413949807
             autocorr =       1.194768345049
   target nu stat err =       0.000413949807
   target dn stat err =       0.003516305894
      target stat err =       0.005509379247
              std dev =       0.535575655880
             le_variance =       0.286841283171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836372052
                                         uncertainty =       0.001722648804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836372052
                                         uncertainty =       0.001722648804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378709197
  error estimate for blocks of size 2^( 2) =       0.000390223565
  error estimate for blocks of size 2^( 3) =       0.000401042068
  error estimate for blocks of size 2^( 4) =       0.000409215370
  error estimate for blocks of size 2^( 5) =       0.000413859116
  error estimate for blocks of size 2^( 6) =       0.000415743297
  error estimate for blocks of size 2^( 7) =       0.000416981423

      target function =      -0.911696632346
              le_mean =     -17.214795611216
             les_mean =     296.649757939668
             stat err =       0.000413949801
             autocorr =       1.194768195657
   target nu stat err =       0.000413949801
   target dn stat err =       0.003516433765
      target stat err =       0.005509565115
              std dev =       0.535575682423
             le_variance =       0.286841311603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836397201
                                         uncertainty =       0.001722648627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286836397201
                                         uncertainty =       0.001722648627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378709213
  error estimate for blocks of size 2^( 2) =       0.000390223576
  error estimate for blocks of size 2^( 3) =       0.000401042073
  error estimate for blocks of size 2^( 4) =       0.000409215369
  error estimate for blocks of size 2^( 5) =       0.000413859112
  error estimate for blocks of size 2^( 6) =       0.000415743289
  error estimate for blocks of size 2^( 7) =       0.000416981417

      target function =      -0.911695762832
              le_mean =     -17.214795611496
             les_mean =     296.649758507534
             stat err =       0.000413949797
             autocorr =       1.194768064940
   target nu stat err =       0.000413949797
   target dn stat err =       0.003516545790
      target stat err =       0.005509727349
              std dev =       0.535575705657
             le_variance =       0.286841336490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911695634785        initial
     5.6843e+02     5.6843e+03             2.5867e-07        -0.911697567581  <--
     2.2737e+03     2.2737e+04             6.4675e-08        -0.911696632346
     9.0949e+03     9.0949e+04             1.6169e-08        -0.911695762832

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 2.3119e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -3.762711e-02 3 1  ON 0
ci_002                -2.875821e-02 3 1  ON 1
ci_003                -2.367603e-02 3 1  ON 2
ci_004                 2.096167e-02 3 1  ON 3
ci_005                 2.155779e-02 3 1  ON 4
ci_006                -1.849837e-02 3 1  ON 5
ci_007                -1.847815e-02 3 1  ON 6
ci_008                -7.758616e-03 3 1  ON 7
ci_009                -1.401816e-02 3 1  ON 8
ci_010                -8.873939e-03 3 1  ON 9
ci_011                -9.143139e-03 3 1  ON 10
ci_012                -9.120803e-03 3 1  ON 11
ci_013                -1.923552e-02 3 1  ON 12
ci_014                 1.118006e-02 3 1  ON 13
ci_015                 1.103442e-02 3 1  ON 14
ci_016                 1.597460e-02 3 1  ON 15
ci_017                 1.566993e-02 3 1  ON 16
ci_018                 9.080760e-03 3 1  ON 17
ci_019                 8.982528e-03 3 1  ON 18
ci_020                 1.506426e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.259136e-03 3 1  ON 21
ci_023                 8.362082e-03 3 1  ON 22
ci_024                 8.583403e-03 3 1  ON 23
ci_025                 8.594900e-03 3 1  ON 24
ci_026                 1.002859e-02 3 1  ON 25
ci_027                 9.639829e-03 3 1  ON 26
ci_028                -1.462487e-02 3 1  ON 27
ci_029                -1.500967e-02 3 1  ON 28
ci_030                -8.796477e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443949e-02 3 1  ON 31
ci_033                 4.554218e-03 3 1  ON 32
ci_034                 4.915500e-03 3 1  ON 33
ci_035                -3.348241e-03 3 1  ON 34
ci_036                -1.126174e-02 3 1  ON 35
ci_037                -1.150789e-02 3 1  ON 36
ci_038                 9.203569e-04 3 1  ON 37
ci_039                 1.223479e-03 3 1  ON 38
ci_040                -1.603138e-03 3 1  ON 39
ci_041                 8.179715e-03 3 1  ON 40
ci_042                 8.255575e-03 3 1  ON 41
ci_043                -2.385854e-03 3 1  ON 42
ci_044                -3.920861e-03 3 1  ON 43
ci_045                -1.870402e-03 3 1  ON 44
ci_046                 4.771256e-03 3 1  ON 45
ci_047                 4.645350e-03 3 1  ON 46
ci_048                -1.242672e-02 3 1  ON 47
ci_049                -1.288169e-02 3 1  ON 48
ci_050                 2.824457e-03 3 1  ON 49
ci_051                 2.816712e-03 3 1  ON 50
ci_052                -2.275470e-03 3 1  ON 51
ci_053                -2.209046e-03 3 1  ON 52
ci_054                -2.321424e-03 3 1  ON 53
ci_055                -2.374848e-03 3 1  ON 54
ci_056                 4.660807e-03 3 1  ON 55
ci_057                 4.675089e-03 3 1  ON 56
ci_058                -2.045425e-03 3 1  ON 57
ci_059                -2.118507e-03 3 1  ON 58
ci_060                 4.733037e-03 3 1  ON 59
ci_061                 5.181313e-03 3 1  ON 60
ci_062                -2.828234e-03 3 1  ON 61
ci_063                -2.781391e-03 3 1  ON 62
ci_064                -2.213704e-03 3 1  ON 63
ci_065                -3.398016e-03 3 1  ON 64
ci_066                 4.063177e-03 3 1  ON 65
ci_067                 4.160737e-03 3 1  ON 66
ci_068                -4.397961e-03 3 1  ON 67
ci_069                -4.114965e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9816e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2942
    reference variance = 0.71396
====================================================
  Execution time = 1.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0101e-01
  Total weights = 1.957749149e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287339619449
                                         uncertainty =       0.001635420854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287339619449
                                         uncertainty =       0.001635420854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379053735
  error estimate for blocks of size 2^( 2) =       0.000390671853
  error estimate for blocks of size 2^( 3) =       0.000401223449
  error estimate for blocks of size 2^( 4) =       0.000409228880
  error estimate for blocks of size 2^( 5) =       0.000414002954
  error estimate for blocks of size 2^( 6) =       0.000416205782
  error estimate for blocks of size 2^( 7) =       0.000414898368

      target function =      -0.911040106995
              le_mean =     -17.214501266214
             les_mean =     296.640064621923
             stat err =       0.000413583996
             autocorr =       1.190490380318
   target nu stat err =       0.000413583996
   target dn stat err =       0.002580934196
      target stat err =       0.004063926236
              std dev =       0.536062932437
             le_variance =       0.287363467533


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450126621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911057273935       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911057982704       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911058091834       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911058106019       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911058106104       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911058106973       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911058106519       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911058106642       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911058106662       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911058106655       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 2.542670e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911057273935       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911057451203       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911057478494       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911057482042       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911057482062       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911057482279       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911057482165       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911057482196       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911057482201       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911057482199       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 6.359215e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911057273935       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911057318257       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911057325080       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911057325967       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911057325972       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911057326027       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911057325998       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911057326006       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911057326007       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911057326007       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+03 is 1.589963e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6724e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -3.762715e-02 3 1  ON 0
ci_002                -2.875802e-02 3 1  ON 1
ci_003                -2.367607e-02 3 1  ON 2
ci_004                 2.096154e-02 3 1  ON 3
ci_005                 2.155763e-02 3 1  ON 4
ci_006                -1.849822e-02 3 1  ON 5
ci_007                -1.847809e-02 3 1  ON 6
ci_008                -7.758508e-03 3 1  ON 7
ci_009                -1.401812e-02 3 1  ON 8
ci_010                -8.873979e-03 3 1  ON 9
ci_011                -9.143093e-03 3 1  ON 10
ci_012                -9.120789e-03 3 1  ON 11
ci_013                -1.923557e-02 3 1  ON 12
ci_014                 1.118003e-02 3 1  ON 13
ci_015                 1.103437e-02 3 1  ON 14
ci_016                 1.597453e-02 3 1  ON 15
ci_017                 1.566990e-02 3 1  ON 16
ci_018                 9.080656e-03 3 1  ON 17
ci_019                 8.982316e-03 3 1  ON 18
ci_020                 1.506438e-02 3 1  ON 19
ci_021                 1.519141e-02 3 1  ON 20
ci_022                 8.259001e-03 3 1  ON 21
ci_023                 8.361981e-03 3 1  ON 22
ci_024                 8.583352e-03 3 1  ON 23
ci_025                 8.594909e-03 3 1  ON 24
ci_026                 1.002851e-02 3 1  ON 25
ci_027                 9.639844e-03 3 1  ON 26
ci_028                -1.462478e-02 3 1  ON 27
ci_029                -1.500973e-02 3 1  ON 28
ci_030                -8.796235e-03 3 1  ON 29
ci_031                -8.563489e-03 3 1  ON 30
ci_032                -1.443940e-02 3 1  ON 31
ci_033                 4.554299e-03 3 1  ON 32
ci_034                 4.915522e-03 3 1  ON 33
ci_035                -3.348207e-03 3 1  ON 34
ci_036                -1.126178e-02 3 1  ON 35
ci_037                -1.150786e-02 3 1  ON 36
ci_038                 9.202956e-04 3 1  ON 37
ci_039                 1.223428e-03 3 1  ON 38
ci_040                -1.603120e-03 3 1  ON 39
ci_041                 8.179842e-03 3 1  ON 40
ci_042                 8.255591e-03 3 1  ON 41
ci_043                -2.385803e-03 3 1  ON 42
ci_044                -3.921020e-03 3 1  ON 43
ci_045                -1.870338e-03 3 1  ON 44
ci_046                 4.771236e-03 3 1  ON 45
ci_047                 4.645375e-03 3 1  ON 46
ci_048                -1.242668e-02 3 1  ON 47
ci_049                -1.288179e-02 3 1  ON 48
ci_050                 2.824599e-03 3 1  ON 49
ci_051                 2.816631e-03 3 1  ON 50
ci_052                -2.275427e-03 3 1  ON 51
ci_053                -2.209005e-03 3 1  ON 52
ci_054                -2.321359e-03 3 1  ON 53
ci_055                -2.374932e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675123e-03 3 1  ON 56
ci_058                -2.045226e-03 3 1  ON 57
ci_059                -2.118526e-03 3 1  ON 58
ci_060                 4.732402e-03 3 1  ON 59
ci_061                 5.181291e-03 3 1  ON 60
ci_062                -2.828225e-03 3 1  ON 61
ci_063                -2.781395e-03 3 1  ON 62
ci_064                -2.213630e-03 3 1  ON 63
ci_065                -3.398027e-03 3 1  ON 64
ci_066                 4.063181e-03 3 1  ON 65
ci_067                 4.160709e-03 3 1  ON 66
ci_068                -4.398159e-03 3 1  ON 67
ci_069                -4.114987e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2116
    reference variance = 0.204799
====================================================
  Execution time = 1.3629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0241e-01
  Total weights = 1.9576e+06
  Execution time = 1.8422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483764930
                                         uncertainty =       0.001692997711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483764930
                                         uncertainty =       0.001692997711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380412050
  error estimate for blocks of size 2^( 2) =       0.000391973161
  error estimate for blocks of size 2^( 3) =       0.000402778630
  error estimate for blocks of size 2^( 4) =       0.000410307494
  error estimate for blocks of size 2^( 5) =       0.000415016100
  error estimate for blocks of size 2^( 6) =       0.000417950877
  error estimate for blocks of size 2^( 7) =       0.000419937038

      target function =      -0.908851847692
              le_mean =     -17.215078776148
             les_mean =     296.661346022098
             stat err =       0.000415802877
             autocorr =       1.194720870012
   target nu stat err =       0.000415802877
   target dn stat err =       0.002460033637
      target stat err =       0.003865949964
              std dev =       0.537983880360
             le_variance =       0.289426655528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483616106
                                         uncertainty =       0.001692984772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483616106
                                         uncertainty =       0.001692984772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380411953
  error estimate for blocks of size 2^( 2) =       0.000391973149
  error estimate for blocks of size 2^( 3) =       0.000402778715
  error estimate for blocks of size 2^( 4) =       0.000410307683
  error estimate for blocks of size 2^( 5) =       0.000415016320
  error estimate for blocks of size 2^( 6) =       0.000417951116
  error estimate for blocks of size 2^( 7) =       0.000419937277

      target function =      -0.908861243682
              le_mean =     -17.215078786250
             les_mean =     296.661340289286
             stat err =       0.000415803099
             autocorr =       1.194722752126
   target nu stat err =       0.000415803099
   target dn stat err =       0.002459855046
      target stat err =       0.003865757418
              std dev =       0.537983743299
             le_variance =       0.289426508054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483690414
                                         uncertainty =       0.001692991238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483690414
                                         uncertainty =       0.001692991238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380412001
  error estimate for blocks of size 2^( 2) =       0.000391973155
  error estimate for blocks of size 2^( 3) =       0.000402778673
  error estimate for blocks of size 2^( 4) =       0.000410307589
  error estimate for blocks of size 2^( 5) =       0.000415016210
  error estimate for blocks of size 2^( 6) =       0.000417950997
  error estimate for blocks of size 2^( 7) =       0.000419937157

      target function =      -0.908856627374
              le_mean =     -17.215078781192
             les_mean =     296.661343102577
             stat err =       0.000415802988
             autocorr =       1.194721811576
   target nu stat err =       0.000415802988
   target dn stat err =       0.002459942533
      target stat err =       0.003865851628
              std dev =       0.537983811733
             le_variance =       0.289426581687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483755607
                                         uncertainty =       0.001692996901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289483755607
                                         uncertainty =       0.001692996901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380412044
  error estimate for blocks of size 2^( 2) =       0.000391973160
  error estimate for blocks of size 2^( 3) =       0.000402778636
  error estimate for blocks of size 2^( 4) =       0.000410307506
  error estimate for blocks of size 2^( 5) =       0.000415016114
  error estimate for blocks of size 2^( 6) =       0.000417950892
  error estimate for blocks of size 2^( 7) =       0.000419937053

      target function =      -0.908852454227
              le_mean =     -17.215078776778
             les_mean =     296.661345651252
             stat err =       0.000415802891
             autocorr =       1.194720987738
   target nu stat err =       0.000415802891
   target dn stat err =       0.002460022046
      target stat err =       0.003865937440
              std dev =       0.537983871773
             le_variance =       0.289426646288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908851847692        initial
     1.4211e+02     1.4211e+03             2.5427e-06        -0.908861243682  <--
     5.6843e+02     5.6843e+03             6.3592e-07        -0.908856627374
     2.2737e+03     2.2737e+04             1.5900e-07        -0.908852454227

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 2.2966e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -3.762727e-02 3 1  ON 0
ci_002                -2.875745e-02 3 1  ON 1
ci_003                -2.367618e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849776e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758185e-03 3 1  ON 7
ci_009                -1.401800e-02 3 1  ON 8
ci_010                -8.874098e-03 3 1  ON 9
ci_011                -9.142954e-03 3 1  ON 10
ci_012                -9.120750e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117994e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566981e-02 3 1  ON 16
ci_018                 9.080345e-03 3 1  ON 17
ci_019                 8.981681e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258593e-03 3 1  ON 21
ci_023                 8.361676e-03 3 1  ON 22
ci_024                 8.583197e-03 3 1  ON 23
ci_025                 8.594939e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639887e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795508e-03 3 1  ON 29
ci_031                -8.563494e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915585e-03 3 1  ON 33
ci_035                -3.348103e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201117e-04 3 1  ON 37
ci_039                 1.223275e-03 3 1  ON 38
ci_040                -1.603065e-03 3 1  ON 39
ci_041                 8.180223e-03 3 1  ON 40
ci_042                 8.255637e-03 3 1  ON 41
ci_043                -2.385652e-03 3 1  ON 42
ci_044                -3.921494e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771178e-03 3 1  ON 45
ci_047                 4.645447e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825028e-03 3 1  ON 49
ci_051                 2.816389e-03 3 1  ON 50
ci_052                -2.275296e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321167e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660829e-03 3 1  ON 55
ci_057                 4.675226e-03 3 1  ON 56
ci_058                -2.044630e-03 3 1  ON 57
ci_059                -2.118584e-03 3 1  ON 58
ci_060                 4.730495e-03 3 1  ON 59
ci_061                 5.181226e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213409e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063192e-03 3 1  ON 65
ci_067                 4.160625e-03 3 1  ON 66
ci_068                -4.398750e-03 3 1  ON 67
ci_069                -4.115054e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.198799
====================================================
  Execution time = 1.4394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9981e-01
  Total weights = 1.957672314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287123017080
                                         uncertainty =       0.002357972944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287123017080
                                         uncertainty =       0.002357972944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378963294
  error estimate for blocks of size 2^( 2) =       0.000390509758
  error estimate for blocks of size 2^( 3) =       0.000400805998
  error estimate for blocks of size 2^( 4) =       0.000407985779
  error estimate for blocks of size 2^( 5) =       0.000413381314
  error estimate for blocks of size 2^( 6) =       0.000416521761
  error estimate for blocks of size 2^( 7) =       0.000417942972

      target function =      -0.912881206347
              le_mean =     -17.214999621557
             les_mean =     296.656021890153
             stat err =       0.000413957956
             autocorr =       1.193213548261
   target nu stat err =       0.000413957956
   target dn stat err =       0.002912129928
      target stat err =       0.004593315293
              std dev =       0.535935029593
             le_variance =       0.287226355945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721499962156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912903637062       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912904841761       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912905002240       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912905046304       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912905055705       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912905062824       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912905063225       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912905063139       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912905063533       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912905063435       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 3.756912e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912903637062       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912903938737       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912903978905       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912903989928       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912903992278       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912903994059       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912903994160       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912903994138       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912903994236       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912903994212       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 9.404112e-07

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912903637062       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912903712512       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912903722557       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912903725313       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912903725901       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912903726345       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912903726371       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912903726366       residual = 9.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912903726390       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912903726384       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+02 is 2.351769e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6966e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -3.762690e-02 3 1  ON 0
ci_002                -2.875732e-02 3 1  ON 1
ci_003                -2.367644e-02 3 1  ON 2
ci_004                 2.096021e-02 3 1  ON 3
ci_005                 2.155620e-02 3 1  ON 4
ci_006                -1.849788e-02 3 1  ON 5
ci_007                -1.847783e-02 3 1  ON 6
ci_008                -7.757779e-03 3 1  ON 7
ci_009                -1.401770e-02 3 1  ON 8
ci_010                -8.873477e-03 3 1  ON 9
ci_011                -9.143094e-03 3 1  ON 10
ci_012                -9.120042e-03 3 1  ON 11
ci_013                -1.923571e-02 3 1  ON 12
ci_014                 1.117970e-02 3 1  ON 13
ci_015                 1.103376e-02 3 1  ON 14
ci_016                 1.597452e-02 3 1  ON 15
ci_017                 1.566975e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981726e-03 3 1  ON 18
ci_020                 1.506431e-02 3 1  ON 19
ci_021                 1.519132e-02 3 1  ON 20
ci_022                 8.258840e-03 3 1  ON 21
ci_023                 8.361422e-03 3 1  ON 22
ci_024                 8.583314e-03 3 1  ON 23
ci_025                 8.594952e-03 3 1  ON 24
ci_026                 1.002825e-02 3 1  ON 25
ci_027                 9.639641e-03 3 1  ON 26
ci_028                -1.462461e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795181e-03 3 1  ON 29
ci_031                -8.562715e-03 3 1  ON 30
ci_032                -1.443908e-02 3 1  ON 31
ci_033                 4.554976e-03 3 1  ON 32
ci_034                 4.915458e-03 3 1  ON 33
ci_035                -3.348139e-03 3 1  ON 34
ci_036                -1.126236e-02 3 1  ON 35
ci_037                -1.150784e-02 3 1  ON 36
ci_038                 9.197942e-04 3 1  ON 37
ci_039                 1.223107e-03 3 1  ON 38
ci_040                -1.603131e-03 3 1  ON 39
ci_041                 8.179695e-03 3 1  ON 40
ci_042                 8.255700e-03 3 1  ON 41
ci_043                -2.385760e-03 3 1  ON 42
ci_044                -3.921403e-03 3 1  ON 43
ci_045                -1.869905e-03 3 1  ON 44
ci_046                 4.771137e-03 3 1  ON 45
ci_047                 4.645132e-03 3 1  ON 46
ci_048                -1.242668e-02 3 1  ON 47
ci_049                -1.288254e-02 3 1  ON 48
ci_050                 2.825489e-03 3 1  ON 49
ci_051                 2.816113e-03 3 1  ON 50
ci_052                -2.275639e-03 3 1  ON 51
ci_053                -2.209092e-03 3 1  ON 52
ci_054                -2.321204e-03 3 1  ON 53
ci_055                -2.375224e-03 3 1  ON 54
ci_056                 4.661154e-03 3 1  ON 55
ci_057                 4.675104e-03 3 1  ON 56
ci_058                -2.044401e-03 3 1  ON 57
ci_059                -2.118042e-03 3 1  ON 58
ci_060                 4.730576e-03 3 1  ON 59
ci_061                 5.181107e-03 3 1  ON 60
ci_062                -2.827686e-03 3 1  ON 61
ci_063                -2.781624e-03 3 1  ON 62
ci_064                -2.213567e-03 3 1  ON 63
ci_065                -3.398261e-03 3 1  ON 64
ci_066                 4.063177e-03 3 1  ON 65
ci_067                 4.160059e-03 3 1  ON 66
ci_068                -4.399370e-03 3 1  ON 67
ci_069                -4.115396e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.358037
====================================================
  Execution time = 1.3494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0201e-01
  Total weights = 1.9578e+06
  Execution time = 1.8665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348817536
                                         uncertainty =       0.001857340477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348817536
                                         uncertainty =       0.001857340477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379745226
  error estimate for blocks of size 2^( 2) =       0.000391075705
  error estimate for blocks of size 2^( 3) =       0.000401261935
  error estimate for blocks of size 2^( 4) =       0.000408560314
  error estimate for blocks of size 2^( 5) =       0.000413422562
  error estimate for blocks of size 2^( 6) =       0.000416803763
  error estimate for blocks of size 2^( 7) =       0.000417647901

      target function =      -0.909481742656
              le_mean =     -17.214729618708
             les_mean =     296.648925700631
             stat err =       0.000414108635
             autocorr =       1.189169954065
   target nu stat err =       0.000414108635
   target dn stat err =       0.002673362258
      target stat err =       0.004192940807
              std dev =       0.537040848693
             le_variance =       0.288412873165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348643172
                                         uncertainty =       0.001857437127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348643172
                                         uncertainty =       0.001857437127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379745106
  error estimate for blocks of size 2^( 2) =       0.000391075757
  error estimate for blocks of size 2^( 3) =       0.000401262213
  error estimate for blocks of size 2^( 4) =       0.000408560687
  error estimate for blocks of size 2^( 5) =       0.000413422918
  error estimate for blocks of size 2^( 6) =       0.000416804151
  error estimate for blocks of size 2^( 7) =       0.000417648451

      target function =      -0.909472466344
              le_mean =     -17.214729631363
             les_mean =     296.648932132599
             stat err =       0.000414109052
             autocorr =       1.189173097491
   target nu stat err =       0.000414109052
   target dn stat err =       0.002673719446
      target stat err =       0.004193401135
              std dev =       0.537040679120
             le_variance =       0.288412691030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348729544
                                         uncertainty =       0.001857388859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348729544
                                         uncertainty =       0.001857388859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379745165
  error estimate for blocks of size 2^( 2) =       0.000391075730
  error estimate for blocks of size 2^( 3) =       0.000401262074
  error estimate for blocks of size 2^( 4) =       0.000408560500
  error estimate for blocks of size 2^( 5) =       0.000413422739
  error estimate for blocks of size 2^( 6) =       0.000416803957
  error estimate for blocks of size 2^( 7) =       0.000417648176

      target function =      -0.909479423677
              le_mean =     -17.214729624904
             les_mean =     296.648927412203
             stat err =       0.000414108843
             autocorr =       1.189171527156
   target nu stat err =       0.000414108843
   target dn stat err =       0.002673522408
      target stat err =       0.004193163943
              std dev =       0.537040763147
             le_variance =       0.288412781282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348806458
                                         uncertainty =       0.001857346525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288348806458
                                         uncertainty =       0.001857346525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379745218
  error estimate for blocks of size 2^( 2) =       0.000391075708
  error estimate for blocks of size 2^( 3) =       0.000401261952
  error estimate for blocks of size 2^( 4) =       0.000408560337
  error estimate for blocks of size 2^( 5) =       0.000413422584
  error estimate for blocks of size 2^( 6) =       0.000416803787
  error estimate for blocks of size 2^( 7) =       0.000417647935

      target function =      -0.909481700655
              le_mean =     -17.214729619470
             les_mean =     296.648925753833
             stat err =       0.000414108661
             autocorr =       1.189170150667
   target nu stat err =       0.000414108661
   target dn stat err =       0.002673380590
      target stat err =       0.004192968381
              std dev =       0.537040837926
             le_variance =       0.288412861600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909481742656        initial  <--
     3.5527e+01     3.5527e+02             3.7569e-06        -0.909472466344
     1.4211e+02     1.4211e+03             9.4041e-07        -0.909479423677
     5.6843e+02     5.6843e+03             2.3518e-07        -0.909481700655

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8541
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -3.762727e-02 3 1  ON 0
ci_002                -2.875745e-02 3 1  ON 1
ci_003                -2.367618e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849776e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758185e-03 3 1  ON 7
ci_009                -1.401800e-02 3 1  ON 8
ci_010                -8.874098e-03 3 1  ON 9
ci_011                -9.142954e-03 3 1  ON 10
ci_012                -9.120750e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117994e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566981e-02 3 1  ON 16
ci_018                 9.080345e-03 3 1  ON 17
ci_019                 8.981681e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258593e-03 3 1  ON 21
ci_023                 8.361676e-03 3 1  ON 22
ci_024                 8.583197e-03 3 1  ON 23
ci_025                 8.594939e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639887e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795508e-03 3 1  ON 29
ci_031                -8.563494e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915585e-03 3 1  ON 33
ci_035                -3.348103e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201117e-04 3 1  ON 37
ci_039                 1.223275e-03 3 1  ON 38
ci_040                -1.603065e-03 3 1  ON 39
ci_041                 8.180223e-03 3 1  ON 40
ci_042                 8.255637e-03 3 1  ON 41
ci_043                -2.385652e-03 3 1  ON 42
ci_044                -3.921494e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771178e-03 3 1  ON 45
ci_047                 4.645447e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825028e-03 3 1  ON 49
ci_051                 2.816389e-03 3 1  ON 50
ci_052                -2.275296e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321167e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660829e-03 3 1  ON 55
ci_057                 4.675226e-03 3 1  ON 56
ci_058                -2.044630e-03 3 1  ON 57
ci_059                -2.118584e-03 3 1  ON 58
ci_060                 4.730495e-03 3 1  ON 59
ci_061                 5.181226e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213409e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063192e-03 3 1  ON 65
ci_067                 4.160625e-03 3 1  ON 66
ci_068                -4.398750e-03 3 1  ON 67
ci_069                -4.115054e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.206868
====================================================
  Execution time = 1.4062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0192e-01
  Total weights = 1.957557694e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285730516113
                                         uncertainty =       0.002443396590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285730516113
                                         uncertainty =       0.002443396590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377971292
  error estimate for blocks of size 2^( 2) =       0.000389383473
  error estimate for blocks of size 2^( 3) =       0.000399965399
  error estimate for blocks of size 2^( 4) =       0.000407380068
  error estimate for blocks of size 2^( 5) =       0.000411732355
  error estimate for blocks of size 2^( 6) =       0.000414795713
  error estimate for blocks of size 2^( 7) =       0.000416655459

      target function =      -0.909597306135
              le_mean =     -17.214532019491
             les_mean =     296.642035522629
             stat err =       0.000412640899
             autocorr =       1.191864570977
   target nu stat err =       0.000412640899
   target dn stat err =       0.004211540285
      target stat err =       0.006548784478
              std dev =       0.534532127592
             le_variance =       0.285724595428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721453201949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+02, overlap shift 3.5527e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909643595464       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909643739044       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909643762221       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909643768914       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909643769351       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909643769467       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909643769439       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909643769373       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909643769365       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909643769380       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+02 is 4.507097e-07

solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909643595464       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909643631365       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909643637160       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909643638833       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909643638943       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909643638971       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909643638961       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909643638948       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909643638946       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909643638950       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 1.126929e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909643595464       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909643604439       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909643605888       residual = 5.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909643606307       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909643606334       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909643606343       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909643606345       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909643606336       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909643606327       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909643606324       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 2.817419e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6584e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -3.762717e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096112e-02 3 1  ON 3
ci_005                 2.155711e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847791e-02 3 1  ON 6
ci_008                -7.758162e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874093e-03 3 1  ON 9
ci_011                -9.142921e-03 3 1  ON 10
ci_012                -9.120692e-03 3 1  ON 11
ci_013                -1.923574e-02 3 1  ON 12
ci_014                 1.117986e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597430e-02 3 1  ON 15
ci_017                 1.566987e-02 3 1  ON 16
ci_018                 9.080330e-03 3 1  ON 17
ci_019                 8.981638e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519136e-02 3 1  ON 20
ci_022                 8.258626e-03 3 1  ON 21
ci_023                 8.361612e-03 3 1  ON 22
ci_024                 8.583084e-03 3 1  ON 23
ci_025                 8.594965e-03 3 1  ON 24
ci_026                 1.002829e-02 3 1  ON 25
ci_027                 9.639843e-03 3 1  ON 26
ci_028                -1.462454e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795580e-03 3 1  ON 29
ci_031                -8.563445e-03 3 1  ON 30
ci_032                -1.443916e-02 3 1  ON 31
ci_033                 4.554545e-03 3 1  ON 32
ci_034                 4.915649e-03 3 1  ON 33
ci_035                -3.348088e-03 3 1  ON 34
ci_036                -1.126187e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201087e-04 3 1  ON 37
ci_039                 1.223233e-03 3 1  ON 38
ci_040                -1.603107e-03 3 1  ON 39
ci_041                 8.180238e-03 3 1  ON 40
ci_042                 8.255676e-03 3 1  ON 41
ci_043                -2.385667e-03 3 1  ON 42
ci_044                -3.921431e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771163e-03 3 1  ON 45
ci_047                 4.645474e-03 3 1  ON 46
ci_048                -1.242651e-02 3 1  ON 47
ci_049                -1.288215e-02 3 1  ON 48
ci_050                 2.825073e-03 3 1  ON 49
ci_051                 2.816430e-03 3 1  ON 50
ci_052                -2.275271e-03 3 1  ON 51
ci_053                -2.208963e-03 3 1  ON 52
ci_054                -2.321162e-03 3 1  ON 53
ci_055                -2.375163e-03 3 1  ON 54
ci_056                 4.660776e-03 3 1  ON 55
ci_057                 4.675214e-03 3 1  ON 56
ci_058                -2.044673e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730511e-03 3 1  ON 59
ci_061                 5.181188e-03 3 1  ON 60
ci_062                -2.828200e-03 3 1  ON 61
ci_063                -2.781406e-03 3 1  ON 62
ci_064                -2.213394e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063198e-03 3 1  ON 65
ci_067                 4.160633e-03 3 1  ON 66
ci_068                -4.398793e-03 3 1  ON 67
ci_069                -4.115070e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.164487
====================================================
  Execution time = 1.3241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9940e-01
  Total weights = 1.9578e+06
  Execution time = 1.8472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609401234
                                         uncertainty =       0.001748322534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609401234
                                         uncertainty =       0.001748322534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377910289
  error estimate for blocks of size 2^( 2) =       0.000389731816
  error estimate for blocks of size 2^( 3) =       0.000400150677
  error estimate for blocks of size 2^( 4) =       0.000408031642
  error estimate for blocks of size 2^( 5) =       0.000412116784
  error estimate for blocks of size 2^( 6) =       0.000415426955
  error estimate for blocks of size 2^( 7) =       0.000417631346

      target function =      -0.913533799772
              le_mean =     -17.214917319365
             les_mean =     296.652774906453
             stat err =       0.000413301682
             autocorr =       1.196070868625
   target nu stat err =       0.000413301682
   target dn stat err =       0.002616716678
      target stat err =       0.004143978751
              std dev =       0.534445855927
             le_variance =       0.285632372918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609343440
                                         uncertainty =       0.001748330779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609343440
                                         uncertainty =       0.001748330779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377910251
  error estimate for blocks of size 2^( 2) =       0.000389731792
  error estimate for blocks of size 2^( 3) =       0.000400150673
  error estimate for blocks of size 2^( 4) =       0.000408031644
  error estimate for blocks of size 2^( 5) =       0.000412116789
  error estimate for blocks of size 2^( 6) =       0.000415426964
  error estimate for blocks of size 2^( 7) =       0.000417631337

      target function =      -0.913533797972
              le_mean =     -17.214917322737
             les_mean =     296.652775022864
             stat err =       0.000413301684
             autocorr =       1.196071117366
   target nu stat err =       0.000413301684
   target dn stat err =       0.002616800389
      target stat err =       0.004144107488
              std dev =       0.534445802537
             le_variance =       0.285632315850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609372325
                                         uncertainty =       0.001748326657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609372325
                                         uncertainty =       0.001748326657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377910270
  error estimate for blocks of size 2^( 2) =       0.000389731804
  error estimate for blocks of size 2^( 3) =       0.000400150675
  error estimate for blocks of size 2^( 4) =       0.000408031643
  error estimate for blocks of size 2^( 5) =       0.000412116786
  error estimate for blocks of size 2^( 6) =       0.000415426960
  error estimate for blocks of size 2^( 7) =       0.000417631341

      target function =      -0.913533799580
              le_mean =     -17.214917321050
             les_mean =     296.652774964172
             stat err =       0.000413301683
             autocorr =       1.196070993019
   target nu stat err =       0.000413301683
   target dn stat err =       0.002616758532
      target stat err =       0.004144043123
              std dev =       0.534445829221
             le_variance =       0.285632344372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609397620
                                         uncertainty =       0.001748323049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285609397620
                                         uncertainty =       0.001748323049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377910287
  error estimate for blocks of size 2^( 2) =       0.000389731814
  error estimate for blocks of size 2^( 3) =       0.000400150676
  error estimate for blocks of size 2^( 4) =       0.000408031642
  error estimate for blocks of size 2^( 5) =       0.000412116785
  error estimate for blocks of size 2^( 6) =       0.000415426956
  error estimate for blocks of size 2^( 7) =       0.000417631345

      target function =      -0.913533799826
              le_mean =     -17.214917319576
             les_mean =     296.652774913614
             stat err =       0.000413301682
             autocorr =       1.196070884182
   target nu stat err =       0.000413301682
   target dn stat err =       0.002616721909
      target stat err =       0.004143986797
              std dev =       0.534445852588
             le_variance =       0.285632369349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913533799772        initial
     3.5527e+02     3.5527e+03             4.5071e-07        -0.913533797972
     1.4211e+03     1.4211e+04             1.1269e-07        -0.913533799580
     5.6843e+03     5.6843e+04             2.8174e-08        -0.913533799826  <--

*****************************************************************************
Applying the update for shift_i =   5.6843e+03     and shift_s =   5.6843e+04
*****************************************************************************

  Execution time = 2.2562e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874097e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080341e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583169e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639876e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563482e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201110e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816399e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208902e-03 3 1  ON 52
ci_054                -2.321166e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2125
    reference variance = 0.251686
====================================================
  Execution time = 1.3775e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0186e-01
  Total weights = 1.958012770e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504683226
                                         uncertainty =       0.001822958238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286504683226
                                         uncertainty =       0.001822958238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378474052
  error estimate for blocks of size 2^( 2) =       0.000389858894
  error estimate for blocks of size 2^( 3) =       0.000400241970
  error estimate for blocks of size 2^( 4) =       0.000408180524
  error estimate for blocks of size 2^( 5) =       0.000412486331
  error estimate for blocks of size 2^( 6) =       0.000415545873
  error estimate for blocks of size 2^( 7) =       0.000418329160

      target function =      -0.909676997872
              le_mean =     -17.215540797654
             les_mean =     296.676701569478
             stat err =       0.000413635472
             autocorr =       1.194437227933
   target nu stat err =       0.000413635472
   target dn stat err =       0.002941549179
      target stat err =       0.004611079825
              std dev =       0.535243137437
             le_variance =       0.286485216173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721554079765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909699409215       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909699436468       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909699440439       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909699441373       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909699441492       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909699441585       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909699441628       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909699441621       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909699441618       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909699441622       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+03 is 7.153853e-08

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909699409215       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909699416029       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909699417021       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909699417254       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909699417292       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909699417300       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909699417323       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909699417317       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909699417324       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909699417317       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+03 is 1.788527e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909699409215       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909699410919       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909699411167       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909699411228       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909699411245       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909699411242       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909699411241       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909699411262       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909699411260       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909699411232       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+04 is 4.471358e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6292e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875742e-02 3 1  ON 1
ci_003                -2.367615e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155712e-02 3 1  ON 4
ci_006                -1.849774e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758186e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874100e-03 3 1  ON 9
ci_011                -9.142943e-03 3 1  ON 10
ci_012                -9.120721e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103420e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080357e-03 3 1  ON 17
ci_019                 8.981674e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519134e-02 3 1  ON 20
ci_022                 8.258583e-03 3 1  ON 21
ci_023                 8.361652e-03 3 1  ON 22
ci_024                 8.583178e-03 3 1  ON 23
ci_025                 8.594944e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639875e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795531e-03 3 1  ON 29
ci_031                -8.563485e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554549e-03 3 1  ON 32
ci_034                 4.915605e-03 3 1  ON 33
ci_035                -3.348090e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150775e-02 3 1  ON 36
ci_038                 9.200979e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603083e-03 3 1  ON 39
ci_041                 8.180220e-03 3 1  ON 40
ci_042                 8.255660e-03 3 1  ON 41
ci_043                -2.385664e-03 3 1  ON 42
ci_044                -3.921471e-03 3 1  ON 43
ci_045                -1.870153e-03 3 1  ON 44
ci_046                 4.771175e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825047e-03 3 1  ON 49
ci_051                 2.816403e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208898e-03 3 1  ON 52
ci_054                -2.321171e-03 3 1  ON 53
ci_055                -2.375170e-03 3 1  ON 54
ci_056                 4.660825e-03 3 1  ON 55
ci_057                 4.675222e-03 3 1  ON 56
ci_058                -2.044649e-03 3 1  ON 57
ci_059                -2.118591e-03 3 1  ON 58
ci_060                 4.730501e-03 3 1  ON 59
ci_061                 5.181205e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781400e-03 3 1  ON 62
ci_064                -2.213412e-03 3 1  ON 63
ci_065                -3.398050e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398757e-03 3 1  ON 67
ci_069                -4.115068e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.295514
====================================================
  Execution time = 1.3354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0009e-01
  Total weights = 1.9576e+06
  Execution time = 1.8554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120259451
                                         uncertainty =       0.002009412769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120259451
                                         uncertainty =       0.002009412769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378893674
  error estimate for blocks of size 2^( 2) =       0.000390440057
  error estimate for blocks of size 2^( 3) =       0.000400710156
  error estimate for blocks of size 2^( 4) =       0.000408235929
  error estimate for blocks of size 2^( 5) =       0.000413134964
  error estimate for blocks of size 2^( 6) =       0.000416792454
  error estimate for blocks of size 2^( 7) =       0.000417617936

      target function =      -0.912439428599
              le_mean =     -17.215156455420
             les_mean =     296.661702331793
             stat err =       0.000413945321
             autocorr =       1.193579210898
   target nu stat err =       0.000413945321
   target dn stat err =       0.002797456327
      target stat err =       0.004413870488
              std dev =       0.535836572620
             le_variance =       0.287120832557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120246221
                                         uncertainty =       0.002009412122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120246221
                                         uncertainty =       0.002009412122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378893665
  error estimate for blocks of size 2^( 2) =       0.000390440048
  error estimate for blocks of size 2^( 3) =       0.000400710147
  error estimate for blocks of size 2^( 4) =       0.000408235920
  error estimate for blocks of size 2^( 5) =       0.000413134953
  error estimate for blocks of size 2^( 6) =       0.000416792441
  error estimate for blocks of size 2^( 7) =       0.000417617925

      target function =      -0.912439305665
              le_mean =     -17.215156456171
             les_mean =     296.661702436513
             stat err =       0.000413945310
             autocorr =       1.193579203666
   target nu stat err =       0.000413945310
   target dn stat err =       0.002797459219
      target stat err =       0.004413873763
              std dev =       0.535836560281
             le_variance =       0.287120819334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120252836
                                         uncertainty =       0.002009412445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120252836
                                         uncertainty =       0.002009412445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378893670
  error estimate for blocks of size 2^( 2) =       0.000390440052
  error estimate for blocks of size 2^( 3) =       0.000400710152
  error estimate for blocks of size 2^( 4) =       0.000408235924
  error estimate for blocks of size 2^( 5) =       0.000413134958
  error estimate for blocks of size 2^( 6) =       0.000416792447
  error estimate for blocks of size 2^( 7) =       0.000417617931

      target function =      -0.912439367175
              le_mean =     -17.215156455795
             les_mean =     296.661702384124
             stat err =       0.000413945315
             autocorr =       1.193579207287
   target nu stat err =       0.000413945315
   target dn stat err =       0.002797457771
      target stat err =       0.004413872123
              std dev =       0.535836566450
             le_variance =       0.287120825945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120258624
                                         uncertainty =       0.002009412729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287120258624
                                         uncertainty =       0.002009412729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378893674
  error estimate for blocks of size 2^( 2) =       0.000390440056
  error estimate for blocks of size 2^( 3) =       0.000400710155
  error estimate for blocks of size 2^( 4) =       0.000408235928
  error estimate for blocks of size 2^( 5) =       0.000413134963
  error estimate for blocks of size 2^( 6) =       0.000416792453
  error estimate for blocks of size 2^( 7) =       0.000417617935

      target function =      -0.912439420926
              le_mean =     -17.215156455467
             les_mean =     296.661702338331
             stat err =       0.000413945320
             autocorr =       1.193579210444
   target nu stat err =       0.000413945320
   target dn stat err =       0.002797456508
      target stat err =       0.004413870692
              std dev =       0.535836571849
             le_variance =       0.287120831731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912439428599        initial  <--
     1.4211e+03     1.4211e+04             7.1539e-08        -0.912439305665
     5.6843e+03     5.6843e+04             1.7885e-08        -0.912439367175
     2.2737e+04     2.2737e+05             4.4714e-09        -0.912439420926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7211
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874097e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080341e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583169e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639876e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563482e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201110e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816399e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208902e-03 3 1  ON 52
ci_054                -2.321166e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.22138
====================================================
  Execution time = 1.5325e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0387e-01
  Total weights = 1.957590022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288935541681
                                         uncertainty =       0.002070711415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288935541681
                                         uncertainty =       0.002070711415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380052799
  error estimate for blocks of size 2^( 2) =       0.000391162991
  error estimate for blocks of size 2^( 3) =       0.000401610072
  error estimate for blocks of size 2^( 4) =       0.000409642748
  error estimate for blocks of size 2^( 5) =       0.000414608699
  error estimate for blocks of size 2^( 6) =       0.000417850826
  error estimate for blocks of size 2^( 7) =       0.000418892964

      target function =      -0.906587666498
              le_mean =     -17.214874330930
             les_mean =     296.655770599076
             stat err =       0.000415248809
             autocorr =       1.193792702614
   target nu stat err =       0.000415248809
   target dn stat err =       0.003664600300
      target stat err =       0.005675458924
              std dev =       0.537475823434
             le_variance =       0.288880260776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721487433093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906622106526       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906622110816       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906622111321       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906622111515       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906622111508       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906622111541       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906622111543       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906622111547       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906622111531       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906622111517       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+04 is 9.944727e-09

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906622106526       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906622107599       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906622107725       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906622107774       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906622107825       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906622107789       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906622107834       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906622107788       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906622107843       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906622107750       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+04 is 2.486189e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906622106526       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906622106794       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906622106826       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906622106838       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906622106640       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906622106708       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906622106800       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906622106344       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906622106801       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906622106932       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+05 is 6.215478e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8008e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -3.762725e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874094e-03 3 1  ON 9
ci_011                -9.142944e-03 3 1  ON 10
ci_012                -9.120735e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080339e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519136e-02 3 1  ON 20
ci_022                 8.258600e-03 3 1  ON 21
ci_023                 8.361661e-03 3 1  ON 22
ci_024                 8.583168e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639874e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563483e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554544e-03 3 1  ON 32
ci_034                 4.915600e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201116e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255648e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816401e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208900e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730498e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063195e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115061e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1718
    reference variance = 0.236584
====================================================
  Execution time = 1.3442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0126e-01
  Total weights = 1.9579e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182386097
                                         uncertainty =       0.001790205748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182386097
                                         uncertainty =       0.001790205748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378913433
  error estimate for blocks of size 2^( 2) =       0.000390275936
  error estimate for blocks of size 2^( 3) =       0.000400767484
  error estimate for blocks of size 2^( 4) =       0.000409593714
  error estimate for blocks of size 2^( 5) =       0.000413831454
  error estimate for blocks of size 2^( 6) =       0.000415991808
  error estimate for blocks of size 2^( 7) =       0.000417806489

      target function =      -0.910658228823
              le_mean =     -17.214350496747
             les_mean =     296.635121740925
             stat err =       0.000414305866
             autocorr =       1.195534632029
   target nu stat err =       0.000414305866
   target dn stat err =       0.002858083716
      target stat err =       0.004483080156
              std dev =       0.535864516135
             le_variance =       0.287150779653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182385729
                                         uncertainty =       0.001790205699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182385729
                                         uncertainty =       0.001790205699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378913433
  error estimate for blocks of size 2^( 2) =       0.000390275936
  error estimate for blocks of size 2^( 3) =       0.000400767485
  error estimate for blocks of size 2^( 4) =       0.000409593715
  error estimate for blocks of size 2^( 5) =       0.000413831455
  error estimate for blocks of size 2^( 6) =       0.000415991809
  error estimate for blocks of size 2^( 7) =       0.000417806490

      target function =      -0.910658227679
              le_mean =     -17.214350496635
             les_mean =     296.635121737782
             stat err =       0.000414305867
             autocorr =       1.195534639323
   target nu stat err =       0.000414305867
   target dn stat err =       0.002858084401
      target stat err =       0.004483081192
              std dev =       0.535864515787
             le_variance =       0.287150779280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182385913
                                         uncertainty =       0.001790205723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182385913
                                         uncertainty =       0.001790205723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378913433
  error estimate for blocks of size 2^( 2) =       0.000390275936
  error estimate for blocks of size 2^( 3) =       0.000400767484
  error estimate for blocks of size 2^( 4) =       0.000409593714
  error estimate for blocks of size 2^( 5) =       0.000413831455
  error estimate for blocks of size 2^( 6) =       0.000415991808
  error estimate for blocks of size 2^( 7) =       0.000417806490

      target function =      -0.910658228252
              le_mean =     -17.214350496691
             les_mean =     296.635121739353
             stat err =       0.000414305867
             autocorr =       1.195534635680
   target nu stat err =       0.000414305867
   target dn stat err =       0.002858084059
      target stat err =       0.004483080674
              std dev =       0.535864515961
             le_variance =       0.287150779466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182386074
                                         uncertainty =       0.001790205745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287182386074
                                         uncertainty =       0.001790205745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378913433
  error estimate for blocks of size 2^( 2) =       0.000390275936
  error estimate for blocks of size 2^( 3) =       0.000400767484
  error estimate for blocks of size 2^( 4) =       0.000409593714
  error estimate for blocks of size 2^( 5) =       0.000413831454
  error estimate for blocks of size 2^( 6) =       0.000415991808
  error estimate for blocks of size 2^( 7) =       0.000417806490

      target function =      -0.910658228752
              le_mean =     -17.214350496740
             les_mean =     296.635121740729
             stat err =       0.000414305866
             autocorr =       1.195534632468
   target nu stat err =       0.000414305866
   target dn stat err =       0.002858083759
      target stat err =       0.004483080221
              std dev =       0.535864516113
             le_variance =       0.287150779629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910658228823        initial  <--
     1.4211e+04     1.4211e+05             9.9447e-09        -0.910658227679
     5.6843e+04     5.6843e+05             2.4862e-09        -0.910658228252
     2.2737e+05     2.2737e+06             6.2155e-10        -0.910658228752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8802
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874097e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080341e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583169e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639876e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563482e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201110e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816399e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208902e-03 3 1  ON 52
ci_054                -2.321166e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1418
    reference variance = 0.320146
====================================================
  Execution time = 1.3790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9995e-01
  Total weights = 1.957731939e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287968875724
                                         uncertainty =       0.002034562072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287968875724
                                         uncertainty =       0.002034562072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379471840
  error estimate for blocks of size 2^( 2) =       0.000390866672
  error estimate for blocks of size 2^( 3) =       0.000400779900
  error estimate for blocks of size 2^( 4) =       0.000408011164
  error estimate for blocks of size 2^( 5) =       0.000412208672
  error estimate for blocks of size 2^( 6) =       0.000415823610
  error estimate for blocks of size 2^( 7) =       0.000416839520

      target function =      -0.912694141269
              le_mean =     -17.214371953079
             les_mean =     296.634548330323
             stat err =       0.000413220742
             autocorr =       1.185782727175
   target nu stat err =       0.000413220742
   target dn stat err =       0.002864908834
      target stat err =       0.004513281991
              std dev =       0.536654222226
             le_variance =       0.287997754233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721437195308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912715674816       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912715675057       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912715675089       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912715674969       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912715675103       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912715675070       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912715675103       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912715675237       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912715675040       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912715675171       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 7.591929e-10

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912715674816       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912715674876       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912715674884       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912715674887       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912715674759       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912715674945       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912715674548       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912715674912       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912715674862       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912715675009       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+05 is 1.897983e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912715674816       residual = 8.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912715674831       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912715674833       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912715674834       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912715673806       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912715672009       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912715677987       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912715675846       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912715671196       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912715675807       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+06 is 4.744959e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253560 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6305e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874097e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120735e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080342e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583169e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639876e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563482e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201109e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816399e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208901e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.279676
====================================================
  Execution time = 1.3243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0112e-01
  Total weights = 1.9575e+06
  Execution time = 1.8453e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708293
                                         uncertainty =       0.001684874265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708293
                                         uncertainty =       0.001684874265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125911
  error estimate for blocks of size 2^( 2) =       0.000390546375
  error estimate for blocks of size 2^( 3) =       0.000401198809
  error estimate for blocks of size 2^( 4) =       0.000408828338
  error estimate for blocks of size 2^( 5) =       0.000414038535
  error estimate for blocks of size 2^( 6) =       0.000417197914
  error estimate for blocks of size 2^( 7) =       0.000417170289

      target function =      -0.910873995289
              le_mean =     -17.214452295264
             les_mean =     296.638488987715
             stat err =       0.000414308769
             autocorr =       1.194211687204
   target nu stat err =       0.000414308769
   target dn stat err =       0.002350483006
      target stat err =       0.003711018035
              std dev =       0.536165004885
             le_variance =       0.287472912463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708166
                                         uncertainty =       0.001684874258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708166
                                         uncertainty =       0.001684874258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125911
  error estimate for blocks of size 2^( 2) =       0.000390546375
  error estimate for blocks of size 2^( 3) =       0.000401198809
  error estimate for blocks of size 2^( 4) =       0.000408828338
  error estimate for blocks of size 2^( 5) =       0.000414038535
  error estimate for blocks of size 2^( 6) =       0.000417197914
  error estimate for blocks of size 2^( 7) =       0.000417170289

      target function =      -0.910873996398
              le_mean =     -17.214452295261
             les_mean =     296.638488986891
             stat err =       0.000414308769
             autocorr =       1.194211688423
   target nu stat err =       0.000414308769
   target dn stat err =       0.002350482953
      target stat err =       0.003711017963
              std dev =       0.536165004769
             le_variance =       0.287472912338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708230
                                         uncertainty =       0.001684874261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708230
                                         uncertainty =       0.001684874261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125911
  error estimate for blocks of size 2^( 2) =       0.000390546375
  error estimate for blocks of size 2^( 3) =       0.000401198809
  error estimate for blocks of size 2^( 4) =       0.000408828338
  error estimate for blocks of size 2^( 5) =       0.000414038535
  error estimate for blocks of size 2^( 6) =       0.000417197914
  error estimate for blocks of size 2^( 7) =       0.000417170289

      target function =      -0.910873995844
              le_mean =     -17.214452295263
             les_mean =     296.638488987303
             stat err =       0.000414308769
             autocorr =       1.194211687815
   target nu stat err =       0.000414308769
   target dn stat err =       0.002350482979
      target stat err =       0.003711017999
              std dev =       0.536165004827
             le_variance =       0.287472912401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708285
                                         uncertainty =       0.001684874265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287537708285
                                         uncertainty =       0.001684874265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125911
  error estimate for blocks of size 2^( 2) =       0.000390546375
  error estimate for blocks of size 2^( 3) =       0.000401198809
  error estimate for blocks of size 2^( 4) =       0.000408828338
  error estimate for blocks of size 2^( 5) =       0.000414038535
  error estimate for blocks of size 2^( 6) =       0.000417197914
  error estimate for blocks of size 2^( 7) =       0.000417170289

      target function =      -0.910873995358
              le_mean =     -17.214452295264
             les_mean =     296.638488987663
             stat err =       0.000414308769
             autocorr =       1.194211687286
   target nu stat err =       0.000414308769
   target dn stat err =       0.002350483003
      target stat err =       0.003711018031
              std dev =       0.536165004878
             le_variance =       0.287472912456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910873995289        initial
     1.4211e+05     1.4211e+06             7.5919e-10        -0.910873996398  <--
     5.6843e+05     5.6843e+06             1.8980e-10        -0.910873995844
     2.2737e+06     2.2737e+07             4.7450e-11        -0.910873995358

*****************************************************************************
Applying the update for shift_i =   1.4211e+05     and shift_s =   1.4211e+06
*****************************************************************************

  Execution time = 2.2588e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874096e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120735e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080342e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583168e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639876e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563482e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201107e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921478e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825039e-03 3 1  ON 49
ci_051                 2.816399e-03 3 1  ON 50
ci_052                -2.275289e-03 3 1  ON 51
ci_053                -2.208901e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660815e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781407e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398760e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1764
    reference variance = 0.137082
====================================================
  Execution time = 1.3676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9633e-01
  Total weights = 1.957948738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284012691637
                                         uncertainty =       0.001759722353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284012691637
                                         uncertainty =       0.001759722353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376853622
  error estimate for blocks of size 2^( 2) =       0.000387998113
  error estimate for blocks of size 2^( 3) =       0.000398920427
  error estimate for blocks of size 2^( 4) =       0.000406048107
  error estimate for blocks of size 2^( 5) =       0.000412079640
  error estimate for blocks of size 2^( 6) =       0.000413143231
  error estimate for blocks of size 2^( 7) =       0.000413247288

      target function =      -0.918358799955
              le_mean =     -17.214686871315
             les_mean =     296.641769495422
             stat err =       0.000411129566
             autocorr =       1.190178314636
   target nu stat err =       0.000411129566
   target dn stat err =       0.002570898476
      target stat err =       0.004113623666
              std dev =       0.532951503319
             le_variance =       0.284037304890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721468687131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918376385068       residual = 8.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918376386039       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918376386197       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918376386235       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918376386259       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918376386266       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918376386295       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918376386297       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918376386201       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918376386238       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+04 is 3.545772e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918376385068       residual = 8.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918376385310       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918376385350       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918376385359       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918376385443       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918376385448       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918376385433       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918376385379       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918376385353       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918376385400       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 8.864444e-10

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918376385068       residual = 8.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918376385128       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918376385138       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918376385140       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918376385123       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918376385710       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918376385355       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918376384915       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918376384173       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918376384078       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+05 is 2.216112e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6180e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874097e-03 3 1  ON 9
ci_011                -9.142945e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080342e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258601e-03 3 1  ON 21
ci_023                 8.361660e-03 3 1  ON 22
ci_024                 8.583168e-03 3 1  ON 23
ci_025                 8.594945e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639875e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563483e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201103e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603076e-03 3 1  ON 39
ci_041                 8.180227e-03 3 1  ON 40
ci_042                 8.255647e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921479e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816400e-03 3 1  ON 50
ci_052                -2.275289e-03 3 1  ON 51
ci_053                -2.208901e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660815e-03 3 1  ON 55
ci_057                 4.675222e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730499e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781406e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398760e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2213
    reference variance = 0.271633
====================================================
  Execution time = 1.3436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9856e-01
  Total weights = 1.9575e+06
  Execution time = 1.8559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695835
                                         uncertainty =       0.001821519714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695835
                                         uncertainty =       0.001821519714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378421447
  error estimate for blocks of size 2^( 2) =       0.000389878173
  error estimate for blocks of size 2^( 3) =       0.000400575247
  error estimate for blocks of size 2^( 4) =       0.000407938889
  error estimate for blocks of size 2^( 5) =       0.000413506057
  error estimate for blocks of size 2^( 6) =       0.000415475668
  error estimate for blocks of size 2^( 7) =       0.000416307372

      target function =      -0.914841237877
              le_mean =     -17.214746750005
             les_mean =     296.646070062071
             stat err =       0.000413306996
             autocorr =       1.192872508707
   target nu stat err =       0.000413306996
   target dn stat err =       0.002552477754
      target stat err =       0.004055351033
              std dev =       0.535168742709
             le_variance =       0.286405583173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695515
                                         uncertainty =       0.001821519716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695515
                                         uncertainty =       0.001821519716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378421447
  error estimate for blocks of size 2^( 2) =       0.000389878173
  error estimate for blocks of size 2^( 3) =       0.000400575247
  error estimate for blocks of size 2^( 4) =       0.000407938889
  error estimate for blocks of size 2^( 5) =       0.000413506056
  error estimate for blocks of size 2^( 6) =       0.000415475668
  error estimate for blocks of size 2^( 7) =       0.000416307372

      target function =      -0.914841239642
              le_mean =     -17.214746749983
             les_mean =     296.646070060192
             stat err =       0.000413306996
             autocorr =       1.192872509522
   target nu stat err =       0.000413306996
   target dn stat err =       0.002552477220
      target stat err =       0.004055350225
              std dev =       0.535168742396
             le_variance =       0.286405582837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695675
                                         uncertainty =       0.001821519715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695675
                                         uncertainty =       0.001821519715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378421447
  error estimate for blocks of size 2^( 2) =       0.000389878173
  error estimate for blocks of size 2^( 3) =       0.000400575247
  error estimate for blocks of size 2^( 4) =       0.000407938889
  error estimate for blocks of size 2^( 5) =       0.000413506057
  error estimate for blocks of size 2^( 6) =       0.000415475668
  error estimate for blocks of size 2^( 7) =       0.000416307372

      target function =      -0.914841238759
              le_mean =     -17.214746749994
             les_mean =     296.646070061132
             stat err =       0.000413306996
             autocorr =       1.192872509111
   target nu stat err =       0.000413306996
   target dn stat err =       0.002552477487
      target stat err =       0.004055350629
              std dev =       0.535168742552
             le_variance =       0.286405583005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695815
                                         uncertainty =       0.001821519714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286415695815
                                         uncertainty =       0.001821519714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378421447
  error estimate for blocks of size 2^( 2) =       0.000389878173
  error estimate for blocks of size 2^( 3) =       0.000400575247
  error estimate for blocks of size 2^( 4) =       0.000407938889
  error estimate for blocks of size 2^( 5) =       0.000413506057
  error estimate for blocks of size 2^( 6) =       0.000415475668
  error estimate for blocks of size 2^( 7) =       0.000416307372

      target function =      -0.914841237987
              le_mean =     -17.214746750004
             les_mean =     296.646070061954
             stat err =       0.000413306996
             autocorr =       1.192872508755
   target nu stat err =       0.000413306996
   target dn stat err =       0.002552477721
      target stat err =       0.004055350983
              std dev =       0.535168742689
             le_variance =       0.286405583152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914841237877        initial
     3.5527e+04     3.5527e+05             3.5458e-09        -0.914841239642  <--
     1.4211e+05     1.4211e+06             8.8644e-10        -0.914841238759
     5.6843e+05     5.6843e+06             2.2161e-10        -0.914841237987

*****************************************************************************
Applying the update for shift_i =   3.5527e+04     and shift_s =   3.5527e+05
*****************************************************************************

  Execution time = 2.2797e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096114e-02 3 1  ON 3
ci_005                 2.155712e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874098e-03 3 1  ON 9
ci_011                -9.142946e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103421e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080343e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258602e-03 3 1  ON 21
ci_023                 8.361659e-03 3 1  ON 22
ci_024                 8.583169e-03 3 1  ON 23
ci_025                 8.594946e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639874e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563485e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554540e-03 3 1  ON 32
ci_034                 4.915599e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201091e-04 3 1  ON 37
ci_039                 1.223263e-03 3 1  ON 38
ci_040                -1.603075e-03 3 1  ON 39
ci_041                 8.180228e-03 3 1  ON 40
ci_042                 8.255646e-03 3 1  ON 41
ci_043                -2.385655e-03 3 1  ON 42
ci_044                -3.921480e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771175e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816401e-03 3 1  ON 50
ci_052                -2.275289e-03 3 1  ON 51
ci_053                -2.208900e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660816e-03 3 1  ON 55
ci_057                 4.675222e-03 3 1  ON 56
ci_058                -2.044642e-03 3 1  ON 57
ci_059                -2.118586e-03 3 1  ON 58
ci_060                 4.730500e-03 3 1  ON 59
ci_061                 5.181217e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781403e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063194e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398758e-03 3 1  ON 67
ci_069                -4.115060e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.392569
====================================================
  Execution time = 1.3846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0408e-01
  Total weights = 1.957695519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289670278626
                                         uncertainty =       0.003265571736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289670278626
                                         uncertainty =       0.003265571736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380554346
  error estimate for blocks of size 2^( 2) =       0.000391992380
  error estimate for blocks of size 2^( 3) =       0.000402309577
  error estimate for blocks of size 2^( 4) =       0.000410255345
  error estimate for blocks of size 2^( 5) =       0.000414659187
  error estimate for blocks of size 2^( 6) =       0.000417379379
  error estimate for blocks of size 2^( 7) =       0.000419811493

      target function =      -0.906239906709
              le_mean =     -17.215020949863
             les_mean =     296.661029561669
             stat err =       0.000415526351
             autocorr =       1.192240219635
   target nu stat err =       0.000415526351
   target dn stat err =       0.004404818875
      target stat err =       0.006802525193
              std dev =       0.538185117116
             le_variance =       0.289643220285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721502094986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906290501002       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906290513878       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906290515442       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906290515861       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906290515907       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906290515943       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906290515962       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906290515953       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906290515934       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906290515934       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+03 is 3.101210e-08

solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906290501002       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906290504221       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906290504612       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906290504710       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906290504733       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906290504761       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906290504714       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906290504779       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906290504786       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906290504670       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+04 is 7.753072e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906290501002       residual = 2.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906290501806       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906290501904       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906290501930       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906290501933       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906290501934       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906290501942       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906290501935       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906290501864       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906290502036       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+05 is 1.938271e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6376e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874106e-03 3 1  ON 9
ci_011                -9.142942e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117992e-02 3 1  ON 13
ci_015                 1.103420e-02 3 1  ON 14
ci_016                 1.597431e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080342e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258603e-03 3 1  ON 21
ci_023                 8.361657e-03 3 1  ON 22
ci_024                 8.583166e-03 3 1  ON 23
ci_025                 8.594942e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639869e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500989e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563485e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554537e-03 3 1  ON 32
ci_034                 4.915599e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201091e-04 3 1  ON 37
ci_039                 1.223264e-03 3 1  ON 38
ci_040                -1.603075e-03 3 1  ON 39
ci_041                 8.180222e-03 3 1  ON 40
ci_042                 8.255645e-03 3 1  ON 41
ci_043                -2.385654e-03 3 1  ON 42
ci_044                -3.921475e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645454e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816402e-03 3 1  ON 50
ci_052                -2.275288e-03 3 1  ON 51
ci_053                -2.208901e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375180e-03 3 1  ON 54
ci_056                 4.660815e-03 3 1  ON 55
ci_057                 4.675223e-03 3 1  ON 56
ci_058                -2.044642e-03 3 1  ON 57
ci_059                -2.118584e-03 3 1  ON 58
ci_060                 4.730495e-03 3 1  ON 59
ci_061                 5.181216e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781406e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063192e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398759e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1754
    reference variance = 0.123172
====================================================
  Execution time = 1.3610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0293e-01
  Total weights = 1.9573e+06
  Execution time = 1.8503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908299072
                                         uncertainty =       0.001919070517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908299072
                                         uncertainty =       0.001919070517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102171
  error estimate for blocks of size 2^( 2) =       0.000391271333
  error estimate for blocks of size 2^( 3) =       0.000402029305
  error estimate for blocks of size 2^( 4) =       0.000410207562
  error estimate for blocks of size 2^( 5) =       0.000414461394
  error estimate for blocks of size 2^( 6) =       0.000418935598
  error estimate for blocks of size 2^( 7) =       0.000420259710

      target function =      -0.908099318997
              le_mean =     -17.213803508728
             les_mean =     296.617964796135
             stat err =       0.000415966066
             autocorr =       1.197609151228
   target nu stat err =       0.000415966066
   target dn stat err =       0.002872536328
      target stat err =       0.004476072353
              std dev =       0.537545644770
             le_variance =       0.288955320211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908296841
                                         uncertainty =       0.001919070068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908296841
                                         uncertainty =       0.001919070068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102169
  error estimate for blocks of size 2^( 2) =       0.000391271333
  error estimate for blocks of size 2^( 3) =       0.000402029306
  error estimate for blocks of size 2^( 4) =       0.000410207563
  error estimate for blocks of size 2^( 5) =       0.000414461396
  error estimate for blocks of size 2^( 6) =       0.000418935600
  error estimate for blocks of size 2^( 7) =       0.000420259712

      target function =      -0.908099336250
              le_mean =     -17.213803508738
             les_mean =     296.617964785260
             stat err =       0.000415966068
             autocorr =       1.197609173614
   target nu stat err =       0.000415966068
   target dn stat err =       0.002872535612
      target stat err =       0.004476071434
              std dev =       0.537545642667
             le_variance =       0.288955317950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908297957
                                         uncertainty =       0.001919070293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908297957
                                         uncertainty =       0.001919070293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102170
  error estimate for blocks of size 2^( 2) =       0.000391271333
  error estimate for blocks of size 2^( 3) =       0.000402029306
  error estimate for blocks of size 2^( 4) =       0.000410207562
  error estimate for blocks of size 2^( 5) =       0.000414461395
  error estimate for blocks of size 2^( 6) =       0.000418935599
  error estimate for blocks of size 2^( 7) =       0.000420259711

      target function =      -0.908099327624
              le_mean =     -17.213803508733
             les_mean =     296.617964790697
             stat err =       0.000415966067
             autocorr =       1.197609162418
   target nu stat err =       0.000415966067
   target dn stat err =       0.002872535970
      target stat err =       0.004476071893
              std dev =       0.537545643718
             le_variance =       0.288955319080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908298933
                                         uncertainty =       0.001919070489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288908298933
                                         uncertainty =       0.001919070489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380102171
  error estimate for blocks of size 2^( 2) =       0.000391271333
  error estimate for blocks of size 2^( 3) =       0.000402029305
  error estimate for blocks of size 2^( 4) =       0.000410207562
  error estimate for blocks of size 2^( 5) =       0.000414461394
  error estimate for blocks of size 2^( 6) =       0.000418935598
  error estimate for blocks of size 2^( 7) =       0.000420259710

      target function =      -0.908099320075
              le_mean =     -17.213803508729
             les_mean =     296.617964795455
             stat err =       0.000415966066
             autocorr =       1.197609152625
   target nu stat err =       0.000415966066
   target dn stat err =       0.002872536284
      target stat err =       0.004476072295
              std dev =       0.537545644638
             le_variance =       0.288955320070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908099318997        initial
     8.8818e+03     8.8818e+04             3.1012e-08        -0.908099336250  <--
     3.5527e+04     3.5527e+05             7.7531e-09        -0.908099327624
     1.4211e+05     1.4211e+06             1.9383e-09        -0.908099320075

*****************************************************************************
Applying the update for shift_i =   8.8818e+03     and shift_s =   8.8818e+04
*****************************************************************************

  Execution time = 2.2931e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.381786
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0715e-01
  Total weights = 1.957756547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292935847606
                                         uncertainty =       0.002486531135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292935847606
                                         uncertainty =       0.002486531135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382693837
  error estimate for blocks of size 2^( 2) =       0.000394203069
  error estimate for blocks of size 2^( 3) =       0.000404717511
  error estimate for blocks of size 2^( 4) =       0.000412036800
  error estimate for blocks of size 2^( 5) =       0.000416249877
  error estimate for blocks of size 2^( 6) =       0.000418824053
  error estimate for blocks of size 2^( 7) =       0.000420310589

      target function =      -0.901625011393
              le_mean =     -17.214313817181
             les_mean =     296.639746299409
             stat err =       0.000416855330
             autocorr =       1.186500102712
   target nu stat err =       0.000416855330
   target dn stat err =       0.003264882421
      target stat err =       0.005006808853
              std dev =       0.541210814833
             le_variance =       0.292909146092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721431381718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901651788345       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901651816462       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901651819239       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901651819811       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901651819833       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901651819930       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901651819931       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901651819935       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901651819936       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901651819937       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+03 is 7.043520e-08

solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901651788345       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901651795374       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901651796068       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901651796213       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901651796217       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901651796242       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901651796265       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901651796227       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901651796244       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901651796235       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+03 is 1.760925e-08

solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901651788345       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901651790102       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901651790276       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901651790312       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901651790315       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901651790361       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901651790288       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901651790300       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901651790350       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901651790316       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+04 is 4.402342e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6266e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155711e-02 3 1  ON 4
ci_006                -1.849773e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758173e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874123e-03 3 1  ON 9
ci_011                -9.142921e-03 3 1  ON 10
ci_012                -9.120729e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103418e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080340e-03 3 1  ON 17
ci_019                 8.981672e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258602e-03 3 1  ON 21
ci_023                 8.361652e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594923e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639868e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795504e-03 3 1  ON 29
ci_031                -8.563490e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554518e-03 3 1  ON 32
ci_034                 4.915595e-03 3 1  ON 33
ci_035                -3.348100e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201152e-04 3 1  ON 37
ci_039                 1.223271e-03 3 1  ON 38
ci_040                -1.603080e-03 3 1  ON 39
ci_041                 8.180207e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385648e-03 3 1  ON 42
ci_044                -3.921458e-03 3 1  ON 43
ci_045                -1.870155e-03 3 1  ON 44
ci_046                 4.771173e-03 3 1  ON 45
ci_047                 4.645461e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288211e-02 3 1  ON 48
ci_050                 2.825030e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275287e-03 3 1  ON 51
ci_053                -2.208909e-03 3 1  ON 52
ci_054                -2.321163e-03 3 1  ON 53
ci_055                -2.375187e-03 3 1  ON 54
ci_056                 4.660815e-03 3 1  ON 55
ci_057                 4.675226e-03 3 1  ON 56
ci_058                -2.044627e-03 3 1  ON 57
ci_059                -2.118573e-03 3 1  ON 58
ci_060                 4.730482e-03 3 1  ON 59
ci_061                 5.181210e-03 3 1  ON 60
ci_062                -2.828202e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398060e-03 3 1  ON 64
ci_066                 4.063182e-03 3 1  ON 65
ci_067                 4.160624e-03 3 1  ON 66
ci_068                -4.398764e-03 3 1  ON 67
ci_069                -4.115066e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2744
    reference variance = 0.375641
====================================================
  Execution time = 1.3285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9936e-01
  Total weights = 1.9578e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717922013
                                         uncertainty =       0.001642891567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717922013
                                         uncertainty =       0.001642891567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378615279
  error estimate for blocks of size 2^( 2) =       0.000389956850
  error estimate for blocks of size 2^( 3) =       0.000400069289
  error estimate for blocks of size 2^( 4) =       0.000408010438
  error estimate for blocks of size 2^( 5) =       0.000411895720
  error estimate for blocks of size 2^( 6) =       0.000414162095
  error estimate for blocks of size 2^( 7) =       0.000416643727

      target function =      -0.913592240928
              le_mean =     -17.214853518620
             les_mean =     296.650544935476
             stat err =       0.000412677995
             autocorr =       1.188027113058
   target nu stat err =       0.000412677995
   target dn stat err =       0.002300257979
      target stat err =       0.003658132795
              std dev =       0.535442862371
             le_variance =       0.286699058864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717919706
                                         uncertainty =       0.001642891470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717919706
                                         uncertainty =       0.001642891470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378615277
  error estimate for blocks of size 2^( 2) =       0.000389956854
  error estimate for blocks of size 2^( 3) =       0.000400069296
  error estimate for blocks of size 2^( 4) =       0.000408010449
  error estimate for blocks of size 2^( 5) =       0.000411895734
  error estimate for blocks of size 2^( 6) =       0.000414162109
  error estimate for blocks of size 2^( 7) =       0.000416643744

      target function =      -0.913591980373
              le_mean =     -17.214853519007
             les_mean =     296.650545115629
             stat err =       0.000412678009
             autocorr =       1.188027202110
   target nu stat err =       0.000412678009
   target dn stat err =       0.002300279107
      target stat err =       0.003658163109
              std dev =       0.535442860190
             le_variance =       0.286699056529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717920859
                                         uncertainty =       0.001642891519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717920859
                                         uncertainty =       0.001642891519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378615278
  error estimate for blocks of size 2^( 2) =       0.000389956852
  error estimate for blocks of size 2^( 3) =       0.000400069293
  error estimate for blocks of size 2^( 4) =       0.000408010444
  error estimate for blocks of size 2^( 5) =       0.000411895727
  error estimate for blocks of size 2^( 6) =       0.000414162102
  error estimate for blocks of size 2^( 7) =       0.000416643736

      target function =      -0.913592110708
              le_mean =     -17.214853518813
             les_mean =     296.650545025514
             stat err =       0.000412678002
             autocorr =       1.188027157586
   target nu stat err =       0.000412678002
   target dn stat err =       0.002300268540
      target stat err =       0.003658147947
              std dev =       0.535442861280
             le_variance =       0.286699057696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717921869
                                         uncertainty =       0.001642891561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286717921869
                                         uncertainty =       0.001642891561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378615279
  error estimate for blocks of size 2^( 2) =       0.000389956850
  error estimate for blocks of size 2^( 3) =       0.000400069289
  error estimate for blocks of size 2^( 4) =       0.000408010439
  error estimate for blocks of size 2^( 5) =       0.000411895721
  error estimate for blocks of size 2^( 6) =       0.000414162095
  error estimate for blocks of size 2^( 7) =       0.000416643728

      target function =      -0.913592224657
              le_mean =     -17.214853518644
             les_mean =     296.650544946726
             stat err =       0.000412677996
             autocorr =       1.188027118630
   target nu stat err =       0.000412677996
   target dn stat err =       0.002300259299
      target stat err =       0.003658134689
              std dev =       0.535442862235
             le_variance =       0.286699058718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913592240928        initial  <--
     2.2204e+03     2.2204e+04             7.0435e-08        -0.913591980373
     8.8818e+03     8.8818e+04             1.7609e-08        -0.913592110708
     3.5527e+04     3.5527e+05             4.4023e-09        -0.913592224657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5798
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.287699
====================================================
  Execution time = 1.3698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9950e-01
  Total weights = 1.957765894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972803386
                                         uncertainty =       0.001776181375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972803386
                                         uncertainty =       0.001776181375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379436776
  error estimate for blocks of size 2^( 2) =       0.000390512871
  error estimate for blocks of size 2^( 3) =       0.000401255993
  error estimate for blocks of size 2^( 4) =       0.000408854330
  error estimate for blocks of size 2^( 5) =       0.000413205947
  error estimate for blocks of size 2^( 6) =       0.000414998518
  error estimate for blocks of size 2^( 7) =       0.000417703427

      target function =      -0.913361867650
              le_mean =     -17.215251122560
             les_mean =     296.664372898080
             stat err =       0.000413690555
             autocorr =       1.188700292666
   target nu stat err =       0.000413690555
   target dn stat err =       0.002195606813
      target stat err =       0.003499242446
              std dev =       0.536604634093
             le_variance =       0.287944533330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721525112256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913374227102       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913374228723       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913374228959       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913374229021       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913374229042       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913374228996       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913374229056       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913374229029       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913374229016       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+04 is 4.501387e-09

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913374227102       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913374227507       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913374227566       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913374227582       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913374227544       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913374227609       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913374227465       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913374227622       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913374227584       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+04 is 1.125349e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913374227102       residual = 9.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913374227204       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913374227218       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913374227222       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913374227212       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913374226989       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913374227015       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913374227256       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913374227104       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+05 is 2.813375e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6202e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142930e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639855e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554525e-03 3 1  ON 32
ci_034                 4.915598e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201087e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275285e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118577e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2557
    reference variance = 0.197415
====================================================
  Execution time = 1.3499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0345e-01
  Total weights = 1.9580e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753811
                                         uncertainty =       0.001955539523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753811
                                         uncertainty =       0.001955539523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380074587
  error estimate for blocks of size 2^( 2) =       0.000391209528
  error estimate for blocks of size 2^( 3) =       0.000401678038
  error estimate for blocks of size 2^( 4) =       0.000408740552
  error estimate for blocks of size 2^( 5) =       0.000413223673
  error estimate for blocks of size 2^( 6) =       0.000416257564
  error estimate for blocks of size 2^( 7) =       0.000419070141

      target function =      -0.907235951301
              le_mean =     -17.215145431404
             les_mean =     296.664684595720
             stat err =       0.000414322983
             autocorr =       1.188339092458
   target nu stat err =       0.000414322983
   target dn stat err =       0.002680790773
      target stat err =       0.004187132333
              std dev =       0.537506635595
             le_variance =       0.288913383309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753250
                                         uncertainty =       0.001955539532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753250
                                         uncertainty =       0.001955539532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380074587
  error estimate for blocks of size 2^( 2) =       0.000391209528
  error estimate for blocks of size 2^( 3) =       0.000401678039
  error estimate for blocks of size 2^( 4) =       0.000408740553
  error estimate for blocks of size 2^( 5) =       0.000413223674
  error estimate for blocks of size 2^( 6) =       0.000416257565
  error estimate for blocks of size 2^( 7) =       0.000419070142

      target function =      -0.907235922554
              le_mean =     -17.215145431472
             les_mean =     296.664684616703
             stat err =       0.000414322983
             autocorr =       1.188339099698
   target nu stat err =       0.000414322983
   target dn stat err =       0.002680793347
      target stat err =       0.004187135979
              std dev =       0.537506635079
             le_variance =       0.288913382754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753531
                                         uncertainty =       0.001955539528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753531
                                         uncertainty =       0.001955539528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380074587
  error estimate for blocks of size 2^( 2) =       0.000391209528
  error estimate for blocks of size 2^( 3) =       0.000401678038
  error estimate for blocks of size 2^( 4) =       0.000408740553
  error estimate for blocks of size 2^( 5) =       0.000413223673
  error estimate for blocks of size 2^( 6) =       0.000416257565
  error estimate for blocks of size 2^( 7) =       0.000419070141

      target function =      -0.907235936937
              le_mean =     -17.215145431438
             les_mean =     296.664684606206
             stat err =       0.000414322983
             autocorr =       1.188339096071
   target nu stat err =       0.000414322983
   target dn stat err =       0.002680792060
      target stat err =       0.004187134156
              std dev =       0.537506635337
             le_variance =       0.288913383031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753776
                                         uncertainty =       0.001955539524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288966753776
                                         uncertainty =       0.001955539524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380074587
  error estimate for blocks of size 2^( 2) =       0.000391209528
  error estimate for blocks of size 2^( 3) =       0.000401678038
  error estimate for blocks of size 2^( 4) =       0.000408740553
  error estimate for blocks of size 2^( 5) =       0.000413223673
  error estimate for blocks of size 2^( 6) =       0.000416257564
  error estimate for blocks of size 2^( 7) =       0.000419070141

      target function =      -0.907235949506
              le_mean =     -17.215145431408
             les_mean =     296.664684597030
             stat err =       0.000414322983
             autocorr =       1.188339092910
   target nu stat err =       0.000414322983
   target dn stat err =       0.002680790934
      target stat err =       0.004187132561
              std dev =       0.537506635563
             le_variance =       0.288913383274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907235951301        initial  <--
     2.2204e+04     2.2204e+05             4.5014e-09        -0.907235922554
     8.8818e+04     8.8818e+05             1.1253e-09        -0.907235936937
     3.5527e+05     3.5527e+06             2.8134e-10        -0.907235949506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0287
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.266582
====================================================
  Execution time = 1.3676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5335e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0345e-01
  Total weights = 1.957878046e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184454598
                                         uncertainty =       0.001733058995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288184454598
                                         uncertainty =       0.001733058995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379587529
  error estimate for blocks of size 2^( 2) =       0.000390717130
  error estimate for blocks of size 2^( 3) =       0.000401057486
  error estimate for blocks of size 2^( 4) =       0.000409138918
  error estimate for blocks of size 2^( 5) =       0.000414711582
  error estimate for blocks of size 2^( 6) =       0.000416360802
  error estimate for blocks of size 2^( 7) =       0.000417754357

      target function =      -0.907246695543
              le_mean =     -17.214491305588
             les_mean =     296.642165819897
             stat err =       0.000414491415
             autocorr =       1.192359474126
   target nu stat err =       0.000414491415
   target dn stat err =       0.003757716247
      target stat err =       0.005821565651
              std dev =       0.536817832165
             le_variance =       0.288173384931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721449130559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907283058179       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907283058429       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907283058463       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907283058476       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907283058623       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907283058644       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907283058527       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907283058355       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907283058637       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907283058316       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+05 is 8.467405e-10

solving harmonic davidson linear method for identity shift 8.8818e+05, overlap shift 8.8818e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907283058179       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907283058242       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907283058250       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907283058253       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907283058290       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907283058152       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907283057793       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907283058687       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907283057823       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907283059278       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+05 is 2.116852e-10

solving harmonic davidson linear method for identity shift 3.5527e+06, overlap shift 3.5527e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907283058179       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907283058195       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907283058197       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907283058198       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907283058438       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907283056138       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907283060861       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907283060573       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907283056635       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907283061717       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+06 is 5.292131e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6191e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201091e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.194016
====================================================
  Execution time = 1.3240e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0501e-01
  Total weights = 1.9576e+06
  Execution time = 1.8435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661477
                                         uncertainty =       0.001768146162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661477
                                         uncertainty =       0.001768146162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379556156
  error estimate for blocks of size 2^( 2) =       0.000391194920
  error estimate for blocks of size 2^( 3) =       0.000401239925
  error estimate for blocks of size 2^( 4) =       0.000408835533
  error estimate for blocks of size 2^( 5) =       0.000413532068
  error estimate for blocks of size 2^( 6) =       0.000416233851
  error estimate for blocks of size 2^( 7) =       0.000417684427

      target function =      -0.904850728697
              le_mean =     -17.214073649985
             les_mean =     296.629342367872
             stat err =       0.000414071470
             autocorr =       1.190141328070
   target nu stat err =       0.000414071470
   target dn stat err =       0.005125398937
      target stat err =       0.007866121384
              std dev =       0.536773463732
             le_variance =       0.288125751367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661506
                                         uncertainty =       0.001768146168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661506
                                         uncertainty =       0.001768146168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379556156
  error estimate for blocks of size 2^( 2) =       0.000391194920
  error estimate for blocks of size 2^( 3) =       0.000401239925
  error estimate for blocks of size 2^( 4) =       0.000408835533
  error estimate for blocks of size 2^( 5) =       0.000413532068
  error estimate for blocks of size 2^( 6) =       0.000416233851
  error estimate for blocks of size 2^( 7) =       0.000417684427

      target function =      -0.904850725353
              le_mean =     -17.214073649983
             les_mean =     296.629342369983
             stat err =       0.000414071470
             autocorr =       1.190141328429
   target nu stat err =       0.000414071470
   target dn stat err =       0.005125398956
      target stat err =       0.007866121355
              std dev =       0.536773463760
             le_variance =       0.288125751396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661492
                                         uncertainty =       0.001768146165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661492
                                         uncertainty =       0.001768146165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379556156
  error estimate for blocks of size 2^( 2) =       0.000391194920
  error estimate for blocks of size 2^( 3) =       0.000401239925
  error estimate for blocks of size 2^( 4) =       0.000408835533
  error estimate for blocks of size 2^( 5) =       0.000413532068
  error estimate for blocks of size 2^( 6) =       0.000416233851
  error estimate for blocks of size 2^( 7) =       0.000417684427

      target function =      -0.904850727026
              le_mean =     -17.214073649984
             les_mean =     296.629342368927
             stat err =       0.000414071470
             autocorr =       1.190141328253
   target nu stat err =       0.000414071470
   target dn stat err =       0.005125398947
      target stat err =       0.007866121369
              std dev =       0.536773463746
             le_variance =       0.288125751381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661479
                                         uncertainty =       0.001768146163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288160661479
                                         uncertainty =       0.001768146163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379556156
  error estimate for blocks of size 2^( 2) =       0.000391194920
  error estimate for blocks of size 2^( 3) =       0.000401239925
  error estimate for blocks of size 2^( 4) =       0.000408835533
  error estimate for blocks of size 2^( 5) =       0.000413532068
  error estimate for blocks of size 2^( 6) =       0.000416233851
  error estimate for blocks of size 2^( 7) =       0.000417684427

      target function =      -0.904850728488
              le_mean =     -17.214073649985
             les_mean =     296.629342368004
             stat err =       0.000414071470
             autocorr =       1.190141328084
   target nu stat err =       0.000414071470
   target dn stat err =       0.005125398938
      target stat err =       0.007866121382
              std dev =       0.536773463734
             le_variance =       0.288125751369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904850728697        initial  <--
     2.2204e+05     2.2204e+06             8.4674e-10        -0.904850725353
     8.8818e+05     8.8818e+06             2.1169e-10        -0.904850727026
     3.5527e+06     3.5527e+07             5.2921e-11        -0.904850728488

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5617
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8761e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.3132
    reference variance = 1.38411
====================================================
  Execution time = 1.3583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0068e-01
  Total weights = 1.957881744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286870420544
                                         uncertainty =       0.002494020793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286870420544
                                         uncertainty =       0.002494020793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378742934
  error estimate for blocks of size 2^( 2) =       0.000390046641
  error estimate for blocks of size 2^( 3) =       0.000400367807
  error estimate for blocks of size 2^( 4) =       0.000407843223
  error estimate for blocks of size 2^( 5) =       0.000412088118
  error estimate for blocks of size 2^( 6) =       0.000414147490
  error estimate for blocks of size 2^( 7) =       0.000416139348

      target function =      -0.911544688812
              le_mean =     -17.214388653460
             les_mean =     296.635858133368
             stat err =       0.000412554545
             autocorr =       1.186516200388
   target nu stat err =       0.000412554545
   target dn stat err =       0.003302839925
      target stat err =       0.005174572894
              std dev =       0.535623394302
             le_variance =       0.286892420523


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721438865346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911572958112       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911572958155       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911572958160       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911572958161       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911572957813       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911572961110       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911572956654       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911572954356       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911572958776       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911572953972       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+06 is 1.036598e-10

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911572958112       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911572958123       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911572958124       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911572958125       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911572952222       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911572950027       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911572957954       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911572969468       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911572956448       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911572967860       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.591494e-11

solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911572958112       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911572958115       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911572958115       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911572951062       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911572959353       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911572926911       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911572997268       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911572940676       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911573025144       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911573049936       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 6.478718e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6123e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1704
    reference variance = 0.310405
====================================================
  Execution time = 1.3535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0104e-01
  Total weights = 1.9575e+06
  Execution time = 1.8578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196612
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196612
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379430552
  error estimate for blocks of size 2^( 2) =       0.000391057188
  error estimate for blocks of size 2^( 3) =       0.000401449638
  error estimate for blocks of size 2^( 4) =       0.000409057162
  error estimate for blocks of size 2^( 5) =       0.000414404818
  error estimate for blocks of size 2^( 6) =       0.000417828568
  error estimate for blocks of size 2^( 7) =       0.000421286079

      target function =      -0.910995537563
              le_mean =     -17.214405300608
             les_mean =     296.636793040600
             stat err =       0.000415644157
             autocorr =       1.199993143010
   target nu stat err =       0.000415644157
   target dn stat err =       0.002543738931
      target stat err =       0.004006634907
              std dev =       0.536595831923
             le_variance =       0.287935086837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196606
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196606
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379430552
  error estimate for blocks of size 2^( 2) =       0.000391057188
  error estimate for blocks of size 2^( 3) =       0.000401449638
  error estimate for blocks of size 2^( 4) =       0.000409057162
  error estimate for blocks of size 2^( 5) =       0.000414404818
  error estimate for blocks of size 2^( 6) =       0.000417828568
  error estimate for blocks of size 2^( 7) =       0.000421286079

      target function =      -0.910995537583
              le_mean =     -17.214405300609
             les_mean =     296.636793040623
             stat err =       0.000415644157
             autocorr =       1.199993143100
   target nu stat err =       0.000415644157
   target dn stat err =       0.002543738936
      target stat err =       0.004006634915
              std dev =       0.536595831917
             le_variance =       0.287935086831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196609
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196609
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379430552
  error estimate for blocks of size 2^( 2) =       0.000391057188
  error estimate for blocks of size 2^( 3) =       0.000401449638
  error estimate for blocks of size 2^( 4) =       0.000409057162
  error estimate for blocks of size 2^( 5) =       0.000414404818
  error estimate for blocks of size 2^( 6) =       0.000417828568
  error estimate for blocks of size 2^( 7) =       0.000421286079

      target function =      -0.910995537573
              le_mean =     -17.214405300608
             les_mean =     296.636793040612
             stat err =       0.000415644157
             autocorr =       1.199993143063
   target nu stat err =       0.000415644157
   target dn stat err =       0.002543738933
      target stat err =       0.004006634911
              std dev =       0.536595831920
             le_variance =       0.287935086834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196611
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287977196611
                                         uncertainty =       0.001848123249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379430552
  error estimate for blocks of size 2^( 2) =       0.000391057188
  error estimate for blocks of size 2^( 3) =       0.000401449638
  error estimate for blocks of size 2^( 4) =       0.000409057162
  error estimate for blocks of size 2^( 5) =       0.000414404818
  error estimate for blocks of size 2^( 6) =       0.000417828568
  error estimate for blocks of size 2^( 7) =       0.000421286079

      target function =      -0.910995537565
              le_mean =     -17.214405300608
             les_mean =     296.636793040602
             stat err =       0.000415644157
             autocorr =       1.199993143020
   target nu stat err =       0.000415644157
   target dn stat err =       0.002543738931
      target stat err =       0.004006634907
              std dev =       0.536595831922
             le_variance =       0.287935086836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910995537563        initial
     2.2204e+06     2.2204e+07             1.0366e-10        -0.910995537583  <--
     8.8818e+06     8.8818e+07             2.5915e-11        -0.910995537573
     3.5527e+07     3.5527e+08             6.4787e-12        -0.910995537565

*****************************************************************************
Applying the update for shift_i =   2.2204e+06     and shift_s =   2.2204e+07
*****************************************************************************

  Execution time = 2.6383e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.263292
====================================================
  Execution time = 1.3842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0267e-01
  Total weights = 1.957577258e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288182836512
                                         uncertainty =       0.002167453727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288182836512
                                         uncertainty =       0.002167453727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379686707
  error estimate for blocks of size 2^( 2) =       0.000390619376
  error estimate for blocks of size 2^( 3) =       0.000400962797
  error estimate for blocks of size 2^( 4) =       0.000409249753
  error estimate for blocks of size 2^( 5) =       0.000413389526
  error estimate for blocks of size 2^( 6) =       0.000415548582
  error estimate for blocks of size 2^( 7) =       0.000416462201

      target function =      -0.908457180632
              le_mean =     -17.214757599423
             les_mean =     296.650551050942
             stat err =       0.000413662516
             autocorr =       1.186974944217
   target nu stat err =       0.000413662516
   target dn stat err =       0.002725618854
      target stat err =       0.004263223431
              std dev =       0.536958090964
             le_variance =       0.288323991452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721475759942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+05, overlap shift 5.5511e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908476442020       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908476442113       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908476442125       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908476442531       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908476442249       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908476442128       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908476441861       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908476441573       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908476441235       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908476442158       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+05 is 3.463656e-10

solving harmonic davidson linear method for identity shift 2.2204e+06, overlap shift 2.2204e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908476442020       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908476442043       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908476442047       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908476442047       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908476443501       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908476442647       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908476438194       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908476444228       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908476435630       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908476434868       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+06 is 8.659142e-11

solving harmonic davidson linear method for identity shift 8.8818e+06, overlap shift 8.8818e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908476442020       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908476442026       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908476442027       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908476442225       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908476441840       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908476442027       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908476442027       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908476446009       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908476453389       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908476439467       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+06 is 2.164786e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6348e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2324
    reference variance = 0.178614
====================================================
  Execution time = 1.3269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.9575e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277280
                                         uncertainty =       0.001440495882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277280
                                         uncertainty =       0.001440495882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379049078
  error estimate for blocks of size 2^( 2) =       0.000390391784
  error estimate for blocks of size 2^( 3) =       0.000400567518
  error estimate for blocks of size 2^( 4) =       0.000408410380
  error estimate for blocks of size 2^( 5) =       0.000412910069
  error estimate for blocks of size 2^( 6) =       0.000415287479
  error estimate for blocks of size 2^( 7) =       0.000416218143

      target function =      -0.911580943191
              le_mean =     -17.214514996152
             les_mean =     296.640190163944
             stat err =       0.000413206518
             autocorr =       1.188347445090
   target nu stat err =       0.000413206518
   target dn stat err =       0.002374965236
      target stat err =       0.003754089089
              std dev =       0.536056347190
             le_variance =       0.287356407362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277264
                                         uncertainty =       0.001440495883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277264
                                         uncertainty =       0.001440495883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379049078
  error estimate for blocks of size 2^( 2) =       0.000390391784
  error estimate for blocks of size 2^( 3) =       0.000400567518
  error estimate for blocks of size 2^( 4) =       0.000408410380
  error estimate for blocks of size 2^( 5) =       0.000412910069
  error estimate for blocks of size 2^( 6) =       0.000415287479
  error estimate for blocks of size 2^( 7) =       0.000416218143

      target function =      -0.911580942683
              le_mean =     -17.214514996149
             les_mean =     296.640190164194
             stat err =       0.000413206518
             autocorr =       1.188347445503
   target nu stat err =       0.000413206518
   target dn stat err =       0.002374965279
      target stat err =       0.003754089151
              std dev =       0.536056347175
             le_variance =       0.287356407346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277272
                                         uncertainty =       0.001440495883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277272
                                         uncertainty =       0.001440495883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379049078
  error estimate for blocks of size 2^( 2) =       0.000390391784
  error estimate for blocks of size 2^( 3) =       0.000400567518
  error estimate for blocks of size 2^( 4) =       0.000408410380
  error estimate for blocks of size 2^( 5) =       0.000412910069
  error estimate for blocks of size 2^( 6) =       0.000415287479
  error estimate for blocks of size 2^( 7) =       0.000416218143

      target function =      -0.911580942937
              le_mean =     -17.214514996150
             les_mean =     296.640190164069
             stat err =       0.000413206518
             autocorr =       1.188347445299
   target nu stat err =       0.000413206518
   target dn stat err =       0.002374965258
      target stat err =       0.003754089120
              std dev =       0.536056347182
             le_variance =       0.287356407354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277279
                                         uncertainty =       0.001440495882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287473277279
                                         uncertainty =       0.001440495882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379049078
  error estimate for blocks of size 2^( 2) =       0.000390391784
  error estimate for blocks of size 2^( 3) =       0.000400567518
  error estimate for blocks of size 2^( 4) =       0.000408410380
  error estimate for blocks of size 2^( 5) =       0.000412910069
  error estimate for blocks of size 2^( 6) =       0.000415287479
  error estimate for blocks of size 2^( 7) =       0.000416218143

      target function =      -0.911580943159
              le_mean =     -17.214514996151
             les_mean =     296.640190163959
             stat err =       0.000413206518
             autocorr =       1.188347445111
   target nu stat err =       0.000413206518
   target dn stat err =       0.002374965239
      target stat err =       0.003754089093
              std dev =       0.536056347189
             le_variance =       0.287356407361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911580943191        initial  <--
     5.5511e+05     5.5511e+06             3.4637e-10        -0.911580942683
     2.2204e+06     2.2204e+07             8.6591e-11        -0.911580942937
     8.8818e+06     8.8818e+07             2.1648e-11        -0.911580943159

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6452
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.177486
====================================================
  Execution time = 1.3635e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0485e-01
  Total weights = 1.957763723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290457943578
                                         uncertainty =       0.002294230298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290457943578
                                         uncertainty =       0.002294230298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381057982
  error estimate for blocks of size 2^( 2) =       0.000392423526
  error estimate for blocks of size 2^( 3) =       0.000402109579
  error estimate for blocks of size 2^( 4) =       0.000409412669
  error estimate for blocks of size 2^( 5) =       0.000413626208
  error estimate for blocks of size 2^( 6) =       0.000416726421
  error estimate for blocks of size 2^( 7) =       0.000418998063

      target function =      -0.905086111609
              le_mean =     -17.214783240163
             les_mean =     296.653609947826
             stat err =       0.000414690840
             autocorr =       1.184313714452
   target nu stat err =       0.000414690840
   target dn stat err =       0.004131328207
      target stat err =       0.006365658899
              std dev =       0.538897366652
             le_variance =       0.290410371785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721478324016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905130183937       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905130183945       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905130183946       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905130183947       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905130183947       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905130183947       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905130183947       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905130183947       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905130183947       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905130183947       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 2.662527e-11

solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905130183937       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905130183939       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905130183939       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905130183939       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905130183939       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905130183939       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905130183939       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905130183939       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905130183939       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905130183939       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+07 is 6.656318e-12

solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905130183937       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905130183937       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905130183937       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905130183937       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905130213399       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905130183937       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905130183937       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905130183937       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905130183937       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905130183937       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+07 is 1.663985e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6130e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.336447
====================================================
  Execution time = 1.3323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9701e-01
  Total weights = 1.9580e+06
  Execution time = 1.8532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377858866
  error estimate for blocks of size 2^( 2) =       0.000389120484
  error estimate for blocks of size 2^( 3) =       0.000399597138
  error estimate for blocks of size 2^( 4) =       0.000407776610
  error estimate for blocks of size 2^( 5) =       0.000413295179
  error estimate for blocks of size 2^( 6) =       0.000415900978
  error estimate for blocks of size 2^( 7) =       0.000417769561

      target function =      -0.917288577149
              le_mean =     -17.214382660409
             les_mean =     296.631985288808
             stat err =       0.000413685582
             autocorr =       1.198620041347
   target nu stat err =       0.000413685582
   target dn stat err =       0.002109855640
      target stat err =       0.003391133349
              std dev =       0.534373133452
             le_variance =       0.285554645755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377858866
  error estimate for blocks of size 2^( 2) =       0.000389120484
  error estimate for blocks of size 2^( 3) =       0.000399597138
  error estimate for blocks of size 2^( 4) =       0.000407776610
  error estimate for blocks of size 2^( 5) =       0.000413295179
  error estimate for blocks of size 2^( 6) =       0.000415900978
  error estimate for blocks of size 2^( 7) =       0.000417769561

      target function =      -0.917288577151
              le_mean =     -17.214382660409
             les_mean =     296.631985288803
             stat err =       0.000413685582
             autocorr =       1.198620041371
   target nu stat err =       0.000413685582
   target dn stat err =       0.002109855639
      target stat err =       0.003391133349
              std dev =       0.534373133452
             le_variance =       0.285554645755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377858866
  error estimate for blocks of size 2^( 2) =       0.000389120484
  error estimate for blocks of size 2^( 3) =       0.000399597138
  error estimate for blocks of size 2^( 4) =       0.000407776610
  error estimate for blocks of size 2^( 5) =       0.000413295179
  error estimate for blocks of size 2^( 6) =       0.000415900978
  error estimate for blocks of size 2^( 7) =       0.000417769561

      target function =      -0.917288577150
              le_mean =     -17.214382660409
             les_mean =     296.631985288805
             stat err =       0.000413685582
             autocorr =       1.198620041352
   target nu stat err =       0.000413685582
   target dn stat err =       0.002109855639
      target stat err =       0.003391133349
              std dev =       0.534373133452
             le_variance =       0.285554645755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285600176700
                                         uncertainty =       0.001588253546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377858866
  error estimate for blocks of size 2^( 2) =       0.000389120484
  error estimate for blocks of size 2^( 3) =       0.000399597138
  error estimate for blocks of size 2^( 4) =       0.000407776610
  error estimate for blocks of size 2^( 5) =       0.000413295179
  error estimate for blocks of size 2^( 6) =       0.000415900978
  error estimate for blocks of size 2^( 7) =       0.000417769561

      target function =      -0.917288577149
              le_mean =     -17.214382660409
             les_mean =     296.631985288808
             stat err =       0.000413685582
             autocorr =       1.198620041344
   target nu stat err =       0.000413685582
   target dn stat err =       0.002109855640
      target stat err =       0.003391133349
              std dev =       0.534373133452
             le_variance =       0.285554645755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917288577149        initial
     5.5511e+06     5.5511e+07             2.6625e-11        -0.917288577151  <--
     2.2204e+07     2.2204e+08             6.6563e-12        -0.917288577150
     8.8818e+07     8.8818e+08             1.6640e-12        -0.917288577149

*****************************************************************************
Applying the update for shift_i =   5.5511e+06     and shift_s =   5.5511e+07
*****************************************************************************

  Execution time = 2.2672e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.329391
====================================================
  Execution time = 1.3542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0026e-01
  Total weights = 1.957633882e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287062561241
                                         uncertainty =       0.001883185412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287062561241
                                         uncertainty =       0.001883185412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378851288
  error estimate for blocks of size 2^( 2) =       0.000390366683
  error estimate for blocks of size 2^( 3) =       0.000400867264
  error estimate for blocks of size 2^( 4) =       0.000409020945
  error estimate for blocks of size 2^( 5) =       0.000414604199
  error estimate for blocks of size 2^( 6) =       0.000417840335
  error estimate for blocks of size 2^( 7) =       0.000419617962

      target function =      -0.912193784017
              le_mean =     -17.214816742903
             les_mean =     296.650178280285
             stat err =       0.000415270860
             autocorr =       1.201504434012
   target nu stat err =       0.000415270860
   target dn stat err =       0.002181909961
      target stat err =       0.003467330613
              std dev =       0.535776630287
             le_variance =       0.287056597562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721481674290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912205934555       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912205934580       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912205934585       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912205934780       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912205933839       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912205934405       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912205936180       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912205933675       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912205934869       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912205935325       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+06 is 9.171805e-11

solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912205934555       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912205934561       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912205934562       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912205934563       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912205930183       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912205928485       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912205938994       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912205924155       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912205934563       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912205939255       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 2.292957e-11

solving harmonic davidson linear method for identity shift 2.2204e+07, overlap shift 2.2204e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912205934555       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912205934557       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912205934557       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912205934557       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912205934557       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912205934557       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912205934557       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912205934557       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912205934557       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912205934557       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+07 is 5.732384e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.283594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6048e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.268755
====================================================
  Execution time = 1.3503e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0416e-01
  Total weights = 1.9579e+06
  Execution time = 1.8460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178685
                                         uncertainty =       0.001907117716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178685
                                         uncertainty =       0.001907117716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380679099
  error estimate for blocks of size 2^( 2) =       0.000391928456
  error estimate for blocks of size 2^( 3) =       0.000401568672
  error estimate for blocks of size 2^( 4) =       0.000408841817
  error estimate for blocks of size 2^( 5) =       0.000413481959
  error estimate for blocks of size 2^( 6) =       0.000414415636
  error estimate for blocks of size 2^( 7) =       0.000414415121

      target function =      -0.906184993376
              le_mean =     -17.214236736508
             les_mean =     296.634110995145
             stat err =       0.000412788633
             autocorr =       1.175810663461
   target nu stat err =       0.000412788633
   target dn stat err =       0.002871576875
      target stat err =       0.004458774958
              std dev =       0.538361544739
             le_variance =       0.289833152854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178663
                                         uncertainty =       0.001907117714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178663
                                         uncertainty =       0.001907117714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380679099
  error estimate for blocks of size 2^( 2) =       0.000391928456
  error estimate for blocks of size 2^( 3) =       0.000401568672
  error estimate for blocks of size 2^( 4) =       0.000408841817
  error estimate for blocks of size 2^( 5) =       0.000413481959
  error estimate for blocks of size 2^( 6) =       0.000414415636
  error estimate for blocks of size 2^( 7) =       0.000414415121

      target function =      -0.906184993507
              le_mean =     -17.214236736506
             les_mean =     296.634110995014
             stat err =       0.000412788633
             autocorr =       1.175810663502
   target nu stat err =       0.000412788633
   target dn stat err =       0.002871576863
      target stat err =       0.004458774942
              std dev =       0.538361544719
             le_variance =       0.289833152832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178674
                                         uncertainty =       0.001907117715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178674
                                         uncertainty =       0.001907117715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380679099
  error estimate for blocks of size 2^( 2) =       0.000391928456
  error estimate for blocks of size 2^( 3) =       0.000401568672
  error estimate for blocks of size 2^( 4) =       0.000408841817
  error estimate for blocks of size 2^( 5) =       0.000413481959
  error estimate for blocks of size 2^( 6) =       0.000414415636
  error estimate for blocks of size 2^( 7) =       0.000414415121

      target function =      -0.906184993442
              le_mean =     -17.214236736507
             les_mean =     296.634110995080
             stat err =       0.000412788633
             autocorr =       1.175810663485
   target nu stat err =       0.000412788633
   target dn stat err =       0.002871576869
      target stat err =       0.004458774950
              std dev =       0.538361544729
             le_variance =       0.289833152843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178683
                                         uncertainty =       0.001907117716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289896178683
                                         uncertainty =       0.001907117716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380679099
  error estimate for blocks of size 2^( 2) =       0.000391928456
  error estimate for blocks of size 2^( 3) =       0.000401568672
  error estimate for blocks of size 2^( 4) =       0.000408841817
  error estimate for blocks of size 2^( 5) =       0.000413481959
  error estimate for blocks of size 2^( 6) =       0.000414415636
  error estimate for blocks of size 2^( 7) =       0.000414415121

      target function =      -0.906184993384
              le_mean =     -17.214236736508
             les_mean =     296.634110995137
             stat err =       0.000412788633
             autocorr =       1.175810663470
   target nu stat err =       0.000412788633
   target dn stat err =       0.002871576875
      target stat err =       0.004458774957
              std dev =       0.538361544738
             le_variance =       0.289833152853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906184993376        initial
     1.3878e+06     1.3878e+07             9.1718e-11        -0.906184993507  <--
     5.5511e+06     5.5511e+07             2.2930e-11        -0.906184993442
     2.2204e+07     2.2204e+08             5.7324e-12        -0.906184993384

*****************************************************************************
Applying the update for shift_i =   1.3878e+06     and shift_s =   1.3878e+07
*****************************************************************************

  Execution time = 2.2818e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1919
    reference variance = 0.256703
====================================================
  Execution time = 1.3558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9811e-01
  Total weights = 1.957679018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590358194
                                         uncertainty =       0.001268911471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590358194
                                         uncertainty =       0.001268911471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377984646
  error estimate for blocks of size 2^( 2) =       0.000389237557
  error estimate for blocks of size 2^( 3) =       0.000399106876
  error estimate for blocks of size 2^( 4) =       0.000406345707
  error estimate for blocks of size 2^( 5) =       0.000411146620
  error estimate for blocks of size 2^( 6) =       0.000412220598
  error estimate for blocks of size 2^( 7) =       0.000412750930

      target function =      -0.915549548477
              le_mean =     -17.214886656608
             les_mean =     296.650435674947
             stat err =       0.000410615964
             autocorr =       1.180112311150
   target nu stat err =       0.000410615964
   target dn stat err =       0.002003976071
      target stat err =       0.003218518077
              std dev =       0.534551013214
             le_variance =       0.285744785729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488665661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915559974120       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915559974175       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915559974184       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915559974186       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915559974186       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915559974186       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915559974187       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915559974187       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915559974459       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+05 is 2.758042e-10

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915559974120       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915559974134       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915559974136       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915559974176       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915559974436       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915559974137       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915559974049       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915559974742       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915559974137       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+06 is 6.895106e-11

solving harmonic davidson linear method for identity shift 5.5511e+06, overlap shift 5.5511e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915559974120       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915559974124       residual = 9.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915559974124       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915559970398       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915559974124       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915559974124       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915559970526       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915559980054       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915559973417       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+06 is 1.723775e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286552 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6060e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142932e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201090e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730482e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1763
    reference variance = 0.212794
====================================================
  Execution time = 1.3521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0526e-01
  Total weights = 1.9575e+06
  Execution time = 1.8481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659119
                                         uncertainty =       0.002205754766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659119
                                         uncertainty =       0.002205754766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380492075
  error estimate for blocks of size 2^( 2) =       0.000391732241
  error estimate for blocks of size 2^( 3) =       0.000402090104
  error estimate for blocks of size 2^( 4) =       0.000409893063
  error estimate for blocks of size 2^( 5) =       0.000414391575
  error estimate for blocks of size 2^( 6) =       0.000413913264
  error estimate for blocks of size 2^( 7) =       0.000416246800

      target function =      -0.904486777465
              le_mean =     -17.214414587672
             les_mean =     296.641334434152
             stat err =       0.000413611175
             autocorr =       1.181662077286
   target nu stat err =       0.000413611175
   target dn stat err =       0.003162755488
      target stat err =       0.004883979893
              std dev =       0.538097052613
             le_variance =       0.289548438031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659085
                                         uncertainty =       0.002205754769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659085
                                         uncertainty =       0.002205754769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380492075
  error estimate for blocks of size 2^( 2) =       0.000391732241
  error estimate for blocks of size 2^( 3) =       0.000402090104
  error estimate for blocks of size 2^( 4) =       0.000409893063
  error estimate for blocks of size 2^( 5) =       0.000414391575
  error estimate for blocks of size 2^( 6) =       0.000413913264
  error estimate for blocks of size 2^( 7) =       0.000416246800

      target function =      -0.904486777468
              le_mean =     -17.214414587670
             les_mean =     296.641334434076
             stat err =       0.000413611175
             autocorr =       1.181662077507
   target nu stat err =       0.000413611175
   target dn stat err =       0.003162755515
      target stat err =       0.004883979934
              std dev =       0.538097052582
             le_variance =       0.289548437997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659102
                                         uncertainty =       0.002205754768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659102
                                         uncertainty =       0.002205754768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380492075
  error estimate for blocks of size 2^( 2) =       0.000391732241
  error estimate for blocks of size 2^( 3) =       0.000402090104
  error estimate for blocks of size 2^( 4) =       0.000409893063
  error estimate for blocks of size 2^( 5) =       0.000414391575
  error estimate for blocks of size 2^( 6) =       0.000413913264
  error estimate for blocks of size 2^( 7) =       0.000416246800

      target function =      -0.904486777467
              le_mean =     -17.214414587671
             les_mean =     296.641334434114
             stat err =       0.000413611175
             autocorr =       1.181662077397
   target nu stat err =       0.000413611175
   target dn stat err =       0.003162755501
      target stat err =       0.004883979913
              std dev =       0.538097052598
             le_variance =       0.289548438014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659117
                                         uncertainty =       0.002205754766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289535659117
                                         uncertainty =       0.002205754766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380492075
  error estimate for blocks of size 2^( 2) =       0.000391732241
  error estimate for blocks of size 2^( 3) =       0.000402090104
  error estimate for blocks of size 2^( 4) =       0.000409893063
  error estimate for blocks of size 2^( 5) =       0.000414391575
  error estimate for blocks of size 2^( 6) =       0.000413913264
  error estimate for blocks of size 2^( 7) =       0.000416246800

      target function =      -0.904486777465
              le_mean =     -17.214414587672
             les_mean =     296.641334434147
             stat err =       0.000413611175
             autocorr =       1.181662077296
   target nu stat err =       0.000413611175
   target dn stat err =       0.003162755489
      target stat err =       0.004883979896
              std dev =       0.538097052612
             le_variance =       0.289548438029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904486777465        initial
     3.4694e+05     3.4694e+06             2.7580e-10        -0.904486777468  <--
     1.3878e+06     1.3878e+07             6.8951e-11        -0.904486777467
     5.5511e+06     5.5511e+07             1.7238e-11        -0.904486777465

*****************************************************************************
Applying the update for shift_i =   3.4694e+05     and shift_s =   3.4694e+06
*****************************************************************************

  Execution time = 2.2843e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583157e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795522e-03 3 1  ON 29
ci_031                -8.563487e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201089e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675224e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730482e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398761e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.159023
====================================================
  Execution time = 1.3746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0507e-01
  Total weights = 1.957680548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290112796371
                                         uncertainty =       0.002179387824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290112796371
                                         uncertainty =       0.002179387824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380861425
  error estimate for blocks of size 2^( 2) =       0.000392158172
  error estimate for blocks of size 2^( 3) =       0.000402273349
  error estimate for blocks of size 2^( 4) =       0.000409819865
  error estimate for blocks of size 2^( 5) =       0.000414381524
  error estimate for blocks of size 2^( 6) =       0.000416561093
  error estimate for blocks of size 2^( 7) =       0.000418182113

      target function =      -0.904735691222
              le_mean =     -17.215222226292
             les_mean =     296.668949214511
             stat err =       0.000414736149
             autocorr =       1.185795521353
   target nu stat err =       0.000414736149
   target dn stat err =       0.003200696427
      target stat err =       0.004951813133
              std dev =       0.538619392062
             le_variance =       0.290110849506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522222629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904761696690       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904761697333       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904761697395       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904761697418       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904761697385       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904761697421       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904761697368       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904761697423       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904761697596       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904761697472       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+04 is 1.692600e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904761696690       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904761696851       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904761696866       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904761696872       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904761697068       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904761696921       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904761696987       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904761697296       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904761697022       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904761697102       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+05 is 4.231502e-10

solving harmonic davidson linear method for identity shift 1.3878e+06, overlap shift 1.3878e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904761696690       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904761696730       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904761696734       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904761697519       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904761697005       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904761696736       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904761698379       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904761699500       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904761697181       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904761697280       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+06 is 1.057876e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.289993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6251e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981670e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201091e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255644e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816407e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1393
    reference variance = 0.170631
====================================================
  Execution time = 1.3674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0852e-01
  Total weights = 1.9577e+06
  Execution time = 1.8465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113872
                                         uncertainty =       0.002963204784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113872
                                         uncertainty =       0.002963204784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382326685
  error estimate for blocks of size 2^( 2) =       0.000393778717
  error estimate for blocks of size 2^( 3) =       0.000403931565
  error estimate for blocks of size 2^( 4) =       0.000410850031
  error estimate for blocks of size 2^( 5) =       0.000415489802
  error estimate for blocks of size 2^( 6) =       0.000418643170
  error estimate for blocks of size 2^( 7) =       0.000420008916

      target function =      -0.899421934163
              le_mean =     -17.215780065116
             les_mean =     296.691607886477
             stat err =       0.000416247980
             autocorr =       1.185318476276
   target nu stat err =       0.000416247980
   target dn stat err =       0.004312144144
      target stat err =       0.006571102834
              std dev =       0.540691583758
             le_variance =       0.292347388746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113432
                                         uncertainty =       0.002963204663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113432
                                         uncertainty =       0.002963204663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382326685
  error estimate for blocks of size 2^( 2) =       0.000393778716
  error estimate for blocks of size 2^( 3) =       0.000403931565
  error estimate for blocks of size 2^( 4) =       0.000410850031
  error estimate for blocks of size 2^( 5) =       0.000415489802
  error estimate for blocks of size 2^( 6) =       0.000418643170
  error estimate for blocks of size 2^( 7) =       0.000420008916

      target function =      -0.899421948088
              le_mean =     -17.215780065123
             les_mean =     296.691607877531
             stat err =       0.000416247980
             autocorr =       1.185318478405
   target nu stat err =       0.000416247980
   target dn stat err =       0.004312143383
      target stat err =       0.006571101890
              std dev =       0.540691583351
             le_variance =       0.292347388307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113652
                                         uncertainty =       0.002963204724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113652
                                         uncertainty =       0.002963204724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382326685
  error estimate for blocks of size 2^( 2) =       0.000393778717
  error estimate for blocks of size 2^( 3) =       0.000403931565
  error estimate for blocks of size 2^( 4) =       0.000410850031
  error estimate for blocks of size 2^( 5) =       0.000415489802
  error estimate for blocks of size 2^( 6) =       0.000418643170
  error estimate for blocks of size 2^( 7) =       0.000420008916

      target function =      -0.899421941126
              le_mean =     -17.215780065119
             les_mean =     296.691607882004
             stat err =       0.000416247980
             autocorr =       1.185318477348
   target nu stat err =       0.000416247980
   target dn stat err =       0.004312143763
      target stat err =       0.006571102362
              std dev =       0.540691583554
             le_variance =       0.292347388527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113844
                                         uncertainty =       0.002963204777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292256113844
                                         uncertainty =       0.002963204777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382326685
  error estimate for blocks of size 2^( 2) =       0.000393778717
  error estimate for blocks of size 2^( 3) =       0.000403931565
  error estimate for blocks of size 2^( 4) =       0.000410850031
  error estimate for blocks of size 2^( 5) =       0.000415489802
  error estimate for blocks of size 2^( 6) =       0.000418643170
  error estimate for blocks of size 2^( 7) =       0.000420008916

      target function =      -0.899421935034
              le_mean =     -17.215780065116
             les_mean =     296.691607885918
             stat err =       0.000416247980
             autocorr =       1.185318476407
   target nu stat err =       0.000416247980
   target dn stat err =       0.004312144096
      target stat err =       0.006571102775
              std dev =       0.540691583732
             le_variance =       0.292347388719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899421934163        initial
     8.6736e+04     8.6736e+05             1.6926e-09        -0.899421948088  <--
     3.4694e+05     3.4694e+06             4.2315e-10        -0.899421941126
     1.3878e+06     1.3878e+07             1.0579e-10        -0.899421935034

*****************************************************************************
Applying the update for shift_i =   8.6736e+04     and shift_s =   8.6736e+05
*****************************************************************************

  Execution time = 2.2995e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9254e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.165
    reference variance = 0.215723
====================================================
  Execution time = 1.3705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0098e-01
  Total weights = 1.957537151e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287768773388
                                         uncertainty =       0.001629162805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287768773388
                                         uncertainty =       0.001629162805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379321698
  error estimate for blocks of size 2^( 2) =       0.000390541462
  error estimate for blocks of size 2^( 3) =       0.000401167114
  error estimate for blocks of size 2^( 4) =       0.000408372796
  error estimate for blocks of size 2^( 5) =       0.000414111237
  error estimate for blocks of size 2^( 6) =       0.000415352407
  error estimate for blocks of size 2^( 7) =       0.000418316890

      target function =      -0.911069501725
              le_mean =     -17.214906858733
             les_mean =     296.653997638896
             stat err =       0.000414038332
             autocorr =       1.191422315859
   target nu stat err =       0.000414038332
   target dn stat err =       0.002697656987
      target stat err =       0.004245942054
              std dev =       0.536441889282
             le_variance =       0.287769900576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721490685873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+04, overlap shift 2.1684e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911088471351       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911088474008       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911088474211       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911088474264       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911088474249       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911088474288       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911088474297       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911088474276       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911088474258       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911088474260       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+04 is 6.651400e-09

solving harmonic davidson linear method for identity shift 8.6736e+04, overlap shift 8.6736e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911088471351       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911088472015       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911088472066       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911088472070       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911088472082       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911088472082       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911088472082       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911088472082       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911088471979       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911088472039       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+04 is 1.662854e-09

solving harmonic davidson linear method for identity shift 3.4694e+05, overlap shift 3.4694e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911088471351       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911088471517       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911088471530       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911088471533       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911088471534       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911088471534       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911088471399       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911088471534       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911088471534       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911088471534       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+05 is 4.157138e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6224e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874127e-03 3 1  ON 9
ci_011                -9.142930e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981668e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361652e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594931e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795520e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348099e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201093e-04 3 1  ON 37
ci_039                 1.223265e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921460e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771171e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275285e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781415e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398763e-03 3 1  ON 67
ci_069                -4.115058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1149
    reference variance = 0.381438
====================================================
  Execution time = 1.3559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9896e-01
  Total weights = 1.9581e+06
  Execution time = 1.8490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341892
                                         uncertainty =       0.001568636670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341892
                                         uncertainty =       0.001568636670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378825678
  error estimate for blocks of size 2^( 2) =       0.000390122204
  error estimate for blocks of size 2^( 3) =       0.000400302095
  error estimate for blocks of size 2^( 4) =       0.000407688772
  error estimate for blocks of size 2^( 5) =       0.000412622270
  error estimate for blocks of size 2^( 6) =       0.000414927410
  error estimate for blocks of size 2^( 7) =       0.000416923071

      target function =      -0.914209945786
              le_mean =     -17.215288075303
             les_mean =     296.665100167896
             stat err =       0.000413040381
             autocorr =       1.188792912496
   target nu stat err =       0.000413040381
   target dn stat err =       0.002336788745
      target stat err =       0.003722165012
              std dev =       0.535740411190
             le_variance =       0.287017788182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341403
                                         uncertainty =       0.001568636763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341403
                                         uncertainty =       0.001568636763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378825677
  error estimate for blocks of size 2^( 2) =       0.000390122204
  error estimate for blocks of size 2^( 3) =       0.000400302095
  error estimate for blocks of size 2^( 4) =       0.000407688772
  error estimate for blocks of size 2^( 5) =       0.000412622270
  error estimate for blocks of size 2^( 6) =       0.000414927410
  error estimate for blocks of size 2^( 7) =       0.000416923071

      target function =      -0.914209932094
              le_mean =     -17.215288075358
             les_mean =     296.665100178538
             stat err =       0.000413040381
             autocorr =       1.188792915385
   target nu stat err =       0.000413040381
   target dn stat err =       0.002336789715
      target stat err =       0.003722166393
              std dev =       0.535740410721
             le_variance =       0.287017787679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341647
                                         uncertainty =       0.001568636717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341647
                                         uncertainty =       0.001568636717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378825678
  error estimate for blocks of size 2^( 2) =       0.000390122204
  error estimate for blocks of size 2^( 3) =       0.000400302095
  error estimate for blocks of size 2^( 4) =       0.000407688772
  error estimate for blocks of size 2^( 5) =       0.000412622270
  error estimate for blocks of size 2^( 6) =       0.000414927410
  error estimate for blocks of size 2^( 7) =       0.000416923071

      target function =      -0.914209938940
              le_mean =     -17.215288075330
             les_mean =     296.665100173216
             stat err =       0.000413040381
             autocorr =       1.188792913949
   target nu stat err =       0.000413040381
   target dn stat err =       0.002336789230
      target stat err =       0.003722165702
              std dev =       0.535740410955
             le_variance =       0.287017787930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341861
                                         uncertainty =       0.001568636676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287008341861
                                         uncertainty =       0.001568636676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378825678
  error estimate for blocks of size 2^( 2) =       0.000390122204
  error estimate for blocks of size 2^( 3) =       0.000400302095
  error estimate for blocks of size 2^( 4) =       0.000407688772
  error estimate for blocks of size 2^( 5) =       0.000412622270
  error estimate for blocks of size 2^( 6) =       0.000414927410
  error estimate for blocks of size 2^( 7) =       0.000416923071

      target function =      -0.914209944930
              le_mean =     -17.215288075306
             les_mean =     296.665100168561
             stat err =       0.000413040381
             autocorr =       1.188792912687
   target nu stat err =       0.000413040381
   target dn stat err =       0.002336788805
      target stat err =       0.003722165098
              std dev =       0.535740411160
             le_variance =       0.287017788150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914209945786        initial  <--
     2.1684e+04     2.1684e+05             6.6514e-09        -0.914209932094
     8.6736e+04     8.6736e+05             1.6629e-09        -0.914209938940
     3.4694e+05     3.4694e+06             4.1571e-10        -0.914209944930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9043
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2581
    reference variance = 0.271415
====================================================
  Execution time = 1.3833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9751e-01
  Total weights = 1.957716519e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284550723699
                                         uncertainty =       0.001528507020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284550723699
                                         uncertainty =       0.001528507020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377186537
  error estimate for blocks of size 2^( 2) =       0.000388719947
  error estimate for blocks of size 2^( 3) =       0.000399121303
  error estimate for blocks of size 2^( 4) =       0.000406901622
  error estimate for blocks of size 2^( 5) =       0.000412207083
  error estimate for blocks of size 2^( 6) =       0.000414746245
  error estimate for blocks of size 2^( 7) =       0.000415309043

      target function =      -0.916523330522
              le_mean =     -17.214173034321
             les_mean =     296.625258624084
             stat err =       0.000412290998
             autocorr =       1.194800345161
   target nu stat err =       0.000412290998
   target dn stat err =       0.002260741163
      target stat err =       0.003615588185
              std dev =       0.533422316214
             le_variance =       0.284539367435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721417303432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+05, overlap shift 2.1684e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916536617734       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916536617858       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916536617885       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916536617895       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916536617897       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916536617594       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916536617643       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916536617868       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916536617710       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916536617897       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+05 is 9.894404e-10

solving harmonic davidson linear method for identity shift 8.6736e+05, overlap shift 8.6736e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916536617734       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916536617765       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916536617772       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916536617806       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916536618577       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916536616719       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916536616449       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916536617095       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916536615900       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916536617364       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+05 is 2.473602e-10

solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916536617734       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916536617742       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916536617744       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916536617744       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916536615717       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916536615857       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916536612446       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916536621106       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916536617909       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916536624570       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+06 is 6.183989e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6351e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.298723
====================================================
  Execution time = 1.3500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9955e-01
  Total weights = 1.9576e+06
  Execution time = 1.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467784
                                         uncertainty =       0.002373161221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467784
                                         uncertainty =       0.002373161221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379544893
  error estimate for blocks of size 2^( 2) =       0.000390652813
  error estimate for blocks of size 2^( 3) =       0.000400969864
  error estimate for blocks of size 2^( 4) =       0.000409000647
  error estimate for blocks of size 2^( 5) =       0.000415094151
  error estimate for blocks of size 2^( 6) =       0.000417529422
  error estimate for blocks of size 2^( 7) =       0.000416879356

      target function =      -0.913283180696
              le_mean =     -17.215332752158
             les_mean =     296.667226769590
             stat err =       0.000414625894
             autocorr =       1.193401387958
   target nu stat err =       0.000414625894
   target dn stat err =       0.002788635375
      target stat err =       0.004409985787
              std dev =       0.536757534673
             le_variance =       0.288108651029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467778
                                         uncertainty =       0.002373161198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467778
                                         uncertainty =       0.002373161198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379544893
  error estimate for blocks of size 2^( 2) =       0.000390652813
  error estimate for blocks of size 2^( 3) =       0.000400969864
  error estimate for blocks of size 2^( 4) =       0.000409000647
  error estimate for blocks of size 2^( 5) =       0.000415094151
  error estimate for blocks of size 2^( 6) =       0.000417529422
  error estimate for blocks of size 2^( 7) =       0.000416879356

      target function =      -0.913283180462
              le_mean =     -17.215332752162
             les_mean =     296.667226769878
             stat err =       0.000414625894
             autocorr =       1.193401388203
   target nu stat err =       0.000414625894
   target dn stat err =       0.002788635373
      target stat err =       0.004409985782
              std dev =       0.536757534668
             le_variance =       0.288108651023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467781
                                         uncertainty =       0.002373161209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467781
                                         uncertainty =       0.002373161209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379544893
  error estimate for blocks of size 2^( 2) =       0.000390652813
  error estimate for blocks of size 2^( 3) =       0.000400969864
  error estimate for blocks of size 2^( 4) =       0.000409000647
  error estimate for blocks of size 2^( 5) =       0.000415094151
  error estimate for blocks of size 2^( 6) =       0.000417529422
  error estimate for blocks of size 2^( 7) =       0.000416879356

      target function =      -0.913283180579
              le_mean =     -17.215332752160
             les_mean =     296.667226769734
             stat err =       0.000414625894
             autocorr =       1.193401388085
   target nu stat err =       0.000414625894
   target dn stat err =       0.002788635374
      target stat err =       0.004409985785
              std dev =       0.536757534671
             le_variance =       0.288108651026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467783
                                         uncertainty =       0.002373161219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288195467783
                                         uncertainty =       0.002373161219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379544893
  error estimate for blocks of size 2^( 2) =       0.000390652813
  error estimate for blocks of size 2^( 3) =       0.000400969864
  error estimate for blocks of size 2^( 4) =       0.000409000647
  error estimate for blocks of size 2^( 5) =       0.000415094151
  error estimate for blocks of size 2^( 6) =       0.000417529422
  error estimate for blocks of size 2^( 7) =       0.000416879356

      target function =      -0.913283180681
              le_mean =     -17.215332752158
             les_mean =     296.667226769608
             stat err =       0.000414625894
             autocorr =       1.193401387971
   target nu stat err =       0.000414625894
   target dn stat err =       0.002788635375
      target stat err =       0.004409985787
              std dev =       0.536757534673
             le_variance =       0.288108651028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913283180696        initial  <--
     2.1684e+05     2.1684e+06             9.8944e-10        -0.913283180462
     8.6736e+05     8.6736e+06             2.4736e-10        -0.913283180579
     3.4694e+06     3.4694e+07             6.1840e-11        -0.913283180681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8311
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.312346
====================================================
  Execution time = 1.4161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9584e-01
  Total weights = 1.957761515e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283489151267
                                         uncertainty =       0.001467773474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283489151267
                                         uncertainty =       0.001467773474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376530592
  error estimate for blocks of size 2^( 2) =       0.000388440703
  error estimate for blocks of size 2^( 3) =       0.000399249882
  error estimate for blocks of size 2^( 4) =       0.000406661995
  error estimate for blocks of size 2^( 5) =       0.000411001956
  error estimate for blocks of size 2^( 6) =       0.000413594096
  error estimate for blocks of size 2^( 7) =       0.000416361957

      target function =      -0.919116722983
              le_mean =     -17.214770564283
             les_mean =     296.644170063560
             stat err =       0.000411905001
             autocorr =       1.196722884875
   target nu stat err =       0.000411905001
   target dn stat err =       0.002453456689
      target stat err =       0.003938602746
              std dev =       0.532494669449
             le_variance =       0.283550572992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721477056428e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919132770604       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919132770615       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919132770617       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919132770325       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919132771564       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919132768165       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919132773166       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919132774941       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919132770602       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919132773423       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 5.105896e-11

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919132770604       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919132770607       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919132770607       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919132770607       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919132761949       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919132763412       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919132760932       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919132770608       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919132771528       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919132784148       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+06 is 1.276477e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919132770604       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919132770605       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919132770605       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919132770605       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919132770631       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919132778658       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919132713361       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919132802748       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919132830830       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919132794935       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+07 is 3.191342e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6679e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.325201
====================================================
  Execution time = 1.5941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0175e-01
  Total weights = 1.9576e+06
  Execution time = 1.8513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872396
                                         uncertainty =       0.002303012194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872396
                                         uncertainty =       0.002303012194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379464736
  error estimate for blocks of size 2^( 2) =       0.000390599371
  error estimate for blocks of size 2^( 3) =       0.000400789676
  error estimate for blocks of size 2^( 4) =       0.000408569240
  error estimate for blocks of size 2^( 5) =       0.000414285284
  error estimate for blocks of size 2^( 6) =       0.000417032101
  error estimate for blocks of size 2^( 7) =       0.000418419714

      target function =      -0.909855153549
              le_mean =     -17.214836700035
             les_mean =     296.652348675122
             stat err =       0.000414576585
             autocorr =       1.193621667585
   target nu stat err =       0.000414576585
   target dn stat err =       0.004308140539
      target stat err =       0.006705244015
              std dev =       0.536644175977
             le_variance =       0.287986971610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872394
                                         uncertainty =       0.002303012195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872394
                                         uncertainty =       0.002303012195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379464736
  error estimate for blocks of size 2^( 2) =       0.000390599371
  error estimate for blocks of size 2^( 3) =       0.000400789676
  error estimate for blocks of size 2^( 4) =       0.000408569240
  error estimate for blocks of size 2^( 5) =       0.000414285284
  error estimate for blocks of size 2^( 6) =       0.000417032101
  error estimate for blocks of size 2^( 7) =       0.000418419714

      target function =      -0.909855153621
              le_mean =     -17.214836700035
             les_mean =     296.652348675083
             stat err =       0.000414576585
             autocorr =       1.193621667575
   target nu stat err =       0.000414576585
   target dn stat err =       0.004308140542
      target stat err =       0.006705244020
              std dev =       0.536644175974
             le_variance =       0.287986971607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872395
                                         uncertainty =       0.002303012195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872395
                                         uncertainty =       0.002303012195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379464736
  error estimate for blocks of size 2^( 2) =       0.000390599371
  error estimate for blocks of size 2^( 3) =       0.000400789676
  error estimate for blocks of size 2^( 4) =       0.000408569240
  error estimate for blocks of size 2^( 5) =       0.000414285284
  error estimate for blocks of size 2^( 6) =       0.000417032101
  error estimate for blocks of size 2^( 7) =       0.000418419714

      target function =      -0.909855153585
              le_mean =     -17.214836700035
             les_mean =     296.652348675103
             stat err =       0.000414576585
             autocorr =       1.193621667587
   target nu stat err =       0.000414576585
   target dn stat err =       0.004308140540
      target stat err =       0.006705244018
              std dev =       0.536644175975
             le_variance =       0.287986971608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872396
                                         uncertainty =       0.002303012194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981872396
                                         uncertainty =       0.002303012194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379464736
  error estimate for blocks of size 2^( 2) =       0.000390599371
  error estimate for blocks of size 2^( 3) =       0.000400789676
  error estimate for blocks of size 2^( 4) =       0.000408569240
  error estimate for blocks of size 2^( 5) =       0.000414285284
  error estimate for blocks of size 2^( 6) =       0.000417032101
  error estimate for blocks of size 2^( 7) =       0.000418419714

      target function =      -0.909855153553
              le_mean =     -17.214836700035
             les_mean =     296.652348675120
             stat err =       0.000414576585
             autocorr =       1.193621667582
   target nu stat err =       0.000414576585
   target dn stat err =       0.004308140539
      target stat err =       0.006705244015
              std dev =       0.536644175977
             le_variance =       0.287986971610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.909855153549        initial
     2.1684e+06     2.1684e+07             5.1059e-11        -0.909855153621  <--
     8.6736e+06     8.6736e+07             1.2765e-11        -0.909855153585
     3.4694e+07     3.4694e+08             3.1913e-12        -0.909855153553

*****************************************************************************
Applying the update for shift_i =   2.1684e+06     and shift_s =   2.1684e+07
*****************************************************************************

  Execution time = 2.5285e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870146e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1479
    reference variance = 0.662788
====================================================
  Execution time = 1.4442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9649e-01
  Total weights = 1.957851673e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285303906978
                                         uncertainty =       0.001525209892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285303906978
                                         uncertainty =       0.001525209892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377694880
  error estimate for blocks of size 2^( 2) =       0.000389066615
  error estimate for blocks of size 2^( 3) =       0.000399597218
  error estimate for blocks of size 2^( 4) =       0.000407353188
  error estimate for blocks of size 2^( 5) =       0.000411655194
  error estimate for blocks of size 2^( 6) =       0.000413917170
  error estimate for blocks of size 2^( 7) =       0.000415059852

      target function =      -0.918093198161
              le_mean =     -17.215111149321
             les_mean =     296.656541832597
             stat err =       0.000411996351
             autocorr =       1.189883780316
   target nu stat err =       0.000411996351
   target dn stat err =       0.002035460446
      target stat err =       0.003286335950
              std dev =       0.534141221201
             le_variance =       0.285306844186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721511114932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918104019589       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918104019636       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918104019644       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918104019803       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918104019041       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918104020076       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918104019326       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918104019124       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918104019648       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918104020041       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 2.491806e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918104019589       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918104019601       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918104019603       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918104019620       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918104019655       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918104019263       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918104016019       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918104022620       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918104021447       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918104017906       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 6.229516e-11

solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918104019589       residual = 6.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918104019592       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918104019593       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918104021131       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918104019631       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918104036395       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918104017160       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918104012344       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918104016387       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918104037113       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+06 is 1.557379e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6948e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.181326
====================================================
  Execution time = 1.3740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0589e-01
  Total weights = 1.9578e+06
  Execution time = 1.8473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777689
                                         uncertainty =       0.002131630632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777689
                                         uncertainty =       0.002131630632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379882399
  error estimate for blocks of size 2^( 2) =       0.000390972012
  error estimate for blocks of size 2^( 3) =       0.000401245774
  error estimate for blocks of size 2^( 4) =       0.000408889867
  error estimate for blocks of size 2^( 5) =       0.000414737235
  error estimate for blocks of size 2^( 6) =       0.000417088392
  error estimate for blocks of size 2^( 7) =       0.000418003426

      target function =      -0.903531042826
              le_mean =     -17.213953203881
             les_mean =     296.626073573998
             stat err =       0.000414679730
             autocorr =       1.191591155407
   target nu stat err =       0.000414679730
   target dn stat err =       0.004579730447
      target stat err =       0.007013690848
              std dev =       0.537234840255
             le_variance =       0.288621273584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777252
                                         uncertainty =       0.002131630599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777252
                                         uncertainty =       0.002131630599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379882398
  error estimate for blocks of size 2^( 2) =       0.000390972012
  error estimate for blocks of size 2^( 3) =       0.000401245774
  error estimate for blocks of size 2^( 4) =       0.000408889867
  error estimate for blocks of size 2^( 5) =       0.000414737235
  error estimate for blocks of size 2^( 6) =       0.000417088392
  error estimate for blocks of size 2^( 7) =       0.000418003426

      target function =      -0.903531063278
              le_mean =     -17.213953203866
             les_mean =     296.626073560241
             stat err =       0.000414679730
             autocorr =       1.191591156258
   target nu stat err =       0.000414679730
   target dn stat err =       0.004579719990
      target stat err =       0.007013675307
              std dev =       0.537234839847
             le_variance =       0.288621273145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777470
                                         uncertainty =       0.002131630616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777470
                                         uncertainty =       0.002131630616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379882398
  error estimate for blocks of size 2^( 2) =       0.000390972012
  error estimate for blocks of size 2^( 3) =       0.000401245774
  error estimate for blocks of size 2^( 4) =       0.000408889867
  error estimate for blocks of size 2^( 5) =       0.000414737235
  error estimate for blocks of size 2^( 6) =       0.000417088392
  error estimate for blocks of size 2^( 7) =       0.000418003426

      target function =      -0.903531053052
              le_mean =     -17.213953203874
             les_mean =     296.626073567119
             stat err =       0.000414679730
             autocorr =       1.191591155842
   target nu stat err =       0.000414679730
   target dn stat err =       0.004579725219
      target stat err =       0.007013683078
              std dev =       0.537234840051
             le_variance =       0.288621273365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777662
                                         uncertainty =       0.002131630630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288654777662
                                         uncertainty =       0.002131630630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379882399
  error estimate for blocks of size 2^( 2) =       0.000390972012
  error estimate for blocks of size 2^( 3) =       0.000401245774
  error estimate for blocks of size 2^( 4) =       0.000408889867
  error estimate for blocks of size 2^( 5) =       0.000414737235
  error estimate for blocks of size 2^( 6) =       0.000417088392
  error estimate for blocks of size 2^( 7) =       0.000418003426

      target function =      -0.903531044105
              le_mean =     -17.213953203880
             les_mean =     296.626073573138
             stat err =       0.000414679730
             autocorr =       1.191591155475
   target nu stat err =       0.000414679730
   target dn stat err =       0.004579729793
      target stat err =       0.007013689877
              std dev =       0.537234840230
             le_variance =       0.288621273557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903531042826        initial
     5.4210e+05     5.4210e+06             2.4918e-10        -0.903531063278  <--
     2.1684e+06     2.1684e+07             6.2295e-11        -0.903531053052
     8.6736e+06     8.6736e+07             1.5574e-11        -0.903531044105

*****************************************************************************
Applying the update for shift_i =   5.4210e+05     and shift_s =   5.4210e+06
*****************************************************************************

  Execution time = 2.3062e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874129e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201095e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 0.414087
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9979e-01
  Total weights = 1.957848570e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286505934143
                                         uncertainty =       0.001792019270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286505934143
                                         uncertainty =       0.001792019270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378464695
  error estimate for blocks of size 2^( 2) =       0.000389641419
  error estimate for blocks of size 2^( 3) =       0.000399927924
  error estimate for blocks of size 2^( 4) =       0.000407121986
  error estimate for blocks of size 2^( 5) =       0.000411476394
  error estimate for blocks of size 2^( 6) =       0.000415233544
  error estimate for blocks of size 2^( 7) =       0.000416239791

      target function =      -0.912880475899
              le_mean =     -17.215793136472
             les_mean =     296.683327435470
             stat err =       0.000412517929
             autocorr =       1.188050528025
   target nu stat err =       0.000412517929
   target dn stat err =       0.002381146541
      target stat err =       0.003782882766
              std dev =       0.535229904650
             le_variance =       0.286471050831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721579313647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912895156612       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912895156931       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912895156956       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912895156969       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912895157168       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912895156971       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912895157089       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912895157084       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912895157295       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912895156832       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 9.584354e-10

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912895156612       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912895156692       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912895156698       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912895156700       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912895156547       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912895156875       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912895156631       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912895155973       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912895156409       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912895156256       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 2.396090e-10

solving harmonic davidson linear method for identity shift 2.1684e+06, overlap shift 2.1684e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912895156612       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912895156632       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912895156634       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912895156634       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912895156717       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912895156870       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912895157486       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912895156076       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912895158238       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912895153899       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+06 is 5.990225e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6473e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874128e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594930e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915596e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150774e-02 3 1  ON 36
ci_038                 9.201094e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321165e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160626e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2533
    reference variance = 0.203635
====================================================
  Execution time = 1.3859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0955e-01
  Total weights = 1.9581e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026209
                                         uncertainty =       0.001980512426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026209
                                         uncertainty =       0.001980512426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379944415
  error estimate for blocks of size 2^( 2) =       0.000391011827
  error estimate for blocks of size 2^( 3) =       0.000401853190
  error estimate for blocks of size 2^( 4) =       0.000409811513
  error estimate for blocks of size 2^( 5) =       0.000414391078
  error estimate for blocks of size 2^( 6) =       0.000416482532
  error estimate for blocks of size 2^( 7) =       0.000418320106

      target function =      -0.897787081553
              le_mean =     -17.214650444746
             les_mean =     296.653737452271
             stat err =       0.000414751307
             autocorr =       1.191613449995
   target nu stat err =       0.000414751307
   target dn stat err =       0.009145133640
      target stat err =       0.013796937396
              std dev =       0.537322545217
             le_variance =       0.288715517599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711025987
                                         uncertainty =       0.001980512393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711025987
                                         uncertainty =       0.001980512393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379944415
  error estimate for blocks of size 2^( 2) =       0.000391011827
  error estimate for blocks of size 2^( 3) =       0.000401853190
  error estimate for blocks of size 2^( 4) =       0.000409811513
  error estimate for blocks of size 2^( 5) =       0.000414391078
  error estimate for blocks of size 2^( 6) =       0.000416482532
  error estimate for blocks of size 2^( 7) =       0.000418320106

      target function =      -0.897787082618
              le_mean =     -17.214650444748
             les_mean =     296.653737451791
             stat err =       0.000414751307
             autocorr =       1.191613450785
   target nu stat err =       0.000414751307
   target dn stat err =       0.009145129065
      target stat err =       0.013796930541
              std dev =       0.537322545012
             le_variance =       0.288715517378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026098
                                         uncertainty =       0.001980512409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026098
                                         uncertainty =       0.001980512409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379944415
  error estimate for blocks of size 2^( 2) =       0.000391011827
  error estimate for blocks of size 2^( 3) =       0.000401853190
  error estimate for blocks of size 2^( 4) =       0.000409811513
  error estimate for blocks of size 2^( 5) =       0.000414391078
  error estimate for blocks of size 2^( 6) =       0.000416482532
  error estimate for blocks of size 2^( 7) =       0.000418320106

      target function =      -0.897787082085
              le_mean =     -17.214650444747
             les_mean =     296.653737452031
             stat err =       0.000414751307
             autocorr =       1.191613450391
   target nu stat err =       0.000414751307
   target dn stat err =       0.009145131352
      target stat err =       0.013796933968
              std dev =       0.537322545115
             le_variance =       0.288715517489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026195
                                         uncertainty =       0.001980512424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288711026195
                                         uncertainty =       0.001980512424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379944415
  error estimate for blocks of size 2^( 2) =       0.000391011827
  error estimate for blocks of size 2^( 3) =       0.000401853190
  error estimate for blocks of size 2^( 4) =       0.000409811513
  error estimate for blocks of size 2^( 5) =       0.000414391078
  error estimate for blocks of size 2^( 6) =       0.000416482532
  error estimate for blocks of size 2^( 7) =       0.000418320106

      target function =      -0.897787081619
              le_mean =     -17.214650444746
             les_mean =     296.653737452241
             stat err =       0.000414751307
             autocorr =       1.191613450044
   target nu stat err =       0.000414751307
   target dn stat err =       0.009145133354
      target stat err =       0.013796936968
              std dev =       0.537322545204
             le_variance =       0.288715517585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.897787081553        initial
     1.3553e+05     1.3553e+06             9.5844e-10        -0.897787082618  <--
     5.4210e+05     5.4210e+06             2.3961e-10        -0.897787082085
     2.1684e+06     2.1684e+07             5.9902e-11        -0.897787081619

*****************************************************************************
Applying the update for shift_i =   1.3553e+05     and shift_s =   1.3553e+06
*****************************************************************************

  Execution time = 2.3239e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758178e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874128e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080338e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594929e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639854e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915597e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201094e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921462e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321164e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660814e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044641e-03 3 1  ON 57
ci_059                -2.118575e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398762e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.130404
====================================================
  Execution time = 1.4551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0158e-01
  Total weights = 1.957610768e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287963405128
                                         uncertainty =       0.001773723416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287963405128
                                         uncertainty =       0.001773723416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379441206
  error estimate for blocks of size 2^( 2) =       0.000390460016
  error estimate for blocks of size 2^( 3) =       0.000400966998
  error estimate for blocks of size 2^( 4) =       0.000408654442
  error estimate for blocks of size 2^( 5) =       0.000414311583
  error estimate for blocks of size 2^( 6) =       0.000417257012
  error estimate for blocks of size 2^( 7) =       0.000419011143

      target function =      -0.910149809013
              le_mean =     -17.214768862613
             les_mean =     296.649846404405
             stat err =       0.000414808545
             autocorr =       1.195105939337
   target nu stat err =       0.000414808545
   target dn stat err =       0.002386891009
      target stat err =       0.003762945536
              std dev =       0.536610899799
             le_variance =       0.287951257784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721476886261e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910164460253       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910164461332       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910164461529       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910164461586       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910164461619       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910164461625       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910164461657       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910164461611       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910164461610       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910164461610       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 3.541132e-09

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910164460253       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910164460523       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910164460572       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910164460588       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910164460559       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910164460764       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910164460572       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910164460441       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910164460738       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910164460713       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 8.852843e-10

solving harmonic davidson linear method for identity shift 5.4210e+05, overlap shift 5.4210e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910164460253       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910164460321       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910164460333       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910164460336       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910164460709       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910164460338       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910164460865       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910164460489       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910164459912       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910164460204       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+05 is 2.213212e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7082e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758179e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874128e-03 3 1  ON 9
ci_011                -9.142931e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361651e-03 3 1  ON 22
ci_024                 8.583159e-03 3 1  ON 23
ci_025                 8.594929e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639853e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563488e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915598e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201093e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255643e-03 3 1  ON 41
ci_043                -2.385651e-03 3 1  ON 42
ci_044                -3.921461e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321164e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660813e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118576e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181212e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213402e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398763e-03 3 1  ON 67
ci_069                -4.115059e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.186776
====================================================
  Execution time = 1.4318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9875e-01
  Total weights = 1.9575e+06
  Execution time = 1.8533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312517
                                         uncertainty =       0.001850241563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312517
                                         uncertainty =       0.001850241563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379081457
  error estimate for blocks of size 2^( 2) =       0.000390478131
  error estimate for blocks of size 2^( 3) =       0.000400759631
  error estimate for blocks of size 2^( 4) =       0.000408160005
  error estimate for blocks of size 2^( 5) =       0.000413722752
  error estimate for blocks of size 2^( 6) =       0.000414710971
  error estimate for blocks of size 2^( 7) =       0.000417542782

      target function =      -0.914555374635
              le_mean =     -17.214771918233
             les_mean =     296.647122570866
             stat err =       0.000413534127
             autocorr =       1.190029230965
   target nu stat err =       0.000413534127
   target dn stat err =       0.002080089156
      target stat err =       0.003328298449
              std dev =       0.536102138059
             le_variance =       0.287405502432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312519
                                         uncertainty =       0.001850241587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312519
                                         uncertainty =       0.001850241587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379081457
  error estimate for blocks of size 2^( 2) =       0.000390478131
  error estimate for blocks of size 2^( 3) =       0.000400759631
  error estimate for blocks of size 2^( 4) =       0.000408160005
  error estimate for blocks of size 2^( 5) =       0.000413722752
  error estimate for blocks of size 2^( 6) =       0.000414710971
  error estimate for blocks of size 2^( 7) =       0.000417542782

      target function =      -0.914555381669
              le_mean =     -17.214771918266
             les_mean =     296.647122567493
             stat err =       0.000413534128
             autocorr =       1.190029233341
   target nu stat err =       0.000413534128
   target dn stat err =       0.002080088694
      target stat err =       0.003328297793
              std dev =       0.536102138063
             le_variance =       0.287405502435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312518
                                         uncertainty =       0.001850241575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312518
                                         uncertainty =       0.001850241575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379081457
  error estimate for blocks of size 2^( 2) =       0.000390478131
  error estimate for blocks of size 2^( 3) =       0.000400759631
  error estimate for blocks of size 2^( 4) =       0.000408160005
  error estimate for blocks of size 2^( 5) =       0.000413722752
  error estimate for blocks of size 2^( 6) =       0.000414710971
  error estimate for blocks of size 2^( 7) =       0.000417542782

      target function =      -0.914555378152
              le_mean =     -17.214771918249
             les_mean =     296.647122569179
             stat err =       0.000413534128
             autocorr =       1.190029232152
   target nu stat err =       0.000413534128
   target dn stat err =       0.002080088925
      target stat err =       0.003328298121
              std dev =       0.536102138061
             le_variance =       0.287405502433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312517
                                         uncertainty =       0.001850241565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287457312517
                                         uncertainty =       0.001850241565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379081457
  error estimate for blocks of size 2^( 2) =       0.000390478131
  error estimate for blocks of size 2^( 3) =       0.000400759631
  error estimate for blocks of size 2^( 4) =       0.000408160005
  error estimate for blocks of size 2^( 5) =       0.000413722752
  error estimate for blocks of size 2^( 6) =       0.000414710971
  error estimate for blocks of size 2^( 7) =       0.000417542782

      target function =      -0.914555375075
              le_mean =     -17.214771918235
             les_mean =     296.647122570655
             stat err =       0.000413534127
             autocorr =       1.190029231116
   target nu stat err =       0.000413534127
   target dn stat err =       0.002080089128
      target stat err =       0.003328298408
              std dev =       0.536102138060
             le_variance =       0.287405502432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914555374635        initial
     3.3881e+04     3.3881e+05             3.5411e-09        -0.914555381669  <--
     1.3553e+05     1.3553e+06             8.8528e-10        -0.914555378152
     5.4210e+05     5.4210e+06             2.2132e-10        -0.914555375075

*****************************************************************************
Applying the update for shift_i =   3.3881e+04     and shift_s =   3.3881e+05
*****************************************************************************

  Execution time = 2.3661e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.762724e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155713e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847789e-02 3 1  ON 6
ci_008                -7.758180e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874126e-03 3 1  ON 9
ci_011                -9.142930e-03 3 1  ON 10
ci_012                -9.120736e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080337e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361649e-03 3 1  ON 22
ci_024                 8.583160e-03 3 1  ON 23
ci_025                 8.594929e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639850e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563489e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554525e-03 3 1  ON 32
ci_034                 4.915600e-03 3 1  ON 33
ci_035                -3.348098e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201092e-04 3 1  ON 37
ci_039                 1.223266e-03 3 1  ON 38
ci_040                -1.603073e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255642e-03 3 1  ON 41
ci_043                -2.385650e-03 3 1  ON 42
ci_044                -3.921460e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771173e-03 3 1  ON 45
ci_047                 4.645456e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825042e-03 3 1  ON 49
ci_051                 2.816409e-03 3 1  ON 50
ci_052                -2.275285e-03 3 1  ON 51
ci_053                -2.208903e-03 3 1  ON 52
ci_054                -2.321163e-03 3 1  ON 53
ci_055                -2.375183e-03 3 1  ON 54
ci_056                 4.660812e-03 3 1  ON 55
ci_057                 4.675225e-03 3 1  ON 56
ci_058                -2.044639e-03 3 1  ON 57
ci_059                -2.118577e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181213e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213403e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160627e-03 3 1  ON 66
ci_068                -4.398764e-03 3 1  ON 67
ci_069                -4.115060e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2091
    reference variance = 0.19609
====================================================
  Execution time = 1.4695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0194e-01
  Total weights = 1.957762559e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286911421527
                                         uncertainty =       0.001658958501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286911421527
                                         uncertainty =       0.001658958501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378823116
  error estimate for blocks of size 2^( 2) =       0.000390223459
  error estimate for blocks of size 2^( 3) =       0.000400180639
  error estimate for blocks of size 2^( 4) =       0.000407480396
  error estimate for blocks of size 2^( 5) =       0.000412013454
  error estimate for blocks of size 2^( 6) =       0.000414872481
  error estimate for blocks of size 2^( 7) =       0.000416809263

      target function =      -0.909592658673
              le_mean =     -17.214707594503
             les_mean =     296.648097808764
             stat err =       0.000412793898
             autocorr =       1.187390566169
   target nu stat err =       0.000412793898
   target dn stat err =       0.002504305266
      target stat err =       0.003935882403
              std dev =       0.535736788428
             le_variance =       0.287013906475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721470759450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909608819140       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909608822684       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909608823386       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909608823710       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909608823734       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909608823729       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909608823715       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909608823715       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909608823728       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909608823731       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 1.403229e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909608819140       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909608820026       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909608820201       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909608820282       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909608820255       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909608820292       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909608820369       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909608820214       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909608820273       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909608820288       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 3.508094e-09

solving harmonic davidson linear method for identity shift 1.3553e+05, overlap shift 1.3553e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909608819140       residual = 6.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909608819361       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909608819405       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909608819425       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909608819414       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909608819239       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909608819524       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909608819495       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909608819404       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909608819415       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+05 is 8.770248e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7226e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155712e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847788e-02 3 1  ON 6
ci_008                -7.758181e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874127e-03 3 1  ON 9
ci_011                -9.142929e-03 3 1  ON 10
ci_012                -9.120737e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080336e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506475e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258606e-03 3 1  ON 21
ci_023                 8.361649e-03 3 1  ON 22
ci_024                 8.583160e-03 3 1  ON 23
ci_025                 8.594929e-03 3 1  ON 24
ci_026                 1.002827e-02 3 1  ON 25
ci_027                 9.639850e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795523e-03 3 1  ON 29
ci_031                -8.563491e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554523e-03 3 1  ON 32
ci_034                 4.915600e-03 3 1  ON 33
ci_035                -3.348097e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201094e-04 3 1  ON 37
ci_039                 1.223265e-03 3 1  ON 38
ci_040                -1.603073e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255642e-03 3 1  ON 41
ci_043                -2.385649e-03 3 1  ON 42
ci_044                -3.921459e-03 3 1  ON 43
ci_045                -1.870145e-03 3 1  ON 44
ci_046                 4.771174e-03 3 1  ON 45
ci_047                 4.645459e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825041e-03 3 1  ON 49
ci_051                 2.816408e-03 3 1  ON 50
ci_052                -2.275285e-03 3 1  ON 51
ci_053                -2.208904e-03 3 1  ON 52
ci_054                -2.321162e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660810e-03 3 1  ON 55
ci_057                 4.675227e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118578e-03 3 1  ON 58
ci_060                 4.730481e-03 3 1  ON 59
ci_061                 5.181209e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781414e-03 3 1  ON 62
ci_064                -2.213404e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063186e-03 3 1  ON 65
ci_067                 4.160628e-03 3 1  ON 66
ci_068                -4.398765e-03 3 1  ON 67
ci_069                -4.115062e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.157844
====================================================
  Execution time = 1.4483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9737e-01
  Total weights = 1.9574e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720447063
                                         uncertainty =       0.001595239879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720447063
                                         uncertainty =       0.001595239879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377976075
  error estimate for blocks of size 2^( 2) =       0.000389101908
  error estimate for blocks of size 2^( 3) =       0.000399046129
  error estimate for blocks of size 2^( 4) =       0.000406309432
  error estimate for blocks of size 2^( 5) =       0.000410506524
  error estimate for blocks of size 2^( 6) =       0.000413608356
  error estimate for blocks of size 2^( 7) =       0.000415299235

      target function =      -0.916711247349
              le_mean =     -17.215101313860
             les_mean =     296.657080571092
             stat err =       0.000411430887
             autocorr =       1.184854881856
   target nu stat err =       0.000411430887
   target dn stat err =       0.002143188783
      target stat err =       0.003441973514
              std dev =       0.534538890936
             le_variance =       0.285731825923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446044
                                         uncertainty =       0.001595239629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446044
                                         uncertainty =       0.001595239629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377976074
  error estimate for blocks of size 2^( 2) =       0.000389101908
  error estimate for blocks of size 2^( 3) =       0.000399046130
  error estimate for blocks of size 2^( 4) =       0.000406309433
  error estimate for blocks of size 2^( 5) =       0.000410506526
  error estimate for blocks of size 2^( 6) =       0.000413608357
  error estimate for blocks of size 2^( 7) =       0.000415299236

      target function =      -0.916711266548
              le_mean =     -17.215101313908
             les_mean =     296.657080560509
             stat err =       0.000411430888
             autocorr =       1.184854895320
   target nu stat err =       0.000411430888
   target dn stat err =       0.002143188179
      target stat err =       0.003441972726
              std dev =       0.534538889988
             le_variance =       0.285731824910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446554
                                         uncertainty =       0.001595239754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446554
                                         uncertainty =       0.001595239754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377976074
  error estimate for blocks of size 2^( 2) =       0.000389101908
  error estimate for blocks of size 2^( 3) =       0.000399046130
  error estimate for blocks of size 2^( 4) =       0.000406309433
  error estimate for blocks of size 2^( 5) =       0.000410506525
  error estimate for blocks of size 2^( 6) =       0.000413608357
  error estimate for blocks of size 2^( 7) =       0.000415299235

      target function =      -0.916711256949
              le_mean =     -17.215101313884
             les_mean =     296.657080565800
             stat err =       0.000411430887
             autocorr =       1.184854888594
   target nu stat err =       0.000411430887
   target dn stat err =       0.002143188481
      target stat err =       0.003441973120
              std dev =       0.534538890462
             le_variance =       0.285731825416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446999
                                         uncertainty =       0.001595239863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285720446999
                                         uncertainty =       0.001595239863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377976075
  error estimate for blocks of size 2^( 2) =       0.000389101908
  error estimate for blocks of size 2^( 3) =       0.000399046130
  error estimate for blocks of size 2^( 4) =       0.000406309432
  error estimate for blocks of size 2^( 5) =       0.000410506524
  error estimate for blocks of size 2^( 6) =       0.000413608356
  error estimate for blocks of size 2^( 7) =       0.000415299235

      target function =      -0.916711248549
              le_mean =     -17.215101313863
             les_mean =     296.657080570431
             stat err =       0.000411430887
             autocorr =       1.184854882707
   target nu stat err =       0.000411430887
   target dn stat err =       0.002143188746
      target stat err =       0.003441973465
              std dev =       0.534538890876
             le_variance =       0.285731825859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916711247349        initial
     8.4703e+03     8.4703e+04             1.4032e-08        -0.916711266548  <--
     3.3881e+04     3.3881e+05             3.5081e-09        -0.916711256949
     1.3553e+05     1.3553e+06             8.7702e-10        -0.916711248549

*****************************************************************************
Applying the update for shift_i =   8.4703e+03     and shift_s =   8.4703e+04
*****************************************************************************

  Execution time = 2.3834e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367616e-02 3 1  ON 2
ci_004                 2.096115e-02 3 1  ON 3
ci_005                 2.155712e-02 3 1  ON 4
ci_006                -1.849771e-02 3 1  ON 5
ci_007                -1.847788e-02 3 1  ON 6
ci_008                -7.758184e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874132e-03 3 1  ON 9
ci_011                -9.142926e-03 3 1  ON 10
ci_012                -9.120740e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103419e-02 3 1  ON 14
ci_016                 1.597432e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080330e-03 3 1  ON 17
ci_019                 8.981669e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519134e-02 3 1  ON 20
ci_022                 8.258605e-03 3 1  ON 21
ci_023                 8.361647e-03 3 1  ON 22
ci_024                 8.583158e-03 3 1  ON 23
ci_025                 8.594927e-03 3 1  ON 24
ci_026                 1.002828e-02 3 1  ON 25
ci_027                 9.639850e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500986e-02 3 1  ON 28
ci_030                -8.795518e-03 3 1  ON 29
ci_031                -8.563494e-03 3 1  ON 30
ci_032                -1.443915e-02 3 1  ON 31
ci_033                 4.554516e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348094e-03 3 1  ON 34
ci_036                -1.126191e-02 3 1  ON 35
ci_037                -1.150773e-02 3 1  ON 36
ci_038                 9.201102e-04 3 1  ON 37
ci_039                 1.223263e-03 3 1  ON 38
ci_040                -1.603074e-03 3 1  ON 39
ci_041                 8.180205e-03 3 1  ON 40
ci_042                 8.255642e-03 3 1  ON 41
ci_043                -2.385646e-03 3 1  ON 42
ci_044                -3.921454e-03 3 1  ON 43
ci_045                -1.870148e-03 3 1  ON 44
ci_046                 4.771179e-03 3 1  ON 45
ci_047                 4.645466e-03 3 1  ON 46
ci_048                -1.242654e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825040e-03 3 1  ON 49
ci_051                 2.816406e-03 3 1  ON 50
ci_052                -2.275286e-03 3 1  ON 51
ci_053                -2.208904e-03 3 1  ON 52
ci_054                -2.321160e-03 3 1  ON 53
ci_055                -2.375186e-03 3 1  ON 54
ci_056                 4.660807e-03 3 1  ON 55
ci_057                 4.675234e-03 3 1  ON 56
ci_058                -2.044631e-03 3 1  ON 57
ci_059                -2.118581e-03 3 1  ON 58
ci_060                 4.730480e-03 3 1  ON 59
ci_061                 5.181199e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781411e-03 3 1  ON 62
ci_064                -2.213407e-03 3 1  ON 63
ci_065                -3.398061e-03 3 1  ON 64
ci_066                 4.063187e-03 3 1  ON 65
ci_067                 4.160630e-03 3 1  ON 66
ci_068                -4.398769e-03 3 1  ON 67
ci_069                -4.115068e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1068e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.3194
    reference variance = 1.95912
====================================================
  Execution time = 1.4845e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0404e-01
  Total weights = 1.957704499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288971597732
                                         uncertainty =       0.002240702327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288971597732
                                         uncertainty =       0.002240702327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380099194
  error estimate for blocks of size 2^( 2) =       0.000391078822
  error estimate for blocks of size 2^( 3) =       0.000401561042
  error estimate for blocks of size 2^( 4) =       0.000409108276
  error estimate for blocks of size 2^( 5) =       0.000412632989
  error estimate for blocks of size 2^( 6) =       0.000416065391
  error estimate for blocks of size 2^( 7) =       0.000419430422

      target function =      -0.906316108022
              le_mean =     -17.214803524784
             les_mean =     296.653502724642
             stat err =       0.000414309269
             autocorr =       1.188106584825
   target nu stat err =       0.000414309269
   target dn stat err =       0.004351155925
      target stat err =       0.006718706139
              std dev =       0.537541434867
             le_variance =       0.288950794199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721480352478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906364633683       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906364714009       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906364717959       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906364718763       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906364719089       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906364719134       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906364719168       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906364719167       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906364719170       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906364719168       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906364719172       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+03 is 1.222041e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906364633683       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906364653765       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906364654753       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906364654952       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906364655034       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906364655059       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906364655058       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906364655055       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906364655054       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906364655051       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906364655068       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 3.055192e-08

solving harmonic davidson linear method for identity shift 3.3881e+04, overlap shift 3.3881e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906364633683       residual = 5.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906364638704       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906364638951       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906364639014       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906364639025       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906364639088       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906364639046       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906364639025       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906364639015       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906364639109       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906364639030       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+04 is 7.638036e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7382e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367617e-02 3 1  ON 2
ci_004                 2.096118e-02 3 1  ON 3
ci_005                 2.155712e-02 3 1  ON 4
ci_006                -1.849771e-02 3 1  ON 5
ci_007                -1.847788e-02 3 1  ON 6
ci_008                -7.758164e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874118e-03 3 1  ON 9
ci_011                -9.142908e-03 3 1  ON 10
ci_012                -9.120735e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103418e-02 3 1  ON 14
ci_016                 1.597433e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080315e-03 3 1  ON 17
ci_019                 8.981663e-03 3 1  ON 18
ci_020                 1.506476e-02 3 1  ON 19
ci_021                 1.519135e-02 3 1  ON 20
ci_022                 8.258599e-03 3 1  ON 21
ci_023                 8.361644e-03 3 1  ON 22
ci_024                 8.583140e-03 3 1  ON 23
ci_025                 8.594922e-03 3 1  ON 24
ci_026                 1.002825e-02 3 1  ON 25
ci_027                 9.639851e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795520e-03 3 1  ON 29
ci_031                -8.563468e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554519e-03 3 1  ON 32
ci_034                 4.915601e-03 3 1  ON 33
ci_035                -3.348092e-03 3 1  ON 34
ci_036                -1.126190e-02 3 1  ON 35
ci_037                -1.150771e-02 3 1  ON 36
ci_038                 9.201031e-04 3 1  ON 37
ci_039                 1.223263e-03 3 1  ON 38
ci_040                -1.603073e-03 3 1  ON 39
ci_041                 8.180206e-03 3 1  ON 40
ci_042                 8.255638e-03 3 1  ON 41
ci_043                -2.385646e-03 3 1  ON 42
ci_044                -3.921452e-03 3 1  ON 43
ci_045                -1.870139e-03 3 1  ON 44
ci_046                 4.771177e-03 3 1  ON 45
ci_047                 4.645462e-03 3 1  ON 46
ci_048                -1.242653e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825043e-03 3 1  ON 49
ci_051                 2.816409e-03 3 1  ON 50
ci_052                -2.275280e-03 3 1  ON 51
ci_053                -2.208900e-03 3 1  ON 52
ci_054                -2.321169e-03 3 1  ON 53
ci_055                -2.375188e-03 3 1  ON 54
ci_056                 4.660807e-03 3 1  ON 55
ci_057                 4.675233e-03 3 1  ON 56
ci_058                -2.044632e-03 3 1  ON 57
ci_059                -2.118567e-03 3 1  ON 58
ci_060                 4.730490e-03 3 1  ON 59
ci_061                 5.181197e-03 3 1  ON 60
ci_062                -2.828205e-03 3 1  ON 61
ci_063                -2.781418e-03 3 1  ON 62
ci_064                -2.213405e-03 3 1  ON 63
ci_065                -3.398058e-03 3 1  ON 64
ci_066                 4.063191e-03 3 1  ON 65
ci_067                 4.160632e-03 3 1  ON 66
ci_068                -4.398768e-03 3 1  ON 67
ci_069                -4.115052e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1716
    reference variance = 0.203665
====================================================
  Execution time = 1.4277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9911e-01
  Total weights = 1.9579e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177554901
                                         uncertainty =       0.001693082427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177554901
                                         uncertainty =       0.001693082427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378559489
  error estimate for blocks of size 2^( 2) =       0.000389826249
  error estimate for blocks of size 2^( 3) =       0.000400308536
  error estimate for blocks of size 2^( 4) =       0.000408056331
  error estimate for blocks of size 2^( 5) =       0.000411865733
  error estimate for blocks of size 2^( 6) =       0.000413971458
  error estimate for blocks of size 2^( 7) =       0.000413320960

      target function =      -0.913985488539
              le_mean =     -17.214750658662
             les_mean =     296.646752884738
             stat err =       0.000411803620
             autocorr =       1.183346819044
   target nu stat err =       0.000411803620
   target dn stat err =       0.002460350500
      target stat err =       0.003905867764
              std dev =       0.535363963389
             le_variance =       0.286614573295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177539911
                                         uncertainty =       0.001693080585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177539911
                                         uncertainty =       0.001693080585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378559480
  error estimate for blocks of size 2^( 2) =       0.000389826248
  error estimate for blocks of size 2^( 3) =       0.000400308543
  error estimate for blocks of size 2^( 4) =       0.000408056343
  error estimate for blocks of size 2^( 5) =       0.000411865748
  error estimate for blocks of size 2^( 6) =       0.000413971479
  error estimate for blocks of size 2^( 7) =       0.000413320977

      target function =      -0.913985527953
              le_mean =     -17.214750657591
             les_mean =     296.646752822650
             stat err =       0.000411803637
             autocorr =       1.183346965494
   target nu stat err =       0.000411803637
   target dn stat err =       0.002460351054
      target stat err =       0.003905868944
              std dev =       0.535363951261
             le_variance =       0.286614560309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177547405
                                         uncertainty =       0.001693081506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177547405
                                         uncertainty =       0.001693081506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378559485
  error estimate for blocks of size 2^( 2) =       0.000389826249
  error estimate for blocks of size 2^( 3) =       0.000400308539
  error estimate for blocks of size 2^( 4) =       0.000408056337
  error estimate for blocks of size 2^( 5) =       0.000411865741
  error estimate for blocks of size 2^( 6) =       0.000413971469
  error estimate for blocks of size 2^( 7) =       0.000413320968

      target function =      -0.913985508301
              le_mean =     -17.214750658126
             les_mean =     296.646752853656
             stat err =       0.000411803629
             autocorr =       1.183346892273
   target nu stat err =       0.000411803629
   target dn stat err =       0.002460350776
      target stat err =       0.003905868353
              std dev =       0.535363957324
             le_variance =       0.286614566802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177553964
                                         uncertainty =       0.001693082312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286177553964
                                         uncertainty =       0.001693082312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378559488
  error estimate for blocks of size 2^( 2) =       0.000389826249
  error estimate for blocks of size 2^( 3) =       0.000400308536
  error estimate for blocks of size 2^( 4) =       0.000408056331
  error estimate for blocks of size 2^( 5) =       0.000411865734
  error estimate for blocks of size 2^( 6) =       0.000413971460
  error estimate for blocks of size 2^( 7) =       0.000413320961

      target function =      -0.913985491015
              le_mean =     -17.214750658595
             les_mean =     296.646752880849
             stat err =       0.000411803621
             autocorr =       1.183346828196
   target nu stat err =       0.000411803621
   target dn stat err =       0.002460350534
      target stat err =       0.003905867838
              std dev =       0.535363962631
             le_variance =       0.286614572484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913985488539        initial
     2.1176e+03     2.1176e+04             1.2220e-07        -0.913985527953  <--
     8.4703e+03     8.4703e+04             3.0552e-08        -0.913985508301
     3.3881e+04     3.3881e+05             7.6380e-09        -0.913985491015

*****************************************************************************
Applying the update for shift_i =   2.1176e+03     and shift_s =   2.1176e+04
*****************************************************************************

  Execution time = 2.3577e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875743e-02 3 1  ON 1
ci_003                -2.367622e-02 3 1  ON 2
ci_004                 2.096126e-02 3 1  ON 3
ci_005                 2.155711e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847790e-02 3 1  ON 6
ci_008                -7.758105e-03 3 1  ON 7
ci_009                -1.401795e-02 3 1  ON 8
ci_010                -8.874076e-03 3 1  ON 9
ci_011                -9.142854e-03 3 1  ON 10
ci_012                -9.120719e-03 3 1  ON 11
ci_013                -1.923577e-02 3 1  ON 12
ci_014                 1.117991e-02 3 1  ON 13
ci_015                 1.103417e-02 3 1  ON 14
ci_016                 1.597435e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080269e-03 3 1  ON 17
ci_019                 8.981646e-03 3 1  ON 18
ci_020                 1.506477e-02 3 1  ON 19
ci_021                 1.519137e-02 3 1  ON 20
ci_022                 8.258582e-03 3 1  ON 21
ci_023                 8.361635e-03 3 1  ON 22
ci_024                 8.583084e-03 3 1  ON 23
ci_025                 8.594906e-03 3 1  ON 24
ci_026                 1.002815e-02 3 1  ON 25
ci_027                 9.639855e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795523e-03 3 1  ON 29
ci_031                -8.563389e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554526e-03 3 1  ON 32
ci_034                 4.915602e-03 3 1  ON 33
ci_035                -3.348087e-03 3 1  ON 34
ci_036                -1.126187e-02 3 1  ON 35
ci_037                -1.150765e-02 3 1  ON 36
ci_038                 9.200816e-04 3 1  ON 37
ci_039                 1.223262e-03 3 1  ON 38
ci_040                -1.603069e-03 3 1  ON 39
ci_041                 8.180210e-03 3 1  ON 40
ci_042                 8.255626e-03 3 1  ON 41
ci_043                -2.385646e-03 3 1  ON 42
ci_044                -3.921448e-03 3 1  ON 43
ci_045                -1.870114e-03 3 1  ON 44
ci_046                 4.771172e-03 3 1  ON 45
ci_047                 4.645450e-03 3 1  ON 46
ci_048                -1.242652e-02 3 1  ON 47
ci_049                -1.288210e-02 3 1  ON 48
ci_050                 2.825053e-03 3 1  ON 49
ci_051                 2.816420e-03 3 1  ON 50
ci_052                -2.275263e-03 3 1  ON 51
ci_053                -2.208889e-03 3 1  ON 52
ci_054                -2.321197e-03 3 1  ON 53
ci_055                -2.375194e-03 3 1  ON 54
ci_056                 4.660805e-03 3 1  ON 55
ci_057                 4.675232e-03 3 1  ON 56
ci_058                -2.044635e-03 3 1  ON 57
ci_059                -2.118526e-03 3 1  ON 58
ci_060                 4.730518e-03 3 1  ON 59
ci_061                 5.181192e-03 3 1  ON 60
ci_062                -2.828236e-03 3 1  ON 61
ci_063                -2.781438e-03 3 1  ON 62
ci_064                -2.213401e-03 3 1  ON 63
ci_065                -3.398050e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160638e-03 3 1  ON 66
ci_068                -4.398766e-03 3 1  ON 67
ci_069                -4.115003e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0967e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.266094
====================================================
  Execution time = 1.4877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9990e-01
  Total weights = 1.957549459e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286437809717
                                         uncertainty =       0.001495827820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286437809717
                                         uncertainty =       0.001495827820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378468341
  error estimate for blocks of size 2^( 2) =       0.000389904052
  error estimate for blocks of size 2^( 3) =       0.000400092934
  error estimate for blocks of size 2^( 4) =       0.000408779906
  error estimate for blocks of size 2^( 5) =       0.000413367889
  error estimate for blocks of size 2^( 6) =       0.000413327486
  error estimate for blocks of size 2^( 7) =       0.000415981854

      target function =      -0.912734267138
              le_mean =     -17.215438595947
             les_mean =     296.671223035360
             stat err =       0.000412864284
             autocorr =       1.190023440680
   target nu stat err =       0.000412864284
   target dn stat err =       0.002442614315
      target stat err =       0.003873499873
              std dev =       0.535235060705
             le_variance =       0.286476570208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721543859595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912749774080       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912749851054       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912749860043       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912749863296       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912749863758       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912749863961       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912749864036       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912749864059       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912749864063       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912749864073       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+02 is 3.100123e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912749774080       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912749793326       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912749795573       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912749796386       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912749796504       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912749796552       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912749796570       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912749796577       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912749796577       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912749796581       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+03 is 7.751195e-08

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912749774080       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912749778891       residual = 9.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912749779453       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912749779663       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912749779672       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912749779681       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912749779706       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912749779714       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912749779696       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912749779709       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+03 is 1.937854e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7382e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875742e-02 3 1  ON 1
ci_003                -2.367619e-02 3 1  ON 2
ci_004                 2.096121e-02 3 1  ON 3
ci_005                 2.155709e-02 3 1  ON 4
ci_006                -1.849771e-02 3 1  ON 5
ci_007                -1.847787e-02 3 1  ON 6
ci_008                -7.758100e-03 3 1  ON 7
ci_009                -1.401796e-02 3 1  ON 8
ci_010                -8.874082e-03 3 1  ON 9
ci_011                -9.142832e-03 3 1  ON 10
ci_012                -9.120683e-03 3 1  ON 11
ci_013                -1.923576e-02 3 1  ON 12
ci_014                 1.117989e-02 3 1  ON 13
ci_015                 1.103416e-02 3 1  ON 14
ci_016                 1.597436e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080225e-03 3 1  ON 17
ci_019                 8.981663e-03 3 1  ON 18
ci_020                 1.506478e-02 3 1  ON 19
ci_021                 1.519139e-02 3 1  ON 20
ci_022                 8.258562e-03 3 1  ON 21
ci_023                 8.361615e-03 3 1  ON 22
ci_024                 8.583034e-03 3 1  ON 23
ci_025                 8.594866e-03 3 1  ON 24
ci_026                 1.002823e-02 3 1  ON 25
ci_027                 9.639883e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795527e-03 3 1  ON 29
ci_031                -8.563398e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554529e-03 3 1  ON 32
ci_034                 4.915615e-03 3 1  ON 33
ci_035                -3.348079e-03 3 1  ON 34
ci_036                -1.126186e-02 3 1  ON 35
ci_037                -1.150766e-02 3 1  ON 36
ci_038                 9.200708e-04 3 1  ON 37
ci_039                 1.223252e-03 3 1  ON 38
ci_040                -1.603067e-03 3 1  ON 39
ci_041                 8.180225e-03 3 1  ON 40
ci_042                 8.255610e-03 3 1  ON 41
ci_043                -2.385644e-03 3 1  ON 42
ci_044                -3.921418e-03 3 1  ON 43
ci_045                -1.870119e-03 3 1  ON 44
ci_046                 4.771165e-03 3 1  ON 45
ci_047                 4.645457e-03 3 1  ON 46
ci_048                -1.242650e-02 3 1  ON 47
ci_049                -1.288208e-02 3 1  ON 48
ci_050                 2.825065e-03 3 1  ON 49
ci_051                 2.816403e-03 3 1  ON 50
ci_052                -2.275290e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321182e-03 3 1  ON 53
ci_055                -2.375191e-03 3 1  ON 54
ci_056                 4.660776e-03 3 1  ON 55
ci_057                 4.675245e-03 3 1  ON 56
ci_058                -2.044638e-03 3 1  ON 57
ci_059                -2.118545e-03 3 1  ON 58
ci_060                 4.730492e-03 3 1  ON 59
ci_061                 5.181187e-03 3 1  ON 60
ci_062                -2.828227e-03 3 1  ON 61
ci_063                -2.781436e-03 3 1  ON 62
ci_064                -2.213415e-03 3 1  ON 63
ci_065                -3.398046e-03 3 1  ON 64
ci_066                 4.063203e-03 3 1  ON 65
ci_067                 4.160649e-03 3 1  ON 66
ci_068                -4.398757e-03 3 1  ON 67
ci_069                -4.115021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1997
    reference variance = 0.365063
====================================================
  Execution time = 1.4258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0141e-01
  Total weights = 1.9578e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574891715
                                         uncertainty =       0.002103433468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574891715
                                         uncertainty =       0.002103433468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932334
  error estimate for blocks of size 2^( 2) =       0.000391450639
  error estimate for blocks of size 2^( 3) =       0.000401729840
  error estimate for blocks of size 2^( 4) =       0.000409769291
  error estimate for blocks of size 2^( 5) =       0.000415174041
  error estimate for blocks of size 2^( 6) =       0.000414951230
  error estimate for blocks of size 2^( 7) =       0.000417225093

      target function =      -0.910436159378
              le_mean =     -17.214053544488
             les_mean =     296.625046804092
             stat err =       0.000414279914
             autocorr =       1.188981897040
   target nu stat err =       0.000414279914
   target dn stat err =       0.003138251191
      target stat err =       0.004907078639
              std dev =       0.537305460166
             le_variance =       0.288697157524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574918784
                                         uncertainty =       0.002103444330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574918784
                                         uncertainty =       0.002103444330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932352
  error estimate for blocks of size 2^( 2) =       0.000391450666
  error estimate for blocks of size 2^( 3) =       0.000401729877
  error estimate for blocks of size 2^( 4) =       0.000409769335
  error estimate for blocks of size 2^( 5) =       0.000415174099
  error estimate for blocks of size 2^( 6) =       0.000414951293
  error estimate for blocks of size 2^( 7) =       0.000417225175

      target function =      -0.910436365106
              le_mean =     -17.214053546330
             les_mean =     296.625046734195
             stat err =       0.000414279975
             autocorr =       1.188982138325
   target nu stat err =       0.000414279975
   target dn stat err =       0.003138278665
      target stat err =       0.004907122944
              std dev =       0.537305485404
             le_variance =       0.288697184645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574905249
                                         uncertainty =       0.002103438899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574905249
                                         uncertainty =       0.002103438899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932343
  error estimate for blocks of size 2^( 2) =       0.000391450652
  error estimate for blocks of size 2^( 3) =       0.000401729859
  error estimate for blocks of size 2^( 4) =       0.000409769313
  error estimate for blocks of size 2^( 5) =       0.000415174070
  error estimate for blocks of size 2^( 6) =       0.000414951261
  error estimate for blocks of size 2^( 7) =       0.000417225134

      target function =      -0.910436263771
              le_mean =     -17.214053545409
             les_mean =     296.625046768147
             stat err =       0.000414279945
             autocorr =       1.188982017698
   target nu stat err =       0.000414279945
   target dn stat err =       0.003138264926
      target stat err =       0.004907100804
              std dev =       0.537305472784
             le_variance =       0.288697171084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574893407
                                         uncertainty =       0.002103434147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288574893407
                                         uncertainty =       0.002103434147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379932336
  error estimate for blocks of size 2^( 2) =       0.000391450641
  error estimate for blocks of size 2^( 3) =       0.000401729843
  error estimate for blocks of size 2^( 4) =       0.000409769294
  error estimate for blocks of size 2^( 5) =       0.000415174044
  error estimate for blocks of size 2^( 6) =       0.000414951234
  error estimate for blocks of size 2^( 7) =       0.000417225098

      target function =      -0.910436172590
              le_mean =     -17.214053544603
             les_mean =     296.625046799492
             stat err =       0.000414279918
             autocorr =       1.188981912113
   target nu stat err =       0.000414279918
   target dn stat err =       0.003138252907
      target stat err =       0.004907081411
              std dev =       0.537305461743
             le_variance =       0.288697159219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910436159378        initial
     5.2940e+02     5.2940e+03             3.1001e-07        -0.910436365106  <--
     2.1176e+03     2.1176e+04             7.7512e-08        -0.910436263771
     8.4703e+03     8.4703e+04             1.9379e-08        -0.910436172590

*****************************************************************************
Applying the update for shift_i =   5.2940e+02     and shift_s =   5.2940e+03
*****************************************************************************

  Execution time = 2.3689e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758086e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874100e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080092e-03 3 1  ON 17
ci_019                 8.981713e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258504e-03 3 1  ON 21
ci_023                 8.361554e-03 3 1  ON 22
ci_024                 8.582882e-03 3 1  ON 23
ci_025                 8.594747e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639968e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795540e-03 3 1  ON 29
ci_031                -8.563427e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554538e-03 3 1  ON 32
ci_034                 4.915654e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200383e-04 3 1  ON 37
ci_039                 1.223220e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180270e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385639e-03 3 1  ON 42
ci_044                -3.921326e-03 3 1  ON 43
ci_045                -1.870133e-03 3 1  ON 44
ci_046                 4.771143e-03 3 1  ON 45
ci_047                 4.645477e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825101e-03 3 1  ON 49
ci_051                 2.816351e-03 3 1  ON 50
ci_052                -2.275373e-03 3 1  ON 51
ci_053                -2.208856e-03 3 1  ON 52
ci_054                -2.321137e-03 3 1  ON 53
ci_055                -2.375182e-03 3 1  ON 54
ci_056                 4.660687e-03 3 1  ON 55
ci_057                 4.675286e-03 3 1  ON 56
ci_058                -2.044645e-03 3 1  ON 57
ci_059                -2.118602e-03 3 1  ON 58
ci_060                 4.730415e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828199e-03 3 1  ON 61
ci_063                -2.781432e-03 3 1  ON 62
ci_064                -2.213457e-03 3 1  ON 63
ci_065                -3.398033e-03 3 1  ON 64
ci_066                 4.063201e-03 3 1  ON 65
ci_067                 4.160681e-03 3 1  ON 66
ci_068                -4.398728e-03 3 1  ON 67
ci_069                -4.115074e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1341
    reference variance = 0.27106
====================================================
  Execution time = 1.4813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0793e-01
  Total weights = 1.957699973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289634080829
                                         uncertainty =       0.001717885424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289634080829
                                         uncertainty =       0.001717885424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380539815
  error estimate for blocks of size 2^( 2) =       0.000392017108
  error estimate for blocks of size 2^( 3) =       0.000402550952
  error estimate for blocks of size 2^( 4) =       0.000410900828
  error estimate for blocks of size 2^( 5) =       0.000414786828
  error estimate for blocks of size 2^( 6) =       0.000416492139
  error estimate for blocks of size 2^( 7) =       0.000418960997

      target function =      -0.900380515050
              le_mean =     -17.214667858221
             les_mean =     296.652721646175
             stat err =       0.000415285198
             autocorr =       1.190947721382
   target nu stat err =       0.000415285198
   target dn stat err =       0.004779551261
      target stat err =       0.007275862880
              std dev =       0.538164567524
             le_variance =       0.289621101739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721466785822e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+02, overlap shift 1.3235e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900438255888       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900439012613       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900439106288       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900439143972       residual = 9.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900439147179       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900439147861       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900439147646       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900439147874       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900439147916       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900439147888       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+02 is 1.386106e-06

solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900438255888       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900438445153       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900438468580       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900438478003       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900438478805       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900438478976       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900438478922       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900438478978       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900438478989       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900438478982       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+02 is 3.466530e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900438255888       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900438303210       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900438309067       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900438311422       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900438311625       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900438311665       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900438311654       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900438311666       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900438311668       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900438311667       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+03 is 8.667116e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7364e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.762730e-02 3 1  ON 0
ci_002                -2.875716e-02 3 1  ON 1
ci_003                -2.367604e-02 3 1  ON 2
ci_004                 2.096109e-02 3 1  ON 3
ci_005                 2.155682e-02 3 1  ON 4
ci_006                -1.849772e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.757931e-03 3 1  ON 7
ci_009                -1.401803e-02 3 1  ON 8
ci_010                -8.873777e-03 3 1  ON 9
ci_011                -9.142937e-03 3 1  ON 10
ci_012                -9.120367e-03 3 1  ON 11
ci_013                -1.923579e-02 3 1  ON 12
ci_014                 1.117950e-02 3 1  ON 13
ci_015                 1.103387e-02 3 1  ON 14
ci_016                 1.597416e-02 3 1  ON 15
ci_017                 1.566981e-02 3 1  ON 16
ci_018                 9.079962e-03 3 1  ON 17
ci_019                 8.981760e-03 3 1  ON 18
ci_020                 1.506471e-02 3 1  ON 19
ci_021                 1.519147e-02 3 1  ON 20
ci_022                 8.258406e-03 3 1  ON 21
ci_023                 8.361371e-03 3 1  ON 22
ci_024                 8.582859e-03 3 1  ON 23
ci_025                 8.594841e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.640056e-03 3 1  ON 26
ci_028                -1.462483e-02 3 1  ON 27
ci_029                -1.500969e-02 3 1  ON 28
ci_030                -8.795350e-03 3 1  ON 29
ci_031                -8.563192e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554635e-03 3 1  ON 32
ci_034                 4.915611e-03 3 1  ON 33
ci_035                -3.348069e-03 3 1  ON 34
ci_036                -1.126189e-02 3 1  ON 35
ci_037                -1.150758e-02 3 1  ON 36
ci_038                 9.200506e-04 3 1  ON 37
ci_039                 1.223125e-03 3 1  ON 38
ci_040                -1.602928e-03 3 1  ON 39
ci_041                 8.180073e-03 3 1  ON 40
ci_042                 8.255695e-03 3 1  ON 41
ci_043                -2.385589e-03 3 1  ON 42
ci_044                -3.921548e-03 3 1  ON 43
ci_045                -1.870105e-03 3 1  ON 44
ci_046                 4.771105e-03 3 1  ON 45
ci_047                 4.645410e-03 3 1  ON 46
ci_048                -1.242653e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825091e-03 3 1  ON 49
ci_051                 2.816213e-03 3 1  ON 50
ci_052                -2.275282e-03 3 1  ON 51
ci_053                -2.208669e-03 3 1  ON 52
ci_054                -2.321147e-03 3 1  ON 53
ci_055                -2.375190e-03 3 1  ON 54
ci_056                 4.660795e-03 3 1  ON 55
ci_057                 4.675215e-03 3 1  ON 56
ci_058                -2.044454e-03 3 1  ON 57
ci_059                -2.118521e-03 3 1  ON 58
ci_060                 4.730256e-03 3 1  ON 59
ci_061                 5.181083e-03 3 1  ON 60
ci_062                -2.828262e-03 3 1  ON 61
ci_063                -2.781405e-03 3 1  ON 62
ci_064                -2.213549e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063163e-03 3 1  ON 65
ci_067                 4.160683e-03 3 1  ON 66
ci_068                -4.398635e-03 3 1  ON 67
ci_069                -4.115358e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.3388
    reference variance = 0.437375
====================================================
  Execution time = 1.4290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9805e-01
  Total weights = 1.9575e+06
  Execution time = 1.8691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252641951
                                         uncertainty =       0.001738865603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252641951
                                         uncertainty =       0.001738865603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377681347
  error estimate for blocks of size 2^( 2) =       0.000388933905
  error estimate for blocks of size 2^( 3) =       0.000399227358
  error estimate for blocks of size 2^( 4) =       0.000407060319
  error estimate for blocks of size 2^( 5) =       0.000412272103
  error estimate for blocks of size 2^( 6) =       0.000414548175
  error estimate for blocks of size 2^( 7) =       0.000413711869

      target function =      -0.915630990279
              le_mean =     -17.215086444912
             les_mean =     296.657250252450
             stat err =       0.000411898117
             autocorr =       1.189401657357
   target nu stat err =       0.000411898117
   target dn stat err =       0.002924554404
      target stat err =       0.004640167437
              std dev =       0.534122083333
             le_variance =       0.285286399904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252454514
                                         uncertainty =       0.001738872265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252454514
                                         uncertainty =       0.001738872265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377681225
  error estimate for blocks of size 2^( 2) =       0.000388933929
  error estimate for blocks of size 2^( 3) =       0.000399227542
  error estimate for blocks of size 2^( 4) =       0.000407060608
  error estimate for blocks of size 2^( 5) =       0.000412272488
  error estimate for blocks of size 2^( 6) =       0.000414548579
  error estimate for blocks of size 2^( 7) =       0.000413712302

      target function =      -0.915614916784
              le_mean =     -17.215086437096
             les_mean =     296.657260204234
             stat err =       0.000411898494
             autocorr =       1.189404607206
   target nu stat err =       0.000411898494
   target dn stat err =       0.002927549574
      target stat err =       0.004644648930
              std dev =       0.534121910599
             le_variance =       0.285286215382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252548095
                                         uncertainty =       0.001738868932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252548095
                                         uncertainty =       0.001738868932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377681286
  error estimate for blocks of size 2^( 2) =       0.000388933917
  error estimate for blocks of size 2^( 3) =       0.000399227450
  error estimate for blocks of size 2^( 4) =       0.000407060464
  error estimate for blocks of size 2^( 5) =       0.000412272295
  error estimate for blocks of size 2^( 6) =       0.000414548377
  error estimate for blocks of size 2^( 7) =       0.000413712086

      target function =      -0.915623004128
              le_mean =     -17.215086440996
             les_mean =     296.657255195847
             stat err =       0.000411898305
             autocorr =       1.189403132933
   target nu stat err =       0.000411898305
   target dn stat err =       0.002926041908
      target stat err =       0.004642393091
              std dev =       0.534121996837
             le_variance =       0.285286307505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252630207
                                         uncertainty =       0.001738866019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285252630207
                                         uncertainty =       0.001738866019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377681339
  error estimate for blocks of size 2^( 2) =       0.000388933906
  error estimate for blocks of size 2^( 3) =       0.000399227370
  error estimate for blocks of size 2^( 4) =       0.000407060337
  error estimate for blocks of size 2^( 5) =       0.000412272127
  error estimate for blocks of size 2^( 6) =       0.000414548200
  error estimate for blocks of size 2^( 7) =       0.000413711896

      target function =      -0.915629997795
              le_mean =     -17.215086444421
             les_mean =     296.657250866666
             stat err =       0.000411898140
             autocorr =       1.189401841826
   target nu stat err =       0.000411898140
   target dn stat err =       0.002924739199
      target stat err =       0.004640443933
              std dev =       0.534122072509
             le_variance =       0.285286388341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915630990279        initial  <--
     1.3235e+02     1.3235e+03             1.3861e-06        -0.915614916784
     5.2940e+02     5.2940e+03             3.4665e-07        -0.915623004128
     2.1176e+03     2.1176e+04             8.6671e-08        -0.915629997795

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.3729
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758086e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874100e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080092e-03 3 1  ON 17
ci_019                 8.981713e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258504e-03 3 1  ON 21
ci_023                 8.361554e-03 3 1  ON 22
ci_024                 8.582882e-03 3 1  ON 23
ci_025                 8.594747e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639968e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795540e-03 3 1  ON 29
ci_031                -8.563427e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554538e-03 3 1  ON 32
ci_034                 4.915654e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200383e-04 3 1  ON 37
ci_039                 1.223220e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180270e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385639e-03 3 1  ON 42
ci_044                -3.921326e-03 3 1  ON 43
ci_045                -1.870133e-03 3 1  ON 44
ci_046                 4.771143e-03 3 1  ON 45
ci_047                 4.645477e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825101e-03 3 1  ON 49
ci_051                 2.816351e-03 3 1  ON 50
ci_052                -2.275373e-03 3 1  ON 51
ci_053                -2.208856e-03 3 1  ON 52
ci_054                -2.321137e-03 3 1  ON 53
ci_055                -2.375182e-03 3 1  ON 54
ci_056                 4.660687e-03 3 1  ON 55
ci_057                 4.675286e-03 3 1  ON 56
ci_058                -2.044645e-03 3 1  ON 57
ci_059                -2.118602e-03 3 1  ON 58
ci_060                 4.730415e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828199e-03 3 1  ON 61
ci_063                -2.781432e-03 3 1  ON 62
ci_064                -2.213457e-03 3 1  ON 63
ci_065                -3.398033e-03 3 1  ON 64
ci_066                 4.063201e-03 3 1  ON 65
ci_067                 4.160681e-03 3 1  ON 66
ci_068                -4.398728e-03 3 1  ON 67
ci_069                -4.115074e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2449
    reference variance = 0.164561
====================================================
  Execution time = 1.4706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9929e-01
  Total weights = 1.957826695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285796400450
                                         uncertainty =       0.002177287934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285796400450
                                         uncertainty =       0.002177287934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378060680
  error estimate for blocks of size 2^( 2) =       0.000389441564
  error estimate for blocks of size 2^( 3) =       0.000399954112
  error estimate for blocks of size 2^( 4) =       0.000407757583
  error estimate for blocks of size 2^( 5) =       0.000411979285
  error estimate for blocks of size 2^( 6) =       0.000413264984
  error estimate for blocks of size 2^( 7) =       0.000413423540

      target function =      -0.913706790637
              le_mean =     -17.214506099613
             les_mean =     296.638511436361
             stat err =       0.000411606348
             autocorr =       1.185334995110
   target nu stat err =       0.000411606348
   target dn stat err =       0.003090801956
      target stat err =       0.004872304806
              std dev =       0.534658540732
             le_variance =       0.285859755178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450609961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913731701282       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913731748392       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913731754814       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913731756518       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913731756839       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913731756906       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913731756914       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913731756909       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913731756921       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913731756924       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913731756924       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+03 is 1.286249e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913731701282       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913731713060       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913731714666       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913731715088       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913731715174       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913731715186       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913731715189       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913731715191       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913731715192       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913731715199       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913731715201       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+03 is 3.215753e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913731701282       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913731704227       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913731704628       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913731704735       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913731704765       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913731704765       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913731704755       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913731704755       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913731704784       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913731704743       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913731704787       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+04 is 8.039465e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7258e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155701e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758078e-03 3 1  ON 7
ci_009                -1.401796e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142777e-03 3 1  ON 10
ci_012                -9.120587e-03 3 1  ON 11
ci_013                -1.923574e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566982e-02 3 1  ON 16
ci_018                 9.080100e-03 3 1  ON 17
ci_019                 8.981717e-03 3 1  ON 18
ci_020                 1.506479e-02 3 1  ON 19
ci_021                 1.519142e-02 3 1  ON 20
ci_022                 8.258500e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582862e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002847e-02 3 1  ON 25
ci_027                 9.639968e-03 3 1  ON 26
ci_028                -1.462450e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795518e-03 3 1  ON 29
ci_031                -8.563416e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554547e-03 3 1  ON 32
ci_034                 4.915667e-03 3 1  ON 33
ci_035                -3.348054e-03 3 1  ON 34
ci_036                -1.126184e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200385e-04 3 1  ON 37
ci_039                 1.223214e-03 3 1  ON 38
ci_040                -1.603060e-03 3 1  ON 39
ci_041                 8.180274e-03 3 1  ON 40
ci_042                 8.255555e-03 3 1  ON 41
ci_043                -2.385633e-03 3 1  ON 42
ci_044                -3.921331e-03 3 1  ON 43
ci_045                -1.870139e-03 3 1  ON 44
ci_046                 4.771133e-03 3 1  ON 45
ci_047                 4.645476e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825098e-03 3 1  ON 49
ci_051                 2.816356e-03 3 1  ON 50
ci_052                -2.275359e-03 3 1  ON 51
ci_053                -2.208873e-03 3 1  ON 52
ci_054                -2.321135e-03 3 1  ON 53
ci_055                -2.375188e-03 3 1  ON 54
ci_056                 4.660673e-03 3 1  ON 55
ci_057                 4.675293e-03 3 1  ON 56
ci_058                -2.044646e-03 3 1  ON 57
ci_059                -2.118587e-03 3 1  ON 58
ci_060                 4.730402e-03 3 1  ON 59
ci_061                 5.181141e-03 3 1  ON 60
ci_062                -2.828210e-03 3 1  ON 61
ci_063                -2.781429e-03 3 1  ON 62
ci_064                -2.213456e-03 3 1  ON 63
ci_065                -3.398031e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160684e-03 3 1  ON 66
ci_068                -4.398716e-03 3 1  ON 67
ci_069                -4.115091e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1208
    reference variance = 0.243125
====================================================
  Execution time = 1.4387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0037e-01
  Total weights = 1.9579e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972659853
                                         uncertainty =       0.001559517346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972659853
                                         uncertainty =       0.001559517346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379421185
  error estimate for blocks of size 2^( 2) =       0.000390644763
  error estimate for blocks of size 2^( 3) =       0.000401060514
  error estimate for blocks of size 2^( 4) =       0.000408569460
  error estimate for blocks of size 2^( 5) =       0.000413022184
  error estimate for blocks of size 2^( 6) =       0.000415586059
  error estimate for blocks of size 2^( 7) =       0.000414899772

      target function =      -0.912022922894
              le_mean =     -17.214773716731
             les_mean =     296.648807860257
             stat err =       0.000413019369
             autocorr =       1.184943617124
   target nu stat err =       0.000413019369
   target dn stat err =       0.002175582038
      target stat err =       0.003455364765
              std dev =       0.536582585014
             le_variance =       0.287920870540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972648829
                                         uncertainty =       0.001559516725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972648829
                                         uncertainty =       0.001559516725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379421178
  error estimate for blocks of size 2^( 2) =       0.000390644761
  error estimate for blocks of size 2^( 3) =       0.000401060515
  error estimate for blocks of size 2^( 4) =       0.000408569467
  error estimate for blocks of size 2^( 5) =       0.000413022192
  error estimate for blocks of size 2^( 6) =       0.000415586067
  error estimate for blocks of size 2^( 7) =       0.000414899782

      target function =      -0.912022727707
              le_mean =     -17.214773715194
             les_mean =     296.648807932947
             stat err =       0.000413019377
             autocorr =       1.184943709256
   target nu stat err =       0.000413019377
   target dn stat err =       0.002175580010
      target stat err =       0.003455360223
              std dev =       0.536582575215
             le_variance =       0.287920860024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972654340
                                         uncertainty =       0.001559517036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972654340
                                         uncertainty =       0.001559517036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379421181
  error estimate for blocks of size 2^( 2) =       0.000390644762
  error estimate for blocks of size 2^( 3) =       0.000401060514
  error estimate for blocks of size 2^( 4) =       0.000408569463
  error estimate for blocks of size 2^( 5) =       0.000413022188
  error estimate for blocks of size 2^( 6) =       0.000415586063
  error estimate for blocks of size 2^( 7) =       0.000414899777

      target function =      -0.912022825912
              le_mean =     -17.214773715962
             les_mean =     296.648807896205
             stat err =       0.000413019373
             autocorr =       1.184943663188
   target nu stat err =       0.000413019373
   target dn stat err =       0.002175581021
      target stat err =       0.003455362495
              std dev =       0.536582580113
             le_variance =       0.287920865281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972659164
                                         uncertainty =       0.001559517307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287972659164
                                         uncertainty =       0.001559517307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379421184
  error estimate for blocks of size 2^( 2) =       0.000390644763
  error estimate for blocks of size 2^( 3) =       0.000401060514
  error estimate for blocks of size 2^( 4) =       0.000408569461
  error estimate for blocks of size 2^( 5) =       0.000413022184
  error estimate for blocks of size 2^( 6) =       0.000415586060
  error estimate for blocks of size 2^( 7) =       0.000414899772

      target function =      -0.912022910838
              le_mean =     -17.214773716635
             les_mean =     296.648807864708
             stat err =       0.000413019369
             autocorr =       1.184943622875
   target nu stat err =       0.000413019369
   target dn stat err =       0.002175581910
      target stat err =       0.003455364481
              std dev =       0.536582584401
             le_variance =       0.287920869882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912022922894        initial  <--
     1.3235e+03     1.3235e+04             1.2862e-07        -0.912022727707
     5.2940e+03     5.2940e+04             3.2158e-08        -0.912022825912
     2.1176e+04     2.1176e+05             8.0395e-09        -0.912022910838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8368
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758086e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874100e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080092e-03 3 1  ON 17
ci_019                 8.981713e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258504e-03 3 1  ON 21
ci_023                 8.361554e-03 3 1  ON 22
ci_024                 8.582882e-03 3 1  ON 23
ci_025                 8.594747e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639968e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795540e-03 3 1  ON 29
ci_031                -8.563427e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554538e-03 3 1  ON 32
ci_034                 4.915654e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200383e-04 3 1  ON 37
ci_039                 1.223220e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180270e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385639e-03 3 1  ON 42
ci_044                -3.921326e-03 3 1  ON 43
ci_045                -1.870133e-03 3 1  ON 44
ci_046                 4.771143e-03 3 1  ON 45
ci_047                 4.645477e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825101e-03 3 1  ON 49
ci_051                 2.816351e-03 3 1  ON 50
ci_052                -2.275373e-03 3 1  ON 51
ci_053                -2.208856e-03 3 1  ON 52
ci_054                -2.321137e-03 3 1  ON 53
ci_055                -2.375182e-03 3 1  ON 54
ci_056                 4.660687e-03 3 1  ON 55
ci_057                 4.675286e-03 3 1  ON 56
ci_058                -2.044645e-03 3 1  ON 57
ci_059                -2.118602e-03 3 1  ON 58
ci_060                 4.730415e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828199e-03 3 1  ON 61
ci_063                -2.781432e-03 3 1  ON 62
ci_064                -2.213457e-03 3 1  ON 63
ci_065                -3.398033e-03 3 1  ON 64
ci_066                 4.063201e-03 3 1  ON 65
ci_067                 4.160681e-03 3 1  ON 66
ci_068                -4.398728e-03 3 1  ON 67
ci_069                -4.115074e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2232
    reference variance = 0.211231
====================================================
  Execution time = 1.4588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9364e-01
  Total weights = 1.957542007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282811261650
                                         uncertainty =       0.001322582782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282811261650
                                         uncertainty =       0.001322582782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376042331
  error estimate for blocks of size 2^( 2) =       0.000387551626
  error estimate for blocks of size 2^( 3) =       0.000398235351
  error estimate for blocks of size 2^( 4) =       0.000406557796
  error estimate for blocks of size 2^( 5) =       0.000412218702
  error estimate for blocks of size 2^( 6) =       0.000414694199
  error estimate for blocks of size 2^( 7) =       0.000415621790

      target function =      -0.922629542073
              le_mean =     -17.214160619450
             les_mean =     296.620967199894
             stat err =       0.000412273122
             autocorr =       1.201978146189
   target nu stat err =       0.000412273122
   target dn stat err =       0.001819485456
      target stat err =       0.002977951596
              std dev =       0.531804164598
             le_variance =       0.282815669484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721416061945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922638160689       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922638162643       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922638162871       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922638162946       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922638162944       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922638162947       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922638162951       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922638162939       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922638162956       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922638162946       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+04 is 8.562376e-09

solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922638160689       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922638161178       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922638161235       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922638161253       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922638161255       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922638161256       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922638161257       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922638161289       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922638161291       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922638161332       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+04 is 2.140602e-09

solving harmonic davidson linear method for identity shift 2.1176e+05, overlap shift 2.1176e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922638160689       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922638160811       residual = 8.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.922638160826       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.922638160830       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.922638161053       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.922638160854       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.922638160732       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.922638160913       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.922638161023       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.922638160948       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+05 is 5.351509e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7139e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.762723e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758086e-03 3 1  ON 7
ci_009                -1.401799e-02 3 1  ON 8
ci_010                -8.874100e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080091e-03 3 1  ON 17
ci_019                 8.981713e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258504e-03 3 1  ON 21
ci_023                 8.361555e-03 3 1  ON 22
ci_024                 8.582880e-03 3 1  ON 23
ci_025                 8.594747e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639969e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795540e-03 3 1  ON 29
ci_031                -8.563426e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915654e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200374e-04 3 1  ON 37
ci_039                 1.223220e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180271e-03 3 1  ON 40
ci_042                 8.255560e-03 3 1  ON 41
ci_043                -2.385639e-03 3 1  ON 42
ci_044                -3.921325e-03 3 1  ON 43
ci_045                -1.870133e-03 3 1  ON 44
ci_046                 4.771144e-03 3 1  ON 45
ci_047                 4.645475e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825101e-03 3 1  ON 49
ci_051                 2.816352e-03 3 1  ON 50
ci_052                -2.275373e-03 3 1  ON 51
ci_053                -2.208857e-03 3 1  ON 52
ci_054                -2.321137e-03 3 1  ON 53
ci_055                -2.375182e-03 3 1  ON 54
ci_056                 4.660687e-03 3 1  ON 55
ci_057                 4.675286e-03 3 1  ON 56
ci_058                -2.044645e-03 3 1  ON 57
ci_059                -2.118601e-03 3 1  ON 58
ci_060                 4.730415e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828199e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213457e-03 3 1  ON 63
ci_065                -3.398032e-03 3 1  ON 64
ci_066                 4.063200e-03 3 1  ON 65
ci_067                 4.160681e-03 3 1  ON 66
ci_068                -4.398729e-03 3 1  ON 67
ci_069                -4.115074e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1144
    reference variance = 0.588768
====================================================
  Execution time = 1.4670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9857e-01
  Total weights = 1.9576e+06
  Execution time = 1.8653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318978
                                         uncertainty =       0.001977116715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318978
                                         uncertainty =       0.001977116715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854621
  error estimate for blocks of size 2^( 2) =       0.000390226434
  error estimate for blocks of size 2^( 3) =       0.000400501936
  error estimate for blocks of size 2^( 4) =       0.000407550525
  error estimate for blocks of size 2^( 5) =       0.000412388179
  error estimate for blocks of size 2^( 6) =       0.000413898374
  error estimate for blocks of size 2^( 7) =       0.000415722820

      target function =      -0.914820162146
              le_mean =     -17.214843284011
             les_mean =     296.649403907411
             stat err =       0.000412389975
             autocorr =       1.184870866555
   target nu stat err =       0.000412389975
   target dn stat err =       0.002656075583
      target stat err =       0.004215354850
              std dev =       0.535781342580
             le_variance =       0.287061647057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096317429
                                         uncertainty =       0.001977116504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096317429
                                         uncertainty =       0.001977116504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854620
  error estimate for blocks of size 2^( 2) =       0.000390226433
  error estimate for blocks of size 2^( 3) =       0.000400501936
  error estimate for blocks of size 2^( 4) =       0.000407550525
  error estimate for blocks of size 2^( 5) =       0.000412388180
  error estimate for blocks of size 2^( 6) =       0.000413898374
  error estimate for blocks of size 2^( 7) =       0.000415722821

      target function =      -0.914820172110
              le_mean =     -17.214843284003
             les_mean =     296.649403900783
             stat err =       0.000412389975
             autocorr =       1.184870874241
   target nu stat err =       0.000412389975
   target dn stat err =       0.002656074575
      target stat err =       0.004215353386
              std dev =       0.535781341144
             le_variance =       0.287061645518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318204
                                         uncertainty =       0.001977116610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318204
                                         uncertainty =       0.001977116610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854620
  error estimate for blocks of size 2^( 2) =       0.000390226433
  error estimate for blocks of size 2^( 3) =       0.000400501936
  error estimate for blocks of size 2^( 4) =       0.000407550525
  error estimate for blocks of size 2^( 5) =       0.000412388180
  error estimate for blocks of size 2^( 6) =       0.000413898374
  error estimate for blocks of size 2^( 7) =       0.000415722820

      target function =      -0.914820167128
              le_mean =     -17.214843284007
             les_mean =     296.649403904097
             stat err =       0.000412389975
             autocorr =       1.184870870396
   target nu stat err =       0.000412389975
   target dn stat err =       0.002656075079
      target stat err =       0.004215354118
              std dev =       0.535781341862
             le_variance =       0.287061646287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318881
                                         uncertainty =       0.001977116702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287096318881
                                         uncertainty =       0.001977116702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854621
  error estimate for blocks of size 2^( 2) =       0.000390226434
  error estimate for blocks of size 2^( 3) =       0.000400501936
  error estimate for blocks of size 2^( 4) =       0.000407550525
  error estimate for blocks of size 2^( 5) =       0.000412388179
  error estimate for blocks of size 2^( 6) =       0.000413898374
  error estimate for blocks of size 2^( 7) =       0.000415722820

      target function =      -0.914820162768
              le_mean =     -17.214843284011
             les_mean =     296.649403906996
             stat err =       0.000412389975
             autocorr =       1.184870867044
   target nu stat err =       0.000412389975
   target dn stat err =       0.002656075520
      target stat err =       0.004215354759
              std dev =       0.535781342490
             le_variance =       0.287061646960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914820162146        initial
     1.3235e+04     1.3235e+05             8.5624e-09        -0.914820172110  <--
     5.2940e+04     5.2940e+05             2.1406e-09        -0.914820167128
     2.1176e+05     2.1176e+06             5.3515e-10        -0.914820162768

*****************************************************************************
Applying the update for shift_i =   1.3235e+04     and shift_s =   1.3235e+05
*****************************************************************************

  Execution time = 2.4092e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367610e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758085e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874098e-03 3 1  ON 9
ci_011                -9.142763e-03 3 1  ON 10
ci_012                -9.120575e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080088e-03 3 1  ON 17
ci_019                 8.981712e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258505e-03 3 1  ON 21
ci_023                 8.361556e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594746e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795537e-03 3 1  ON 29
ci_031                -8.563425e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915653e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200345e-04 3 1  ON 37
ci_039                 1.223220e-03 3 1  ON 38
ci_040                -1.603060e-03 3 1  ON 39
ci_041                 8.180273e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385637e-03 3 1  ON 42
ci_044                -3.921323e-03 3 1  ON 43
ci_045                -1.870135e-03 3 1  ON 44
ci_046                 4.771147e-03 3 1  ON 45
ci_047                 4.645472e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825101e-03 3 1  ON 49
ci_051                 2.816355e-03 3 1  ON 50
ci_052                -2.275375e-03 3 1  ON 51
ci_053                -2.208862e-03 3 1  ON 52
ci_054                -2.321137e-03 3 1  ON 53
ci_055                -2.375182e-03 3 1  ON 54
ci_056                 4.660687e-03 3 1  ON 55
ci_057                 4.675287e-03 3 1  ON 56
ci_058                -2.044645e-03 3 1  ON 57
ci_059                -2.118598e-03 3 1  ON 58
ci_060                 4.730417e-03 3 1  ON 59
ci_061                 5.181173e-03 3 1  ON 60
ci_062                -2.828199e-03 3 1  ON 61
ci_063                -2.781430e-03 3 1  ON 62
ci_064                -2.213459e-03 3 1  ON 63
ci_065                -3.398031e-03 3 1  ON 64
ci_066                 4.063199e-03 3 1  ON 65
ci_067                 4.160680e-03 3 1  ON 66
ci_068                -4.398733e-03 3 1  ON 67
ci_069                -4.115075e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.138562
====================================================
  Execution time = 1.4593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9969e-01
  Total weights = 1.957777656e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470246050
                                         uncertainty =       0.002037892747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286470246050
                                         uncertainty =       0.002037892747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378461688
  error estimate for blocks of size 2^( 2) =       0.000389928635
  error estimate for blocks of size 2^( 3) =       0.000400461326
  error estimate for blocks of size 2^( 4) =       0.000409159253
  error estimate for blocks of size 2^( 5) =       0.000413694407
  error estimate for blocks of size 2^( 6) =       0.000416340772
  error estimate for blocks of size 2^( 7) =       0.000419188861

      target function =      -0.913101489166
              le_mean =     -17.214267063787
             les_mean =     296.630681324714
             stat err =       0.000414595823
             autocorr =       1.200068399625
   target nu stat err =       0.000414595823
   target dn stat err =       0.002554786716
      target stat err =       0.004040477925
              std dev =       0.535225652525
             le_variance =       0.286466499121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426706379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913117889665       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913117898004       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913117898742       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913117899030       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913117899065       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913117899066       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913117899066       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913117899070       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913117899067       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+03 is 2.765687e-08

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913117889665       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913117891749       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913117891934       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913117892006       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913117892010       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913117892018       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913117892010       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913117891998       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913117892014       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+04 is 6.914334e-09

solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913117889665       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913117890186       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913117890232       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913117890250       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913117890270       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913117890235       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913117890252       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913117890170       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913117890263       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.2940e+04 is 1.728591e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7158e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096107e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849768e-02 3 1  ON 5
ci_007                -1.847780e-02 3 1  ON 6
ci_008                -7.758081e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874102e-03 3 1  ON 9
ci_011                -9.142766e-03 3 1  ON 10
ci_012                -9.120575e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597439e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080087e-03 3 1  ON 17
ci_019                 8.981716e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519144e-02 3 1  ON 20
ci_022                 8.258509e-03 3 1  ON 21
ci_023                 8.361552e-03 3 1  ON 22
ci_024                 8.582872e-03 3 1  ON 23
ci_025                 8.594748e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795535e-03 3 1  ON 29
ci_031                -8.563432e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915656e-03 3 1  ON 33
ci_035                -3.348053e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150769e-02 3 1  ON 36
ci_038                 9.200341e-04 3 1  ON 37
ci_039                 1.223219e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180274e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385634e-03 3 1  ON 42
ci_044                -3.921320e-03 3 1  ON 43
ci_045                -1.870135e-03 3 1  ON 44
ci_046                 4.771142e-03 3 1  ON 45
ci_047                 4.645474e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825100e-03 3 1  ON 49
ci_051                 2.816356e-03 3 1  ON 50
ci_052                -2.275381e-03 3 1  ON 51
ci_053                -2.208867e-03 3 1  ON 52
ci_054                -2.321130e-03 3 1  ON 53
ci_055                -2.375180e-03 3 1  ON 54
ci_056                 4.660688e-03 3 1  ON 55
ci_057                 4.675284e-03 3 1  ON 56
ci_058                -2.044643e-03 3 1  ON 57
ci_059                -2.118597e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181174e-03 3 1  ON 60
ci_062                -2.828198e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213461e-03 3 1  ON 63
ci_065                -3.398029e-03 3 1  ON 64
ci_066                 4.063200e-03 3 1  ON 65
ci_067                 4.160683e-03 3 1  ON 66
ci_068                -4.398727e-03 3 1  ON 67
ci_069                -4.115080e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2628
    reference variance = 0.990904
====================================================
  Execution time = 1.4243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9633e-01
  Total weights = 1.9577e+06
  Execution time = 1.8732e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281465011
                                         uncertainty =       0.001448198518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281465011
                                         uncertainty =       0.001448198518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376996761
  error estimate for blocks of size 2^( 2) =       0.000388462073
  error estimate for blocks of size 2^( 3) =       0.000398738002
  error estimate for blocks of size 2^( 4) =       0.000406584008
  error estimate for blocks of size 2^( 5) =       0.000411145030
  error estimate for blocks of size 2^( 6) =       0.000414765754
  error estimate for blocks of size 2^( 7) =       0.000416928370

      target function =      -0.918340013744
              le_mean =     -17.215040364831
             les_mean =     296.653947140142
             stat err =       0.000412355790
             autocorr =       1.196379486944
   target nu stat err =       0.000412355790
   target dn stat err =       0.002358414581
      target stat err =       0.003786807278
              std dev =       0.533153931769
             le_variance =       0.284253114960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281461217
                                         uncertainty =       0.001448198238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281461217
                                         uncertainty =       0.001448198238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376996758
  error estimate for blocks of size 2^( 2) =       0.000388462070
  error estimate for blocks of size 2^( 3) =       0.000398737998
  error estimate for blocks of size 2^( 4) =       0.000406584004
  error estimate for blocks of size 2^( 5) =       0.000411145025
  error estimate for blocks of size 2^( 6) =       0.000414765748
  error estimate for blocks of size 2^( 7) =       0.000416928364

      target function =      -0.918340215968
              le_mean =     -17.215040364873
             les_mean =     296.653947013521
             stat err =       0.000412355785
             autocorr =       1.196379473228
   target nu stat err =       0.000412355785
   target dn stat err =       0.002358395618
      target stat err =       0.003786779531
              std dev =       0.533153928226
             le_variance =       0.284253111182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281463114
                                         uncertainty =       0.001448198378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281463114
                                         uncertainty =       0.001448198378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376996759
  error estimate for blocks of size 2^( 2) =       0.000388462071
  error estimate for blocks of size 2^( 3) =       0.000398738000
  error estimate for blocks of size 2^( 4) =       0.000406584006
  error estimate for blocks of size 2^( 5) =       0.000411145027
  error estimate for blocks of size 2^( 6) =       0.000414765751
  error estimate for blocks of size 2^( 7) =       0.000416928367

      target function =      -0.918340115623
              le_mean =     -17.215040364852
             les_mean =     296.653947076345
             stat err =       0.000412355788
             autocorr =       1.196379480092
   target nu stat err =       0.000412355788
   target dn stat err =       0.002358405098
      target stat err =       0.003786793410
              std dev =       0.533153929997
             le_variance =       0.284253113071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281464774
                                         uncertainty =       0.001448198500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281464774
                                         uncertainty =       0.001448198500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376996760
  error estimate for blocks of size 2^( 2) =       0.000388462073
  error estimate for blocks of size 2^( 3) =       0.000398738002
  error estimate for blocks of size 2^( 4) =       0.000406584008
  error estimate for blocks of size 2^( 5) =       0.000411145029
  error estimate for blocks of size 2^( 6) =       0.000414765753
  error estimate for blocks of size 2^( 7) =       0.000416928369

      target function =      -0.918340026564
              le_mean =     -17.215040364833
             les_mean =     296.653947132113
             stat err =       0.000412355790
             autocorr =       1.196379486082
   target nu stat err =       0.000412355790
   target dn stat err =       0.002358413395
      target stat err =       0.003786805545
              std dev =       0.533153931547
             le_variance =       0.284253114724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.918340013744        initial
     3.3087e+03     3.3087e+04             2.7657e-08        -0.918340215968  <--
     1.3235e+04     1.3235e+05             6.9143e-09        -0.918340115623
     5.2940e+04     5.2940e+05             1.7286e-09        -0.918340026564

*****************************************************************************
Applying the update for shift_i =   3.3087e+03     and shift_s =   3.3087e+04
*****************************************************************************

  Execution time = 2.3710e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582869e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200327e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180278e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385625e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730413e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.221873
====================================================
  Execution time = 1.4648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0500e-01
  Total weights = 1.957849027e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5317e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291190869102
                                         uncertainty =       0.003333940769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291190869102
                                         uncertainty =       0.003333940769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381586386
  error estimate for blocks of size 2^( 2) =       0.000392813160
  error estimate for blocks of size 2^( 3) =       0.000403263416
  error estimate for blocks of size 2^( 4) =       0.000410521164
  error estimate for blocks of size 2^( 5) =       0.000414732974
  error estimate for blocks of size 2^( 6) =       0.000416945260
  error estimate for blocks of size 2^( 7) =       0.000418331785

      target function =      -0.904870921235
              le_mean =     -17.214522455857
             les_mean =     296.644782523810
             stat err =       0.000415132796
             autocorr =       1.183554725322
   target nu stat err =       0.000415132796
   target dn stat err =       0.004032630979
      target stat err =       0.006209558472
              std dev =       0.539644642880
             le_variance =       0.291216340590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721452245586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+02, overlap shift 8.2718e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904912631859       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904912683344       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904912689873       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904912692592       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904912692747       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904912692734       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904912692798       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904912692804       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904912692811       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904912692813       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+02 is 1.969122e-07

solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904912631859       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904912644731       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904912646363       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904912647046       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904912647081       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904912647080       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904912647094       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904912647092       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904912647101       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904912647100       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+03 is 4.923095e-08

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904912631859       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904912635077       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904912635485       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904912635655       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904912635695       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904912635652       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904912635659       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904912635677       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904912635675       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904912635688       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+04 is 1.230792e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7189e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.762720e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155701e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758067e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874093e-03 3 1  ON 9
ci_011                -9.142782e-03 3 1  ON 10
ci_012                -9.120575e-03 3 1  ON 11
ci_013                -1.923573e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103411e-02 3 1  ON 14
ci_016                 1.597438e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080089e-03 3 1  ON 17
ci_019                 8.981738e-03 3 1  ON 18
ci_020                 1.506479e-02 3 1  ON 19
ci_021                 1.519141e-02 3 1  ON 20
ci_022                 8.258506e-03 3 1  ON 21
ci_023                 8.361548e-03 3 1  ON 22
ci_024                 8.582819e-03 3 1  ON 23
ci_025                 8.594719e-03 3 1  ON 24
ci_026                 1.002847e-02 3 1  ON 25
ci_027                 9.639983e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795514e-03 3 1  ON 29
ci_031                -8.563472e-03 3 1  ON 30
ci_032                -1.443914e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915666e-03 3 1  ON 33
ci_035                -3.348060e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200344e-04 3 1  ON 37
ci_039                 1.223205e-03 3 1  ON 38
ci_040                -1.603045e-03 3 1  ON 39
ci_041                 8.180253e-03 3 1  ON 40
ci_042                 8.255567e-03 3 1  ON 41
ci_043                -2.385633e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870125e-03 3 1  ON 44
ci_046                 4.771114e-03 3 1  ON 45
ci_047                 4.645469e-03 3 1  ON 46
ci_048                -1.242640e-02 3 1  ON 47
ci_049                -1.288198e-02 3 1  ON 48
ci_050                 2.825128e-03 3 1  ON 49
ci_051                 2.816378e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208872e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375178e-03 3 1  ON 54
ci_056                 4.660689e-03 3 1  ON 55
ci_057                 4.675264e-03 3 1  ON 56
ci_058                -2.044652e-03 3 1  ON 57
ci_059                -2.118569e-03 3 1  ON 58
ci_060                 4.730418e-03 3 1  ON 59
ci_061                 5.181149e-03 3 1  ON 60
ci_062                -2.828211e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213459e-03 3 1  ON 63
ci_065                -3.398028e-03 3 1  ON 64
ci_066                 4.063212e-03 3 1  ON 65
ci_067                 4.160680e-03 3 1  ON 66
ci_068                -4.398705e-03 3 1  ON 67
ci_069                -4.115104e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.227
    reference variance = 0.302023
====================================================
  Execution time = 1.4471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9757e-01
  Total weights = 1.9577e+06
  Execution time = 1.8638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745428777
                                         uncertainty =       0.001654679354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745428777
                                         uncertainty =       0.001654679354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378645733
  error estimate for blocks of size 2^( 2) =       0.000390231084
  error estimate for blocks of size 2^( 3) =       0.000400932608
  error estimate for blocks of size 2^( 4) =       0.000408881389
  error estimate for blocks of size 2^( 5) =       0.000413904610
  error estimate for blocks of size 2^( 6) =       0.000415224288
  error estimate for blocks of size 2^( 7) =       0.000415901614

      target function =      -0.916401401357
              le_mean =     -17.214641023898
             les_mean =     296.641440120774
             stat err =       0.000413477975
             autocorr =       1.192445742845
   target nu stat err =       0.000413477975
   target dn stat err =       0.002117906536
      target stat err =       0.003398637489
              std dev =       0.535485931165
             le_variance =       0.286745182476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745423393
                                         uncertainty =       0.001654681097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745423393
                                         uncertainty =       0.001654681097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378645730
  error estimate for blocks of size 2^( 2) =       0.000390231085
  error estimate for blocks of size 2^( 3) =       0.000400932614
  error estimate for blocks of size 2^( 4) =       0.000408881402
  error estimate for blocks of size 2^( 5) =       0.000413904621
  error estimate for blocks of size 2^( 6) =       0.000415224300
  error estimate for blocks of size 2^( 7) =       0.000415901617

      target function =      -0.916401381317
              le_mean =     -17.214641024149
             les_mean =     296.641440142158
             stat err =       0.000413477985
             autocorr =       1.192445819780
   target nu stat err =       0.000413477985
   target dn stat err =       0.002117910556
      target stat err =       0.003398643519
              std dev =       0.535485926598
             le_variance =       0.286745177584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745426084
                                         uncertainty =       0.001654680226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745426084
                                         uncertainty =       0.001654680226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378645732
  error estimate for blocks of size 2^( 2) =       0.000390231085
  error estimate for blocks of size 2^( 3) =       0.000400932611
  error estimate for blocks of size 2^( 4) =       0.000408881396
  error estimate for blocks of size 2^( 5) =       0.000413904615
  error estimate for blocks of size 2^( 6) =       0.000415224294
  error estimate for blocks of size 2^( 7) =       0.000415901616

      target function =      -0.916401391386
              le_mean =     -17.214641024023
             les_mean =     296.641440131431
             stat err =       0.000413477980
             autocorr =       1.192445781309
   target nu stat err =       0.000413477980
   target dn stat err =       0.002117908545
      target stat err =       0.003398640503
              std dev =       0.535485928880
             le_variance =       0.286745180029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745428440
                                         uncertainty =       0.001654679463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286745428440
                                         uncertainty =       0.001654679463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378645733
  error estimate for blocks of size 2^( 2) =       0.000390231084
  error estimate for blocks of size 2^( 3) =       0.000400932609
  error estimate for blocks of size 2^( 4) =       0.000408881390
  error estimate for blocks of size 2^( 5) =       0.000413904610
  error estimate for blocks of size 2^( 6) =       0.000415224289
  error estimate for blocks of size 2^( 7) =       0.000415901614

      target function =      -0.916401400116
              le_mean =     -17.214641023914
             les_mean =     296.641440122102
             stat err =       0.000413477976
             autocorr =       1.192445747654
   target nu stat err =       0.000413477976
   target dn stat err =       0.002117906787
      target stat err =       0.003398637865
              std dev =       0.535485930879
             le_variance =       0.286745182170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.916401401357        initial  <--
     8.2718e+02     8.2718e+03             1.9691e-07        -0.916401381317
     3.3087e+03     3.3087e+04             4.9231e-08        -0.916401391386
     1.3235e+04     1.3235e+05             1.2308e-08        -0.916401400116

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8861
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582869e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200327e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180278e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385625e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730413e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2532
    reference variance = 0.250148
====================================================
  Execution time = 1.4848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0304e-01
  Total weights = 1.958050594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287509228892
                                         uncertainty =       0.001996057272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287509228892
                                         uncertainty =       0.001996057272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379304121
  error estimate for blocks of size 2^( 2) =       0.000390619522
  error estimate for blocks of size 2^( 3) =       0.000401002116
  error estimate for blocks of size 2^( 4) =       0.000408765972
  error estimate for blocks of size 2^( 5) =       0.000413350028
  error estimate for blocks of size 2^( 6) =       0.000416919062
  error estimate for blocks of size 2^( 7) =       0.000417037497

      target function =      -0.907866230969
              le_mean =     -17.214952596603
             les_mean =     296.657629098777
             stat err =       0.000414018140
             autocorr =       1.191416518027
   target nu stat err =       0.000414018140
   target dn stat err =       0.003876066946
      target stat err =       0.006015539085
              std dev =       0.536417032048
             le_variance =       0.287743232271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721495259660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+03, overlap shift 8.2718e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907905146175       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907905152148       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907905152514       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907905152693       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907905152703       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907905152732       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907905152763       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907905152772       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907905152758       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907905152771       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+03 is 1.431377e-08

solving harmonic davidson linear method for identity shift 3.3087e+04, overlap shift 3.3087e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907905146175       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907905147668       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907905147759       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907905147805       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907905147815       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907905147853       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907905147819       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907905147835       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907905147846       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907905147828       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+04 is 3.578464e-09

solving harmonic davidson linear method for identity shift 1.3235e+05, overlap shift 1.3235e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907905146175       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907905146548       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907905146571       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907905146598       residual = 7.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907905146706       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907905146645       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907905146658       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907905146435       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907905146661       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907905146601       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+05 is 8.946173e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7384e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874111e-03 3 1  ON 9
ci_011                -9.142776e-03 3 1  ON 10
ci_012                -9.120577e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080088e-03 3 1  ON 17
ci_019                 8.981729e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258521e-03 3 1  ON 21
ci_023                 8.361544e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795527e-03 3 1  ON 29
ci_031                -8.563450e-03 3 1  ON 30
ci_032                -1.443912e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348052e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200324e-04 3 1  ON 37
ci_039                 1.223218e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255557e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921309e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275403e-03 3 1  ON 51
ci_053                -2.208882e-03 3 1  ON 52
ci_054                -2.321110e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044635e-03 3 1  ON 57
ci_059                -2.118593e-03 3 1  ON 58
ci_060                 4.730412e-03 3 1  ON 59
ci_061                 5.181177e-03 3 1  ON 60
ci_062                -2.828196e-03 3 1  ON 61
ci_063                -2.781441e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160691e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115098e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.290581
====================================================
  Execution time = 1.4228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0640e-01
  Total weights = 1.9578e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739480
                                         uncertainty =       0.002076683860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739480
                                         uncertainty =       0.002076683860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379923157
  error estimate for blocks of size 2^( 2) =       0.000391456321
  error estimate for blocks of size 2^( 3) =       0.000401711894
  error estimate for blocks of size 2^( 4) =       0.000408863787
  error estimate for blocks of size 2^( 5) =       0.000413830023
  error estimate for blocks of size 2^( 6) =       0.000415718071
  error estimate for blocks of size 2^( 7) =       0.000418928468

      target function =      -0.902699591571
              le_mean =     -17.214570974176
             les_mean =     296.647858083844
             stat err =       0.000414335087
             autocorr =       1.189356071471
   target nu stat err =       0.000414335087
   target dn stat err =       0.005076178639
      target stat err =       0.007761559375
              std dev =       0.537292481426
             le_variance =       0.288683210596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681740213
                                         uncertainty =       0.002076683784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681740213
                                         uncertainty =       0.002076683784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379923158
  error estimate for blocks of size 2^( 2) =       0.000391456321
  error estimate for blocks of size 2^( 3) =       0.000401711895
  error estimate for blocks of size 2^( 4) =       0.000408863788
  error estimate for blocks of size 2^( 5) =       0.000413830024
  error estimate for blocks of size 2^( 6) =       0.000415718073
  error estimate for blocks of size 2^( 7) =       0.000418928469

      target function =      -0.902699580299
              le_mean =     -17.214570974223
             les_mean =     296.647858092876
             stat err =       0.000414335088
             autocorr =       1.189356073846
   target nu stat err =       0.000414335088
   target dn stat err =       0.005076177027
      target stat err =       0.007761556736
              std dev =       0.537292482091
             le_variance =       0.288683211312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739846
                                         uncertainty =       0.002076683822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739846
                                         uncertainty =       0.002076683822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379923157
  error estimate for blocks of size 2^( 2) =       0.000391456321
  error estimate for blocks of size 2^( 3) =       0.000401711894
  error estimate for blocks of size 2^( 4) =       0.000408863787
  error estimate for blocks of size 2^( 5) =       0.000413830023
  error estimate for blocks of size 2^( 6) =       0.000415718072
  error estimate for blocks of size 2^( 7) =       0.000418928469

      target function =      -0.902699585938
              le_mean =     -17.214570974200
             les_mean =     296.647858088358
             stat err =       0.000414335088
             autocorr =       1.189356072652
   target nu stat err =       0.000414335088
   target dn stat err =       0.005076177833
      target stat err =       0.007761558055
              std dev =       0.537292481758
             le_variance =       0.288683210954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739526
                                         uncertainty =       0.002076683856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288681739526
                                         uncertainty =       0.002076683856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379923157
  error estimate for blocks of size 2^( 2) =       0.000391456321
  error estimate for blocks of size 2^( 3) =       0.000401711894
  error estimate for blocks of size 2^( 4) =       0.000408863787
  error estimate for blocks of size 2^( 5) =       0.000413830023
  error estimate for blocks of size 2^( 6) =       0.000415718072
  error estimate for blocks of size 2^( 7) =       0.000418928468

      target function =      -0.902699590867
              le_mean =     -17.214570974179
             les_mean =     296.647858084408
             stat err =       0.000414335087
             autocorr =       1.189356071625
   target nu stat err =       0.000414335087
   target dn stat err =       0.005076178539
      target stat err =       0.007761559210
              std dev =       0.537292481467
             le_variance =       0.288683210641


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902699591571        initial  <--
     8.2718e+03     8.2718e+04             1.4314e-08        -0.902699580299
     3.3087e+04     3.3087e+05             3.5785e-09        -0.902699585938
     1.3235e+05     1.3235e+06             8.9462e-10        -0.902699590867

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6553
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582869e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200327e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180278e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385625e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730413e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.307802
====================================================
  Execution time = 1.4746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9896e-01
  Total weights = 1.958054973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287234975203
                                         uncertainty =       0.001751622065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287234975203
                                         uncertainty =       0.001751622065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378941924
  error estimate for blocks of size 2^( 2) =       0.000390158148
  error estimate for blocks of size 2^( 3) =       0.000400756829
  error estimate for blocks of size 2^( 4) =       0.000407780713
  error estimate for blocks of size 2^( 5) =       0.000412529125
  error estimate for blocks of size 2^( 6) =       0.000413924742
  error estimate for blocks of size 2^( 7) =       0.000414756591

      target function =      -0.914203664808
              le_mean =     -17.215254757844
             les_mean =     296.663954300948
             stat err =       0.000412247793
             autocorr =       1.183508460333
   target nu stat err =       0.000412247793
   target dn stat err =       0.002749880054
      target stat err =       0.004357651097
              std dev =       0.535904808107
             le_variance =       0.287193963352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721525475784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+04, overlap shift 8.2718e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223634449       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223634673       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223634717       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223634730       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914223634702       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914223634753       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914223634784       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914223634687       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914223634730       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914223634719       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+04 is 1.144057e-09

solving harmonic davidson linear method for identity shift 3.3087e+05, overlap shift 3.3087e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223634449       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223634505       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223634516       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223634228       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914223634520       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914223633801       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914223634541       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914223635072       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914223634192       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914223634236       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+05 is 2.860145e-10

solving harmonic davidson linear method for identity shift 1.3235e+06, overlap shift 1.3235e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914223634449       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914223634463       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914223634466       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914223634466       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914223634467       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914223634342       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914223633823       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914223631760       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914223635266       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914223634467       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3235e+06 is 7.150365e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7281e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582869e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200327e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730413e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1865
    reference variance = 0.210389
====================================================
  Execution time = 1.4439e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0526e-01
  Total weights = 1.9576e+06
  Execution time = 1.8609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798209
                                         uncertainty =       0.002603429601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798209
                                         uncertainty =       0.002603429601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379990875
  error estimate for blocks of size 2^( 2) =       0.000391162060
  error estimate for blocks of size 2^( 3) =       0.000401460049
  error estimate for blocks of size 2^( 4) =       0.000408923251
  error estimate for blocks of size 2^( 5) =       0.000414250271
  error estimate for blocks of size 2^( 6) =       0.000417160586
  error estimate for blocks of size 2^( 7) =       0.000418061359

      target function =      -0.904488353235
              le_mean =     -17.214406012138
             les_mean =     296.641031286649
             stat err =       0.000414598867
             autocorr =       1.190446507687
   target nu stat err =       0.000414598867
   target dn stat err =       0.003781742940
      target stat err =       0.005822029865
              std dev =       0.537388249299
             le_variance =       0.288786130485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798229
                                         uncertainty =       0.002603429683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798229
                                         uncertainty =       0.002603429683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379990875
  error estimate for blocks of size 2^( 2) =       0.000391162060
  error estimate for blocks of size 2^( 3) =       0.000401460049
  error estimate for blocks of size 2^( 4) =       0.000408923251
  error estimate for blocks of size 2^( 5) =       0.000414250271
  error estimate for blocks of size 2^( 6) =       0.000417160586
  error estimate for blocks of size 2^( 7) =       0.000418061359

      target function =      -0.904488360677
              le_mean =     -17.214406012148
             les_mean =     296.641031282138
             stat err =       0.000414598867
             autocorr =       1.190446508698
   target nu stat err =       0.000414598867
   target dn stat err =       0.003781742274
      target stat err =       0.005822028950
              std dev =       0.537388249318
             le_variance =       0.288786130506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798219
                                         uncertainty =       0.002603429642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798219
                                         uncertainty =       0.002603429642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379990875
  error estimate for blocks of size 2^( 2) =       0.000391162060
  error estimate for blocks of size 2^( 3) =       0.000401460049
  error estimate for blocks of size 2^( 4) =       0.000408923251
  error estimate for blocks of size 2^( 5) =       0.000414250271
  error estimate for blocks of size 2^( 6) =       0.000417160586
  error estimate for blocks of size 2^( 7) =       0.000418061359

      target function =      -0.904488356956
              le_mean =     -17.214406012143
             les_mean =     296.641031284393
             stat err =       0.000414598867
             autocorr =       1.190446508188
   target nu stat err =       0.000414598867
   target dn stat err =       0.003781742607
      target stat err =       0.005822029408
              std dev =       0.537388249309
             le_variance =       0.288786130495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798210
                                         uncertainty =       0.002603429606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288788798210
                                         uncertainty =       0.002603429606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379990875
  error estimate for blocks of size 2^( 2) =       0.000391162060
  error estimate for blocks of size 2^( 3) =       0.000401460049
  error estimate for blocks of size 2^( 4) =       0.000408923251
  error estimate for blocks of size 2^( 5) =       0.000414250271
  error estimate for blocks of size 2^( 6) =       0.000417160586
  error estimate for blocks of size 2^( 7) =       0.000418061359

      target function =      -0.904488353700
              le_mean =     -17.214406012139
             les_mean =     296.641031286367
             stat err =       0.000414598867
             autocorr =       1.190446507748
   target nu stat err =       0.000414598867
   target dn stat err =       0.003781742898
      target stat err =       0.005822029808
              std dev =       0.537388249301
             le_variance =       0.288786130486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904488353235        initial
     8.2718e+04     8.2718e+05             1.1441e-09        -0.904488360677  <--
     3.3087e+05     3.3087e+06             2.8601e-10        -0.904488356956
     1.3235e+06     1.3235e+07             7.1504e-11        -0.904488353700

*****************************************************************************
Applying the update for shift_i =   8.2718e+04     and shift_s =   8.2718e+05
*****************************************************************************

  Execution time = 2.3845e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594750e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200326e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921310e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2979
    reference variance = 0.29991
====================================================
  Execution time = 1.4668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9632e-01
  Total weights = 1.957780755e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284724090205
                                         uncertainty =       0.001573741585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284724090205
                                         uncertainty =       0.001573741585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377349825
  error estimate for blocks of size 2^( 2) =       0.000388670903
  error estimate for blocks of size 2^( 3) =       0.000398930496
  error estimate for blocks of size 2^( 4) =       0.000406683553
  error estimate for blocks of size 2^( 5) =       0.000412662844
  error estimate for blocks of size 2^( 6) =       0.000416021883
  error estimate for blocks of size 2^( 7) =       0.000417588325

      target function =      -0.918382159950
              le_mean =     -17.214606013406
             les_mean =     296.638976404309
             stat err =       0.000413239151
             autocorr =       1.199263503846
   target nu stat err =       0.000413239151
   target dn stat err =       0.002074793414
      target stat err =       0.003346274930
              std dev =       0.533653239592
             le_variance =       0.284785780127


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721460601341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+04, overlap shift 2.0680e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918393290487       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918393291398       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918393291634       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918393291711       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918393291725       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918393291709       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918393291702       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918393291673       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918393291729       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918393291770       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+04 is 4.499662e-09

solving harmonic davidson linear method for identity shift 8.2718e+04, overlap shift 8.2718e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918393290487       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918393290715       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918393290774       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918393290793       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918393290828       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918393290678       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918393290852       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918393290814       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918393290755       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918393290775       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+04 is 1.124918e-09

solving harmonic davidson linear method for identity shift 3.3087e+05, overlap shift 3.3087e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918393290487       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918393290544       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918393290559       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918393290550       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918393289903       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918393290445       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918393290378       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918393290893       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918393290422       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918393290805       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+05 is 2.812299e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7218e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874111e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594751e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795529e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554540e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200326e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825093e-03 3 1  ON 49
ci_051                 2.816363e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2741
    reference variance = 0.122818
====================================================
  Execution time = 1.4311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9894e-01
  Total weights = 1.9578e+06
  Execution time = 1.8659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431437
                                         uncertainty =       0.001678178133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431437
                                         uncertainty =       0.001678178133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378826740
  error estimate for blocks of size 2^( 2) =       0.000390082427
  error estimate for blocks of size 2^( 3) =       0.000400566828
  error estimate for blocks of size 2^( 4) =       0.000408522072
  error estimate for blocks of size 2^( 5) =       0.000413779439
  error estimate for blocks of size 2^( 6) =       0.000416083182
  error estimate for blocks of size 2^( 7) =       0.000415399836

      target function =      -0.914253380899
              le_mean =     -17.214904169518
             les_mean =     296.651864741614
             stat err =       0.000413446132
             autocorr =       1.191123008366
   target nu stat err =       0.000413446132
   target dn stat err =       0.002238966839
      target stat err =       0.003569982025
              std dev =       0.535741913314
             le_variance =       0.287019397681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431305
                                         uncertainty =       0.001678178079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431305
                                         uncertainty =       0.001678178079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378826740
  error estimate for blocks of size 2^( 2) =       0.000390082427
  error estimate for blocks of size 2^( 3) =       0.000400566829
  error estimate for blocks of size 2^( 4) =       0.000408522073
  error estimate for blocks of size 2^( 5) =       0.000413779439
  error estimate for blocks of size 2^( 6) =       0.000416083183
  error estimate for blocks of size 2^( 7) =       0.000415399836

      target function =      -0.914253368880
              le_mean =     -17.214904169444
             les_mean =     296.651864746764
             stat err =       0.000413446133
             autocorr =       1.191123012445
   target nu stat err =       0.000413446133
   target dn stat err =       0.002238967196
      target stat err =       0.003569982479
              std dev =       0.535741913189
             le_variance =       0.287019397548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431371
                                         uncertainty =       0.001678178106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431371
                                         uncertainty =       0.001678178106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378826740
  error estimate for blocks of size 2^( 2) =       0.000390082427
  error estimate for blocks of size 2^( 3) =       0.000400566829
  error estimate for blocks of size 2^( 4) =       0.000408522073
  error estimate for blocks of size 2^( 5) =       0.000413779439
  error estimate for blocks of size 2^( 6) =       0.000416083182
  error estimate for blocks of size 2^( 7) =       0.000415399836

      target function =      -0.914253374894
              le_mean =     -17.214904169481
             les_mean =     296.651864744187
             stat err =       0.000413446132
             autocorr =       1.191123010400
   target nu stat err =       0.000413446132
   target dn stat err =       0.002238967017
      target stat err =       0.003569982252
              std dev =       0.535741913252
             le_variance =       0.287019397615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431429
                                         uncertainty =       0.001678178129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287061431429
                                         uncertainty =       0.001678178129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378826740
  error estimate for blocks of size 2^( 2) =       0.000390082427
  error estimate for blocks of size 2^( 3) =       0.000400566828
  error estimate for blocks of size 2^( 4) =       0.000408522072
  error estimate for blocks of size 2^( 5) =       0.000413779439
  error estimate for blocks of size 2^( 6) =       0.000416083182
  error estimate for blocks of size 2^( 7) =       0.000415399836

      target function =      -0.914253380149
              le_mean =     -17.214904169513
             les_mean =     296.651864741935
             stat err =       0.000413446132
             autocorr =       1.191123008623
   target nu stat err =       0.000413446132
   target dn stat err =       0.002238966861
      target stat err =       0.003569982053
              std dev =       0.535741913306
             le_variance =       0.287019397673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914253380899        initial  <--
     2.0680e+04     2.0680e+05             4.4997e-09        -0.914253368880
     8.2718e+04     8.2718e+05             1.1249e-09        -0.914253374894
     3.3087e+05     3.3087e+06             2.8123e-10        -0.914253380149

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7397
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849767e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594750e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200326e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921310e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1411
    reference variance = 0.202528
====================================================
  Execution time = 1.6453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0034e-01
  Total weights = 1.957487714e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286750416562
                                         uncertainty =       0.001788284941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286750416562
                                         uncertainty =       0.001788284941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378626243
  error estimate for blocks of size 2^( 2) =       0.000389697542
  error estimate for blocks of size 2^( 3) =       0.000399810495
  error estimate for blocks of size 2^( 4) =       0.000407244743
  error estimate for blocks of size 2^( 5) =       0.000411977656
  error estimate for blocks of size 2^( 6) =       0.000415013325
  error estimate for blocks of size 2^( 7) =       0.000415541992

      target function =      -0.912060747052
              le_mean =     -17.215089401494
             les_mean =     296.659641603349
             stat err =       0.000412444429
             autocorr =       1.186613977412
   target nu stat err =       0.000412444429
   target dn stat err =       0.002485426966
      target stat err =       0.003930746522
              std dev =       0.535458367596
             le_variance =       0.286715663428


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721508940149e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+05, overlap shift 2.0680e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912076773120       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912076773277       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912076773295       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912076773301       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912076773374       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912076773301       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912076773931       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912076773301       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912076773300       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912076773757       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+05 is 6.144971e-10

solving harmonic davidson linear method for identity shift 8.2718e+05, overlap shift 8.2718e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912076773120       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912076773159       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912076773164       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912076772872       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912076773343       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912076773165       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912076773165       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912076773165       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912076773165       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912076773165       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+05 is 1.536243e-10

solving harmonic davidson linear method for identity shift 3.3087e+06, overlap shift 3.3087e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912076773120       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912076773130       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912076773131       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912076773131       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912076773131       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912076773131       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912076773199       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912076774303       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912076771397       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912076772599       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3087e+06 is 3.840609e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8984e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594750e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563452e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200326e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921310e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.220581
====================================================
  Execution time = 1.4616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0080e-01
  Total weights = 1.9579e+06
  Execution time = 1.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972778
                                         uncertainty =       0.001729320214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972778
                                         uncertainty =       0.001729320214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378220525
  error estimate for blocks of size 2^( 2) =       0.000389364519
  error estimate for blocks of size 2^( 3) =       0.000399645692
  error estimate for blocks of size 2^( 4) =       0.000407330649
  error estimate for blocks of size 2^( 5) =       0.000412223794
  error estimate for blocks of size 2^( 6) =       0.000416684496
  error estimate for blocks of size 2^( 7) =       0.000419065070

      target function =      -0.911382921643
              le_mean =     -17.214131457196
             les_mean =     296.627117125454
             stat err =       0.000413826002
             autocorr =       1.197141165580
   target nu stat err =       0.000413826002
   target dn stat err =       0.003030591399
      target stat err =       0.004752591528
              std dev =       0.534884596079
             le_variance =       0.286101531122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972721
                                         uncertainty =       0.001729320219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972721
                                         uncertainty =       0.001729320219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378220525
  error estimate for blocks of size 2^( 2) =       0.000389364519
  error estimate for blocks of size 2^( 3) =       0.000399645692
  error estimate for blocks of size 2^( 4) =       0.000407330649
  error estimate for blocks of size 2^( 5) =       0.000412223794
  error estimate for blocks of size 2^( 6) =       0.000416684496
  error estimate for blocks of size 2^( 7) =       0.000419065071

      target function =      -0.911382924550
              le_mean =     -17.214131457202
             les_mean =     296.627117123780
             stat err =       0.000413826002
             autocorr =       1.197141166519
   target nu stat err =       0.000413826002
   target dn stat err =       0.003030590765
      target stat err =       0.004752590585
              std dev =       0.534884596025
             le_variance =       0.286101531065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972750
                                         uncertainty =       0.001729320216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972750
                                         uncertainty =       0.001729320216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378220525
  error estimate for blocks of size 2^( 2) =       0.000389364519
  error estimate for blocks of size 2^( 3) =       0.000399645692
  error estimate for blocks of size 2^( 4) =       0.000407330649
  error estimate for blocks of size 2^( 5) =       0.000412223794
  error estimate for blocks of size 2^( 6) =       0.000416684496
  error estimate for blocks of size 2^( 7) =       0.000419065071

      target function =      -0.911382923097
              le_mean =     -17.214131457199
             les_mean =     296.627117124617
             stat err =       0.000413826002
             autocorr =       1.197141166049
   target nu stat err =       0.000413826002
   target dn stat err =       0.003030591082
      target stat err =       0.004752591057
              std dev =       0.534884596052
             le_variance =       0.286101531094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972775
                                         uncertainty =       0.001729320214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286095972775
                                         uncertainty =       0.001729320214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378220525
  error estimate for blocks of size 2^( 2) =       0.000389364519
  error estimate for blocks of size 2^( 3) =       0.000399645692
  error estimate for blocks of size 2^( 4) =       0.000407330649
  error estimate for blocks of size 2^( 5) =       0.000412223794
  error estimate for blocks of size 2^( 6) =       0.000416684496
  error estimate for blocks of size 2^( 7) =       0.000419065071

      target function =      -0.911382921825
              le_mean =     -17.214131457197
             les_mean =     296.627117125349
             stat err =       0.000413826002
             autocorr =       1.197141165645
   target nu stat err =       0.000413826002
   target dn stat err =       0.003030591360
      target stat err =       0.004752591469
              std dev =       0.534884596075
             le_variance =       0.286101531119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911382921643        initial
     2.0680e+05     2.0680e+06             6.1450e-10        -0.911382924550  <--
     8.2718e+05     8.2718e+06             1.5362e-10        -0.911382923097
     3.3087e+06     3.3087e+07             3.8406e-11        -0.911382921825

*****************************************************************************
Applying the update for shift_i =   2.0680e+05     and shift_s =   2.0680e+06
*****************************************************************************

  Execution time = 2.4041e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361542e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594750e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795530e-03 3 1  ON 29
ci_031                -8.563453e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200326e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921310e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2671
    reference variance = 0.179206
====================================================
  Execution time = 1.4581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9760e-01
  Total weights = 1.958092880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286107123159
                                         uncertainty =       0.001616946617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286107123159
                                         uncertainty =       0.001616946617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378195972
  error estimate for blocks of size 2^( 2) =       0.000390067180
  error estimate for blocks of size 2^( 3) =       0.000400595978
  error estimate for blocks of size 2^( 4) =       0.000408292893
  error estimate for blocks of size 2^( 5) =       0.000412794394
  error estimate for blocks of size 2^( 6) =       0.000415330028
  error estimate for blocks of size 2^( 7) =       0.000417226975

      target function =      -0.916360951781
              le_mean =     -17.214850872872
             les_mean =     296.648686969249
             stat err =       0.000413411073
             autocorr =       1.194896831518
   target nu stat err =       0.000413411073
   target dn stat err =       0.002040569117
      target stat err =       0.003280994595
              std dev =       0.534849873471
             le_variance =       0.286064387152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721485087287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+04, overlap shift 5.1699e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916371704468       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916371705067       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916371705142       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916371705166       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916371705168       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916371705202       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916371705167       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916371705102       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916371705177       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+04 is 2.580696e-09

solving harmonic davidson linear method for identity shift 2.0680e+05, overlap shift 2.0680e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916371704468       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916371704618       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916371704636       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916371704643       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916371704643       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916371704643       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916371704643       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916371704643       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916371704624       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+05 is 6.451748e-10

solving harmonic davidson linear method for identity shift 8.2718e+05, overlap shift 8.2718e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916371704468       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916371704505       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916371704510       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916371704512       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916371704611       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916371704805       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916371704720       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916371704883       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916371704947       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.2718e+05 is 1.612937e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7124e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875738e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874111e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120576e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103414e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981728e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582868e-03 3 1  ON 23
ci_025                 8.594750e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795529e-03 3 1  ON 29
ci_031                -8.563453e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554540e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200325e-04 3 1  ON 37
ci_039                 1.223217e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385624e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816362e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181176e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781439e-03 3 1  ON 62
ci_064                -2.213467e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115097e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.189517
====================================================
  Execution time = 1.4409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9847e-01
  Total weights = 1.9577e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914578159
                                         uncertainty =       0.001768576681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914578159
                                         uncertainty =       0.001768576681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378070246
  error estimate for blocks of size 2^( 2) =       0.000389267963
  error estimate for blocks of size 2^( 3) =       0.000399635981
  error estimate for blocks of size 2^( 4) =       0.000407577621
  error estimate for blocks of size 2^( 5) =       0.000411644923
  error estimate for blocks of size 2^( 6) =       0.000414575133
  error estimate for blocks of size 2^( 7) =       0.000415209303

      target function =      -0.915001017635
              le_mean =     -17.214450588733
             les_mean =     296.635779234116
             stat err =       0.000412251745
             autocorr =       1.188994934403
   target nu stat err =       0.000412251745
   target dn stat err =       0.002413324376
      target stat err =       0.003840022637
              std dev =       0.534672069880
             le_variance =       0.285874222309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914577834
                                         uncertainty =       0.001768576619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914577834
                                         uncertainty =       0.001768576619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378070246
  error estimate for blocks of size 2^( 2) =       0.000389267963
  error estimate for blocks of size 2^( 3) =       0.000399635981
  error estimate for blocks of size 2^( 4) =       0.000407577621
  error estimate for blocks of size 2^( 5) =       0.000411644923
  error estimate for blocks of size 2^( 6) =       0.000414575133
  error estimate for blocks of size 2^( 7) =       0.000415209303

      target function =      -0.915001019214
              le_mean =     -17.214450588717
             les_mean =     296.635779232545
             stat err =       0.000412251745
             autocorr =       1.188994936832
   target nu stat err =       0.000412251745
   target dn stat err =       0.002413324306
      target stat err =       0.003840022544
              std dev =       0.534672069578
             le_variance =       0.285874221987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914577997
                                         uncertainty =       0.001768576650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914577997
                                         uncertainty =       0.001768576650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378070246
  error estimate for blocks of size 2^( 2) =       0.000389267963
  error estimate for blocks of size 2^( 3) =       0.000399635981
  error estimate for blocks of size 2^( 4) =       0.000407577621
  error estimate for blocks of size 2^( 5) =       0.000411644923
  error estimate for blocks of size 2^( 6) =       0.000414575133
  error estimate for blocks of size 2^( 7) =       0.000415209303

      target function =      -0.915001018424
              le_mean =     -17.214450588725
             les_mean =     296.635779233330
             stat err =       0.000412251745
             autocorr =       1.188994935621
   target nu stat err =       0.000412251745
   target dn stat err =       0.002413324341
      target stat err =       0.003840022590
              std dev =       0.534672069729
             le_variance =       0.285874222148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914578139
                                         uncertainty =       0.001768576677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914578139
                                         uncertainty =       0.001768576677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378070246
  error estimate for blocks of size 2^( 2) =       0.000389267963
  error estimate for blocks of size 2^( 3) =       0.000399635981
  error estimate for blocks of size 2^( 4) =       0.000407577621
  error estimate for blocks of size 2^( 5) =       0.000411644923
  error estimate for blocks of size 2^( 6) =       0.000414575133
  error estimate for blocks of size 2^( 7) =       0.000415209303

      target function =      -0.915001017733
              le_mean =     -17.214450588732
             les_mean =     296.635779234017
             stat err =       0.000412251745
             autocorr =       1.188994934565
   target nu stat err =       0.000412251745
   target dn stat err =       0.002413324371
      target stat err =       0.003840022631
              std dev =       0.534672069861
             le_variance =       0.285874222289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915001017635        initial
     5.1699e+04     5.1699e+05             2.5807e-09        -0.915001019214  <--
     2.0680e+05     2.0680e+06             6.4517e-10        -0.915001018424
     8.2718e+05     8.2718e+06             1.6129e-10        -0.915001017733

*****************************************************************************
Applying the update for shift_i =   5.1699e+04     and shift_s =   5.1699e+05
*****************************************************************************

  Execution time = 2.3879e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874109e-03 3 1  ON 9
ci_011                -9.142774e-03 3 1  ON 10
ci_012                -9.120575e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117984e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981729e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594749e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639974e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795528e-03 3 1  ON 29
ci_031                -8.563453e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554540e-03 3 1  ON 32
ci_034                 4.915665e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200324e-04 3 1  ON 37
ci_039                 1.223216e-03 3 1  ON 38
ci_040                -1.603059e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921311e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645482e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816363e-03 3 1  ON 50
ci_052                -2.275399e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321108e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118592e-03 3 1  ON 58
ci_060                 4.730415e-03 3 1  ON 59
ci_061                 5.181175e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781438e-03 3 1  ON 62
ci_064                -2.213468e-03 3 1  ON 63
ci_065                -3.398022e-03 3 1  ON 64
ci_066                 4.063205e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.282157
====================================================
  Execution time = 1.4471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0340e-01
  Total weights = 1.957591025e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289206967950
                                         uncertainty =       0.001988638003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289206967950
                                         uncertainty =       0.001988638003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380236760
  error estimate for blocks of size 2^( 2) =       0.000391618074
  error estimate for blocks of size 2^( 3) =       0.000401413592
  error estimate for blocks of size 2^( 4) =       0.000408940904
  error estimate for blocks of size 2^( 5) =       0.000413982002
  error estimate for blocks of size 2^( 6) =       0.000416494371
  error estimate for blocks of size 2^( 7) =       0.000417078270

      target function =      -0.907299612049
              le_mean =     -17.215182603177
             les_mean =     296.665916853655
             stat err =       0.000414123887
             autocorr =       1.186184820180
   target nu stat err =       0.000414123887
   target dn stat err =       0.003191197615
      target stat err =       0.004964638655
              std dev =       0.537735982704
             le_variance =       0.289159987095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721518260318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+04, overlap shift 1.2925e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907325716900       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907325723974       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907325724923       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907325725206       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907325725232       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907325725259       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907325725235       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907325725273       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907325725258       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907325725225       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+04 is 1.823179e-08

solving harmonic davidson linear method for identity shift 5.1699e+04, overlap shift 5.1699e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907325716900       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907325718669       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907325718906       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907325718977       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907325718989       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907325719064       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907325718990       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907325719043       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907325718990       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907325718990       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+04 is 4.557970e-09

solving harmonic davidson linear method for identity shift 2.0680e+05, overlap shift 2.0680e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907325716900       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907325717342       residual = 3.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907325717402       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907325717419       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907325717423       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907325717911       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907325717308       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907325717643       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907325717455       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907325717482       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0680e+05 is 1.139494e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7020e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874110e-03 3 1  ON 9
ci_011                -9.142771e-03 3 1  ON 10
ci_012                -9.120574e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981729e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594748e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639975e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795527e-03 3 1  ON 29
ci_031                -8.563448e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915663e-03 3 1  ON 33
ci_035                -3.348051e-03 3 1  ON 34
ci_036                -1.126182e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200315e-04 3 1  ON 37
ci_039                 1.223215e-03 3 1  ON 38
ci_040                -1.603058e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255559e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921308e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816361e-03 3 1  ON 50
ci_052                -2.275400e-03 3 1  ON 51
ci_053                -2.208880e-03 3 1  ON 52
ci_054                -2.321109e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660692e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118589e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181174e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781438e-03 3 1  ON 62
ci_064                -2.213468e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063206e-03 3 1  ON 65
ci_067                 4.160692e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.275
    reference variance = 0.26982
====================================================
  Execution time = 1.4341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9908e-01
  Total weights = 1.9578e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427270182
                                         uncertainty =       0.001750626908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427270182
                                         uncertainty =       0.001750626908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378422547
  error estimate for blocks of size 2^( 2) =       0.000389808755
  error estimate for blocks of size 2^( 3) =       0.000400123689
  error estimate for blocks of size 2^( 4) =       0.000407549633
  error estimate for blocks of size 2^( 5) =       0.000411464888
  error estimate for blocks of size 2^( 6) =       0.000413888488
  error estimate for blocks of size 2^( 7) =       0.000416710369

      target function =      -0.914025396353
              le_mean =     -17.215324567471
             les_mean =     296.666475318150
             stat err =       0.000412403345
             autocorr =       1.187655131720
   target nu stat err =       0.000412403345
   target dn stat err =       0.002152444973
      target stat err =       0.003438190951
              std dev =       0.535170297696
             le_variance =       0.286407247536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427268947
                                         uncertainty =       0.001750626599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427268947
                                         uncertainty =       0.001750626599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378422546
  error estimate for blocks of size 2^( 2) =       0.000389808755
  error estimate for blocks of size 2^( 3) =       0.000400123691
  error estimate for blocks of size 2^( 4) =       0.000407549635
  error estimate for blocks of size 2^( 5) =       0.000411464890
  error estimate for blocks of size 2^( 6) =       0.000413888491
  error estimate for blocks of size 2^( 7) =       0.000416710372

      target function =      -0.914025533118
              le_mean =     -17.215324567525
             les_mean =     296.666475232619
             stat err =       0.000412403347
             autocorr =       1.187655150707
   target nu stat err =       0.000412403347
   target dn stat err =       0.002152436185
      target stat err =       0.003438178511
              std dev =       0.535170296514
             le_variance =       0.286407246271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427269565
                                         uncertainty =       0.001750626753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427269565
                                         uncertainty =       0.001750626753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378422546
  error estimate for blocks of size 2^( 2) =       0.000389808755
  error estimate for blocks of size 2^( 3) =       0.000400123690
  error estimate for blocks of size 2^( 4) =       0.000407549634
  error estimate for blocks of size 2^( 5) =       0.000411464889
  error estimate for blocks of size 2^( 6) =       0.000413888490
  error estimate for blocks of size 2^( 7) =       0.000416710371

      target function =      -0.914025464746
              le_mean =     -17.215324567498
             les_mean =     296.666475275377
             stat err =       0.000412403346
             autocorr =       1.187655141202
   target nu stat err =       0.000412403346
   target dn stat err =       0.002152440578
      target stat err =       0.003438184729
              std dev =       0.535170297105
             le_variance =       0.286407246904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427270105
                                         uncertainty =       0.001750626888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286427270105
                                         uncertainty =       0.001750626888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378422547
  error estimate for blocks of size 2^( 2) =       0.000389808755
  error estimate for blocks of size 2^( 3) =       0.000400123689
  error estimate for blocks of size 2^( 4) =       0.000407549633
  error estimate for blocks of size 2^( 5) =       0.000411464888
  error estimate for blocks of size 2^( 6) =       0.000413888489
  error estimate for blocks of size 2^( 7) =       0.000416710369

      target function =      -0.914025404903
              le_mean =     -17.215324567474
             les_mean =     296.666475312803
             stat err =       0.000412403345
             autocorr =       1.187655132891
   target nu stat err =       0.000412403345
   target dn stat err =       0.002152444424
      target stat err =       0.003438190173
              std dev =       0.535170297622
             le_variance =       0.286407247457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914025396353        initial
     1.2925e+04     1.2925e+05             1.8232e-08        -0.914025533118  <--
     5.1699e+04     5.1699e+05             4.5580e-09        -0.914025464746
     2.0680e+05     2.0680e+06             1.1395e-09        -0.914025404903

*****************************************************************************
Applying the update for shift_i =   1.2925e+04     and shift_s =   1.2925e+05
*****************************************************************************

  Execution time = 2.3798e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758068e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874113e-03 3 1  ON 9
ci_011                -9.142762e-03 3 1  ON 10
ci_012                -9.120570e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981728e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258520e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594746e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639979e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563434e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915657e-03 3 1  ON 33
ci_035                -3.348050e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200289e-04 3 1  ON 37
ci_039                 1.223212e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921299e-03 3 1  ON 43
ci_045                -1.870137e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645480e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825095e-03 3 1  ON 49
ci_051                 2.816353e-03 3 1  ON 50
ci_052                -2.275404e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321113e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660693e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118580e-03 3 1  ON 58
ci_060                 4.730412e-03 3 1  ON 59
ci_061                 5.181170e-03 3 1  ON 60
ci_062                -2.828193e-03 3 1  ON 61
ci_063                -2.781436e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063207e-03 3 1  ON 65
ci_067                 4.160693e-03 3 1  ON 66
ci_068                -4.398711e-03 3 1  ON 67
ci_069                -4.115093e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0828e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.168853
====================================================
  Execution time = 1.4490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0399e-01
  Total weights = 1.957661064e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5391e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288225620907
                                         uncertainty =       0.002096071469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288225620907
                                         uncertainty =       0.002096071469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379564492
  error estimate for blocks of size 2^( 2) =       0.000390939497
  error estimate for blocks of size 2^( 3) =       0.000401354475
  error estimate for blocks of size 2^( 4) =       0.000407977436
  error estimate for blocks of size 2^( 5) =       0.000413353031
  error estimate for blocks of size 2^( 6) =       0.000416526136
  error estimate for blocks of size 2^( 7) =       0.000416853422

      target function =      -0.906427882423
              le_mean =     -17.214503136105
             les_mean =     296.643112223726
             stat err =       0.000413677506
             autocorr =       1.187825538733
   target nu stat err =       0.000413677506
   target dn stat err =       0.003205847759
      target stat err =       0.004971066473
              std dev =       0.536785252171
             le_variance =       0.288138406948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450313610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+03, overlap shift 3.2312e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906454115395       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906454129657       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906454131841       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906454132447       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906454132562       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906454132570       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906454132575       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906454132578       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906454132575       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906454132579       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+03 is 4.827709e-08

solving harmonic davidson linear method for identity shift 1.2925e+04, overlap shift 1.2925e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906454115395       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906454118960       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906454119506       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906454119658       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906454119687       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906454119690       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906454119690       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906454119691       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906454119691       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906454119691       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+04 is 1.206947e-08

solving harmonic davidson linear method for identity shift 5.1699e+04, overlap shift 5.1699e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906454115395       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906454116286       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906454116423       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906454116461       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906454116443       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906454116469       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906454116438       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906454116469       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906454116469       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906454116469       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+04 is 3.017380e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7038e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.762721e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758062e-03 3 1  ON 7
ci_009                -1.401796e-02 3 1  ON 8
ci_010                -8.874107e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120566e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080081e-03 3 1  ON 17
ci_019                 8.981722e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258522e-03 3 1  ON 21
ci_023                 8.361540e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594737e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639975e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500986e-02 3 1  ON 28
ci_030                -8.795528e-03 3 1  ON 29
ci_031                -8.563439e-03 3 1  ON 30
ci_032                -1.443912e-02 3 1  ON 31
ci_033                 4.554547e-03 3 1  ON 32
ci_034                 4.915657e-03 3 1  ON 33
ci_035                -3.348050e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200306e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385619e-03 3 1  ON 42
ci_044                -3.921287e-03 3 1  ON 43
ci_045                -1.870132e-03 3 1  ON 44
ci_046                 4.771129e-03 3 1  ON 45
ci_047                 4.645478e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825095e-03 3 1  ON 49
ci_051                 2.816348e-03 3 1  ON 50
ci_052                -2.275406e-03 3 1  ON 51
ci_053                -2.208882e-03 3 1  ON 52
ci_054                -2.321113e-03 3 1  ON 53
ci_055                -2.375172e-03 3 1  ON 54
ci_056                 4.660691e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044632e-03 3 1  ON 57
ci_059                -2.118584e-03 3 1  ON 58
ci_060                 4.730406e-03 3 1  ON 59
ci_061                 5.181169e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781443e-03 3 1  ON 62
ci_064                -2.213472e-03 3 1  ON 63
ci_065                -3.398024e-03 3 1  ON 64
ci_066                 4.063207e-03 3 1  ON 65
ci_067                 4.160694e-03 3 1  ON 66
ci_068                -4.398709e-03 3 1  ON 67
ci_069                -4.115100e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2077
    reference variance = 0.167728
====================================================
  Execution time = 1.4455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9510e-01
  Total weights = 1.9577e+06
  Execution time = 1.8716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162285793
                                         uncertainty =       0.001715250947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162285793
                                         uncertainty =       0.001715250947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376898649
  error estimate for blocks of size 2^( 2) =       0.000388338445
  error estimate for blocks of size 2^( 3) =       0.000398206269
  error estimate for blocks of size 2^( 4) =       0.000405923811
  error estimate for blocks of size 2^( 5) =       0.000410171763
  error estimate for blocks of size 2^( 6) =       0.000413106588
  error estimate for blocks of size 2^( 7) =       0.000411385381

      target function =      -0.920320078603
              le_mean =     -17.214168598086
             les_mean =     296.622697939210
             stat err =       0.000410146886
             autocorr =       1.184212593587
   target nu stat err =       0.000410146886
   target dn stat err =       0.001886063596
      target stat err =       0.003065035898
              std dev =       0.533015180821
             le_variance =       0.284105182985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162279429
                                         uncertainty =       0.001715250639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162279429
                                         uncertainty =       0.001715250639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376898645
  error estimate for blocks of size 2^( 2) =       0.000388338444
  error estimate for blocks of size 2^( 3) =       0.000398206272
  error estimate for blocks of size 2^( 4) =       0.000405923816
  error estimate for blocks of size 2^( 5) =       0.000410171769
  error estimate for blocks of size 2^( 6) =       0.000413106595
  error estimate for blocks of size 2^( 7) =       0.000411385391

      target function =      -0.920319851001
              le_mean =     -17.214168597427
             les_mean =     296.622698060454
             stat err =       0.000410146893
             autocorr =       1.184212661686
   target nu stat err =       0.000410146893
   target dn stat err =       0.001886064153
      target stat err =       0.003065035278
              std dev =       0.533015174871
             le_variance =       0.284105176643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162282611
                                         uncertainty =       0.001715250793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162282611
                                         uncertainty =       0.001715250793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376898647
  error estimate for blocks of size 2^( 2) =       0.000388338444
  error estimate for blocks of size 2^( 3) =       0.000398206270
  error estimate for blocks of size 2^( 4) =       0.000405923814
  error estimate for blocks of size 2^( 5) =       0.000410171766
  error estimate for blocks of size 2^( 6) =       0.000413106591
  error estimate for blocks of size 2^( 7) =       0.000411385386

      target function =      -0.920319969728
              le_mean =     -17.214168597756
             les_mean =     296.622697996716
             stat err =       0.000410146889
             autocorr =       1.184212627639
   target nu stat err =       0.000410146889
   target dn stat err =       0.001886063864
      target stat err =       0.003065035603
              std dev =       0.533015177846
             le_variance =       0.284105179814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162285396
                                         uncertainty =       0.001715250928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284162285396
                                         uncertainty =       0.001715250928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376898649
  error estimate for blocks of size 2^( 2) =       0.000388338445
  error estimate for blocks of size 2^( 3) =       0.000398206269
  error estimate for blocks of size 2^( 4) =       0.000405923812
  error estimate for blocks of size 2^( 5) =       0.000410171763
  error estimate for blocks of size 2^( 6) =       0.000413106588
  error estimate for blocks of size 2^( 7) =       0.000411385382

      target function =      -0.920320065494
              le_mean =     -17.214168598045
             les_mean =     296.622697946081
             stat err =       0.000410146886
             autocorr =       1.184212597838
   target nu stat err =       0.000410146886
   target dn stat err =       0.001886063629
      target stat err =       0.003065035863
              std dev =       0.533015180449
             le_variance =       0.284105182589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.920320078603        initial  <--
     3.2312e+03     3.2312e+04             4.8277e-08        -0.920319851001
     1.2925e+04     1.2925e+05             1.2069e-08        -0.920319969728
     5.1699e+04     5.1699e+05             3.0174e-09        -0.920320065494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9090
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758068e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874113e-03 3 1  ON 9
ci_011                -9.142762e-03 3 1  ON 10
ci_012                -9.120570e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981728e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258520e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594746e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639979e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795526e-03 3 1  ON 29
ci_031                -8.563434e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915657e-03 3 1  ON 33
ci_035                -3.348050e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200289e-04 3 1  ON 37
ci_039                 1.223212e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921299e-03 3 1  ON 43
ci_045                -1.870137e-03 3 1  ON 44
ci_046                 4.771126e-03 3 1  ON 45
ci_047                 4.645480e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825095e-03 3 1  ON 49
ci_051                 2.816353e-03 3 1  ON 50
ci_052                -2.275404e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321113e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660693e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118580e-03 3 1  ON 58
ci_060                 4.730412e-03 3 1  ON 59
ci_061                 5.181170e-03 3 1  ON 60
ci_062                -2.828193e-03 3 1  ON 61
ci_063                -2.781436e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063207e-03 3 1  ON 65
ci_067                 4.160693e-03 3 1  ON 66
ci_068                -4.398711e-03 3 1  ON 67
ci_069                -4.115093e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.990496
====================================================
  Execution time = 1.4632e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9905e-01
  Total weights = 1.957553873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287393041526
                                         uncertainty =       0.001708016494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287393041526
                                         uncertainty =       0.001708016494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379065685
  error estimate for blocks of size 2^( 2) =       0.000390310605
  error estimate for blocks of size 2^( 3) =       0.000400260936
  error estimate for blocks of size 2^( 4) =       0.000407565146
  error estimate for blocks of size 2^( 5) =       0.000413294706
  error estimate for blocks of size 2^( 6) =       0.000414852086
  error estimate for blocks of size 2^( 7) =       0.000415846864

      target function =      -0.914100934121
              le_mean =     -17.214364820236
             les_mean =     296.633405009917
             stat err =       0.000412889700
             autocorr =       1.186421900666
   target nu stat err =       0.000412889700
   target dn stat err =       0.002324643987
      target stat err =       0.003696216320
              std dev =       0.536079833131
             le_variance =       0.287381587490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721436482024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+04, overlap shift 3.2312e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914115051499       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914115052511       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914115052667       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914115052708       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914115052720       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914115052762       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914115052756       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914115052699       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914115052710       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914115052731       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+04 is 3.826101e-09

solving harmonic davidson linear method for identity shift 1.2925e+05, overlap shift 1.2925e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914115051499       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914115051752       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914115051791       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914115051801       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914115051675       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914115051597       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914115051826       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914115051703       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914115051754       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914115051912       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+05 is 9.565266e-10

solving harmonic davidson linear method for identity shift 5.1699e+05, overlap shift 5.1699e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914115051499       residual = 7.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914115051562       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914115051572       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914115051574       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914115051323       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914115051759       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914115051613       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914115051608       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914115051712       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914115051359       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.1699e+05 is 2.391318e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7173e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758067e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142763e-03 3 1  ON 10
ci_012                -9.120570e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258520e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582867e-03 3 1  ON 23
ci_025                 8.594746e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563434e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915657e-03 3 1  ON 33
ci_035                -3.348050e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200288e-04 3 1  ON 37
ci_039                 1.223212e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255561e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921300e-03 3 1  ON 43
ci_045                -1.870137e-03 3 1  ON 44
ci_046                 4.771125e-03 3 1  ON 45
ci_047                 4.645479e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825095e-03 3 1  ON 49
ci_051                 2.816354e-03 3 1  ON 50
ci_052                -2.275404e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321112e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660693e-03 3 1  ON 55
ci_057                 4.675274e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118580e-03 3 1  ON 58
ci_060                 4.730411e-03 3 1  ON 59
ci_061                 5.181169e-03 3 1  ON 60
ci_062                -2.828193e-03 3 1  ON 61
ci_063                -2.781435e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398023e-03 3 1  ON 64
ci_066                 4.063207e-03 3 1  ON 65
ci_067                 4.160693e-03 3 1  ON 66
ci_068                -4.398712e-03 3 1  ON 67
ci_069                -4.115094e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.250459
====================================================
  Execution time = 1.4186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0096e-01
  Total weights = 1.9576e+06
  Execution time = 1.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216615
                                         uncertainty =       0.001733127790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216615
                                         uncertainty =       0.001733127790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380086445
  error estimate for blocks of size 2^( 2) =       0.000391191487
  error estimate for blocks of size 2^( 3) =       0.000401534999
  error estimate for blocks of size 2^( 4) =       0.000409545671
  error estimate for blocks of size 2^( 5) =       0.000413588912
  error estimate for blocks of size 2^( 6) =       0.000415848333
  error estimate for blocks of size 2^( 7) =       0.000419813148

      target function =      -0.911111980064
              le_mean =     -17.214608833536
             les_mean =     296.643721433738
             stat err =       0.000414699016
             autocorr =       1.190422824948
   target nu stat err =       0.000414699016
   target dn stat err =       0.002269926507
      target stat err =       0.003591517732
              std dev =       0.537523406075
             le_variance =       0.288931412078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216283
                                         uncertainty =       0.001733127839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216283
                                         uncertainty =       0.001733127839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380086445
  error estimate for blocks of size 2^( 2) =       0.000391191487
  error estimate for blocks of size 2^( 3) =       0.000401534999
  error estimate for blocks of size 2^( 4) =       0.000409545671
  error estimate for blocks of size 2^( 5) =       0.000413588912
  error estimate for blocks of size 2^( 6) =       0.000415848333
  error estimate for blocks of size 2^( 7) =       0.000419813148

      target function =      -0.911111985184
              le_mean =     -17.214608833555
             les_mean =     296.643721431092
             stat err =       0.000414699016
             autocorr =       1.190422826319
   target nu stat err =       0.000414699016
   target dn stat err =       0.002269926468
      target stat err =       0.003591517712
              std dev =       0.537523405780
             le_variance =       0.288931411761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216449
                                         uncertainty =       0.001733127815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216449
                                         uncertainty =       0.001733127815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380086445
  error estimate for blocks of size 2^( 2) =       0.000391191487
  error estimate for blocks of size 2^( 3) =       0.000401534999
  error estimate for blocks of size 2^( 4) =       0.000409545671
  error estimate for blocks of size 2^( 5) =       0.000413588912
  error estimate for blocks of size 2^( 6) =       0.000415848333
  error estimate for blocks of size 2^( 7) =       0.000419813148

      target function =      -0.911111982624
              le_mean =     -17.214608833545
             les_mean =     296.643721432415
             stat err =       0.000414699016
             autocorr =       1.190422825629
   target nu stat err =       0.000414699016
   target dn stat err =       0.002269926488
      target stat err =       0.003591517722
              std dev =       0.537523405927
             le_variance =       0.288931411920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216594
                                         uncertainty =       0.001733127793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288911216594
                                         uncertainty =       0.001733127793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380086445
  error estimate for blocks of size 2^( 2) =       0.000391191487
  error estimate for blocks of size 2^( 3) =       0.000401534999
  error estimate for blocks of size 2^( 4) =       0.000409545671
  error estimate for blocks of size 2^( 5) =       0.000413588912
  error estimate for blocks of size 2^( 6) =       0.000415848333
  error estimate for blocks of size 2^( 7) =       0.000419813148

      target function =      -0.911111980384
              le_mean =     -17.214608833537
             les_mean =     296.643721433572
             stat err =       0.000414699016
             autocorr =       1.190422825026
   target nu stat err =       0.000414699016
   target dn stat err =       0.002269926505
      target stat err =       0.003591517731
              std dev =       0.537523406057
             le_variance =       0.288931412059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911111980064        initial
     3.2312e+04     3.2312e+05             3.8261e-09        -0.911111985184  <--
     1.2925e+05     1.2925e+06             9.5653e-10        -0.911111982624
     5.1699e+05     5.1699e+06             2.3913e-10        -0.911111980384

*****************************************************************************
Applying the update for shift_i =   3.2312e+04     and shift_s =   3.2312e+05
*****************************************************************************

  Execution time = 2.3604e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758066e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874112e-03 3 1  ON 9
ci_011                -9.142764e-03 3 1  ON 10
ci_012                -9.120571e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117983e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080084e-03 3 1  ON 17
ci_019                 8.981727e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258521e-03 3 1  ON 21
ci_023                 8.361541e-03 3 1  ON 22
ci_024                 8.582869e-03 3 1  ON 23
ci_025                 8.594748e-03 3 1  ON 24
ci_026                 1.002846e-02 3 1  ON 25
ci_027                 9.639982e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563434e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554541e-03 3 1  ON 32
ci_034                 4.915656e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200284e-04 3 1  ON 37
ci_039                 1.223211e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255562e-03 3 1  ON 41
ci_043                -2.385623e-03 3 1  ON 42
ci_044                -3.921303e-03 3 1  ON 43
ci_045                -1.870137e-03 3 1  ON 44
ci_046                 4.771124e-03 3 1  ON 45
ci_047                 4.645479e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825096e-03 3 1  ON 49
ci_051                 2.816354e-03 3 1  ON 50
ci_052                -2.275405e-03 3 1  ON 51
ci_053                -2.208881e-03 3 1  ON 52
ci_054                -2.321112e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660693e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118580e-03 3 1  ON 58
ci_060                 4.730408e-03 3 1  ON 59
ci_061                 5.181168e-03 3 1  ON 60
ci_062                -2.828195e-03 3 1  ON 61
ci_063                -2.781434e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398024e-03 3 1  ON 64
ci_066                 4.063206e-03 3 1  ON 65
ci_067                 4.160693e-03 3 1  ON 66
ci_068                -4.398713e-03 3 1  ON 67
ci_069                -4.115095e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0796e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1747
    reference variance = 0.249371
====================================================
  Execution time = 1.4479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0136e-01
  Total weights = 1.957830919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286377525869
                                         uncertainty =       0.002559245970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286377525869
                                         uncertainty =       0.002559245970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378436195
  error estimate for blocks of size 2^( 2) =       0.000390077352
  error estimate for blocks of size 2^( 3) =       0.000399975539
  error estimate for blocks of size 2^( 4) =       0.000408656414
  error estimate for blocks of size 2^( 5) =       0.000413068408
  error estimate for blocks of size 2^( 6) =       0.000415744846
  error estimate for blocks of size 2^( 7) =       0.000417785323

      target function =      -0.910468239181
              le_mean =     -17.214552320153
             les_mean =     296.642176105930
             stat err =       0.000413813748
             autocorr =       1.195706238004
   target nu stat err =       0.000413813748
   target dn stat err =       0.003829797681
      target stat err =       0.005974087350
              std dev =       0.535189599417
             le_variance =       0.286427907325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721455232015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e+03, overlap shift 8.0779e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910506801771       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910506809180       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910506809979       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910506810211       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910506810239       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910506810229       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910506810246       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910506810233       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910506810233       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+03 is 1.936711e-08

solving harmonic davidson linear method for identity shift 3.2312e+04, overlap shift 3.2312e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910506801771       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910506803624       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910506803823       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910506803882       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910506803860       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910506803921       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910506803917       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910506803880       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910506803883       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+04 is 4.841813e-09

solving harmonic davidson linear method for identity shift 1.2925e+05, overlap shift 1.2925e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910506801771       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910506802234       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910506802284       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910506802299       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910506802175       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910506802319       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910506802158       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910506802278       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910506802453       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2925e+05 is 1.210455e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7008e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875737e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758067e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874114e-03 3 1  ON 9
ci_011                -9.142759e-03 3 1  ON 10
ci_012                -9.120568e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566983e-02 3 1  ON 16
ci_018                 9.080080e-03 3 1  ON 17
ci_019                 8.981728e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258520e-03 3 1  ON 21
ci_023                 8.361540e-03 3 1  ON 22
ci_024                 8.582870e-03 3 1  ON 23
ci_025                 8.594746e-03 3 1  ON 24
ci_026                 1.002845e-02 3 1  ON 25
ci_027                 9.639981e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563431e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554542e-03 3 1  ON 32
ci_034                 4.915657e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200294e-04 3 1  ON 37
ci_039                 1.223210e-03 3 1  ON 38
ci_040                -1.603056e-03 3 1  ON 39
ci_041                 8.180279e-03 3 1  ON 40
ci_042                 8.255563e-03 3 1  ON 41
ci_043                -2.385621e-03 3 1  ON 42
ci_044                -3.921301e-03 3 1  ON 43
ci_045                -1.870137e-03 3 1  ON 44
ci_046                 4.771124e-03 3 1  ON 45
ci_047                 4.645480e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825094e-03 3 1  ON 49
ci_051                 2.816357e-03 3 1  ON 50
ci_052                -2.275404e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321110e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660695e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118577e-03 3 1  ON 58
ci_060                 4.730410e-03 3 1  ON 59
ci_061                 5.181166e-03 3 1  ON 60
ci_062                -2.828194e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398022e-03 3 1  ON 64
ci_066                 4.063206e-03 3 1  ON 65
ci_067                 4.160694e-03 3 1  ON 66
ci_068                -4.398712e-03 3 1  ON 67
ci_069                -4.115098e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1489
    reference variance = 0.39728
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9892e-01
  Total weights = 1.9577e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053425160
                                         uncertainty =       0.001883977426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053425160
                                         uncertainty =       0.001883977426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378364582
  error estimate for blocks of size 2^( 2) =       0.000389566262
  error estimate for blocks of size 2^( 3) =       0.000399630945
  error estimate for blocks of size 2^( 4) =       0.000407729633
  error estimate for blocks of size 2^( 5) =       0.000411650611
  error estimate for blocks of size 2^( 6) =       0.000415664352
  error estimate for blocks of size 2^( 7) =       0.000417678900

      target function =      -0.914280915170
              le_mean =     -17.214986724933
             les_mean =     296.654688407839
             stat err =       0.000413180874
             autocorr =       1.192502963613
   target nu stat err =       0.000413180874
   target dn stat err =       0.002114421316
      target stat err =       0.003380021346
              std dev =       0.535088323998
             le_variance =       0.286319514479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053421443
                                         uncertainty =       0.001883976996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053421443
                                         uncertainty =       0.001883976996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378364580
  error estimate for blocks of size 2^( 2) =       0.000389566261
  error estimate for blocks of size 2^( 3) =       0.000399630945
  error estimate for blocks of size 2^( 4) =       0.000407729634
  error estimate for blocks of size 2^( 5) =       0.000411650613
  error estimate for blocks of size 2^( 6) =       0.000415664353
  error estimate for blocks of size 2^( 7) =       0.000417678901

      target function =      -0.914281013774
              le_mean =     -17.214986725387
             les_mean =     296.654688360405
             stat err =       0.000413180875
             autocorr =       1.192502985442
   target nu stat err =       0.000413180875
   target dn stat err =       0.002114419234
      target stat err =       0.003380018880
              std dev =       0.535088320332
             le_variance =       0.286319510556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053423302
                                         uncertainty =       0.001883977211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053423302
                                         uncertainty =       0.001883977211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378364581
  error estimate for blocks of size 2^( 2) =       0.000389566261
  error estimate for blocks of size 2^( 3) =       0.000399630945
  error estimate for blocks of size 2^( 4) =       0.000407729633
  error estimate for blocks of size 2^( 5) =       0.000411650612
  error estimate for blocks of size 2^( 6) =       0.000415664352
  error estimate for blocks of size 2^( 7) =       0.000417678901

      target function =      -0.914280964487
              le_mean =     -17.214986725160
             les_mean =     296.654688384112
             stat err =       0.000413180875
             autocorr =       1.192502974532
   target nu stat err =       0.000413180875
   target dn stat err =       0.002114420275
      target stat err =       0.003380020113
              std dev =       0.535088322165
             le_variance =       0.286319512517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053424928
                                         uncertainty =       0.001883977399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286053424928
                                         uncertainty =       0.001883977399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378364582
  error estimate for blocks of size 2^( 2) =       0.000389566262
  error estimate for blocks of size 2^( 3) =       0.000399630945
  error estimate for blocks of size 2^( 4) =       0.000407729633
  error estimate for blocks of size 2^( 5) =       0.000411650611
  error estimate for blocks of size 2^( 6) =       0.000415664352
  error estimate for blocks of size 2^( 7) =       0.000417678900

      target function =      -0.914280921336
              le_mean =     -17.214986724961
             les_mean =     296.654688404872
             stat err =       0.000413180874
             autocorr =       1.192502964977
   target nu stat err =       0.000413180874
   target dn stat err =       0.002114421185
      target stat err =       0.003380021192
              std dev =       0.535088323768
             le_variance =       0.286319514233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.914280915170        initial
     8.0779e+03     8.0779e+04             1.9367e-08        -0.914281013774  <--
     3.2312e+04     3.2312e+05             4.8418e-09        -0.914280964487
     1.2925e+05     1.2925e+06             1.2105e-09        -0.914280921336

*****************************************************************************
Applying the update for shift_i =   8.0779e+03     and shift_s =   8.0779e+04
*****************************************************************************

  Execution time = 2.3803e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080069e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563424e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915660e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200322e-04 3 1  ON 37
ci_039                 1.223207e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208874e-03 3 1  ON 52
ci_054                -2.321106e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181159e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2414
    reference variance = 0.197353
====================================================
  Execution time = 1.4637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0491e-01
  Total weights = 1.957581384e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290381975569
                                         uncertainty =       0.002355663838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290381975569
                                         uncertainty =       0.002355663838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381023372
  error estimate for blocks of size 2^( 2) =       0.000392538088
  error estimate for blocks of size 2^( 3) =       0.000402828905
  error estimate for blocks of size 2^( 4) =       0.000410256075
  error estimate for blocks of size 2^( 5) =       0.000414697144
  error estimate for blocks of size 2^( 6) =       0.000417777334
  error estimate for blocks of size 2^( 7) =       0.000417584047

      target function =      -0.904988030945
              le_mean =     -17.215069434361
             les_mean =     296.663528632730
             stat err =       0.000415078650
             autocorr =       1.186745404721
   target nu stat err =       0.000415078650
   target dn stat err =       0.003247024563
      target stat err =       0.005023482101
              std dev =       0.538848420095
             le_variance =       0.290357619839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721506943436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+03, overlap shift 2.0195e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905015054461       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905015085841       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905015090784       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905015092336       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905015092597       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905015092663       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905015092686       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905015092679       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905015092690       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905015092692       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+03 is 9.136149e-08

solving harmonic davidson linear method for identity shift 8.0779e+03, overlap shift 8.0779e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905015054461       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905015062306       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905015063542       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905015063930       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905015063999       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905015064008       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905015064015       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905015064019       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905015064018       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905015064014       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+03 is 2.284096e-08

solving harmonic davidson linear method for identity shift 3.2312e+04, overlap shift 3.2312e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905015054461       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905015056422       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905015056731       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905015056828       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905015056844       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905015056848       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905015056850       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905015056849       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905015056850       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905015056850       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+04 is 5.710277e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7176e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.762721e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155701e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758062e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874138e-03 3 1  ON 9
ci_011                -9.142737e-03 3 1  ON 10
ci_012                -9.120571e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117979e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080061e-03 3 1  ON 17
ci_019                 8.981726e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258512e-03 3 1  ON 21
ci_023                 8.361533e-03 3 1  ON 22
ci_024                 8.582885e-03 3 1  ON 23
ci_025                 8.594735e-03 3 1  ON 24
ci_026                 1.002843e-02 3 1  ON 25
ci_027                 9.639990e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500988e-02 3 1  ON 28
ci_030                -8.795527e-03 3 1  ON 29
ci_031                -8.563422e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554547e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348046e-03 3 1  ON 34
ci_036                -1.126184e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200298e-04 3 1  ON 37
ci_039                 1.223204e-03 3 1  ON 38
ci_040                -1.603054e-03 3 1  ON 39
ci_041                 8.180269e-03 3 1  ON 40
ci_042                 8.255558e-03 3 1  ON 41
ci_043                -2.385614e-03 3 1  ON 42
ci_044                -3.921285e-03 3 1  ON 43
ci_045                -1.870134e-03 3 1  ON 44
ci_046                 4.771116e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825078e-03 3 1  ON 49
ci_051                 2.816370e-03 3 1  ON 50
ci_052                -2.275404e-03 3 1  ON 51
ci_053                -2.208863e-03 3 1  ON 52
ci_054                -2.321104e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660694e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118554e-03 3 1  ON 58
ci_060                 4.730409e-03 3 1  ON 59
ci_061                 5.181153e-03 3 1  ON 60
ci_062                -2.828193e-03 3 1  ON 61
ci_063                -2.781435e-03 3 1  ON 62
ci_064                -2.213466e-03 3 1  ON 63
ci_065                -3.398021e-03 3 1  ON 64
ci_066                 4.063204e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398705e-03 3 1  ON 67
ci_069                -4.115109e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.3084
    reference variance = 0.747549
====================================================
  Execution time = 1.4302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0508e-01
  Total weights = 1.9578e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178503486
                                         uncertainty =       0.001672154879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178503486
                                         uncertainty =       0.001672154879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378920361
  error estimate for blocks of size 2^( 2) =       0.000390030658
  error estimate for blocks of size 2^( 3) =       0.000400248122
  error estimate for blocks of size 2^( 4) =       0.000407504544
  error estimate for blocks of size 2^( 5) =       0.000412572033
  error estimate for blocks of size 2^( 6) =       0.000416071213
  error estimate for blocks of size 2^( 7) =       0.000417193895

      target function =      -0.904752999474
              le_mean =     -17.214414498559
             les_mean =     296.641143112095
             stat err =       0.000413335421
             autocorr =       1.189896983231
   target nu stat err =       0.000413335421
   target dn stat err =       0.004282385265
      target stat err =       0.006586043502
              std dev =       0.535874313904
             le_variance =       0.287161280302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178474946
                                         uncertainty =       0.001672153211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178474946
                                         uncertainty =       0.001672153211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378920342
  error estimate for blocks of size 2^( 2) =       0.000390030644
  error estimate for blocks of size 2^( 3) =       0.000400248113
  error estimate for blocks of size 2^( 4) =       0.000407504538
  error estimate for blocks of size 2^( 5) =       0.000412572031
  error estimate for blocks of size 2^( 6) =       0.000416071210
  error estimate for blocks of size 2^( 7) =       0.000417193892

      target function =      -0.904752807479
              le_mean =     -17.214414496910
             les_mean =     296.641143179918
             stat err =       0.000413335418
             autocorr =       1.189897080823
   target nu stat err =       0.000413335418
   target dn stat err =       0.004282455831
      target stat err =       0.006586148017
              std dev =       0.535874287298
             le_variance =       0.287161251787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178489215
                                         uncertainty =       0.001672154045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178489215
                                         uncertainty =       0.001672154045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378920352
  error estimate for blocks of size 2^( 2) =       0.000390030651
  error estimate for blocks of size 2^( 3) =       0.000400248117
  error estimate for blocks of size 2^( 4) =       0.000407504541
  error estimate for blocks of size 2^( 5) =       0.000412572032
  error estimate for blocks of size 2^( 6) =       0.000416071212
  error estimate for blocks of size 2^( 7) =       0.000417193893

      target function =      -0.904752903490
              le_mean =     -17.214414497734
             les_mean =     296.641143145996
             stat err =       0.000413335420
             autocorr =       1.189897032034
   target nu stat err =       0.000413335420
   target dn stat err =       0.004282420549
      target stat err =       0.006586095760
              std dev =       0.535874300600
             le_variance =       0.287161266044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178501702
                                         uncertainty =       0.001672154775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287178501702
                                         uncertainty =       0.001672154775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378920360
  error estimate for blocks of size 2^( 2) =       0.000390030657
  error estimate for blocks of size 2^( 3) =       0.000400248121
  error estimate for blocks of size 2^( 4) =       0.000407504543
  error estimate for blocks of size 2^( 5) =       0.000412572033
  error estimate for blocks of size 2^( 6) =       0.000416071213
  error estimate for blocks of size 2^( 7) =       0.000417193895

      target function =      -0.904752987477
              le_mean =     -17.214414498456
             les_mean =     296.641143116332
             stat err =       0.000413335421
             autocorr =       1.189896989332
   target nu stat err =       0.000413335421
   target dn stat err =       0.004282389676
      target stat err =       0.006586050034
              std dev =       0.535874312241
             le_variance =       0.287161278520


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904752999474        initial  <--
     2.0195e+03     2.0195e+04             9.1361e-08        -0.904752807479
     8.0779e+03     8.0779e+04             2.2841e-08        -0.904752903490
     3.2312e+04     3.2312e+05             5.7103e-09        -0.904752987477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7071
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080069e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563424e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915660e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200322e-04 3 1  ON 37
ci_039                 1.223207e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208874e-03 3 1  ON 52
ci_054                -2.321106e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181159e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.3224
    reference variance = 0.288585
====================================================
  Execution time = 1.4558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0106e-01
  Total weights = 1.957398866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.1910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288358114808
                                         uncertainty =       0.001864006043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288358114808
                                         uncertainty =       0.001864006043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379641335
  error estimate for blocks of size 2^( 2) =       0.000391008347
  error estimate for blocks of size 2^( 3) =       0.000401173820
  error estimate for blocks of size 2^( 4) =       0.000409042720
  error estimate for blocks of size 2^( 5) =       0.000414313783
  error estimate for blocks of size 2^( 6) =       0.000414515328
  error estimate for blocks of size 2^( 7) =       0.000416046687

      target function =      -0.910956157234
              le_mean =     -17.214594260982
             les_mean =     296.643319939123
             stat err =       0.000413479629
             autocorr =       1.186209102546
   target nu stat err =       0.000413479629
   target dn stat err =       0.002347916901
      target stat err =       0.003708484559
              std dev =       0.536893924961
             le_variance =       0.288255086660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721459426098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+04, overlap shift 2.0195e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910970222374       residual = 5.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910970223563       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910970223727       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910970223767       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910970223778       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910970223772       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910970223751       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910970223805       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910970223813       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910970223771       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+04 is 5.656524e-09

solving harmonic davidson linear method for identity shift 8.0779e+04, overlap shift 8.0779e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910970222374       residual = 5.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910970222671       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910970222712       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910970222722       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910970222931       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910970222687       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910970222764       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910970222731       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910970222696       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910970222678       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+04 is 1.414135e-09

solving harmonic davidson linear method for identity shift 3.2312e+05, overlap shift 3.2312e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910970222374       residual = 5.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910970222448       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910970222458       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910970222461       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910970222467       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910970223032       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910970222487       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910970222047       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910970222243       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910970222120       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+05 is 3.535338e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8858e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758068e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874118e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080069e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361537e-03 3 1  ON 22
ci_024                 8.582872e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563424e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348048e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200321e-04 3 1  ON 37
ci_039                 1.223207e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180275e-03 3 1  ON 40
ci_042                 8.255565e-03 3 1  ON 41
ci_043                -2.385616e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771121e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275401e-03 3 1  ON 51
ci_053                -2.208874e-03 3 1  ON 52
ci_054                -2.321105e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730417e-03 3 1  ON 59
ci_061                 5.181159e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781430e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063209e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398707e-03 3 1  ON 67
ci_069                -4.115108e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.303622
====================================================
  Execution time = 1.4543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0064e-01
  Total weights = 1.9574e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653883
                                         uncertainty =       0.001735292808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653883
                                         uncertainty =       0.001735292808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379221343
  error estimate for blocks of size 2^( 2) =       0.000391132359
  error estimate for blocks of size 2^( 3) =       0.000401636441
  error estimate for blocks of size 2^( 4) =       0.000409329226
  error estimate for blocks of size 2^( 5) =       0.000413775887
  error estimate for blocks of size 2^( 6) =       0.000416770311
  error estimate for blocks of size 2^( 7) =       0.000419578359

      target function =      -0.911601709585
              le_mean =     -17.214942667414
             les_mean =     296.654886820769
             stat err =       0.000414863446
             autocorr =       1.196808861772
   target nu stat err =       0.000414863446
   target dn stat err =       0.002707374087
      target stat err =       0.004266244780
              std dev =       0.536299966933
             le_variance =       0.287617654532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653754
                                         uncertainty =       0.001735292800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653754
                                         uncertainty =       0.001735292800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379221343
  error estimate for blocks of size 2^( 2) =       0.000391132359
  error estimate for blocks of size 2^( 3) =       0.000401636442
  error estimate for blocks of size 2^( 4) =       0.000409329227
  error estimate for blocks of size 2^( 5) =       0.000413775888
  error estimate for blocks of size 2^( 6) =       0.000416770313
  error estimate for blocks of size 2^( 7) =       0.000419578361

      target function =      -0.911601695486
              le_mean =     -17.214942667492
             les_mean =     296.654886832523
             stat err =       0.000414863447
             autocorr =       1.196808870154
   target nu stat err =       0.000414863447
   target dn stat err =       0.002707374753
      target stat err =       0.004266245670
              std dev =       0.536299966806
             le_variance =       0.287617654396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653818
                                         uncertainty =       0.001735292804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653818
                                         uncertainty =       0.001735292804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379221343
  error estimate for blocks of size 2^( 2) =       0.000391132359
  error estimate for blocks of size 2^( 3) =       0.000401636442
  error estimate for blocks of size 2^( 4) =       0.000409329227
  error estimate for blocks of size 2^( 5) =       0.000413775888
  error estimate for blocks of size 2^( 6) =       0.000416770312
  error estimate for blocks of size 2^( 7) =       0.000419578360

      target function =      -0.911601702535
              le_mean =     -17.214942667453
             les_mean =     296.654886826646
             stat err =       0.000414863447
             autocorr =       1.196808865963
   target nu stat err =       0.000414863447
   target dn stat err =       0.002707374420
      target stat err =       0.004266245225
              std dev =       0.536299966869
             le_variance =       0.287617654464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653875
                                         uncertainty =       0.001735292807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287639653875
                                         uncertainty =       0.001735292807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379221343
  error estimate for blocks of size 2^( 2) =       0.000391132359
  error estimate for blocks of size 2^( 3) =       0.000401636441
  error estimate for blocks of size 2^( 4) =       0.000409329226
  error estimate for blocks of size 2^( 5) =       0.000413775887
  error estimate for blocks of size 2^( 6) =       0.000416770312
  error estimate for blocks of size 2^( 7) =       0.000419578359

      target function =      -0.911601708704
              le_mean =     -17.214942667419
             les_mean =     296.654886821504
             stat err =       0.000414863446
             autocorr =       1.196808862292
   target nu stat err =       0.000414863446
   target dn stat err =       0.002707374129
      target stat err =       0.004266244835
              std dev =       0.536299966925
             le_variance =       0.287617654524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911601709585        initial  <--
     2.0195e+04     2.0195e+05             5.6565e-09        -0.911601695486
     8.0779e+04     8.0779e+05             1.4141e-09        -0.911601702535
     3.2312e+05     3.2312e+06             3.5353e-10        -0.911601708704

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0347
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080069e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563424e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915660e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200322e-04 3 1  ON 37
ci_039                 1.223207e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208874e-03 3 1  ON 52
ci_054                -2.321106e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181159e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1291
    reference variance = 0.468842
====================================================
  Execution time = 1.4589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0203e-01
  Total weights = 1.957704146e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286598977810
                                         uncertainty =       0.001638421752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286598977810
                                         uncertainty =       0.001638421752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378523710
  error estimate for blocks of size 2^( 2) =       0.000389944245
  error estimate for blocks of size 2^( 3) =       0.000400488776
  error estimate for blocks of size 2^( 4) =       0.000408332548
  error estimate for blocks of size 2^( 5) =       0.000412647414
  error estimate for blocks of size 2^( 6) =       0.000414915277
  error estimate for blocks of size 2^( 7) =       0.000413818082

      target function =      -0.909431436931
              le_mean =     -17.214721153048
             les_mean =     296.648653714772
             stat err =       0.000412428330
             autocorr =       1.187164234555
   target nu stat err =       0.000412428330
   target dn stat err =       0.003866269324
      target stat err =       0.006018187488
              std dev =       0.535313364055
             le_variance =       0.286560397736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721472115305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+05, overlap shift 2.0195e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470439254       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909470439630       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909470439663       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909470439696       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909470439655       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909470439485       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909470439330       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909470439762       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909470439678       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909470439678       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+05 is 7.264371e-10

solving harmonic davidson linear method for identity shift 8.0779e+05, overlap shift 8.0779e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470439254       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909470439348       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909470439356       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909470439395       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909470439421       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909470436525       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909470438670       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909470437802       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909470439662       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909470439479       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+05 is 1.816093e-10

solving harmonic davidson linear method for identity shift 3.2312e+06, overlap shift 3.2312e+07 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909470439254       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909470439277       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909470439279       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909470440496       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909470437632       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909470437793       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909470438515       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909470442049       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909470439909       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909470435033       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.2312e+06 is 4.540232e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378635 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7144e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080069e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795525e-03 3 1  ON 29
ci_031                -8.563424e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915660e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200321e-04 3 1  ON 37
ci_039                 1.223207e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645484e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208873e-03 3 1  ON 52
ci_054                -2.321105e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181159e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.0904
    reference variance = 1.23989
====================================================
  Execution time = 1.4646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0304e-01
  Total weights = 1.9577e+06
  Execution time = 1.8660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481676
                                         uncertainty =       0.002405291698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481676
                                         uncertainty =       0.002405291698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379506877
  error estimate for blocks of size 2^( 2) =       0.000390564166
  error estimate for blocks of size 2^( 3) =       0.000400680425
  error estimate for blocks of size 2^( 4) =       0.000409251145
  error estimate for blocks of size 2^( 5) =       0.000413755943
  error estimate for blocks of size 2^( 6) =       0.000415635280
  error estimate for blocks of size 2^( 7) =       0.000416355270

      target function =      -0.907868259039
              le_mean =     -17.214678622607
             les_mean =     296.648204110510
             stat err =       0.000413749409
             autocorr =       1.188599307359
   target nu stat err =       0.000413749409
   target dn stat err =       0.003871985081
      target stat err =       0.006006182002
              std dev =       0.536703772651
             le_variance =       0.288050939578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481652
                                         uncertainty =       0.002405291690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481652
                                         uncertainty =       0.002405291690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379506877
  error estimate for blocks of size 2^( 2) =       0.000390564166
  error estimate for blocks of size 2^( 3) =       0.000400680425
  error estimate for blocks of size 2^( 4) =       0.000409251145
  error estimate for blocks of size 2^( 5) =       0.000413755943
  error estimate for blocks of size 2^( 6) =       0.000415635280
  error estimate for blocks of size 2^( 7) =       0.000416355270

      target function =      -0.907868259837
              le_mean =     -17.214678622603
             les_mean =     296.648204109845
             stat err =       0.000413749409
             autocorr =       1.188599307984
   target nu stat err =       0.000413749409
   target dn stat err =       0.003871984925
      target stat err =       0.006006181774
              std dev =       0.536703772628
             le_variance =       0.288050939553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481664
                                         uncertainty =       0.002405291694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481664
                                         uncertainty =       0.002405291694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379506877
  error estimate for blocks of size 2^( 2) =       0.000390564166
  error estimate for blocks of size 2^( 3) =       0.000400680425
  error estimate for blocks of size 2^( 4) =       0.000409251145
  error estimate for blocks of size 2^( 5) =       0.000413755943
  error estimate for blocks of size 2^( 6) =       0.000415635280
  error estimate for blocks of size 2^( 7) =       0.000416355270

      target function =      -0.907868259438
              le_mean =     -17.214678622605
             les_mean =     296.648204110177
             stat err =       0.000413749409
             autocorr =       1.188599307674
   target nu stat err =       0.000413749409
   target dn stat err =       0.003871985003
      target stat err =       0.006006181888
              std dev =       0.536703772640
             le_variance =       0.288050939566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481674
                                         uncertainty =       0.002405291698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288075481674
                                         uncertainty =       0.002405291698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379506877
  error estimate for blocks of size 2^( 2) =       0.000390564166
  error estimate for blocks of size 2^( 3) =       0.000400680425
  error estimate for blocks of size 2^( 4) =       0.000409251145
  error estimate for blocks of size 2^( 5) =       0.000413755943
  error estimate for blocks of size 2^( 6) =       0.000415635280
  error estimate for blocks of size 2^( 7) =       0.000416355270

      target function =      -0.907868259089
              le_mean =     -17.214678622607
             les_mean =     296.648204110468
             stat err =       0.000413749409
             autocorr =       1.188599307398
   target nu stat err =       0.000413749409
   target dn stat err =       0.003871985071
      target stat err =       0.006006181987
              std dev =       0.536703772649
             le_variance =       0.288050939576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907868259039        initial
     2.0195e+05     2.0195e+06             7.2644e-10        -0.907868259837  <--
     8.0779e+05     8.0779e+06             1.8161e-10        -0.907868259438
     3.2312e+06     3.2312e+07             4.5402e-11        -0.907868259089

*****************************************************************************
Applying the update for shift_i =   2.0195e+05     and shift_s =   2.0195e+06
*****************************************************************************

  Execution time = 2.4084e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847779e-02 3 1  ON 6
ci_008                -7.758069e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142746e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080070e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258520e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563423e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915660e-03 3 1  ON 33
ci_035                -3.348049e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200320e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645485e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208873e-03 3 1  ON 52
ci_054                -2.321105e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044637e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181158e-03 3 1  ON 60
ci_062                -2.828191e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398707e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.172565
====================================================
  Execution time = 1.4470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9914e-01
  Total weights = 1.957507133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287427752490
                                         uncertainty =       0.001876176557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287427752490
                                         uncertainty =       0.001876176557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379110771
  error estimate for blocks of size 2^( 2) =       0.000390280818
  error estimate for blocks of size 2^( 3) =       0.000400151297
  error estimate for blocks of size 2^( 4) =       0.000408190791
  error estimate for blocks of size 2^( 5) =       0.000413681377
  error estimate for blocks of size 2^( 6) =       0.000416687636
  error estimate for blocks of size 2^( 7) =       0.000420570888

      target function =      -0.913950935216
              le_mean =     -17.214299711214
             les_mean =     296.631259102904
             stat err =       0.000414782673
             autocorr =       1.197040832844
   target nu stat err =       0.000414782673
   target dn stat err =       0.002570537831
      target stat err =       0.004072386754
              std dev =       0.536143593942
             le_variance =       0.287449953325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429971121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+04, overlap shift 5.0487e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913968060514       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913968061125       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913968061208       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913968061236       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913968061196       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913968061241       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913968061250       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913968061164       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913968061175       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+04 is 2.617650e-09

solving harmonic davidson linear method for identity shift 2.0195e+05, overlap shift 2.0195e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913968060514       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913968060667       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913968060688       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913968060696       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913968060776       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913968060940       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913968060470       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913968060631       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913968060765       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+05 is 6.544132e-10

solving harmonic davidson linear method for identity shift 8.0779e+05, overlap shift 8.0779e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913968060514       residual = 8.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913968060553       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913968060558       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913968060559       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913968060560       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913968060840       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913968060560       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913968060594       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913968060547       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.0779e+05 is 1.636033e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7014e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758068e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874119e-03 3 1  ON 9
ci_011                -9.142745e-03 3 1  ON 10
ci_012                -9.120559e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080070e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594738e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639980e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563423e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554543e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348048e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200320e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255566e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921294e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645485e-03 3 1  ON 46
ci_048                -1.242642e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816364e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208873e-03 3 1  ON 52
ci_054                -2.321105e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118570e-03 3 1  ON 58
ci_060                 4.730416e-03 3 1  ON 59
ci_061                 5.181158e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160695e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.391539
====================================================
  Execution time = 1.4243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9948e-01
  Total weights = 1.9576e+06
  Execution time = 1.8643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785609
                                         uncertainty =       0.001958180639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785609
                                         uncertainty =       0.001958180639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854774
  error estimate for blocks of size 2^( 2) =       0.000390292920
  error estimate for blocks of size 2^( 3) =       0.000400616452
  error estimate for blocks of size 2^( 4) =       0.000407650734
  error estimate for blocks of size 2^( 5) =       0.000412802388
  error estimate for blocks of size 2^( 6) =       0.000415287049
  error estimate for blocks of size 2^( 7) =       0.000418303853

      target function =      -0.913425881032
              le_mean =     -17.214138856302
             les_mean =     296.626060356226
             stat err =       0.000413511006
             autocorr =       1.191320508906
   target nu stat err =       0.000413511006
   target dn stat err =       0.002702616646
      target stat err =       0.004268982636
              std dev =       0.535781559538
             le_variance =       0.287061879541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785334
                                         uncertainty =       0.001958180607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785334
                                         uncertainty =       0.001958180607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854774
  error estimate for blocks of size 2^( 2) =       0.000390292920
  error estimate for blocks of size 2^( 3) =       0.000400616452
  error estimate for blocks of size 2^( 4) =       0.000407650734
  error estimate for blocks of size 2^( 5) =       0.000412802388
  error estimate for blocks of size 2^( 6) =       0.000415287049
  error estimate for blocks of size 2^( 7) =       0.000418303853

      target function =      -0.913425885421
              le_mean =     -17.214138856286
             les_mean =     296.626060352856
             stat err =       0.000413511006
             autocorr =       1.191320510322
   target nu stat err =       0.000413511006
   target dn stat err =       0.002702616108
      target stat err =       0.004268981851
              std dev =       0.535781559279
             le_variance =       0.287061879263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785472
                                         uncertainty =       0.001958180623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785472
                                         uncertainty =       0.001958180623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854774
  error estimate for blocks of size 2^( 2) =       0.000390292920
  error estimate for blocks of size 2^( 3) =       0.000400616452
  error estimate for blocks of size 2^( 4) =       0.000407650734
  error estimate for blocks of size 2^( 5) =       0.000412802388
  error estimate for blocks of size 2^( 6) =       0.000415287049
  error estimate for blocks of size 2^( 7) =       0.000418303853

      target function =      -0.913425883227
              le_mean =     -17.214138856294
             les_mean =     296.626060354541
             stat err =       0.000413511006
             autocorr =       1.191320509613
   target nu stat err =       0.000413511006
   target dn stat err =       0.002702616377
      target stat err =       0.004268982244
              std dev =       0.535781559409
             le_variance =       0.287061879402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785592
                                         uncertainty =       0.001958180637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985785592
                                         uncertainty =       0.001958180637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378854774
  error estimate for blocks of size 2^( 2) =       0.000390292920
  error estimate for blocks of size 2^( 3) =       0.000400616452
  error estimate for blocks of size 2^( 4) =       0.000407650734
  error estimate for blocks of size 2^( 5) =       0.000412802388
  error estimate for blocks of size 2^( 6) =       0.000415287049
  error estimate for blocks of size 2^( 7) =       0.000418303853

      target function =      -0.913425881306
              le_mean =     -17.214138856301
             les_mean =     296.626060356015
             stat err =       0.000413511006
             autocorr =       1.191320508988
   target nu stat err =       0.000413511006
   target dn stat err =       0.002702616612
      target stat err =       0.004268982587
              std dev =       0.535781559522
             le_variance =       0.287061879524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913425881032        initial
     5.0487e+04     5.0487e+05             2.6177e-09        -0.913425885421  <--
     2.0195e+05     2.0195e+06             6.5441e-10        -0.913425883227
     8.0779e+05     8.0779e+06             1.6360e-10        -0.913425881306

*****************************************************************************
Applying the update for shift_i =   5.0487e+04     and shift_s =   5.0487e+05
*****************************************************************************

  Execution time = 2.3767e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758068e-03 3 1  ON 7
ci_009                -1.401798e-02 3 1  ON 8
ci_010                -8.874118e-03 3 1  ON 9
ci_011                -9.142745e-03 3 1  ON 10
ci_012                -9.120560e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080070e-03 3 1  ON 17
ci_019                 8.981730e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258518e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582873e-03 3 1  ON 23
ci_025                 8.594737e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639979e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795524e-03 3 1  ON 29
ci_031                -8.563423e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554544e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348048e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200320e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180275e-03 3 1  ON 40
ci_042                 8.255567e-03 3 1  ON 41
ci_043                -2.385616e-03 3 1  ON 42
ci_044                -3.921295e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645485e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816365e-03 3 1  ON 50
ci_052                -2.275402e-03 3 1  ON 51
ci_053                -2.208874e-03 3 1  ON 52
ci_054                -2.321105e-03 3 1  ON 53
ci_055                -2.375176e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044635e-03 3 1  ON 57
ci_059                -2.118569e-03 3 1  ON 58
ci_060                 4.730418e-03 3 1  ON 59
ci_061                 5.181157e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213470e-03 3 1  ON 63
ci_065                -3.398019e-03 3 1  ON 64
ci_066                 4.063208e-03 3 1  ON 65
ci_067                 4.160696e-03 3 1  ON 66
ci_068                -4.398705e-03 3 1  ON 67
ci_069                -4.115108e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2796
    reference variance = 0.182966
====================================================
  Execution time = 1.4531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0239e-01
  Total weights = 1.957631959e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288190722831
                                         uncertainty =       0.001607893693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288190722831
                                         uncertainty =       0.001607893693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379608240
  error estimate for blocks of size 2^( 2) =       0.000391135996
  error estimate for blocks of size 2^( 3) =       0.000401923508
  error estimate for blocks of size 2^( 4) =       0.000409633879
  error estimate for blocks of size 2^( 5) =       0.000413953782
  error estimate for blocks of size 2^( 6) =       0.000416501256
  error estimate for blocks of size 2^( 7) =       0.000418131585

      target function =      -0.908885471710
              le_mean =     -17.214800846271
             les_mean =     296.651761799644
             stat err =       0.000414555125
             autocorr =       1.192595908824
   target nu stat err =       0.000414555125
   target dn stat err =       0.002675279832
      target stat err =       0.004191126309
              std dev =       0.536847121666
             le_variance =       0.288204832041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721480084627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+04, overlap shift 1.2622e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908903853427       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908903858054       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908903858749       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908903858898       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908903858946       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908903858964       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908903858923       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908903858958       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908903858950       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908903858961       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+04 is 1.662847e-08

solving harmonic davidson linear method for identity shift 5.0487e+04, overlap shift 5.0487e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908903853427       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908903854584       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908903854758       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908903854795       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908903854742       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908903854881       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908903854807       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908903854838       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908903854805       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908903854860       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+04 is 4.157135e-09

solving harmonic davidson linear method for identity shift 2.0195e+05, overlap shift 2.0195e+06 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908903853427       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908903853716       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908903853760       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908903853770       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908903853745       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908903853697       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908903854074       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908903853485       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908903853814       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908903853952       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.0195e+05 is 1.039285e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7080e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.762722e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367612e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758067e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874120e-03 3 1  ON 9
ci_011                -9.142744e-03 3 1  ON 10
ci_012                -9.120556e-03 3 1  ON 11
ci_013                -1.923572e-02 3 1  ON 12
ci_014                 1.117982e-02 3 1  ON 13
ci_015                 1.103413e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080070e-03 3 1  ON 17
ci_019                 8.981730e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258518e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582874e-03 3 1  ON 23
ci_025                 8.594735e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639981e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795521e-03 3 1  ON 29
ci_031                -8.563423e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554544e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348048e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200313e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603055e-03 3 1  ON 39
ci_041                 8.180276e-03 3 1  ON 40
ci_042                 8.255569e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921292e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771122e-03 3 1  ON 45
ci_047                 4.645483e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825088e-03 3 1  ON 49
ci_051                 2.816365e-03 3 1  ON 50
ci_052                -2.275403e-03 3 1  ON 51
ci_053                -2.208876e-03 3 1  ON 52
ci_054                -2.321104e-03 3 1  ON 53
ci_055                -2.375177e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675273e-03 3 1  ON 56
ci_058                -2.044635e-03 3 1  ON 57
ci_059                -2.118569e-03 3 1  ON 58
ci_060                 4.730418e-03 3 1  ON 59
ci_061                 5.181155e-03 3 1  ON 60
ci_062                -2.828192e-03 3 1  ON 61
ci_063                -2.781431e-03 3 1  ON 62
ci_064                -2.213469e-03 3 1  ON 63
ci_065                -3.398018e-03 3 1  ON 64
ci_066                 4.063207e-03 3 1  ON 65
ci_067                 4.160697e-03 3 1  ON 66
ci_068                -4.398706e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.245095
====================================================
  Execution time = 1.4451e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9790e-01
  Total weights = 1.9576e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732539403
                                         uncertainty =       0.001967624147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732539403
                                         uncertainty =       0.001967624147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378624617
  error estimate for blocks of size 2^( 2) =       0.000390211967
  error estimate for blocks of size 2^( 3) =       0.000400926851
  error estimate for blocks of size 2^( 4) =       0.000408569820
  error estimate for blocks of size 2^( 5) =       0.000412761935
  error estimate for blocks of size 2^( 6) =       0.000415723905
  error estimate for blocks of size 2^( 7) =       0.000417354833

      target function =      -0.915880101992
              le_mean =     -17.215054838769
             les_mean =     296.656009846259
             stat err =       0.000413602623
             autocorr =       1.193297895828
   target nu stat err =       0.000413602623
   target dn stat err =       0.002233415063
      target stat err =       0.003574973271
              std dev =       0.535456068370
             le_variance =       0.286713201154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732537136
                                         uncertainty =       0.001967623620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732537136
                                         uncertainty =       0.001967623620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378624615
  error estimate for blocks of size 2^( 2) =       0.000390211966
  error estimate for blocks of size 2^( 3) =       0.000400926850
  error estimate for blocks of size 2^( 4) =       0.000408569820
  error estimate for blocks of size 2^( 5) =       0.000412761935
  error estimate for blocks of size 2^( 6) =       0.000415723906
  error estimate for blocks of size 2^( 7) =       0.000417354834

      target function =      -0.915880113660
              le_mean =     -17.215054838723
             les_mean =     296.656009837229
             stat err =       0.000413602624
             autocorr =       1.193297908604
   target nu stat err =       0.000413602624
   target dn stat err =       0.002233414062
      target stat err =       0.003574971822
              std dev =       0.535456066249
             le_variance =       0.286713198883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732538270
                                         uncertainty =       0.001967623884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732538270
                                         uncertainty =       0.001967623884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378624616
  error estimate for blocks of size 2^( 2) =       0.000390211966
  error estimate for blocks of size 2^( 3) =       0.000400926851
  error estimate for blocks of size 2^( 4) =       0.000408569820
  error estimate for blocks of size 2^( 5) =       0.000412761935
  error estimate for blocks of size 2^( 6) =       0.000415723905
  error estimate for blocks of size 2^( 7) =       0.000417354833

      target function =      -0.915880107841
              le_mean =     -17.215054838746
             les_mean =     296.656009841735
             stat err =       0.000413602623
             autocorr =       1.193297902216
   target nu stat err =       0.000413602623
   target dn stat err =       0.002233414562
      target stat err =       0.003574972547
              std dev =       0.535456067310
             le_variance =       0.286713200019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732539261
                                         uncertainty =       0.001967624114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286732539261
                                         uncertainty =       0.001967624114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378624617
  error estimate for blocks of size 2^( 2) =       0.000390211967
  error estimate for blocks of size 2^( 3) =       0.000400926851
  error estimate for blocks of size 2^( 4) =       0.000408569820
  error estimate for blocks of size 2^( 5) =       0.000412761935
  error estimate for blocks of size 2^( 6) =       0.000415723905
  error estimate for blocks of size 2^( 7) =       0.000417354833

      target function =      -0.915880102725
              le_mean =     -17.215054838766
             les_mean =     296.656009845692
             stat err =       0.000413602623
             autocorr =       1.193297896625
   target nu stat err =       0.000413602623
   target dn stat err =       0.002233415000
      target stat err =       0.003574973181
              std dev =       0.535456068237
             le_variance =       0.286713201012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915880101992        initial
     1.2622e+04     1.2622e+05             1.6628e-08        -0.915880113660  <--
     5.0487e+04     5.0487e+05             4.1571e-09        -0.915880107841
     2.0195e+05     2.0195e+06             1.0393e-09        -0.915880102725

*****************************************************************************
Applying the update for shift_i =   1.2622e+04     and shift_s =   1.2622e+05
*****************************************************************************

  Execution time = 2.3927e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.762721e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367611e-02 3 1  ON 2
ci_004                 2.096109e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849764e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758065e-03 3 1  ON 7
ci_009                -1.401797e-02 3 1  ON 8
ci_010                -8.874123e-03 3 1  ON 9
ci_011                -9.142742e-03 3 1  ON 10
ci_012                -9.120543e-03 3 1  ON 11
ci_013                -1.923571e-02 3 1  ON 12
ci_014                 1.117981e-02 3 1  ON 13
ci_015                 1.103412e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080070e-03 3 1  ON 17
ci_019                 8.981728e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258519e-03 3 1  ON 21
ci_023                 8.361538e-03 3 1  ON 22
ci_024                 8.582875e-03 3 1  ON 23
ci_025                 8.594728e-03 3 1  ON 24
ci_026                 1.002844e-02 3 1  ON 25
ci_027                 9.639986e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500986e-02 3 1  ON 28
ci_030                -8.795511e-03 3 1  ON 29
ci_031                -8.563421e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554545e-03 3 1  ON 32
ci_034                 4.915659e-03 3 1  ON 33
ci_035                -3.348047e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150767e-02 3 1  ON 36
ci_038                 9.200293e-04 3 1  ON 37
ci_039                 1.223208e-03 3 1  ON 38
ci_040                -1.603057e-03 3 1  ON 39
ci_041                 8.180280e-03 3 1  ON 40
ci_042                 8.255574e-03 3 1  ON 41
ci_043                -2.385617e-03 3 1  ON 42
ci_044                -3.921283e-03 3 1  ON 43
ci_045                -1.870136e-03 3 1  ON 44
ci_046                 4.771123e-03 3 1  ON 45
ci_047                 4.645480e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288199e-02 3 1  ON 48
ci_050                 2.825087e-03 3 1  ON 49
ci_051                 2.816366e-03 3 1  ON 50
ci_052                -2.275406e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321102e-03 3 1  ON 53
ci_055                -2.375178e-03 3 1  ON 54
ci_056                 4.660701e-03 3 1  ON 55
ci_057                 4.675276e-03 3 1  ON 56
ci_058                -2.044636e-03 3 1  ON 57
ci_059                -2.118567e-03 3 1  ON 58
ci_060                 4.730418e-03 3 1  ON 59
ci_061                 5.181148e-03 3 1  ON 60
ci_062                -2.828191e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213468e-03 3 1  ON 63
ci_065                -3.398017e-03 3 1  ON 64
ci_066                 4.063206e-03 3 1  ON 65
ci_067                 4.160699e-03 3 1  ON 66
ci_068                -4.398710e-03 3 1  ON 67
ci_069                -4.115107e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2063
    reference variance = 0.16567
====================================================
  Execution time = 1.4865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0148e-01
  Total weights = 1.957824133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981495342
                                         uncertainty =       0.003042943765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287981495342
                                         uncertainty =       0.003042943765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379494230
  error estimate for blocks of size 2^( 2) =       0.000391031102
  error estimate for blocks of size 2^( 3) =       0.000401611473
  error estimate for blocks of size 2^( 4) =       0.000409955264
  error estimate for blocks of size 2^( 5) =       0.000414994005
  error estimate for blocks of size 2^( 6) =       0.000418323951
  error estimate for blocks of size 2^( 7) =       0.000418250510

      target function =      -0.910273025228
              le_mean =     -17.214471456929
             les_mean =     296.639511101735
             stat err =       0.000415380932
             autocorr =       1.198071563711
   target nu stat err =       0.000415380932
   target dn stat err =       0.004481408913
      target stat err =       0.006973779865
              std dev =       0.536685886523
             le_variance =       0.288031740793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721447145693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.1554e+03, overlap shift 3.1554e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910325957616       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910325994103       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910325999012       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910326000039       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910326000116       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910326000155       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910326000172       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910326000171       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910326000173       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910326000172       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.1554e+03 is 5.718992e-08

solving harmonic davidson linear method for identity shift 1.2622e+04, overlap shift 1.2622e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910325957616       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910325966738       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910325967965       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910325968220       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910325968230       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910325968249       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910325968266       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910325968273       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910325968257       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910325968284       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+04 is 1.429775e-08

solving harmonic davidson linear method for identity shift 5.0487e+04, overlap shift 5.0487e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910325957616       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910325959897       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910325960203       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910325960272       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910325960263       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910325960224       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910325960274       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910325960321       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910325960311       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910325960146       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.0487e+04 is 3.574454e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7400e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.762721e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367610e-02 3 1  ON 2
ci_004                 2.096108e-02 3 1  ON 3
ci_005                 2.155702e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847778e-02 3 1  ON 6
ci_008                -7.758070e-03 3 1  ON 7
ci_009                -1.401796e-02 3 1  ON 8
ci_010                -8.874133e-03 3 1  ON 9
ci_011                -9.142733e-03 3 1  ON 10
ci_012                -9.120533e-03 3 1  ON 11
ci_013                -1.923571e-02 3 1  ON 12
ci_014                 1.117980e-02 3 1  ON 13
ci_015                 1.103412e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080075e-03 3 1  ON 17
ci_019                 8.981729e-03 3 1  ON 18
ci_020                 1.506480e-02 3 1  ON 19
ci_021                 1.519143e-02 3 1  ON 20
ci_022                 8.258518e-03 3 1  ON 21
ci_023                 8.361535e-03 3 1  ON 22
ci_024                 8.582878e-03 3 1  ON 23
ci_025                 8.594720e-03 3 1  ON 24
ci_026                 1.002845e-02 3 1  ON 25
ci_027                 9.639985e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500987e-02 3 1  ON 28
ci_030                -8.795509e-03 3 1  ON 29
ci_031                -8.563414e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554539e-03 3 1  ON 32
ci_034                 4.915656e-03 3 1  ON 33
ci_035                -3.348047e-03 3 1  ON 34
ci_036                -1.126183e-02 3 1  ON 35
ci_037                -1.150768e-02 3 1  ON 36
ci_038                 9.200297e-04 3 1  ON 37
ci_039                 1.223205e-03 3 1  ON 38
ci_040                -1.603042e-03 3 1  ON 39
ci_041                 8.180284e-03 3 1  ON 40
ci_042                 8.255567e-03 3 1  ON 41
ci_043                -2.385615e-03 3 1  ON 42
ci_044                -3.921283e-03 3 1  ON 43
ci_045                -1.870138e-03 3 1  ON 44
ci_046                 4.771119e-03 3 1  ON 45
ci_047                 4.645480e-03 3 1  ON 46
ci_048                -1.242643e-02 3 1  ON 47
ci_049                -1.288200e-02 3 1  ON 48
ci_050                 2.825081e-03 3 1  ON 49
ci_051                 2.816374e-03 3 1  ON 50
ci_052                -2.275408e-03 3 1  ON 51
ci_053                -2.208879e-03 3 1  ON 52
ci_054                -2.321102e-03 3 1  ON 53
ci_055                -2.375179e-03 3 1  ON 54
ci_056                 4.660696e-03 3 1  ON 55
ci_057                 4.675278e-03 3 1  ON 56
ci_058                -2.044640e-03 3 1  ON 57
ci_059                -2.118566e-03 3 1  ON 58
ci_060                 4.730417e-03 3 1  ON 59
ci_061                 5.181154e-03 3 1  ON 60
ci_062                -2.828190e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213475e-03 3 1  ON 63
ci_065                -3.398016e-03 3 1  ON 64
ci_066                 4.063202e-03 3 1  ON 65
ci_067                 4.160699e-03 3 1  ON 66
ci_068                -4.398711e-03 3 1  ON 67
ci_069                -4.115117e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.139
    reference variance = 0.187689
====================================================
  Execution time = 1.4302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0110e-01
  Total weights = 1.9578e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270958560
                                         uncertainty =       0.001504180637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270958560
                                         uncertainty =       0.001504180637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379006938
  error estimate for blocks of size 2^( 2) =       0.000390321129
  error estimate for blocks of size 2^( 3) =       0.000400515256
  error estimate for blocks of size 2^( 4) =       0.000408164279
  error estimate for blocks of size 2^( 5) =       0.000412954491
  error estimate for blocks of size 2^( 6) =       0.000415464160
  error estimate for blocks of size 2^( 7) =       0.000416440398

      target function =      -0.910893212599
              le_mean =     -17.214597753416
             les_mean =     296.643478474101
             stat err =       0.000413255832
             autocorr =       1.188895443552
   target nu stat err =       0.000413255832
   target dn stat err =       0.002609874508
      target stat err =       0.004107476335
              std dev =       0.535996751799
             le_variance =       0.287292517939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270941615
                                         uncertainty =       0.001504178865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270941615
                                         uncertainty =       0.001504178865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379006927
  error estimate for blocks of size 2^( 2) =       0.000390321119
  error estimate for blocks of size 2^( 3) =       0.000400515248
  error estimate for blocks of size 2^( 4) =       0.000408164272
  error estimate for blocks of size 2^( 5) =       0.000412954485
  error estimate for blocks of size 2^( 6) =       0.000415464153
  error estimate for blocks of size 2^( 7) =       0.000416440389

      target function =      -0.910893259669
              le_mean =     -17.214597752829
             les_mean =     296.643478423626
             stat err =       0.000413255825
             autocorr =       1.188895473131
   target nu stat err =       0.000413255825
   target dn stat err =       0.002609865996
      target stat err =       0.004107463743
              std dev =       0.535996735938
             le_variance =       0.287292500936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270950087
                                         uncertainty =       0.001504179751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270950087
                                         uncertainty =       0.001504179751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379006932
  error estimate for blocks of size 2^( 2) =       0.000390321124
  error estimate for blocks of size 2^( 3) =       0.000400515252
  error estimate for blocks of size 2^( 4) =       0.000408164276
  error estimate for blocks of size 2^( 5) =       0.000412954488
  error estimate for blocks of size 2^( 6) =       0.000415464156
  error estimate for blocks of size 2^( 7) =       0.000416440394

      target function =      -0.910893236139
              le_mean =     -17.214597753122
             les_mean =     296.643478448859
             stat err =       0.000413255829
             autocorr =       1.188895458336
   target nu stat err =       0.000413255829
   target dn stat err =       0.002609870252
      target stat err =       0.004107470039
              std dev =       0.535996743868
             le_variance =       0.287292509437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270957501
                                         uncertainty =       0.001504180526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287270957501
                                         uncertainty =       0.001504180526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379006937
  error estimate for blocks of size 2^( 2) =       0.000390321129
  error estimate for blocks of size 2^( 3) =       0.000400515255
  error estimate for blocks of size 2^( 4) =       0.000408164279
  error estimate for blocks of size 2^( 5) =       0.000412954491
  error estimate for blocks of size 2^( 6) =       0.000415464159
  error estimate for blocks of size 2^( 7) =       0.000416440397

      target function =      -0.910893215542
              le_mean =     -17.214597753379
             les_mean =     296.643478470945
             stat err =       0.000413255832
             autocorr =       1.188895445397
   target nu stat err =       0.000413255832
   target dn stat err =       0.002609873976
      target stat err =       0.004107475548
              std dev =       0.535996750807
             le_variance =       0.287292516876


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.910893212599        initial
     3.1554e+03     3.1554e+04             5.7190e-08        -0.910893259669  <--
     1.2622e+04     1.2622e+05             1.4298e-08        -0.910893236139
     5.0487e+04     5.0487e+05             3.5745e-09        -0.910893215542

*****************************************************************************
Applying the update for shift_i =   3.1554e+03     and shift_s =   3.1554e+04
*****************************************************************************

  Execution time = 2.3781e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.762720e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367606e-02 3 1  ON 2
ci_004                 2.096105e-02 3 1  ON 3
ci_005                 2.155703e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847776e-02 3 1  ON 6
ci_008                -7.758084e-03 3 1  ON 7
ci_009                -1.401791e-02 3 1  ON 8
ci_010                -8.874164e-03 3 1  ON 9
ci_011                -9.142707e-03 3 1  ON 10
ci_012                -9.120501e-03 3 1  ON 11
ci_013                -1.923570e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103411e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566985e-02 3 1  ON 16
ci_018                 9.080092e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506479e-02 3 1  ON 19
ci_021                 1.519142e-02 3 1  ON 20
ci_022                 8.258514e-03 3 1  ON 21
ci_023                 8.361525e-03 3 1  ON 22
ci_024                 8.582886e-03 3 1  ON 23
ci_025                 8.594694e-03 3 1  ON 24
ci_026                 1.002847e-02 3 1  ON 25
ci_027                 9.639981e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795505e-03 3 1  ON 29
ci_031                -8.563394e-03 3 1  ON 30
ci_032                -1.443912e-02 3 1  ON 31
ci_033                 4.554523e-03 3 1  ON 32
ci_034                 4.915647e-03 3 1  ON 33
ci_035                -3.348044e-03 3 1  ON 34
ci_036                -1.126181e-02 3 1  ON 35
ci_037                -1.150770e-02 3 1  ON 36
ci_038                 9.200307e-04 3 1  ON 37
ci_039                 1.223196e-03 3 1  ON 38
ci_040                -1.602999e-03 3 1  ON 39
ci_041                 8.180296e-03 3 1  ON 40
ci_042                 8.255544e-03 3 1  ON 41
ci_043                -2.385611e-03 3 1  ON 42
ci_044                -3.921283e-03 3 1  ON 43
ci_045                -1.870143e-03 3 1  ON 44
ci_046                 4.771109e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242644e-02 3 1  ON 47
ci_049                -1.288202e-02 3 1  ON 48
ci_050                 2.825065e-03 3 1  ON 49
ci_051                 2.816396e-03 3 1  ON 50
ci_052                -2.275413e-03 3 1  ON 51
ci_053                -2.208880e-03 3 1  ON 52
ci_054                -2.321101e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660681e-03 3 1  ON 55
ci_057                 4.675284e-03 3 1  ON 56
ci_058                -2.044651e-03 3 1  ON 57
ci_059                -2.118562e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181170e-03 3 1  ON 60
ci_062                -2.828186e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213496e-03 3 1  ON 63
ci_065                -3.398013e-03 3 1  ON 64
ci_066                 4.063191e-03 3 1  ON 65
ci_067                 4.160699e-03 3 1  ON 66
ci_068                -4.398715e-03 3 1  ON 67
ci_069                -4.115147e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.30723
====================================================
  Execution time = 1.4661e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9763e-01
  Total weights = 1.958041708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286669344150
                                         uncertainty =       0.001701995245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286669344150
                                         uncertainty =       0.001701995245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378588303
  error estimate for blocks of size 2^( 2) =       0.000390423793
  error estimate for blocks of size 2^( 3) =       0.000400567576
  error estimate for blocks of size 2^( 4) =       0.000408492343
  error estimate for blocks of size 2^( 5) =       0.000414169481
  error estimate for blocks of size 2^( 6) =       0.000417186381
  error estimate for blocks of size 2^( 7) =       0.000418882630

      target function =      -0.916300720787
              le_mean =     -17.215247080903
             les_mean =     296.662358081185
             stat err =       0.000414682709
             autocorr =       1.199768542947
   target nu stat err =       0.000414682709
   target dn stat err =       0.002032053741
      target stat err =       0.003270418289
              std dev =       0.535404712027
             le_variance =       0.286658205661


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721524708090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 7.8886e+02, overlap shift 7.8886e+03 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916311509158       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916311533404       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916311536113       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916311537602       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916311537705       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916311537665       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916311537631       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916311537640       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916311537642       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 7.8886e+02 is 1.018240e-07

solving harmonic davidson linear method for identity shift 3.1554e+03, overlap shift 3.1554e+04 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916311509158       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916311515220       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916311515897       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916311516270       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916311516297       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916311516285       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916311516277       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916311516280       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916311516280       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.1554e+03 is 2.545775e-08

solving harmonic davidson linear method for identity shift 1.2622e+04, overlap shift 1.2622e+05 and omega -1.7750e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916311509158       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916311510674       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916311510843       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916311510924       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916311510942       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916311510943       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916311510945       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916311510939       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916311510974       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.2622e+04 is 6.364548e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391716 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7218e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.762719e-02 3 1  ON 0
ci_002                -2.875735e-02 3 1  ON 1
ci_003                -2.367607e-02 3 1  ON 2
ci_004                 2.096105e-02 3 1  ON 3
ci_005                 2.155700e-02 3 1  ON 4
ci_006                -1.849765e-02 3 1  ON 5
ci_007                -1.847775e-02 3 1  ON 6
ci_008                -7.758077e-03 3 1  ON 7
ci_009                -1.401793e-02 3 1  ON 8
ci_010                -8.874150e-03 3 1  ON 9
ci_011                -9.142696e-03 3 1  ON 10
ci_012                -9.120515e-03 3 1  ON 11
ci_013                -1.923571e-02 3 1  ON 12
ci_014                 1.117977e-02 3 1  ON 13
ci_015                 1.103411e-02 3 1  ON 14
ci_016                 1.597441e-02 3 1  ON 15
ci_017                 1.566984e-02 3 1  ON 16
ci_018                 9.080085e-03 3 1  ON 17
ci_019                 8.981715e-03 3 1  ON 18
ci_020                 1.506481e-02 3 1  ON 19
ci_021                 1.519141e-02 3 1  ON 20
ci_022                 8.258516e-03 3 1  ON 21
ci_023                 8.361520e-03 3 1  ON 22
ci_024                 8.582863e-03 3 1  ON 23
ci_025                 8.594686e-03 3 1  ON 24
ci_026                 1.002847e-02 3 1  ON 25
ci_027                 9.639994e-03 3 1  ON 26
ci_028                -1.462451e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795501e-03 3 1  ON 29
ci_031                -8.563391e-03 3 1  ON 30
ci_032                -1.443913e-02 3 1  ON 31
ci_033                 4.554529e-03 3 1  ON 32
ci_034                 4.915662e-03 3 1  ON 33
ci_035                -3.348034e-03 3 1  ON 34
ci_036                -1.126180e-02 3 1  ON 35
ci_037                -1.150770e-02 3 1  ON 36
ci_038                 9.200172e-04 3 1  ON 37
ci_039                 1.223175e-03 3 1  ON 38
ci_040                -1.602992e-03 3 1  ON 39
ci_041                 8.180309e-03 3 1  ON 40
ci_042                 8.255568e-03 3 1  ON 41
ci_043                -2.385611e-03 3 1  ON 42
ci_044                -3.921309e-03 3 1  ON 43
ci_045                -1.870141e-03 3 1  ON 44
ci_046                 4.771105e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242644e-02 3 1  ON 47
ci_049                -1.288201e-02 3 1  ON 48
ci_050                 2.825070e-03 3 1  ON 49
ci_051                 2.816395e-03 3 1  ON 50
ci_052                -2.275429e-03 3 1  ON 51
ci_053                -2.208887e-03 3 1  ON 52
ci_054                -2.321089e-03 3 1  ON 53
ci_055                -2.375191e-03 3 1  ON 54
ci_056                 4.660680e-03 3 1  ON 55
ci_057                 4.675280e-03 3 1  ON 56
ci_058                -2.044642e-03 3 1  ON 57
ci_059                -2.118542e-03 3 1  ON 58
ci_060                 4.730406e-03 3 1  ON 59
ci_061                 5.181165e-03 3 1  ON 60
ci_062                -2.828191e-03 3 1  ON 61
ci_063                -2.781419e-03 3 1  ON 62
ci_064                -2.213501e-03 3 1  ON 63
ci_065                -3.398003e-03 3 1  ON 64
ci_066                 4.063190e-03 3 1  ON 65
ci_067                 4.160694e-03 3 1  ON 66
ci_068                -4.398694e-03 3 1  ON 67
ci_069                -4.115143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1777
    reference variance = 0.22236
====================================================
  Execution time = 1.4516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9979e-01
  Total weights = 1.9576e+06
  Execution time = 1.8711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837782516
                                         uncertainty =       0.001720868600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837782516
                                         uncertainty =       0.001720868600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379410046
  error estimate for blocks of size 2^( 2) =       0.000390496704
  error estimate for blocks of size 2^( 3) =       0.000400827213
  error estimate for blocks of size 2^( 4) =       0.000409011506
  error estimate for blocks of size 2^( 5) =       0.000414188579
  error estimate for blocks of size 2^( 6) =       0.000417007746
  error estimate for blocks of size 2^( 7) =       0.000415786361

      target function =      -0.912928635723
              le_mean =     -17.214823860800
             les_mean =     296.649947622395
             stat err =       0.000413998548
             autocorr =       1.190638669718
   target nu stat err =       0.000413998548
   target dn stat err =       0.002610924878
      target stat err =       0.004129157881
              std dev =       0.536566833171
             le_variance =       0.287903966459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837764244
                                         uncertainty =       0.001720870585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837764244
                                         uncertainty =       0.001720870585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379410035
  error estimate for blocks of size 2^( 2) =       0.000390496698
  error estimate for blocks of size 2^( 3) =       0.000400827211
  error estimate for blocks of size 2^( 4) =       0.000409011509
  error estimate for blocks of size 2^( 5) =       0.000414188583
  error estimate for blocks of size 2^( 6) =       0.000417007755
  error estimate for blocks of size 2^( 7) =       0.000415786369

      target function =      -0.912928518212
              le_mean =     -17.214823860451
             les_mean =     296.649947685873
             stat err =       0.000413998554
             autocorr =       1.190638777722
   target nu stat err =       0.000413998554
   target dn stat err =       0.002610920467
      target stat err =       0.004129150061
              std dev =       0.536566816625
             le_variance =       0.287903948703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837773378
                                         uncertainty =       0.001720869593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837773378
                                         uncertainty =       0.001720869593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379410040
  error estimate for blocks of size 2^( 2) =       0.000390496701
  error estimate for blocks of size 2^( 3) =       0.000400827212
  error estimate for blocks of size 2^( 4) =       0.000409011508
  error estimate for blocks of size 2^( 5) =       0.000414188581
  error estimate for blocks of size 2^( 6) =       0.000417007751
  error estimate for blocks of size 2^( 7) =       0.000415786365

      target function =      -0.912928577644
              le_mean =     -17.214823860625
             les_mean =     296.649947653696
             stat err =       0.000413998551
             autocorr =       1.190638723717
   target nu stat err =       0.000413998551
   target dn stat err =       0.002610922671
      target stat err =       0.004129153974
              std dev =       0.536566824897
             le_variance =       0.287903957580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837781373
                                         uncertainty =       0.001720868724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287837781373
                                         uncertainty =       0.001720868724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379410046
  error estimate for blocks of size 2^( 2) =       0.000390496704
  error estimate for blocks of size 2^( 3) =       0.000400827213
  error estimate for blocks of size 2^( 4) =       0.000409011507
  error estimate for blocks of size 2^( 5) =       0.000414188579
  error estimate for blocks of size 2^( 6) =       0.000417007747
  error estimate for blocks of size 2^( 7) =       0.000415786362

      target function =      -0.912928628537
              le_mean =     -17.214823860778
             les_mean =     296.649947626260
             stat err =       0.000413998548
             autocorr =       1.190638676470
   target nu stat err =       0.000413998548
   target dn stat err =       0.002610924602
      target stat err =       0.004129157393
              std dev =       0.536566832137
             le_variance =       0.287903965349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.912928635723        initial  <--
     7.8886e+02     7.8886e+03             1.0182e-07        -0.912928518212
     3.1554e+03     3.1554e+04             2.5458e-08        -0.912928577644
     1.2622e+04     1.2622e+05             6.3645e-09        -0.912928628537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9745
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.762720e-02 3 1  ON 0
ci_002                -2.875736e-02 3 1  ON 1
ci_003                -2.367606e-02 3 1  ON 2
ci_004                 2.096105e-02 3 1  ON 3
ci_005                 2.155703e-02 3 1  ON 4
ci_006                -1.849766e-02 3 1  ON 5
ci_007                -1.847776e-02 3 1  ON 6
ci_008                -7.758084e-03 3 1  ON 7
ci_009                -1.401791e-02 3 1  ON 8
ci_010                -8.874164e-03 3 1  ON 9
ci_011                -9.142707e-03 3 1  ON 10
ci_012                -9.120501e-03 3 1  ON 11
ci_013                -1.923570e-02 3 1  ON 12
ci_014                 1.117978e-02 3 1  ON 13
ci_015                 1.103411e-02 3 1  ON 14
ci_016                 1.597440e-02 3 1  ON 15
ci_017                 1.566985e-02 3 1  ON 16
ci_018                 9.080092e-03 3 1  ON 17
ci_019                 8.981731e-03 3 1  ON 18
ci_020                 1.506479e-02 3 1  ON 19
ci_021                 1.519142e-02 3 1  ON 20
ci_022                 8.258514e-03 3 1  ON 21
ci_023                 8.361525e-03 3 1  ON 22
ci_024                 8.582886e-03 3 1  ON 23
ci_025                 8.594694e-03 3 1  ON 24
ci_026                 1.002847e-02 3 1  ON 25
ci_027                 9.639981e-03 3 1  ON 26
ci_028                -1.462452e-02 3 1  ON 27
ci_029                -1.500990e-02 3 1  ON 28
ci_030                -8.795505e-03 3 1  ON 29
ci_031                -8.563394e-03 3 1  ON 30
ci_032                -1.443912e-02 3 1  ON 31
ci_033                 4.554523e-03 3 1  ON 32
ci_034                 4.915647e-03 3 1  ON 33
ci_035                -3.348044e-03 3 1  ON 34
ci_036                -1.126181e-02 3 1  ON 35
ci_037                -1.150770e-02 3 1  ON 36
ci_038                 9.200307e-04 3 1  ON 37
ci_039                 1.223196e-03 3 1  ON 38
ci_040                -1.602999e-03 3 1  ON 39
ci_041                 8.180296e-03 3 1  ON 40
ci_042                 8.255544e-03 3 1  ON 41
ci_043                -2.385611e-03 3 1  ON 42
ci_044                -3.921283e-03 3 1  ON 43
ci_045                -1.870143e-03 3 1  ON 44
ci_046                 4.771109e-03 3 1  ON 45
ci_047                 4.645481e-03 3 1  ON 46
ci_048                -1.242644e-02 3 1  ON 47
ci_049                -1.288202e-02 3 1  ON 48
ci_050                 2.825065e-03 3 1  ON 49
ci_051                 2.816396e-03 3 1  ON 50
ci_052                -2.275413e-03 3 1  ON 51
ci_053                -2.208880e-03 3 1  ON 52
ci_054                -2.321101e-03 3 1  ON 53
ci_055                -2.375184e-03 3 1  ON 54
ci_056                 4.660681e-03 3 1  ON 55
ci_057                 4.675284e-03 3 1  ON 56
ci_058                -2.044651e-03 3 1  ON 57
ci_059                -2.118562e-03 3 1  ON 58
ci_060                 4.730414e-03 3 1  ON 59
ci_061                 5.181170e-03 3 1  ON 60
ci_062                -2.828186e-03 3 1  ON 61
ci_063                -2.781433e-03 3 1  ON 62
ci_064                -2.213496e-03 3 1  ON 63
ci_065                -3.398013e-03 3 1  ON 64
ci_066                 4.063191e-03 3 1  ON 65
ci_067                 4.160699e-03 3 1  ON 66
ci_068                -4.398715e-03 3 1  ON 67
ci_069                -4.115147e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1204e+01 secs
  Total Execution time = 4.0480e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
