--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0237.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 82381 MB
Rank =    1  Free Memory = 82378 MB
Rank =    2  Free Memory = 82378 MB
Rank =    3  Free Memory = 82378 MB
Rank =    4  Free Memory = 82377 MB
Rank =    5  Free Memory = 82377 MB
Rank =    6  Free Memory = 82377 MB
Rank =    7  Free Memory = 82377 MB
Rank =    8  Free Memory = 82377 MB
Rank =    9  Free Memory = 82377 MB
Rank =   10  Free Memory = 82377 MB
Rank =   11  Free Memory = 82377 MB
Rank =   12  Free Memory = 82377 MB
Rank =   13  Free Memory = 82377 MB
Rank =   14  Free Memory = 82377 MB
Rank =   15  Free Memory = 82377 MB
Rank =   16  Free Memory = 82377 MB
Rank =   17  Free Memory = 82376 MB
Rank =   18  Free Memory = 82376 MB
Rank =   19  Free Memory = 82376 MB
Rank =   20  Free Memory = 82376 MB
Rank =   21  Free Memory = 82376 MB
Rank =   22  Free Memory = 82376 MB
Rank =   23  Free Memory = 82376 MB
Rank =   24  Free Memory = 82376 MB
Rank =   25  Free Memory = 82376 MB
Rank =   26  Free Memory = 82376 MB
Rank =   27  Free Memory = 82376 MB
Rank =   28  Free Memory = 82376 MB
Rank =   29  Free Memory = 82376 MB
Rank =   30  Free Memory = 82376 MB
Rank =   31  Free Memory = 82376 MB
Rank =   32  Free Memory = 82376 MB
Rank =   33  Free Memory = 82376 MB
Rank =   34  Free Memory = 82376 MB
Rank =   35  Free Memory = 82376 MB
Rank =   36  Free Memory = 82376 MB
Rank =   37  Free Memory = 82376 MB
Rank =   38  Free Memory = 82376 MB
Rank =   39  Free Memory = 82376 MB
Rank =   40  Free Memory = 78308 MB
Rank =   41  Free Memory = 78308 MB
Rank =   42  Free Memory = 78308 MB
Rank =   43  Free Memory = 78308 MB
Rank =   44  Free Memory = 78308 MB
Rank =   45  Free Memory = 78308 MB
Rank =   46  Free Memory = 78308 MB
Rank =   47  Free Memory = 78307 MB
Rank =   48  Free Memory = 78307 MB
Rank =   49  Free Memory = 78307 MB
Rank =   50  Free Memory = 78307 MB
Rank =   51  Free Memory = 78307 MB
Rank =   52  Free Memory = 78307 MB
Rank =   53  Free Memory = 78307 MB
Rank =   54  Free Memory = 78307 MB
Rank =   55  Free Memory = 78307 MB
Rank =   56  Free Memory = 78307 MB
Rank =   57  Free Memory = 78307 MB
Rank =   58  Free Memory = 78307 MB
Rank =   59  Free Memory = 78307 MB
Rank =   60  Free Memory = 78307 MB
Rank =   61  Free Memory = 78307 MB
Rank =   62  Free Memory = 78307 MB
Rank =   63  Free Memory = 78307 MB
Rank =   64  Free Memory = 78307 MB
Rank =   65  Free Memory = 78307 MB
Rank =   66  Free Memory = 78307 MB
Rank =   67  Free Memory = 78307 MB
Rank =   68  Free Memory = 78307 MB
Rank =   69  Free Memory = 78307 MB
Rank =   70  Free Memory = 78307 MB
Rank =   71  Free Memory = 78307 MB
Rank =   72  Free Memory = 78307 MB
Rank =   73  Free Memory = 78307 MB
Rank =   74  Free Memory = 78307 MB
Rank =   75  Free Memory = 78307 MB
Rank =   76  Free Memory = 78307 MB
Rank =   77  Free Memory = 78307 MB
Rank =   78  Free Memory = 78307 MB
Rank =   79  Free Memory = 78307 MB
Rank =   80  Free Memory = 79540 MB
Rank =   81  Free Memory = 79540 MB
Rank =   82  Free Memory = 79540 MB
Rank =   83  Free Memory = 79540 MB
Rank =   84  Free Memory = 79540 MB
Rank =   85  Free Memory = 79540 MB
Rank =   86  Free Memory = 79540 MB
Rank =   87  Free Memory = 79540 MB
Rank =   88  Free Memory = 79540 MB
Rank =   89  Free Memory = 79540 MB
Rank =   90  Free Memory = 79540 MB
Rank =   91  Free Memory = 79540 MB
Rank =   92  Free Memory = 79540 MB
Rank =   93  Free Memory = 79540 MB
Rank =   94  Free Memory = 79540 MB
Rank =   95  Free Memory = 79540 MB
Rank =   96  Free Memory = 79540 MB
Rank =   97  Free Memory = 79540 MB
Rank =   98  Free Memory = 79540 MB
Rank =   99  Free Memory = 79540 MB
Rank =  100  Free Memory = 79540 MB
Rank =  101  Free Memory = 79540 MB
Rank =  102  Free Memory = 79540 MB
Rank =  103  Free Memory = 79540 MB
Rank =  104  Free Memory = 79540 MB
Rank =  105  Free Memory = 79540 MB
Rank =  106  Free Memory = 79540 MB
Rank =  107  Free Memory = 79540 MB
Rank =  108  Free Memory = 79540 MB
Rank =  109  Free Memory = 79540 MB
Rank =  110  Free Memory = 79540 MB
Rank =  111  Free Memory = 79540 MB
Rank =  112  Free Memory = 79540 MB
Rank =  113  Free Memory = 79540 MB
Rank =  114  Free Memory = 79540 MB
Rank =  115  Free Memory = 79540 MB
Rank =  116  Free Memory = 79540 MB
Rank =  117  Free Memory = 79540 MB
Rank =  118  Free Memory = 79540 MB
Rank =  119  Free Memory = 79540 MB
Rank =  120  Free Memory = 81242 MB
  Input file(s): opt_h2o_gs_lmcombci_run001b.xml 
Rank =  121  Free Memory = 81242 MB
Rank =  127  Free Memory = 81242 MB
Rank =  122  Free Memory = 81242 MB
Rank =  123  Free Memory = 81242 MB
Rank =  124  Free Memory = 81242 MB
Rank =  125  Free Memory = 81242 MB
Rank =  126  Free Memory = 81242 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmcombci_run001b.xml

  Project = H2O
  date    = 2023-04-12 11:52:06 PDT
  host    = n0234.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 470

  Range of prime numbers to use as seeds over processors and threads = 3347-4409


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.708012e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.8406e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0234.savio3:206801] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0234.savio3:206801] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.193618
====================================================
  Execution time = 1.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1652e-01
  Total weights = 1.956660548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075692476
                                         uncertainty =       0.002209576645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075692476
                                         uncertainty =       0.002209576645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385994377
  error estimate for blocks of size 2^( 2) =       0.000396026871
  error estimate for blocks of size 2^( 3) =       0.000405029140
  error estimate for blocks of size 2^( 4) =       0.000412148756
  error estimate for blocks of size 2^( 5) =       0.000416178777
  error estimate for blocks of size 2^( 6) =       0.000418435793
  error estimate for blocks of size 2^( 7) =       0.000419304751

      target function =                  N/A
              le_mean =     -17.215942137845
             les_mean =     296.705185719261
             stat err =       0.000416517019
             autocorr =       1.164403622620
              std dev =       0.545878482759
             le_variance =       0.297983317939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721594213784e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942137891       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215948151260       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215948142206       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215948308833       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.536543e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942137891       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215944538075       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215944328626       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.415352e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942137891       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215942843114       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215942755736       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 7.468059e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.003328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6684e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.036831e-02                3 1 ON  0
ci_002 -2.968589e-02                3 1 ON  1
ci_003 -2.560197e-02                3 1 ON  2
ci_004 2.146321e-02                 3 1 ON  3
ci_005 2.139750e-02                 3 1 ON  4
ci_006 -1.919422e-02                3 1 ON  5
ci_007 -1.907018e-02                3 1 ON  6
ci_008 -1.796863e-02                3 1 ON  7
ci_009 -1.801707e-02                3 1 ON  8
ci_010 -1.744865e-02                3 1 ON  9
ci_011 -1.631432e-02                3 1 ON  10
ci_012 -1.631819e-02                3 1 ON  11
ci_013 -1.933783e-02                3 1 ON  12
ci_014 1.385587e-02                 3 1 ON  13
ci_015 1.390118e-02                 3 1 ON  14
ci_016 1.663763e-02                 3 1 ON  15
ci_017 1.588948e-02                 3 1 ON  16
ci_018 1.273036e-02                 3 1 ON  17
ci_019 1.275169e-02                 3 1 ON  18
ci_020 1.292681e-02                 3 1 ON  19
ci_021 1.296381e-02                 3 1 ON  20
ci_022 1.154904e-02                 3 1 ON  21
ci_023 1.125633e-02                 3 1 ON  22
ci_024 1.168935e-02                 3 1 ON  23
ci_025 1.146107e-02                 3 1 ON  24
ci_026 1.100271e-02                 3 1 ON  25
ci_027 1.123768e-02                 3 1 ON  26
ci_028 -1.402072e-02                3 1 ON  27
ci_029 -1.474440e-02                3 1 ON  28
ci_030 -1.142439e-02                3 1 ON  29
ci_031 -1.101336e-02                3 1 ON  30
ci_032 -1.368243e-02                3 1 ON  31
ci_033 1.042485e-02                 3 1 ON  32
ci_034 1.025789e-02                 3 1 ON  33
ci_035 -4.821273e-03                3 1 ON  34
ci_036 -1.032890e-02                3 1 ON  35
ci_037 -1.007737e-02                3 1 ON  36
ci_038 1.739735e-03                 3 1 ON  37
ci_039 1.783887e-03                 3 1 ON  38
ci_040 -3.898460e-03                3 1 ON  39
ci_041 9.512173e-03                 3 1 ON  40
ci_042 9.747194e-03                 3 1 ON  41
ci_043 -3.068015e-03                3 1 ON  42
ci_044 -1.512402e-02                3 1 ON  43
ci_045 -1.681589e-03                3 1 ON  44
ci_046 5.968174e-03                 3 1 ON  45
ci_047 5.594338e-03                 3 1 ON  46
ci_048 -1.177028e-02                3 1 ON  47
ci_049 -1.183244e-02                3 1 ON  48
ci_050 7.562343e-03                 3 1 ON  49
ci_051 7.486854e-03                 3 1 ON  50
ci_052 -6.534506e-03                3 1 ON  51
ci_053 -6.781350e-03                3 1 ON  52
ci_054 -2.882117e-03                3 1 ON  53
ci_055 -2.964530e-03                3 1 ON  54
ci_056 4.494325e-03                 3 1 ON  55
ci_057 4.803069e-03                 3 1 ON  56
ci_058 -6.970120e-03                3 1 ON  57
ci_059 -6.866724e-03                3 1 ON  58
ci_060 8.497542e-03                 3 1 ON  59
ci_061 8.486908e-03                 3 1 ON  60
ci_062 -2.895762e-03                3 1 ON  61
ci_063 -3.304298e-03                3 1 ON  62
ci_064 -3.068781e-03                3 1 ON  63
ci_065 -4.353063e-03                3 1 ON  64
ci_066 5.689946e-03                 3 1 ON  65
ci_067 5.876834e-03                 3 1 ON  66
ci_068 -4.966344e-03                3 1 ON  67
ci_069 -4.761797e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.249943
====================================================
  Execution time = 1.3352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1526e-01
  Total weights = 1.9564e+06
  Execution time = 1.8500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301154047679
                                         uncertainty =       0.002095485362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301154047679
                                         uncertainty =       0.002095485362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388022627
  error estimate for blocks of size 2^( 2) =       0.000397800965
  error estimate for blocks of size 2^( 3) =       0.000407101409
  error estimate for blocks of size 2^( 4) =       0.000413817759
  error estimate for blocks of size 2^( 5) =       0.000417623785
  error estimate for blocks of size 2^( 6) =       0.000420142911
  error estimate for blocks of size 2^( 7) =       0.000420086760

      target function =                  N/A
              le_mean =     -17.216596592611
             les_mean =     296.735400083211
             stat err =       0.000417917804
             autocorr =       1.160025783576
              std dev =       0.548746862079
             le_variance =       0.301123118642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265732597
                                         uncertainty =       0.002107777274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301265732597
                                         uncertainty =       0.002107777274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388094329
  error estimate for blocks of size 2^( 2) =       0.000397872689
  error estimate for blocks of size 2^( 3) =       0.000407182474
  error estimate for blocks of size 2^( 4) =       0.000413898923
  error estimate for blocks of size 2^( 5) =       0.000417695204
  error estimate for blocks of size 2^( 6) =       0.000420229618
  error estimate for blocks of size 2^( 7) =       0.000420161684

      target function =                  N/A
              le_mean =     -17.216603946934
             les_mean =     296.732303833287
             stat err =       0.000417996357
             autocorr =       1.160033149368
              std dev =       0.548848264052
             le_variance =       0.301234416953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301258368613
                                         uncertainty =       0.002104117943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301258368613
                                         uncertainty =       0.002104117943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388089622
  error estimate for blocks of size 2^( 2) =       0.000397866349
  error estimate for blocks of size 2^( 3) =       0.000407172991
  error estimate for blocks of size 2^( 4) =       0.000413888050
  error estimate for blocks of size 2^( 5) =       0.000417679953
  error estimate for blocks of size 2^( 6) =       0.000420211957
  error estimate for blocks of size 2^( 7) =       0.000420143705

      target function =                  N/A
              le_mean =     -17.216600520955
             les_mean =     296.728749680702
             stat err =       0.000417980916
             autocorr =       1.159975585519
              std dev =       0.548841606846
             le_variance =       0.301227109406

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301158857856
                                         uncertainty =       0.002096803581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301158857856
                                         uncertainty =       0.002096803581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388025703
  error estimate for blocks of size 2^( 2) =       0.000397803126
  error estimate for blocks of size 2^( 3) =       0.000407104268
  error estimate for blocks of size 2^( 4) =       0.000413820788
  error estimate for blocks of size 2^( 5) =       0.000417619483
  error estimate for blocks of size 2^( 6) =       0.000420140416
  error estimate for blocks of size 2^( 7) =       0.000420080678

      target function =                  N/A
              le_mean =     -17.216597718170
             les_mean =     296.728474134881
             stat err =       0.000417915341
             autocorr =       1.159993724420
              std dev =       0.548751211429
             le_variance =       0.301127892044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216596592611        initial
     2.5000e-01     2.5000e+00             6.5365e-04       -17.216603946934  <--
     1.0000e+00     1.0000e+01             2.4154e-04       -17.216600520955
     4.0000e+00     4.0000e+01             7.4681e-05       -17.216597718170

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2839e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.030301e-02 3 1  ON 0
ci_002                -2.950770e-02 3 1  ON 1
ci_003                -2.524608e-02 3 1  ON 2
ci_004                 2.180693e-02 3 1  ON 3
ci_005                 2.098622e-02 3 1  ON 4
ci_006                -1.911252e-02 3 1  ON 5
ci_007                -1.900883e-02 3 1  ON 6
ci_008                -1.784929e-02 3 1  ON 7
ci_009                -1.810941e-02 3 1  ON 8
ci_010                -1.734701e-02 3 1  ON 9
ci_011                -1.620270e-02 3 1  ON 10
ci_012                -1.624779e-02 3 1  ON 11
ci_013                -1.920194e-02 3 1  ON 12
ci_014                 1.347007e-02 3 1  ON 13
ci_015                 1.403953e-02 3 1  ON 14
ci_016                 1.667910e-02 3 1  ON 15
ci_017                 1.566858e-02 3 1  ON 16
ci_018                 1.273733e-02 3 1  ON 17
ci_019                 1.276072e-02 3 1  ON 18
ci_020                 1.312387e-02 3 1  ON 19
ci_021                 1.306155e-02 3 1  ON 20
ci_022                 1.144734e-02 3 1  ON 21
ci_023                 1.104210e-02 3 1  ON 22
ci_024                 1.126661e-02 3 1  ON 23
ci_025                 1.151609e-02 3 1  ON 24
ci_026                 1.105897e-02 3 1  ON 25
ci_027                 1.144245e-02 3 1  ON 26
ci_028                -1.394058e-02 3 1  ON 27
ci_029                -1.468294e-02 3 1  ON 28
ci_030                -1.152501e-02 3 1  ON 29
ci_031                -1.110254e-02 3 1  ON 30
ci_032                -1.357197e-02 3 1  ON 31
ci_033                 1.054696e-02 3 1  ON 32
ci_034                 1.033026e-02 3 1  ON 33
ci_035                -4.883896e-03 3 1  ON 34
ci_036                -1.038541e-02 3 1  ON 35
ci_037                -1.004545e-02 3 1  ON 36
ci_038                 1.788456e-03 3 1  ON 37
ci_039                 1.896464e-03 3 1  ON 38
ci_040                -4.039042e-03 3 1  ON 39
ci_041                 9.585871e-03 3 1  ON 40
ci_042                 9.929407e-03 3 1  ON 41
ci_043                -3.093267e-03 3 1  ON 42
ci_044                -1.517724e-02 3 1  ON 43
ci_045                -1.768358e-03 3 1  ON 44
ci_046                 6.251676e-03 3 1  ON 45
ci_047                 5.790764e-03 3 1  ON 46
ci_048                -1.170051e-02 3 1  ON 47
ci_049                -1.186036e-02 3 1  ON 48
ci_050                 7.591882e-03 3 1  ON 49
ci_051                 7.785421e-03 3 1  ON 50
ci_052                -6.599507e-03 3 1  ON 51
ci_053                -6.621994e-03 3 1  ON 52
ci_054                -2.937058e-03 3 1  ON 53
ci_055                -2.902236e-03 3 1  ON 54
ci_056                 4.522333e-03 3 1  ON 55
ci_057                 4.715048e-03 3 1  ON 56
ci_058                -6.997075e-03 3 1  ON 57
ci_059                -7.171607e-03 3 1  ON 58
ci_060                 8.478260e-03 3 1  ON 59
ci_061                 8.653070e-03 3 1  ON 60
ci_062                -2.677939e-03 3 1  ON 61
ci_063                -3.432798e-03 3 1  ON 62
ci_064                -2.971896e-03 3 1  ON 63
ci_065                -4.452762e-03 3 1  ON 64
ci_066                 5.692760e-03 3 1  ON 65
ci_067                 5.919504e-03 3 1  ON 66
ci_068                -5.072529e-03 3 1  ON 67
ci_069                -5.015574e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7181e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.29797
====================================================
  Execution time = 1.4015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1354e-01
  Total weights = 1.956739890e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297830259030
                                         uncertainty =       0.002792387114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297830259030
                                         uncertainty =       0.002792387114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385852349
  error estimate for blocks of size 2^( 2) =       0.000395703280
  error estimate for blocks of size 2^( 3) =       0.000404909491
  error estimate for blocks of size 2^( 4) =       0.000411270283
  error estimate for blocks of size 2^( 5) =       0.000415260672
  error estimate for blocks of size 2^( 6) =       0.000417448718
  error estimate for blocks of size 2^( 7) =       0.000419513386

      target function =                  N/A
              le_mean =     -17.216790658971
             les_mean =     296.731422637215
             stat err =       0.000415873265
             autocorr =       1.161661796406
              std dev =       0.545677624728
             le_variance =       0.297764070129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679065897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790659042       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216787389358       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216785236816       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216785659533       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216785734968       residual = 7.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.282410e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790659042       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216788622159       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216787758331       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787903169       residual = 9.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 7.892269e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790659042       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216789846939       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216789725753       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.105251e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.005628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6527e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.060280e-02 3 1  ON 0
ci_002                -2.963054e-02 3 1  ON 1
ci_003                -2.555305e-02 3 1  ON 2
ci_004                 2.190260e-02 3 1  ON 3
ci_005                 2.055574e-02 3 1  ON 4
ci_006                -1.922681e-02 3 1  ON 5
ci_007                -1.916677e-02 3 1  ON 6
ci_008                -1.829469e-02 3 1  ON 7
ci_009                -1.770824e-02 3 1  ON 8
ci_010                -1.727803e-02 3 1  ON 9
ci_011                -1.638369e-02 3 1  ON 10
ci_012                -1.591877e-02 3 1  ON 11
ci_013                -1.904586e-02 3 1  ON 12
ci_014                 1.413187e-02 3 1  ON 13
ci_015                 1.349189e-02 3 1  ON 14
ci_016                 1.665644e-02 3 1  ON 15
ci_017                 1.606201e-02 3 1  ON 16
ci_018                 1.267775e-02 3 1  ON 17
ci_019                 1.258884e-02 3 1  ON 18
ci_020                 1.300866e-02 3 1  ON 19
ci_021                 1.316130e-02 3 1  ON 20
ci_022                 1.148043e-02 3 1  ON 21
ci_023                 1.110501e-02 3 1  ON 22
ci_024                 1.149655e-02 3 1  ON 23
ci_025                 1.135975e-02 3 1  ON 24
ci_026                 1.096602e-02 3 1  ON 25
ci_027                 1.113142e-02 3 1  ON 26
ci_028                -1.394949e-02 3 1  ON 27
ci_029                -1.448638e-02 3 1  ON 28
ci_030                -1.136023e-02 3 1  ON 29
ci_031                -1.119917e-02 3 1  ON 30
ci_032                -1.386295e-02 3 1  ON 31
ci_033                 1.058860e-02 3 1  ON 32
ci_034                 1.008973e-02 3 1  ON 33
ci_035                -4.756989e-03 3 1  ON 34
ci_036                -1.025772e-02 3 1  ON 35
ci_037                -1.058735e-02 3 1  ON 36
ci_038                 1.668996e-03 3 1  ON 37
ci_039                 1.603506e-03 3 1  ON 38
ci_040                -3.842673e-03 3 1  ON 39
ci_041                 9.369986e-03 3 1  ON 40
ci_042                 9.840774e-03 3 1  ON 41
ci_043                -3.095306e-03 3 1  ON 42
ci_044                -1.473145e-02 3 1  ON 43
ci_045                -1.720201e-03 3 1  ON 44
ci_046                 5.719010e-03 3 1  ON 45
ci_047                 5.620653e-03 3 1  ON 46
ci_048                -1.215484e-02 3 1  ON 47
ci_049                -1.190632e-02 3 1  ON 48
ci_050                 7.756018e-03 3 1  ON 49
ci_051                 7.807340e-03 3 1  ON 50
ci_052                -6.347971e-03 3 1  ON 51
ci_053                -6.729060e-03 3 1  ON 52
ci_054                -3.164312e-03 3 1  ON 53
ci_055                -2.800959e-03 3 1  ON 54
ci_056                 4.643236e-03 3 1  ON 55
ci_057                 4.597738e-03 3 1  ON 56
ci_058                -6.861227e-03 3 1  ON 57
ci_059                -7.113271e-03 3 1  ON 58
ci_060                 7.740450e-03 3 1  ON 59
ci_061                 7.863843e-03 3 1  ON 60
ci_062                -2.813454e-03 3 1  ON 61
ci_063                -3.208831e-03 3 1  ON 62
ci_064                -2.751055e-03 3 1  ON 63
ci_065                -4.450352e-03 3 1  ON 64
ci_066                 5.827315e-03 3 1  ON 65
ci_067                 5.675541e-03 3 1  ON 66
ci_068                -4.773415e-03 3 1  ON 67
ci_069                -5.301749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.335706
====================================================
  Execution time = 1.3559e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1046e-01
  Total weights = 1.9569e+06
  Execution time = 1.8494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329922216644
                                         uncertainty =       0.023320863748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329922216644
                                         uncertainty =       0.023320863748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406016688
  error estimate for blocks of size 2^( 2) =       0.000415553618
  error estimate for blocks of size 2^( 3) =       0.000424165941
  error estimate for blocks of size 2^( 4) =       0.000430169757
  error estimate for blocks of size 2^( 5) =       0.000433852439
  error estimate for blocks of size 2^( 6) =       0.000435508447
  error estimate for blocks of size 2^( 7) =       0.000435750209

      target function =                  N/A
              le_mean =     -17.216454291203
             les_mean =     312.922645978592
             stat err =       0.000433820213
             autocorr =       1.141646892025
              std dev =       0.574194306547
             le_variance =       0.329699101671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296916146924
                                         uncertainty =       0.001779084520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296916146924
                                         uncertainty =       0.001779084520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385261297
  error estimate for blocks of size 2^( 2) =       0.000395312602
  error estimate for blocks of size 2^( 3) =       0.000404394477
  error estimate for blocks of size 2^( 4) =       0.000410543485
  error estimate for blocks of size 2^( 5) =       0.000414362082
  error estimate for blocks of size 2^( 6) =       0.000415904513
  error estimate for blocks of size 2^( 7) =       0.000415890665

      target function =                  N/A
              le_mean =     -17.216635482785
             les_mean =     296.724130344894
             stat err =       0.000414175186
             autocorr =       1.155732662139
              std dev =       0.544841751825
             le_variance =       0.296852534532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296989014787
                                         uncertainty =       0.001779631130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296989014787
                                         uncertainty =       0.001779631130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385308636
  error estimate for blocks of size 2^( 2) =       0.000395362931
  error estimate for blocks of size 2^( 3) =       0.000404449045
  error estimate for blocks of size 2^( 4) =       0.000410593681
  error estimate for blocks of size 2^( 5) =       0.000414408856
  error estimate for blocks of size 2^( 6) =       0.000415947819
  error estimate for blocks of size 2^( 7) =       0.000415942737

      target function =                  N/A
              le_mean =     -17.216647509451
             les_mean =     296.736574798236
             stat err =       0.000414223273
             autocorr =       1.155717013465
              std dev =       0.544908698354
             le_variance =       0.296925489542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296982643685
                                         uncertainty =       0.001780000813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296982643685
                                         uncertainty =       0.001780000813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385304035
  error estimate for blocks of size 2^( 2) =       0.000395341144
  error estimate for blocks of size 2^( 3) =       0.000404405290
  error estimate for blocks of size 2^( 4) =       0.000410551380
  error estimate for blocks of size 2^( 5) =       0.000414377096
  error estimate for blocks of size 2^( 6) =       0.000415936829
  error estimate for blocks of size 2^( 7) =       0.000415906279

      target function =                  N/A
              le_mean =     -17.216625252622
             les_mean =     296.743341710260
             stat err =       0.000414192896
             autocorr =       1.155575108669
              std dev =       0.544902191597
             le_variance =       0.296918398407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216454291203        initial
     6.2500e-02     6.2500e-01             1.2824e-03       -17.216635482785
     2.5000e-01     2.5000e+00             7.8923e-04       -17.216647509451  <--
     1.0000e+00     1.0000e+01             3.1053e-04       -17.216625252622

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3037e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.060280e-02 3 1  ON 0
ci_002                -2.963054e-02 3 1  ON 1
ci_003                -2.555305e-02 3 1  ON 2
ci_004                 2.190260e-02 3 1  ON 3
ci_005                 2.055574e-02 3 1  ON 4
ci_006                -1.922681e-02 3 1  ON 5
ci_007                -1.916677e-02 3 1  ON 6
ci_008                -1.829469e-02 3 1  ON 7
ci_009                -1.770824e-02 3 1  ON 8
ci_010                -1.727803e-02 3 1  ON 9
ci_011                -1.638369e-02 3 1  ON 10
ci_012                -1.591877e-02 3 1  ON 11
ci_013                -1.904586e-02 3 1  ON 12
ci_014                 1.413187e-02 3 1  ON 13
ci_015                 1.349189e-02 3 1  ON 14
ci_016                 1.665644e-02 3 1  ON 15
ci_017                 1.606201e-02 3 1  ON 16
ci_018                 1.267775e-02 3 1  ON 17
ci_019                 1.258884e-02 3 1  ON 18
ci_020                 1.300866e-02 3 1  ON 19
ci_021                 1.316130e-02 3 1  ON 20
ci_022                 1.148043e-02 3 1  ON 21
ci_023                 1.110501e-02 3 1  ON 22
ci_024                 1.149655e-02 3 1  ON 23
ci_025                 1.135975e-02 3 1  ON 24
ci_026                 1.096602e-02 3 1  ON 25
ci_027                 1.113142e-02 3 1  ON 26
ci_028                -1.394949e-02 3 1  ON 27
ci_029                -1.448638e-02 3 1  ON 28
ci_030                -1.136023e-02 3 1  ON 29
ci_031                -1.119917e-02 3 1  ON 30
ci_032                -1.386295e-02 3 1  ON 31
ci_033                 1.058860e-02 3 1  ON 32
ci_034                 1.008973e-02 3 1  ON 33
ci_035                -4.756989e-03 3 1  ON 34
ci_036                -1.025772e-02 3 1  ON 35
ci_037                -1.058735e-02 3 1  ON 36
ci_038                 1.668996e-03 3 1  ON 37
ci_039                 1.603506e-03 3 1  ON 38
ci_040                -3.842673e-03 3 1  ON 39
ci_041                 9.369986e-03 3 1  ON 40
ci_042                 9.840774e-03 3 1  ON 41
ci_043                -3.095306e-03 3 1  ON 42
ci_044                -1.473145e-02 3 1  ON 43
ci_045                -1.720201e-03 3 1  ON 44
ci_046                 5.719010e-03 3 1  ON 45
ci_047                 5.620653e-03 3 1  ON 46
ci_048                -1.215484e-02 3 1  ON 47
ci_049                -1.190632e-02 3 1  ON 48
ci_050                 7.756018e-03 3 1  ON 49
ci_051                 7.807340e-03 3 1  ON 50
ci_052                -6.347971e-03 3 1  ON 51
ci_053                -6.729060e-03 3 1  ON 52
ci_054                -3.164312e-03 3 1  ON 53
ci_055                -2.800959e-03 3 1  ON 54
ci_056                 4.643236e-03 3 1  ON 55
ci_057                 4.597738e-03 3 1  ON 56
ci_058                -6.861227e-03 3 1  ON 57
ci_059                -7.113271e-03 3 1  ON 58
ci_060                 7.740450e-03 3 1  ON 59
ci_061                 7.863843e-03 3 1  ON 60
ci_062                -2.813454e-03 3 1  ON 61
ci_063                -3.208831e-03 3 1  ON 62
ci_064                -2.751055e-03 3 1  ON 63
ci_065                -4.450352e-03 3 1  ON 64
ci_066                 5.827315e-03 3 1  ON 65
ci_067                 5.675541e-03 3 1  ON 66
ci_068                -4.773415e-03 3 1  ON 67
ci_069                -5.301749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9824e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1785
    reference variance = 0.20983
====================================================
  Execution time = 1.4081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1325e-01
  Total weights = 1.956570337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300827011573
                                         uncertainty =       0.002275645045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300827011573
                                         uncertainty =       0.002275645045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387835632
  error estimate for blocks of size 2^( 2) =       0.000397722887
  error estimate for blocks of size 2^( 3) =       0.000407347506
  error estimate for blocks of size 2^( 4) =       0.000414447733
  error estimate for blocks of size 2^( 5) =       0.000418443266
  error estimate for blocks of size 2^( 6) =       0.000421539976
  error estimate for blocks of size 2^( 7) =       0.000421761483

      target function =                  N/A
              le_mean =     -17.216081535280
             les_mean =     296.706715367264
             stat err =       0.000419048114
             autocorr =       1.167434078113
              std dev =       0.548482411312
             le_variance =       0.300832955518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608153528e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216081535332       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216086529986       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216083678377       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216085106763       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216084948592       residual = 6.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 8.878341e-04

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216081535332       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216084807680       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216083443216       residual = 7.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216083841874       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.523619e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216081535332       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216082910661       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216082607533       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216082643851       residual = 2.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.808168e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6602e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.039887e-02 3 1  ON 0
ci_002                -2.973805e-02 3 1  ON 1
ci_003                -2.528757e-02 3 1  ON 2
ci_004                 2.141842e-02 3 1  ON 3
ci_005                 2.064469e-02 3 1  ON 4
ci_006                -1.877796e-02 3 1  ON 5
ci_007                -1.902341e-02 3 1  ON 6
ci_008                -1.808676e-02 3 1  ON 7
ci_009                -1.763273e-02 3 1  ON 8
ci_010                -1.720899e-02 3 1  ON 9
ci_011                -1.629225e-02 3 1  ON 10
ci_012                -1.618923e-02 3 1  ON 11
ci_013                -1.931903e-02 3 1  ON 12
ci_014                 1.367754e-02 3 1  ON 13
ci_015                 1.386820e-02 3 1  ON 14
ci_016                 1.649786e-02 3 1  ON 15
ci_017                 1.615597e-02 3 1  ON 16
ci_018                 1.274349e-02 3 1  ON 17
ci_019                 1.275917e-02 3 1  ON 18
ci_020                 1.286049e-02 3 1  ON 19
ci_021                 1.313894e-02 3 1  ON 20
ci_022                 1.179045e-02 3 1  ON 21
ci_023                 1.111426e-02 3 1  ON 22
ci_024                 1.126931e-02 3 1  ON 23
ci_025                 1.169118e-02 3 1  ON 24
ci_026                 1.063080e-02 3 1  ON 25
ci_027                 1.109199e-02 3 1  ON 26
ci_028                -1.411650e-02 3 1  ON 27
ci_029                -1.478891e-02 3 1  ON 28
ci_030                -1.143141e-02 3 1  ON 29
ci_031                -1.075309e-02 3 1  ON 30
ci_032                -1.368157e-02 3 1  ON 31
ci_033                 1.056217e-02 3 1  ON 32
ci_034                 1.006284e-02 3 1  ON 33
ci_035                -4.592859e-03 3 1  ON 34
ci_036                -1.009584e-02 3 1  ON 35
ci_037                -1.005081e-02 3 1  ON 36
ci_038                 1.823464e-03 3 1  ON 37
ci_039                 1.368994e-03 3 1  ON 38
ci_040                -3.972297e-03 3 1  ON 39
ci_041                 9.367984e-03 3 1  ON 40
ci_042                 9.636316e-03 3 1  ON 41
ci_043                -3.058893e-03 3 1  ON 42
ci_044                -1.467953e-02 3 1  ON 43
ci_045                -1.917446e-03 3 1  ON 44
ci_046                 5.628114e-03 3 1  ON 45
ci_047                 5.499244e-03 3 1  ON 46
ci_048                -1.204115e-02 3 1  ON 47
ci_049                -1.182082e-02 3 1  ON 48
ci_050                 7.852439e-03 3 1  ON 49
ci_051                 7.992281e-03 3 1  ON 50
ci_052                -6.557644e-03 3 1  ON 51
ci_053                -6.860454e-03 3 1  ON 52
ci_054                -3.031157e-03 3 1  ON 53
ci_055                -2.762399e-03 3 1  ON 54
ci_056                 4.721440e-03 3 1  ON 55
ci_057                 4.682296e-03 3 1  ON 56
ci_058                -7.081159e-03 3 1  ON 57
ci_059                -6.845682e-03 3 1  ON 58
ci_060                 7.898012e-03 3 1  ON 59
ci_061                 7.889144e-03 3 1  ON 60
ci_062                -2.586200e-03 3 1  ON 61
ci_063                -3.163952e-03 3 1  ON 62
ci_064                -3.303417e-03 3 1  ON 63
ci_065                -4.295277e-03 3 1  ON 64
ci_066                 6.104924e-03 3 1  ON 65
ci_067                 5.942553e-03 3 1  ON 66
ci_068                -5.067651e-03 3 1  ON 67
ci_069                -4.865810e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.146116
====================================================
  Execution time = 1.3467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1343e-01
  Total weights = 1.9569e+06
  Execution time = 1.6930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300283245056
                                         uncertainty =       0.002322887996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300283245056
                                         uncertainty =       0.002322887996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387500484
  error estimate for blocks of size 2^( 2) =       0.000397787215
  error estimate for blocks of size 2^( 3) =       0.000406839165
  error estimate for blocks of size 2^( 4) =       0.000413603161
  error estimate for blocks of size 2^( 5) =       0.000416926325
  error estimate for blocks of size 2^( 6) =       0.000418149184
  error estimate for blocks of size 2^( 7) =       0.000420136703

      target function =                  N/A
              le_mean =     -17.217128333836
             les_mean =     296.745009601397
             stat err =       0.000417203843
             autocorr =       1.159183263679
              std dev =       0.548008439710
             le_variance =       0.300313249993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300424872479
                                         uncertainty =       0.002291964382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300424872479
                                         uncertainty =       0.002291964382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387589415
  error estimate for blocks of size 2^( 2) =       0.000397891248
  error estimate for blocks of size 2^( 3) =       0.000406955590
  error estimate for blocks of size 2^( 4) =       0.000413733356
  error estimate for blocks of size 2^( 5) =       0.000417069686
  error estimate for blocks of size 2^( 6) =       0.000418296094
  error estimate for blocks of size 2^( 7) =       0.000420254798

      target function =                  N/A
              le_mean =     -17.217134071430
             les_mean =     296.744494183351
             stat err =       0.000417338483
             autocorr =       1.159399346372
              std dev =       0.548134207224
             le_variance =       0.300451109129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300563758568
                                         uncertainty =       0.002286594595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300563758568
                                         uncertainty =       0.002286594595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387678301
  error estimate for blocks of size 2^( 2) =       0.000397984554
  error estimate for blocks of size 2^( 3) =       0.000407050236
  error estimate for blocks of size 2^( 4) =       0.000413825873
  error estimate for blocks of size 2^( 5) =       0.000417166696
  error estimate for blocks of size 2^( 6) =       0.000418388116
  error estimate for blocks of size 2^( 7) =       0.000420347495

      target function =                  N/A
              le_mean =     -17.217142536667
             les_mean =     296.746427592955
             stat err =       0.000417432045
             autocorr =       1.159387422080
              std dev =       0.548259910741
             le_variance =       0.300588929726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292382226
                                         uncertainty =       0.002314354529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292382226
                                         uncertainty =       0.002314354529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387505693
  error estimate for blocks of size 2^( 2) =       0.000397796572
  error estimate for blocks of size 2^( 3) =       0.000406854737
  error estimate for blocks of size 2^( 4) =       0.000413621234
  error estimate for blocks of size 2^( 5) =       0.000416947678
  error estimate for blocks of size 2^( 6) =       0.000418176815
  error estimate for blocks of size 2^( 7) =       0.000420160186

      target function =                  N/A
              le_mean =     -17.217125228381
             les_mean =     296.747036508605
             stat err =       0.000417226478
             autocorr =       1.159277879695
              std dev =       0.548015806936
             le_variance =       0.300321324651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217128333836        initial
     6.2500e-02     6.2500e-01             8.8783e-04       -17.217134071430
     2.5000e-01     2.5000e+00             5.5236e-04       -17.217142536667  <--
     1.0000e+00     1.0000e+01             2.8082e-04       -17.217125228381

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2198e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.039887e-02 3 1  ON 0
ci_002                -2.973805e-02 3 1  ON 1
ci_003                -2.528757e-02 3 1  ON 2
ci_004                 2.141842e-02 3 1  ON 3
ci_005                 2.064469e-02 3 1  ON 4
ci_006                -1.877796e-02 3 1  ON 5
ci_007                -1.902341e-02 3 1  ON 6
ci_008                -1.808676e-02 3 1  ON 7
ci_009                -1.763273e-02 3 1  ON 8
ci_010                -1.720899e-02 3 1  ON 9
ci_011                -1.629225e-02 3 1  ON 10
ci_012                -1.618923e-02 3 1  ON 11
ci_013                -1.931903e-02 3 1  ON 12
ci_014                 1.367754e-02 3 1  ON 13
ci_015                 1.386820e-02 3 1  ON 14
ci_016                 1.649786e-02 3 1  ON 15
ci_017                 1.615597e-02 3 1  ON 16
ci_018                 1.274349e-02 3 1  ON 17
ci_019                 1.275917e-02 3 1  ON 18
ci_020                 1.286049e-02 3 1  ON 19
ci_021                 1.313894e-02 3 1  ON 20
ci_022                 1.179045e-02 3 1  ON 21
ci_023                 1.111426e-02 3 1  ON 22
ci_024                 1.126931e-02 3 1  ON 23
ci_025                 1.169118e-02 3 1  ON 24
ci_026                 1.063080e-02 3 1  ON 25
ci_027                 1.109199e-02 3 1  ON 26
ci_028                -1.411650e-02 3 1  ON 27
ci_029                -1.478891e-02 3 1  ON 28
ci_030                -1.143141e-02 3 1  ON 29
ci_031                -1.075309e-02 3 1  ON 30
ci_032                -1.368157e-02 3 1  ON 31
ci_033                 1.056217e-02 3 1  ON 32
ci_034                 1.006284e-02 3 1  ON 33
ci_035                -4.592859e-03 3 1  ON 34
ci_036                -1.009584e-02 3 1  ON 35
ci_037                -1.005081e-02 3 1  ON 36
ci_038                 1.823464e-03 3 1  ON 37
ci_039                 1.368994e-03 3 1  ON 38
ci_040                -3.972297e-03 3 1  ON 39
ci_041                 9.367984e-03 3 1  ON 40
ci_042                 9.636316e-03 3 1  ON 41
ci_043                -3.058893e-03 3 1  ON 42
ci_044                -1.467953e-02 3 1  ON 43
ci_045                -1.917446e-03 3 1  ON 44
ci_046                 5.628114e-03 3 1  ON 45
ci_047                 5.499244e-03 3 1  ON 46
ci_048                -1.204115e-02 3 1  ON 47
ci_049                -1.182082e-02 3 1  ON 48
ci_050                 7.852439e-03 3 1  ON 49
ci_051                 7.992281e-03 3 1  ON 50
ci_052                -6.557644e-03 3 1  ON 51
ci_053                -6.860454e-03 3 1  ON 52
ci_054                -3.031157e-03 3 1  ON 53
ci_055                -2.762399e-03 3 1  ON 54
ci_056                 4.721440e-03 3 1  ON 55
ci_057                 4.682296e-03 3 1  ON 56
ci_058                -7.081159e-03 3 1  ON 57
ci_059                -6.845682e-03 3 1  ON 58
ci_060                 7.898012e-03 3 1  ON 59
ci_061                 7.889144e-03 3 1  ON 60
ci_062                -2.586200e-03 3 1  ON 61
ci_063                -3.163952e-03 3 1  ON 62
ci_064                -3.303417e-03 3 1  ON 63
ci_065                -4.295277e-03 3 1  ON 64
ci_066                 6.104924e-03 3 1  ON 65
ci_067                 5.942553e-03 3 1  ON 66
ci_068                -5.067651e-03 3 1  ON 67
ci_069                -4.865810e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9067e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1648
    reference variance = 0.169879
====================================================
  Execution time = 1.3985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1290e-01
  Total weights = 1.956748685e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298565270631
                                         uncertainty =       0.001896195976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298565270631
                                         uncertainty =       0.001896195976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386365218
  error estimate for blocks of size 2^( 2) =       0.000396654046
  error estimate for blocks of size 2^( 3) =       0.000405467022
  error estimate for blocks of size 2^( 4) =       0.000412434752
  error estimate for blocks of size 2^( 5) =       0.000417021956
  error estimate for blocks of size 2^( 6) =       0.000419772299
  error estimate for blocks of size 2^( 7) =       0.000420389866

      target function =                  N/A
              le_mean =     -17.215887197642
             les_mean =     296.699667871953
             stat err =       0.000417404718
             autocorr =       1.167128464761
              std dev =       0.546402931773
             le_variance =       0.298556163851


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721588719764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215887197696       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215898217234       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215894426050       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215894854631       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215894774221       residual = 8.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.490877e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215887197696       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215894114947       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215892729461       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215892940950       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 9.162081e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215887197696       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215889976715       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215889898164       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 3.599886e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6509e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.031623e-02 3 1  ON 0
ci_002                -2.981983e-02 3 1  ON 1
ci_003                -2.556023e-02 3 1  ON 2
ci_004                 2.163822e-02 3 1  ON 3
ci_005                 2.118574e-02 3 1  ON 4
ci_006                -1.890823e-02 3 1  ON 5
ci_007                -1.903944e-02 3 1  ON 6
ci_008                -1.799637e-02 3 1  ON 7
ci_009                -1.761565e-02 3 1  ON 8
ci_010                -1.730337e-02 3 1  ON 9
ci_011                -1.615151e-02 3 1  ON 10
ci_012                -1.647488e-02 3 1  ON 11
ci_013                -1.893173e-02 3 1  ON 12
ci_014                 1.352595e-02 3 1  ON 13
ci_015                 1.394993e-02 3 1  ON 14
ci_016                 1.643887e-02 3 1  ON 15
ci_017                 1.603537e-02 3 1  ON 16
ci_018                 1.268290e-02 3 1  ON 17
ci_019                 1.268253e-02 3 1  ON 18
ci_020                 1.291493e-02 3 1  ON 19
ci_021                 1.327097e-02 3 1  ON 20
ci_022                 1.156877e-02 3 1  ON 21
ci_023                 1.126707e-02 3 1  ON 22
ci_024                 1.146229e-02 3 1  ON 23
ci_025                 1.158982e-02 3 1  ON 24
ci_026                 1.086619e-02 3 1  ON 25
ci_027                 1.149512e-02 3 1  ON 26
ci_028                -1.433203e-02 3 1  ON 27
ci_029                -1.458493e-02 3 1  ON 28
ci_030                -1.132600e-02 3 1  ON 29
ci_031                -1.086299e-02 3 1  ON 30
ci_032                -1.370410e-02 3 1  ON 31
ci_033                 1.008246e-02 3 1  ON 32
ci_034                 1.010488e-02 3 1  ON 33
ci_035                -4.852249e-03 3 1  ON 34
ci_036                -1.044354e-02 3 1  ON 35
ci_037                -1.029207e-02 3 1  ON 36
ci_038                 1.755067e-03 3 1  ON 37
ci_039                 1.587840e-03 3 1  ON 38
ci_040                -3.930626e-03 3 1  ON 39
ci_041                 9.716253e-03 3 1  ON 40
ci_042                 9.556100e-03 3 1  ON 41
ci_043                -3.124433e-03 3 1  ON 42
ci_044                -1.509955e-02 3 1  ON 43
ci_045                -1.842389e-03 3 1  ON 44
ci_046                 5.501573e-03 3 1  ON 45
ci_047                 5.343108e-03 3 1  ON 46
ci_048                -1.201999e-02 3 1  ON 47
ci_049                -1.135025e-02 3 1  ON 48
ci_050                 7.987450e-03 3 1  ON 49
ci_051                 7.272109e-03 3 1  ON 50
ci_052                -6.440788e-03 3 1  ON 51
ci_053                -6.571911e-03 3 1  ON 52
ci_054                -2.873261e-03 3 1  ON 53
ci_055                -3.064030e-03 3 1  ON 54
ci_056                 4.759445e-03 3 1  ON 55
ci_057                 4.630469e-03 3 1  ON 56
ci_058                -7.138998e-03 3 1  ON 57
ci_059                -7.010816e-03 3 1  ON 58
ci_060                 8.159788e-03 3 1  ON 59
ci_061                 8.805352e-03 3 1  ON 60
ci_062                -2.613037e-03 3 1  ON 61
ci_063                -3.049525e-03 3 1  ON 62
ci_064                -3.186748e-03 3 1  ON 63
ci_065                -4.123930e-03 3 1  ON 64
ci_066                 5.728600e-03 3 1  ON 65
ci_067                 5.758453e-03 3 1  ON 66
ci_068                -5.044188e-03 3 1  ON 67
ci_069                -4.842966e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.268
    reference variance = 0.162849
====================================================
  Execution time = 1.3506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1283e-01
  Total weights = 1.9566e+06
  Execution time = 1.8464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299424202443
                                         uncertainty =       0.002095026832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299424202443
                                         uncertainty =       0.002095026832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386929994
  error estimate for blocks of size 2^( 2) =       0.000397099018
  error estimate for blocks of size 2^( 3) =       0.000406545330
  error estimate for blocks of size 2^( 4) =       0.000413533773
  error estimate for blocks of size 2^( 5) =       0.000418683368
  error estimate for blocks of size 2^( 6) =       0.000423006990
  error estimate for blocks of size 2^( 7) =       0.000425169293

      target function =                  N/A
              le_mean =     -17.217085834056
             les_mean =     296.750079468778
             stat err =       0.000420098356
             autocorr =       1.178791973807
              std dev =       0.547201645480
             le_variance =       0.299429640816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299453855125
                                         uncertainty =       0.002194780211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299453855125
                                         uncertainty =       0.002194780211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386950246
  error estimate for blocks of size 2^( 2) =       0.000397135772
  error estimate for blocks of size 2^( 3) =       0.000406589476
  error estimate for blocks of size 2^( 4) =       0.000413584249
  error estimate for blocks of size 2^( 5) =       0.000418759659
  error estimate for blocks of size 2^( 6) =       0.000423098093
  error estimate for blocks of size 2^( 7) =       0.000425221544

      target function =                  N/A
              le_mean =     -17.217084161145
             les_mean =     296.742463772652
             stat err =       0.000420165886
             autocorr =       1.179047553263
              std dev =       0.547230286513
             le_variance =       0.299460986477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299442933685
                                         uncertainty =       0.002218918314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299442933685
                                         uncertainty =       0.002218918314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386943505
  error estimate for blocks of size 2^( 2) =       0.000397135049
  error estimate for blocks of size 2^( 3) =       0.000406592354
  error estimate for blocks of size 2^( 4) =       0.000413591523
  error estimate for blocks of size 2^( 5) =       0.000418772964
  error estimate for blocks of size 2^( 6) =       0.000423120916
  error estimate for blocks of size 2^( 7) =       0.000425237311

      target function =                  N/A
              le_mean =     -17.217093458382
             les_mean =     296.741731443287
             stat err =       0.000420180679
             autocorr =       1.179171664494
              std dev =       0.547220752269
             le_variance =       0.299450551714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299347478353
                                         uncertainty =       0.002115571944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299347478353
                                         uncertainty =       0.002115571944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386880723
  error estimate for blocks of size 2^( 2) =       0.000397053634
  error estimate for blocks of size 2^( 3) =       0.000406501204
  error estimate for blocks of size 2^( 4) =       0.000413491733
  error estimate for blocks of size 2^( 5) =       0.000418648540
  error estimate for blocks of size 2^( 6) =       0.000422981096
  error estimate for blocks of size 2^( 7) =       0.000425132229

      target function =                  N/A
              le_mean =     -17.217080385371
             les_mean =     296.744019965799
             stat err =       0.000420063399
             autocorr =       1.178896023583
              std dev =       0.547131966119
             le_variance =       0.299353388349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217085834056        initial
     6.2500e-02     6.2500e-01             1.4909e-03       -17.217084161145
     2.5000e-01     2.5000e+00             9.1621e-04       -17.217093458382  <--
     1.0000e+00     1.0000e+01             3.5999e-04       -17.217080385371

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2812e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.031623e-02 3 1  ON 0
ci_002                -2.981983e-02 3 1  ON 1
ci_003                -2.556023e-02 3 1  ON 2
ci_004                 2.163822e-02 3 1  ON 3
ci_005                 2.118574e-02 3 1  ON 4
ci_006                -1.890823e-02 3 1  ON 5
ci_007                -1.903944e-02 3 1  ON 6
ci_008                -1.799637e-02 3 1  ON 7
ci_009                -1.761565e-02 3 1  ON 8
ci_010                -1.730337e-02 3 1  ON 9
ci_011                -1.615151e-02 3 1  ON 10
ci_012                -1.647488e-02 3 1  ON 11
ci_013                -1.893173e-02 3 1  ON 12
ci_014                 1.352595e-02 3 1  ON 13
ci_015                 1.394993e-02 3 1  ON 14
ci_016                 1.643887e-02 3 1  ON 15
ci_017                 1.603537e-02 3 1  ON 16
ci_018                 1.268290e-02 3 1  ON 17
ci_019                 1.268253e-02 3 1  ON 18
ci_020                 1.291493e-02 3 1  ON 19
ci_021                 1.327097e-02 3 1  ON 20
ci_022                 1.156877e-02 3 1  ON 21
ci_023                 1.126707e-02 3 1  ON 22
ci_024                 1.146229e-02 3 1  ON 23
ci_025                 1.158982e-02 3 1  ON 24
ci_026                 1.086619e-02 3 1  ON 25
ci_027                 1.149512e-02 3 1  ON 26
ci_028                -1.433203e-02 3 1  ON 27
ci_029                -1.458493e-02 3 1  ON 28
ci_030                -1.132600e-02 3 1  ON 29
ci_031                -1.086299e-02 3 1  ON 30
ci_032                -1.370410e-02 3 1  ON 31
ci_033                 1.008246e-02 3 1  ON 32
ci_034                 1.010488e-02 3 1  ON 33
ci_035                -4.852249e-03 3 1  ON 34
ci_036                -1.044354e-02 3 1  ON 35
ci_037                -1.029207e-02 3 1  ON 36
ci_038                 1.755067e-03 3 1  ON 37
ci_039                 1.587840e-03 3 1  ON 38
ci_040                -3.930626e-03 3 1  ON 39
ci_041                 9.716253e-03 3 1  ON 40
ci_042                 9.556100e-03 3 1  ON 41
ci_043                -3.124433e-03 3 1  ON 42
ci_044                -1.509955e-02 3 1  ON 43
ci_045                -1.842389e-03 3 1  ON 44
ci_046                 5.501573e-03 3 1  ON 45
ci_047                 5.343108e-03 3 1  ON 46
ci_048                -1.201999e-02 3 1  ON 47
ci_049                -1.135025e-02 3 1  ON 48
ci_050                 7.987450e-03 3 1  ON 49
ci_051                 7.272109e-03 3 1  ON 50
ci_052                -6.440788e-03 3 1  ON 51
ci_053                -6.571911e-03 3 1  ON 52
ci_054                -2.873261e-03 3 1  ON 53
ci_055                -3.064030e-03 3 1  ON 54
ci_056                 4.759445e-03 3 1  ON 55
ci_057                 4.630469e-03 3 1  ON 56
ci_058                -7.138998e-03 3 1  ON 57
ci_059                -7.010816e-03 3 1  ON 58
ci_060                 8.159788e-03 3 1  ON 59
ci_061                 8.805352e-03 3 1  ON 60
ci_062                -2.613037e-03 3 1  ON 61
ci_063                -3.049525e-03 3 1  ON 62
ci_064                -3.186748e-03 3 1  ON 63
ci_065                -4.123930e-03 3 1  ON 64
ci_066                 5.728600e-03 3 1  ON 65
ci_067                 5.758453e-03 3 1  ON 66
ci_068                -5.044188e-03 3 1  ON 67
ci_069                -4.842966e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2178
    reference variance = 0.170445
====================================================
  Execution time = 1.4535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1070e-01
  Total weights = 1.956665335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029382117
                                         uncertainty =       0.001659604982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029382117
                                         uncertainty =       0.001659604982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386001398
  error estimate for blocks of size 2^( 2) =       0.000395836878
  error estimate for blocks of size 2^( 3) =       0.000404505612
  error estimate for blocks of size 2^( 4) =       0.000411615073
  error estimate for blocks of size 2^( 5) =       0.000416107167
  error estimate for blocks of size 2^( 6) =       0.000419955679
  error estimate for blocks of size 2^( 7) =       0.000420446910

      target function =                  N/A
              le_mean =     -17.216854504196
             les_mean =     296.730783029150
             stat err =       0.000417031207
             autocorr =       1.167237831411
              std dev =       0.545888412381
             le_variance =       0.297994158772


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685450420e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216854504267       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216871956790       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216870669543       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216870416177       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216870469016       residual = 6.80e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 9.606729e-04

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216854504267       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216865571400       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216865120519       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216865083404       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.807677e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216854504267       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216858996725       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216859080332       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 2.242369e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7059e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.035008e-02 3 1  ON 0
ci_002                -3.005374e-02 3 1  ON 1
ci_003                -2.530101e-02 3 1  ON 2
ci_004                 2.121429e-02 3 1  ON 3
ci_005                 2.163139e-02 3 1  ON 4
ci_006                -1.860711e-02 3 1  ON 5
ci_007                -1.861680e-02 3 1  ON 6
ci_008                -1.803881e-02 3 1  ON 7
ci_009                -1.736244e-02 3 1  ON 8
ci_010                -1.721092e-02 3 1  ON 9
ci_011                -1.665401e-02 3 1  ON 10
ci_012                -1.670212e-02 3 1  ON 11
ci_013                -1.890588e-02 3 1  ON 12
ci_014                 1.328433e-02 3 1  ON 13
ci_015                 1.336916e-02 3 1  ON 14
ci_016                 1.645556e-02 3 1  ON 15
ci_017                 1.607375e-02 3 1  ON 16
ci_018                 1.255216e-02 3 1  ON 17
ci_019                 1.292263e-02 3 1  ON 18
ci_020                 1.303989e-02 3 1  ON 19
ci_021                 1.313120e-02 3 1  ON 20
ci_022                 1.177432e-02 3 1  ON 21
ci_023                 1.142840e-02 3 1  ON 22
ci_024                 1.114970e-02 3 1  ON 23
ci_025                 1.119066e-02 3 1  ON 24
ci_026                 1.102688e-02 3 1  ON 25
ci_027                 1.153687e-02 3 1  ON 26
ci_028                -1.401778e-02 3 1  ON 27
ci_029                -1.464256e-02 3 1  ON 28
ci_030                -1.131879e-02 3 1  ON 29
ci_031                -1.114652e-02 3 1  ON 30
ci_032                -1.369494e-02 3 1  ON 31
ci_033                 1.025458e-02 3 1  ON 32
ci_034                 1.026639e-02 3 1  ON 33
ci_035                -4.650836e-03 3 1  ON 34
ci_036                -1.031832e-02 3 1  ON 35
ci_037                -1.032285e-02 3 1  ON 36
ci_038                 1.770731e-03 3 1  ON 37
ci_039                 1.649431e-03 3 1  ON 38
ci_040                -4.023063e-03 3 1  ON 39
ci_041                 9.744275e-03 3 1  ON 40
ci_042                 9.723149e-03 3 1  ON 41
ci_043                -2.988158e-03 3 1  ON 42
ci_044                -1.497907e-02 3 1  ON 43
ci_045                -1.767237e-03 3 1  ON 44
ci_046                 5.738272e-03 3 1  ON 45
ci_047                 5.762740e-03 3 1  ON 46
ci_048                -1.179600e-02 3 1  ON 47
ci_049                -1.117965e-02 3 1  ON 48
ci_050                 7.700724e-03 3 1  ON 49
ci_051                 7.661111e-03 3 1  ON 50
ci_052                -6.786483e-03 3 1  ON 51
ci_053                -6.363933e-03 3 1  ON 52
ci_054                -2.806035e-03 3 1  ON 53
ci_055                -3.229113e-03 3 1  ON 54
ci_056                 4.288325e-03 3 1  ON 55
ci_057                 4.672635e-03 3 1  ON 56
ci_058                -6.859674e-03 3 1  ON 57
ci_059                -6.686169e-03 3 1  ON 58
ci_060                 8.630297e-03 3 1  ON 59
ci_061                 8.899312e-03 3 1  ON 60
ci_062                -2.817592e-03 3 1  ON 61
ci_063                -3.069530e-03 3 1  ON 62
ci_064                -3.096501e-03 3 1  ON 63
ci_065                -3.784587e-03 3 1  ON 64
ci_066                 5.966860e-03 3 1  ON 65
ci_067                 5.728518e-03 3 1  ON 66
ci_068                -5.028060e-03 3 1  ON 67
ci_069                -4.477035e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1715
    reference variance = 0.195993
====================================================
  Execution time = 1.3507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1543e-01
  Total weights = 1.9566e+06
  Execution time = 1.8565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297967108853
                                         uncertainty =       0.002403057766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297967108853
                                         uncertainty =       0.002403057766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385955299
  error estimate for blocks of size 2^( 2) =       0.000396185331
  error estimate for blocks of size 2^( 3) =       0.000404956029
  error estimate for blocks of size 2^( 4) =       0.000411319342
  error estimate for blocks of size 2^( 5) =       0.000415326388
  error estimate for blocks of size 2^( 6) =       0.000416211019
  error estimate for blocks of size 2^( 7) =       0.000418818350

      target function =                  N/A
              le_mean =     -17.216985551646
             les_mean =     296.744779639933
             stat err =       0.000415418775
             autocorr =       1.158505835677
              std dev =       0.545823217634
             le_variance =       0.297922984908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298419514431
                                         uncertainty =       0.002421957711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298419514431
                                         uncertainty =       0.002421957711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386249195
  error estimate for blocks of size 2^( 2) =       0.000396470819
  error estimate for blocks of size 2^( 3) =       0.000405244373
  error estimate for blocks of size 2^( 4) =       0.000411604165
  error estimate for blocks of size 2^( 5) =       0.000415585087
  error estimate for blocks of size 2^( 6) =       0.000416431315
  error estimate for blocks of size 2^( 7) =       0.000419067680

      target function =                  N/A
              le_mean =     -17.217008050998
             les_mean =     298.709826731315
             stat err =       0.000415672062
             autocorr =       1.158154493765
              std dev =       0.546238850143
             le_variance =       0.298376881405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299381530326
                                         uncertainty =       0.002618842795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299381530326
                                         uncertainty =       0.002618842795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386870414
  error estimate for blocks of size 2^( 2) =       0.000397075191
  error estimate for blocks of size 2^( 3) =       0.000405868389
  error estimate for blocks of size 2^( 4) =       0.000412257239
  error estimate for blocks of size 2^( 5) =       0.000416297545
  error estimate for blocks of size 2^( 6) =       0.000417123574
  error estimate for blocks of size 2^( 7) =       0.000419669031

      target function =                  N/A
              le_mean =     -17.216986476285
             les_mean =     297.587091917234
             stat err =       0.000416336847
             autocorr =       1.158133596975
              std dev =       0.547117386958
             le_variance =       0.299337435112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955354144
                                         uncertainty =       0.002401112946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297955354144
                                         uncertainty =       0.002401112946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385948063
  error estimate for blocks of size 2^( 2) =       0.000396174564
  error estimate for blocks of size 2^( 3) =       0.000404950116
  error estimate for blocks of size 2^( 4) =       0.000411314732
  error estimate for blocks of size 2^( 5) =       0.000415327668
  error estimate for blocks of size 2^( 6) =       0.000416196093
  error estimate for blocks of size 2^( 7) =       0.000418809561

      target function =                  N/A
              le_mean =     -17.216983581926
             les_mean =     296.742248823677
             stat err =       0.000415412014
             autocorr =       1.158511561381
              std dev =       0.545812985494
             le_variance =       0.297911815134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216985551646        initial
     6.2500e-02     6.2500e-01             9.6067e-04       -17.217008050998  <--
     2.5000e-01     2.5000e+00             5.8077e-04       -17.216986476285
     1.0000e+00     1.0000e+01             2.2424e-04       -17.216983581926

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.2851e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.039468e-02 3 1  ON 0
ci_002                -3.023102e-02 3 1  ON 1
ci_003                -2.513140e-02 3 1  ON 2
ci_004                 2.089609e-02 3 1  ON 3
ci_005                 2.202210e-02 3 1  ON 4
ci_006                -1.837930e-02 3 1  ON 5
ci_007                -1.830639e-02 3 1  ON 6
ci_008                -1.805685e-02 3 1  ON 7
ci_009                -1.725627e-02 3 1  ON 8
ci_010                -1.713261e-02 3 1  ON 9
ci_011                -1.698015e-02 3 1  ON 10
ci_012                -1.683794e-02 3 1  ON 11
ci_013                -1.888833e-02 3 1  ON 12
ci_014                 1.312607e-02 3 1  ON 13
ci_015                 1.298926e-02 3 1  ON 14
ci_016                 1.647266e-02 3 1  ON 15
ci_017                 1.613083e-02 3 1  ON 16
ci_018                 1.246175e-02 3 1  ON 17
ci_019                 1.306080e-02 3 1  ON 18
ci_020                 1.315061e-02 3 1  ON 19
ci_021                 1.304047e-02 3 1  ON 20
ci_022                 1.190578e-02 3 1  ON 21
ci_023                 1.151919e-02 3 1  ON 22
ci_024                 1.087897e-02 3 1  ON 23
ci_025                 1.085288e-02 3 1  ON 24
ci_026                 1.112636e-02 3 1  ON 25
ci_027                 1.155303e-02 3 1  ON 26
ci_028                -1.377031e-02 3 1  ON 27
ci_029                -1.469589e-02 3 1  ON 28
ci_030                -1.132119e-02 3 1  ON 29
ci_031                -1.132563e-02 3 1  ON 30
ci_032                -1.369565e-02 3 1  ON 31
ci_033                 1.037982e-02 3 1  ON 32
ci_034                 1.038889e-02 3 1  ON 33
ci_035                -4.567626e-03 3 1  ON 34
ci_036                -1.023055e-02 3 1  ON 35
ci_037                -1.032044e-02 3 1  ON 36
ci_038                 1.778421e-03 3 1  ON 37
ci_039                 1.677889e-03 3 1  ON 38
ci_040                -4.059701e-03 3 1  ON 39
ci_041                 9.762243e-03 3 1  ON 40
ci_042                 9.814941e-03 3 1  ON 41
ci_043                -2.930276e-03 3 1  ON 42
ci_044                -1.489182e-02 3 1  ON 43
ci_045                -1.735131e-03 3 1  ON 44
ci_046                 5.873833e-03 3 1  ON 45
ci_047                 6.002382e-03 3 1  ON 46
ci_048                -1.159383e-02 3 1  ON 47
ci_049                -1.104709e-02 3 1  ON 48
ci_050                 7.573894e-03 3 1  ON 49
ci_051                 7.835924e-03 3 1  ON 50
ci_052                -6.957491e-03 3 1  ON 51
ci_053                -6.266489e-03 3 1  ON 52
ci_054                -2.762318e-03 3 1  ON 53
ci_055                -3.308833e-03 3 1  ON 54
ci_056                 4.058502e-03 3 1  ON 55
ci_057                 4.695875e-03 3 1  ON 56
ci_058                -6.707221e-03 3 1  ON 57
ci_059                -6.517321e-03 3 1  ON 58
ci_060                 8.921861e-03 3 1  ON 59
ci_061                 8.950691e-03 3 1  ON 60
ci_062                -2.925484e-03 3 1  ON 61
ci_063                -3.079532e-03 3 1  ON 62
ci_064                -3.075738e-03 3 1  ON 63
ci_065                -3.672980e-03 3 1  ON 64
ci_066                 6.077655e-03 3 1  ON 65
ci_067                 5.712209e-03 3 1  ON 66
ci_068                -5.024349e-03 3 1  ON 67
ci_069                -4.251140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.220767
====================================================
  Execution time = 1.4627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1674e-01
  Total weights = 1.956515335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300705118313
                                         uncertainty =       0.001873624217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300705118313
                                         uncertainty =       0.001873624217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768436
  error estimate for blocks of size 2^( 2) =       0.000397772452
  error estimate for blocks of size 2^( 3) =       0.000406787783
  error estimate for blocks of size 2^( 4) =       0.000413695873
  error estimate for blocks of size 2^( 5) =       0.000418805291
  error estimate for blocks of size 2^( 6) =       0.000420693760
  error estimate for blocks of size 2^( 7) =       0.000422600276

      target function =                  N/A
              le_mean =     -17.216375596262
             les_mean =     296.720327642322
             stat err =       0.000418948800
             autocorr =       1.167285235532
              std dev =       0.548387380721
             le_variance =       0.300728719334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637559626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216375596288       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216382089629       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216386713026       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216385630627       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216385689102       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-02 is 1.401826e-03

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216375596288       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216381096844       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216384513756       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383807357       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383854547       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.136909e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216375596288       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379009451       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216380512729       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216380296873       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.906060e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7132e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.141650e-02 3 1  ON 0
ci_002                -2.993753e-02 3 1  ON 1
ci_003                -2.482135e-02 3 1  ON 2
ci_004                 2.069152e-02 3 1  ON 3
ci_005                 2.190372e-02 3 1  ON 4
ci_006                -1.897927e-02 3 1  ON 5
ci_007                -1.849089e-02 3 1  ON 6
ci_008                -1.795430e-02 3 1  ON 7
ci_009                -1.741589e-02 3 1  ON 8
ci_010                -1.668150e-02 3 1  ON 9
ci_011                -1.606127e-02 3 1  ON 10
ci_012                -1.626340e-02 3 1  ON 11
ci_013                -1.938969e-02 3 1  ON 12
ci_014                 1.298476e-02 3 1  ON 13
ci_015                 1.355428e-02 3 1  ON 14
ci_016                 1.662065e-02 3 1  ON 15
ci_017                 1.647097e-02 3 1  ON 16
ci_018                 1.258777e-02 3 1  ON 17
ci_019                 1.280948e-02 3 1  ON 18
ci_020                 1.402921e-02 3 1  ON 19
ci_021                 1.225993e-02 3 1  ON 20
ci_022                 1.139338e-02 3 1  ON 21
ci_023                 1.112567e-02 3 1  ON 22
ci_024                 1.171154e-02 3 1  ON 23
ci_025                 1.194928e-02 3 1  ON 24
ci_026                 1.071605e-02 3 1  ON 25
ci_027                 1.087168e-02 3 1  ON 26
ci_028                -1.467954e-02 3 1  ON 27
ci_029                -1.469753e-02 3 1  ON 28
ci_030                -1.217600e-02 3 1  ON 29
ci_031                -1.018872e-02 3 1  ON 30
ci_032                -1.338126e-02 3 1  ON 31
ci_033                 1.039171e-02 3 1  ON 32
ci_034                 1.045483e-02 3 1  ON 33
ci_035                -4.869673e-03 3 1  ON 34
ci_036                -1.004197e-02 3 1  ON 35
ci_037                -1.022091e-02 3 1  ON 36
ci_038                 1.537999e-03 3 1  ON 37
ci_039                 1.287669e-03 3 1  ON 38
ci_040                -3.812820e-03 3 1  ON 39
ci_041                 9.535061e-03 3 1  ON 40
ci_042                 1.073359e-02 3 1  ON 41
ci_043                -2.773132e-03 3 1  ON 42
ci_044                -1.388117e-02 3 1  ON 43
ci_045                -1.811246e-03 3 1  ON 44
ci_046                 5.783257e-03 3 1  ON 45
ci_047                 5.035958e-03 3 1  ON 46
ci_048                -1.205087e-02 3 1  ON 47
ci_049                -1.151023e-02 3 1  ON 48
ci_050                 7.883188e-03 3 1  ON 49
ci_051                 7.660382e-03 3 1  ON 50
ci_052                -5.949109e-03 3 1  ON 51
ci_053                -6.685175e-03 3 1  ON 52
ci_054                -2.914825e-03 3 1  ON 53
ci_055                -3.552383e-03 3 1  ON 54
ci_056                 4.212360e-03 3 1  ON 55
ci_057                 4.423122e-03 3 1  ON 56
ci_058                -6.580543e-03 3 1  ON 57
ci_059                -6.347679e-03 3 1  ON 58
ci_060                 8.150812e-03 3 1  ON 59
ci_061                 9.024991e-03 3 1  ON 60
ci_062                -2.980472e-03 3 1  ON 61
ci_063                -3.193713e-03 3 1  ON 62
ci_064                -3.306331e-03 3 1  ON 63
ci_065                -4.024799e-03 3 1  ON 64
ci_066                 6.299434e-03 3 1  ON 65
ci_067                 5.073751e-03 3 1  ON 66
ci_068                -4.252206e-03 3 1  ON 67
ci_069                -4.396204e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1477
    reference variance = 0.159288
====================================================
  Execution time = 1.3857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2115e-01
  Total weights = 1.9567e+06
  Execution time = 1.8549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.250169
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302652656382
                                         uncertainty =       0.002878874223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302652656382
                                         uncertainty =       0.002878874223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389022186
  error estimate for blocks of size 2^( 2) =       0.000398928707
  error estimate for blocks of size 2^( 3) =       0.000407448849
  error estimate for blocks of size 2^( 4) =       0.000414274891
  error estimate for blocks of size 2^( 5) =       0.000418663062
  error estimate for blocks of size 2^( 6) =       0.000420811785
  error estimate for blocks of size 2^( 7) =       0.000422605585

      target function =                  N/A
              le_mean =     -17.216859212798
             les_mean =     296.751931450929
             stat err =       0.000419088831
             autocorr =       1.160548869597
              std dev =       0.550160451752
             le_variance =       0.302676522672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300917618597
                                         uncertainty =       0.002639646867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300917618597
                                         uncertainty =       0.002639646867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387905087
  error estimate for blocks of size 2^( 2) =       0.000397855701
  error estimate for blocks of size 2^( 3) =       0.000406414027
  error estimate for blocks of size 2^( 4) =       0.000413269886
  error estimate for blocks of size 2^( 5) =       0.000417722531
  error estimate for blocks of size 2^( 6) =       0.000419900223
  error estimate for blocks of size 2^( 7) =       0.000421700388

      target function =                  N/A
              le_mean =     -17.216797221231
             les_mean =     296.739964488398
             stat err =       0.000418148257
             autocorr =       1.162009377059
              std dev =       0.548580634641
             le_variance =       0.300940712703

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.26072
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300585116773
                                         uncertainty =       0.002542090009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300585116773
                                         uncertainty =       0.002542090009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689842
  error estimate for blocks of size 2^( 2) =       0.000397668514
  error estimate for blocks of size 2^( 3) =       0.000406249399
  error estimate for blocks of size 2^( 4) =       0.000413118821
  error estimate for blocks of size 2^( 5) =       0.000417602431
  error estimate for blocks of size 2^( 6) =       0.000419795890
  error estimate for blocks of size 2^( 7) =       0.000421597065

      target function =                  N/A
              le_mean =     -17.216823817189
             les_mean =     296.740094882885
             stat err =       0.000418028552
             autocorr =       1.162634076257
              std dev =       0.548276232097
             le_variance =       0.300606826682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301564236987
                                         uncertainty =       0.002734315520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301564236987
                                         uncertainty =       0.002734315520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388321963
  error estimate for blocks of size 2^( 2) =       0.000398251760
  error estimate for blocks of size 2^( 3) =       0.000406791331
  error estimate for blocks of size 2^( 4) =       0.000413633427
  error estimate for blocks of size 2^( 5) =       0.000418059591
  error estimate for blocks of size 2^( 6) =       0.000420224324
  error estimate for blocks of size 2^( 7) =       0.000422027383

      target function =                  N/A
              le_mean =     -17.216811410369
             les_mean =     296.751657975714
             stat err =       0.000418486181
             autocorr =       1.161390676402
              std dev =       0.549170186479
             le_variance =       0.301587893717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216859212798        initial  <--
     1.5625e-02     1.5625e-01             1.4018e-03       -17.216797221231
     6.2500e-02     6.2500e-01             1.1369e-03       -17.216823817189
     2.5000e-01     2.5000e+00             6.9061e-04       -17.216811410369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1973
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.039468e-02 3 1  ON 0
ci_002                -3.023102e-02 3 1  ON 1
ci_003                -2.513140e-02 3 1  ON 2
ci_004                 2.089609e-02 3 1  ON 3
ci_005                 2.202210e-02 3 1  ON 4
ci_006                -1.837930e-02 3 1  ON 5
ci_007                -1.830639e-02 3 1  ON 6
ci_008                -1.805685e-02 3 1  ON 7
ci_009                -1.725627e-02 3 1  ON 8
ci_010                -1.713261e-02 3 1  ON 9
ci_011                -1.698015e-02 3 1  ON 10
ci_012                -1.683794e-02 3 1  ON 11
ci_013                -1.888833e-02 3 1  ON 12
ci_014                 1.312607e-02 3 1  ON 13
ci_015                 1.298926e-02 3 1  ON 14
ci_016                 1.647266e-02 3 1  ON 15
ci_017                 1.613083e-02 3 1  ON 16
ci_018                 1.246175e-02 3 1  ON 17
ci_019                 1.306080e-02 3 1  ON 18
ci_020                 1.315061e-02 3 1  ON 19
ci_021                 1.304047e-02 3 1  ON 20
ci_022                 1.190578e-02 3 1  ON 21
ci_023                 1.151919e-02 3 1  ON 22
ci_024                 1.087897e-02 3 1  ON 23
ci_025                 1.085288e-02 3 1  ON 24
ci_026                 1.112636e-02 3 1  ON 25
ci_027                 1.155303e-02 3 1  ON 26
ci_028                -1.377031e-02 3 1  ON 27
ci_029                -1.469589e-02 3 1  ON 28
ci_030                -1.132119e-02 3 1  ON 29
ci_031                -1.132563e-02 3 1  ON 30
ci_032                -1.369565e-02 3 1  ON 31
ci_033                 1.037982e-02 3 1  ON 32
ci_034                 1.038889e-02 3 1  ON 33
ci_035                -4.567626e-03 3 1  ON 34
ci_036                -1.023055e-02 3 1  ON 35
ci_037                -1.032044e-02 3 1  ON 36
ci_038                 1.778421e-03 3 1  ON 37
ci_039                 1.677889e-03 3 1  ON 38
ci_040                -4.059701e-03 3 1  ON 39
ci_041                 9.762243e-03 3 1  ON 40
ci_042                 9.814941e-03 3 1  ON 41
ci_043                -2.930276e-03 3 1  ON 42
ci_044                -1.489182e-02 3 1  ON 43
ci_045                -1.735131e-03 3 1  ON 44
ci_046                 5.873833e-03 3 1  ON 45
ci_047                 6.002382e-03 3 1  ON 46
ci_048                -1.159383e-02 3 1  ON 47
ci_049                -1.104709e-02 3 1  ON 48
ci_050                 7.573894e-03 3 1  ON 49
ci_051                 7.835924e-03 3 1  ON 50
ci_052                -6.957491e-03 3 1  ON 51
ci_053                -6.266489e-03 3 1  ON 52
ci_054                -2.762318e-03 3 1  ON 53
ci_055                -3.308833e-03 3 1  ON 54
ci_056                 4.058502e-03 3 1  ON 55
ci_057                 4.695875e-03 3 1  ON 56
ci_058                -6.707221e-03 3 1  ON 57
ci_059                -6.517321e-03 3 1  ON 58
ci_060                 8.921861e-03 3 1  ON 59
ci_061                 8.950691e-03 3 1  ON 60
ci_062                -2.925484e-03 3 1  ON 61
ci_063                -3.079532e-03 3 1  ON 62
ci_064                -3.075738e-03 3 1  ON 63
ci_065                -3.672980e-03 3 1  ON 64
ci_066                 6.077655e-03 3 1  ON 65
ci_067                 5.712209e-03 3 1  ON 66
ci_068                -5.024349e-03 3 1  ON 67
ci_069                -4.251140e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.25125
====================================================
  Execution time = 1.4128e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1683e-01
  Total weights = 1.956562931e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.3333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300937466525
                                         uncertainty =       0.002486643976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300937466525
                                         uncertainty =       0.002486643976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387965906
  error estimate for blocks of size 2^( 2) =       0.000397992876
  error estimate for blocks of size 2^( 3) =       0.000407092509
  error estimate for blocks of size 2^( 4) =       0.000413376484
  error estimate for blocks of size 2^( 5) =       0.000418115697
  error estimate for blocks of size 2^( 6) =       0.000420469087
  error estimate for blocks of size 2^( 7) =       0.000422933703

      target function =                  N/A
              le_mean =     -17.216402927605
             les_mean =     296.721359506438
             stat err =       0.000418723743
             autocorr =       1.164844757783
              std dev =       0.548666646473
             le_variance =       0.301035088952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640292760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216402927651       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216403157102       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216405561156       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216405514310       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.051574e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216402927651       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216403030882       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216403943600       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216403949490       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.257123e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216402927651       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216402959907       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216403221739       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216403240422       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.257600e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9430e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.055013e-02 3 1  ON 0
ci_002                -3.037375e-02 3 1  ON 1
ci_003                -2.517594e-02 3 1  ON 2
ci_004                 2.082998e-02 3 1  ON 3
ci_005                 2.159639e-02 3 1  ON 4
ci_006                -1.831440e-02 3 1  ON 5
ci_007                -1.833258e-02 3 1  ON 6
ci_008                -1.795860e-02 3 1  ON 7
ci_009                -1.746274e-02 3 1  ON 8
ci_010                -1.739888e-02 3 1  ON 9
ci_011                -1.687408e-02 3 1  ON 10
ci_012                -1.654911e-02 3 1  ON 11
ci_013                -1.901800e-02 3 1  ON 12
ci_014                 1.351599e-02 3 1  ON 13
ci_015                 1.314012e-02 3 1  ON 14
ci_016                 1.640719e-02 3 1  ON 15
ci_017                 1.631550e-02 3 1  ON 16
ci_018                 1.276491e-02 3 1  ON 17
ci_019                 1.316167e-02 3 1  ON 18
ci_020                 1.327334e-02 3 1  ON 19
ci_021                 1.313577e-02 3 1  ON 20
ci_022                 1.177023e-02 3 1  ON 21
ci_023                 1.155834e-02 3 1  ON 22
ci_024                 1.090747e-02 3 1  ON 23
ci_025                 1.109021e-02 3 1  ON 24
ci_026                 1.121935e-02 3 1  ON 25
ci_027                 1.143479e-02 3 1  ON 26
ci_028                -1.381962e-02 3 1  ON 27
ci_029                -1.450264e-02 3 1  ON 28
ci_030                -1.147781e-02 3 1  ON 29
ci_031                -1.140394e-02 3 1  ON 30
ci_032                -1.381052e-02 3 1  ON 31
ci_033                 1.044265e-02 3 1  ON 32
ci_034                 1.044774e-02 3 1  ON 33
ci_035                -4.650617e-03 3 1  ON 34
ci_036                -1.035419e-02 3 1  ON 35
ci_037                -1.006610e-02 3 1  ON 36
ci_038                 1.865198e-03 3 1  ON 37
ci_039                 1.729044e-03 3 1  ON 38
ci_040                -3.993632e-03 3 1  ON 39
ci_041                 9.720473e-03 3 1  ON 40
ci_042                 1.002009e-02 3 1  ON 41
ci_043                -2.968254e-03 3 1  ON 42
ci_044                -1.478204e-02 3 1  ON 43
ci_045                -1.662616e-03 3 1  ON 44
ci_046                 5.930306e-03 3 1  ON 45
ci_047                 6.057337e-03 3 1  ON 46
ci_048                -1.177822e-02 3 1  ON 47
ci_049                -1.131545e-02 3 1  ON 48
ci_050                 7.608639e-03 3 1  ON 49
ci_051                 7.771753e-03 3 1  ON 50
ci_052                -6.937413e-03 3 1  ON 51
ci_053                -6.368636e-03 3 1  ON 52
ci_054                -2.951106e-03 3 1  ON 53
ci_055                -3.163641e-03 3 1  ON 54
ci_056                 4.181938e-03 3 1  ON 55
ci_057                 4.760983e-03 3 1  ON 56
ci_058                -6.781560e-03 3 1  ON 57
ci_059                -6.256889e-03 3 1  ON 58
ci_060                 8.619849e-03 3 1  ON 59
ci_061                 8.947348e-03 3 1  ON 60
ci_062                -3.115069e-03 3 1  ON 61
ci_063                -2.864347e-03 3 1  ON 62
ci_064                -3.064811e-03 3 1  ON 63
ci_065                -3.725933e-03 3 1  ON 64
ci_066                 6.119717e-03 3 1  ON 65
ci_067                 5.597176e-03 3 1  ON 66
ci_068                -5.145953e-03 3 1  ON 67
ci_069                -4.399982e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1563
    reference variance = 0.229619
====================================================
  Execution time = 1.3456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1445e-01
  Total weights = 1.9566e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299361315602
                                         uncertainty =       0.002014808436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299361315602
                                         uncertainty =       0.002014808436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386937698
  error estimate for blocks of size 2^( 2) =       0.000397104180
  error estimate for blocks of size 2^( 3) =       0.000406491479
  error estimate for blocks of size 2^( 4) =       0.000412549426
  error estimate for blocks of size 2^( 5) =       0.000416416514
  error estimate for blocks of size 2^( 6) =       0.000418169544
  error estimate for blocks of size 2^( 7) =       0.000419995555

      target function =                  N/A
              le_mean =     -17.216346419542
             les_mean =     296.717414362983
             stat err =       0.000416782760
             autocorr =       1.160212138369
              std dev =       0.547212540049
             le_variance =       0.299441563987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299491508454
                                         uncertainty =       0.002016530394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299491508454
                                         uncertainty =       0.002016530394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387021401
  error estimate for blocks of size 2^( 2) =       0.000397167129
  error estimate for blocks of size 2^( 3) =       0.000406520043
  error estimate for blocks of size 2^( 4) =       0.000412569065
  error estimate for blocks of size 2^( 5) =       0.000416456212
  error estimate for blocks of size 2^( 6) =       0.000418218477
  error estimate for blocks of size 2^( 7) =       0.000420027437

      target function =                  N/A
              le_mean =     -17.216349015237
             les_mean =     296.719121966901
             stat err =       0.000416817798
             autocorr =       1.159905343167
              std dev =       0.547330913568
             le_variance =       0.299571128948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299474877804
                                         uncertainty =       0.002016062878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299474877804
                                         uncertainty =       0.002016062878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387010799
  error estimate for blocks of size 2^( 2) =       0.000397158721
  error estimate for blocks of size 2^( 3) =       0.000406512494
  error estimate for blocks of size 2^( 4) =       0.000412558002
  error estimate for blocks of size 2^( 5) =       0.000416442509
  error estimate for blocks of size 2^( 6) =       0.000418203008
  error estimate for blocks of size 2^( 7) =       0.000420015205

      target function =                  N/A
              le_mean =     -17.216345380540
             les_mean =     296.717635528554
             stat err =       0.000416804681
             autocorr =       1.159895887762
              std dev =       0.547315920581
             le_variance =       0.299554716921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299362649297
                                         uncertainty =       0.002014672350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299362649297
                                         uncertainty =       0.002014672350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386938536
  error estimate for blocks of size 2^( 2) =       0.000397102111
  error estimate for blocks of size 2^( 3) =       0.000406484253
  error estimate for blocks of size 2^( 4) =       0.000412540451
  error estimate for blocks of size 2^( 5) =       0.000416410239
  error estimate for blocks of size 2^( 6) =       0.000418165453
  error estimate for blocks of size 2^( 7) =       0.000419988830

      target function =                  N/A
              le_mean =     -17.216344190221
             les_mean =     296.717840114989
             stat err =       0.000416776243
             autocorr =       1.160170836681
              std dev =       0.547213724854
             le_variance =       0.299442860669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216346419542        initial
     1.5625e-01     1.5625e+00             1.0516e-03       -17.216349015237  <--
     6.2500e-01     6.2500e+00             4.2571e-04       -17.216345380540
     2.5000e+00     2.5000e+01             1.2576e-04       -17.216344190221

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.2792e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.074475e-02 3 1  ON 0
ci_002                -3.053392e-02 3 1  ON 1
ci_003                -2.520061e-02 3 1  ON 2
ci_004                 2.069961e-02 3 1  ON 3
ci_005                 2.097053e-02 3 1  ON 4
ci_006                -1.820941e-02 3 1  ON 5
ci_007                -1.834012e-02 3 1  ON 6
ci_008                -1.784282e-02 3 1  ON 7
ci_009                -1.766797e-02 3 1  ON 8
ci_010                -1.777384e-02 3 1  ON 9
ci_011                -1.674543e-02 3 1  ON 10
ci_012                -1.619176e-02 3 1  ON 11
ci_013                -1.920197e-02 3 1  ON 12
ci_014                 1.398426e-02 3 1  ON 13
ci_015                 1.332775e-02 3 1  ON 14
ci_016                 1.631230e-02 3 1  ON 15
ci_017                 1.653829e-02 3 1  ON 16
ci_018                 1.311373e-02 3 1  ON 17
ci_019                 1.327681e-02 3 1  ON 18
ci_020                 1.344560e-02 3 1  ON 19
ci_021                 1.325264e-02 3 1  ON 20
ci_022                 1.159626e-02 3 1  ON 21
ci_023                 1.160636e-02 3 1  ON 22
ci_024                 1.097649e-02 3 1  ON 23
ci_025                 1.145014e-02 3 1  ON 24
ci_026                 1.130933e-02 3 1  ON 25
ci_027                 1.127926e-02 3 1  ON 26
ci_028                -1.389381e-02 3 1  ON 27
ci_029                -1.422750e-02 3 1  ON 28
ci_030                -1.166513e-02 3 1  ON 29
ci_031                -1.150130e-02 3 1  ON 30
ci_032                -1.393271e-02 3 1  ON 31
ci_033                 1.052178e-02 3 1  ON 32
ci_034                 1.050679e-02 3 1  ON 33
ci_035                -4.716620e-03 3 1  ON 34
ci_036                -1.051174e-02 3 1  ON 35
ci_037                -9.730893e-03 3 1  ON 36
ci_038                 1.934672e-03 3 1  ON 37
ci_039                 1.771438e-03 3 1  ON 38
ci_040                -3.939476e-03 3 1  ON 39
ci_041                 9.654915e-03 3 1  ON 40
ci_042                 1.024991e-02 3 1  ON 41
ci_043                -3.001440e-03 3 1  ON 42
ci_044                -1.459977e-02 3 1  ON 43
ci_045                -1.604107e-03 3 1  ON 44
ci_046                 5.987722e-03 3 1  ON 45
ci_047                 6.118559e-03 3 1  ON 46
ci_048                -1.207212e-02 3 1  ON 47
ci_049                -1.173764e-02 3 1  ON 48
ci_050                 7.638557e-03 3 1  ON 49
ci_051                 7.709649e-03 3 1  ON 50
ci_052                -6.916206e-03 3 1  ON 51
ci_053                -6.476665e-03 3 1  ON 52
ci_054                -3.149201e-03 3 1  ON 53
ci_055                -3.011096e-03 3 1  ON 54
ci_056                 4.302787e-03 3 1  ON 55
ci_057                 4.822805e-03 3 1  ON 56
ci_058                -6.859263e-03 3 1  ON 57
ci_059                -5.979263e-03 3 1  ON 58
ci_060                 8.265708e-03 3 1  ON 59
ci_061                 8.949888e-03 3 1  ON 60
ci_062                -3.320371e-03 3 1  ON 61
ci_063                -2.629370e-03 3 1  ON 62
ci_064                -3.060713e-03 3 1  ON 63
ci_065                -3.761129e-03 3 1  ON 64
ci_066                 6.158477e-03 3 1  ON 65
ci_067                 5.489861e-03 3 1  ON 66
ci_068                -5.287051e-03 3 1  ON 67
ci_069                -4.562234e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7190e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1832
    reference variance = 0.252536
====================================================
  Execution time = 1.4665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1748e-01
  Total weights = 1.956574137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301918401712
                                         uncertainty =       0.002292653671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301918401712
                                         uncertainty =       0.002292653671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388549866
  error estimate for blocks of size 2^( 2) =       0.000398818156
  error estimate for blocks of size 2^( 3) =       0.000408010812
  error estimate for blocks of size 2^( 4) =       0.000414349244
  error estimate for blocks of size 2^( 5) =       0.000418871991
  error estimate for blocks of size 2^( 6) =       0.000421081369
  error estimate for blocks of size 2^( 7) =       0.000418948031

      target function =                  N/A
              le_mean =     -17.216685218427
             les_mean =     296.731725752245
             stat err =       0.000418312659
             autocorr =       1.159066855891
              std dev =       0.549492490266
             le_variance =       0.301941996859


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668521843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216685218494       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705601660       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216707566078       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216708307808       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216708217522       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.125094e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216685218494       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216700059305       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216700825308       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216701076447       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 8.137152e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216685218494       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216692327399       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692338519       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.157763e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013818 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7186e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.091071e-02 3 1  ON 0
ci_002                -3.020140e-02 3 1  ON 1
ci_003                -2.449170e-02 3 1  ON 2
ci_004                 2.065196e-02 3 1  ON 3
ci_005                 2.074473e-02 3 1  ON 4
ci_006                -1.852844e-02 3 1  ON 5
ci_007                -1.838159e-02 3 1  ON 6
ci_008                -1.811487e-02 3 1  ON 7
ci_009                -1.800574e-02 3 1  ON 8
ci_010                -1.733158e-02 3 1  ON 9
ci_011                -1.637115e-02 3 1  ON 10
ci_012                -1.590260e-02 3 1  ON 11
ci_013                -1.902796e-02 3 1  ON 12
ci_014                 1.414330e-02 3 1  ON 13
ci_015                 1.352262e-02 3 1  ON 14
ci_016                 1.655534e-02 3 1  ON 15
ci_017                 1.643125e-02 3 1  ON 16
ci_018                 1.269516e-02 3 1  ON 17
ci_019                 1.276955e-02 3 1  ON 18
ci_020                 1.319910e-02 3 1  ON 19
ci_021                 1.315437e-02 3 1  ON 20
ci_022                 1.186044e-02 3 1  ON 21
ci_023                 1.155157e-02 3 1  ON 22
ci_024                 1.101587e-02 3 1  ON 23
ci_025                 1.132810e-02 3 1  ON 24
ci_026                 1.135487e-02 3 1  ON 25
ci_027                 1.062428e-02 3 1  ON 26
ci_028                -1.401516e-02 3 1  ON 27
ci_029                -1.484524e-02 3 1  ON 28
ci_030                -1.132084e-02 3 1  ON 29
ci_031                -1.161104e-02 3 1  ON 30
ci_032                -1.333509e-02 3 1  ON 31
ci_033                 1.038694e-02 3 1  ON 32
ci_034                 1.044038e-02 3 1  ON 33
ci_035                -4.700548e-03 3 1  ON 34
ci_036                -1.075601e-02 3 1  ON 35
ci_037                -1.009027e-02 3 1  ON 36
ci_038                 1.790871e-03 3 1  ON 37
ci_039                 1.652961e-03 3 1  ON 38
ci_040                -4.480193e-03 3 1  ON 39
ci_041                 9.659018e-03 3 1  ON 40
ci_042                 9.853848e-03 3 1  ON 41
ci_043                -3.030815e-03 3 1  ON 42
ci_044                -1.463318e-02 3 1  ON 43
ci_045                -1.322613e-03 3 1  ON 44
ci_046                 5.320126e-03 3 1  ON 45
ci_047                 5.749978e-03 3 1  ON 46
ci_048                -1.200311e-02 3 1  ON 47
ci_049                -1.198118e-02 3 1  ON 48
ci_050                 7.875559e-03 3 1  ON 49
ci_051                 7.517774e-03 3 1  ON 50
ci_052                -6.635442e-03 3 1  ON 51
ci_053                -6.263332e-03 3 1  ON 52
ci_054                -2.739658e-03 3 1  ON 53
ci_055                -3.242412e-03 3 1  ON 54
ci_056                 5.116502e-03 3 1  ON 55
ci_057                 4.361048e-03 3 1  ON 56
ci_058                -6.680324e-03 3 1  ON 57
ci_059                -6.543271e-03 3 1  ON 58
ci_060                 8.344329e-03 3 1  ON 59
ci_061                 8.363728e-03 3 1  ON 60
ci_062                -3.501575e-03 3 1  ON 61
ci_063                -2.941224e-03 3 1  ON 62
ci_064                -3.008163e-03 3 1  ON 63
ci_065                -3.891794e-03 3 1  ON 64
ci_066                 5.656385e-03 3 1  ON 65
ci_067                 5.705383e-03 3 1  ON 66
ci_068                -5.289039e-03 3 1  ON 67
ci_069                -4.640808e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.310186
====================================================
  Execution time = 1.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0649e-01
  Total weights = 1.9567e+06
  Execution time = 1.8470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294786953006
                                         uncertainty =       0.001527049732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294786953006
                                         uncertainty =       0.001527049732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383946898
  error estimate for blocks of size 2^( 2) =       0.000394365915
  error estimate for blocks of size 2^( 3) =       0.000403783729
  error estimate for blocks of size 2^( 4) =       0.000410571230
  error estimate for blocks of size 2^( 5) =       0.000415796400
  error estimate for blocks of size 2^( 6) =       0.000418226139
  error estimate for blocks of size 2^( 7) =       0.000420688451

      target function =                  N/A
              le_mean =     -17.215678697376
             les_mean =     296.688373405843
             stat err =       0.000416320555
             autocorr =       1.175745650911
              std dev =       0.542982910457
             le_variance =       0.294830441049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294178075273
                                         uncertainty =       0.001504956514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294178075273
                                         uncertainty =       0.001504956514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383551128
  error estimate for blocks of size 2^( 2) =       0.000394001506
  error estimate for blocks of size 2^( 3) =       0.000403438640
  error estimate for blocks of size 2^( 4) =       0.000410254906
  error estimate for blocks of size 2^( 5) =       0.000415514188
  error estimate for blocks of size 2^( 6) =       0.000418027285
  error estimate for blocks of size 2^( 7) =       0.000420611360

      target function =                  N/A
              le_mean =     -17.215665591210
             les_mean =     296.686120796879
             stat err =       0.000416101935
             autocorr =       1.176936252846
              std dev =       0.542423207520
             le_variance =       0.294222936056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294147002164
                                         uncertainty =       0.001497724825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294147002164
                                         uncertainty =       0.001497724825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383531250
  error estimate for blocks of size 2^( 2) =       0.000393994317
  error estimate for blocks of size 2^( 3) =       0.000403437585
  error estimate for blocks of size 2^( 4) =       0.000410262529
  error estimate for blocks of size 2^( 5) =       0.000415534192
  error estimate for blocks of size 2^( 6) =       0.000418085584
  error estimate for blocks of size 2^( 7) =       0.000420725636

      target function =                  N/A
              le_mean =     -17.215683352231
             les_mean =     296.688710798045
             stat err =       0.000416151985
             autocorr =       1.177341434543
              std dev =       0.542395095893
             le_variance =       0.294192440049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294535584017
                                         uncertainty =       0.001518462821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294535584017
                                         uncertainty =       0.001518462821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383783550
  error estimate for blocks of size 2^( 2) =       0.000394211429
  error estimate for blocks of size 2^( 3) =       0.000403633833
  error estimate for blocks of size 2^( 4) =       0.000410429936
  error estimate for blocks of size 2^( 5) =       0.000415668642
  error estimate for blocks of size 2^( 6) =       0.000418127858
  error estimate for blocks of size 2^( 7) =       0.000420633786

      target function =                  N/A
              le_mean =     -17.215665953302
             les_mean =     296.686608718162
             stat err =       0.000416215056
             autocorr =       1.176150396956
              std dev =       0.542751901587
             le_variance =       0.294579626676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215678697376        initial
     3.9062e-02     3.9062e-01             1.1251e-03       -17.215665591210
     1.5625e-01     1.5625e+00             8.1372e-04       -17.215683352231  <--
     6.2500e-01     6.2500e+00             4.1578e-04       -17.215665953302

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.2860e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.091071e-02 3 1  ON 0
ci_002                -3.020140e-02 3 1  ON 1
ci_003                -2.449170e-02 3 1  ON 2
ci_004                 2.065196e-02 3 1  ON 3
ci_005                 2.074473e-02 3 1  ON 4
ci_006                -1.852844e-02 3 1  ON 5
ci_007                -1.838159e-02 3 1  ON 6
ci_008                -1.811487e-02 3 1  ON 7
ci_009                -1.800574e-02 3 1  ON 8
ci_010                -1.733158e-02 3 1  ON 9
ci_011                -1.637115e-02 3 1  ON 10
ci_012                -1.590260e-02 3 1  ON 11
ci_013                -1.902796e-02 3 1  ON 12
ci_014                 1.414330e-02 3 1  ON 13
ci_015                 1.352262e-02 3 1  ON 14
ci_016                 1.655534e-02 3 1  ON 15
ci_017                 1.643125e-02 3 1  ON 16
ci_018                 1.269516e-02 3 1  ON 17
ci_019                 1.276955e-02 3 1  ON 18
ci_020                 1.319910e-02 3 1  ON 19
ci_021                 1.315437e-02 3 1  ON 20
ci_022                 1.186044e-02 3 1  ON 21
ci_023                 1.155157e-02 3 1  ON 22
ci_024                 1.101587e-02 3 1  ON 23
ci_025                 1.132810e-02 3 1  ON 24
ci_026                 1.135487e-02 3 1  ON 25
ci_027                 1.062428e-02 3 1  ON 26
ci_028                -1.401516e-02 3 1  ON 27
ci_029                -1.484524e-02 3 1  ON 28
ci_030                -1.132084e-02 3 1  ON 29
ci_031                -1.161104e-02 3 1  ON 30
ci_032                -1.333509e-02 3 1  ON 31
ci_033                 1.038694e-02 3 1  ON 32
ci_034                 1.044038e-02 3 1  ON 33
ci_035                -4.700548e-03 3 1  ON 34
ci_036                -1.075601e-02 3 1  ON 35
ci_037                -1.009027e-02 3 1  ON 36
ci_038                 1.790871e-03 3 1  ON 37
ci_039                 1.652961e-03 3 1  ON 38
ci_040                -4.480193e-03 3 1  ON 39
ci_041                 9.659018e-03 3 1  ON 40
ci_042                 9.853848e-03 3 1  ON 41
ci_043                -3.030815e-03 3 1  ON 42
ci_044                -1.463318e-02 3 1  ON 43
ci_045                -1.322613e-03 3 1  ON 44
ci_046                 5.320126e-03 3 1  ON 45
ci_047                 5.749978e-03 3 1  ON 46
ci_048                -1.200311e-02 3 1  ON 47
ci_049                -1.198118e-02 3 1  ON 48
ci_050                 7.875559e-03 3 1  ON 49
ci_051                 7.517774e-03 3 1  ON 50
ci_052                -6.635442e-03 3 1  ON 51
ci_053                -6.263332e-03 3 1  ON 52
ci_054                -2.739658e-03 3 1  ON 53
ci_055                -3.242412e-03 3 1  ON 54
ci_056                 5.116502e-03 3 1  ON 55
ci_057                 4.361048e-03 3 1  ON 56
ci_058                -6.680324e-03 3 1  ON 57
ci_059                -6.543271e-03 3 1  ON 58
ci_060                 8.344329e-03 3 1  ON 59
ci_061                 8.363728e-03 3 1  ON 60
ci_062                -3.501575e-03 3 1  ON 61
ci_063                -2.941224e-03 3 1  ON 62
ci_064                -3.008163e-03 3 1  ON 63
ci_065                -3.891794e-03 3 1  ON 64
ci_066                 5.656385e-03 3 1  ON 65
ci_067                 5.705383e-03 3 1  ON 66
ci_068                -5.289039e-03 3 1  ON 67
ci_069                -4.640808e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.244734
====================================================
  Execution time = 1.4135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1467e-01
  Total weights = 1.956757577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299312921954
                                         uncertainty =       0.001753935078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299312921954
                                         uncertainty =       0.001753935078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386788361
  error estimate for blocks of size 2^( 2) =       0.000397049754
  error estimate for blocks of size 2^( 3) =       0.000406152427
  error estimate for blocks of size 2^( 4) =       0.000412767189
  error estimate for blocks of size 2^( 5) =       0.000417805934
  error estimate for blocks of size 2^( 6) =       0.000419092595
  error estimate for blocks of size 2^( 7) =       0.000419941554

      target function =                  N/A
              le_mean =     -17.216307489018
             les_mean =     296.715909449015
             stat err =       0.000417401818
             autocorr =       1.164560027944
              std dev =       0.547001345331
             le_variance =       0.299210471794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630748902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307489070       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315990722       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216321388190       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216320841697       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216321255023       residual = 1.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-02 is 1.467853e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307489070       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313599950       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216316204766       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216315950385       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 9.456121e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307489070       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216310364978       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216310763627       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216310704155       residual = 2.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 4.316449e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6663e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.047134e-02 3 1  ON 0
ci_002                -3.051801e-02 3 1  ON 1
ci_003                -2.543731e-02 3 1  ON 2
ci_004                 2.094118e-02 3 1  ON 3
ci_005                 2.072278e-02 3 1  ON 4
ci_006                -1.917817e-02 3 1  ON 5
ci_007                -1.884035e-02 3 1  ON 6
ci_008                -1.780344e-02 3 1  ON 7
ci_009                -1.802557e-02 3 1  ON 8
ci_010                -1.697824e-02 3 1  ON 9
ci_011                -1.544026e-02 3 1  ON 10
ci_012                -1.575553e-02 3 1  ON 11
ci_013                -1.856268e-02 3 1  ON 12
ci_014                 1.423285e-02 3 1  ON 13
ci_015                 1.310703e-02 3 1  ON 14
ci_016                 1.665110e-02 3 1  ON 15
ci_017                 1.651726e-02 3 1  ON 16
ci_018                 1.252733e-02 3 1  ON 17
ci_019                 1.267395e-02 3 1  ON 18
ci_020                 1.311457e-02 3 1  ON 19
ci_021                 1.358810e-02 3 1  ON 20
ci_022                 1.151401e-02 3 1  ON 21
ci_023                 1.089715e-02 3 1  ON 22
ci_024                 1.193123e-02 3 1  ON 23
ci_025                 1.134996e-02 3 1  ON 24
ci_026                 1.172653e-02 3 1  ON 25
ci_027                 1.126998e-02 3 1  ON 26
ci_028                -1.431861e-02 3 1  ON 27
ci_029                -1.437609e-02 3 1  ON 28
ci_030                -1.137447e-02 3 1  ON 29
ci_031                -1.173641e-02 3 1  ON 30
ci_032                -1.324859e-02 3 1  ON 31
ci_033                 1.021320e-02 3 1  ON 32
ci_034                 1.009709e-02 3 1  ON 33
ci_035                -4.549011e-03 3 1  ON 34
ci_036                -1.051208e-02 3 1  ON 35
ci_037                -1.033275e-02 3 1  ON 36
ci_038                 1.501294e-03 3 1  ON 37
ci_039                 1.570792e-03 3 1  ON 38
ci_040                -3.943116e-03 3 1  ON 39
ci_041                 9.624943e-03 3 1  ON 40
ci_042                 9.591172e-03 3 1  ON 41
ci_043                -3.489943e-03 3 1  ON 42
ci_044                -1.500941e-02 3 1  ON 43
ci_045                -1.672859e-03 3 1  ON 44
ci_046                 5.593430e-03 3 1  ON 45
ci_047                 5.709238e-03 3 1  ON 46
ci_048                -1.166982e-02 3 1  ON 47
ci_049                -1.220516e-02 3 1  ON 48
ci_050                 8.017702e-03 3 1  ON 49
ci_051                 7.718760e-03 3 1  ON 50
ci_052                -6.605324e-03 3 1  ON 51
ci_053                -6.029296e-03 3 1  ON 52
ci_054                -3.250572e-03 3 1  ON 53
ci_055                -3.226160e-03 3 1  ON 54
ci_056                 5.018261e-03 3 1  ON 55
ci_057                 4.235257e-03 3 1  ON 56
ci_058                -6.596028e-03 3 1  ON 57
ci_059                -6.578946e-03 3 1  ON 58
ci_060                 9.004878e-03 3 1  ON 59
ci_061                 8.149303e-03 3 1  ON 60
ci_062                -3.425313e-03 3 1  ON 61
ci_063                -2.747217e-03 3 1  ON 62
ci_064                -3.183166e-03 3 1  ON 63
ci_065                -4.165542e-03 3 1  ON 64
ci_066                 5.308092e-03 3 1  ON 65
ci_067                 5.771943e-03 3 1  ON 66
ci_068                -4.921533e-03 3 1  ON 67
ci_069                -4.744978e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1724
    reference variance = 0.285701
====================================================
  Execution time = 1.3804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1341e-01
  Total weights = 1.9567e+06
  Execution time = 1.8498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299527991741
                                         uncertainty =       0.001903153658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299527991741
                                         uncertainty =       0.001903153658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387079907
  error estimate for blocks of size 2^( 2) =       0.000396918117
  error estimate for blocks of size 2^( 3) =       0.000406044285
  error estimate for blocks of size 2^( 4) =       0.000412826028
  error estimate for blocks of size 2^( 5) =       0.000417191438
  error estimate for blocks of size 2^( 6) =       0.000418410360
  error estimate for blocks of size 2^( 7) =       0.000418295785

      target function =                  N/A
              le_mean =     -17.216543435514
             les_mean =     296.725066437549
             stat err =       0.000416680903
             autocorr =       1.158793193960
              std dev =       0.547413654858
             le_variance =       0.299661709525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298962272947
                                         uncertainty =       0.001898613758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298962272947
                                         uncertainty =       0.001898613758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386709161
  error estimate for blocks of size 2^( 2) =       0.000396586141
  error estimate for blocks of size 2^( 3) =       0.000405709244
  error estimate for blocks of size 2^( 4) =       0.000412505424
  error estimate for blocks of size 2^( 5) =       0.000416878284
  error estimate for blocks of size 2^( 6) =       0.000418124556
  error estimate for blocks of size 2^( 7) =       0.000418036367

      target function =                  N/A
              le_mean =     -17.216512101131
             les_mean =     296.740849225862
             stat err =       0.000416386158
             autocorr =       1.159374241735
              std dev =       0.546889339576
             le_variance =       0.299087949742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298889884883
                                         uncertainty =       0.001897879728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298889884883
                                         uncertainty =       0.001897879728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386660619
  error estimate for blocks of size 2^( 2) =       0.000396549190
  error estimate for blocks of size 2^( 3) =       0.000405674628
  error estimate for blocks of size 2^( 4) =       0.000412471094
  error estimate for blocks of size 2^( 5) =       0.000416835289
  error estimate for blocks of size 2^( 6) =       0.000418115596
  error estimate for blocks of size 2^( 7) =       0.000418049416

      target function =                  N/A
              le_mean =     -17.216531551472
             les_mean =     296.737206429586
             stat err =       0.000416367849
             autocorr =       1.159563373348
              std dev =       0.546820691648
             le_variance =       0.299012868814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299229930704
                                         uncertainty =       0.001898450301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299229930704
                                         uncertainty =       0.001898450301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386885702
  error estimate for blocks of size 2^( 2) =       0.000396743150
  error estimate for blocks of size 2^( 3) =       0.000405868717
  error estimate for blocks of size 2^( 4) =       0.000412653355
  error estimate for blocks of size 2^( 5) =       0.000417034479
  error estimate for blocks of size 2^( 6) =       0.000418268373
  error estimate for blocks of size 2^( 7) =       0.000418188045

      target function =                  N/A
              le_mean =     -17.216521890567
             les_mean =     296.738825886334
             stat err =       0.000416536063
             autocorr =       1.159150578810
              std dev =       0.547139006730
             le_variance =       0.299361092686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216543435514        initial  <--
     3.9062e-02     3.9062e-01             1.4679e-03       -17.216512101131
     1.5625e-01     1.5625e+00             9.4561e-04       -17.216531551472
     6.2500e-01     6.2500e+00             4.3164e-04       -17.216521890567

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1191
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.091071e-02 3 1  ON 0
ci_002                -3.020140e-02 3 1  ON 1
ci_003                -2.449170e-02 3 1  ON 2
ci_004                 2.065196e-02 3 1  ON 3
ci_005                 2.074473e-02 3 1  ON 4
ci_006                -1.852844e-02 3 1  ON 5
ci_007                -1.838159e-02 3 1  ON 6
ci_008                -1.811487e-02 3 1  ON 7
ci_009                -1.800574e-02 3 1  ON 8
ci_010                -1.733158e-02 3 1  ON 9
ci_011                -1.637115e-02 3 1  ON 10
ci_012                -1.590260e-02 3 1  ON 11
ci_013                -1.902796e-02 3 1  ON 12
ci_014                 1.414330e-02 3 1  ON 13
ci_015                 1.352262e-02 3 1  ON 14
ci_016                 1.655534e-02 3 1  ON 15
ci_017                 1.643125e-02 3 1  ON 16
ci_018                 1.269516e-02 3 1  ON 17
ci_019                 1.276955e-02 3 1  ON 18
ci_020                 1.319910e-02 3 1  ON 19
ci_021                 1.315437e-02 3 1  ON 20
ci_022                 1.186044e-02 3 1  ON 21
ci_023                 1.155157e-02 3 1  ON 22
ci_024                 1.101587e-02 3 1  ON 23
ci_025                 1.132810e-02 3 1  ON 24
ci_026                 1.135487e-02 3 1  ON 25
ci_027                 1.062428e-02 3 1  ON 26
ci_028                -1.401516e-02 3 1  ON 27
ci_029                -1.484524e-02 3 1  ON 28
ci_030                -1.132084e-02 3 1  ON 29
ci_031                -1.161104e-02 3 1  ON 30
ci_032                -1.333509e-02 3 1  ON 31
ci_033                 1.038694e-02 3 1  ON 32
ci_034                 1.044038e-02 3 1  ON 33
ci_035                -4.700548e-03 3 1  ON 34
ci_036                -1.075601e-02 3 1  ON 35
ci_037                -1.009027e-02 3 1  ON 36
ci_038                 1.790871e-03 3 1  ON 37
ci_039                 1.652961e-03 3 1  ON 38
ci_040                -4.480193e-03 3 1  ON 39
ci_041                 9.659018e-03 3 1  ON 40
ci_042                 9.853848e-03 3 1  ON 41
ci_043                -3.030815e-03 3 1  ON 42
ci_044                -1.463318e-02 3 1  ON 43
ci_045                -1.322613e-03 3 1  ON 44
ci_046                 5.320126e-03 3 1  ON 45
ci_047                 5.749978e-03 3 1  ON 46
ci_048                -1.200311e-02 3 1  ON 47
ci_049                -1.198118e-02 3 1  ON 48
ci_050                 7.875559e-03 3 1  ON 49
ci_051                 7.517774e-03 3 1  ON 50
ci_052                -6.635442e-03 3 1  ON 51
ci_053                -6.263332e-03 3 1  ON 52
ci_054                -2.739658e-03 3 1  ON 53
ci_055                -3.242412e-03 3 1  ON 54
ci_056                 5.116502e-03 3 1  ON 55
ci_057                 4.361048e-03 3 1  ON 56
ci_058                -6.680324e-03 3 1  ON 57
ci_059                -6.543271e-03 3 1  ON 58
ci_060                 8.344329e-03 3 1  ON 59
ci_061                 8.363728e-03 3 1  ON 60
ci_062                -3.501575e-03 3 1  ON 61
ci_063                -2.941224e-03 3 1  ON 62
ci_064                -3.008163e-03 3 1  ON 63
ci_065                -3.891794e-03 3 1  ON 64
ci_066                 5.656385e-03 3 1  ON 65
ci_067                 5.705383e-03 3 1  ON 66
ci_068                -5.289039e-03 3 1  ON 67
ci_069                -4.640808e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2349
    reference variance = 0.235799
====================================================
  Execution time = 1.4532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1755e-01
  Total weights = 1.956394835e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303605764505
                                         uncertainty =       0.003121656882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303605764505
                                         uncertainty =       0.003121656882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389591762
  error estimate for blocks of size 2^( 2) =       0.000399196086
  error estimate for blocks of size 2^( 3) =       0.000408196481
  error estimate for blocks of size 2^( 4) =       0.000414765212
  error estimate for blocks of size 2^( 5) =       0.000419559128
  error estimate for blocks of size 2^( 6) =       0.000420010680
  error estimate for blocks of size 2^( 7) =       0.000423732421

      target function =                  N/A
              le_mean =     -17.216869306302
             les_mean =     296.738137369224
             stat err =       0.000419516860
             autocorr =       1.159522844691
              std dev =       0.550965953333
             le_variance =       0.303563481732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686930630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216869306334       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877394359       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877526318       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216877528643       residual = 2.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.723146e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216869306334       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872204834       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216872146364       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.653221e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216869306334       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216870119030       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216870093984       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216870095150       residual = 1.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 4.696564e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7056e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.077952e-02 3 1  ON 0
ci_002                -3.022230e-02 3 1  ON 1
ci_003                -2.450102e-02 3 1  ON 2
ci_004                 2.065386e-02 3 1  ON 3
ci_005                 2.087974e-02 3 1  ON 4
ci_006                -1.847992e-02 3 1  ON 5
ci_007                -1.847020e-02 3 1  ON 6
ci_008                -1.817249e-02 3 1  ON 7
ci_009                -1.802370e-02 3 1  ON 8
ci_010                -1.724790e-02 3 1  ON 9
ci_011                -1.629352e-02 3 1  ON 10
ci_012                -1.596418e-02 3 1  ON 11
ci_013                -1.907299e-02 3 1  ON 12
ci_014                 1.414006e-02 3 1  ON 13
ci_015                 1.350523e-02 3 1  ON 14
ci_016                 1.654281e-02 3 1  ON 15
ci_017                 1.648196e-02 3 1  ON 16
ci_018                 1.270066e-02 3 1  ON 17
ci_019                 1.288341e-02 3 1  ON 18
ci_020                 1.313636e-02 3 1  ON 19
ci_021                 1.314000e-02 3 1  ON 20
ci_022                 1.171974e-02 3 1  ON 21
ci_023                 1.156461e-02 3 1  ON 22
ci_024                 1.111210e-02 3 1  ON 23
ci_025                 1.118268e-02 3 1  ON 24
ci_026                 1.131337e-02 3 1  ON 25
ci_027                 1.068894e-02 3 1  ON 26
ci_028                -1.398433e-02 3 1  ON 27
ci_029                -1.483853e-02 3 1  ON 28
ci_030                -1.132176e-02 3 1  ON 29
ci_031                -1.150689e-02 3 1  ON 30
ci_032                -1.341658e-02 3 1  ON 31
ci_033                 1.050001e-02 3 1  ON 32
ci_034                 1.035825e-02 3 1  ON 33
ci_035                -4.719791e-03 3 1  ON 34
ci_036                -1.081156e-02 3 1  ON 35
ci_037                -1.012754e-02 3 1  ON 36
ci_038                 1.697241e-03 3 1  ON 37
ci_039                 1.639584e-03 3 1  ON 38
ci_040                -4.322541e-03 3 1  ON 39
ci_041                 9.663972e-03 3 1  ON 40
ci_042                 9.915048e-03 3 1  ON 41
ci_043                -3.039911e-03 3 1  ON 42
ci_044                -1.471043e-02 3 1  ON 43
ci_045                -1.403736e-03 3 1  ON 44
ci_046                 5.305640e-03 3 1  ON 45
ci_047                 5.703323e-03 3 1  ON 46
ci_048                -1.193125e-02 3 1  ON 47
ci_049                -1.193155e-02 3 1  ON 48
ci_050                 7.722855e-03 3 1  ON 49
ci_051                 7.447905e-03 3 1  ON 50
ci_052                -6.547548e-03 3 1  ON 51
ci_053                -6.314482e-03 3 1  ON 52
ci_054                -2.860888e-03 3 1  ON 53
ci_055                -3.135778e-03 3 1  ON 54
ci_056                 4.993581e-03 3 1  ON 55
ci_057                 4.365197e-03 3 1  ON 56
ci_058                -6.745629e-03 3 1  ON 57
ci_059                -6.644777e-03 3 1  ON 58
ci_060                 8.424762e-03 3 1  ON 59
ci_061                 8.352463e-03 3 1  ON 60
ci_062                -3.587286e-03 3 1  ON 61
ci_063                -2.968576e-03 3 1  ON 62
ci_064                -2.942540e-03 3 1  ON 63
ci_065                -3.942953e-03 3 1  ON 64
ci_066                 5.585883e-03 3 1  ON 65
ci_067                 5.590701e-03 3 1  ON 66
ci_068                -5.239274e-03 3 1  ON 67
ci_069                -4.806130e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.237808
====================================================
  Execution time = 1.3369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1411e-01
  Total weights = 1.9565e+06
  Execution time = 1.8480e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300683999396
                                         uncertainty =       0.002164774660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300683999396
                                         uncertainty =       0.002164774660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387709102
  error estimate for blocks of size 2^( 2) =       0.000397896779
  error estimate for blocks of size 2^( 3) =       0.000406765201
  error estimate for blocks of size 2^( 4) =       0.000413744254
  error estimate for blocks of size 2^( 5) =       0.000418097923
  error estimate for blocks of size 2^( 6) =       0.000419909352
  error estimate for blocks of size 2^( 7) =       0.000419626502

      target function =                  N/A
              le_mean =     -17.215814524064
             les_mean =     296.699031093626
             stat err =       0.000417844508
             autocorr =       1.161495153405
              std dev =       0.548303470666
             le_variance =       0.300636695945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300353377067
                                         uncertainty =       0.002074924096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300353377067
                                         uncertainty =       0.002074924096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387495478
  error estimate for blocks of size 2^( 2) =       0.000397689893
  error estimate for blocks of size 2^( 3) =       0.000406560135
  error estimate for blocks of size 2^( 4) =       0.000413554552
  error estimate for blocks of size 2^( 5) =       0.000417918474
  error estimate for blocks of size 2^( 6) =       0.000419709069
  error estimate for blocks of size 2^( 7) =       0.000419455293

      target function =                  N/A
              le_mean =     -17.215822163710
             les_mean =     296.698836530671
             stat err =       0.000417659347
             autocorr =       1.161745857059
              std dev =       0.548001360688
             le_variance =       0.300305491316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300411056002
                                         uncertainty =       0.002095055000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300411056002
                                         uncertainty =       0.002095055000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387532770
  error estimate for blocks of size 2^( 2) =       0.000397725473
  error estimate for blocks of size 2^( 3) =       0.000406594791
  error estimate for blocks of size 2^( 4) =       0.000413585086
  error estimate for blocks of size 2^( 5) =       0.000417946677
  error estimate for blocks of size 2^( 6) =       0.000419743804
  error estimate for blocks of size 2^( 7) =       0.000419482696

      target function =                  N/A
              le_mean =     -17.215818171711
             les_mean =     296.698473808534
             stat err =       0.000417689566
             autocorr =       1.161690367601
              std dev =       0.548054098576
             le_variance =       0.300363294966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638461986
                                         uncertainty =       0.002153459777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638461986
                                         uncertainty =       0.002153459777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387679696
  error estimate for blocks of size 2^( 2) =       0.000397867933
  error estimate for blocks of size 2^( 3) =       0.000406736665
  error estimate for blocks of size 2^( 4) =       0.000413717104
  error estimate for blocks of size 2^( 5) =       0.000418071541
  error estimate for blocks of size 2^( 6) =       0.000419880718
  error estimate for blocks of size 2^( 7) =       0.000419601618

      target function =                  N/A
              le_mean =     -17.215814350698
             les_mean =     296.699303784066
             stat err =       0.000417817745
             autocorr =       1.161522562774
              std dev =       0.548261883562
             le_variance =       0.300591092967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215814524064        initial
     3.9062e-01     3.9062e+00             4.7231e-04       -17.215822163710  <--
     1.5625e+00     1.5625e+01             1.6532e-04       -17.215818171711
     6.2500e+00     6.2500e+01             4.6966e-05       -17.215814350698

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2668e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.051273e-02 3 1  ON 0
ci_002                -3.026094e-02 3 1  ON 1
ci_003                -2.452267e-02 3 1  ON 2
ci_004                 2.066310e-02 3 1  ON 3
ci_005                 2.116731e-02 3 1  ON 4
ci_006                -1.838641e-02 3 1  ON 5
ci_007                -1.864209e-02 3 1  ON 6
ci_008                -1.827186e-02 3 1  ON 7
ci_009                -1.805038e-02 3 1  ON 8
ci_010                -1.708305e-02 3 1  ON 9
ci_011                -1.615345e-02 3 1  ON 10
ci_012                -1.608076e-02 3 1  ON 11
ci_013                -1.916677e-02 3 1  ON 12
ci_014                 1.413391e-02 3 1  ON 13
ci_015                 1.347390e-02 3 1  ON 14
ci_016                 1.651794e-02 3 1  ON 15
ci_017                 1.658911e-02 3 1  ON 16
ci_018                 1.271282e-02 3 1  ON 17
ci_019                 1.308620e-02 3 1  ON 18
ci_020                 1.300725e-02 3 1  ON 19
ci_021                 1.311093e-02 3 1  ON 20
ci_022                 1.146032e-02 3 1  ON 21
ci_023                 1.158463e-02 3 1  ON 22
ci_024                 1.130362e-02 3 1  ON 23
ci_025                 1.086819e-02 3 1  ON 24
ci_026                 1.123855e-02 3 1  ON 25
ci_027                 1.081456e-02 3 1  ON 26
ci_028                -1.392578e-02 3 1  ON 27
ci_029                -1.482018e-02 3 1  ON 28
ci_030                -1.131594e-02 3 1  ON 29
ci_031                -1.131016e-02 3 1  ON 30
ci_032                -1.356481e-02 3 1  ON 31
ci_033                 1.070896e-02 3 1  ON 32
ci_034                 1.020290e-02 3 1  ON 33
ci_035                -4.751164e-03 3 1  ON 34
ci_036                -1.091897e-02 3 1  ON 35
ci_037                -1.020152e-02 3 1  ON 36
ci_038                 1.560614e-03 3 1  ON 37
ci_039                 1.621025e-03 3 1  ON 38
ci_040                -4.100016e-03 3 1  ON 39
ci_041                 9.669219e-03 3 1  ON 40
ci_042                 1.002336e-02 3 1  ON 41
ci_043                -3.053660e-03 3 1  ON 42
ci_044                -1.487551e-02 3 1  ON 43
ci_045                -1.527333e-03 3 1  ON 44
ci_046                 5.279165e-03 3 1  ON 45
ci_047                 5.623098e-03 3 1  ON 46
ci_048                -1.177434e-02 3 1  ON 47
ci_049                -1.182325e-02 3 1  ON 48
ci_050                 7.475187e-03 3 1  ON 49
ci_051                 7.335292e-03 3 1  ON 50
ci_052                -6.397893e-03 3 1  ON 51
ci_053                -6.396867e-03 3 1  ON 52
ci_054                -3.067774e-03 3 1  ON 53
ci_055                -2.952398e-03 3 1  ON 54
ci_056                 4.795611e-03 3 1  ON 55
ci_057                 4.373468e-03 3 1  ON 56
ci_058                -6.863306e-03 3 1  ON 57
ci_059                -6.819144e-03 3 1  ON 58
ci_060                 8.575055e-03 3 1  ON 59
ci_061                 8.335448e-03 3 1  ON 60
ci_062                -3.740547e-03 3 1  ON 61
ci_063                -3.018958e-03 3 1  ON 62
ci_064                -2.856517e-03 3 1  ON 63
ci_065                -4.011214e-03 3 1  ON 64
ci_066                 5.473160e-03 3 1  ON 65
ci_067                 5.408540e-03 3 1  ON 66
ci_068                -5.151908e-03 3 1  ON 67
ci_069                -5.113122e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.309197
====================================================
  Execution time = 1.3881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1306e-01
  Total weights = 1.956790326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299769394669
                                         uncertainty =       0.002453822702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299769394669
                                         uncertainty =       0.002453822702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117485
  error estimate for blocks of size 2^( 2) =       0.000396643620
  error estimate for blocks of size 2^( 3) =       0.000405480154
  error estimate for blocks of size 2^( 4) =       0.000411875348
  error estimate for blocks of size 2^( 5) =       0.000415732481
  error estimate for blocks of size 2^( 6) =       0.000417786756
  error estimate for blocks of size 2^( 7) =       0.000419403351

      target function =                  N/A
              le_mean =     -17.216695029031
             les_mean =     296.727644332502
             stat err =       0.000416199484
             autocorr =       1.155892639537
              std dev =       0.547466798087
             le_variance =       0.299719895007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669502903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695029113       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216711563541       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216712670478       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216712820962       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216712628901       residual = 4.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.654096e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695029113       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703923177       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703984037       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703977248       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.994808e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216695029113       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216698151638       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216698047630       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216698046393       residual = 1.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.619795e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6462e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.041263e-02 3 1  ON 0
ci_002                -3.005493e-02 3 1  ON 1
ci_003                -2.532215e-02 3 1  ON 2
ci_004                 2.048774e-02 3 1  ON 3
ci_005                 2.162212e-02 3 1  ON 4
ci_006                -1.858112e-02 3 1  ON 5
ci_007                -1.854712e-02 3 1  ON 6
ci_008                -1.794791e-02 3 1  ON 7
ci_009                -1.789465e-02 3 1  ON 8
ci_010                -1.697790e-02 3 1  ON 9
ci_011                -1.599609e-02 3 1  ON 10
ci_012                -1.599288e-02 3 1  ON 11
ci_013                -1.902649e-02 3 1  ON 12
ci_014                 1.390837e-02 3 1  ON 13
ci_015                 1.320021e-02 3 1  ON 14
ci_016                 1.654441e-02 3 1  ON 15
ci_017                 1.671321e-02 3 1  ON 16
ci_018                 1.299936e-02 3 1  ON 17
ci_019                 1.309134e-02 3 1  ON 18
ci_020                 1.294337e-02 3 1  ON 19
ci_021                 1.369645e-02 3 1  ON 20
ci_022                 1.181646e-02 3 1  ON 21
ci_023                 1.148125e-02 3 1  ON 22
ci_024                 1.133487e-02 3 1  ON 23
ci_025                 1.126593e-02 3 1  ON 24
ci_026                 1.124414e-02 3 1  ON 25
ci_027                 1.107950e-02 3 1  ON 26
ci_028                -1.389344e-02 3 1  ON 27
ci_029                -1.462157e-02 3 1  ON 28
ci_030                -1.156634e-02 3 1  ON 29
ci_031                -1.106230e-02 3 1  ON 30
ci_032                -1.365954e-02 3 1  ON 31
ci_033                 1.071955e-02 3 1  ON 32
ci_034                 1.035869e-02 3 1  ON 33
ci_035                -4.917123e-03 3 1  ON 34
ci_036                -1.067441e-02 3 1  ON 35
ci_037                -1.028122e-02 3 1  ON 36
ci_038                 1.567521e-03 3 1  ON 37
ci_039                 1.547554e-03 3 1  ON 38
ci_040                -4.082098e-03 3 1  ON 39
ci_041                 9.850568e-03 3 1  ON 40
ci_042                 1.014240e-02 3 1  ON 41
ci_043                -2.781395e-03 3 1  ON 42
ci_044                -1.490975e-02 3 1  ON 43
ci_045                -1.581008e-03 3 1  ON 44
ci_046                 5.064715e-03 3 1  ON 45
ci_047                 5.490499e-03 3 1  ON 46
ci_048                -1.210118e-02 3 1  ON 47
ci_049                -1.184291e-02 3 1  ON 48
ci_050                 7.601563e-03 3 1  ON 49
ci_051                 7.479010e-03 3 1  ON 50
ci_052                -6.472470e-03 3 1  ON 51
ci_053                -6.641024e-03 3 1  ON 52
ci_054                -2.963211e-03 3 1  ON 53
ci_055                -2.960241e-03 3 1  ON 54
ci_056                 4.780085e-03 3 1  ON 55
ci_057                 4.655011e-03 3 1  ON 56
ci_058                -6.874234e-03 3 1  ON 57
ci_059                -6.620313e-03 3 1  ON 58
ci_060                 8.676849e-03 3 1  ON 59
ci_061                 8.557869e-03 3 1  ON 60
ci_062                -3.418544e-03 3 1  ON 61
ci_063                -2.947245e-03 3 1  ON 62
ci_064                -3.175997e-03 3 1  ON 63
ci_065                -4.032983e-03 3 1  ON 64
ci_066                 5.651809e-03 3 1  ON 65
ci_067                 5.497123e-03 3 1  ON 66
ci_068                -5.044168e-03 3 1  ON 67
ci_069                -5.015708e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.3294
    reference variance = 0.661942
====================================================
  Execution time = 1.3433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1425e-01
  Total weights = 1.9564e+06
  Execution time = 1.8575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300875883418
                                         uncertainty =       0.002400238883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300875883418
                                         uncertainty =       0.002400238883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387809476
  error estimate for blocks of size 2^( 2) =       0.000397677862
  error estimate for blocks of size 2^( 3) =       0.000406843140
  error estimate for blocks of size 2^( 4) =       0.000413882894
  error estimate for blocks of size 2^( 5) =       0.000417997693
  error estimate for blocks of size 2^( 6) =       0.000418992467
  error estimate for blocks of size 2^( 7) =       0.000422023497

      target function =                  N/A
              le_mean =     -17.216746124956
             les_mean =     296.731210674924
             stat err =       0.000418224138
             autocorr =       1.163004397376
              std dev =       0.548445419879
             le_variance =       0.300792378586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300907920196
                                         uncertainty =       0.002393602392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300907920196
                                         uncertainty =       0.002393602392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387830503
  error estimate for blocks of size 2^( 2) =       0.000397694637
  error estimate for blocks of size 2^( 3) =       0.000406858909
  error estimate for blocks of size 2^( 4) =       0.000413876967
  error estimate for blocks of size 2^( 5) =       0.000417965975
  error estimate for blocks of size 2^( 6) =       0.000418956047
  error estimate for blocks of size 2^( 7) =       0.000421956866

      target function =                  N/A
              le_mean =     -17.216732796819
             les_mean =     296.732492151565
             stat err =       0.000418188964
             autocorr =       1.162682694261
              std dev =       0.548475156706
             le_variance =       0.300824997524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300935663706
                                         uncertainty =       0.002397805979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300935663706
                                         uncertainty =       0.002397805979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387848330
  error estimate for blocks of size 2^( 2) =       0.000397709364
  error estimate for blocks of size 2^( 3) =       0.000406870032
  error estimate for blocks of size 2^( 4) =       0.000413885651
  error estimate for blocks of size 2^( 5) =       0.000417968276
  error estimate for blocks of size 2^( 6) =       0.000418958693
  error estimate for blocks of size 2^( 7) =       0.000421961673

      target function =                  N/A
              le_mean =     -17.216734095810
             les_mean =     296.730564713014
             stat err =       0.000418193573
             autocorr =       1.162601439404
              std dev =       0.548500368899
             le_variance =       0.300852654682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300855410216
                                         uncertainty =       0.002399999545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300855410216
                                         uncertainty =       0.002399999545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387796334
  error estimate for blocks of size 2^( 2) =       0.000397662749
  error estimate for blocks of size 2^( 3) =       0.000406826381
  error estimate for blocks of size 2^( 4) =       0.000413862132
  error estimate for blocks of size 2^( 5) =       0.000417971100
  error estimate for blocks of size 2^( 6) =       0.000418965897
  error estimate for blocks of size 2^( 7) =       0.000421992671

      target function =                  N/A
              le_mean =     -17.216739656036
             les_mean =     296.730610804109
             stat err =       0.000418197950
             autocorr =       1.162937568252
              std dev =       0.548426835275
             le_variance =       0.300771993649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216746124956        initial  <--
     9.7656e-02     9.7656e-01             1.6541e-03       -17.216732796819
     3.9062e-01     3.9062e+00             7.9948e-04       -17.216734095810
     1.5625e+00     1.5625e+01             2.6198e-04       -17.216739656036

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7894
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.051273e-02 3 1  ON 0
ci_002                -3.026094e-02 3 1  ON 1
ci_003                -2.452267e-02 3 1  ON 2
ci_004                 2.066310e-02 3 1  ON 3
ci_005                 2.116731e-02 3 1  ON 4
ci_006                -1.838641e-02 3 1  ON 5
ci_007                -1.864209e-02 3 1  ON 6
ci_008                -1.827186e-02 3 1  ON 7
ci_009                -1.805038e-02 3 1  ON 8
ci_010                -1.708305e-02 3 1  ON 9
ci_011                -1.615345e-02 3 1  ON 10
ci_012                -1.608076e-02 3 1  ON 11
ci_013                -1.916677e-02 3 1  ON 12
ci_014                 1.413391e-02 3 1  ON 13
ci_015                 1.347390e-02 3 1  ON 14
ci_016                 1.651794e-02 3 1  ON 15
ci_017                 1.658911e-02 3 1  ON 16
ci_018                 1.271282e-02 3 1  ON 17
ci_019                 1.308620e-02 3 1  ON 18
ci_020                 1.300725e-02 3 1  ON 19
ci_021                 1.311093e-02 3 1  ON 20
ci_022                 1.146032e-02 3 1  ON 21
ci_023                 1.158463e-02 3 1  ON 22
ci_024                 1.130362e-02 3 1  ON 23
ci_025                 1.086819e-02 3 1  ON 24
ci_026                 1.123855e-02 3 1  ON 25
ci_027                 1.081456e-02 3 1  ON 26
ci_028                -1.392578e-02 3 1  ON 27
ci_029                -1.482018e-02 3 1  ON 28
ci_030                -1.131594e-02 3 1  ON 29
ci_031                -1.131016e-02 3 1  ON 30
ci_032                -1.356481e-02 3 1  ON 31
ci_033                 1.070896e-02 3 1  ON 32
ci_034                 1.020290e-02 3 1  ON 33
ci_035                -4.751164e-03 3 1  ON 34
ci_036                -1.091897e-02 3 1  ON 35
ci_037                -1.020152e-02 3 1  ON 36
ci_038                 1.560614e-03 3 1  ON 37
ci_039                 1.621025e-03 3 1  ON 38
ci_040                -4.100016e-03 3 1  ON 39
ci_041                 9.669219e-03 3 1  ON 40
ci_042                 1.002336e-02 3 1  ON 41
ci_043                -3.053660e-03 3 1  ON 42
ci_044                -1.487551e-02 3 1  ON 43
ci_045                -1.527333e-03 3 1  ON 44
ci_046                 5.279165e-03 3 1  ON 45
ci_047                 5.623098e-03 3 1  ON 46
ci_048                -1.177434e-02 3 1  ON 47
ci_049                -1.182325e-02 3 1  ON 48
ci_050                 7.475187e-03 3 1  ON 49
ci_051                 7.335292e-03 3 1  ON 50
ci_052                -6.397893e-03 3 1  ON 51
ci_053                -6.396867e-03 3 1  ON 52
ci_054                -3.067774e-03 3 1  ON 53
ci_055                -2.952398e-03 3 1  ON 54
ci_056                 4.795611e-03 3 1  ON 55
ci_057                 4.373468e-03 3 1  ON 56
ci_058                -6.863306e-03 3 1  ON 57
ci_059                -6.819144e-03 3 1  ON 58
ci_060                 8.575055e-03 3 1  ON 59
ci_061                 8.335448e-03 3 1  ON 60
ci_062                -3.740547e-03 3 1  ON 61
ci_063                -3.018958e-03 3 1  ON 62
ci_064                -2.856517e-03 3 1  ON 63
ci_065                -4.011214e-03 3 1  ON 64
ci_066                 5.473160e-03 3 1  ON 65
ci_067                 5.408540e-03 3 1  ON 66
ci_068                -5.151908e-03 3 1  ON 67
ci_069                -5.113122e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.229114
====================================================
  Execution time = 1.4079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1397e-01
  Total weights = 1.956286575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300908138017
                                         uncertainty =       0.001685445226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300908138017
                                         uncertainty =       0.001685445226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387867832
  error estimate for blocks of size 2^( 2) =       0.000397521423
  error estimate for blocks of size 2^( 3) =       0.000406122233
  error estimate for blocks of size 2^( 4) =       0.000412869955
  error estimate for blocks of size 2^( 5) =       0.000416583692
  error estimate for blocks of size 2^( 6) =       0.000418828768
  error estimate for blocks of size 2^( 7) =       0.000419442814

      target function =                  N/A
              le_mean =     -17.216516935201
             les_mean =     296.722429844799
             stat err =       0.000416931307
             autocorr =       1.155477490394
              std dev =       0.548527948303
             le_variance =       0.300882910069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651693520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516935240       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216519346219       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216519254202       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216519222919       residual = 3.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-01 is 3.096729e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516935240       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216517638293       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216517651947       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216517647816       residual = 3.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+00 is 8.971778e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516935240       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216517118633       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216517125508       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216517124861       residual = 4.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 2.335876e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6660e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.048300e-02 3 1  ON 0
ci_002                -3.026392e-02 3 1  ON 1
ci_003                -2.456152e-02 3 1  ON 2
ci_004                 2.070252e-02 3 1  ON 3
ci_005                 2.120704e-02 3 1  ON 4
ci_006                -1.841688e-02 3 1  ON 5
ci_007                -1.864977e-02 3 1  ON 6
ci_008                -1.823439e-02 3 1  ON 7
ci_009                -1.801262e-02 3 1  ON 8
ci_010                -1.713891e-02 3 1  ON 9
ci_011                -1.617681e-02 3 1  ON 10
ci_012                -1.611515e-02 3 1  ON 11
ci_013                -1.913760e-02 3 1  ON 12
ci_014                 1.413688e-02 3 1  ON 13
ci_015                 1.348443e-02 3 1  ON 14
ci_016                 1.657289e-02 3 1  ON 15
ci_017                 1.659740e-02 3 1  ON 16
ci_018                 1.268750e-02 3 1  ON 17
ci_019                 1.310584e-02 3 1  ON 18
ci_020                 1.299747e-02 3 1  ON 19
ci_021                 1.307014e-02 3 1  ON 20
ci_022                 1.146091e-02 3 1  ON 21
ci_023                 1.156500e-02 3 1  ON 22
ci_024                 1.130198e-02 3 1  ON 23
ci_025                 1.089146e-02 3 1  ON 24
ci_026                 1.121547e-02 3 1  ON 25
ci_027                 1.082653e-02 3 1  ON 26
ci_028                -1.400575e-02 3 1  ON 27
ci_029                -1.479048e-02 3 1  ON 28
ci_030                -1.133326e-02 3 1  ON 29
ci_031                -1.129227e-02 3 1  ON 30
ci_032                -1.356330e-02 3 1  ON 31
ci_033                 1.061924e-02 3 1  ON 32
ci_034                 1.018250e-02 3 1  ON 33
ci_035                -4.749588e-03 3 1  ON 34
ci_036                -1.087101e-02 3 1  ON 35
ci_037                -1.022723e-02 3 1  ON 36
ci_038                 1.571117e-03 3 1  ON 37
ci_039                 1.635739e-03 3 1  ON 38
ci_040                -4.126711e-03 3 1  ON 39
ci_041                 9.681582e-03 3 1  ON 40
ci_042                 1.002475e-02 3 1  ON 41
ci_043                -3.054355e-03 3 1  ON 42
ci_044                -1.493410e-02 3 1  ON 43
ci_045                -1.570563e-03 3 1  ON 44
ci_046                 5.355720e-03 3 1  ON 45
ci_047                 5.610628e-03 3 1  ON 46
ci_048                -1.178564e-02 3 1  ON 47
ci_049                -1.181910e-02 3 1  ON 48
ci_050                 7.501015e-03 3 1  ON 49
ci_051                 7.328286e-03 3 1  ON 50
ci_052                -6.450915e-03 3 1  ON 51
ci_053                -6.414654e-03 3 1  ON 52
ci_054                -3.123847e-03 3 1  ON 53
ci_055                -2.945399e-03 3 1  ON 54
ci_056                 4.827176e-03 3 1  ON 55
ci_057                 4.373175e-03 3 1  ON 56
ci_058                -6.866852e-03 3 1  ON 57
ci_059                -6.856304e-03 3 1  ON 58
ci_060                 8.591796e-03 3 1  ON 59
ci_061                 8.362410e-03 3 1  ON 60
ci_062                -3.685208e-03 3 1  ON 61
ci_063                -3.022401e-03 3 1  ON 62
ci_064                -2.884422e-03 3 1  ON 63
ci_065                -4.001915e-03 3 1  ON 64
ci_066                 5.475782e-03 3 1  ON 65
ci_067                 5.435100e-03 3 1  ON 66
ci_068                -5.112866e-03 3 1  ON 67
ci_069                -5.073953e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2519
    reference variance = 0.15285
====================================================
  Execution time = 1.3591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1554e-01
  Total weights = 1.9562e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302245534466
                                         uncertainty =       0.002597016598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302245534466
                                         uncertainty =       0.002597016598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388720995
  error estimate for blocks of size 2^( 2) =       0.000398871690
  error estimate for blocks of size 2^( 3) =       0.000407540400
  error estimate for blocks of size 2^( 4) =       0.000414390042
  error estimate for blocks of size 2^( 5) =       0.000418713285
  error estimate for blocks of size 2^( 6) =       0.000420448087
  error estimate for blocks of size 2^( 7) =       0.000422522818

      target function =                  N/A
              le_mean =     -17.216560477332
             les_mean =     296.725648820889
             stat err =       0.000419018558
             autocorr =       1.161958241974
              std dev =       0.549734502928
             le_variance =       0.302208023710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302334959060
                                         uncertainty =       0.002591751788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302334959060
                                         uncertainty =       0.002591751788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388778707
  error estimate for blocks of size 2^( 2) =       0.000398925129
  error estimate for blocks of size 2^( 3) =       0.000407588752
  error estimate for blocks of size 2^( 4) =       0.000414436960
  error estimate for blocks of size 2^( 5) =       0.000418744540
  error estimate for blocks of size 2^( 6) =       0.000420473482
  error estimate for blocks of size 2^( 7) =       0.000422554928

      target function =                  N/A
              le_mean =     -17.216560038353
             les_mean =     296.726058874369
             stat err =       0.000419052477
             autocorr =       1.161801367167
              std dev =       0.549816119846
             le_variance =       0.302297765643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302294772104
                                         uncertainty =       0.002594000170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302294772104
                                         uncertainty =       0.002594000170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388752777
  error estimate for blocks of size 2^( 2) =       0.000398901002
  error estimate for blocks of size 2^( 3) =       0.000407566695
  error estimate for blocks of size 2^( 4) =       0.000414415311
  error estimate for blocks of size 2^( 5) =       0.000418729240
  error estimate for blocks of size 2^( 6) =       0.000420460677
  error estimate for blocks of size 2^( 7) =       0.000422538513

      target function =                  N/A
              le_mean =     -17.216559754565
             les_mean =     296.725506133530
             stat err =       0.000419035935
             autocorr =       1.161864624682
              std dev =       0.549779448983
             le_variance =       0.302257442524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302251358245
                                         uncertainty =       0.002596617366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302251358245
                                         uncertainty =       0.002596617366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388724756
  error estimate for blocks of size 2^( 2) =       0.000398875135
  error estimate for blocks of size 2^( 3) =       0.000407543451
  error estimate for blocks of size 2^( 4) =       0.000414392945
  error estimate for blocks of size 2^( 5) =       0.000418714951
  error estimate for blocks of size 2^( 6) =       0.000420449313
  error estimate for blocks of size 2^( 7) =       0.000422524421

      target function =                  N/A
              le_mean =     -17.216560321515
             les_mean =     296.725565026079
             stat err =       0.000419020408
             autocorr =       1.161946016260
              std dev =       0.549739821549
             le_variance =       0.302213871397


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216560477332        initial  <--
     9.7656e-01     9.7656e+00             3.0967e-04       -17.216560038353
     3.9062e+00     3.9062e+01             8.9718e-05       -17.216559754565
     1.5625e+01     1.5625e+02             2.3359e-05       -17.216560321515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9993
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.051273e-02 3 1  ON 0
ci_002                -3.026094e-02 3 1  ON 1
ci_003                -2.452267e-02 3 1  ON 2
ci_004                 2.066310e-02 3 1  ON 3
ci_005                 2.116731e-02 3 1  ON 4
ci_006                -1.838641e-02 3 1  ON 5
ci_007                -1.864209e-02 3 1  ON 6
ci_008                -1.827186e-02 3 1  ON 7
ci_009                -1.805038e-02 3 1  ON 8
ci_010                -1.708305e-02 3 1  ON 9
ci_011                -1.615345e-02 3 1  ON 10
ci_012                -1.608076e-02 3 1  ON 11
ci_013                -1.916677e-02 3 1  ON 12
ci_014                 1.413391e-02 3 1  ON 13
ci_015                 1.347390e-02 3 1  ON 14
ci_016                 1.651794e-02 3 1  ON 15
ci_017                 1.658911e-02 3 1  ON 16
ci_018                 1.271282e-02 3 1  ON 17
ci_019                 1.308620e-02 3 1  ON 18
ci_020                 1.300725e-02 3 1  ON 19
ci_021                 1.311093e-02 3 1  ON 20
ci_022                 1.146032e-02 3 1  ON 21
ci_023                 1.158463e-02 3 1  ON 22
ci_024                 1.130362e-02 3 1  ON 23
ci_025                 1.086819e-02 3 1  ON 24
ci_026                 1.123855e-02 3 1  ON 25
ci_027                 1.081456e-02 3 1  ON 26
ci_028                -1.392578e-02 3 1  ON 27
ci_029                -1.482018e-02 3 1  ON 28
ci_030                -1.131594e-02 3 1  ON 29
ci_031                -1.131016e-02 3 1  ON 30
ci_032                -1.356481e-02 3 1  ON 31
ci_033                 1.070896e-02 3 1  ON 32
ci_034                 1.020290e-02 3 1  ON 33
ci_035                -4.751164e-03 3 1  ON 34
ci_036                -1.091897e-02 3 1  ON 35
ci_037                -1.020152e-02 3 1  ON 36
ci_038                 1.560614e-03 3 1  ON 37
ci_039                 1.621025e-03 3 1  ON 38
ci_040                -4.100016e-03 3 1  ON 39
ci_041                 9.669219e-03 3 1  ON 40
ci_042                 1.002336e-02 3 1  ON 41
ci_043                -3.053660e-03 3 1  ON 42
ci_044                -1.487551e-02 3 1  ON 43
ci_045                -1.527333e-03 3 1  ON 44
ci_046                 5.279165e-03 3 1  ON 45
ci_047                 5.623098e-03 3 1  ON 46
ci_048                -1.177434e-02 3 1  ON 47
ci_049                -1.182325e-02 3 1  ON 48
ci_050                 7.475187e-03 3 1  ON 49
ci_051                 7.335292e-03 3 1  ON 50
ci_052                -6.397893e-03 3 1  ON 51
ci_053                -6.396867e-03 3 1  ON 52
ci_054                -3.067774e-03 3 1  ON 53
ci_055                -2.952398e-03 3 1  ON 54
ci_056                 4.795611e-03 3 1  ON 55
ci_057                 4.373468e-03 3 1  ON 56
ci_058                -6.863306e-03 3 1  ON 57
ci_059                -6.819144e-03 3 1  ON 58
ci_060                 8.575055e-03 3 1  ON 59
ci_061                 8.335448e-03 3 1  ON 60
ci_062                -3.740547e-03 3 1  ON 61
ci_063                -3.018958e-03 3 1  ON 62
ci_064                -2.856517e-03 3 1  ON 63
ci_065                -4.011214e-03 3 1  ON 64
ci_066                 5.473160e-03 3 1  ON 65
ci_067                 5.408540e-03 3 1  ON 66
ci_068                -5.151908e-03 3 1  ON 67
ci_069                -5.113122e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1932
    reference variance = 0.18933
====================================================
  Execution time = 1.3766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1185e-01
  Total weights = 1.956690462e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297552163807
                                         uncertainty =       0.002023973312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297552163807
                                         uncertainty =       0.002023973312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385939782
  error estimate for blocks of size 2^( 2) =       0.000395501866
  error estimate for blocks of size 2^( 3) =       0.000404543863
  error estimate for blocks of size 2^( 4) =       0.000410832325
  error estimate for blocks of size 2^( 5) =       0.000416017519
  error estimate for blocks of size 2^( 6) =       0.000419222681
  error estimate for blocks of size 2^( 7) =       0.000419271688

      target function =                  N/A
              le_mean =     -17.216345983142
             les_mean =     296.714415013491
             stat err =       0.000416336053
             autocorr =       1.163721203856
              std dev =       0.545801274123
             le_variance =       0.297899030835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634598314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216345983173       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346692003       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346668975       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346668374       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.025229e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216345983173       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346163745       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346157812       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346157659       residual = 1.99e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 7.736595e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216345983173       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346028531       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346027037       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346026999       residual = 2.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.945312e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6283e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.050957e-02 3 1  ON 0
ci_002                -3.025903e-02 3 1  ON 1
ci_003                -2.452784e-02 3 1  ON 2
ci_004                 2.066094e-02 3 1  ON 3
ci_005                 2.116648e-02 3 1  ON 4
ci_006                -1.839218e-02 3 1  ON 5
ci_007                -1.864390e-02 3 1  ON 6
ci_008                -1.826412e-02 3 1  ON 7
ci_009                -1.805075e-02 3 1  ON 8
ci_010                -1.708571e-02 3 1  ON 9
ci_011                -1.615746e-02 3 1  ON 10
ci_012                -1.608586e-02 3 1  ON 11
ci_013                -1.916902e-02 3 1  ON 12
ci_014                 1.413506e-02 3 1  ON 13
ci_015                 1.347551e-02 3 1  ON 14
ci_016                 1.651772e-02 3 1  ON 15
ci_017                 1.658812e-02 3 1  ON 16
ci_018                 1.271651e-02 3 1  ON 17
ci_019                 1.308084e-02 3 1  ON 18
ci_020                 1.300799e-02 3 1  ON 19
ci_021                 1.311347e-02 3 1  ON 20
ci_022                 1.145667e-02 3 1  ON 21
ci_023                 1.158037e-02 3 1  ON 22
ci_024                 1.129892e-02 3 1  ON 23
ci_025                 1.087413e-02 3 1  ON 24
ci_026                 1.123407e-02 3 1  ON 25
ci_027                 1.081620e-02 3 1  ON 26
ci_028                -1.393109e-02 3 1  ON 27
ci_029                -1.481395e-02 3 1  ON 28
ci_030                -1.131472e-02 3 1  ON 29
ci_031                -1.130858e-02 3 1  ON 30
ci_032                -1.356936e-02 3 1  ON 31
ci_033                 1.070706e-02 3 1  ON 32
ci_034                 1.020474e-02 3 1  ON 33
ci_035                -4.750620e-03 3 1  ON 34
ci_036                -1.091183e-02 3 1  ON 35
ci_037                -1.020522e-02 3 1  ON 36
ci_038                 1.566724e-03 3 1  ON 37
ci_039                 1.618142e-03 3 1  ON 38
ci_040                -4.100405e-03 3 1  ON 39
ci_041                 9.665617e-03 3 1  ON 40
ci_042                 1.002099e-02 3 1  ON 41
ci_043                -3.048468e-03 3 1  ON 42
ci_044                -1.488103e-02 3 1  ON 43
ci_045                -1.530463e-03 3 1  ON 44
ci_046                 5.286221e-03 3 1  ON 45
ci_047                 5.627244e-03 3 1  ON 46
ci_048                -1.177453e-02 3 1  ON 47
ci_049                -1.182303e-02 3 1  ON 48
ci_050                 7.478364e-03 3 1  ON 49
ci_051                 7.342740e-03 3 1  ON 50
ci_052                -6.396007e-03 3 1  ON 51
ci_053                -6.392945e-03 3 1  ON 52
ci_054                -3.068377e-03 3 1  ON 53
ci_055                -2.954233e-03 3 1  ON 54
ci_056                 4.798662e-03 3 1  ON 55
ci_057                 4.375798e-03 3 1  ON 56
ci_058                -6.869450e-03 3 1  ON 57
ci_059                -6.815894e-03 3 1  ON 58
ci_060                 8.573531e-03 3 1  ON 59
ci_061                 8.335296e-03 3 1  ON 60
ci_062                -3.739159e-03 3 1  ON 61
ci_063                -3.018192e-03 3 1  ON 62
ci_064                -2.860615e-03 3 1  ON 63
ci_065                -4.012218e-03 3 1  ON 64
ci_066                 5.472338e-03 3 1  ON 65
ci_067                 5.412177e-03 3 1  ON 66
ci_068                -5.149900e-03 3 1  ON 67
ci_069                -5.115978e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1867
    reference variance = 0.360223
====================================================
  Execution time = 1.3309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1931e-01
  Total weights = 1.9567e+06
  Execution time = 1.8496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339259297
                                         uncertainty =       0.002406833294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339259297
                                         uncertainty =       0.002406833294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389442910
  error estimate for blocks of size 2^( 2) =       0.000399385008
  error estimate for blocks of size 2^( 3) =       0.000408324719
  error estimate for blocks of size 2^( 4) =       0.000415304693
  error estimate for blocks of size 2^( 5) =       0.000418686557
  error estimate for blocks of size 2^( 6) =       0.000421661155
  error estimate for blocks of size 2^( 7) =       0.000423955620

      target function =                  N/A
              le_mean =     -17.216146482373
             les_mean =     296.715000523728
             stat err =       0.000419902006
             autocorr =       1.162541043523
              std dev =       0.550755445579
             le_variance =       0.303331560835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339928680
                                         uncertainty =       0.002407342538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339928680
                                         uncertainty =       0.002407342538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389443378
  error estimate for blocks of size 2^( 2) =       0.000399385307
  error estimate for blocks of size 2^( 3) =       0.000408324923
  error estimate for blocks of size 2^( 4) =       0.000415304285
  error estimate for blocks of size 2^( 5) =       0.000418687023
  error estimate for blocks of size 2^( 6) =       0.000421660905
  error estimate for blocks of size 2^( 7) =       0.000423956106

      target function =                  N/A
              le_mean =     -17.216146024752
             les_mean =     296.716059711603
             stat err =       0.000419902080
             autocorr =       1.162538658462
              std dev =       0.550756107526
             le_variance =       0.303332289977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339467953
                                         uncertainty =       0.002407089121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339467953
                                         uncertainty =       0.002407089121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389443064
  error estimate for blocks of size 2^( 2) =       0.000399385077
  error estimate for blocks of size 2^( 3) =       0.000408324757
  error estimate for blocks of size 2^( 4) =       0.000415304443
  error estimate for blocks of size 2^( 5) =       0.000418686763
  error estimate for blocks of size 2^( 6) =       0.000421660998
  error estimate for blocks of size 2^( 7) =       0.000423955819

      target function =                  N/A
              le_mean =     -17.216146245966
             les_mean =     296.715007803217
             stat err =       0.000419902006
             autocorr =       1.162540126532
              std dev =       0.550755662679
             le_variance =       0.303331799973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339273863
                                         uncertainty =       0.002406865133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303339273863
                                         uncertainty =       0.002406865133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389442922
  error estimate for blocks of size 2^( 2) =       0.000399385009
  error estimate for blocks of size 2^( 3) =       0.000408324716
  error estimate for blocks of size 2^( 4) =       0.000415304654
  error estimate for blocks of size 2^( 5) =       0.000418686574
  error estimate for blocks of size 2^( 6) =       0.000421661126
  error estimate for blocks of size 2^( 7) =       0.000423955637

      target function =                  N/A
              le_mean =     -17.216146451583
             les_mean =     296.715000776725
             stat err =       0.000419901998
             autocorr =       1.162540927537
              std dev =       0.550755462283
             le_variance =       0.303331579234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216146482373        initial  <--
     9.7656e+00     9.7656e+01             3.0252e-05       -17.216146024752
     3.9062e+01     3.9062e+02             7.7366e-06       -17.216146245966
     1.5625e+02     1.5625e+03             1.9453e-06       -17.216146451583

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6375
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.051273e-02 3 1  ON 0
ci_002                -3.026094e-02 3 1  ON 1
ci_003                -2.452267e-02 3 1  ON 2
ci_004                 2.066310e-02 3 1  ON 3
ci_005                 2.116731e-02 3 1  ON 4
ci_006                -1.838641e-02 3 1  ON 5
ci_007                -1.864209e-02 3 1  ON 6
ci_008                -1.827186e-02 3 1  ON 7
ci_009                -1.805038e-02 3 1  ON 8
ci_010                -1.708305e-02 3 1  ON 9
ci_011                -1.615345e-02 3 1  ON 10
ci_012                -1.608076e-02 3 1  ON 11
ci_013                -1.916677e-02 3 1  ON 12
ci_014                 1.413391e-02 3 1  ON 13
ci_015                 1.347390e-02 3 1  ON 14
ci_016                 1.651794e-02 3 1  ON 15
ci_017                 1.658911e-02 3 1  ON 16
ci_018                 1.271282e-02 3 1  ON 17
ci_019                 1.308620e-02 3 1  ON 18
ci_020                 1.300725e-02 3 1  ON 19
ci_021                 1.311093e-02 3 1  ON 20
ci_022                 1.146032e-02 3 1  ON 21
ci_023                 1.158463e-02 3 1  ON 22
ci_024                 1.130362e-02 3 1  ON 23
ci_025                 1.086819e-02 3 1  ON 24
ci_026                 1.123855e-02 3 1  ON 25
ci_027                 1.081456e-02 3 1  ON 26
ci_028                -1.392578e-02 3 1  ON 27
ci_029                -1.482018e-02 3 1  ON 28
ci_030                -1.131594e-02 3 1  ON 29
ci_031                -1.131016e-02 3 1  ON 30
ci_032                -1.356481e-02 3 1  ON 31
ci_033                 1.070896e-02 3 1  ON 32
ci_034                 1.020290e-02 3 1  ON 33
ci_035                -4.751164e-03 3 1  ON 34
ci_036                -1.091897e-02 3 1  ON 35
ci_037                -1.020152e-02 3 1  ON 36
ci_038                 1.560614e-03 3 1  ON 37
ci_039                 1.621025e-03 3 1  ON 38
ci_040                -4.100016e-03 3 1  ON 39
ci_041                 9.669219e-03 3 1  ON 40
ci_042                 1.002336e-02 3 1  ON 41
ci_043                -3.053660e-03 3 1  ON 42
ci_044                -1.487551e-02 3 1  ON 43
ci_045                -1.527333e-03 3 1  ON 44
ci_046                 5.279165e-03 3 1  ON 45
ci_047                 5.623098e-03 3 1  ON 46
ci_048                -1.177434e-02 3 1  ON 47
ci_049                -1.182325e-02 3 1  ON 48
ci_050                 7.475187e-03 3 1  ON 49
ci_051                 7.335292e-03 3 1  ON 50
ci_052                -6.397893e-03 3 1  ON 51
ci_053                -6.396867e-03 3 1  ON 52
ci_054                -3.067774e-03 3 1  ON 53
ci_055                -2.952398e-03 3 1  ON 54
ci_056                 4.795611e-03 3 1  ON 55
ci_057                 4.373468e-03 3 1  ON 56
ci_058                -6.863306e-03 3 1  ON 57
ci_059                -6.819144e-03 3 1  ON 58
ci_060                 8.575055e-03 3 1  ON 59
ci_061                 8.335448e-03 3 1  ON 60
ci_062                -3.740547e-03 3 1  ON 61
ci_063                -3.018958e-03 3 1  ON 62
ci_064                -2.856517e-03 3 1  ON 63
ci_065                -4.011214e-03 3 1  ON 64
ci_066                 5.473160e-03 3 1  ON 65
ci_067                 5.408540e-03 3 1  ON 66
ci_068                -5.151908e-03 3 1  ON 67
ci_069                -5.113122e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2535
    reference variance = 0.341408
====================================================
  Execution time = 1.3647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1499e-01
  Total weights = 1.956823241e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300334766922
                                         uncertainty =       0.002079447377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300334766922
                                         uncertainty =       0.002079447377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387467988
  error estimate for blocks of size 2^( 2) =       0.000397460905
  error estimate for blocks of size 2^( 3) =       0.000406550355
  error estimate for blocks of size 2^( 4) =       0.000414013309
  error estimate for blocks of size 2^( 5) =       0.000418227944
  error estimate for blocks of size 2^( 6) =       0.000420029796
  error estimate for blocks of size 2^( 7) =       0.000421464141

      target function =                  N/A
              le_mean =     -17.216604695680
             les_mean =     296.726463562676
             stat err =       0.000418433798
             autocorr =       1.166223680436
              std dev =       0.547962484227
             le_variance =       0.300262884121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660469568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604695747       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604667347       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604668190       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 3.026432e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604695747       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604688634       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604688839       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 7.580423e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216604695747       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216604693968       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216604694019       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.896004e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6224e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.051248e-02 3 1  ON 0
ci_002                -3.026118e-02 3 1  ON 1
ci_003                -2.452284e-02 3 1  ON 2
ci_004                 2.066361e-02 3 1  ON 3
ci_005                 2.116670e-02 3 1  ON 4
ci_006                -1.838656e-02 3 1  ON 5
ci_007                -1.864228e-02 3 1  ON 6
ci_008                -1.827136e-02 3 1  ON 7
ci_009                -1.805016e-02 3 1  ON 8
ci_010                -1.708274e-02 3 1  ON 9
ci_011                -1.615362e-02 3 1  ON 10
ci_012                -1.608104e-02 3 1  ON 11
ci_013                -1.916727e-02 3 1  ON 12
ci_014                 1.413336e-02 3 1  ON 13
ci_015                 1.347373e-02 3 1  ON 14
ci_016                 1.651808e-02 3 1  ON 15
ci_017                 1.658886e-02 3 1  ON 16
ci_018                 1.271302e-02 3 1  ON 17
ci_019                 1.308586e-02 3 1  ON 18
ci_020                 1.300726e-02 3 1  ON 19
ci_021                 1.311130e-02 3 1  ON 20
ci_022                 1.146005e-02 3 1  ON 21
ci_023                 1.158469e-02 3 1  ON 22
ci_024                 1.130379e-02 3 1  ON 23
ci_025                 1.086820e-02 3 1  ON 24
ci_026                 1.123855e-02 3 1  ON 25
ci_027                 1.081458e-02 3 1  ON 26
ci_028                -1.392641e-02 3 1  ON 27
ci_029                -1.482040e-02 3 1  ON 28
ci_030                -1.131568e-02 3 1  ON 29
ci_031                -1.130974e-02 3 1  ON 30
ci_032                -1.356462e-02 3 1  ON 31
ci_033                 1.070891e-02 3 1  ON 32
ci_034                 1.020316e-02 3 1  ON 33
ci_035                -4.750622e-03 3 1  ON 34
ci_036                -1.091868e-02 3 1  ON 35
ci_037                -1.020143e-02 3 1  ON 36
ci_038                 1.560815e-03 3 1  ON 37
ci_039                 1.620956e-03 3 1  ON 38
ci_040                -4.099923e-03 3 1  ON 39
ci_041                 9.669531e-03 3 1  ON 40
ci_042                 1.002381e-02 3 1  ON 41
ci_043                -3.053734e-03 3 1  ON 42
ci_044                -1.487611e-02 3 1  ON 43
ci_045                -1.527827e-03 3 1  ON 44
ci_046                 5.279734e-03 3 1  ON 45
ci_047                 5.623088e-03 3 1  ON 46
ci_048                -1.177409e-02 3 1  ON 47
ci_049                -1.182354e-02 3 1  ON 48
ci_050                 7.475197e-03 3 1  ON 49
ci_051                 7.335700e-03 3 1  ON 50
ci_052                -6.398142e-03 3 1  ON 51
ci_053                -6.396384e-03 3 1  ON 52
ci_054                -3.068031e-03 3 1  ON 53
ci_055                -2.952327e-03 3 1  ON 54
ci_056                 4.795622e-03 3 1  ON 55
ci_057                 4.373764e-03 3 1  ON 56
ci_058                -6.863485e-03 3 1  ON 57
ci_059                -6.819364e-03 3 1  ON 58
ci_060                 8.575813e-03 3 1  ON 59
ci_061                 8.335010e-03 3 1  ON 60
ci_062                -3.740368e-03 3 1  ON 61
ci_063                -3.018989e-03 3 1  ON 62
ci_064                -2.856742e-03 3 1  ON 63
ci_065                -4.011133e-03 3 1  ON 64
ci_066                 5.472896e-03 3 1  ON 65
ci_067                 5.408822e-03 3 1  ON 66
ci_068                -5.151579e-03 3 1  ON 67
ci_069                -5.112651e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.298122
====================================================
  Execution time = 1.3595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1738e-01
  Total weights = 1.9568e+06
  Execution time = 1.8537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303809353343
                                         uncertainty =       0.002972513844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303809353343
                                         uncertainty =       0.002972513844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389796087
  error estimate for blocks of size 2^( 2) =       0.000399423500
  error estimate for blocks of size 2^( 3) =       0.000408041834
  error estimate for blocks of size 2^( 4) =       0.000414329733
  error estimate for blocks of size 2^( 5) =       0.000418574428
  error estimate for blocks of size 2^( 6) =       0.000419949893
  error estimate for blocks of size 2^( 7) =       0.000421599581

      target function =                  N/A
              le_mean =     -17.216671718155
             les_mean =     296.731162596742
             stat err =       0.000418613409
             autocorr =       1.153323976842
              std dev =       0.551254912676
             le_variance =       0.303881978750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303808487695
                                         uncertainty =       0.002972461178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303808487695
                                         uncertainty =       0.002972461178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389795529
  error estimate for blocks of size 2^( 2) =       0.000399423001
  error estimate for blocks of size 2^( 3) =       0.000408041346
  error estimate for blocks of size 2^( 4) =       0.000414329253
  error estimate for blocks of size 2^( 5) =       0.000418573934
  error estimate for blocks of size 2^( 6) =       0.000419949439
  error estimate for blocks of size 2^( 7) =       0.000421599141

      target function =                  N/A
              le_mean =     -17.216671728895
             les_mean =     296.731158340580
             stat err =       0.000418612942
             autocorr =       1.153324702650
              std dev =       0.551254124048
             le_variance =       0.303881109280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303808918884
                                         uncertainty =       0.002972487433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303808918884
                                         uncertainty =       0.002972487433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389795807
  error estimate for blocks of size 2^( 2) =       0.000399423249
  error estimate for blocks of size 2^( 3) =       0.000408041589
  error estimate for blocks of size 2^( 4) =       0.000414329492
  error estimate for blocks of size 2^( 5) =       0.000418574180
  error estimate for blocks of size 2^( 6) =       0.000419949665
  error estimate for blocks of size 2^( 7) =       0.000421599360

      target function =                  N/A
              le_mean =     -17.216671723476
             les_mean =     296.731160400187
             stat err =       0.000418613174
             autocorr =       1.153324340450
              std dev =       0.551254516873
             le_variance =       0.303881542373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303809298944
                                         uncertainty =       0.002972510540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303809298944
                                         uncertainty =       0.002972510540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389796052
  error estimate for blocks of size 2^( 2) =       0.000399423469
  error estimate for blocks of size 2^( 3) =       0.000408041803
  error estimate for blocks of size 2^( 4) =       0.000414329703
  error estimate for blocks of size 2^( 5) =       0.000418574397
  error estimate for blocks of size 2^( 6) =       0.000419949864
  error estimate for blocks of size 2^( 7) =       0.000421599553

      target function =                  N/A
              le_mean =     -17.216671718813
             les_mean =     296.731162314641
             stat err =       0.000418613380
             autocorr =       1.153324022301
              std dev =       0.551254863117
             le_variance =       0.303881924110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216671718155        initial
     9.7656e+01     9.7656e+02             3.0264e-06       -17.216671728895  <--
     3.9062e+02     3.9062e+03             7.5804e-07       -17.216671723476
     1.5625e+03     1.5625e+04             1.8960e-07       -17.216671718813

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.6447e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.051173e-02 3 1  ON 0
ci_002                -3.026187e-02 3 1  ON 1
ci_003                -2.452335e-02 3 1  ON 2
ci_004                 2.066511e-02 3 1  ON 3
ci_005                 2.116489e-02 3 1  ON 4
ci_006                -1.838701e-02 3 1  ON 5
ci_007                -1.864288e-02 3 1  ON 6
ci_008                -1.826987e-02 3 1  ON 7
ci_009                -1.804953e-02 3 1  ON 8
ci_010                -1.708180e-02 3 1  ON 9
ci_011                -1.615414e-02 3 1  ON 10
ci_012                -1.608186e-02 3 1  ON 11
ci_013                -1.916875e-02 3 1  ON 12
ci_014                 1.413170e-02 3 1  ON 13
ci_015                 1.347322e-02 3 1  ON 14
ci_016                 1.651849e-02 3 1  ON 15
ci_017                 1.658810e-02 3 1  ON 16
ci_018                 1.271362e-02 3 1  ON 17
ci_019                 1.308485e-02 3 1  ON 18
ci_020                 1.300729e-02 3 1  ON 19
ci_021                 1.311242e-02 3 1  ON 20
ci_022                 1.145924e-02 3 1  ON 21
ci_023                 1.158485e-02 3 1  ON 22
ci_024                 1.130429e-02 3 1  ON 23
ci_025                 1.086823e-02 3 1  ON 24
ci_026                 1.123854e-02 3 1  ON 25
ci_027                 1.081467e-02 3 1  ON 26
ci_028                -1.392828e-02 3 1  ON 27
ci_029                -1.482105e-02 3 1  ON 28
ci_030                -1.131490e-02 3 1  ON 29
ci_031                -1.130846e-02 3 1  ON 30
ci_032                -1.356406e-02 3 1  ON 31
ci_033                 1.070876e-02 3 1  ON 32
ci_034                 1.020394e-02 3 1  ON 33
ci_035                -4.749003e-03 3 1  ON 34
ci_036                -1.091784e-02 3 1  ON 35
ci_037                -1.020116e-02 3 1  ON 36
ci_038                 1.561414e-03 3 1  ON 37
ci_039                 1.620751e-03 3 1  ON 38
ci_040                -4.099644e-03 3 1  ON 39
ci_041                 9.670468e-03 3 1  ON 40
ci_042                 1.002515e-02 3 1  ON 41
ci_043                -3.053953e-03 3 1  ON 42
ci_044                -1.487790e-02 3 1  ON 43
ci_045                -1.529303e-03 3 1  ON 44
ci_046                 5.281437e-03 3 1  ON 45
ci_047                 5.623059e-03 3 1  ON 46
ci_048                -1.177337e-02 3 1  ON 47
ci_049                -1.182440e-02 3 1  ON 48
ci_050                 7.475224e-03 3 1  ON 49
ci_051                 7.336920e-03 3 1  ON 50
ci_052                -6.398887e-03 3 1  ON 51
ci_053                -6.394940e-03 3 1  ON 52
ci_054                -3.068798e-03 3 1  ON 53
ci_055                -2.952113e-03 3 1  ON 54
ci_056                 4.795655e-03 3 1  ON 55
ci_057                 4.374650e-03 3 1  ON 56
ci_058                -6.864019e-03 3 1  ON 57
ci_059                -6.820022e-03 3 1  ON 58
ci_060                 8.578082e-03 3 1  ON 59
ci_061                 8.333699e-03 3 1  ON 60
ci_062                -3.739833e-03 3 1  ON 61
ci_063                -3.019083e-03 3 1  ON 62
ci_064                -2.857415e-03 3 1  ON 63
ci_065                -4.010890e-03 3 1  ON 64
ci_066                 5.472107e-03 3 1  ON 65
ci_067                 5.409666e-03 3 1  ON 66
ci_068                -5.150596e-03 3 1  ON 67
ci_069                -5.111240e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2528
    reference variance = 0.242647
====================================================
  Execution time = 1.3583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2068e-01
  Total weights = 1.956405496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303323505073
                                         uncertainty =       0.003665669818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303323505073
                                         uncertainty =       0.003665669818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389399371
  error estimate for blocks of size 2^( 2) =       0.000399333387
  error estimate for blocks of size 2^( 3) =       0.000408258794
  error estimate for blocks of size 2^( 4) =       0.000414929574
  error estimate for blocks of size 2^( 5) =       0.000418870583
  error estimate for blocks of size 2^( 6) =       0.000420068246
  error estimate for blocks of size 2^( 7) =       0.000420772410

      target function =                  N/A
              le_mean =     -17.215991219132
             les_mean =     296.711031759569
             stat err =       0.000418660203
             autocorr =       1.155933548043
              std dev =       0.550693871809
             le_variance =       0.303263740447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721599121913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215991219149       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215991310535       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215991329606       residual = 9.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.288642e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215991219149       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215991242179       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215991247066       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 3.246836e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215991219149       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215991224918       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215991226147       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 8.133026e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6085e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.051132e-02 3 1  ON 0
ci_002                -3.026262e-02 3 1  ON 1
ci_003                -2.452503e-02 3 1  ON 2
ci_004                 2.066627e-02 3 1  ON 3
ci_005                 2.116660e-02 3 1  ON 4
ci_006                -1.838767e-02 3 1  ON 5
ci_007                -1.864359e-02 3 1  ON 6
ci_008                -1.827040e-02 3 1  ON 7
ci_009                -1.804865e-02 3 1  ON 8
ci_010                -1.708250e-02 3 1  ON 9
ci_011                -1.615424e-02 3 1  ON 10
ci_012                -1.608295e-02 3 1  ON 11
ci_013                -1.916989e-02 3 1  ON 12
ci_014                 1.412929e-02 3 1  ON 13
ci_015                 1.347302e-02 3 1  ON 14
ci_016                 1.651829e-02 3 1  ON 15
ci_017                 1.658929e-02 3 1  ON 16
ci_018                 1.271398e-02 3 1  ON 17
ci_019                 1.308406e-02 3 1  ON 18
ci_020                 1.300840e-02 3 1  ON 19
ci_021                 1.311272e-02 3 1  ON 20
ci_022                 1.145895e-02 3 1  ON 21
ci_023                 1.158180e-02 3 1  ON 22
ci_024                 1.130429e-02 3 1  ON 23
ci_025                 1.086870e-02 3 1  ON 24
ci_026                 1.124029e-02 3 1  ON 25
ci_027                 1.081403e-02 3 1  ON 26
ci_028                -1.393004e-02 3 1  ON 27
ci_029                -1.482094e-02 3 1  ON 28
ci_030                -1.131385e-02 3 1  ON 29
ci_031                -1.130665e-02 3 1  ON 30
ci_032                -1.356523e-02 3 1  ON 31
ci_033                 1.070799e-02 3 1  ON 32
ci_034                 1.020326e-02 3 1  ON 33
ci_035                -4.749073e-03 3 1  ON 34
ci_036                -1.091668e-02 3 1  ON 35
ci_037                -1.019815e-02 3 1  ON 36
ci_038                 1.562970e-03 3 1  ON 37
ci_039                 1.621491e-03 3 1  ON 38
ci_040                -4.098805e-03 3 1  ON 39
ci_041                 9.671862e-03 3 1  ON 40
ci_042                 1.002476e-02 3 1  ON 41
ci_043                -3.055842e-03 3 1  ON 42
ci_044                -1.487846e-02 3 1  ON 43
ci_045                -1.530145e-03 3 1  ON 44
ci_046                 5.282013e-03 3 1  ON 45
ci_047                 5.623402e-03 3 1  ON 46
ci_048                -1.177350e-02 3 1  ON 47
ci_049                -1.182619e-02 3 1  ON 48
ci_050                 7.474271e-03 3 1  ON 49
ci_051                 7.336098e-03 3 1  ON 50
ci_052                -6.399878e-03 3 1  ON 51
ci_053                -6.397348e-03 3 1  ON 52
ci_054                -3.068399e-03 3 1  ON 53
ci_055                -2.952345e-03 3 1  ON 54
ci_056                 4.796449e-03 3 1  ON 55
ci_057                 4.375055e-03 3 1  ON 56
ci_058                -6.862144e-03 3 1  ON 57
ci_059                -6.820112e-03 3 1  ON 58
ci_060                 8.580852e-03 3 1  ON 59
ci_061                 8.335986e-03 3 1  ON 60
ci_062                -3.737868e-03 3 1  ON 61
ci_063                -3.019683e-03 3 1  ON 62
ci_064                -2.859743e-03 3 1  ON 63
ci_065                -4.012192e-03 3 1  ON 64
ci_066                 5.473529e-03 3 1  ON 65
ci_067                 5.410644e-03 3 1  ON 66
ci_068                -5.147349e-03 3 1  ON 67
ci_069                -5.109058e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1885
    reference variance = 0.27993
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1322e-01
  Total weights = 1.9568e+06
  Execution time = 1.8587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110193908
                                         uncertainty =       0.002282174148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110193908
                                         uncertainty =       0.002282174148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796805
  error estimate for blocks of size 2^( 2) =       0.000397113528
  error estimate for blocks of size 2^( 3) =       0.000406285616
  error estimate for blocks of size 2^( 4) =       0.000413043314
  error estimate for blocks of size 2^( 5) =       0.000417610014
  error estimate for blocks of size 2^( 6) =       0.000418270285
  error estimate for blocks of size 2^( 7) =       0.000420663370

      target function =                  N/A
              le_mean =     -17.216581115121
             les_mean =     296.723887586076
             stat err =       0.000417396746
             autocorr =       1.164480879316
              std dev =       0.547013286862
             le_variance =       0.299223536004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299111212464
                                         uncertainty =       0.002281601401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299111212464
                                         uncertainty =       0.002281601401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386797415
  error estimate for blocks of size 2^( 2) =       0.000397113927
  error estimate for blocks of size 2^( 3) =       0.000406285824
  error estimate for blocks of size 2^( 4) =       0.000413043273
  error estimate for blocks of size 2^( 5) =       0.000417610117
  error estimate for blocks of size 2^( 6) =       0.000418270611
  error estimate for blocks of size 2^( 7) =       0.000420663122

      target function =                  N/A
              le_mean =     -17.216581277109
             les_mean =     296.723898218741
             stat err =       0.000417396780
             autocorr =       1.164477401114
              std dev =       0.547014149615
             le_variance =       0.299224479879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110692633
                                         uncertainty =       0.002281884804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110692633
                                         uncertainty =       0.002281884804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386797103
  error estimate for blocks of size 2^( 2) =       0.000397113720
  error estimate for blocks of size 2^( 3) =       0.000406285712
  error estimate for blocks of size 2^( 4) =       0.000413043284
  error estimate for blocks of size 2^( 5) =       0.000417610057
  error estimate for blocks of size 2^( 6) =       0.000418270440
  error estimate for blocks of size 2^( 7) =       0.000420663235

      target function =                  N/A
              le_mean =     -17.216581195128
             les_mean =     296.723892696221
             stat err =       0.000417396754
             autocorr =       1.164479133123
              std dev =       0.547013708313
             le_variance =       0.299223997083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110254892
                                         uncertainty =       0.002282137872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299110254892
                                         uncertainty =       0.002282137872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796841
  error estimate for blocks of size 2^( 2) =       0.000397113551
  error estimate for blocks of size 2^( 3) =       0.000406285627
  error estimate for blocks of size 2^( 4) =       0.000413043309
  error estimate for blocks of size 2^( 5) =       0.000417610018
  error estimate for blocks of size 2^( 6) =       0.000418270303
  error estimate for blocks of size 2^( 7) =       0.000420663352

      target function =                  N/A
              le_mean =     -17.216581124978
             les_mean =     296.723888199923
             stat err =       0.000417396746
             autocorr =       1.164480661238
              std dev =       0.547013338295
             le_variance =       0.299223592272


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216581115121        initial
     2.4414e+01     2.4414e+02             1.2886e-05       -17.216581277109  <--
     9.7656e+01     9.7656e+02             3.2468e-06       -17.216581195128
     3.9062e+02     3.9062e+03             8.1330e-07       -17.216581124978

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 2.3123e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.051009e-02 3 1  ON 0
ci_002                -3.026484e-02 3 1  ON 1
ci_003                -2.453003e-02 3 1  ON 2
ci_004                 2.066973e-02 3 1  ON 3
ci_005                 2.117171e-02 3 1  ON 4
ci_006                -1.838963e-02 3 1  ON 5
ci_007                -1.864570e-02 3 1  ON 6
ci_008                -1.827199e-02 3 1  ON 7
ci_009                -1.804606e-02 3 1  ON 8
ci_010                -1.708461e-02 3 1  ON 9
ci_011                -1.615455e-02 3 1  ON 10
ci_012                -1.608618e-02 3 1  ON 11
ci_013                -1.917327e-02 3 1  ON 12
ci_014                 1.412214e-02 3 1  ON 13
ci_015                 1.347243e-02 3 1  ON 14
ci_016                 1.651772e-02 3 1  ON 15
ci_017                 1.659282e-02 3 1  ON 16
ci_018                 1.271505e-02 3 1  ON 17
ci_019                 1.308171e-02 3 1  ON 18
ci_020                 1.301168e-02 3 1  ON 19
ci_021                 1.311361e-02 3 1  ON 20
ci_022                 1.145811e-02 3 1  ON 21
ci_023                 1.157276e-02 3 1  ON 22
ci_024                 1.130428e-02 3 1  ON 23
ci_025                 1.087013e-02 3 1  ON 24
ci_026                 1.124549e-02 3 1  ON 25
ci_027                 1.081213e-02 3 1  ON 26
ci_028                -1.393527e-02 3 1  ON 27
ci_029                -1.482062e-02 3 1  ON 28
ci_030                -1.131075e-02 3 1  ON 29
ci_031                -1.130127e-02 3 1  ON 30
ci_032                -1.356872e-02 3 1  ON 31
ci_033                 1.070572e-02 3 1  ON 32
ci_034                 1.020125e-02 3 1  ON 33
ci_035                -4.749282e-03 3 1  ON 34
ci_036                -1.091326e-02 3 1  ON 35
ci_037                -1.018918e-02 3 1  ON 36
ci_038                 1.567563e-03 3 1  ON 37
ci_039                 1.623678e-03 3 1  ON 38
ci_040                -4.096338e-03 3 1  ON 39
ci_041                 9.676002e-03 3 1  ON 40
ci_042                 1.002360e-02 3 1  ON 41
ci_043                -3.061422e-03 3 1  ON 42
ci_044                -1.488011e-02 3 1  ON 43
ci_045                -1.532629e-03 3 1  ON 44
ci_046                 5.283725e-03 3 1  ON 45
ci_047                 5.624423e-03 3 1  ON 46
ci_048                -1.177389e-02 3 1  ON 47
ci_049                -1.183151e-02 3 1  ON 48
ci_050                 7.471452e-03 3 1  ON 49
ci_051                 7.333667e-03 3 1  ON 50
ci_052                -6.402813e-03 3 1  ON 51
ci_053                -6.404478e-03 3 1  ON 52
ci_054                -3.067217e-03 3 1  ON 53
ci_055                -2.953030e-03 3 1  ON 54
ci_056                 4.798799e-03 3 1  ON 55
ci_057                 4.376255e-03 3 1  ON 56
ci_058                -6.856586e-03 3 1  ON 57
ci_059                -6.820380e-03 3 1  ON 58
ci_060                 8.589080e-03 3 1  ON 59
ci_061                 8.342777e-03 3 1  ON 60
ci_062                -3.732043e-03 3 1  ON 61
ci_063                -3.021463e-03 3 1  ON 62
ci_064                -2.866583e-03 3 1  ON 63
ci_065                -4.016023e-03 3 1  ON 64
ci_066                 5.477734e-03 3 1  ON 65
ci_067                 5.413536e-03 3 1  ON 66
ci_068                -5.137709e-03 3 1  ON 67
ci_069                -5.102586e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.242404
====================================================
  Execution time = 1.4113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1685e-01
  Total weights = 1.957029700e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303387577655
                                         uncertainty =       0.003113241017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303387577655
                                         uncertainty =       0.003113241017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389444783
  error estimate for blocks of size 2^( 2) =       0.000399526304
  error estimate for blocks of size 2^( 3) =       0.000408460343
  error estimate for blocks of size 2^( 4) =       0.000415253460
  error estimate for blocks of size 2^( 5) =       0.000420022442
  error estimate for blocks of size 2^( 6) =       0.000421850213
  error estimate for blocks of size 2^( 7) =       0.000423200467

      target function =                  N/A
              le_mean =     -17.217107098126
             les_mean =     296.745627183912
             stat err =       0.000420081646
             autocorr =       1.163524764589
              std dev =       0.550758094505
             le_variance =       0.303334478663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710709813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217107098218       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217107818573       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217107802491       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 4.648391e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217107098218       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217107283833       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217107279714       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.211220e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217107098218       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217107144980       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217107143945       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 3.060290e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.023169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6618e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.050695e-02 3 1  ON 0
ci_002                -3.025334e-02 3 1  ON 1
ci_003                -2.453017e-02 3 1  ON 2
ci_004                 2.066976e-02 3 1  ON 3
ci_005                 2.117335e-02 3 1  ON 4
ci_006                -1.839366e-02 3 1  ON 5
ci_007                -1.864925e-02 3 1  ON 6
ci_008                -1.827370e-02 3 1  ON 7
ci_009                -1.804730e-02 3 1  ON 8
ci_010                -1.707605e-02 3 1  ON 9
ci_011                -1.615785e-02 3 1  ON 10
ci_012                -1.608985e-02 3 1  ON 11
ci_013                -1.917471e-02 3 1  ON 12
ci_014                 1.411888e-02 3 1  ON 13
ci_015                 1.347659e-02 3 1  ON 14
ci_016                 1.651329e-02 3 1  ON 15
ci_017                 1.660178e-02 3 1  ON 16
ci_018                 1.271337e-02 3 1  ON 17
ci_019                 1.307714e-02 3 1  ON 18
ci_020                 1.300799e-02 3 1  ON 19
ci_021                 1.310975e-02 3 1  ON 20
ci_022                 1.145995e-02 3 1  ON 21
ci_023                 1.157466e-02 3 1  ON 22
ci_024                 1.130154e-02 3 1  ON 23
ci_025                 1.087196e-02 3 1  ON 24
ci_026                 1.124746e-02 3 1  ON 25
ci_027                 1.081713e-02 3 1  ON 26
ci_028                -1.393969e-02 3 1  ON 27
ci_029                -1.481311e-02 3 1  ON 28
ci_030                -1.130529e-02 3 1  ON 29
ci_031                -1.130388e-02 3 1  ON 30
ci_032                -1.357044e-02 3 1  ON 31
ci_033                 1.070562e-02 3 1  ON 32
ci_034                 1.020571e-02 3 1  ON 33
ci_035                -4.751172e-03 3 1  ON 34
ci_036                -1.090468e-02 3 1  ON 35
ci_037                -1.019455e-02 3 1  ON 36
ci_038                 1.567631e-03 3 1  ON 37
ci_039                 1.624908e-03 3 1  ON 38
ci_040                -4.095925e-03 3 1  ON 39
ci_041                 9.678308e-03 3 1  ON 40
ci_042                 1.002216e-02 3 1  ON 41
ci_043                -3.060318e-03 3 1  ON 42
ci_044                -1.488015e-02 3 1  ON 43
ci_045                -1.538449e-03 3 1  ON 44
ci_046                 5.282967e-03 3 1  ON 45
ci_047                 5.630708e-03 3 1  ON 46
ci_048                -1.177614e-02 3 1  ON 47
ci_049                -1.183378e-02 3 1  ON 48
ci_050                 7.461068e-03 3 1  ON 49
ci_051                 7.338227e-03 3 1  ON 50
ci_052                -6.399772e-03 3 1  ON 51
ci_053                -6.397518e-03 3 1  ON 52
ci_054                -3.067950e-03 3 1  ON 53
ci_055                -2.955473e-03 3 1  ON 54
ci_056                 4.801090e-03 3 1  ON 55
ci_057                 4.377090e-03 3 1  ON 56
ci_058                -6.859512e-03 3 1  ON 57
ci_059                -6.818537e-03 3 1  ON 58
ci_060                 8.589632e-03 3 1  ON 59
ci_061                 8.352059e-03 3 1  ON 60
ci_062                -3.724570e-03 3 1  ON 61
ci_063                -3.022904e-03 3 1  ON 62
ci_064                -2.865211e-03 3 1  ON 63
ci_065                -4.012241e-03 3 1  ON 64
ci_066                 5.480561e-03 3 1  ON 65
ci_067                 5.425648e-03 3 1  ON 66
ci_068                -5.134426e-03 3 1  ON 67
ci_069                -5.102384e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1504
    reference variance = 0.518265
====================================================
  Execution time = 1.3496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1452e-01
  Total weights = 1.9569e+06
  Execution time = 1.8525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823095731
                                         uncertainty =       0.002017145071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823095731
                                         uncertainty =       0.002017145071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387215747
  error estimate for blocks of size 2^( 2) =       0.000396919261
  error estimate for blocks of size 2^( 3) =       0.000405460079
  error estimate for blocks of size 2^( 4) =       0.000411429007
  error estimate for blocks of size 2^( 5) =       0.000415407688
  error estimate for blocks of size 2^( 6) =       0.000417074651
  error estimate for blocks of size 2^( 7) =       0.000419651354

      target function =                  N/A
              le_mean =     -17.216564428084
             les_mean =     296.724601459736
             stat err =       0.000415890675
             autocorr =       1.153592290288
              std dev =       0.547605760501
             le_variance =       0.299872068934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823047962
                                         uncertainty =       0.002017042322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823047962
                                         uncertainty =       0.002017042322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387215568
  error estimate for blocks of size 2^( 2) =       0.000396919727
  error estimate for blocks of size 2^( 3) =       0.000405460656
  error estimate for blocks of size 2^( 4) =       0.000411429715
  error estimate for blocks of size 2^( 5) =       0.000415409500
  error estimate for blocks of size 2^( 6) =       0.000417074912
  error estimate for blocks of size 2^( 7) =       0.000419651005

      target function =                  N/A
              le_mean =     -17.216564551772
             les_mean =     296.724673235903
             stat err =       0.000415891283
             autocorr =       1.153596726952
              std dev =       0.547605508158
             le_variance =       0.299871792565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299822945417
                                         uncertainty =       0.002017089222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299822945417
                                         uncertainty =       0.002017089222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387215573
  error estimate for blocks of size 2^( 2) =       0.000396919421
  error estimate for blocks of size 2^( 3) =       0.000405460297
  error estimate for blocks of size 2^( 4) =       0.000411429293
  error estimate for blocks of size 2^( 5) =       0.000415408554
  error estimate for blocks of size 2^( 6) =       0.000417074720
  error estimate for blocks of size 2^( 7) =       0.000419651104

      target function =                  N/A
              le_mean =     -17.216564477231
             les_mean =     296.724622588890
             stat err =       0.000415890918
             autocorr =       1.153594670116
              std dev =       0.547605515402
             le_variance =       0.299871800498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823063214
                                         uncertainty =       0.002017137761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299823063214
                                         uncertainty =       0.002017137761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387215716
  error estimate for blocks of size 2^( 2) =       0.000396919273
  error estimate for blocks of size 2^( 3) =       0.000405460098
  error estimate for blocks of size 2^( 4) =       0.000411429034
  error estimate for blocks of size 2^( 5) =       0.000415407789
  error estimate for blocks of size 2^( 6) =       0.000417074652
  error estimate for blocks of size 2^( 7) =       0.000419651315

      target function =                  N/A
              le_mean =     -17.216564432812
             les_mean =     296.724602513325
             stat err =       0.000415890697
             autocorr =       1.153592598000
              std dev =       0.547605717214
             le_variance =       0.299872021525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216564428084        initial
     6.1035e+00     6.1035e+01             4.6484e-05       -17.216564551772  <--
     2.4414e+01     2.4414e+02             1.2112e-05       -17.216564477231
     9.7656e+01     9.7656e+02             3.0603e-06       -17.216564432812

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.2814e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.049775e-02 3 1  ON 0
ci_002                -3.022004e-02 3 1  ON 1
ci_003                -2.453062e-02 3 1  ON 2
ci_004                 2.066985e-02 3 1  ON 3
ci_005                 2.117806e-02 3 1  ON 4
ci_006                -1.840535e-02 3 1  ON 5
ci_007                -1.865967e-02 3 1  ON 6
ci_008                -1.827861e-02 3 1  ON 7
ci_009                -1.805087e-02 3 1  ON 8
ci_010                -1.705110e-02 3 1  ON 9
ci_011                -1.616734e-02 3 1  ON 10
ci_012                -1.610047e-02 3 1  ON 11
ci_013                -1.917890e-02 3 1  ON 12
ci_014                 1.410942e-02 3 1  ON 13
ci_015                 1.348856e-02 3 1  ON 14
ci_016                 1.650041e-02 3 1  ON 15
ci_017                 1.662784e-02 3 1  ON 16
ci_018                 1.270846e-02 3 1  ON 17
ci_019                 1.306399e-02 3 1  ON 18
ci_020                 1.299727e-02 3 1  ON 19
ci_021                 1.309853e-02 3 1  ON 20
ci_022                 1.146520e-02 3 1  ON 21
ci_023                 1.158014e-02 3 1  ON 22
ci_024                 1.129354e-02 3 1  ON 23
ci_025                 1.087734e-02 3 1  ON 24
ci_026                 1.125315e-02 3 1  ON 25
ci_027                 1.083165e-02 3 1  ON 26
ci_028                -1.395257e-02 3 1  ON 27
ci_029                -1.479135e-02 3 1  ON 28
ci_030                -1.128947e-02 3 1  ON 29
ci_031                -1.131136e-02 3 1  ON 30
ci_032                -1.357535e-02 3 1  ON 31
ci_033                 1.070529e-02 3 1  ON 32
ci_034                 1.021858e-02 3 1  ON 33
ci_035                -4.756480e-03 3 1  ON 34
ci_036                -1.087987e-02 3 1  ON 35
ci_037                -1.021008e-02 3 1  ON 36
ci_038                 1.567847e-03 3 1  ON 37
ci_039                 1.628366e-03 3 1  ON 38
ci_040                -4.094747e-03 3 1  ON 39
ci_041                 9.685013e-03 3 1  ON 40
ci_042                 1.001802e-02 3 1  ON 41
ci_043                -3.057191e-03 3 1  ON 42
ci_044                -1.488033e-02 3 1  ON 43
ci_045                -1.554834e-03 3 1  ON 44
ci_046                 5.280794e-03 3 1  ON 45
ci_047                 5.648790e-03 3 1  ON 46
ci_048                -1.178266e-02 3 1  ON 47
ci_049                -1.184043e-02 3 1  ON 48
ci_050                 7.431514e-03 3 1  ON 49
ci_051                 7.351186e-03 3 1  ON 50
ci_052                -6.391107e-03 3 1  ON 51
ci_053                -6.377651e-03 3 1  ON 52
ci_054                -3.070043e-03 3 1  ON 53
ci_055                -2.962481e-03 3 1  ON 54
ci_056                 4.807616e-03 3 1  ON 55
ci_057                 4.379442e-03 3 1  ON 56
ci_058                -6.867872e-03 3 1  ON 57
ci_059                -6.813267e-03 3 1  ON 58
ci_060                 8.591159e-03 3 1  ON 59
ci_061                 8.378830e-03 3 1  ON 60
ci_062                -3.703153e-03 3 1  ON 61
ci_063                -3.027029e-03 3 1  ON 62
ci_064                -2.861384e-03 3 1  ON 63
ci_065                -4.001698e-03 3 1  ON 64
ci_066                 5.488573e-03 3 1  ON 65
ci_067                 5.460020e-03 3 1  ON 66
ci_068                -5.124971e-03 3 1  ON 67
ci_069                -5.101841e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.190626
====================================================
  Execution time = 1.4026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1343e-01
  Total weights = 1.956145747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299101442671
                                         uncertainty =       0.002078752171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299101442671
                                         uncertainty =       0.002078752171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386681781
  error estimate for blocks of size 2^( 2) =       0.000396837991
  error estimate for blocks of size 2^( 3) =       0.000406047409
  error estimate for blocks of size 2^( 4) =       0.000412829765
  error estimate for blocks of size 2^( 5) =       0.000416908637
  error estimate for blocks of size 2^( 6) =       0.000418325380
  error estimate for blocks of size 2^( 7) =       0.000418099013

      target function =                  N/A
              le_mean =     -17.216504838851
             les_mean =     296.721469380611
             stat err =       0.000416540698
             autocorr =       1.160399308019
              std dev =       0.546850619215
             le_variance =       0.299045599736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650483885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504838871       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216509599225       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216509545429       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.821720e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504838871       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506160662       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506159668       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 5.053241e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216504838871       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505178721       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216505179563       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+01 is 1.299159e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6541e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.050432e-02 3 1  ON 0
ci_002                -3.020677e-02 3 1  ON 1
ci_003                -2.455804e-02 3 1  ON 2
ci_004                 2.066341e-02 3 1  ON 3
ci_005                 2.118048e-02 3 1  ON 4
ci_006                -1.842197e-02 3 1  ON 5
ci_007                -1.868814e-02 3 1  ON 6
ci_008                -1.824405e-02 3 1  ON 7
ci_009                -1.800446e-02 3 1  ON 8
ci_010                -1.704823e-02 3 1  ON 9
ci_011                -1.621787e-02 3 1  ON 10
ci_012                -1.612179e-02 3 1  ON 11
ci_013                -1.921216e-02 3 1  ON 12
ci_014                 1.410539e-02 3 1  ON 13
ci_015                 1.347765e-02 3 1  ON 14
ci_016                 1.652007e-02 3 1  ON 15
ci_017                 1.659383e-02 3 1  ON 16
ci_018                 1.272285e-02 3 1  ON 17
ci_019                 1.305357e-02 3 1  ON 18
ci_020                 1.298624e-02 3 1  ON 19
ci_021                 1.308431e-02 3 1  ON 20
ci_022                 1.142778e-02 3 1  ON 21
ci_023                 1.156120e-02 3 1  ON 22
ci_024                 1.126774e-02 3 1  ON 23
ci_025                 1.091403e-02 3 1  ON 24
ci_026                 1.128318e-02 3 1  ON 25
ci_027                 1.083958e-02 3 1  ON 26
ci_028                -1.397631e-02 3 1  ON 27
ci_029                -1.474468e-02 3 1  ON 28
ci_030                -1.126169e-02 3 1  ON 29
ci_031                -1.134143e-02 3 1  ON 30
ci_032                -1.354749e-02 3 1  ON 31
ci_033                 1.070260e-02 3 1  ON 32
ci_034                 1.022836e-02 3 1  ON 33
ci_035                -4.762416e-03 3 1  ON 34
ci_036                -1.084687e-02 3 1  ON 35
ci_037                -1.020688e-02 3 1  ON 36
ci_038                 1.578232e-03 3 1  ON 37
ci_039                 1.635431e-03 3 1  ON 38
ci_040                -4.079633e-03 3 1  ON 39
ci_041                 9.679657e-03 3 1  ON 40
ci_042                 1.002947e-02 3 1  ON 41
ci_043                -3.027888e-03 3 1  ON 42
ci_044                -1.489315e-02 3 1  ON 43
ci_045                -1.567789e-03 3 1  ON 44
ci_046                 5.303563e-03 3 1  ON 45
ci_047                 5.670708e-03 3 1  ON 46
ci_048                -1.178939e-02 3 1  ON 47
ci_049                -1.184704e-02 3 1  ON 48
ci_050                 7.428507e-03 3 1  ON 49
ci_051                 7.330109e-03 3 1  ON 50
ci_052                -6.371608e-03 3 1  ON 51
ci_053                -6.378033e-03 3 1  ON 52
ci_054                -3.062276e-03 3 1  ON 53
ci_055                -2.964895e-03 3 1  ON 54
ci_056                 4.797891e-03 3 1  ON 55
ci_057                 4.382734e-03 3 1  ON 56
ci_058                -6.874939e-03 3 1  ON 57
ci_059                -6.804919e-03 3 1  ON 58
ci_060                 8.573793e-03 3 1  ON 59
ci_061                 8.389697e-03 3 1  ON 60
ci_062                -3.706306e-03 3 1  ON 61
ci_063                -3.008169e-03 3 1  ON 62
ci_064                -2.866623e-03 3 1  ON 63
ci_065                -3.996116e-03 3 1  ON 64
ci_066                 5.523126e-03 3 1  ON 65
ci_067                 5.452638e-03 3 1  ON 66
ci_068                -5.103968e-03 3 1  ON 67
ci_069                -5.096020e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.23265
====================================================
  Execution time = 1.3743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1005e-01
  Total weights = 1.9571e+06
  Execution time = 1.8474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297705541333
                                         uncertainty =       0.002009447898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297705541333
                                         uncertainty =       0.002009447898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385820833
  error estimate for blocks of size 2^( 2) =       0.000395874162
  error estimate for blocks of size 2^( 3) =       0.000404818309
  error estimate for blocks of size 2^( 4) =       0.000411971027
  error estimate for blocks of size 2^( 5) =       0.000415394119
  error estimate for blocks of size 2^( 6) =       0.000417894214
  error estimate for blocks of size 2^( 7) =       0.000420489737

      target function =                  N/A
              le_mean =     -17.217302750238
             les_mean =     296.745587564682
             stat err =       0.000416437274
             autocorr =       1.165005144173
              std dev =       0.545633054034
             le_variance =       0.297715429654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297653286441
                                         uncertainty =       0.002006445000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297653286441
                                         uncertainty =       0.002006445000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385787330
  error estimate for blocks of size 2^( 2) =       0.000395844823
  error estimate for blocks of size 2^( 3) =       0.000404791961
  error estimate for blocks of size 2^( 4) =       0.000411944828
  error estimate for blocks of size 2^( 5) =       0.000415369683
  error estimate for blocks of size 2^( 6) =       0.000417867209
  error estimate for blocks of size 2^( 7) =       0.000420461219

      target function =                  N/A
              le_mean =     -17.217302993820
             les_mean =     296.745584131631
             stat err =       0.000416410735
             autocorr =       1.165058979401
              std dev =       0.545585674774
             le_variance =       0.297663728518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297672093984
                                         uncertainty =       0.002007673106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297672093984
                                         uncertainty =       0.002007673106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385799359
  error estimate for blocks of size 2^( 2) =       0.000395855113
  error estimate for blocks of size 2^( 3) =       0.000404801039
  error estimate for blocks of size 2^( 4) =       0.000411953918
  error estimate for blocks of size 2^( 5) =       0.000415378072
  error estimate for blocks of size 2^( 6) =       0.000417876881
  error estimate for blocks of size 2^( 7) =       0.000420471350

      target function =                  N/A
              le_mean =     -17.217302695549
             les_mean =     296.745536022178
             stat err =       0.000416420056
             autocorr =       1.165038484478
              std dev =       0.545602686135
             le_variance =       0.297682291118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297700890104
                                         uncertainty =       0.002009212439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297700890104
                                         uncertainty =       0.002009212439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385817844
  error estimate for blocks of size 2^( 2) =       0.000395871490
  error estimate for blocks of size 2^( 3) =       0.000404815866
  error estimate for blocks of size 2^( 4) =       0.000411968608
  error estimate for blocks of size 2^( 5) =       0.000415391836
  error estimate for blocks of size 2^( 6) =       0.000417891767
  error estimate for blocks of size 2^( 7) =       0.000420487139

      target function =                  N/A
              le_mean =     -17.217302713013
             les_mean =     296.745577875164
             stat err =       0.000416434837
             autocorr =       1.165009554399
              std dev =       0.545628828139
             le_variance =       0.297710818097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217302750238        initial
     1.5259e+00     1.5259e+01             1.8217e-04       -17.217302993820  <--
     6.1035e+00     6.1035e+01             5.0532e-05       -17.217302695549
     2.4414e+01     2.4414e+02             1.2992e-05       -17.217302713013

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.3063e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.052175e-02 3 1  ON 0
ci_002                -3.017214e-02 3 1  ON 1
ci_003                -2.463315e-02 3 1  ON 2
ci_004                 2.064622e-02 3 1  ON 3
ci_005                 2.118654e-02 3 1  ON 4
ci_006                -1.846602e-02 3 1  ON 5
ci_007                -1.876454e-02 3 1  ON 6
ci_008                -1.815603e-02 3 1  ON 7
ci_009                -1.788724e-02 3 1  ON 8
ci_010                -1.704053e-02 3 1  ON 9
ci_011                -1.634951e-02 3 1  ON 10
ci_012                -1.617900e-02 3 1  ON 11
ci_013                -1.930282e-02 3 1  ON 12
ci_014                 1.409472e-02 3 1  ON 13
ci_015                 1.344842e-02 3 1  ON 14
ci_016                 1.657176e-02 3 1  ON 15
ci_017                 1.650280e-02 3 1  ON 16
ci_018                 1.275950e-02 3 1  ON 17
ci_019                 1.302726e-02 3 1  ON 18
ci_020                 1.295626e-02 3 1  ON 19
ci_021                 1.304752e-02 3 1  ON 20
ci_022                 1.133186e-02 3 1  ON 21
ci_023                 1.151302e-02 3 1  ON 22
ci_024                 1.119909e-02 3 1  ON 23
ci_025                 1.101485e-02 3 1  ON 24
ci_026                 1.136202e-02 3 1  ON 25
ci_027                 1.086036e-02 3 1  ON 26
ci_028                -1.404004e-02 3 1  ON 27
ci_029                -1.461993e-02 3 1  ON 28
ci_030                -1.118928e-02 3 1  ON 29
ci_031                -1.141889e-02 3 1  ON 30
ci_032                -1.347686e-02 3 1  ON 31
ci_033                 1.069630e-02 3 1  ON 32
ci_034                 1.025370e-02 3 1  ON 33
ci_035                -4.776310e-03 3 1  ON 34
ci_036                -1.076097e-02 3 1  ON 35
ci_037                -1.019737e-02 3 1  ON 36
ci_038                 1.602539e-03 3 1  ON 37
ci_039                 1.651924e-03 3 1  ON 38
ci_040                -4.044961e-03 3 1  ON 39
ci_041                 9.666598e-03 3 1  ON 40
ci_042                 1.005886e-02 3 1  ON 41
ci_043                -2.957522e-03 3 1  ON 42
ci_044                -1.492840e-02 3 1  ON 43
ci_045                -1.598294e-03 3 1  ON 44
ci_046                 5.362144e-03 3 1  ON 45
ci_047                 5.726789e-03 3 1  ON 46
ci_048                -1.180685e-02 3 1  ON 47
ci_049                -1.186535e-02 3 1  ON 48
ci_050                 7.421380e-03 3 1  ON 49
ci_051                 7.278401e-03 3 1  ON 50
ci_052                -6.322851e-03 3 1  ON 51
ci_053                -6.379591e-03 3 1  ON 52
ci_054                -3.042725e-03 3 1  ON 53
ci_055                -2.970648e-03 3 1  ON 54
ci_056                 4.773937e-03 3 1  ON 55
ci_057                 4.390943e-03 3 1  ON 56
ci_058                -6.892874e-03 3 1  ON 57
ci_059                -6.783732e-03 3 1  ON 58
ci_060                 8.529203e-03 3 1  ON 59
ci_061                 8.418081e-03 3 1  ON 60
ci_062                -3.714231e-03 3 1  ON 61
ci_063                -2.960064e-03 3 1  ON 62
ci_064                -2.878319e-03 3 1  ON 63
ci_065                -3.983258e-03 3 1  ON 64
ci_066                 5.607489e-03 3 1  ON 65
ci_067                 5.434616e-03 3 1  ON 66
ci_068                -5.050421e-03 3 1  ON 67
ci_069                -5.081631e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2187
    reference variance = 0.191789
====================================================
  Execution time = 1.4005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1369e-01
  Total weights = 1.956873967e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299736750942
                                         uncertainty =       0.001882767238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299736750942
                                         uncertainty =       0.001882767238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387131746
  error estimate for blocks of size 2^( 2) =       0.000397514313
  error estimate for blocks of size 2^( 3) =       0.000406514114
  error estimate for blocks of size 2^( 4) =       0.000413079229
  error estimate for blocks of size 2^( 5) =       0.000417934061
  error estimate for blocks of size 2^( 6) =       0.000421925783
  error estimate for blocks of size 2^( 7) =       0.000421557936

      target function =                  N/A
              le_mean =     -17.216113724700
             les_mean =     296.708263360127
             stat err =       0.000418624252
             autocorr =       1.169314128456
              std dev =       0.547486965377
             le_variance =       0.299741977258


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611372470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216113724765       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216107819751       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216108040369       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216108211043       residual = 5.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 4.188065e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216113724765       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216111615394       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216111627906       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 1.412161e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216113724765       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216113134092       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216113126568       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+00 is 3.855021e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6525e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.053377e-02 3 1  ON 0
ci_002                -3.014419e-02 3 1  ON 1
ci_003                -2.455275e-02 3 1  ON 2
ci_004                 2.075128e-02 3 1  ON 3
ci_005                 2.118535e-02 3 1  ON 4
ci_006                -1.846168e-02 3 1  ON 5
ci_007                -1.868439e-02 3 1  ON 6
ci_008                -1.809189e-02 3 1  ON 7
ci_009                -1.788296e-02 3 1  ON 8
ci_010                -1.703695e-02 3 1  ON 9
ci_011                -1.629211e-02 3 1  ON 10
ci_012                -1.618978e-02 3 1  ON 11
ci_013                -1.933443e-02 3 1  ON 12
ci_014                 1.399659e-02 3 1  ON 13
ci_015                 1.337313e-02 3 1  ON 14
ci_016                 1.663121e-02 3 1  ON 15
ci_017                 1.646557e-02 3 1  ON 16
ci_018                 1.270955e-02 3 1  ON 17
ci_019                 1.296374e-02 3 1  ON 18
ci_020                 1.293363e-02 3 1  ON 19
ci_021                 1.300946e-02 3 1  ON 20
ci_022                 1.125952e-02 3 1  ON 21
ci_023                 1.147498e-02 3 1  ON 22
ci_024                 1.115538e-02 3 1  ON 23
ci_025                 1.113331e-02 3 1  ON 24
ci_026                 1.139675e-02 3 1  ON 25
ci_027                 1.089087e-02 3 1  ON 26
ci_028                -1.389882e-02 3 1  ON 27
ci_029                -1.452311e-02 3 1  ON 28
ci_030                -1.114068e-02 3 1  ON 29
ci_031                -1.134817e-02 3 1  ON 30
ci_032                -1.350796e-02 3 1  ON 31
ci_033                 1.068444e-02 3 1  ON 32
ci_034                 1.025465e-02 3 1  ON 33
ci_035                -4.768766e-03 3 1  ON 34
ci_036                -1.076590e-02 3 1  ON 35
ci_037                -1.012562e-02 3 1  ON 36
ci_038                 1.643598e-03 3 1  ON 37
ci_039                 1.690072e-03 3 1  ON 38
ci_040                -4.006067e-03 3 1  ON 39
ci_041                 9.667014e-03 3 1  ON 40
ci_042                 9.927995e-03 3 1  ON 41
ci_043                -2.930310e-03 3 1  ON 42
ci_044                -1.497000e-02 3 1  ON 43
ci_045                -1.657270e-03 3 1  ON 44
ci_046                 5.389297e-03 3 1  ON 45
ci_047                 5.756505e-03 3 1  ON 46
ci_048                -1.181290e-02 3 1  ON 47
ci_049                -1.187391e-02 3 1  ON 48
ci_050                 7.462587e-03 3 1  ON 49
ci_051                 7.366897e-03 3 1  ON 50
ci_052                -6.428909e-03 3 1  ON 51
ci_053                -6.442687e-03 3 1  ON 52
ci_054                -3.089206e-03 3 1  ON 53
ci_055                -3.028828e-03 3 1  ON 54
ci_056                 4.802644e-03 3 1  ON 55
ci_057                 4.490004e-03 3 1  ON 56
ci_058                -6.900524e-03 3 1  ON 57
ci_059                -6.897957e-03 3 1  ON 58
ci_060                 8.470759e-03 3 1  ON 59
ci_061                 8.355155e-03 3 1  ON 60
ci_062                -3.734474e-03 3 1  ON 61
ci_063                -2.975598e-03 3 1  ON 62
ci_064                -2.849432e-03 3 1  ON 63
ci_065                -4.041613e-03 3 1  ON 64
ci_066                 5.537228e-03 3 1  ON 65
ci_067                 5.472090e-03 3 1  ON 66
ci_068                -5.095002e-03 3 1  ON 67
ci_069                -5.036663e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1601
    reference variance = 0.238826
====================================================
  Execution time = 1.3951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1607e-01
  Total weights = 1.9565e+06
  Execution time = 1.8472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589348325
                                         uncertainty =       0.001908863321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589348325
                                         uncertainty =       0.001908863321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731596
  error estimate for blocks of size 2^( 2) =       0.000397873815
  error estimate for blocks of size 2^( 3) =       0.000407194359
  error estimate for blocks of size 2^( 4) =       0.000413978621
  error estimate for blocks of size 2^( 5) =       0.000417717286
  error estimate for blocks of size 2^( 6) =       0.000418826063
  error estimate for blocks of size 2^( 7) =       0.000419803710

      target function =                  N/A
              le_mean =     -17.215810991064
             les_mean =     296.700483638747
             stat err =       0.000417581420
             autocorr =       1.159898394348
              std dev =       0.548335281882
             le_variance =       0.300671581357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300547897388
                                         uncertainty =       0.001909140758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300547897388
                                         uncertainty =       0.001909140758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387703824
  error estimate for blocks of size 2^( 2) =       0.000397853186
  error estimate for blocks of size 2^( 3) =       0.000407185442
  error estimate for blocks of size 2^( 4) =       0.000413973783
  error estimate for blocks of size 2^( 5) =       0.000417723300
  error estimate for blocks of size 2^( 6) =       0.000418829296
  error estimate for blocks of size 2^( 7) =       0.000419790962

      target function =                  N/A
              le_mean =     -17.215815554122
             les_mean =     296.700737882786
             stat err =       0.000417579335
             autocorr =       1.160052990394
              std dev =       0.548296006203
             le_variance =       0.300628510418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556663913
                                         uncertainty =       0.001908331462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300556663913
                                         uncertainty =       0.001908331462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387709763
  error estimate for blocks of size 2^( 2) =       0.000397857170
  error estimate for blocks of size 2^( 3) =       0.000407185838
  error estimate for blocks of size 2^( 4) =       0.000413972824
  error estimate for blocks of size 2^( 5) =       0.000417719291
  error estimate for blocks of size 2^( 6) =       0.000418827222
  error estimate for blocks of size 2^( 7) =       0.000419792918

      target function =                  N/A
              le_mean =     -17.215813068847
             les_mean =     296.700257396280
             stat err =       0.000417578064
             autocorr =       1.160010387127
              std dev =       0.548304404970
             le_variance =       0.300637720509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300582176339
                                         uncertainty =       0.001908584998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300582176339
                                         uncertainty =       0.001908584998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387726865
  error estimate for blocks of size 2^( 2) =       0.000397869796
  error estimate for blocks of size 2^( 3) =       0.000407191490
  error estimate for blocks of size 2^( 4) =       0.000413976131
  error estimate for blocks of size 2^( 5) =       0.000417715865
  error estimate for blocks of size 2^( 6) =       0.000418824518
  error estimate for blocks of size 2^( 7) =       0.000419800382

      target function =                  N/A
              le_mean =     -17.215810945345
             les_mean =     296.700374103704
             stat err =       0.000417579224
             autocorr =       1.159914503378
              std dev =       0.548328590440
             le_variance =       0.300664243094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215810991064        initial
     3.8147e-01     3.8147e+00             4.1881e-04       -17.215815554122  <--
     1.5259e+00     1.5259e+01             1.4122e-04       -17.215813068847
     6.1035e+00     6.1035e+01             3.8550e-05       -17.215810945345

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.3412e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.055457e-02 3 1  ON 0
ci_002                -3.009596e-02 3 1  ON 1
ci_003                -2.438953e-02 3 1  ON 2
ci_004                 2.096802e-02 3 1  ON 3
ci_005                 2.118906e-02 3 1  ON 4
ci_006                -1.845435e-02 3 1  ON 5
ci_007                -1.852990e-02 3 1  ON 6
ci_008                -1.798583e-02 3 1  ON 7
ci_009                -1.787424e-02 3 1  ON 8
ci_010                -1.703158e-02 3 1  ON 9
ci_011                -1.618687e-02 3 1  ON 10
ci_012                -1.621284e-02 3 1  ON 11
ci_013                -1.940405e-02 3 1  ON 12
ci_014                 1.381196e-02 3 1  ON 13
ci_015                 1.322799e-02 3 1  ON 14
ci_016                 1.675300e-02 3 1  ON 15
ci_017                 1.639524e-02 3 1  ON 16
ci_018                 1.262706e-02 3 1  ON 17
ci_019                 1.285412e-02 3 1  ON 18
ci_020                 1.289571e-02 3 1  ON 19
ci_021                 1.293640e-02 3 1  ON 20
ci_022                 1.113725e-02 3 1  ON 21
ci_023                 1.140692e-02 3 1  ON 22
ci_024                 1.106021e-02 3 1  ON 23
ci_025                 1.138146e-02 3 1  ON 24
ci_026                 1.147445e-02 3 1  ON 25
ci_027                 1.094898e-02 3 1  ON 26
ci_028                -1.362123e-02 3 1  ON 27
ci_029                -1.433090e-02 3 1  ON 28
ci_030                -1.104361e-02 3 1  ON 29
ci_031                -1.121443e-02 3 1  ON 30
ci_032                -1.355849e-02 3 1  ON 31
ci_033                 1.066957e-02 3 1  ON 32
ci_034                 1.025964e-02 3 1  ON 33
ci_035                -4.752477e-03 3 1  ON 34
ci_036                -1.077739e-02 3 1  ON 35
ci_037                -9.994663e-03 3 1  ON 36
ci_038                 1.702126e-03 3 1  ON 37
ci_039                 1.746103e-03 3 1  ON 38
ci_040                -3.950309e-03 3 1  ON 39
ci_041                 9.669620e-03 3 1  ON 40
ci_042                 9.692273e-03 3 1  ON 41
ci_043                -2.885465e-03 3 1  ON 42
ci_044                -1.505635e-02 3 1  ON 43
ci_045                -1.744101e-03 3 1  ON 44
ci_046                 5.436835e-03 3 1  ON 45
ci_047                 5.808206e-03 3 1  ON 46
ci_048                -1.183533e-02 3 1  ON 47
ci_049                -1.189284e-02 3 1  ON 48
ci_050                 7.523723e-03 3 1  ON 49
ci_051                 7.504778e-03 3 1  ON 50
ci_052                -6.602781e-03 3 1  ON 51
ci_053                -6.544666e-03 3 1  ON 52
ci_054                -3.165624e-03 3 1  ON 53
ci_055                -3.125834e-03 3 1  ON 54
ci_056                 4.849942e-03 3 1  ON 55
ci_057                 4.651145e-03 3 1  ON 56
ci_058                -6.910159e-03 3 1  ON 57
ci_059                -7.092806e-03 3 1  ON 58
ci_060                 8.365779e-03 3 1  ON 59
ci_061                 8.237796e-03 3 1  ON 60
ci_062                -3.767026e-03 3 1  ON 61
ci_063                -2.999334e-03 3 1  ON 62
ci_064                -2.811211e-03 3 1  ON 63
ci_065                -4.123109e-03 3 1  ON 64
ci_066                 5.426069e-03 3 1  ON 65
ci_067                 5.530153e-03 3 1  ON 66
ci_068                -5.178461e-03 3 1  ON 67
ci_069                -4.963583e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1529
    reference variance = 0.159268
====================================================
  Execution time = 1.3983e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1755e-01
  Total weights = 1.956760976e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299952316723
                                         uncertainty =       0.002017937719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299952316723
                                         uncertainty =       0.002017937719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387220060
  error estimate for blocks of size 2^( 2) =       0.000397079214
  error estimate for blocks of size 2^( 3) =       0.000406575379
  error estimate for blocks of size 2^( 4) =       0.000412442782
  error estimate for blocks of size 2^( 5) =       0.000416724170
  error estimate for blocks of size 2^( 6) =       0.000418685690
  error estimate for blocks of size 2^( 7) =       0.000420027893

      target function =                  N/A
              le_mean =     -17.215845353542
             les_mean =     296.702877259683
             stat err =       0.000416970134
             autocorr =       1.159562605108
              std dev =       0.547611861058
             le_variance =       0.299878750372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584535354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215845353611       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215866504970       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215866933682       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215866779659       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215866911699       residual = 5.25e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-02 is 1.835048e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215845353611       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215856860298       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215857136809       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215857096669       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-01 is 8.971617e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215845353611       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215849428305       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215849581631       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215849577396       residual = 3.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+00 is 2.946040e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026562 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6497e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.055528e-02 3 1  ON 0
ci_002                -2.988706e-02 3 1  ON 1
ci_003                -2.442860e-02 3 1  ON 2
ci_004                 2.111190e-02 3 1  ON 3
ci_005                 2.093815e-02 3 1  ON 4
ci_006                -1.832216e-02 3 1  ON 5
ci_007                -1.847029e-02 3 1  ON 6
ci_008                -1.801820e-02 3 1  ON 7
ci_009                -1.743483e-02 3 1  ON 8
ci_010                -1.706463e-02 3 1  ON 9
ci_011                -1.642884e-02 3 1  ON 10
ci_012                -1.570238e-02 3 1  ON 11
ci_013                -1.930427e-02 3 1  ON 12
ci_014                 1.364273e-02 3 1  ON 13
ci_015                 1.366542e-02 3 1  ON 14
ci_016                 1.692606e-02 3 1  ON 15
ci_017                 1.693576e-02 3 1  ON 16
ci_018                 1.314175e-02 3 1  ON 17
ci_019                 1.290998e-02 3 1  ON 18
ci_020                 1.274056e-02 3 1  ON 19
ci_021                 1.383356e-02 3 1  ON 20
ci_022                 1.189971e-02 3 1  ON 21
ci_023                 1.179579e-02 3 1  ON 22
ci_024                 1.114481e-02 3 1  ON 23
ci_025                 1.142900e-02 3 1  ON 24
ci_026                 1.128415e-02 3 1  ON 25
ci_027                 1.114798e-02 3 1  ON 26
ci_028                -1.310548e-02 3 1  ON 27
ci_029                -1.429397e-02 3 1  ON 28
ci_030                -1.089008e-02 3 1  ON 29
ci_031                -1.143925e-02 3 1  ON 30
ci_032                -1.427195e-02 3 1  ON 31
ci_033                 1.061815e-02 3 1  ON 32
ci_034                 1.079636e-02 3 1  ON 33
ci_035                -4.551127e-03 3 1  ON 34
ci_036                -1.043879e-02 3 1  ON 35
ci_037                -1.028910e-02 3 1  ON 36
ci_038                 1.545178e-03 3 1  ON 37
ci_039                 2.053164e-03 3 1  ON 38
ci_040                -3.861486e-03 3 1  ON 39
ci_041                 9.132929e-03 3 1  ON 40
ci_042                 9.676366e-03 3 1  ON 41
ci_043                -2.938091e-03 3 1  ON 42
ci_044                -1.495113e-02 3 1  ON 43
ci_045                -1.899718e-03 3 1  ON 44
ci_046                 5.479159e-03 3 1  ON 45
ci_047                 5.837191e-03 3 1  ON 46
ci_048                -1.208835e-02 3 1  ON 47
ci_049                -1.198959e-02 3 1  ON 48
ci_050                 7.479397e-03 3 1  ON 49
ci_051                 7.675396e-03 3 1  ON 50
ci_052                -6.919747e-03 3 1  ON 51
ci_053                -6.790865e-03 3 1  ON 52
ci_054                -3.139842e-03 3 1  ON 53
ci_055                -3.075087e-03 3 1  ON 54
ci_056                 4.784291e-03 3 1  ON 55
ci_057                 4.238879e-03 3 1  ON 56
ci_058                -6.521458e-03 3 1  ON 57
ci_059                -6.688887e-03 3 1  ON 58
ci_060                 8.211493e-03 3 1  ON 59
ci_061                 8.571452e-03 3 1  ON 60
ci_062                -3.569606e-03 3 1  ON 61
ci_063                -2.794795e-03 3 1  ON 62
ci_064                -3.029244e-03 3 1  ON 63
ci_065                -4.080770e-03 3 1  ON 64
ci_066                 5.577774e-03 3 1  ON 65
ci_067                 5.904632e-03 3 1  ON 66
ci_068                -4.982222e-03 3 1  ON 67
ci_069                -5.346690e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.257111
====================================================
  Execution time = 1.3522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1410e-01
  Total weights = 1.9567e+06
  Execution time = 1.8518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0754273
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298795036881
                                         uncertainty =       0.002227297263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298795036881
                                         uncertainty =       0.002227297263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386493315
  error estimate for blocks of size 2^( 2) =       0.000396546215
  error estimate for blocks of size 2^( 3) =       0.000405500738
  error estimate for blocks of size 2^( 4) =       0.000412100948
  error estimate for blocks of size 2^( 5) =       0.000416482832
  error estimate for blocks of size 2^( 6) =       0.000417821422
  error estimate for blocks of size 2^( 7) =       0.000420087595

      target function =                  N/A
              le_mean =     -17.216151039456
             les_mean =     296.710944659519
             stat err =       0.000416623199
             autocorr =       1.161991435328
              std dev =       0.546584087398
             le_variance =       0.298754164597

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0422203
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299010721561
                                         uncertainty =       0.002195608916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299010721561
                                         uncertainty =       0.002195608916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386632027
  error estimate for blocks of size 2^( 2) =       0.000396664959
  error estimate for blocks of size 2^( 3) =       0.000405606050
  error estimate for blocks of size 2^( 4) =       0.000412187240
  error estimate for blocks of size 2^( 5) =       0.000416591413
  error estimate for blocks of size 2^( 6) =       0.000417915682
  error estimate for blocks of size 2^( 7) =       0.000420153165

      target function =                  N/A
              le_mean =     -17.216141068246
             les_mean =     296.710822202352
             stat err =       0.000416711875
             autocorr =       1.161652151577
              std dev =       0.546780255681
             le_variance =       0.298968648003

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0778926
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089313898
                                         uncertainty =       0.002193843851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089313898
                                         uncertainty =       0.002193843851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386682731
  error estimate for blocks of size 2^( 2) =       0.000396713473
  error estimate for blocks of size 2^( 3) =       0.000405652727
  error estimate for blocks of size 2^( 4) =       0.000412231528
  error estimate for blocks of size 2^( 5) =       0.000416625029
  error estimate for blocks of size 2^( 6) =       0.000417941524
  error estimate for blocks of size 2^( 7) =       0.000420183567

      target function =                  N/A
              le_mean =     -17.216142421026
             les_mean =     296.712530518172
             stat err =       0.000416745412
             autocorr =       1.161534460461
              std dev =       0.546851963019
             le_variance =       0.299047069458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298781355318
                                         uncertainty =       0.002219844766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298781355318
                                         uncertainty =       0.002219844766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386484328
  error estimate for blocks of size 2^( 2) =       0.000396531841
  error estimate for blocks of size 2^( 3) =       0.000405483878
  error estimate for blocks of size 2^( 4) =       0.000412081164
  error estimate for blocks of size 2^( 5) =       0.000416464121
  error estimate for blocks of size 2^( 6) =       0.000417797389
  error estimate for blocks of size 2^( 7) =       0.000420053905

      target function =                  N/A
              le_mean =     -17.216142305138
             les_mean =     296.712507059890
             stat err =       0.000416599145
             autocorr =       1.161911292083
              std dev =       0.546571378552
             le_variance =       0.298740271853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216151039456        initial  <--
     9.5367e-02     9.5367e-01             1.8350e-03       -17.216141068246
     3.8147e-01     3.8147e+00             8.9716e-04       -17.216142421026
     1.5259e+00     1.5259e+01             2.9460e-04       -17.216142305138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8511
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.055457e-02 3 1  ON 0
ci_002                -3.009596e-02 3 1  ON 1
ci_003                -2.438953e-02 3 1  ON 2
ci_004                 2.096802e-02 3 1  ON 3
ci_005                 2.118906e-02 3 1  ON 4
ci_006                -1.845435e-02 3 1  ON 5
ci_007                -1.852990e-02 3 1  ON 6
ci_008                -1.798583e-02 3 1  ON 7
ci_009                -1.787424e-02 3 1  ON 8
ci_010                -1.703158e-02 3 1  ON 9
ci_011                -1.618687e-02 3 1  ON 10
ci_012                -1.621284e-02 3 1  ON 11
ci_013                -1.940405e-02 3 1  ON 12
ci_014                 1.381196e-02 3 1  ON 13
ci_015                 1.322799e-02 3 1  ON 14
ci_016                 1.675300e-02 3 1  ON 15
ci_017                 1.639524e-02 3 1  ON 16
ci_018                 1.262706e-02 3 1  ON 17
ci_019                 1.285412e-02 3 1  ON 18
ci_020                 1.289571e-02 3 1  ON 19
ci_021                 1.293640e-02 3 1  ON 20
ci_022                 1.113725e-02 3 1  ON 21
ci_023                 1.140692e-02 3 1  ON 22
ci_024                 1.106021e-02 3 1  ON 23
ci_025                 1.138146e-02 3 1  ON 24
ci_026                 1.147445e-02 3 1  ON 25
ci_027                 1.094898e-02 3 1  ON 26
ci_028                -1.362123e-02 3 1  ON 27
ci_029                -1.433090e-02 3 1  ON 28
ci_030                -1.104361e-02 3 1  ON 29
ci_031                -1.121443e-02 3 1  ON 30
ci_032                -1.355849e-02 3 1  ON 31
ci_033                 1.066957e-02 3 1  ON 32
ci_034                 1.025964e-02 3 1  ON 33
ci_035                -4.752477e-03 3 1  ON 34
ci_036                -1.077739e-02 3 1  ON 35
ci_037                -9.994663e-03 3 1  ON 36
ci_038                 1.702126e-03 3 1  ON 37
ci_039                 1.746103e-03 3 1  ON 38
ci_040                -3.950309e-03 3 1  ON 39
ci_041                 9.669620e-03 3 1  ON 40
ci_042                 9.692273e-03 3 1  ON 41
ci_043                -2.885465e-03 3 1  ON 42
ci_044                -1.505635e-02 3 1  ON 43
ci_045                -1.744101e-03 3 1  ON 44
ci_046                 5.436835e-03 3 1  ON 45
ci_047                 5.808206e-03 3 1  ON 46
ci_048                -1.183533e-02 3 1  ON 47
ci_049                -1.189284e-02 3 1  ON 48
ci_050                 7.523723e-03 3 1  ON 49
ci_051                 7.504778e-03 3 1  ON 50
ci_052                -6.602781e-03 3 1  ON 51
ci_053                -6.544666e-03 3 1  ON 52
ci_054                -3.165624e-03 3 1  ON 53
ci_055                -3.125834e-03 3 1  ON 54
ci_056                 4.849942e-03 3 1  ON 55
ci_057                 4.651145e-03 3 1  ON 56
ci_058                -6.910159e-03 3 1  ON 57
ci_059                -7.092806e-03 3 1  ON 58
ci_060                 8.365779e-03 3 1  ON 59
ci_061                 8.237796e-03 3 1  ON 60
ci_062                -3.767026e-03 3 1  ON 61
ci_063                -2.999334e-03 3 1  ON 62
ci_064                -2.811211e-03 3 1  ON 63
ci_065                -4.123109e-03 3 1  ON 64
ci_066                 5.426069e-03 3 1  ON 65
ci_067                 5.530153e-03 3 1  ON 66
ci_068                -5.178461e-03 3 1  ON 67
ci_069                -4.963583e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2488
    reference variance = 0.207201
====================================================
  Execution time = 1.4281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1360e-01
  Total weights = 1.956504394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5279e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301349395074
                                         uncertainty =       0.003007972604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301349395074
                                         uncertainty =       0.003007972604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388147860
  error estimate for blocks of size 2^( 2) =       0.000398401362
  error estimate for blocks of size 2^( 3) =       0.000406416186
  error estimate for blocks of size 2^( 4) =       0.000413008293
  error estimate for blocks of size 2^( 5) =       0.000416899069
  error estimate for blocks of size 2^( 6) =       0.000417513984
  error estimate for blocks of size 2^( 7) =       0.000418370106

      target function =                  N/A
              le_mean =     -17.215756925966
             les_mean =     296.695884058012
             stat err =       0.000416447863
             autocorr =       1.151136657270
              std dev =       0.548923967356
             le_variance =       0.301317521938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721575692597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756926031       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215759253722       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215759328855       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.202707e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756926031       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215757621263       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215757633648       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 6.451768e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215756926031       residual = 8.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215757108733       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215757111267       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+01 is 1.702186e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6820e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.056598e-02 3 1  ON 0
ci_002                -3.007895e-02 3 1  ON 1
ci_003                -2.439631e-02 3 1  ON 2
ci_004                 2.098937e-02 3 1  ON 3
ci_005                 2.120478e-02 3 1  ON 4
ci_006                -1.848661e-02 3 1  ON 5
ci_007                -1.855165e-02 3 1  ON 6
ci_008                -1.792637e-02 3 1  ON 7
ci_009                -1.789312e-02 3 1  ON 8
ci_010                -1.704140e-02 3 1  ON 9
ci_011                -1.617873e-02 3 1  ON 10
ci_012                -1.621450e-02 3 1  ON 11
ci_013                -1.939191e-02 3 1  ON 12
ci_014                 1.380505e-02 3 1  ON 13
ci_015                 1.327645e-02 3 1  ON 14
ci_016                 1.674369e-02 3 1  ON 15
ci_017                 1.638136e-02 3 1  ON 16
ci_018                 1.261158e-02 3 1  ON 17
ci_019                 1.289700e-02 3 1  ON 18
ci_020                 1.291649e-02 3 1  ON 19
ci_021                 1.290553e-02 3 1  ON 20
ci_022                 1.118869e-02 3 1  ON 21
ci_023                 1.141461e-02 3 1  ON 22
ci_024                 1.108348e-02 3 1  ON 23
ci_025                 1.137540e-02 3 1  ON 24
ci_026                 1.143308e-02 3 1  ON 25
ci_027                 1.096068e-02 3 1  ON 26
ci_028                -1.365361e-02 3 1  ON 27
ci_029                -1.433456e-02 3 1  ON 28
ci_030                -1.107585e-02 3 1  ON 29
ci_031                -1.120217e-02 3 1  ON 30
ci_032                -1.356737e-02 3 1  ON 31
ci_033                 1.073359e-02 3 1  ON 32
ci_034                 1.027600e-02 3 1  ON 33
ci_035                -4.739663e-03 3 1  ON 34
ci_036                -1.078936e-02 3 1  ON 35
ci_037                -9.997956e-03 3 1  ON 36
ci_038                 1.675995e-03 3 1  ON 37
ci_039                 1.709767e-03 3 1  ON 38
ci_040                -3.942461e-03 3 1  ON 39
ci_041                 9.677711e-03 3 1  ON 40
ci_042                 9.695948e-03 3 1  ON 41
ci_043                -2.885747e-03 3 1  ON 42
ci_044                -1.503189e-02 3 1  ON 43
ci_045                -1.741556e-03 3 1  ON 44
ci_046                 5.441199e-03 3 1  ON 45
ci_047                 5.763335e-03 3 1  ON 46
ci_048                -1.185320e-02 3 1  ON 47
ci_049                -1.191789e-02 3 1  ON 48
ci_050                 7.534008e-03 3 1  ON 49
ci_051                 7.524162e-03 3 1  ON 50
ci_052                -6.617324e-03 3 1  ON 51
ci_053                -6.512179e-03 3 1  ON 52
ci_054                -3.116054e-03 3 1  ON 53
ci_055                -3.137084e-03 3 1  ON 54
ci_056                 4.794217e-03 3 1  ON 55
ci_057                 4.656501e-03 3 1  ON 56
ci_058                -6.905648e-03 3 1  ON 57
ci_059                -7.028288e-03 3 1  ON 58
ci_060                 8.367639e-03 3 1  ON 59
ci_061                 8.286823e-03 3 1  ON 60
ci_062                -3.750371e-03 3 1  ON 61
ci_063                -2.988930e-03 3 1  ON 62
ci_064                -2.844747e-03 3 1  ON 63
ci_065                -4.135310e-03 3 1  ON 64
ci_066                 5.427727e-03 3 1  ON 65
ci_067                 5.507723e-03 3 1  ON 66
ci_068                -5.213661e-03 3 1  ON 67
ci_069                -4.950157e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1523
    reference variance = 0.339713
====================================================
  Execution time = 1.3990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1194e-01
  Total weights = 1.9570e+06
  Execution time = 1.8472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298588421091
                                         uncertainty =       0.002150729411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298588421091
                                         uncertainty =       0.002150729411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386436691
  error estimate for blocks of size 2^( 2) =       0.000396358568
  error estimate for blocks of size 2^( 3) =       0.000404941627
  error estimate for blocks of size 2^( 4) =       0.000412136172
  error estimate for blocks of size 2^( 5) =       0.000415727876
  error estimate for blocks of size 2^( 6) =       0.000418657695
  error estimate for blocks of size 2^( 7) =       0.000420448483

      target function =                  N/A
              le_mean =     -17.217533291341
             les_mean =     296.755381353531
             stat err =       0.000416742556
             autocorr =       1.162998069256
              std dev =       0.546504009353
             le_variance =       0.298666632239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298540535291
                                         uncertainty =       0.002159317384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298540535291
                                         uncertainty =       0.002159317384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386405737
  error estimate for blocks of size 2^( 2) =       0.000396324613
  error estimate for blocks of size 2^( 3) =       0.000404900308
  error estimate for blocks of size 2^( 4) =       0.000412088574
  error estimate for blocks of size 2^( 5) =       0.000415684278
  error estimate for blocks of size 2^( 6) =       0.000418615133
  error estimate for blocks of size 2^( 7) =       0.000420409127

      target function =                  N/A
              le_mean =     -17.217535352935
             les_mean =     296.755623990707
             stat err =       0.000416699278
             autocorr =       1.162942824032
              std dev =       0.546460234373
             le_variance =       0.298618787751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298554714712
                                         uncertainty =       0.002155662269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298554714712
                                         uncertainty =       0.002155662269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386414907
  error estimate for blocks of size 2^( 2) =       0.000396334884
  error estimate for blocks of size 2^( 3) =       0.000404913658
  error estimate for blocks of size 2^( 4) =       0.000412104533
  error estimate for blocks of size 2^( 5) =       0.000415698659
  error estimate for blocks of size 2^( 6) =       0.000418628693
  error estimate for blocks of size 2^( 7) =       0.000420421510

      target function =                  N/A
              le_mean =     -17.217534199148
             les_mean =     296.755468963983
             stat err =       0.000416713349
             autocorr =       1.162966168531
              std dev =       0.546473202200
             le_variance =       0.298632960723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298583399053
                                         uncertainty =       0.002151358332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298583399053
                                         uncertainty =       0.002151358332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386433445
  error estimate for blocks of size 2^( 2) =       0.000396355063
  error estimate for blocks of size 2^( 3) =       0.000404937557
  error estimate for blocks of size 2^( 4) =       0.000412131636
  error estimate for blocks of size 2^( 5) =       0.000415723647
  error estimate for blocks of size 2^( 6) =       0.000418653483
  error estimate for blocks of size 2^( 7) =       0.000420444543

      target function =                  N/A
              le_mean =     -17.217533348365
             les_mean =     296.755378741225
             stat err =       0.000416738327
             autocorr =       1.162993999026
              std dev =       0.546499419465
             le_variance =       0.298661615475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217533291341        initial
     9.5367e-01     9.5367e+00             2.2027e-04       -17.217535352935  <--
     3.8147e+00     3.8147e+01             6.4518e-05       -17.217534199148
     1.5259e+01     1.5259e+02             1.7022e-05       -17.217533348365

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 2.3300e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.059537e-02 3 1  ON 0
ci_002                -3.003720e-02 3 1  ON 1
ci_003                -2.441214e-02 3 1  ON 2
ci_004                 2.104260e-02 3 1  ON 3
ci_005                 2.124101e-02 3 1  ON 4
ci_006                -1.856681e-02 3 1  ON 5
ci_007                -1.860539e-02 3 1  ON 6
ci_008                -1.778884e-02 3 1  ON 7
ci_009                -1.793760e-02 3 1  ON 8
ci_010                -1.706751e-02 3 1  ON 9
ci_011                -1.615918e-02 3 1  ON 10
ci_012                -1.621840e-02 3 1  ON 11
ci_013                -1.936179e-02 3 1  ON 12
ci_014                 1.378731e-02 3 1  ON 13
ci_015                 1.339066e-02 3 1  ON 14
ci_016                 1.671692e-02 3 1  ON 15
ci_017                 1.634594e-02 3 1  ON 16
ci_018                 1.257489e-02 3 1  ON 17
ci_019                 1.299885e-02 3 1  ON 18
ci_020                 1.296752e-02 3 1  ON 19
ci_021                 1.282651e-02 3 1  ON 20
ci_022                 1.130937e-02 3 1  ON 21
ci_023                 1.143193e-02 3 1  ON 22
ci_024                 1.114442e-02 3 1  ON 23
ci_025                 1.136053e-02 3 1  ON 24
ci_026                 1.133153e-02 3 1  ON 25
ci_027                 1.098740e-02 3 1  ON 26
ci_028                -1.373421e-02 3 1  ON 27
ci_029                -1.434310e-02 3 1  ON 28
ci_030                -1.115443e-02 3 1  ON 29
ci_031                -1.117357e-02 3 1  ON 30
ci_032                -1.358867e-02 3 1  ON 31
ci_033                 1.088984e-02 3 1  ON 32
ci_034                 1.031684e-02 3 1  ON 33
ci_035                -4.711859e-03 3 1  ON 34
ci_036                -1.081684e-02 3 1  ON 35
ci_037                -1.000578e-02 3 1  ON 36
ci_038                 1.620887e-03 3 1  ON 37
ci_039                 1.633970e-03 3 1  ON 38
ci_040                -3.926699e-03 3 1  ON 39
ci_041                 9.696432e-03 3 1  ON 40
ci_042                 9.705708e-03 3 1  ON 41
ci_043                -2.886706e-03 3 1  ON 42
ci_044                -1.496917e-02 3 1  ON 43
ci_045                -1.736107e-03 3 1  ON 44
ci_046                 5.452240e-03 3 1  ON 45
ci_047                 5.657829e-03 3 1  ON 46
ci_048                -1.189807e-02 3 1  ON 47
ci_049                -1.198076e-02 3 1  ON 48
ci_050                 7.557161e-03 3 1  ON 49
ci_051                 7.567739e-03 3 1  ON 50
ci_052                -6.650046e-03 3 1  ON 51
ci_053                -6.438031e-03 3 1  ON 52
ci_054                -3.002826e-03 3 1  ON 53
ci_055                -3.163495e-03 3 1  ON 54
ci_056                 4.671106e-03 3 1  ON 55
ci_057                 4.668084e-03 3 1  ON 56
ci_058                -6.895254e-03 3 1  ON 57
ci_059                -6.879424e-03 3 1  ON 58
ci_060                 8.372300e-03 3 1  ON 59
ci_061                 8.403151e-03 3 1  ON 60
ci_062                -3.712925e-03 3 1  ON 61
ci_063                -2.965642e-03 3 1  ON 62
ci_064                -2.907608e-03 3 1  ON 63
ci_065                -4.158291e-03 3 1  ON 64
ci_066                 5.431251e-03 3 1  ON 65
ci_067                 5.458733e-03 3 1  ON 66
ci_068                -5.296301e-03 3 1  ON 67
ci_069                -4.916612e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1871
    reference variance = 0.189545
====================================================
  Execution time = 1.4408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1750e-01
  Total weights = 1.956504442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304193000080
                                         uncertainty =       0.002650560702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304193000080
                                         uncertainty =       0.002650560702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389989567
  error estimate for blocks of size 2^( 2) =       0.000399997520
  error estimate for blocks of size 2^( 3) =       0.000409092479
  error estimate for blocks of size 2^( 4) =       0.000415115006
  error estimate for blocks of size 2^( 5) =       0.000419255226
  error estimate for blocks of size 2^( 6) =       0.000423223530
  error estimate for blocks of size 2^( 7) =       0.000424466423

      target function =                  N/A
              le_mean =     -17.217004063120
             les_mean =     296.742726175471
             stat err =       0.000420515046
             autocorr =       1.162671701120
              std dev =       0.551528534512
             le_variance =       0.304183724381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700406312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004063189       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217005956589       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217005036866       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217004832247       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 9.570660e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004063189       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217004824362       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217004525464       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 3.487096e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004063189       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217004287595       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217004214694       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+00 is 9.838057e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6923e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.039260e-02 3 1  ON 0
ci_002                -2.991209e-02 3 1  ON 1
ci_003                -2.450444e-02 3 1  ON 2
ci_004                 2.106445e-02 3 1  ON 3
ci_005                 2.140060e-02 3 1  ON 4
ci_006                -1.841781e-02 3 1  ON 5
ci_007                -1.872535e-02 3 1  ON 6
ci_008                -1.766766e-02 3 1  ON 7
ci_009                -1.789881e-02 3 1  ON 8
ci_010                -1.720253e-02 3 1  ON 9
ci_011                -1.608563e-02 3 1  ON 10
ci_012                -1.618441e-02 3 1  ON 11
ci_013                -1.935358e-02 3 1  ON 12
ci_014                 1.365500e-02 3 1  ON 13
ci_015                 1.351183e-02 3 1  ON 14
ci_016                 1.678550e-02 3 1  ON 15
ci_017                 1.637208e-02 3 1  ON 16
ci_018                 1.260761e-02 3 1  ON 17
ci_019                 1.303066e-02 3 1  ON 18
ci_020                 1.284310e-02 3 1  ON 19
ci_021                 1.280677e-02 3 1  ON 20
ci_022                 1.136898e-02 3 1  ON 21
ci_023                 1.145878e-02 3 1  ON 22
ci_024                 1.149313e-02 3 1  ON 23
ci_025                 1.140882e-02 3 1  ON 24
ci_026                 1.138591e-02 3 1  ON 25
ci_027                 1.086030e-02 3 1  ON 26
ci_028                -1.363581e-02 3 1  ON 27
ci_029                -1.434040e-02 3 1  ON 28
ci_030                -1.117648e-02 3 1  ON 29
ci_031                -1.120057e-02 3 1  ON 30
ci_032                -1.360565e-02 3 1  ON 31
ci_033                 1.079440e-02 3 1  ON 32
ci_034                 1.044160e-02 3 1  ON 33
ci_035                -4.780039e-03 3 1  ON 34
ci_036                -1.080087e-02 3 1  ON 35
ci_037                -9.948283e-03 3 1  ON 36
ci_038                 1.668203e-03 3 1  ON 37
ci_039                 1.599394e-03 3 1  ON 38
ci_040                -3.899734e-03 3 1  ON 39
ci_041                 9.790485e-03 3 1  ON 40
ci_042                 9.705792e-03 3 1  ON 41
ci_043                -2.846668e-03 3 1  ON 42
ci_044                -1.489519e-02 3 1  ON 43
ci_045                -1.810035e-03 3 1  ON 44
ci_046                 5.507875e-03 3 1  ON 45
ci_047                 5.645368e-03 3 1  ON 46
ci_048                -1.187213e-02 3 1  ON 47
ci_049                -1.183544e-02 3 1  ON 48
ci_050                 7.504397e-03 3 1  ON 49
ci_051                 7.578371e-03 3 1  ON 50
ci_052                -6.643661e-03 3 1  ON 51
ci_053                -6.647891e-03 3 1  ON 52
ci_054                -2.864943e-03 3 1  ON 53
ci_055                -3.307082e-03 3 1  ON 54
ci_056                 4.666393e-03 3 1  ON 55
ci_057                 4.729839e-03 3 1  ON 56
ci_058                -6.879042e-03 3 1  ON 57
ci_059                -6.845894e-03 3 1  ON 58
ci_060                 8.254644e-03 3 1  ON 59
ci_061                 8.602380e-03 3 1  ON 60
ci_062                -3.653691e-03 3 1  ON 61
ci_063                -3.043222e-03 3 1  ON 62
ci_064                -2.952947e-03 3 1  ON 63
ci_065                -4.185065e-03 3 1  ON 64
ci_066                 5.321496e-03 3 1  ON 65
ci_067                 5.736131e-03 3 1  ON 66
ci_068                -5.337255e-03 3 1  ON 67
ci_069                -4.903741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1486
    reference variance = 0.235754
====================================================
  Execution time = 1.3812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1027e-01
  Total weights = 1.9568e+06
  Execution time = 1.8407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295981055190
                                         uncertainty =       0.001974873989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295981055190
                                         uncertainty =       0.001974873989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384712342
  error estimate for blocks of size 2^( 2) =       0.000394664350
  error estimate for blocks of size 2^( 3) =       0.000403734769
  error estimate for blocks of size 2^( 4) =       0.000410997100
  error estimate for blocks of size 2^( 5) =       0.000415084096
  error estimate for blocks of size 2^( 6) =       0.000416802432
  error estimate for blocks of size 2^( 7) =       0.000418707457

      target function =                  N/A
              le_mean =     -17.215596750884
             les_mean =     296.723544731328
             stat err =       0.000415397771
             autocorr =       1.165885993683
              std dev =       0.544065412088
             le_variance =       0.296007172631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296056497998
                                         uncertainty =       0.001969226288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296056497998
                                         uncertainty =       0.001969226288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384757588
  error estimate for blocks of size 2^( 2) =       0.000394708452
  error estimate for blocks of size 2^( 3) =       0.000403780827
  error estimate for blocks of size 2^( 4) =       0.000411038893
  error estimate for blocks of size 2^( 5) =       0.000415118547
  error estimate for blocks of size 2^( 6) =       0.000416852627
  error estimate for blocks of size 2^( 7) =       0.000418765161

      target function =                  N/A
              le_mean =     -17.215602206363
             les_mean =     296.691243344912
             stat err =       0.000415443807
             autocorr =       1.165870171979
              std dev =       0.544129399424
             le_variance =       0.296076803317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296020807867
                                         uncertainty =       0.001970213752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296020807867
                                         uncertainty =       0.001970213752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384734409
  error estimate for blocks of size 2^( 2) =       0.000394685547
  error estimate for blocks of size 2^( 3) =       0.000403756830
  error estimate for blocks of size 2^( 4) =       0.000411015875
  error estimate for blocks of size 2^( 5) =       0.000415096785
  error estimate for blocks of size 2^( 6) =       0.000416818200
  error estimate for blocks of size 2^( 7) =       0.000418731809

      target function =                  N/A
              le_mean =     -17.215598292158
             les_mean =     296.696762784407
             stat err =       0.000415415668
             autocorr =       1.165852705991
              std dev =       0.544096619140
             le_variance =       0.296041130960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295977627263
                                         uncertainty =       0.001974145340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295977627263
                                         uncertainty =       0.001974145340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384706485
  error estimate for blocks of size 2^( 2) =       0.000394658116
  error estimate for blocks of size 2^( 3) =       0.000403728495
  error estimate for blocks of size 2^( 4) =       0.000410990970
  error estimate for blocks of size 2^( 5) =       0.000415080057
  error estimate for blocks of size 2^( 6) =       0.000416797599
  error estimate for blocks of size 2^( 7) =       0.000418704000

      target function =                  N/A
              le_mean =     -17.215595082880
             les_mean =     296.687196359188
             stat err =       0.000415393156
             autocorr =       1.165895593219
              std dev =       0.544057128026
             le_variance =       0.295998158556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215596750884        initial
     2.3842e-01     2.3842e+00             9.5707e-04       -17.215602206363  <--
     9.5367e-01     9.5367e+00             3.4871e-04       -17.215598292158
     3.8147e+00     3.8147e+01             9.8381e-05       -17.215595082880

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.3088e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.004512e-02 3 1  ON 0
ci_002                -2.972025e-02 3 1  ON 1
ci_003                -2.467333e-02 3 1  ON 2
ci_004                 2.110446e-02 3 1  ON 3
ci_005                 2.168367e-02 3 1  ON 4
ci_006                -1.817335e-02 3 1  ON 5
ci_007                -1.892070e-02 3 1  ON 6
ci_008                -1.750492e-02 3 1  ON 7
ci_009                -1.783554e-02 3 1  ON 8
ci_010                -1.743787e-02 3 1  ON 9
ci_011                -1.598708e-02 3 1  ON 10
ci_012                -1.613875e-02 3 1  ON 11
ci_013                -1.934413e-02 3 1  ON 12
ci_014                 1.345712e-02 3 1  ON 13
ci_015                 1.369454e-02 3 1  ON 14
ci_016                 1.691028e-02 3 1  ON 15
ci_017                 1.642296e-02 3 1  ON 16
ci_018                 1.265485e-02 3 1  ON 17
ci_019                 1.306883e-02 3 1  ON 18
ci_020                 1.263177e-02 3 1  ON 19
ci_021                 1.277541e-02 3 1  ON 20
ci_022                 1.145707e-02 3 1  ON 21
ci_023                 1.149587e-02 3 1  ON 22
ci_024                 1.210149e-02 3 1  ON 23
ci_025                 1.148662e-02 3 1  ON 24
ci_026                 1.147318e-02 3 1  ON 25
ci_027                 1.066271e-02 3 1  ON 26
ci_028                -1.346967e-02 3 1  ON 27
ci_029                -1.433997e-02 3 1  ON 28
ci_030                -1.120912e-02 3 1  ON 29
ci_031                -1.124542e-02 3 1  ON 30
ci_032                -1.363836e-02 3 1  ON 31
ci_033                 1.065049e-02 3 1  ON 32
ci_034                 1.063386e-02 3 1  ON 33
ci_035                -4.857930e-03 3 1  ON 34
ci_036                -1.077942e-02 3 1  ON 35
ci_037                -9.859959e-03 3 1  ON 36
ci_038                 1.718796e-03 3 1  ON 37
ci_039                 1.553955e-03 3 1  ON 38
ci_040                -3.865277e-03 3 1  ON 39
ci_041                 9.931026e-03 3 1  ON 40
ci_042                 9.704905e-03 3 1  ON 41
ci_043                -2.799204e-03 3 1  ON 42
ci_044                -1.476135e-02 3 1  ON 43
ci_045                -1.891938e-03 3 1  ON 44
ci_046                 5.589351e-03 3 1  ON 45
ci_047                 5.622633e-03 3 1  ON 46
ci_048                -1.183745e-02 3 1  ON 47
ci_049                -1.158634e-02 3 1  ON 48
ci_050                 7.439859e-03 3 1  ON 49
ci_051                 7.586968e-03 3 1  ON 50
ci_052                -6.638896e-03 3 1  ON 51
ci_053                -6.915490e-03 3 1  ON 52
ci_054                -2.678527e-03 3 1  ON 53
ci_055                -3.500406e-03 3 1  ON 54
ci_056                 4.661191e-03 3 1  ON 55
ci_057                 4.805082e-03 3 1  ON 56
ci_058                -6.853397e-03 3 1  ON 57
ci_059                -6.799046e-03 3 1  ON 58
ci_060                 8.073899e-03 3 1  ON 59
ci_061                 8.895342e-03 3 1  ON 60
ci_062                -3.572403e-03 3 1  ON 61
ci_063                -3.147251e-03 3 1  ON 62
ci_064                -3.000853e-03 3 1  ON 63
ci_065                -4.211016e-03 3 1  ON 64
ci_066                 5.190530e-03 3 1  ON 65
ci_067                 6.074395e-03 3 1  ON 66
ci_068                -5.396097e-03 3 1  ON 67
ci_069                -4.887897e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.338897
====================================================
  Execution time = 1.7468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1260e-01
  Total weights = 1.956452779e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299146045150
                                         uncertainty =       0.002044015390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299146045150
                                         uncertainty =       0.002044015390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386716281
  error estimate for blocks of size 2^( 2) =       0.000396467319
  error estimate for blocks of size 2^( 3) =       0.000405463667
  error estimate for blocks of size 2^( 4) =       0.000411915037
  error estimate for blocks of size 2^( 5) =       0.000415643301
  error estimate for blocks of size 2^( 6) =       0.000417800299
  error estimate for blocks of size 2^( 7) =       0.000418282998

      target function =                  N/A
              le_mean =     -17.216316819133
             les_mean =     296.714161753235
             stat err =       0.000415910409
             autocorr =       1.156683836191
              std dev =       0.546899408905
             le_variance =       0.299098963460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631681913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316819163       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216318341121       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319686341       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216319878603       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216319810258       residual = 9.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.226549e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316819163       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317795630       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216318104775       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216318089405       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 7.500664e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216316819163       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317220397       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216317106564       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317094418       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-01 is 2.940948e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9979e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.033168e-02 3 1  ON 0
ci_002                -2.977481e-02 3 1  ON 1
ci_003                -2.530100e-02 3 1  ON 2
ci_004                 2.044283e-02 3 1  ON 3
ci_005                 2.154864e-02 3 1  ON 4
ci_006                -1.869189e-02 3 1  ON 5
ci_007                -1.892864e-02 3 1  ON 6
ci_008                -1.762005e-02 3 1  ON 7
ci_009                -1.790740e-02 3 1  ON 8
ci_010                -1.769439e-02 3 1  ON 9
ci_011                -1.608738e-02 3 1  ON 10
ci_012                -1.613423e-02 3 1  ON 11
ci_013                -1.906155e-02 3 1  ON 12
ci_014                 1.338325e-02 3 1  ON 13
ci_015                 1.388234e-02 3 1  ON 14
ci_016                 1.662185e-02 3 1  ON 15
ci_017                 1.674176e-02 3 1  ON 16
ci_018                 1.262877e-02 3 1  ON 17
ci_019                 1.310064e-02 3 1  ON 18
ci_020                 1.278328e-02 3 1  ON 19
ci_021                 1.275619e-02 3 1  ON 20
ci_022                 1.182923e-02 3 1  ON 21
ci_023                 1.172346e-02 3 1  ON 22
ci_024                 1.176633e-02 3 1  ON 23
ci_025                 1.165638e-02 3 1  ON 24
ci_026                 1.116115e-02 3 1  ON 25
ci_027                 1.097784e-02 3 1  ON 26
ci_028                -1.358048e-02 3 1  ON 27
ci_029                -1.405686e-02 3 1  ON 28
ci_030                -1.107829e-02 3 1  ON 29
ci_031                -1.097381e-02 3 1  ON 30
ci_032                -1.342298e-02 3 1  ON 31
ci_033                 1.038627e-02 3 1  ON 32
ci_034                 9.883791e-03 3 1  ON 33
ci_035                -4.509580e-03 3 1  ON 34
ci_036                -1.040973e-02 3 1  ON 35
ci_037                -1.021450e-02 3 1  ON 36
ci_038                 1.689625e-03 3 1  ON 37
ci_039                 1.846264e-03 3 1  ON 38
ci_040                -4.194065e-03 3 1  ON 39
ci_041                 9.854045e-03 3 1  ON 40
ci_042                 9.504100e-03 3 1  ON 41
ci_043                -2.917995e-03 3 1  ON 42
ci_044                -1.533005e-02 3 1  ON 43
ci_045                -1.736975e-03 3 1  ON 44
ci_046                 5.342058e-03 3 1  ON 45
ci_047                 5.471354e-03 3 1  ON 46
ci_048                -1.157531e-02 3 1  ON 47
ci_049                -1.175149e-02 3 1  ON 48
ci_050                 7.572662e-03 3 1  ON 49
ci_051                 7.724365e-03 3 1  ON 50
ci_052                -6.131878e-03 3 1  ON 51
ci_053                -6.786285e-03 3 1  ON 52
ci_054                -2.708447e-03 3 1  ON 53
ci_055                -3.207980e-03 3 1  ON 54
ci_056                 4.810037e-03 3 1  ON 55
ci_057                 4.558936e-03 3 1  ON 56
ci_058                -6.331444e-03 3 1  ON 57
ci_059                -6.507051e-03 3 1  ON 58
ci_060                 8.027212e-03 3 1  ON 59
ci_061                 9.092798e-03 3 1  ON 60
ci_062                -3.382401e-03 3 1  ON 61
ci_063                -3.047634e-03 3 1  ON 62
ci_064                -3.003649e-03 3 1  ON 63
ci_065                -4.190525e-03 3 1  ON 64
ci_066                 5.819697e-03 3 1  ON 65
ci_067                 5.539728e-03 3 1  ON 66
ci_068                -5.144035e-03 3 1  ON 67
ci_069                -4.879190e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.238684
====================================================
  Execution time = 1.3425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1573e-01
  Total weights = 1.9565e+06
  Execution time = 1.8521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952540892
                                         uncertainty =       0.002069466371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298952540892
                                         uncertainty =       0.002069466371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386613218
  error estimate for blocks of size 2^( 2) =       0.000396191976
  error estimate for blocks of size 2^( 3) =       0.000405074049
  error estimate for blocks of size 2^( 4) =       0.000412496907
  error estimate for blocks of size 2^( 5) =       0.000416398052
  error estimate for blocks of size 2^( 6) =       0.000418657060
  error estimate for blocks of size 2^( 7) =       0.000418846808

      target function =                  N/A
              le_mean =     -17.216097117984
             les_mean =     296.884969009266
             stat err =       0.000416599707
             autocorr =       1.161139831721
              std dev =       0.546753656589
             le_variance =       0.298939560993

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298832220227
                                         uncertainty =       0.001899634195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298832220227
                                         uncertainty =       0.001899634195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386532609
  error estimate for blocks of size 2^( 2) =       0.000396141822
  error estimate for blocks of size 2^( 3) =       0.000405016135
  error estimate for blocks of size 2^( 4) =       0.000412424163
  error estimate for blocks of size 2^( 5) =       0.000416309038
  error estimate for blocks of size 2^( 6) =       0.000418523713
  error estimate for blocks of size 2^( 7) =       0.000418710707

      target function =                  N/A
              le_mean =     -17.216123401935
             les_mean =     296.829867074000
             stat err =       0.000416491905
             autocorr =       1.161023082816
              std dev =       0.546639657959
             le_variance =       0.298814915653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298591302221
                                         uncertainty =       0.001884944701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298591302221
                                         uncertainty =       0.001884944701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386377804
  error estimate for blocks of size 2^( 2) =       0.000395987963
  error estimate for blocks of size 2^( 3) =       0.000404873371
  error estimate for blocks of size 2^( 4) =       0.000412313255
  error estimate for blocks of size 2^( 5) =       0.000416198967
  error estimate for blocks of size 2^( 6) =       0.000418462555
  error estimate for blocks of size 2^( 7) =       0.000418674436

      target function =                  N/A
              le_mean =     -17.216120808415
             les_mean =     296.711660194422
             stat err =       0.000416412303
             autocorr =       1.161509497844
              std dev =       0.546420730681
             le_variance =       0.298575614918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298378527906
                                         uncertainty =       0.001903682224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298378527906
                                         uncertainty =       0.001903682224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240804
  error estimate for blocks of size 2^( 2) =       0.000395838020
  error estimate for blocks of size 2^( 3) =       0.000404725914
  error estimate for blocks of size 2^( 4) =       0.000412167207
  error estimate for blocks of size 2^( 5) =       0.000416074846
  error estimate for blocks of size 2^( 6) =       0.000418325572
  error estimate for blocks of size 2^( 7) =       0.000418527659

      target function =                  N/A
              le_mean =     -17.216102374776
             les_mean =     296.718390953071
             stat err =       0.000416273821
             autocorr =       1.161560656966
              std dev =       0.546226983421
             le_variance =       0.298363917417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216097117984        initial
     5.9605e-02     5.9605e-01             1.2265e-03       -17.216123401935  <--
     2.3842e-01     2.3842e+00             7.5007e-04       -17.216120808415
     9.5367e-01     9.5367e+00             2.9409e-04       -17.216102374776

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.2741e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.054804e-02 3 1  ON 0
ci_002                -2.980683e-02 3 1  ON 1
ci_003                -2.579346e-02 3 1  ON 2
ci_004                 1.991448e-02 3 1  ON 3
ci_005                 2.143300e-02 3 1  ON 4
ci_006                -1.904712e-02 3 1  ON 5
ci_007                -1.895245e-02 3 1  ON 6
ci_008                -1.768856e-02 3 1  ON 7
ci_009                -1.791360e-02 3 1  ON 8
ci_010                -1.785436e-02 3 1  ON 9
ci_011                -1.616521e-02 3 1  ON 10
ci_012                -1.614535e-02 3 1  ON 11
ci_013                -1.881341e-02 3 1  ON 12
ci_014                 1.336246e-02 3 1  ON 13
ci_015                 1.401451e-02 3 1  ON 14
ci_016                 1.640027e-02 3 1  ON 15
ci_017                 1.695541e-02 3 1  ON 16
ci_018                 1.261152e-02 3 1  ON 17
ci_019                 1.312427e-02 3 1  ON 18
ci_020                 1.290326e-02 3 1  ON 19
ci_021                 1.274586e-02 3 1  ON 20
ci_022                 1.204364e-02 3 1  ON 21
ci_023                 1.186820e-02 3 1  ON 22
ci_024                 1.149512e-02 3 1  ON 23
ci_025                 1.181467e-02 3 1  ON 24
ci_026                 1.096623e-02 3 1  ON 25
ci_027                 1.118492e-02 3 1  ON 26
ci_028                -1.363249e-02 3 1  ON 27
ci_029                -1.385841e-02 3 1  ON 28
ci_030                -1.100465e-02 3 1  ON 29
ci_031                -1.080280e-02 3 1  ON 30
ci_032                -1.331180e-02 3 1  ON 31
ci_033                 1.021772e-02 3 1  ON 32
ci_034                 9.407308e-03 3 1  ON 33
ci_035                -4.369100e-03 3 1  ON 34
ci_036                -1.017937e-02 3 1  ON 35
ci_037                -1.045772e-02 3 1  ON 36
ci_038                 1.679517e-03 3 1  ON 37
ci_039                 1.959761e-03 3 1  ON 38
ci_040                -4.316647e-03 3 1  ON 39
ci_041                 9.798725e-03 3 1  ON 40
ci_042                 9.390914e-03 3 1  ON 41
ci_043                -2.968270e-03 3 1  ON 42
ci_044                -1.582000e-02 3 1  ON 43
ci_045                -1.677434e-03 3 1  ON 44
ci_046                 5.207665e-03 3 1  ON 45
ci_047                 5.389571e-03 3 1  ON 46
ci_048                -1.134949e-02 3 1  ON 47
ci_049                -1.189034e-02 3 1  ON 48
ci_050                 7.633712e-03 3 1  ON 49
ci_051                 7.787237e-03 3 1  ON 50
ci_052                -5.896361e-03 3 1  ON 51
ci_053                -6.719310e-03 3 1  ON 52
ci_054                -2.728930e-03 3 1  ON 53
ci_055                -3.059181e-03 3 1  ON 54
ci_056                 4.872453e-03 3 1  ON 55
ci_057                 4.445877e-03 3 1  ON 56
ci_058                -6.075752e-03 3 1  ON 57
ci_059                -6.353068e-03 3 1  ON 58
ci_060                 7.995375e-03 3 1  ON 59
ci_061                 9.205609e-03 3 1  ON 60
ci_062                -3.280918e-03 3 1  ON 61
ci_063                -2.997802e-03 3 1  ON 62
ci_064                -3.007928e-03 3 1  ON 63
ci_065                -4.178290e-03 3 1  ON 64
ci_066                 6.101634e-03 3 1  ON 65
ci_067                 5.305292e-03 3 1  ON 66
ci_068                -4.982255e-03 3 1  ON 67
ci_069                -4.864952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2428
    reference variance = 0.174316
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1618e-01
  Total weights = 1.956621296e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302671811621
                                         uncertainty =       0.002297716816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302671811621
                                         uncertainty =       0.002297716816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388998859
  error estimate for blocks of size 2^( 2) =       0.000399106569
  error estimate for blocks of size 2^( 3) =       0.000408342785
  error estimate for blocks of size 2^( 4) =       0.000415032609
  error estimate for blocks of size 2^( 5) =       0.000419478026
  error estimate for blocks of size 2^( 6) =       0.000421194724
  error estimate for blocks of size 2^( 7) =       0.000422438469

      target function =                  N/A
              le_mean =     -17.217007687697
             les_mean =     296.741532255154
             stat err =       0.000419535957
             autocorr =       1.163166061079
              std dev =       0.550127462661
             le_variance =       0.302640225174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700768770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007687802       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217003172712       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217005221986       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217005212135       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217005234761       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 1.655732e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007687802       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217003817926       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217005335570       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217005310858       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217005326815       residual = 1.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.342378e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217007687802       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217005225433       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217005833755       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217005803085       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 7.639276e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6373e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.033172e-02 3 1  ON 0
ci_002                -2.943426e-02 3 1  ON 1
ci_003                -2.452073e-02 3 1  ON 2
ci_004                 2.058133e-02 3 1  ON 3
ci_005                 2.009062e-02 3 1  ON 4
ci_006                -1.917975e-02 3 1  ON 5
ci_007                -1.854286e-02 3 1  ON 6
ci_008                -1.794480e-02 3 1  ON 7
ci_009                -1.778932e-02 3 1  ON 8
ci_010                -1.836980e-02 3 1  ON 9
ci_011                -1.648460e-02 3 1  ON 10
ci_012                -1.677059e-02 3 1  ON 11
ci_013                -1.880825e-02 3 1  ON 12
ci_014                 1.387638e-02 3 1  ON 13
ci_015                 1.403376e-02 3 1  ON 14
ci_016                 1.620435e-02 3 1  ON 15
ci_017                 1.596829e-02 3 1  ON 16
ci_018                 1.251347e-02 3 1  ON 17
ci_019                 1.294492e-02 3 1  ON 18
ci_020                 1.278946e-02 3 1  ON 19
ci_021                 1.202143e-02 3 1  ON 20
ci_022                 1.193595e-02 3 1  ON 21
ci_023                 1.160651e-02 3 1  ON 22
ci_024                 1.126476e-02 3 1  ON 23
ci_025                 1.180795e-02 3 1  ON 24
ci_026                 1.137617e-02 3 1  ON 25
ci_027                 1.103024e-02 3 1  ON 26
ci_028                -1.398328e-02 3 1  ON 27
ci_029                -1.505857e-02 3 1  ON 28
ci_030                -1.090503e-02 3 1  ON 29
ci_031                -1.098625e-02 3 1  ON 30
ci_032                -1.305615e-02 3 1  ON 31
ci_033                 1.031534e-02 3 1  ON 32
ci_034                 1.054187e-02 3 1  ON 33
ci_035                -4.589483e-03 3 1  ON 34
ci_036                -9.618013e-03 3 1  ON 35
ci_037                -1.035033e-02 3 1  ON 36
ci_038                 1.685068e-03 3 1  ON 37
ci_039                 1.509467e-03 3 1  ON 38
ci_040                -3.946444e-03 3 1  ON 39
ci_041                 9.783756e-03 3 1  ON 40
ci_042                 9.366515e-03 3 1  ON 41
ci_043                -2.946800e-03 3 1  ON 42
ci_044                -1.579648e-02 3 1  ON 43
ci_045                -2.016399e-03 3 1  ON 44
ci_046                 5.084316e-03 3 1  ON 45
ci_047                 5.652208e-03 3 1  ON 46
ci_048                -1.059798e-02 3 1  ON 47
ci_049                -1.121540e-02 3 1  ON 48
ci_050                 7.114251e-03 3 1  ON 49
ci_051                 7.920788e-03 3 1  ON 50
ci_052                -6.663061e-03 3 1  ON 51
ci_053                -6.312964e-03 3 1  ON 52
ci_054                -2.433444e-03 3 1  ON 53
ci_055                -2.987897e-03 3 1  ON 54
ci_056                 4.744765e-03 3 1  ON 55
ci_057                 4.664078e-03 3 1  ON 56
ci_058                -6.935954e-03 3 1  ON 57
ci_059                -6.644883e-03 3 1  ON 58
ci_060                 8.032829e-03 3 1  ON 59
ci_061                 9.015852e-03 3 1  ON 60
ci_062                -3.134875e-03 3 1  ON 61
ci_063                -2.590515e-03 3 1  ON 62
ci_064                -3.269970e-03 3 1  ON 63
ci_065                -4.357571e-03 3 1  ON 64
ci_066                 5.690645e-03 3 1  ON 65
ci_067                 5.987444e-03 3 1  ON 66
ci_068                -4.635790e-03 3 1  ON 67
ci_069                -4.184635e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2554
    reference variance = 0.359508
====================================================
  Execution time = 1.4748e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1252e-01
  Total weights = 1.9565e+06
  Execution time = 1.8450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298042938489
                                         uncertainty =       0.001794685665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298042938489
                                         uncertainty =       0.001794685665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386027709
  error estimate for blocks of size 2^( 2) =       0.000396003801
  error estimate for blocks of size 2^( 3) =       0.000404786775
  error estimate for blocks of size 2^( 4) =       0.000411491275
  error estimate for blocks of size 2^( 5) =       0.000414277224
  error estimate for blocks of size 2^( 6) =       0.000416066316
  error estimate for blocks of size 2^( 7) =       0.000415129813

      target function =                  N/A
              le_mean =     -17.216201122293
             les_mean =     296.720973617720
             stat err =       0.000414241157
             autocorr =       1.151514821782
              std dev =       0.545925622194
             le_variance =       0.298034784968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298445573480
                                         uncertainty =       0.001783353776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298445573480
                                         uncertainty =       0.001783353776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386286732
  error estimate for blocks of size 2^( 2) =       0.000396245052
  error estimate for blocks of size 2^( 3) =       0.000405000755
  error estimate for blocks of size 2^( 4) =       0.000411673292
  error estimate for blocks of size 2^( 5) =       0.000414439966
  error estimate for blocks of size 2^( 6) =       0.000416253164
  error estimate for blocks of size 2^( 7) =       0.000415277675

      target function =                  N/A
              le_mean =     -17.216179722008
             les_mean =     296.711260372371
             stat err =       0.000414411024
             autocorr =       1.150914378313
              std dev =       0.546291935950
             le_variance =       0.298434879284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594612778
                                         uncertainty =       0.001792646197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594612778
                                         uncertainty =       0.001792646197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387028193
  error estimate for blocks of size 2^( 2) =       0.000396975247
  error estimate for blocks of size 2^( 3) =       0.000405726756
  error estimate for blocks of size 2^( 4) =       0.000412394546
  error estimate for blocks of size 2^( 5) =       0.000415155293
  error estimate for blocks of size 2^( 6) =       0.000416979258
  error estimate for blocks of size 2^( 7) =       0.000415998176

      target function =                  N/A
              le_mean =     -17.216230378414
             les_mean =     296.730924773013
             stat err =       0.000415131818
             autocorr =       1.150500569824
              std dev =       0.547340520130
             le_variance =       0.299581644976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298083849397
                                         uncertainty =       0.001785171616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298083849397
                                         uncertainty =       0.001785171616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386053297
  error estimate for blocks of size 2^( 2) =       0.000396020106
  error estimate for blocks of size 2^( 3) =       0.000404784398
  error estimate for blocks of size 2^( 4) =       0.000411461983
  error estimate for blocks of size 2^( 5) =       0.000414231994
  error estimate for blocks of size 2^( 6) =       0.000416035982
  error estimate for blocks of size 2^( 7) =       0.000415081107

      target function =                  N/A
              le_mean =     -17.216179748050
             les_mean =     296.709797054969
             stat err =       0.000414202767
             autocorr =       1.151148783990
              std dev =       0.545961808392
             le_variance =       0.298074296223


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216201122293        initial
     1.4901e-02     1.4901e-01             1.6557e-03       -17.216179722008
     5.9605e-02     5.9605e-01             1.3424e-03       -17.216230378414  <--
     2.3842e-01     2.3842e+00             7.6393e-04       -17.216179748050

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.4052e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.033172e-02 3 1  ON 0
ci_002                -2.943426e-02 3 1  ON 1
ci_003                -2.452073e-02 3 1  ON 2
ci_004                 2.058133e-02 3 1  ON 3
ci_005                 2.009062e-02 3 1  ON 4
ci_006                -1.917975e-02 3 1  ON 5
ci_007                -1.854286e-02 3 1  ON 6
ci_008                -1.794480e-02 3 1  ON 7
ci_009                -1.778932e-02 3 1  ON 8
ci_010                -1.836980e-02 3 1  ON 9
ci_011                -1.648460e-02 3 1  ON 10
ci_012                -1.677059e-02 3 1  ON 11
ci_013                -1.880825e-02 3 1  ON 12
ci_014                 1.387638e-02 3 1  ON 13
ci_015                 1.403376e-02 3 1  ON 14
ci_016                 1.620435e-02 3 1  ON 15
ci_017                 1.596829e-02 3 1  ON 16
ci_018                 1.251347e-02 3 1  ON 17
ci_019                 1.294492e-02 3 1  ON 18
ci_020                 1.278946e-02 3 1  ON 19
ci_021                 1.202143e-02 3 1  ON 20
ci_022                 1.193595e-02 3 1  ON 21
ci_023                 1.160651e-02 3 1  ON 22
ci_024                 1.126476e-02 3 1  ON 23
ci_025                 1.180795e-02 3 1  ON 24
ci_026                 1.137617e-02 3 1  ON 25
ci_027                 1.103024e-02 3 1  ON 26
ci_028                -1.398328e-02 3 1  ON 27
ci_029                -1.505857e-02 3 1  ON 28
ci_030                -1.090503e-02 3 1  ON 29
ci_031                -1.098625e-02 3 1  ON 30
ci_032                -1.305615e-02 3 1  ON 31
ci_033                 1.031534e-02 3 1  ON 32
ci_034                 1.054187e-02 3 1  ON 33
ci_035                -4.589483e-03 3 1  ON 34
ci_036                -9.618013e-03 3 1  ON 35
ci_037                -1.035033e-02 3 1  ON 36
ci_038                 1.685068e-03 3 1  ON 37
ci_039                 1.509467e-03 3 1  ON 38
ci_040                -3.946444e-03 3 1  ON 39
ci_041                 9.783756e-03 3 1  ON 40
ci_042                 9.366515e-03 3 1  ON 41
ci_043                -2.946800e-03 3 1  ON 42
ci_044                -1.579648e-02 3 1  ON 43
ci_045                -2.016399e-03 3 1  ON 44
ci_046                 5.084316e-03 3 1  ON 45
ci_047                 5.652208e-03 3 1  ON 46
ci_048                -1.059798e-02 3 1  ON 47
ci_049                -1.121540e-02 3 1  ON 48
ci_050                 7.114251e-03 3 1  ON 49
ci_051                 7.920788e-03 3 1  ON 50
ci_052                -6.663061e-03 3 1  ON 51
ci_053                -6.312964e-03 3 1  ON 52
ci_054                -2.433444e-03 3 1  ON 53
ci_055                -2.987897e-03 3 1  ON 54
ci_056                 4.744765e-03 3 1  ON 55
ci_057                 4.664078e-03 3 1  ON 56
ci_058                -6.935954e-03 3 1  ON 57
ci_059                -6.644883e-03 3 1  ON 58
ci_060                 8.032829e-03 3 1  ON 59
ci_061                 9.015852e-03 3 1  ON 60
ci_062                -3.134875e-03 3 1  ON 61
ci_063                -2.590515e-03 3 1  ON 62
ci_064                -3.269970e-03 3 1  ON 63
ci_065                -4.357571e-03 3 1  ON 64
ci_066                 5.690645e-03 3 1  ON 65
ci_067                 5.987444e-03 3 1  ON 66
ci_068                -4.635790e-03 3 1  ON 67
ci_069                -4.184635e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1997
    reference variance = 0.395602
====================================================
  Execution time = 1.5267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1559e-01
  Total weights = 1.956659963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300560567412
                                         uncertainty =       0.002226114949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300560567412
                                         uncertainty =       0.002226114949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387640109
  error estimate for blocks of size 2^( 2) =       0.000397465080
  error estimate for blocks of size 2^( 3) =       0.000407297341
  error estimate for blocks of size 2^( 4) =       0.000413818042
  error estimate for blocks of size 2^( 5) =       0.000418389867
  error estimate for blocks of size 2^( 6) =       0.000419721092
  error estimate for blocks of size 2^( 7) =       0.000421423780

      target function =                  N/A
              le_mean =     -17.216992552612
             les_mean =     296.740427080313
             stat err =       0.000418338195
             autocorr =       1.164655879397
              std dev =       0.548205899071
             le_variance =       0.300529707776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699255261e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992552685       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217023145400       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217018469390       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217019387421       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217019183465       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 1.853983e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992552685       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217018507420       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217014926911       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217015513668       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217015424144       residual = 9.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.454291e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992552685       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217008709575       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217007143329       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217007341037       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 8.252893e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7789e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.887743e-02 3 1  ON 0
ci_002                -2.903283e-02 3 1  ON 1
ci_003                -2.563865e-02 3 1  ON 2
ci_004                 1.985435e-02 3 1  ON 3
ci_005                 2.014947e-02 3 1  ON 4
ci_006                -1.923695e-02 3 1  ON 5
ci_007                -1.892718e-02 3 1  ON 6
ci_008                -1.808943e-02 3 1  ON 7
ci_009                -1.687397e-02 3 1  ON 8
ci_010                -1.759168e-02 3 1  ON 9
ci_011                -1.734639e-02 3 1  ON 10
ci_012                -1.674692e-02 3 1  ON 11
ci_013                -1.871408e-02 3 1  ON 12
ci_014                 1.406541e-02 3 1  ON 13
ci_015                 1.426911e-02 3 1  ON 14
ci_016                 1.527591e-02 3 1  ON 15
ci_017                 1.656660e-02 3 1  ON 16
ci_018                 1.327021e-02 3 1  ON 17
ci_019                 1.277960e-02 3 1  ON 18
ci_020                 1.351645e-02 3 1  ON 19
ci_021                 1.262713e-02 3 1  ON 20
ci_022                 1.187474e-02 3 1  ON 21
ci_023                 1.084848e-02 3 1  ON 22
ci_024                 1.271383e-02 3 1  ON 23
ci_025                 1.145583e-02 3 1  ON 24
ci_026                 1.100117e-02 3 1  ON 25
ci_027                 1.089430e-02 3 1  ON 26
ci_028                -1.476441e-02 3 1  ON 27
ci_029                -1.468277e-02 3 1  ON 28
ci_030                -1.101437e-02 3 1  ON 29
ci_031                -1.109814e-02 3 1  ON 30
ci_032                -1.355423e-02 3 1  ON 31
ci_033                 1.033018e-02 3 1  ON 32
ci_034                 1.011165e-02 3 1  ON 33
ci_035                -4.644915e-03 3 1  ON 34
ci_036                -9.814153e-03 3 1  ON 35
ci_037                -9.840845e-03 3 1  ON 36
ci_038                 1.749360e-03 3 1  ON 37
ci_039                 1.796233e-03 3 1  ON 38
ci_040                -4.055486e-03 3 1  ON 39
ci_041                 9.701180e-03 3 1  ON 40
ci_042                 9.707423e-03 3 1  ON 41
ci_043                -3.465669e-03 3 1  ON 42
ci_044                -1.531638e-02 3 1  ON 43
ci_045                -1.581025e-03 3 1  ON 44
ci_046                 5.537929e-03 3 1  ON 45
ci_047                 5.333401e-03 3 1  ON 46
ci_048                -1.142954e-02 3 1  ON 47
ci_049                -1.261823e-02 3 1  ON 48
ci_050                 7.644614e-03 3 1  ON 49
ci_051                 7.878008e-03 3 1  ON 50
ci_052                -7.126833e-03 3 1  ON 51
ci_053                -6.581360e-03 3 1  ON 52
ci_054                -2.743295e-03 3 1  ON 53
ci_055                -2.932483e-03 3 1  ON 54
ci_056                 4.139029e-03 3 1  ON 55
ci_057                 4.356792e-03 3 1  ON 56
ci_058                -6.482247e-03 3 1  ON 57
ci_059                -7.112332e-03 3 1  ON 58
ci_060                 8.168917e-03 3 1  ON 59
ci_061                 9.342170e-03 3 1  ON 60
ci_062                -3.262470e-03 3 1  ON 61
ci_063                -2.585551e-03 3 1  ON 62
ci_064                -3.238954e-03 3 1  ON 63
ci_065                -4.210133e-03 3 1  ON 64
ci_066                 5.587020e-03 3 1  ON 65
ci_067                 5.213724e-03 3 1  ON 66
ci_068                -4.041126e-03 3 1  ON 67
ci_069                -5.014119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.217187
====================================================
  Execution time = 1.3526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2089e-01
  Total weights = 1.9569e+06
  Execution time = 1.8456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302795934892
                                         uncertainty =       0.002627120040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302795934892
                                         uncertainty =       0.002627120040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389079787
  error estimate for blocks of size 2^( 2) =       0.000399147347
  error estimate for blocks of size 2^( 3) =       0.000408301938
  error estimate for blocks of size 2^( 4) =       0.000414464337
  error estimate for blocks of size 2^( 5) =       0.000418876369
  error estimate for blocks of size 2^( 6) =       0.000420449628
  error estimate for blocks of size 2^( 7) =       0.000419243455

      target function =                  N/A
              le_mean =     -17.216681013606
             les_mean =     296.735455646422
             stat err =       0.000418258447
             autocorr =       1.155612160684
              std dev =       0.550241911309
             le_variance =       0.302766160961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305113365013
                                         uncertainty =       0.003649141068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305113365013
                                         uncertainty =       0.003649141068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390563157
  error estimate for blocks of size 2^( 2) =       0.000400594955
  error estimate for blocks of size 2^( 3) =       0.000409660671
  error estimate for blocks of size 2^( 4) =       0.000415741932
  error estimate for blocks of size 2^( 5) =       0.000420238759
  error estimate for blocks of size 2^( 6) =       0.000421715707
  error estimate for blocks of size 2^( 7) =       0.000420345470

      target function =                  N/A
              le_mean =     -17.216626693540
             les_mean =     296.745712142712
             stat err =       0.000419510467
             autocorr =       1.153727001727
              std dev =       0.552339713777
             le_variance =       0.305079159415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304021005053
                                         uncertainty =       0.002619319037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304021005053
                                         uncertainty =       0.002619319037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389864081
  error estimate for blocks of size 2^( 2) =       0.000399905114
  error estimate for blocks of size 2^( 3) =       0.000408989138
  error estimate for blocks of size 2^( 4) =       0.000415099696
  error estimate for blocks of size 2^( 5) =       0.000419512582
  error estimate for blocks of size 2^( 6) =       0.000421039659
  error estimate for blocks of size 2^( 7) =       0.000419619278

      target function =                  N/A
              le_mean =     -17.216741945538
             les_mean =     296.752579892791
             stat err =       0.000418817804
             autocorr =       1.154047863921
              std dev =       0.551351070554
             le_variance =       0.303988003001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302832134179
                                         uncertainty =       0.002627033738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302832134179
                                         uncertainty =       0.002627033738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389102575
  error estimate for blocks of size 2^( 2) =       0.000399163979
  error estimate for blocks of size 2^( 3) =       0.000408293235
  error estimate for blocks of size 2^( 4) =       0.000414435299
  error estimate for blocks of size 2^( 5) =       0.000418859200
  error estimate for blocks of size 2^( 6) =       0.000420400965
  error estimate for blocks of size 2^( 7) =       0.000419135816

      target function =                  N/A
              le_mean =     -17.216648458697
             les_mean =     296.733612588876
             stat err =       0.000418207820
             autocorr =       1.155197100462
              std dev =       0.550274138423
             le_variance =       0.302801627417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216681013606        initial
     1.4901e-02     1.4901e-01             1.8540e-03       -17.216626693540
     5.9605e-02     5.9605e-01             1.4543e-03       -17.216741945538  <--
     2.3842e-01     2.3842e+00             8.2529e-04       -17.216648458697

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.2815e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -3.887743e-02 3 1  ON 0
ci_002                -2.903283e-02 3 1  ON 1
ci_003                -2.563865e-02 3 1  ON 2
ci_004                 1.985435e-02 3 1  ON 3
ci_005                 2.014947e-02 3 1  ON 4
ci_006                -1.923695e-02 3 1  ON 5
ci_007                -1.892718e-02 3 1  ON 6
ci_008                -1.808943e-02 3 1  ON 7
ci_009                -1.687397e-02 3 1  ON 8
ci_010                -1.759168e-02 3 1  ON 9
ci_011                -1.734639e-02 3 1  ON 10
ci_012                -1.674692e-02 3 1  ON 11
ci_013                -1.871408e-02 3 1  ON 12
ci_014                 1.406541e-02 3 1  ON 13
ci_015                 1.426911e-02 3 1  ON 14
ci_016                 1.527591e-02 3 1  ON 15
ci_017                 1.656660e-02 3 1  ON 16
ci_018                 1.327021e-02 3 1  ON 17
ci_019                 1.277960e-02 3 1  ON 18
ci_020                 1.351645e-02 3 1  ON 19
ci_021                 1.262713e-02 3 1  ON 20
ci_022                 1.187474e-02 3 1  ON 21
ci_023                 1.084848e-02 3 1  ON 22
ci_024                 1.271383e-02 3 1  ON 23
ci_025                 1.145583e-02 3 1  ON 24
ci_026                 1.100117e-02 3 1  ON 25
ci_027                 1.089430e-02 3 1  ON 26
ci_028                -1.476441e-02 3 1  ON 27
ci_029                -1.468277e-02 3 1  ON 28
ci_030                -1.101437e-02 3 1  ON 29
ci_031                -1.109814e-02 3 1  ON 30
ci_032                -1.355423e-02 3 1  ON 31
ci_033                 1.033018e-02 3 1  ON 32
ci_034                 1.011165e-02 3 1  ON 33
ci_035                -4.644915e-03 3 1  ON 34
ci_036                -9.814153e-03 3 1  ON 35
ci_037                -9.840845e-03 3 1  ON 36
ci_038                 1.749360e-03 3 1  ON 37
ci_039                 1.796233e-03 3 1  ON 38
ci_040                -4.055486e-03 3 1  ON 39
ci_041                 9.701180e-03 3 1  ON 40
ci_042                 9.707423e-03 3 1  ON 41
ci_043                -3.465669e-03 3 1  ON 42
ci_044                -1.531638e-02 3 1  ON 43
ci_045                -1.581025e-03 3 1  ON 44
ci_046                 5.537929e-03 3 1  ON 45
ci_047                 5.333401e-03 3 1  ON 46
ci_048                -1.142954e-02 3 1  ON 47
ci_049                -1.261823e-02 3 1  ON 48
ci_050                 7.644614e-03 3 1  ON 49
ci_051                 7.878008e-03 3 1  ON 50
ci_052                -7.126833e-03 3 1  ON 51
ci_053                -6.581360e-03 3 1  ON 52
ci_054                -2.743295e-03 3 1  ON 53
ci_055                -2.932483e-03 3 1  ON 54
ci_056                 4.139029e-03 3 1  ON 55
ci_057                 4.356792e-03 3 1  ON 56
ci_058                -6.482247e-03 3 1  ON 57
ci_059                -7.112332e-03 3 1  ON 58
ci_060                 8.168917e-03 3 1  ON 59
ci_061                 9.342170e-03 3 1  ON 60
ci_062                -3.262470e-03 3 1  ON 61
ci_063                -2.585551e-03 3 1  ON 62
ci_064                -3.238954e-03 3 1  ON 63
ci_065                -4.210133e-03 3 1  ON 64
ci_066                 5.587020e-03 3 1  ON 65
ci_067                 5.213724e-03 3 1  ON 66
ci_068                -4.041126e-03 3 1  ON 67
ci_069                -5.014119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.194616
====================================================
  Execution time = 1.4294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1316e-01
  Total weights = 1.956445930e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298539523001
                                         uncertainty =       0.001922971898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298539523001
                                         uncertainty =       0.001922971898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386345975
  error estimate for blocks of size 2^( 2) =       0.000396465002
  error estimate for blocks of size 2^( 3) =       0.000405636086
  error estimate for blocks of size 2^( 4) =       0.000412990427
  error estimate for blocks of size 2^( 5) =       0.000417092563
  error estimate for blocks of size 2^( 6) =       0.000419705830
  error estimate for blocks of size 2^( 7) =       0.000420530300

      target function =                  N/A
              le_mean =     -17.216751621819
             les_mean =     296.729698826510
             stat err =       0.000417579780
             autocorr =       1.168224036884
              std dev =       0.546375717921
             le_variance =       0.298526425134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675162182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751621862       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216779600058       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216779632968       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216780367967       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216781047502       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 2.207263e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751621862       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775401007       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775161291       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216775528796       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216775878551       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.810742e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216751621862       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216766480722       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216766057111       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216766063551       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 1.057303e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6808e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.068817e-02 3 1  ON 0
ci_002                -3.006075e-02 3 1  ON 1
ci_003                -2.546921e-02 3 1  ON 2
ci_004                 2.073471e-02 3 1  ON 3
ci_005                 2.078259e-02 3 1  ON 4
ci_006                -1.922531e-02 3 1  ON 5
ci_007                -1.884560e-02 3 1  ON 6
ci_008                -1.801650e-02 3 1  ON 7
ci_009                -1.674799e-02 3 1  ON 8
ci_010                -1.700721e-02 3 1  ON 9
ci_011                -1.714810e-02 3 1  ON 10
ci_012                -1.713592e-02 3 1  ON 11
ci_013                -1.911349e-02 3 1  ON 12
ci_014                 1.267144e-02 3 1  ON 13
ci_015                 1.375847e-02 3 1  ON 14
ci_016                 1.630384e-02 3 1  ON 15
ci_017                 1.640685e-02 3 1  ON 16
ci_018                 1.286338e-02 3 1  ON 17
ci_019                 1.240923e-02 3 1  ON 18
ci_020                 1.372686e-02 3 1  ON 19
ci_021                 1.310243e-02 3 1  ON 20
ci_022                 1.128294e-02 3 1  ON 21
ci_023                 1.147820e-02 3 1  ON 22
ci_024                 1.127198e-02 3 1  ON 23
ci_025                 1.145847e-02 3 1  ON 24
ci_026                 1.106805e-02 3 1  ON 25
ci_027                 1.126375e-02 3 1  ON 26
ci_028                -1.483451e-02 3 1  ON 27
ci_029                -1.435591e-02 3 1  ON 28
ci_030                -1.102430e-02 3 1  ON 29
ci_031                -1.151353e-02 3 1  ON 30
ci_032                -1.375630e-02 3 1  ON 31
ci_033                 1.032688e-02 3 1  ON 32
ci_034                 1.045922e-02 3 1  ON 33
ci_035                -4.457034e-03 3 1  ON 34
ci_036                -1.053997e-02 3 1  ON 35
ci_037                -9.227496e-03 3 1  ON 36
ci_038                 1.662765e-03 3 1  ON 37
ci_039                 1.689231e-03 3 1  ON 38
ci_040                -3.768995e-03 3 1  ON 39
ci_041                 1.007708e-02 3 1  ON 40
ci_042                 9.151432e-03 3 1  ON 41
ci_043                -3.138478e-03 3 1  ON 42
ci_044                -1.604868e-02 3 1  ON 43
ci_045                -1.837073e-03 3 1  ON 44
ci_046                 5.474630e-03 3 1  ON 45
ci_047                 6.402215e-03 3 1  ON 46
ci_048                -1.222741e-02 3 1  ON 47
ci_049                -1.255304e-02 3 1  ON 48
ci_050                 7.129559e-03 3 1  ON 49
ci_051                 7.454360e-03 3 1  ON 50
ci_052                -6.968448e-03 3 1  ON 51
ci_053                -6.907642e-03 3 1  ON 52
ci_054                -2.957506e-03 3 1  ON 53
ci_055                -2.625214e-03 3 1  ON 54
ci_056                 3.994472e-03 3 1  ON 55
ci_057                 4.633089e-03 3 1  ON 56
ci_058                -6.478899e-03 3 1  ON 57
ci_059                -6.686504e-03 3 1  ON 58
ci_060                 7.848201e-03 3 1  ON 59
ci_061                 9.427560e-03 3 1  ON 60
ci_062                -3.563747e-03 3 1  ON 61
ci_063                -3.165647e-03 3 1  ON 62
ci_064                -2.978234e-03 3 1  ON 63
ci_065                -4.183218e-03 3 1  ON 64
ci_066                 5.193159e-03 3 1  ON 65
ci_067                 5.641243e-03 3 1  ON 66
ci_068                -5.236710e-03 3 1  ON 67
ci_069                -5.205143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.204676
====================================================
  Execution time = 1.3527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2237e-01
  Total weights = 1.9565e+06
  Execution time = 1.8307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299244831340
                                         uncertainty =       0.002197831696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299244831340
                                         uncertainty =       0.002197831696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386761545
  error estimate for blocks of size 2^( 2) =       0.000396544529
  error estimate for blocks of size 2^( 3) =       0.000405531626
  error estimate for blocks of size 2^( 4) =       0.000413044470
  error estimate for blocks of size 2^( 5) =       0.000416693596
  error estimate for blocks of size 2^( 6) =       0.000417724903
  error estimate for blocks of size 2^( 7) =       0.000419680553

      target function =                  N/A
              le_mean =     -17.216055375693
             les_mean =     296.738705635935
             stat err =       0.000416785880
             autocorr =       1.161286619376
              std dev =       0.546963422768
             le_variance =       0.299168985846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297976580828
                                         uncertainty =       0.002155005932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297976580828
                                         uncertainty =       0.002155005932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385940209
  error estimate for blocks of size 2^( 2) =       0.000395746292
  error estimate for blocks of size 2^( 3) =       0.000404784094
  error estimate for blocks of size 2^( 4) =       0.000412317468
  error estimate for blocks of size 2^( 5) =       0.000416003400
  error estimate for blocks of size 2^( 6) =       0.000417143893
  error estimate for blocks of size 2^( 7) =       0.000419218446

      target function =                  N/A
              le_mean =     -17.216048054842
             les_mean =     296.737925793520
             stat err =       0.000416170802
             autocorr =       1.162795007367
              std dev =       0.545801877998
             le_variance =       0.297899690026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297878183245
                                         uncertainty =       0.002135976545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297878183245
                                         uncertainty =       0.002135976545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385875472
  error estimate for blocks of size 2^( 2) =       0.000395711902
  error estimate for blocks of size 2^( 3) =       0.000404783400
  error estimate for blocks of size 2^( 4) =       0.000412278062
  error estimate for blocks of size 2^( 5) =       0.000415987717
  error estimate for blocks of size 2^( 6) =       0.000417226011
  error estimate for blocks of size 2^( 7) =       0.000419295291

      target function =                  N/A
              le_mean =     -17.216103205406
             les_mean =     296.731784181422
             stat err =       0.000416196770
             autocorr =       1.163330364573
              std dev =       0.545710326080
             le_variance =       0.297799759990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298245230858
                                         uncertainty =       0.002173614462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298245230858
                                         uncertainty =       0.002173614462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386114930
  error estimate for blocks of size 2^( 2) =       0.000395916286
  error estimate for blocks of size 2^( 3) =       0.000404944362
  error estimate for blocks of size 2^( 4) =       0.000412466359
  error estimate for blocks of size 2^( 5) =       0.000416126917
  error estimate for blocks of size 2^( 6) =       0.000417236083
  error estimate for blocks of size 2^( 7) =       0.000419298475

      target function =                  N/A
              le_mean =     -17.216040573419
             les_mean =     296.710421458808
             stat err =       0.000416281958
             autocorr =       1.162363567263
              std dev =       0.546048970172
             le_variance =       0.298169477826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216055375693        initial
     1.4901e-02     1.4901e-01             2.2073e-03       -17.216048054842
     5.9605e-02     5.9605e-01             1.8107e-03       -17.216103205406  <--
     2.3842e-01     2.3842e+00             1.0573e-03       -17.216040573419

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 2.2749e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.068817e-02 3 1  ON 0
ci_002                -3.006075e-02 3 1  ON 1
ci_003                -2.546921e-02 3 1  ON 2
ci_004                 2.073471e-02 3 1  ON 3
ci_005                 2.078259e-02 3 1  ON 4
ci_006                -1.922531e-02 3 1  ON 5
ci_007                -1.884560e-02 3 1  ON 6
ci_008                -1.801650e-02 3 1  ON 7
ci_009                -1.674799e-02 3 1  ON 8
ci_010                -1.700721e-02 3 1  ON 9
ci_011                -1.714810e-02 3 1  ON 10
ci_012                -1.713592e-02 3 1  ON 11
ci_013                -1.911349e-02 3 1  ON 12
ci_014                 1.267144e-02 3 1  ON 13
ci_015                 1.375847e-02 3 1  ON 14
ci_016                 1.630384e-02 3 1  ON 15
ci_017                 1.640685e-02 3 1  ON 16
ci_018                 1.286338e-02 3 1  ON 17
ci_019                 1.240923e-02 3 1  ON 18
ci_020                 1.372686e-02 3 1  ON 19
ci_021                 1.310243e-02 3 1  ON 20
ci_022                 1.128294e-02 3 1  ON 21
ci_023                 1.147820e-02 3 1  ON 22
ci_024                 1.127198e-02 3 1  ON 23
ci_025                 1.145847e-02 3 1  ON 24
ci_026                 1.106805e-02 3 1  ON 25
ci_027                 1.126375e-02 3 1  ON 26
ci_028                -1.483451e-02 3 1  ON 27
ci_029                -1.435591e-02 3 1  ON 28
ci_030                -1.102430e-02 3 1  ON 29
ci_031                -1.151353e-02 3 1  ON 30
ci_032                -1.375630e-02 3 1  ON 31
ci_033                 1.032688e-02 3 1  ON 32
ci_034                 1.045922e-02 3 1  ON 33
ci_035                -4.457034e-03 3 1  ON 34
ci_036                -1.053997e-02 3 1  ON 35
ci_037                -9.227496e-03 3 1  ON 36
ci_038                 1.662765e-03 3 1  ON 37
ci_039                 1.689231e-03 3 1  ON 38
ci_040                -3.768995e-03 3 1  ON 39
ci_041                 1.007708e-02 3 1  ON 40
ci_042                 9.151432e-03 3 1  ON 41
ci_043                -3.138478e-03 3 1  ON 42
ci_044                -1.604868e-02 3 1  ON 43
ci_045                -1.837073e-03 3 1  ON 44
ci_046                 5.474630e-03 3 1  ON 45
ci_047                 6.402215e-03 3 1  ON 46
ci_048                -1.222741e-02 3 1  ON 47
ci_049                -1.255304e-02 3 1  ON 48
ci_050                 7.129559e-03 3 1  ON 49
ci_051                 7.454360e-03 3 1  ON 50
ci_052                -6.968448e-03 3 1  ON 51
ci_053                -6.907642e-03 3 1  ON 52
ci_054                -2.957506e-03 3 1  ON 53
ci_055                -2.625214e-03 3 1  ON 54
ci_056                 3.994472e-03 3 1  ON 55
ci_057                 4.633089e-03 3 1  ON 56
ci_058                -6.478899e-03 3 1  ON 57
ci_059                -6.686504e-03 3 1  ON 58
ci_060                 7.848201e-03 3 1  ON 59
ci_061                 9.427560e-03 3 1  ON 60
ci_062                -3.563747e-03 3 1  ON 61
ci_063                -3.165647e-03 3 1  ON 62
ci_064                -2.978234e-03 3 1  ON 63
ci_065                -4.183218e-03 3 1  ON 64
ci_066                 5.193159e-03 3 1  ON 65
ci_067                 5.641243e-03 3 1  ON 66
ci_068                -5.236710e-03 3 1  ON 67
ci_069                -5.205143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.354501
====================================================
  Execution time = 1.4247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1508e-01
  Total weights = 1.956562888e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299519484498
                                         uncertainty =       0.002110158697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299519484498
                                         uncertainty =       0.002110158697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387052417
  error estimate for blocks of size 2^( 2) =       0.000396809823
  error estimate for blocks of size 2^( 3) =       0.000405649691
  error estimate for blocks of size 2^( 4) =       0.000412684968
  error estimate for blocks of size 2^( 5) =       0.000416220663
  error estimate for blocks of size 2^( 6) =       0.000418623985
  error estimate for blocks of size 2^( 7) =       0.000420246067

      target function =                  N/A
              le_mean =     -17.216322294242
             les_mean =     296.716830781561
             stat err =       0.000416943921
             autocorr =       1.160421387042
              std dev =       0.547374777546
             le_variance =       0.299619147093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632229424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322294252       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216366297533       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216368121724       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216367557459       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216367563341       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-02 is 1.773756e-03

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322294252       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216360207635       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216361383458       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216360995024       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216361019570       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-02 is 1.505993e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216322294252       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346697996       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216347073222       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346951092       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-01 is 9.408390e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6773e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.122321e-02 3 1  ON 0
ci_002                -2.958527e-02 3 1  ON 1
ci_003                -2.541267e-02 3 1  ON 2
ci_004                 1.997345e-02 3 1  ON 3
ci_005                 2.112791e-02 3 1  ON 4
ci_006                -1.878975e-02 3 1  ON 5
ci_007                -1.806801e-02 3 1  ON 6
ci_008                -1.778988e-02 3 1  ON 7
ci_009                -1.721514e-02 3 1  ON 8
ci_010                -1.767031e-02 3 1  ON 9
ci_011                -1.564210e-02 3 1  ON 10
ci_012                -1.660427e-02 3 1  ON 11
ci_013                -1.917358e-02 3 1  ON 12
ci_014                 1.319954e-02 3 1  ON 13
ci_015                 1.384661e-02 3 1  ON 14
ci_016                 1.701695e-02 3 1  ON 15
ci_017                 1.628559e-02 3 1  ON 16
ci_018                 1.279656e-02 3 1  ON 17
ci_019                 1.306522e-02 3 1  ON 18
ci_020                 1.259885e-02 3 1  ON 19
ci_021                 1.219858e-02 3 1  ON 20
ci_022                 1.143878e-02 3 1  ON 21
ci_023                 1.134626e-02 3 1  ON 22
ci_024                 1.146129e-02 3 1  ON 23
ci_025                 1.077109e-02 3 1  ON 24
ci_026                 1.103180e-02 3 1  ON 25
ci_027                 1.120762e-02 3 1  ON 26
ci_028                -1.429064e-02 3 1  ON 27
ci_029                -1.441775e-02 3 1  ON 28
ci_030                -1.161927e-02 3 1  ON 29
ci_031                -1.131446e-02 3 1  ON 30
ci_032                -1.412086e-02 3 1  ON 31
ci_033                 1.038134e-02 3 1  ON 32
ci_034                 9.959419e-03 3 1  ON 33
ci_035                -4.829803e-03 3 1  ON 34
ci_036                -1.090418e-02 3 1  ON 35
ci_037                -1.014732e-02 3 1  ON 36
ci_038                 1.659643e-03 3 1  ON 37
ci_039                 1.453414e-03 3 1  ON 38
ci_040                -4.074685e-03 3 1  ON 39
ci_041                 1.001333e-02 3 1  ON 40
ci_042                 1.022658e-02 3 1  ON 41
ci_043                -2.934551e-03 3 1  ON 42
ci_044                -1.538303e-02 3 1  ON 43
ci_045                -1.433620e-03 3 1  ON 44
ci_046                 5.221666e-03 3 1  ON 45
ci_047                 5.434991e-03 3 1  ON 46
ci_048                -1.176061e-02 3 1  ON 47
ci_049                -1.168906e-02 3 1  ON 48
ci_050                 7.942938e-03 3 1  ON 49
ci_051                 8.047660e-03 3 1  ON 50
ci_052                -6.703898e-03 3 1  ON 51
ci_053                -6.259835e-03 3 1  ON 52
ci_054                -3.230992e-03 3 1  ON 53
ci_055                -2.235740e-03 3 1  ON 54
ci_056                 4.850989e-03 3 1  ON 55
ci_057                 4.501363e-03 3 1  ON 56
ci_058                -6.990130e-03 3 1  ON 57
ci_059                -7.184874e-03 3 1  ON 58
ci_060                 8.013125e-03 3 1  ON 59
ci_061                 9.258853e-03 3 1  ON 60
ci_062                -2.957603e-03 3 1  ON 61
ci_063                -3.056668e-03 3 1  ON 62
ci_064                -3.105443e-03 3 1  ON 63
ci_065                -4.236469e-03 3 1  ON 64
ci_066                 5.802446e-03 3 1  ON 65
ci_067                 6.356568e-03 3 1  ON 66
ci_068                -5.287817e-03 3 1  ON 67
ci_069                -4.399116e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.168235
====================================================
  Execution time = 1.4323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2287e-01
  Total weights = 1.9564e+06
  Execution time = 1.8393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306492872988
                                         uncertainty =       0.002877811734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306492872988
                                         uncertainty =       0.002877811734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391420234
  error estimate for blocks of size 2^( 2) =       0.000401219822
  error estimate for blocks of size 2^( 3) =       0.000409684902
  error estimate for blocks of size 2^( 4) =       0.000416029726
  error estimate for blocks of size 2^( 5) =       0.000420762245
  error estimate for blocks of size 2^( 6) =       0.000423072721
  error estimate for blocks of size 2^( 7) =       0.000424528710

      target function =                  N/A
              le_mean =     -17.216101836310
             les_mean =     297.541269639238
             stat err =       0.000421098350
             autocorr =       1.157392158355
              std dev =       0.553551803669
             le_variance =       0.306419599345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305022563236
                                         uncertainty =       0.002697039758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305022563236
                                         uncertainty =       0.002697039758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390482767
  error estimate for blocks of size 2^( 2) =       0.000400271676
  error estimate for blocks of size 2^( 3) =       0.000408754987
  error estimate for blocks of size 2^( 4) =       0.000415081460
  error estimate for blocks of size 2^( 5) =       0.000419810476
  error estimate for blocks of size 2^( 6) =       0.000422008120
  error estimate for blocks of size 2^( 7) =       0.000423440723

      target function =                  N/A
              le_mean =     -17.216034470122
             les_mean =     296.714453279394
             stat err =       0.000420085195
             autocorr =       1.157366766960
              std dev =       0.552226024427
             le_variance =       0.304953582055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306050081092
                                         uncertainty =       0.002779849300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306050081092
                                         uncertainty =       0.002779849300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391140033
  error estimate for blocks of size 2^( 2) =       0.000400909538
  error estimate for blocks of size 2^( 3) =       0.000409386875
  error estimate for blocks of size 2^( 4) =       0.000415709479
  error estimate for blocks of size 2^( 5) =       0.000420421649
  error estimate for blocks of size 2^( 6) =       0.000422608862
  error estimate for blocks of size 2^( 7) =       0.000424012415

      target function =                  N/A
              le_mean =     -17.216071253888
             les_mean =     296.723145159636
             stat err =       0.000420688101
             autocorr =       1.156793717257
              std dev =       0.553155539379
             le_variance =       0.305981050746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304874172568
                                         uncertainty =       0.002664324155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304874172568
                                         uncertainty =       0.002664324155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390387637
  error estimate for blocks of size 2^( 2) =       0.000400188556
  error estimate for blocks of size 2^( 3) =       0.000408675994
  error estimate for blocks of size 2^( 4) =       0.000414997206
  error estimate for blocks of size 2^( 5) =       0.000419734575
  error estimate for blocks of size 2^( 6) =       0.000421956374
  error estimate for blocks of size 2^( 7) =       0.000423396596

      target function =                  N/A
              le_mean =     -17.216042719327
             les_mean =     296.728282653264
             stat err =       0.000420021188
             autocorr =       1.157578057396
              std dev =       0.552091490785
             le_variance =       0.304805014197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216101836310        initial  <--
     1.4901e-02     1.4901e-01             1.7738e-03       -17.216034470122
     5.9605e-02     5.9605e-01             1.5060e-03       -17.216071253888
     2.3842e-01     2.3842e+00             9.4084e-04       -17.216042719327

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5658
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.068817e-02 3 1  ON 0
ci_002                -3.006075e-02 3 1  ON 1
ci_003                -2.546921e-02 3 1  ON 2
ci_004                 2.073471e-02 3 1  ON 3
ci_005                 2.078259e-02 3 1  ON 4
ci_006                -1.922531e-02 3 1  ON 5
ci_007                -1.884560e-02 3 1  ON 6
ci_008                -1.801650e-02 3 1  ON 7
ci_009                -1.674799e-02 3 1  ON 8
ci_010                -1.700721e-02 3 1  ON 9
ci_011                -1.714810e-02 3 1  ON 10
ci_012                -1.713592e-02 3 1  ON 11
ci_013                -1.911349e-02 3 1  ON 12
ci_014                 1.267144e-02 3 1  ON 13
ci_015                 1.375847e-02 3 1  ON 14
ci_016                 1.630384e-02 3 1  ON 15
ci_017                 1.640685e-02 3 1  ON 16
ci_018                 1.286338e-02 3 1  ON 17
ci_019                 1.240923e-02 3 1  ON 18
ci_020                 1.372686e-02 3 1  ON 19
ci_021                 1.310243e-02 3 1  ON 20
ci_022                 1.128294e-02 3 1  ON 21
ci_023                 1.147820e-02 3 1  ON 22
ci_024                 1.127198e-02 3 1  ON 23
ci_025                 1.145847e-02 3 1  ON 24
ci_026                 1.106805e-02 3 1  ON 25
ci_027                 1.126375e-02 3 1  ON 26
ci_028                -1.483451e-02 3 1  ON 27
ci_029                -1.435591e-02 3 1  ON 28
ci_030                -1.102430e-02 3 1  ON 29
ci_031                -1.151353e-02 3 1  ON 30
ci_032                -1.375630e-02 3 1  ON 31
ci_033                 1.032688e-02 3 1  ON 32
ci_034                 1.045922e-02 3 1  ON 33
ci_035                -4.457034e-03 3 1  ON 34
ci_036                -1.053997e-02 3 1  ON 35
ci_037                -9.227496e-03 3 1  ON 36
ci_038                 1.662765e-03 3 1  ON 37
ci_039                 1.689231e-03 3 1  ON 38
ci_040                -3.768995e-03 3 1  ON 39
ci_041                 1.007708e-02 3 1  ON 40
ci_042                 9.151432e-03 3 1  ON 41
ci_043                -3.138478e-03 3 1  ON 42
ci_044                -1.604868e-02 3 1  ON 43
ci_045                -1.837073e-03 3 1  ON 44
ci_046                 5.474630e-03 3 1  ON 45
ci_047                 6.402215e-03 3 1  ON 46
ci_048                -1.222741e-02 3 1  ON 47
ci_049                -1.255304e-02 3 1  ON 48
ci_050                 7.129559e-03 3 1  ON 49
ci_051                 7.454360e-03 3 1  ON 50
ci_052                -6.968448e-03 3 1  ON 51
ci_053                -6.907642e-03 3 1  ON 52
ci_054                -2.957506e-03 3 1  ON 53
ci_055                -2.625214e-03 3 1  ON 54
ci_056                 3.994472e-03 3 1  ON 55
ci_057                 4.633089e-03 3 1  ON 56
ci_058                -6.478899e-03 3 1  ON 57
ci_059                -6.686504e-03 3 1  ON 58
ci_060                 7.848201e-03 3 1  ON 59
ci_061                 9.427560e-03 3 1  ON 60
ci_062                -3.563747e-03 3 1  ON 61
ci_063                -3.165647e-03 3 1  ON 62
ci_064                -2.978234e-03 3 1  ON 63
ci_065                -4.183218e-03 3 1  ON 64
ci_066                 5.193159e-03 3 1  ON 65
ci_067                 5.641243e-03 3 1  ON 66
ci_068                -5.236710e-03 3 1  ON 67
ci_069                -5.205143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.7839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2475
    reference variance = 0.192642
====================================================
  Execution time = 1.3824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1079e-01
  Total weights = 1.956543610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296569629016
                                         uncertainty =       0.002160715919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296569629016
                                         uncertainty =       0.002160715919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385053786
  error estimate for blocks of size 2^( 2) =       0.000395152247
  error estimate for blocks of size 2^( 3) =       0.000404163193
  error estimate for blocks of size 2^( 4) =       0.000411692376
  error estimate for blocks of size 2^( 5) =       0.000416981810
  error estimate for blocks of size 2^( 6) =       0.000419610261
  error estimate for blocks of size 2^( 7) =       0.000420303851

      target function =                  N/A
              le_mean =     -17.216539341354
             les_mean =     296.720020704054
             stat err =       0.000417147075
             autocorr =       1.173641910467
              std dev =       0.544548285890
             le_variance =       0.296532835666


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653934135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539341423       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216567823851       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216567058859       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567263394       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567272246       residual = 3.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 1.195370e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539341423       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552855026       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216552996982       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216553073539       residual = 2.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 5.621532e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216539341423       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216543697573       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216543905220       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216543915739       residual = 1.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+00 is 1.803246e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6306e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.037840e-02 3 1  ON 0
ci_002                -2.997463e-02 3 1  ON 1
ci_003                -2.566907e-02 3 1  ON 2
ci_004                 2.070690e-02 3 1  ON 3
ci_005                 2.100897e-02 3 1  ON 4
ci_006                -1.912912e-02 3 1  ON 5
ci_007                -1.882526e-02 3 1  ON 6
ci_008                -1.786382e-02 3 1  ON 7
ci_009                -1.705666e-02 3 1  ON 8
ci_010                -1.700607e-02 3 1  ON 9
ci_011                -1.695714e-02 3 1  ON 10
ci_012                -1.679185e-02 3 1  ON 11
ci_013                -1.900780e-02 3 1  ON 12
ci_014                 1.274646e-02 3 1  ON 13
ci_015                 1.345948e-02 3 1  ON 14
ci_016                 1.635276e-02 3 1  ON 15
ci_017                 1.662160e-02 3 1  ON 16
ci_018                 1.284310e-02 3 1  ON 17
ci_019                 1.243949e-02 3 1  ON 18
ci_020                 1.372761e-02 3 1  ON 19
ci_021                 1.330848e-02 3 1  ON 20
ci_022                 1.149031e-02 3 1  ON 21
ci_023                 1.146488e-02 3 1  ON 22
ci_024                 1.137700e-02 3 1  ON 23
ci_025                 1.180397e-02 3 1  ON 24
ci_026                 1.102667e-02 3 1  ON 25
ci_027                 1.134566e-02 3 1  ON 26
ci_028                -1.507013e-02 3 1  ON 27
ci_029                -1.431752e-02 3 1  ON 28
ci_030                -1.114754e-02 3 1  ON 29
ci_031                -1.131488e-02 3 1  ON 30
ci_032                -1.373438e-02 3 1  ON 31
ci_033                 1.039989e-02 3 1  ON 32
ci_034                 1.009693e-02 3 1  ON 33
ci_035                -4.416776e-03 3 1  ON 34
ci_036                -1.061166e-02 3 1  ON 35
ci_037                -9.652387e-03 3 1  ON 36
ci_038                 1.558054e-03 3 1  ON 37
ci_039                 1.725709e-03 3 1  ON 38
ci_040                -3.801361e-03 3 1  ON 39
ci_041                 1.011103e-02 3 1  ON 40
ci_042                 9.713585e-03 3 1  ON 41
ci_043                -3.309271e-03 3 1  ON 42
ci_044                -1.579110e-02 3 1  ON 43
ci_045                -1.645509e-03 3 1  ON 44
ci_046                 5.250919e-03 3 1  ON 45
ci_047                 6.334565e-03 3 1  ON 46
ci_048                -1.209716e-02 3 1  ON 47
ci_049                -1.221555e-02 3 1  ON 48
ci_050                 7.425096e-03 3 1  ON 49
ci_051                 7.526082e-03 3 1  ON 50
ci_052                -6.844434e-03 3 1  ON 51
ci_053                -6.748388e-03 3 1  ON 52
ci_054                -2.833023e-03 3 1  ON 53
ci_055                -2.845128e-03 3 1  ON 54
ci_056                 4.168929e-03 3 1  ON 55
ci_057                 4.517509e-03 3 1  ON 56
ci_058                -6.639106e-03 3 1  ON 57
ci_059                -6.716575e-03 3 1  ON 58
ci_060                 8.234936e-03 3 1  ON 59
ci_061                 9.157548e-03 3 1  ON 60
ci_062                -3.854600e-03 3 1  ON 61
ci_063                -2.926069e-03 3 1  ON 62
ci_064                -3.168539e-03 3 1  ON 63
ci_065                -4.029925e-03 3 1  ON 64
ci_066                 5.289553e-03 3 1  ON 65
ci_067                 5.479766e-03 3 1  ON 66
ci_068                -4.888019e-03 3 1  ON 67
ci_069                -5.246103e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.272466
====================================================
  Execution time = 1.3631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1293e-01
  Total weights = 1.9567e+06
  Execution time = 1.8353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298745864638
                                         uncertainty =       0.001825264661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298745864638
                                         uncertainty =       0.001825264661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386453620
  error estimate for blocks of size 2^( 2) =       0.000396466429
  error estimate for blocks of size 2^( 3) =       0.000405592508
  error estimate for blocks of size 2^( 4) =       0.000412016432
  error estimate for blocks of size 2^( 5) =       0.000416381251
  error estimate for blocks of size 2^( 6) =       0.000418292765
  error estimate for blocks of size 2^( 7) =       0.000420285927

      target function =                  N/A
              le_mean =     -17.215784394659
             les_mean =     296.706349626659
             stat err =       0.000416744094
             autocorr =       1.162904757755
              std dev =       0.546527950624
             le_variance =       0.298692800814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298335635557
                                         uncertainty =       0.001817406605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298335635557
                                         uncertainty =       0.001817406605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386188061
  error estimate for blocks of size 2^( 2) =       0.000396216835
  error estimate for blocks of size 2^( 3) =       0.000405363263
  error estimate for blocks of size 2^( 4) =       0.000411787514
  error estimate for blocks of size 2^( 5) =       0.000416155506
  error estimate for blocks of size 2^( 6) =       0.000418031448
  error estimate for blocks of size 2^( 7) =       0.000420081518

      target function =                  N/A
              le_mean =     -17.215789187369
             les_mean =     296.703725507225
             stat err =       0.000416513996
             autocorr =       1.163219069102
              std dev =       0.546152393451
             le_variance =       0.298282436872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385719139
                                         uncertainty =       0.001818179999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298385719139
                                         uncertainty =       0.001818179999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386220492
  error estimate for blocks of size 2^( 2) =       0.000396246644
  error estimate for blocks of size 2^( 3) =       0.000405389672
  error estimate for blocks of size 2^( 4) =       0.000411812532
  error estimate for blocks of size 2^( 5) =       0.000416170664
  error estimate for blocks of size 2^( 6) =       0.000418048570
  error estimate for blocks of size 2^( 7) =       0.000420089763

      target function =                  N/A
              le_mean =     -17.215785985690
             les_mean =     296.704319713870
             stat err =       0.000416530382
             autocorr =       1.163115234524
              std dev =       0.546198257997
             le_variance =       0.298332537039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655604639
                                         uncertainty =       0.001824171310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655604639
                                         uncertainty =       0.001824171310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395220
  error estimate for blocks of size 2^( 2) =       0.000396413304
  error estimate for blocks of size 2^( 3) =       0.000405545739
  error estimate for blocks of size 2^( 4) =       0.000411959080
  error estimate for blocks of size 2^( 5) =       0.000416320237
  error estimate for blocks of size 2^( 6) =       0.000418236323
  error estimate for blocks of size 2^( 7) =       0.000420251123

      target function =                  N/A
              le_mean =     -17.215775790747
             les_mean =     296.697359627631
             stat err =       0.000416691691
             autocorr =       1.162963783840
              std dev =       0.546445360164
             le_variance =       0.298602531645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215784394659        initial
     1.4901e-01     1.4901e+00             1.1954e-03       -17.215789187369  <--
     5.9605e-01     5.9605e+00             5.6215e-04       -17.215785985690
     2.3842e+00     2.3842e+01             1.8032e-04       -17.215775790747

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.2862e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -3.996659e-02 3 1  ON 0
ci_002                -2.986431e-02 3 1  ON 1
ci_003                -2.593052e-02 3 1  ON 2
ci_004                 2.066938e-02 3 1  ON 3
ci_005                 2.132593e-02 3 1  ON 4
ci_006                -1.900112e-02 3 1  ON 5
ci_007                -1.878645e-02 3 1  ON 6
ci_008                -1.770904e-02 3 1  ON 7
ci_009                -1.737706e-02 3 1  ON 8
ci_010                -1.698846e-02 3 1  ON 9
ci_011                -1.673511e-02 3 1  ON 10
ci_012                -1.641342e-02 3 1  ON 11
ci_013                -1.885050e-02 3 1  ON 12
ci_014                 1.284328e-02 3 1  ON 13
ci_015                 1.312386e-02 3 1  ON 14
ci_016                 1.643299e-02 3 1  ON 15
ci_017                 1.689909e-02 3 1  ON 16
ci_018                 1.279736e-02 3 1  ON 17
ci_019                 1.245797e-02 3 1  ON 18
ci_020                 1.370661e-02 3 1  ON 19
ci_021                 1.357865e-02 3 1  ON 20
ci_022                 1.172535e-02 3 1  ON 21
ci_023                 1.145397e-02 3 1  ON 22
ci_024                 1.149976e-02 3 1  ON 23
ci_025                 1.229509e-02 3 1  ON 24
ci_026                 1.097732e-02 3 1  ON 25
ci_027                 1.146193e-02 3 1  ON 26
ci_028                -1.535641e-02 3 1  ON 27
ci_029                -1.427949e-02 3 1  ON 28
ci_030                -1.129018e-02 3 1  ON 29
ci_031                -1.107171e-02 3 1  ON 30
ci_032                -1.371560e-02 3 1  ON 31
ci_033                 1.049987e-02 3 1  ON 32
ci_034                 9.661212e-03 3 1  ON 33
ci_035                -4.386955e-03 3 1  ON 34
ci_036                -1.069800e-02 3 1  ON 35
ci_037                -1.016703e-02 3 1  ON 36
ci_038                 1.473978e-03 3 1  ON 37
ci_039                 1.757057e-03 3 1  ON 38
ci_040                -3.830479e-03 3 1  ON 39
ci_041                 1.014859e-02 3 1  ON 40
ci_042                 1.034680e-02 3 1  ON 41
ci_043                -3.461429e-03 3 1  ON 42
ci_044                -1.538346e-02 3 1  ON 43
ci_045                -1.491622e-03 3 1  ON 44
ci_046                 5.008511e-03 3 1  ON 45
ci_047                 6.245656e-03 3 1  ON 46
ci_048                -1.189661e-02 3 1  ON 47
ci_049                -1.174691e-02 3 1  ON 48
ci_050                 7.685352e-03 3 1  ON 49
ci_051                 7.579515e-03 3 1  ON 50
ci_052                -6.716598e-03 3 1  ON 51
ci_053                -6.583207e-03 3 1  ON 52
ci_054                -2.709448e-03 3 1  ON 53
ci_055                -3.067030e-03 3 1  ON 54
ci_056                 4.331453e-03 3 1  ON 55
ci_057                 4.416729e-03 3 1  ON 56
ci_058                -6.808766e-03 3 1  ON 57
ci_059                -6.735368e-03 3 1  ON 58
ci_060                 8.682715e-03 3 1  ON 59
ci_061                 8.832183e-03 3 1  ON 60
ci_062                -4.146018e-03 3 1  ON 61
ci_063                -2.679703e-03 3 1  ON 62
ci_064                -3.290931e-03 3 1  ON 63
ci_065                -3.920439e-03 3 1  ON 64
ci_066                 5.372435e-03 3 1  ON 65
ci_067                 5.334802e-03 3 1  ON 66
ci_068                -4.495333e-03 3 1  ON 67
ci_069                -5.286715e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.222097
====================================================
  Execution time = 1.4274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2170e-01
  Total weights = 1.956723969e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301710044878
                                         uncertainty =       0.002634654179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301710044878
                                         uncertainty =       0.002634654179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388403942
  error estimate for blocks of size 2^( 2) =       0.000398550520
  error estimate for blocks of size 2^( 3) =       0.000407441683
  error estimate for blocks of size 2^( 4) =       0.000414629765
  error estimate for blocks of size 2^( 5) =       0.000418531764
  error estimate for blocks of size 2^( 6) =       0.000420931650
  error estimate for blocks of size 2^( 7) =       0.000422704291

      target function =                  N/A
              le_mean =     -17.217215239370
             les_mean =     296.754204812852
             stat err =       0.000419199368
             autocorr =       1.164860663186
              std dev =       0.549286122435
             le_variance =       0.301715244300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721523937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217215239434       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217231527725       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217231869374       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217231475228       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217231493415       residual = 9.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-02 is 1.392181e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217215239434       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226869421       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226971713       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226800373       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-01 is 9.413763e-04

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217215239434       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217220663953       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217220682751       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217220652541       residual = 2.42e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-01 is 4.197921e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045792 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6756e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.005725e-02 3 1  ON 0
ci_002                -2.985360e-02 3 1  ON 1
ci_003                -2.535832e-02 3 1  ON 2
ci_004                 2.087377e-02 3 1  ON 3
ci_005                 2.080395e-02 3 1  ON 4
ci_006                -1.880352e-02 3 1  ON 5
ci_007                -1.867467e-02 3 1  ON 6
ci_008                -1.722176e-02 3 1  ON 7
ci_009                -1.721173e-02 3 1  ON 8
ci_010                -1.703013e-02 3 1  ON 9
ci_011                -1.683246e-02 3 1  ON 10
ci_012                -1.611675e-02 3 1  ON 11
ci_013                -1.966574e-02 3 1  ON 12
ci_014                 1.342341e-02 3 1  ON 13
ci_015                 1.404090e-02 3 1  ON 14
ci_016                 1.639700e-02 3 1  ON 15
ci_017                 1.685545e-02 3 1  ON 16
ci_018                 1.283148e-02 3 1  ON 17
ci_019                 1.286314e-02 3 1  ON 18
ci_020                 1.343696e-02 3 1  ON 19
ci_021                 1.340522e-02 3 1  ON 20
ci_022                 1.185429e-02 3 1  ON 21
ci_023                 1.133900e-02 3 1  ON 22
ci_024                 1.208951e-02 3 1  ON 23
ci_025                 1.223918e-02 3 1  ON 24
ci_026                 1.082196e-02 3 1  ON 25
ci_027                 1.126045e-02 3 1  ON 26
ci_028                -1.441504e-02 3 1  ON 27
ci_029                -1.381820e-02 3 1  ON 28
ci_030                -1.099349e-02 3 1  ON 29
ci_031                -1.026060e-02 3 1  ON 30
ci_032                -1.393881e-02 3 1  ON 31
ci_033                 1.069050e-02 3 1  ON 32
ci_034                 1.029323e-02 3 1  ON 33
ci_035                -4.507760e-03 3 1  ON 34
ci_036                -1.042993e-02 3 1  ON 35
ci_037                -1.035770e-02 3 1  ON 36
ci_038                 1.472242e-03 3 1  ON 37
ci_039                 1.922802e-03 3 1  ON 38
ci_040                -4.055132e-03 3 1  ON 39
ci_041                 9.744189e-03 3 1  ON 40
ci_042                 9.950663e-03 3 1  ON 41
ci_043                -3.552119e-03 3 1  ON 42
ci_044                -1.556888e-02 3 1  ON 43
ci_045                -1.535599e-03 3 1  ON 44
ci_046                 5.263533e-03 3 1  ON 45
ci_047                 5.848127e-03 3 1  ON 46
ci_048                -1.164657e-02 3 1  ON 47
ci_049                -1.145837e-02 3 1  ON 48
ci_050                 8.042489e-03 3 1  ON 49
ci_051                 7.482852e-03 3 1  ON 50
ci_052                -6.755206e-03 3 1  ON 51
ci_053                -6.459208e-03 3 1  ON 52
ci_054                -2.295601e-03 3 1  ON 53
ci_055                -2.986701e-03 3 1  ON 54
ci_056                 4.439345e-03 3 1  ON 55
ci_057                 4.725089e-03 3 1  ON 56
ci_058                -6.580136e-03 3 1  ON 57
ci_059                -7.138394e-03 3 1  ON 58
ci_060                 8.305768e-03 3 1  ON 59
ci_061                 8.576856e-03 3 1  ON 60
ci_062                -3.666602e-03 3 1  ON 61
ci_063                -2.740360e-03 3 1  ON 62
ci_064                -3.405323e-03 3 1  ON 63
ci_065                -4.074442e-03 3 1  ON 64
ci_066                 5.609612e-03 3 1  ON 65
ci_067                 5.557151e-03 3 1  ON 66
ci_068                -4.531746e-03 3 1  ON 67
ci_069                -5.236063e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.259613
====================================================
  Execution time = 1.3442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1529e-01
  Total weights = 1.9568e+06
  Execution time = 1.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.185501
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299998627911
                                         uncertainty =       0.002064807582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299998627911
                                         uncertainty =       0.002064807582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387360428
  error estimate for blocks of size 2^( 2) =       0.000397459862
  error estimate for blocks of size 2^( 3) =       0.000406778210
  error estimate for blocks of size 2^( 4) =       0.000413481317
  error estimate for blocks of size 2^( 5) =       0.000418806957
  error estimate for blocks of size 2^( 6) =       0.000420993731
  error estimate for blocks of size 2^( 7) =       0.000423199768

      target function =                  N/A
              le_mean =     -17.216217716172
             les_mean =     296.719722652893
             stat err =       0.000419120443
             autocorr =       1.170704223745
              std dev =       0.547810371159
             le_variance =       0.300096202749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299908064514
                                         uncertainty =       0.002061956340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299908064514
                                         uncertainty =       0.002061956340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387306590
  error estimate for blocks of size 2^( 2) =       0.000397406392
  error estimate for blocks of size 2^( 3) =       0.000406707093
  error estimate for blocks of size 2^( 4) =       0.000413397506
  error estimate for blocks of size 2^( 5) =       0.000418689860
  error estimate for blocks of size 2^( 6) =       0.000420868116
  error estimate for blocks of size 2^( 7) =       0.000423164865

      target function =                  N/A
              le_mean =     -17.216185422541
             les_mean =     296.787434425399
             stat err =       0.000419030087
             autocorr =       1.170524854616
              std dev =       0.547734232652
             le_variance =       0.300012789619

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.178149
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300068988047
                                         uncertainty =       0.002039745686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300068988047
                                         uncertainty =       0.002039745686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387412427
  error estimate for blocks of size 2^( 2) =       0.000397512293
  error estimate for blocks of size 2^( 3) =       0.000406806283
  error estimate for blocks of size 2^( 4) =       0.000413490407
  error estimate for blocks of size 2^( 5) =       0.000418786453
  error estimate for blocks of size 2^( 6) =       0.000420976290
  error estimate for blocks of size 2^( 7) =       0.000423282053

      target function =                  N/A
              le_mean =     -17.216185078843
             les_mean =     296.735565051415
             stat err =       0.000419133801
             autocorr =       1.170464579490
              std dev =       0.547883909025
             le_variance =       0.300176777769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299898438830
                                         uncertainty =       0.002056731309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299898438830
                                         uncertainty =       0.002056731309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387297249
  error estimate for blocks of size 2^( 2) =       0.000397398461
  error estimate for blocks of size 2^( 3) =       0.000406713109
  error estimate for blocks of size 2^( 4) =       0.000413415137
  error estimate for blocks of size 2^( 5) =       0.000418742436
  error estimate for blocks of size 2^( 6) =       0.000420936264
  error estimate for blocks of size 2^( 7) =       0.000423172574

      target function =                  N/A
              le_mean =     -17.216195359126
             les_mean =     296.786915840550
             stat err =       0.000419066603
             autocorr =       1.170785350355
              std dev =       0.547721021503
             le_variance =       0.299998317396


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216217716172        initial  <--
     3.7253e-02     3.7253e-01             1.3922e-03       -17.216185422541
     1.4901e-01     1.4901e+00             9.4138e-04       -17.216185078843
     5.9605e-01     5.9605e+00             4.1979e-04       -17.216195359126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7356
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -3.996659e-02 3 1  ON 0
ci_002                -2.986431e-02 3 1  ON 1
ci_003                -2.593052e-02 3 1  ON 2
ci_004                 2.066938e-02 3 1  ON 3
ci_005                 2.132593e-02 3 1  ON 4
ci_006                -1.900112e-02 3 1  ON 5
ci_007                -1.878645e-02 3 1  ON 6
ci_008                -1.770904e-02 3 1  ON 7
ci_009                -1.737706e-02 3 1  ON 8
ci_010                -1.698846e-02 3 1  ON 9
ci_011                -1.673511e-02 3 1  ON 10
ci_012                -1.641342e-02 3 1  ON 11
ci_013                -1.885050e-02 3 1  ON 12
ci_014                 1.284328e-02 3 1  ON 13
ci_015                 1.312386e-02 3 1  ON 14
ci_016                 1.643299e-02 3 1  ON 15
ci_017                 1.689909e-02 3 1  ON 16
ci_018                 1.279736e-02 3 1  ON 17
ci_019                 1.245797e-02 3 1  ON 18
ci_020                 1.370661e-02 3 1  ON 19
ci_021                 1.357865e-02 3 1  ON 20
ci_022                 1.172535e-02 3 1  ON 21
ci_023                 1.145397e-02 3 1  ON 22
ci_024                 1.149976e-02 3 1  ON 23
ci_025                 1.229509e-02 3 1  ON 24
ci_026                 1.097732e-02 3 1  ON 25
ci_027                 1.146193e-02 3 1  ON 26
ci_028                -1.535641e-02 3 1  ON 27
ci_029                -1.427949e-02 3 1  ON 28
ci_030                -1.129018e-02 3 1  ON 29
ci_031                -1.107171e-02 3 1  ON 30
ci_032                -1.371560e-02 3 1  ON 31
ci_033                 1.049987e-02 3 1  ON 32
ci_034                 9.661212e-03 3 1  ON 33
ci_035                -4.386955e-03 3 1  ON 34
ci_036                -1.069800e-02 3 1  ON 35
ci_037                -1.016703e-02 3 1  ON 36
ci_038                 1.473978e-03 3 1  ON 37
ci_039                 1.757057e-03 3 1  ON 38
ci_040                -3.830479e-03 3 1  ON 39
ci_041                 1.014859e-02 3 1  ON 40
ci_042                 1.034680e-02 3 1  ON 41
ci_043                -3.461429e-03 3 1  ON 42
ci_044                -1.538346e-02 3 1  ON 43
ci_045                -1.491622e-03 3 1  ON 44
ci_046                 5.008511e-03 3 1  ON 45
ci_047                 6.245656e-03 3 1  ON 46
ci_048                -1.189661e-02 3 1  ON 47
ci_049                -1.174691e-02 3 1  ON 48
ci_050                 7.685352e-03 3 1  ON 49
ci_051                 7.579515e-03 3 1  ON 50
ci_052                -6.716598e-03 3 1  ON 51
ci_053                -6.583207e-03 3 1  ON 52
ci_054                -2.709448e-03 3 1  ON 53
ci_055                -3.067030e-03 3 1  ON 54
ci_056                 4.331453e-03 3 1  ON 55
ci_057                 4.416729e-03 3 1  ON 56
ci_058                -6.808766e-03 3 1  ON 57
ci_059                -6.735368e-03 3 1  ON 58
ci_060                 8.682715e-03 3 1  ON 59
ci_061                 8.832183e-03 3 1  ON 60
ci_062                -4.146018e-03 3 1  ON 61
ci_063                -2.679703e-03 3 1  ON 62
ci_064                -3.290931e-03 3 1  ON 63
ci_065                -3.920439e-03 3 1  ON 64
ci_066                 5.372435e-03 3 1  ON 65
ci_067                 5.334802e-03 3 1  ON 66
ci_068                -4.495333e-03 3 1  ON 67
ci_069                -5.286715e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9653e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1894
    reference variance = 0.275728
====================================================
  Execution time = 1.4039e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0992e-01
  Total weights = 1.956693632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295951373113
                                         uncertainty =       0.001678741894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295951373113
                                         uncertainty =       0.001678741894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384661317
  error estimate for blocks of size 2^( 2) =       0.000394600303
  error estimate for blocks of size 2^( 3) =       0.000404071237
  error estimate for blocks of size 2^( 4) =       0.000411074312
  error estimate for blocks of size 2^( 5) =       0.000415174513
  error estimate for blocks of size 2^( 6) =       0.000417102415
  error estimate for blocks of size 2^( 7) =       0.000419059663

      target function =                  N/A
              le_mean =     -17.216167748510
             les_mean =     296.706347371682
             stat err =       0.000415602726
             autocorr =       1.167346393793
              std dev =       0.543993251609
             le_variance =       0.295928657796


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616774851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167748530       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216187432358       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216187520483       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216187504692       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 9.839008e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167748530       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216174696207       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216174811346       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216174815297       residual = 1.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 3.251133e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167748530       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169684815       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216169731873       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216169733702       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 8.840023e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049548 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6579e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.002842e-02 3 1  ON 0
ci_002                -2.986107e-02 3 1  ON 1
ci_003                -2.560541e-02 3 1  ON 2
ci_004                 2.073059e-02 3 1  ON 3
ci_005                 2.133042e-02 3 1  ON 4
ci_006                -1.903483e-02 3 1  ON 5
ci_007                -1.881031e-02 3 1  ON 6
ci_008                -1.773917e-02 3 1  ON 7
ci_009                -1.737683e-02 3 1  ON 8
ci_010                -1.709875e-02 3 1  ON 9
ci_011                -1.666152e-02 3 1  ON 10
ci_012                -1.645926e-02 3 1  ON 11
ci_013                -1.885576e-02 3 1  ON 12
ci_014                 1.293167e-02 3 1  ON 13
ci_015                 1.321544e-02 3 1  ON 14
ci_016                 1.639333e-02 3 1  ON 15
ci_017                 1.696240e-02 3 1  ON 16
ci_018                 1.272313e-02 3 1  ON 17
ci_019                 1.250565e-02 3 1  ON 18
ci_020                 1.347733e-02 3 1  ON 19
ci_021                 1.350816e-02 3 1  ON 20
ci_022                 1.173941e-02 3 1  ON 21
ci_023                 1.151658e-02 3 1  ON 22
ci_024                 1.151651e-02 3 1  ON 23
ci_025                 1.210032e-02 3 1  ON 24
ci_026                 1.101954e-02 3 1  ON 25
ci_027                 1.135494e-02 3 1  ON 26
ci_028                -1.528562e-02 3 1  ON 27
ci_029                -1.438510e-02 3 1  ON 28
ci_030                -1.124487e-02 3 1  ON 29
ci_031                -1.089314e-02 3 1  ON 30
ci_032                -1.360090e-02 3 1  ON 31
ci_033                 1.051487e-02 3 1  ON 32
ci_034                 9.770345e-03 3 1  ON 33
ci_035                -4.441590e-03 3 1  ON 34
ci_036                -1.075215e-02 3 1  ON 35
ci_037                -1.023656e-02 3 1  ON 36
ci_038                 1.500633e-03 3 1  ON 37
ci_039                 1.760004e-03 3 1  ON 38
ci_040                -3.890172e-03 3 1  ON 39
ci_041                 1.010284e-02 3 1  ON 40
ci_042                 1.032453e-02 3 1  ON 41
ci_043                -3.326120e-03 3 1  ON 42
ci_044                -1.543550e-02 3 1  ON 43
ci_045                -1.474923e-03 3 1  ON 44
ci_046                 5.018337e-03 3 1  ON 45
ci_047                 6.168374e-03 3 1  ON 46
ci_048                -1.191454e-02 3 1  ON 47
ci_049                -1.170941e-02 3 1  ON 48
ci_050                 7.696609e-03 3 1  ON 49
ci_051                 7.692491e-03 3 1  ON 50
ci_052                -6.703413e-03 3 1  ON 51
ci_053                -6.546485e-03 3 1  ON 52
ci_054                -2.606508e-03 3 1  ON 53
ci_055                -3.041468e-03 3 1  ON 54
ci_056                 4.248854e-03 3 1  ON 55
ci_057                 4.588961e-03 3 1  ON 56
ci_058                -6.650740e-03 3 1  ON 57
ci_059                -6.763791e-03 3 1  ON 58
ci_060                 8.743281e-03 3 1  ON 59
ci_061                 8.920239e-03 3 1  ON 60
ci_062                -3.947295e-03 3 1  ON 61
ci_063                -2.687508e-03 3 1  ON 62
ci_064                -3.225674e-03 3 1  ON 63
ci_065                -3.860926e-03 3 1  ON 64
ci_066                 5.320488e-03 3 1  ON 65
ci_067                 5.360577e-03 3 1  ON 66
ci_068                -4.600068e-03 3 1  ON 67
ci_069                -5.274718e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.149
    reference variance = 0.278437
====================================================
  Execution time = 1.6205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1186e-01
  Total weights = 1.9566e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298767714999
                                         uncertainty =       0.002020942470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298767714999
                                         uncertainty =       0.002020942470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386471088
  error estimate for blocks of size 2^( 2) =       0.000396366796
  error estimate for blocks of size 2^( 3) =       0.000405701179
  error estimate for blocks of size 2^( 4) =       0.000411909349
  error estimate for blocks of size 2^( 5) =       0.000415975492
  error estimate for blocks of size 2^( 6) =       0.000419431233
  error estimate for blocks of size 2^( 7) =       0.000418492338

      target function =                  N/A
              le_mean =     -17.216549536194
             les_mean =     296.722354185406
             stat err =       0.000416452103
             autocorr =       1.161170781729
              std dev =       0.546552654637
             le_variance =       0.298719804290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298786193681
                                         uncertainty =       0.002010208917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298786193681
                                         uncertainty =       0.002010208917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386482679
  error estimate for blocks of size 2^( 2) =       0.000396365327
  error estimate for blocks of size 2^( 3) =       0.000405702424
  error estimate for blocks of size 2^( 4) =       0.000411915724
  error estimate for blocks of size 2^( 5) =       0.000415991628
  error estimate for blocks of size 2^( 6) =       0.000419442405
  error estimate for blocks of size 2^( 7) =       0.000418496175

      target function =                  N/A
              le_mean =     -17.216555006104
             les_mean =     296.724954397190
             stat err =       0.000416461483
             autocorr =       1.161153438307
              std dev =       0.546569046584
             le_variance =       0.298737722683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298758726248
                                         uncertainty =       0.002011996970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298758726248
                                         uncertainty =       0.002011996970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386465033
  error estimate for blocks of size 2^( 2) =       0.000396351478
  error estimate for blocks of size 2^( 3) =       0.000405687044
  error estimate for blocks of size 2^( 4) =       0.000411890426
  error estimate for blocks of size 2^( 5) =       0.000415964877
  error estimate for blocks of size 2^( 6) =       0.000419417319
  error estimate for blocks of size 2^( 7) =       0.000418471349

      target function =                  N/A
              le_mean =     -17.216551895535
             les_mean =     296.721910880484
             stat err =       0.000416435993
             autocorr =       1.161117326577
              std dev =       0.546544091526
             le_variance =       0.298710443982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298760578277
                                         uncertainty =       0.002019514380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298760578277
                                         uncertainty =       0.002019514380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386466441
  error estimate for blocks of size 2^( 2) =       0.000396360919
  error estimate for blocks of size 2^( 3) =       0.000405695480
  error estimate for blocks of size 2^( 4) =       0.000411902926
  error estimate for blocks of size 2^( 5) =       0.000415970335
  error estimate for blocks of size 2^( 6) =       0.000419425433
  error estimate for blocks of size 2^( 7) =       0.000418484578

      target function =                  N/A
              le_mean =     -17.216549016124
             les_mean =     296.722210657076
             stat err =       0.000416445818
             autocorr =       1.161163658482
              std dev =       0.546546082008
             le_variance =       0.298712619758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216549536194        initial
     3.7253e-01     3.7253e+00             9.8390e-04       -17.216555006104  <--
     1.4901e+00     1.4901e+01             3.2511e-04       -17.216551895535
     5.9605e+00     5.9605e+01             8.8400e-05       -17.216549016124

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.5472e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.015581e-02 3 1  ON 0
ci_002                -2.985896e-02 3 1  ON 1
ci_003                -2.494662e-02 3 1  ON 2
ci_004                 2.086598e-02 3 1  ON 3
ci_005                 2.135387e-02 3 1  ON 4
ci_006                -1.910311e-02 3 1  ON 5
ci_007                -1.885166e-02 3 1  ON 6
ci_008                -1.780270e-02 3 1  ON 7
ci_009                -1.738389e-02 3 1  ON 8
ci_010                -1.732932e-02 3 1  ON 9
ci_011                -1.651068e-02 3 1  ON 10
ci_012                -1.652454e-02 3 1  ON 11
ci_013                -1.888414e-02 3 1  ON 12
ci_014                 1.308924e-02 3 1  ON 13
ci_015                 1.338618e-02 3 1  ON 14
ci_016                 1.632016e-02 3 1  ON 15
ci_017                 1.708094e-02 3 1  ON 16
ci_018                 1.259241e-02 3 1  ON 17
ci_019                 1.259136e-02 3 1  ON 18
ci_020                 1.302696e-02 3 1  ON 19
ci_021                 1.336906e-02 3 1  ON 20
ci_022                 1.176512e-02 3 1  ON 21
ci_023                 1.162032e-02 3 1  ON 22
ci_024                 1.155029e-02 3 1  ON 23
ci_025                 1.168848e-02 3 1  ON 24
ci_026                 1.110122e-02 3 1  ON 25
ci_027                 1.115947e-02 3 1  ON 26
ci_028                -1.515701e-02 3 1  ON 27
ci_029                -1.460387e-02 3 1  ON 28
ci_030                -1.115623e-02 3 1  ON 29
ci_031                -1.056018e-02 3 1  ON 30
ci_032                -1.340404e-02 3 1  ON 31
ci_033                 1.053345e-02 3 1  ON 32
ci_034                 9.976568e-03 3 1  ON 33
ci_035                -4.522129e-03 3 1  ON 34
ci_036                -1.085115e-02 3 1  ON 35
ci_037                -1.036933e-02 3 1  ON 36
ci_038                 1.540562e-03 3 1  ON 37
ci_039                 1.765306e-03 3 1  ON 38
ci_040                -3.975536e-03 3 1  ON 39
ci_041                 1.002353e-02 3 1  ON 40
ci_042                 1.028653e-02 3 1  ON 41
ci_043                -3.128050e-03 3 1  ON 42
ci_044                -1.555333e-02 3 1  ON 43
ci_045                -1.453971e-03 3 1  ON 44
ci_046                 5.035061e-03 3 1  ON 45
ci_047                 6.033794e-03 3 1  ON 46
ci_048                -1.196104e-02 3 1  ON 47
ci_049                -1.163166e-02 3 1  ON 48
ci_050                 7.716233e-03 3 1  ON 49
ci_051                 7.868231e-03 3 1  ON 50
ci_052                -6.684907e-03 3 1  ON 51
ci_053                -6.485948e-03 3 1  ON 52
ci_054                -2.432700e-03 3 1  ON 53
ci_055                -3.002509e-03 3 1  ON 54
ci_056                 4.117178e-03 3 1  ON 55
ci_057                 4.860241e-03 3 1  ON 56
ci_058                -6.382647e-03 3 1  ON 57
ci_059                -6.811594e-03 3 1  ON 58
ci_060                 8.851005e-03 3 1  ON 59
ci_061                 9.080410e-03 3 1  ON 60
ci_062                -3.611626e-03 3 1  ON 61
ci_063                -2.701647e-03 3 1  ON 62
ci_064                -3.142425e-03 3 1  ON 63
ci_065                -3.781657e-03 3 1  ON 64
ci_066                 5.241017e-03 3 1  ON 65
ci_067                 5.402700e-03 3 1  ON 66
ci_068                -4.790271e-03 3 1  ON 67
ci_069                -5.254506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.301597
====================================================
  Execution time = 1.4298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0959e-01
  Total weights = 1.956395492e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298356233478
                                         uncertainty =       0.001976896264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298356233478
                                         uncertainty =       0.001976896264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386207716
  error estimate for blocks of size 2^( 2) =       0.000396157157
  error estimate for blocks of size 2^( 3) =       0.000404567183
  error estimate for blocks of size 2^( 4) =       0.000411052484
  error estimate for blocks of size 2^( 5) =       0.000414248971
  error estimate for blocks of size 2^( 6) =       0.000415899303
  error estimate for blocks of size 2^( 7) =       0.000418071863

      target function =                  N/A
              le_mean =     -17.216149124296
             les_mean =     296.705384362000
             stat err =       0.000414818155
             autocorr =       1.153648802973
              std dev =       0.546180189483
             le_variance =       0.298312799384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614912430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216149124356       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216172718651       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216171571133       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216171763987       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216171968561       residual = 2.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-02 is 1.221127e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216149124356       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216162159885       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216161680761       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216161793543       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 6.712025e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216149124356       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216153796490       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216153720735       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153747174       residual = 1.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 2.397122e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050902 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6924e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.041875e-02 3 1  ON 0
ci_002                -3.000789e-02 3 1  ON 1
ci_003                -2.518574e-02 3 1  ON 2
ci_004                 2.098881e-02 3 1  ON 3
ci_005                 2.136875e-02 3 1  ON 4
ci_006                -1.936945e-02 3 1  ON 5
ci_007                -1.909028e-02 3 1  ON 6
ci_008                -1.775943e-02 3 1  ON 7
ci_009                -1.761149e-02 3 1  ON 8
ci_010                -1.753470e-02 3 1  ON 9
ci_011                -1.650566e-02 3 1  ON 10
ci_012                -1.603276e-02 3 1  ON 11
ci_013                -1.939375e-02 3 1  ON 12
ci_014                 1.343860e-02 3 1  ON 13
ci_015                 1.347859e-02 3 1  ON 14
ci_016                 1.638608e-02 3 1  ON 15
ci_017                 1.701540e-02 3 1  ON 16
ci_018                 1.268800e-02 3 1  ON 17
ci_019                 1.230923e-02 3 1  ON 18
ci_020                 1.290849e-02 3 1  ON 19
ci_021                 1.348119e-02 3 1  ON 20
ci_022                 1.126401e-02 3 1  ON 21
ci_023                 1.127824e-02 3 1  ON 22
ci_024                 1.168729e-02 3 1  ON 23
ci_025                 1.166528e-02 3 1  ON 24
ci_026                 1.096565e-02 3 1  ON 25
ci_027                 1.110709e-02 3 1  ON 26
ci_028                -1.481646e-02 3 1  ON 27
ci_029                -1.486144e-02 3 1  ON 28
ci_030                -1.111262e-02 3 1  ON 29
ci_031                -1.078381e-02 3 1  ON 30
ci_032                -1.333367e-02 3 1  ON 31
ci_033                 1.014910e-02 3 1  ON 32
ci_034                 1.000661e-02 3 1  ON 33
ci_035                -4.598106e-03 3 1  ON 34
ci_036                -1.078979e-02 3 1  ON 35
ci_037                -1.028375e-02 3 1  ON 36
ci_038                 1.463252e-03 3 1  ON 37
ci_039                 1.742952e-03 3 1  ON 38
ci_040                -4.093958e-03 3 1  ON 39
ci_041                 9.784423e-03 3 1  ON 40
ci_042                 1.021101e-02 3 1  ON 41
ci_043                -3.077900e-03 3 1  ON 42
ci_044                -1.576061e-02 3 1  ON 43
ci_045                -1.505148e-03 3 1  ON 44
ci_046                 5.231718e-03 3 1  ON 45
ci_047                 5.703851e-03 3 1  ON 46
ci_048                -1.195409e-02 3 1  ON 47
ci_049                -1.174975e-02 3 1  ON 48
ci_050                 7.933482e-03 3 1  ON 49
ci_051                 7.930131e-03 3 1  ON 50
ci_052                -6.551160e-03 3 1  ON 51
ci_053                -6.422173e-03 3 1  ON 52
ci_054                -2.719363e-03 3 1  ON 53
ci_055                -3.272077e-03 3 1  ON 54
ci_056                 4.694993e-03 3 1  ON 55
ci_057                 4.701061e-03 3 1  ON 56
ci_058                -6.397640e-03 3 1  ON 57
ci_059                -6.740377e-03 3 1  ON 58
ci_060                 8.567801e-03 3 1  ON 59
ci_061                 8.871116e-03 3 1  ON 60
ci_062                -3.618205e-03 3 1  ON 61
ci_063                -2.667476e-03 3 1  ON 62
ci_064                -3.185415e-03 3 1  ON 63
ci_065                -3.910068e-03 3 1  ON 64
ci_066                 5.369809e-03 3 1  ON 65
ci_067                 5.555273e-03 3 1  ON 66
ci_068                -4.757287e-03 3 1  ON 67
ci_069                -4.583303e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2238
    reference variance = 0.218445
====================================================
  Execution time = 1.3444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2275e-01
  Total weights = 1.9568e+06
  Execution time = 1.8332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303001215262
                                         uncertainty =       0.003136625286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303001215262
                                         uncertainty =       0.003136625286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389175673
  error estimate for blocks of size 2^( 2) =       0.000399039192
  error estimate for blocks of size 2^( 3) =       0.000407924377
  error estimate for blocks of size 2^( 4) =       0.000414467106
  error estimate for blocks of size 2^( 5) =       0.000419065521
  error estimate for blocks of size 2^( 6) =       0.000421198066
  error estimate for blocks of size 2^( 7) =       0.000422265574

      target function =                  N/A
              le_mean =     -17.217521308054
             les_mean =     296.778386650880
             stat err =       0.000419249066
             autocorr =       1.160520559654
              std dev =       0.550377514586
             le_variance =       0.302915408562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303102816241
                                         uncertainty =       0.003152772139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303102816241
                                         uncertainty =       0.003152772139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389241645
  error estimate for blocks of size 2^( 2) =       0.000399111596
  error estimate for blocks of size 2^( 3) =       0.000407990991
  error estimate for blocks of size 2^( 4) =       0.000414528018
  error estimate for blocks of size 2^( 5) =       0.000419117497
  error estimate for blocks of size 2^( 6) =       0.000421244581
  error estimate for blocks of size 2^( 7) =       0.000422349010

      target function =                  N/A
              le_mean =     -17.217500625893
             les_mean =     296.840364562790
             stat err =       0.000419309777
             autocorr =       1.160463216212
              std dev =       0.550470813135
             le_variance =       0.303018116113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303236990751
                                         uncertainty =       0.003159068764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303236990751
                                         uncertainty =       0.003159068764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389327739
  error estimate for blocks of size 2^( 2) =       0.000399195092
  error estimate for blocks of size 2^( 3) =       0.000408077806
  error estimate for blocks of size 2^( 4) =       0.000414592855
  error estimate for blocks of size 2^( 5) =       0.000419190914
  error estimate for blocks of size 2^( 6) =       0.000421311325
  error estimate for blocks of size 2^( 7) =       0.000422385308

      target function =                  N/A
              le_mean =     -17.217496151442
             les_mean =     297.013205246224
             stat err =       0.000419370100
             autocorr =       1.160283809120
              std dev =       0.550592568704
             le_variance =       0.303152176713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302970211890
                                         uncertainty =       0.003139033897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302970211890
                                         uncertainty =       0.003139033897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389155906
  error estimate for blocks of size 2^( 2) =       0.000399020465
  error estimate for blocks of size 2^( 3) =       0.000407905480
  error estimate for blocks of size 2^( 4) =       0.000414449880
  error estimate for blocks of size 2^( 5) =       0.000419048093
  error estimate for blocks of size 2^( 6) =       0.000421179699
  error estimate for blocks of size 2^( 7) =       0.000422253643

      target function =                  N/A
              le_mean =     -17.217514083864
             les_mean =     296.764669601653
             stat err =       0.000419232829
             autocorr =       1.160548558069
              std dev =       0.550349559512
             le_variance =       0.302884637655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217521308054        initial  <--
     9.3132e-02     9.3132e-01             1.2211e-03       -17.217500625893
     3.7253e-01     3.7253e+00             6.7120e-04       -17.217496151442
     1.4901e+00     1.4901e+01             2.3971e-04       -17.217514083864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6752
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.015581e-02 3 1  ON 0
ci_002                -2.985896e-02 3 1  ON 1
ci_003                -2.494662e-02 3 1  ON 2
ci_004                 2.086598e-02 3 1  ON 3
ci_005                 2.135387e-02 3 1  ON 4
ci_006                -1.910311e-02 3 1  ON 5
ci_007                -1.885166e-02 3 1  ON 6
ci_008                -1.780270e-02 3 1  ON 7
ci_009                -1.738389e-02 3 1  ON 8
ci_010                -1.732932e-02 3 1  ON 9
ci_011                -1.651068e-02 3 1  ON 10
ci_012                -1.652454e-02 3 1  ON 11
ci_013                -1.888414e-02 3 1  ON 12
ci_014                 1.308924e-02 3 1  ON 13
ci_015                 1.338618e-02 3 1  ON 14
ci_016                 1.632016e-02 3 1  ON 15
ci_017                 1.708094e-02 3 1  ON 16
ci_018                 1.259241e-02 3 1  ON 17
ci_019                 1.259136e-02 3 1  ON 18
ci_020                 1.302696e-02 3 1  ON 19
ci_021                 1.336906e-02 3 1  ON 20
ci_022                 1.176512e-02 3 1  ON 21
ci_023                 1.162032e-02 3 1  ON 22
ci_024                 1.155029e-02 3 1  ON 23
ci_025                 1.168848e-02 3 1  ON 24
ci_026                 1.110122e-02 3 1  ON 25
ci_027                 1.115947e-02 3 1  ON 26
ci_028                -1.515701e-02 3 1  ON 27
ci_029                -1.460387e-02 3 1  ON 28
ci_030                -1.115623e-02 3 1  ON 29
ci_031                -1.056018e-02 3 1  ON 30
ci_032                -1.340404e-02 3 1  ON 31
ci_033                 1.053345e-02 3 1  ON 32
ci_034                 9.976568e-03 3 1  ON 33
ci_035                -4.522129e-03 3 1  ON 34
ci_036                -1.085115e-02 3 1  ON 35
ci_037                -1.036933e-02 3 1  ON 36
ci_038                 1.540562e-03 3 1  ON 37
ci_039                 1.765306e-03 3 1  ON 38
ci_040                -3.975536e-03 3 1  ON 39
ci_041                 1.002353e-02 3 1  ON 40
ci_042                 1.028653e-02 3 1  ON 41
ci_043                -3.128050e-03 3 1  ON 42
ci_044                -1.555333e-02 3 1  ON 43
ci_045                -1.453971e-03 3 1  ON 44
ci_046                 5.035061e-03 3 1  ON 45
ci_047                 6.033794e-03 3 1  ON 46
ci_048                -1.196104e-02 3 1  ON 47
ci_049                -1.163166e-02 3 1  ON 48
ci_050                 7.716233e-03 3 1  ON 49
ci_051                 7.868231e-03 3 1  ON 50
ci_052                -6.684907e-03 3 1  ON 51
ci_053                -6.485948e-03 3 1  ON 52
ci_054                -2.432700e-03 3 1  ON 53
ci_055                -3.002509e-03 3 1  ON 54
ci_056                 4.117178e-03 3 1  ON 55
ci_057                 4.860241e-03 3 1  ON 56
ci_058                -6.382647e-03 3 1  ON 57
ci_059                -6.811594e-03 3 1  ON 58
ci_060                 8.851005e-03 3 1  ON 59
ci_061                 9.080410e-03 3 1  ON 60
ci_062                -3.611626e-03 3 1  ON 61
ci_063                -2.701647e-03 3 1  ON 62
ci_064                -3.142425e-03 3 1  ON 63
ci_065                -3.781657e-03 3 1  ON 64
ci_066                 5.241017e-03 3 1  ON 65
ci_067                 5.402700e-03 3 1  ON 66
ci_068                -4.790271e-03 3 1  ON 67
ci_069                -5.254506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.0998
    reference variance = 0.227641
====================================================
  Execution time = 1.4348e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0970e-01
  Total weights = 1.956845571e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297273178779
                                         uncertainty =       0.001912034461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297273178779
                                         uncertainty =       0.001912034461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385574224
  error estimate for blocks of size 2^( 2) =       0.000395523164
  error estimate for blocks of size 2^( 3) =       0.000404278192
  error estimate for blocks of size 2^( 4) =       0.000410895761
  error estimate for blocks of size 2^( 5) =       0.000414521187
  error estimate for blocks of size 2^( 6) =       0.000416512387
  error estimate for blocks of size 2^( 7) =       0.000418270220

      target function =                  N/A
              le_mean =     -17.216012721429
             les_mean =     296.700798196004
             stat err =       0.000415049889
             autocorr =       1.158736314657
              std dev =       0.545284296514
             le_variance =       0.297334964025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601272143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012721475       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216014700413       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216014771838       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 3.929719e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012721475       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216013312890       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216013337861       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 1.164602e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216012721475       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216012876923       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216012883831       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 3.054705e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6879e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.020954e-02 3 1  ON 0
ci_002                -2.988802e-02 3 1  ON 1
ci_003                -2.495814e-02 3 1  ON 2
ci_004                 2.084676e-02 3 1  ON 3
ci_005                 2.130306e-02 3 1  ON 4
ci_006                -1.912092e-02 3 1  ON 5
ci_007                -1.883697e-02 3 1  ON 6
ci_008                -1.782643e-02 3 1  ON 7
ci_009                -1.733562e-02 3 1  ON 8
ci_010                -1.731248e-02 3 1  ON 9
ci_011                -1.651890e-02 3 1  ON 10
ci_012                -1.657018e-02 3 1  ON 11
ci_013                -1.893399e-02 3 1  ON 12
ci_014                 1.311693e-02 3 1  ON 13
ci_015                 1.341687e-02 3 1  ON 14
ci_016                 1.629798e-02 3 1  ON 15
ci_017                 1.710243e-02 3 1  ON 16
ci_018                 1.257805e-02 3 1  ON 17
ci_019                 1.257781e-02 3 1  ON 18
ci_020                 1.301685e-02 3 1  ON 19
ci_021                 1.337100e-02 3 1  ON 20
ci_022                 1.172331e-02 3 1  ON 21
ci_023                 1.153159e-02 3 1  ON 22
ci_024                 1.155318e-02 3 1  ON 23
ci_025                 1.165172e-02 3 1  ON 24
ci_026                 1.110842e-02 3 1  ON 25
ci_027                 1.117914e-02 3 1  ON 26
ci_028                -1.505168e-02 3 1  ON 27
ci_029                -1.458444e-02 3 1  ON 28
ci_030                -1.113731e-02 3 1  ON 29
ci_031                -1.059290e-02 3 1  ON 30
ci_032                -1.341097e-02 3 1  ON 31
ci_033                 1.053748e-02 3 1  ON 32
ci_034                 9.998293e-03 3 1  ON 33
ci_035                -4.535249e-03 3 1  ON 34
ci_036                -1.083866e-02 3 1  ON 35
ci_037                -1.030762e-02 3 1  ON 36
ci_038                 1.512716e-03 3 1  ON 37
ci_039                 1.748333e-03 3 1  ON 38
ci_040                -3.979001e-03 3 1  ON 39
ci_041                 1.005177e-02 3 1  ON 40
ci_042                 1.027694e-02 3 1  ON 41
ci_043                -3.117478e-03 3 1  ON 42
ci_044                -1.554727e-02 3 1  ON 43
ci_045                -1.431357e-03 3 1  ON 44
ci_046                 5.093224e-03 3 1  ON 45
ci_047                 6.040768e-03 3 1  ON 46
ci_048                -1.197111e-02 3 1  ON 47
ci_049                -1.164001e-02 3 1  ON 48
ci_050                 7.624502e-03 3 1  ON 49
ci_051                 7.879574e-03 3 1  ON 50
ci_052                -6.734478e-03 3 1  ON 51
ci_053                -6.464803e-03 3 1  ON 52
ci_054                -2.480627e-03 3 1  ON 53
ci_055                -3.036490e-03 3 1  ON 54
ci_056                 4.141982e-03 3 1  ON 55
ci_057                 4.854932e-03 3 1  ON 56
ci_058                -6.450618e-03 3 1  ON 57
ci_059                -6.796753e-03 3 1  ON 58
ci_060                 8.734545e-03 3 1  ON 59
ci_061                 9.014043e-03 3 1  ON 60
ci_062                -3.604776e-03 3 1  ON 61
ci_063                -2.745081e-03 3 1  ON 62
ci_064                -3.150581e-03 3 1  ON 63
ci_065                -3.845283e-03 3 1  ON 64
ci_066                 5.279274e-03 3 1  ON 65
ci_067                 5.429300e-03 3 1  ON 66
ci_068                -4.786195e-03 3 1  ON 67
ci_069                -5.256860e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.28
    reference variance = 0.326283
====================================================
  Execution time = 1.3468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1162e-01
  Total weights = 1.9568e+06
  Execution time = 1.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296578597459
                                         uncertainty =       0.002035653191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296578597459
                                         uncertainty =       0.002035653191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385024758
  error estimate for blocks of size 2^( 2) =       0.000395048648
  error estimate for blocks of size 2^( 3) =       0.000403584735
  error estimate for blocks of size 2^( 4) =       0.000410282068
  error estimate for blocks of size 2^( 5) =       0.000415819014
  error estimate for blocks of size 2^( 6) =       0.000417437146
  error estimate for blocks of size 2^( 7) =       0.000417813288

      target function =                  N/A
              le_mean =     -17.216357268335
             les_mean =     296.714886193549
             stat err =       0.000415337879
             autocorr =       1.163659098727
              std dev =       0.544507233950
             le_variance =       0.296488127823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296567478254
                                         uncertainty =       0.002027018134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296567478254
                                         uncertainty =       0.002027018134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385017845
  error estimate for blocks of size 2^( 2) =       0.000395047085
  error estimate for blocks of size 2^( 3) =       0.000403587579
  error estimate for blocks of size 2^( 4) =       0.000410289976
  error estimate for blocks of size 2^( 5) =       0.000415820020
  error estimate for blocks of size 2^( 6) =       0.000417433747
  error estimate for blocks of size 2^( 7) =       0.000417791562

      target function =                  N/A
              le_mean =     -17.216356728993
             les_mean =     296.716910988995
             stat err =       0.000415333827
             autocorr =       1.163678174992
              std dev =       0.544497458018
             le_variance =       0.296477481788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296562814584
                                         uncertainty =       0.002030210282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296562814584
                                         uncertainty =       0.002030210282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385014701
  error estimate for blocks of size 2^( 2) =       0.000395041765
  error estimate for blocks of size 2^( 3) =       0.000403581168
  error estimate for blocks of size 2^( 4) =       0.000410281077
  error estimate for blocks of size 2^( 5) =       0.000415814383
  error estimate for blocks of size 2^( 6) =       0.000417429725
  error estimate for blocks of size 2^( 7) =       0.000417795857

      target function =                  N/A
              le_mean =     -17.216356143974
             les_mean =     296.714951970960
             stat err =       0.000415330260
             autocorr =       1.163677194188
              std dev =       0.544493012020
             le_variance =       0.296472640139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296575220656
                                         uncertainty =       0.002034913756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296575220656
                                         uncertainty =       0.002034913756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385022591
  error estimate for blocks of size 2^( 2) =       0.000395046911
  error estimate for blocks of size 2^( 3) =       0.000403583575
  error estimate for blocks of size 2^( 4) =       0.000410281217
  error estimate for blocks of size 2^( 5) =       0.000415817661
  error estimate for blocks of size 2^( 6) =       0.000417435404
  error estimate for blocks of size 2^( 7) =       0.000417810361

      target function =                  N/A
              le_mean =     -17.216356952479
             les_mean =     296.714463772356
             stat err =       0.000415336161
             autocorr =       1.163662564320
              std dev =       0.544504170103
             le_variance =       0.296484791259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216357268335        initial  <--
     9.3132e-01     9.3132e+00             3.9297e-04       -17.216356728993
     3.7253e+00     3.7253e+01             1.1646e-04       -17.216356143974
     1.4901e+01     1.4901e+02             3.0547e-05       -17.216356952479

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9038
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.015581e-02 3 1  ON 0
ci_002                -2.985896e-02 3 1  ON 1
ci_003                -2.494662e-02 3 1  ON 2
ci_004                 2.086598e-02 3 1  ON 3
ci_005                 2.135387e-02 3 1  ON 4
ci_006                -1.910311e-02 3 1  ON 5
ci_007                -1.885166e-02 3 1  ON 6
ci_008                -1.780270e-02 3 1  ON 7
ci_009                -1.738389e-02 3 1  ON 8
ci_010                -1.732932e-02 3 1  ON 9
ci_011                -1.651068e-02 3 1  ON 10
ci_012                -1.652454e-02 3 1  ON 11
ci_013                -1.888414e-02 3 1  ON 12
ci_014                 1.308924e-02 3 1  ON 13
ci_015                 1.338618e-02 3 1  ON 14
ci_016                 1.632016e-02 3 1  ON 15
ci_017                 1.708094e-02 3 1  ON 16
ci_018                 1.259241e-02 3 1  ON 17
ci_019                 1.259136e-02 3 1  ON 18
ci_020                 1.302696e-02 3 1  ON 19
ci_021                 1.336906e-02 3 1  ON 20
ci_022                 1.176512e-02 3 1  ON 21
ci_023                 1.162032e-02 3 1  ON 22
ci_024                 1.155029e-02 3 1  ON 23
ci_025                 1.168848e-02 3 1  ON 24
ci_026                 1.110122e-02 3 1  ON 25
ci_027                 1.115947e-02 3 1  ON 26
ci_028                -1.515701e-02 3 1  ON 27
ci_029                -1.460387e-02 3 1  ON 28
ci_030                -1.115623e-02 3 1  ON 29
ci_031                -1.056018e-02 3 1  ON 30
ci_032                -1.340404e-02 3 1  ON 31
ci_033                 1.053345e-02 3 1  ON 32
ci_034                 9.976568e-03 3 1  ON 33
ci_035                -4.522129e-03 3 1  ON 34
ci_036                -1.085115e-02 3 1  ON 35
ci_037                -1.036933e-02 3 1  ON 36
ci_038                 1.540562e-03 3 1  ON 37
ci_039                 1.765306e-03 3 1  ON 38
ci_040                -3.975536e-03 3 1  ON 39
ci_041                 1.002353e-02 3 1  ON 40
ci_042                 1.028653e-02 3 1  ON 41
ci_043                -3.128050e-03 3 1  ON 42
ci_044                -1.555333e-02 3 1  ON 43
ci_045                -1.453971e-03 3 1  ON 44
ci_046                 5.035061e-03 3 1  ON 45
ci_047                 6.033794e-03 3 1  ON 46
ci_048                -1.196104e-02 3 1  ON 47
ci_049                -1.163166e-02 3 1  ON 48
ci_050                 7.716233e-03 3 1  ON 49
ci_051                 7.868231e-03 3 1  ON 50
ci_052                -6.684907e-03 3 1  ON 51
ci_053                -6.485948e-03 3 1  ON 52
ci_054                -2.432700e-03 3 1  ON 53
ci_055                -3.002509e-03 3 1  ON 54
ci_056                 4.117178e-03 3 1  ON 55
ci_057                 4.860241e-03 3 1  ON 56
ci_058                -6.382647e-03 3 1  ON 57
ci_059                -6.811594e-03 3 1  ON 58
ci_060                 8.851005e-03 3 1  ON 59
ci_061                 9.080410e-03 3 1  ON 60
ci_062                -3.611626e-03 3 1  ON 61
ci_063                -2.701647e-03 3 1  ON 62
ci_064                -3.142425e-03 3 1  ON 63
ci_065                -3.781657e-03 3 1  ON 64
ci_066                 5.241017e-03 3 1  ON 65
ci_067                 5.402700e-03 3 1  ON 66
ci_068                -4.790271e-03 3 1  ON 67
ci_069                -5.254506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.241699
====================================================
  Execution time = 1.4736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1307e-01
  Total weights = 1.956914237e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298364155770
                                         uncertainty =       0.002044730653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298364155770
                                         uncertainty =       0.002044730653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386184043
  error estimate for blocks of size 2^( 2) =       0.000396307721
  error estimate for blocks of size 2^( 3) =       0.000405139221
  error estimate for blocks of size 2^( 4) =       0.000412044859
  error estimate for blocks of size 2^( 5) =       0.000415774657
  error estimate for blocks of size 2^( 6) =       0.000418481451
  error estimate for blocks of size 2^( 7) =       0.000420693504

      target function =                  N/A
              le_mean =     -17.216761523047
             les_mean =     296.729946050297
             stat err =       0.000416748618
             autocorr =       1.164554144712
              std dev =       0.546146711812
             le_variance =       0.298276230824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676152305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216761523093       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216761567567       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216761560375       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216761559740       residual = 1.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 3.628533e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216761523093       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216761534434       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216761532423       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216761532315       residual = 1.45e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 9.205976e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216761523093       residual = 9.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216761525942       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216761525426       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216761525402       residual = 1.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 2.310065e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7247e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.015499e-02 3 1  ON 0
ci_002                -2.985979e-02 3 1  ON 1
ci_003                -2.494839e-02 3 1  ON 2
ci_004                 2.086373e-02 3 1  ON 3
ci_005                 2.134890e-02 3 1  ON 4
ci_006                -1.909996e-02 3 1  ON 5
ci_007                -1.884957e-02 3 1  ON 6
ci_008                -1.780477e-02 3 1  ON 7
ci_009                -1.738851e-02 3 1  ON 8
ci_010                -1.733106e-02 3 1  ON 9
ci_011                -1.650757e-02 3 1  ON 10
ci_012                -1.652488e-02 3 1  ON 11
ci_013                -1.888893e-02 3 1  ON 12
ci_014                 1.308965e-02 3 1  ON 13
ci_015                 1.338605e-02 3 1  ON 14
ci_016                 1.631978e-02 3 1  ON 15
ci_017                 1.708185e-02 3 1  ON 16
ci_018                 1.259232e-02 3 1  ON 17
ci_019                 1.259073e-02 3 1  ON 18
ci_020                 1.303046e-02 3 1  ON 19
ci_021                 1.336478e-02 3 1  ON 20
ci_022                 1.176801e-02 3 1  ON 21
ci_023                 1.161494e-02 3 1  ON 22
ci_024                 1.154719e-02 3 1  ON 23
ci_025                 1.168802e-02 3 1  ON 24
ci_026                 1.110200e-02 3 1  ON 25
ci_027                 1.115948e-02 3 1  ON 26
ci_028                -1.514780e-02 3 1  ON 27
ci_029                -1.460838e-02 3 1  ON 28
ci_030                -1.115364e-02 3 1  ON 29
ci_031                -1.056603e-02 3 1  ON 30
ci_032                -1.341017e-02 3 1  ON 31
ci_033                 1.053086e-02 3 1  ON 32
ci_034                 9.977204e-03 3 1  ON 33
ci_035                -4.524742e-03 3 1  ON 34
ci_036                -1.084903e-02 3 1  ON 35
ci_037                -1.036810e-02 3 1  ON 36
ci_038                 1.542327e-03 3 1  ON 37
ci_039                 1.763777e-03 3 1  ON 38
ci_040                -3.971265e-03 3 1  ON 39
ci_041                 1.002722e-02 3 1  ON 40
ci_042                 1.028369e-02 3 1  ON 41
ci_043                -3.125232e-03 3 1  ON 42
ci_044                -1.555550e-02 3 1  ON 43
ci_045                -1.456182e-03 3 1  ON 44
ci_046                 5.040796e-03 3 1  ON 45
ci_047                 6.032969e-03 3 1  ON 46
ci_048                -1.196135e-02 3 1  ON 47
ci_049                -1.163271e-02 3 1  ON 48
ci_050                 7.715629e-03 3 1  ON 49
ci_051                 7.866673e-03 3 1  ON 50
ci_052                -6.685348e-03 3 1  ON 51
ci_053                -6.486997e-03 3 1  ON 52
ci_054                -2.431255e-03 3 1  ON 53
ci_055                -3.005695e-03 3 1  ON 54
ci_056                 4.121352e-03 3 1  ON 55
ci_057                 4.858594e-03 3 1  ON 56
ci_058                -6.382113e-03 3 1  ON 57
ci_059                -6.814622e-03 3 1  ON 58
ci_060                 8.851478e-03 3 1  ON 59
ci_061                 9.075486e-03 3 1  ON 60
ci_062                -3.609226e-03 3 1  ON 61
ci_063                -2.704492e-03 3 1  ON 62
ci_064                -3.136869e-03 3 1  ON 63
ci_065                -3.785306e-03 3 1  ON 64
ci_066                 5.244206e-03 3 1  ON 65
ci_067                 5.405712e-03 3 1  ON 66
ci_068                -4.791680e-03 3 1  ON 67
ci_069                -5.253811e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.22542
====================================================
  Execution time = 1.3597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1476e-01
  Total weights = 1.9570e+06
  Execution time = 1.8426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298740476351
                                         uncertainty =       0.002216438681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298740476351
                                         uncertainty =       0.002216438681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386465283
  error estimate for blocks of size 2^( 2) =       0.000396468442
  error estimate for blocks of size 2^( 3) =       0.000405293113
  error estimate for blocks of size 2^( 4) =       0.000411952544
  error estimate for blocks of size 2^( 5) =       0.000415437342
  error estimate for blocks of size 2^( 6) =       0.000418084858
  error estimate for blocks of size 2^( 7) =       0.000417936641

      target function =                  N/A
              le_mean =     -17.217220401880
             les_mean =     296.747547381628
             stat err =       0.000415852846
             autocorr =       1.157866217920
              std dev =       0.546544445203
             le_variance =       0.298710830582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676104030
                                         uncertainty =       0.002211074122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298676104030
                                         uncertainty =       0.002211074122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386423651
  error estimate for blocks of size 2^( 2) =       0.000396427804
  error estimate for blocks of size 2^( 3) =       0.000405252418
  error estimate for blocks of size 2^( 4) =       0.000411909381
  error estimate for blocks of size 2^( 5) =       0.000415389431
  error estimate for blocks of size 2^( 6) =       0.000418037296
  error estimate for blocks of size 2^( 7) =       0.000417891406

      target function =                  N/A
              le_mean =     -17.217219665547
             les_mean =     296.747247635782
             stat err =       0.000415806878
             autocorr =       1.157859703273
              std dev =       0.546485568164
             le_variance =       0.298646476211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298705176106
                                         uncertainty =       0.002213312825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298705176106
                                         uncertainty =       0.002213312825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386442453
  error estimate for blocks of size 2^( 2) =       0.000396446155
  error estimate for blocks of size 2^( 3) =       0.000405270812
  error estimate for blocks of size 2^( 4) =       0.000411928928
  error estimate for blocks of size 2^( 5) =       0.000415411155
  error estimate for blocks of size 2^( 6) =       0.000418058841
  error estimate for blocks of size 2^( 7) =       0.000417911857

      target function =                  N/A
              le_mean =     -17.217219991954
             les_mean =     296.747325850752
             stat err =       0.000415827695
             autocorr =       1.157862961010
              std dev =       0.546512158444
             le_variance =       0.298675539328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298735726226
                                         uncertainty =       0.002215991353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298735726226
                                         uncertainty =       0.002215991353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386462211
  error estimate for blocks of size 2^( 2) =       0.000396465443
  error estimate for blocks of size 2^( 3) =       0.000405290114
  error estimate for blocks of size 2^( 4) =       0.000411949374
  error estimate for blocks of size 2^( 5) =       0.000415433832
  error estimate for blocks of size 2^( 6) =       0.000418081369
  error estimate for blocks of size 2^( 7) =       0.000417933312

      target function =                  N/A
              le_mean =     -17.217220345711
             les_mean =     296.747516366093
             stat err =       0.000415849472
             autocorr =       1.157865833324
              std dev =       0.546540100601
             le_variance =       0.298706081565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217220401880        initial  <--
     9.3132e+00     9.3132e+01             3.6285e-05       -17.217219665547
     3.7253e+01     3.7253e+02             9.2060e-06       -17.217219991954
     1.4901e+02     1.4901e+03             2.3101e-06       -17.217220345711

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9070
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.015581e-02 3 1  ON 0
ci_002                -2.985896e-02 3 1  ON 1
ci_003                -2.494662e-02 3 1  ON 2
ci_004                 2.086598e-02 3 1  ON 3
ci_005                 2.135387e-02 3 1  ON 4
ci_006                -1.910311e-02 3 1  ON 5
ci_007                -1.885166e-02 3 1  ON 6
ci_008                -1.780270e-02 3 1  ON 7
ci_009                -1.738389e-02 3 1  ON 8
ci_010                -1.732932e-02 3 1  ON 9
ci_011                -1.651068e-02 3 1  ON 10
ci_012                -1.652454e-02 3 1  ON 11
ci_013                -1.888414e-02 3 1  ON 12
ci_014                 1.308924e-02 3 1  ON 13
ci_015                 1.338618e-02 3 1  ON 14
ci_016                 1.632016e-02 3 1  ON 15
ci_017                 1.708094e-02 3 1  ON 16
ci_018                 1.259241e-02 3 1  ON 17
ci_019                 1.259136e-02 3 1  ON 18
ci_020                 1.302696e-02 3 1  ON 19
ci_021                 1.336906e-02 3 1  ON 20
ci_022                 1.176512e-02 3 1  ON 21
ci_023                 1.162032e-02 3 1  ON 22
ci_024                 1.155029e-02 3 1  ON 23
ci_025                 1.168848e-02 3 1  ON 24
ci_026                 1.110122e-02 3 1  ON 25
ci_027                 1.115947e-02 3 1  ON 26
ci_028                -1.515701e-02 3 1  ON 27
ci_029                -1.460387e-02 3 1  ON 28
ci_030                -1.115623e-02 3 1  ON 29
ci_031                -1.056018e-02 3 1  ON 30
ci_032                -1.340404e-02 3 1  ON 31
ci_033                 1.053345e-02 3 1  ON 32
ci_034                 9.976568e-03 3 1  ON 33
ci_035                -4.522129e-03 3 1  ON 34
ci_036                -1.085115e-02 3 1  ON 35
ci_037                -1.036933e-02 3 1  ON 36
ci_038                 1.540562e-03 3 1  ON 37
ci_039                 1.765306e-03 3 1  ON 38
ci_040                -3.975536e-03 3 1  ON 39
ci_041                 1.002353e-02 3 1  ON 40
ci_042                 1.028653e-02 3 1  ON 41
ci_043                -3.128050e-03 3 1  ON 42
ci_044                -1.555333e-02 3 1  ON 43
ci_045                -1.453971e-03 3 1  ON 44
ci_046                 5.035061e-03 3 1  ON 45
ci_047                 6.033794e-03 3 1  ON 46
ci_048                -1.196104e-02 3 1  ON 47
ci_049                -1.163166e-02 3 1  ON 48
ci_050                 7.716233e-03 3 1  ON 49
ci_051                 7.868231e-03 3 1  ON 50
ci_052                -6.684907e-03 3 1  ON 51
ci_053                -6.485948e-03 3 1  ON 52
ci_054                -2.432700e-03 3 1  ON 53
ci_055                -3.002509e-03 3 1  ON 54
ci_056                 4.117178e-03 3 1  ON 55
ci_057                 4.860241e-03 3 1  ON 56
ci_058                -6.382647e-03 3 1  ON 57
ci_059                -6.811594e-03 3 1  ON 58
ci_060                 8.851005e-03 3 1  ON 59
ci_061                 9.080410e-03 3 1  ON 60
ci_062                -3.611626e-03 3 1  ON 61
ci_063                -2.701647e-03 3 1  ON 62
ci_064                -3.142425e-03 3 1  ON 63
ci_065                -3.781657e-03 3 1  ON 64
ci_066                 5.241017e-03 3 1  ON 65
ci_067                 5.402700e-03 3 1  ON 66
ci_068                -4.790271e-03 3 1  ON 67
ci_069                -5.254506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0186e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2015
    reference variance = 0.315591
====================================================
  Execution time = 1.3809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1384e-01
  Total weights = 1.956871148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297594485853
                                         uncertainty =       0.002004096727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297594485853
                                         uncertainty =       0.002004096727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385754552
  error estimate for blocks of size 2^( 2) =       0.000395600113
  error estimate for blocks of size 2^( 3) =       0.000404606782
  error estimate for blocks of size 2^( 4) =       0.000411322650
  error estimate for blocks of size 2^( 5) =       0.000415562351
  error estimate for blocks of size 2^( 6) =       0.000416374806
  error estimate for blocks of size 2^( 7) =       0.000417209255

      target function =                  N/A
              le_mean =     -17.216390395054
             les_mean =     296.717933583001
             stat err =       0.000415117265
             autocorr =       1.158029107335
              std dev =       0.545539318563
             le_variance =       0.297613148099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639039505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390395091       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390492708       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390503092       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390502795       residual = 3.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.031527e-05

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390395091       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390419537       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390422155       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390422081       residual = 3.36e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 2.582601e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216390395091       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216390401205       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216390401861       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216390401843       residual = 3.37e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 6.458872e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.015621e-02 3 1  ON 0
ci_002                -2.985922e-02 3 1  ON 1
ci_003                -2.494624e-02 3 1  ON 2
ci_004                 2.086609e-02 3 1  ON 3
ci_005                 2.135424e-02 3 1  ON 4
ci_006                -1.910334e-02 3 1  ON 5
ci_007                -1.885144e-02 3 1  ON 6
ci_008                -1.780259e-02 3 1  ON 7
ci_009                -1.738374e-02 3 1  ON 8
ci_010                -1.732673e-02 3 1  ON 9
ci_011                -1.651070e-02 3 1  ON 10
ci_012                -1.652435e-02 3 1  ON 11
ci_013                -1.888463e-02 3 1  ON 12
ci_014                 1.308940e-02 3 1  ON 13
ci_015                 1.338643e-02 3 1  ON 14
ci_016                 1.632047e-02 3 1  ON 15
ci_017                 1.708054e-02 3 1  ON 16
ci_018                 1.259224e-02 3 1  ON 17
ci_019                 1.259163e-02 3 1  ON 18
ci_020                 1.302719e-02 3 1  ON 19
ci_021                 1.336894e-02 3 1  ON 20
ci_022                 1.176508e-02 3 1  ON 21
ci_023                 1.161932e-02 3 1  ON 22
ci_024                 1.154969e-02 3 1  ON 23
ci_025                 1.168762e-02 3 1  ON 24
ci_026                 1.110106e-02 3 1  ON 25
ci_027                 1.115997e-02 3 1  ON 26
ci_028                -1.515651e-02 3 1  ON 27
ci_029                -1.460346e-02 3 1  ON 28
ci_030                -1.115664e-02 3 1  ON 29
ci_031                -1.056034e-02 3 1  ON 30
ci_032                -1.340396e-02 3 1  ON 31
ci_033                 1.053363e-02 3 1  ON 32
ci_034                 9.976626e-03 3 1  ON 33
ci_035                -4.522236e-03 3 1  ON 34
ci_036                -1.085060e-02 3 1  ON 35
ci_037                -1.036894e-02 3 1  ON 36
ci_038                 1.540269e-03 3 1  ON 37
ci_039                 1.765709e-03 3 1  ON 38
ci_040                -3.975120e-03 3 1  ON 39
ci_041                 1.002392e-02 3 1  ON 40
ci_042                 1.028611e-02 3 1  ON 41
ci_043                -3.128068e-03 3 1  ON 42
ci_044                -1.555318e-02 3 1  ON 43
ci_045                -1.454661e-03 3 1  ON 44
ci_046                 5.034871e-03 3 1  ON 45
ci_047                 6.033243e-03 3 1  ON 46
ci_048                -1.196115e-02 3 1  ON 47
ci_049                -1.163238e-02 3 1  ON 48
ci_050                 7.715896e-03 3 1  ON 49
ci_051                 7.868038e-03 3 1  ON 50
ci_052                -6.684583e-03 3 1  ON 51
ci_053                -6.485705e-03 3 1  ON 52
ci_054                -2.433125e-03 3 1  ON 53
ci_055                -3.002879e-03 3 1  ON 54
ci_056                 4.117391e-03 3 1  ON 55
ci_057                 4.860220e-03 3 1  ON 56
ci_058                -6.383248e-03 3 1  ON 57
ci_059                -6.810987e-03 3 1  ON 58
ci_060                 8.851249e-03 3 1  ON 59
ci_061                 9.079766e-03 3 1  ON 60
ci_062                -3.611681e-03 3 1  ON 61
ci_063                -2.702436e-03 3 1  ON 62
ci_064                -3.142688e-03 3 1  ON 63
ci_065                -3.781752e-03 3 1  ON 64
ci_066                 5.241423e-03 3 1  ON 65
ci_067                 5.403012e-03 3 1  ON 66
ci_068                -4.790209e-03 3 1  ON 67
ci_069                -5.254316e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.159864
====================================================
  Execution time = 1.3496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1532e-01
  Total weights = 1.9568e+06
  Execution time = 1.8413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300301533675
                                         uncertainty =       0.002244763058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300301533675
                                         uncertainty =       0.002244763058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388022826
  error estimate for blocks of size 2^( 2) =       0.000397761284
  error estimate for blocks of size 2^( 3) =       0.000407280091
  error estimate for blocks of size 2^( 4) =       0.000414858913
  error estimate for blocks of size 2^( 5) =       0.000418690146
  error estimate for blocks of size 2^( 6) =       0.000421099476
  error estimate for blocks of size 2^( 7) =       0.000421362363

      target function =                  N/A
              le_mean =     -17.216267187390
             les_mean =     296.715168206480
             stat err =       0.000419002725
             autocorr =       1.166055293315
              std dev =       0.548747143287
             le_variance =       0.301123427265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300298469148
                                         uncertainty =       0.002244403012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300298469148
                                         uncertainty =       0.002244403012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388020640
  error estimate for blocks of size 2^( 2) =       0.000397759259
  error estimate for blocks of size 2^( 3) =       0.000407278237
  error estimate for blocks of size 2^( 4) =       0.000414857158
  error estimate for blocks of size 2^( 5) =       0.000418688623
  error estimate for blocks of size 2^( 6) =       0.000421098148
  error estimate for blocks of size 2^( 7) =       0.000421360920

      target function =                  N/A
              le_mean =     -17.216267285317
             les_mean =     296.715199116607
             stat err =       0.000419001212
             autocorr =       1.166060017215
              std dev =       0.548744051446
             le_variance =       0.301120033998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299997035
                                         uncertainty =       0.002244582573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300299997035
                                         uncertainty =       0.002244582573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388021730
  error estimate for blocks of size 2^( 2) =       0.000397760269
  error estimate for blocks of size 2^( 3) =       0.000407279161
  error estimate for blocks of size 2^( 4) =       0.000414858033
  error estimate for blocks of size 2^( 5) =       0.000418689381
  error estimate for blocks of size 2^( 6) =       0.000421098809
  error estimate for blocks of size 2^( 7) =       0.000421361638

      target function =                  N/A
              le_mean =     -17.216267236426
             les_mean =     296.715181088759
             stat err =       0.000419001965
             autocorr =       1.166057657154
              std dev =       0.548745592991
             le_variance =       0.301121725827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300301341337
                                         uncertainty =       0.002244740476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300301341337
                                         uncertainty =       0.002244740476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388022689
  error estimate for blocks of size 2^( 2) =       0.000397761157
  error estimate for blocks of size 2^( 3) =       0.000407279975
  error estimate for blocks of size 2^( 4) =       0.000414858803
  error estimate for blocks of size 2^( 5) =       0.000418690050
  error estimate for blocks of size 2^( 6) =       0.000421099392
  error estimate for blocks of size 2^( 7) =       0.000421362272

      target function =                  N/A
              le_mean =     -17.216267193513
             les_mean =     296.715169643945
             stat err =       0.000419002629
             autocorr =       1.166055588774
              std dev =       0.548746949251
             le_variance =       0.301123214312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216267187390        initial
     9.3132e+01     9.3132e+02             1.0315e-05       -17.216267285317  <--
     3.7253e+02     3.7253e+03             2.5826e-06       -17.216267236426
     1.4901e+03     1.4901e+04             6.4589e-07       -17.216267193513

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 2.2771e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.015743e-02 3 1  ON 0
ci_002                -2.985998e-02 3 1  ON 1
ci_003                -2.494509e-02 3 1  ON 2
ci_004                 2.086642e-02 3 1  ON 3
ci_005                 2.135533e-02 3 1  ON 4
ci_006                -1.910405e-02 3 1  ON 5
ci_007                -1.885076e-02 3 1  ON 6
ci_008                -1.780227e-02 3 1  ON 7
ci_009                -1.738329e-02 3 1  ON 8
ci_010                -1.731900e-02 3 1  ON 9
ci_011                -1.651077e-02 3 1  ON 10
ci_012                -1.652376e-02 3 1  ON 11
ci_013                -1.888609e-02 3 1  ON 12
ci_014                 1.308986e-02 3 1  ON 13
ci_015                 1.338717e-02 3 1  ON 14
ci_016                 1.632141e-02 3 1  ON 15
ci_017                 1.707936e-02 3 1  ON 16
ci_018                 1.259173e-02 3 1  ON 17
ci_019                 1.259245e-02 3 1  ON 18
ci_020                 1.302789e-02 3 1  ON 19
ci_021                 1.336856e-02 3 1  ON 20
ci_022                 1.176496e-02 3 1  ON 21
ci_023                 1.161633e-02 3 1  ON 22
ci_024                 1.154788e-02 3 1  ON 23
ci_025                 1.168504e-02 3 1  ON 24
ci_026                 1.110059e-02 3 1  ON 25
ci_027                 1.116146e-02 3 1  ON 26
ci_028                -1.515504e-02 3 1  ON 27
ci_029                -1.460223e-02 3 1  ON 28
ci_030                -1.115787e-02 3 1  ON 29
ci_031                -1.056083e-02 3 1  ON 30
ci_032                -1.340372e-02 3 1  ON 31
ci_033                 1.053416e-02 3 1  ON 32
ci_034                 9.976799e-03 3 1  ON 33
ci_035                -4.522553e-03 3 1  ON 34
ci_036                -1.084898e-02 3 1  ON 35
ci_037                -1.036778e-02 3 1  ON 36
ci_038                 1.539394e-03 3 1  ON 37
ci_039                 1.766912e-03 3 1  ON 38
ci_040                -3.973877e-03 3 1  ON 39
ci_041                 1.002510e-02 3 1  ON 40
ci_042                 1.028488e-02 3 1  ON 41
ci_043                -3.128125e-03 3 1  ON 42
ci_044                -1.555273e-02 3 1  ON 43
ci_045                -1.456722e-03 3 1  ON 44
ci_046                 5.034302e-03 3 1  ON 45
ci_047                 6.031595e-03 3 1  ON 46
ci_048                -1.196148e-02 3 1  ON 47
ci_049                -1.163456e-02 3 1  ON 48
ci_050                 7.714890e-03 3 1  ON 49
ci_051                 7.867462e-03 3 1  ON 50
ci_052                -6.683613e-03 3 1  ON 51
ci_053                -6.484978e-03 3 1  ON 52
ci_054                -2.434397e-03 3 1  ON 53
ci_055                -3.003983e-03 3 1  ON 54
ci_056                 4.118027e-03 3 1  ON 55
ci_057                 4.860157e-03 3 1  ON 56
ci_058                -6.385047e-03 3 1  ON 57
ci_059                -6.809174e-03 3 1  ON 58
ci_060                 8.851978e-03 3 1  ON 59
ci_061                 9.077840e-03 3 1  ON 60
ci_062                -3.611846e-03 3 1  ON 61
ci_063                -2.704797e-03 3 1  ON 62
ci_064                -3.143472e-03 3 1  ON 63
ci_065                -3.782035e-03 3 1  ON 64
ci_066                 5.242638e-03 3 1  ON 65
ci_067                 5.403945e-03 3 1  ON 66
ci_068                -4.790023e-03 3 1  ON 67
ci_069                -5.253749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9137e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.30502
====================================================
  Execution time = 1.3903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2126e-01
  Total weights = 1.956619458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302628814254
                                         uncertainty =       0.004971099735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302628814254
                                         uncertainty =       0.004971099735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388955825
  error estimate for blocks of size 2^( 2) =       0.000398854506
  error estimate for blocks of size 2^( 3) =       0.000407490746
  error estimate for blocks of size 2^( 4) =       0.000413836167
  error estimate for blocks of size 2^( 5) =       0.000417246809
  error estimate for blocks of size 2^( 6) =       0.000419601741
  error estimate for blocks of size 2^( 7) =       0.000420556508

      target function =                  N/A
              le_mean =     -17.216516286699
             les_mean =     296.729697220847
             stat err =       0.000417810306
             autocorr =       1.153872271930
              std dev =       0.550066602891
             le_variance =       0.302573267616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651628670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516286739       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516700716       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516712701       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516714147       residual = 1.48e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.903460e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516286739       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516391066       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516394123       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516394512       residual = 1.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 4.782334e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516286739       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516312874       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516313642       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516313741       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 1.197073e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6425e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.015663e-02 3 1  ON 0
ci_002                -2.986049e-02 3 1  ON 1
ci_003                -2.494633e-02 3 1  ON 2
ci_004                 2.086979e-02 3 1  ON 3
ci_005                 2.135685e-02 3 1  ON 4
ci_006                -1.910352e-02 3 1  ON 5
ci_007                -1.885082e-02 3 1  ON 6
ci_008                -1.780085e-02 3 1  ON 7
ci_009                -1.738184e-02 3 1  ON 8
ci_010                -1.731585e-02 3 1  ON 9
ci_011                -1.651016e-02 3 1  ON 10
ci_012                -1.652498e-02 3 1  ON 11
ci_013                -1.888797e-02 3 1  ON 12
ci_014                 1.309100e-02 3 1  ON 13
ci_015                 1.338824e-02 3 1  ON 14
ci_016                 1.632203e-02 3 1  ON 15
ci_017                 1.708007e-02 3 1  ON 16
ci_018                 1.259220e-02 3 1  ON 17
ci_019                 1.259246e-02 3 1  ON 18
ci_020                 1.302744e-02 3 1  ON 19
ci_021                 1.336879e-02 3 1  ON 20
ci_022                 1.176619e-02 3 1  ON 21
ci_023                 1.161419e-02 3 1  ON 22
ci_024                 1.154959e-02 3 1  ON 23
ci_025                 1.168739e-02 3 1  ON 24
ci_026                 1.109942e-02 3 1  ON 25
ci_027                 1.115977e-02 3 1  ON 26
ci_028                -1.515256e-02 3 1  ON 27
ci_029                -1.460181e-02 3 1  ON 28
ci_030                -1.115580e-02 3 1  ON 29
ci_031                -1.056436e-02 3 1  ON 30
ci_032                -1.340297e-02 3 1  ON 31
ci_033                 1.053251e-02 3 1  ON 32
ci_034                 9.977468e-03 3 1  ON 33
ci_035                -4.522681e-03 3 1  ON 34
ci_036                -1.085038e-02 3 1  ON 35
ci_037                -1.036854e-02 3 1  ON 36
ci_038                 1.541083e-03 3 1  ON 37
ci_039                 1.767133e-03 3 1  ON 38
ci_040                -3.972267e-03 3 1  ON 39
ci_041                 1.002326e-02 3 1  ON 40
ci_042                 1.028444e-02 3 1  ON 41
ci_043                -3.126723e-03 3 1  ON 42
ci_044                -1.554794e-02 3 1  ON 43
ci_045                -1.459506e-03 3 1  ON 44
ci_046                 5.034937e-03 3 1  ON 45
ci_047                 6.028797e-03 3 1  ON 46
ci_048                -1.196063e-02 3 1  ON 47
ci_049                -1.163415e-02 3 1  ON 48
ci_050                 7.711876e-03 3 1  ON 49
ci_051                 7.865484e-03 3 1  ON 50
ci_052                -6.683471e-03 3 1  ON 51
ci_053                -6.485870e-03 3 1  ON 52
ci_054                -2.434205e-03 3 1  ON 53
ci_055                -3.002988e-03 3 1  ON 54
ci_056                 4.120676e-03 3 1  ON 55
ci_057                 4.858533e-03 3 1  ON 56
ci_058                -6.386355e-03 3 1  ON 57
ci_059                -6.807531e-03 3 1  ON 58
ci_060                 8.850605e-03 3 1  ON 59
ci_061                 9.076904e-03 3 1  ON 60
ci_062                -3.609503e-03 3 1  ON 61
ci_063                -2.706571e-03 3 1  ON 62
ci_064                -3.141783e-03 3 1  ON 63
ci_065                -3.784975e-03 3 1  ON 64
ci_066                 5.243306e-03 3 1  ON 65
ci_067                 5.403488e-03 3 1  ON 66
ci_068                -4.791013e-03 3 1  ON 67
ci_069                -5.255617e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2354
    reference variance = 0.239812
====================================================
  Execution time = 1.3522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1165e-01
  Total weights = 1.9565e+06
  Execution time = 1.8468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297927166705
                                         uncertainty =       0.002041888170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297927166705
                                         uncertainty =       0.002041888170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891134
  error estimate for blocks of size 2^( 2) =       0.000395705783
  error estimate for blocks of size 2^( 3) =       0.000404834886
  error estimate for blocks of size 2^( 4) =       0.000411235962
  error estimate for blocks of size 2^( 5) =       0.000416422977
  error estimate for blocks of size 2^( 6) =       0.000418945950
  error estimate for blocks of size 2^( 7) =       0.000419680715

      target function =                  N/A
              le_mean =     -17.216732219016
             les_mean =     296.727582712828
             stat err =       0.000416571401
             autocorr =       1.165331005789
              std dev =       0.545732474671
             le_variance =       0.297823933910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297904436979
                                         uncertainty =       0.002041368721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297904436979
                                         uncertainty =       0.002041368721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385876419
  error estimate for blocks of size 2^( 2) =       0.000395691642
  error estimate for blocks of size 2^( 3) =       0.000404821090
  error estimate for blocks of size 2^( 4) =       0.000411222197
  error estimate for blocks of size 2^( 5) =       0.000416409174
  error estimate for blocks of size 2^( 6) =       0.000418931587
  error estimate for blocks of size 2^( 7) =       0.000419664918

      target function =                  N/A
              le_mean =     -17.216732461064
             les_mean =     296.727437198646
             stat err =       0.000416556969
             autocorr =       1.165339129460
              std dev =       0.545711665835
             le_variance =       0.297801222228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297915665450
                                         uncertainty =       0.002041623981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297915665450
                                         uncertainty =       0.002041623981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385883688
  error estimate for blocks of size 2^( 2) =       0.000395698627
  error estimate for blocks of size 2^( 3) =       0.000404827904
  error estimate for blocks of size 2^( 4) =       0.000411228996
  error estimate for blocks of size 2^( 5) =       0.000416415992
  error estimate for blocks of size 2^( 6) =       0.000418938684
  error estimate for blocks of size 2^( 7) =       0.000419672725

      target function =                  N/A
              le_mean =     -17.216732338966
             les_mean =     296.727480787046
             stat err =       0.000416564099
             autocorr =       1.165335120400
              std dev =       0.545721945485
             le_variance =       0.297812441784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297925722146
                                         uncertainty =       0.002041854830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297925722146
                                         uncertainty =       0.002041854830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385890198
  error estimate for blocks of size 2^( 2) =       0.000395704884
  error estimate for blocks of size 2^( 3) =       0.000404834009
  error estimate for blocks of size 2^( 4) =       0.000411235087
  error estimate for blocks of size 2^( 5) =       0.000416422100
  error estimate for blocks of size 2^( 6) =       0.000418945038
  error estimate for blocks of size 2^( 7) =       0.000419679712

      target function =                  N/A
              le_mean =     -17.216732233858
             les_mean =     296.727558867483
             stat err =       0.000416570484
             autocorr =       1.165331524187
              std dev =       0.545731152216
             le_variance =       0.297822490499


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216732219016        initial
     2.3283e+01     2.3283e+02             1.9035e-05       -17.216732461064  <--
     9.3132e+01     9.3132e+02             4.7823e-06       -17.216732338966
     3.7253e+02     3.7253e+03             1.1971e-06       -17.216732233858

*****************************************************************************
Applying the update for shift_i =   2.3283e+01     and shift_s =   2.3283e+02
*****************************************************************************

  Execution time = 2.2805e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087984e-02 3 1  ON 3
ci_005                 2.136137e-02 3 1  ON 4
ci_006                -1.910194e-02 3 1  ON 5
ci_007                -1.885098e-02 3 1  ON 6
ci_008                -1.779663e-02 3 1  ON 7
ci_009                -1.737755e-02 3 1  ON 8
ci_010                -1.730647e-02 3 1  ON 9
ci_011                -1.650835e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309439e-02 3 1  ON 13
ci_015                 1.339140e-02 3 1  ON 14
ci_016                 1.632386e-02 3 1  ON 15
ci_017                 1.708221e-02 3 1  ON 16
ci_018                 1.259361e-02 3 1  ON 17
ci_019                 1.259251e-02 3 1  ON 18
ci_020                 1.302608e-02 3 1  ON 19
ci_021                 1.336947e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155467e-02 3 1  ON 23
ci_025                 1.169439e-02 3 1  ON 24
ci_026                 1.109595e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514518e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340077e-02 3 1  ON 31
ci_033                 1.052760e-02 3 1  ON 32
ci_034                 9.979449e-03 3 1  ON 33
ci_035                -4.523057e-03 3 1  ON 34
ci_036                -1.085457e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546064e-03 3 1  ON 37
ci_039                 1.767782e-03 3 1  ON 38
ci_040                -3.967525e-03 3 1  ON 39
ci_041                 1.001781e-02 3 1  ON 40
ci_042                 1.028315e-02 3 1  ON 41
ci_043                -3.122580e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467716e-03 3 1  ON 44
ci_046                 5.036826e-03 3 1  ON 45
ci_047                 6.020499e-03 3 1  ON 46
ci_048                -1.195809e-02 3 1  ON 47
ci_049                -1.163290e-02 3 1  ON 48
ci_050                 7.702972e-03 3 1  ON 49
ci_051                 7.859641e-03 3 1  ON 50
ci_052                -6.683053e-03 3 1  ON 51
ci_053                -6.488513e-03 3 1  ON 52
ci_054                -2.433638e-03 3 1  ON 53
ci_055                -3.000044e-03 3 1  ON 54
ci_056                 4.128510e-03 3 1  ON 55
ci_057                 4.853732e-03 3 1  ON 56
ci_058                -6.390231e-03 3 1  ON 57
ci_059                -6.802662e-03 3 1  ON 58
ci_060                 8.846532e-03 3 1  ON 59
ci_061                 9.074128e-03 3 1  ON 60
ci_062                -3.602562e-03 3 1  ON 61
ci_063                -2.711832e-03 3 1  ON 62
ci_064                -3.136832e-03 3 1  ON 63
ci_065                -3.793617e-03 3 1  ON 64
ci_066                 5.245283e-03 3 1  ON 65
ci_067                 5.402137e-03 3 1  ON 66
ci_068                -4.793950e-03 3 1  ON 67
ci_069                -5.261155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0879
    reference variance = 0.727386
====================================================
  Execution time = 1.3693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1572e-01
  Total weights = 1.956382581e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301472279414
                                         uncertainty =       0.002304086130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301472279414
                                         uncertainty =       0.002304086130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388322351
  error estimate for blocks of size 2^( 2) =       0.000397885414
  error estimate for blocks of size 2^( 3) =       0.000407251292
  error estimate for blocks of size 2^( 4) =       0.000414131185
  error estimate for blocks of size 2^( 5) =       0.000418746303
  error estimate for blocks of size 2^( 6) =       0.000420461283
  error estimate for blocks of size 2^( 7) =       0.000422312379

      target function =                  N/A
              le_mean =     -17.216609422535
             les_mean =     296.727362446735
             stat err =       0.000418912788
             autocorr =       1.163757406100
              std dev =       0.549170736039
             le_variance =       0.301588497321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660942254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609422604       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609449722       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609459141       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+00 is 5.454030e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609422604       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609429603       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609431250       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 1.397107e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609422604       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609424368       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609424732       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 3.514412e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6226e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.015747e-02 3 1  ON 0
ci_002                -2.985852e-02 3 1  ON 1
ci_003                -2.494786e-02 3 1  ON 2
ci_004                 2.088256e-02 3 1  ON 3
ci_005                 2.135259e-02 3 1  ON 4
ci_006                -1.910216e-02 3 1  ON 5
ci_007                -1.886495e-02 3 1  ON 6
ci_008                -1.780011e-02 3 1  ON 7
ci_009                -1.738022e-02 3 1  ON 8
ci_010                -1.730485e-02 3 1  ON 9
ci_011                -1.650943e-02 3 1  ON 10
ci_012                -1.652315e-02 3 1  ON 11
ci_013                -1.889004e-02 3 1  ON 12
ci_014                 1.309793e-02 3 1  ON 13
ci_015                 1.339642e-02 3 1  ON 14
ci_016                 1.633024e-02 3 1  ON 15
ci_017                 1.707637e-02 3 1  ON 16
ci_018                 1.258791e-02 3 1  ON 17
ci_019                 1.259861e-02 3 1  ON 18
ci_020                 1.302020e-02 3 1  ON 19
ci_021                 1.336314e-02 3 1  ON 20
ci_022                 1.176878e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.154900e-02 3 1  ON 23
ci_025                 1.168738e-02 3 1  ON 24
ci_026                 1.109352e-02 3 1  ON 25
ci_027                 1.116197e-02 3 1  ON 26
ci_028                -1.513653e-02 3 1  ON 27
ci_029                -1.459379e-02 3 1  ON 28
ci_030                -1.114999e-02 3 1  ON 29
ci_031                -1.057612e-02 3 1  ON 30
ci_032                -1.340828e-02 3 1  ON 31
ci_033                 1.053490e-02 3 1  ON 32
ci_034                 9.991554e-03 3 1  ON 33
ci_035                -4.526838e-03 3 1  ON 34
ci_036                -1.085433e-02 3 1  ON 35
ci_037                -1.036587e-02 3 1  ON 36
ci_038                 1.550617e-03 3 1  ON 37
ci_039                 1.763603e-03 3 1  ON 38
ci_040                -3.971912e-03 3 1  ON 39
ci_041                 1.001751e-02 3 1  ON 40
ci_042                 1.027998e-02 3 1  ON 41
ci_043                -3.121289e-03 3 1  ON 42
ci_044                -1.553321e-02 3 1  ON 43
ci_045                -1.468485e-03 3 1  ON 44
ci_046                 5.037251e-03 3 1  ON 45
ci_047                 6.015338e-03 3 1  ON 46
ci_048                -1.195352e-02 3 1  ON 47
ci_049                -1.163364e-02 3 1  ON 48
ci_050                 7.704341e-03 3 1  ON 49
ci_051                 7.850435e-03 3 1  ON 50
ci_052                -6.681633e-03 3 1  ON 51
ci_053                -6.493474e-03 3 1  ON 52
ci_054                -2.432559e-03 3 1  ON 53
ci_055                -3.001774e-03 3 1  ON 54
ci_056                 4.126974e-03 3 1  ON 55
ci_057                 4.848625e-03 3 1  ON 56
ci_058                -6.390398e-03 3 1  ON 57
ci_059                -6.800326e-03 3 1  ON 58
ci_060                 8.843545e-03 3 1  ON 59
ci_061                 9.066191e-03 3 1  ON 60
ci_062                -3.592402e-03 3 1  ON 61
ci_063                -2.706498e-03 3 1  ON 62
ci_064                -3.141862e-03 3 1  ON 63
ci_065                -3.801914e-03 3 1  ON 64
ci_066                 5.257243e-03 3 1  ON 65
ci_067                 5.409357e-03 3 1  ON 66
ci_068                -4.801115e-03 3 1  ON 67
ci_069                -5.254570e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.161
    reference variance = 0.21639
====================================================
  Execution time = 1.3262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2417e-01
  Total weights = 1.9565e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304892678115
                                         uncertainty =       0.004134246842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304892678115
                                         uncertainty =       0.004134246842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390397351
  error estimate for blocks of size 2^( 2) =       0.000399916729
  error estimate for blocks of size 2^( 3) =       0.000409352121
  error estimate for blocks of size 2^( 4) =       0.000416258433
  error estimate for blocks of size 2^( 5) =       0.000420483338
  error estimate for blocks of size 2^( 6) =       0.000423702737
  error estimate for blocks of size 2^( 7) =       0.000424290798

      target function =                  N/A
              le_mean =     -17.215604220017
             les_mean =     296.701234964328
             stat err =       0.000421183827
             autocorr =       1.163937462046
              std dev =       0.552105229182
             le_variance =       0.304820184090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304909869513
                                         uncertainty =       0.004126446068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304909869513
                                         uncertainty =       0.004126446068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390408363
  error estimate for blocks of size 2^( 2) =       0.000399926711
  error estimate for blocks of size 2^( 3) =       0.000409361367
  error estimate for blocks of size 2^( 4) =       0.000416267243
  error estimate for blocks of size 2^( 5) =       0.000420491889
  error estimate for blocks of size 2^( 6) =       0.000423709615
  error estimate for blocks of size 2^( 7) =       0.000424295239

      target function =                  N/A
              le_mean =     -17.215604014461
             les_mean =     296.701150993068
             stat err =       0.000421190996
             autocorr =       1.163911432587
              std dev =       0.552120801491
             le_variance =       0.304837379439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304901365389
                                         uncertainty =       0.004130166327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304901365389
                                         uncertainty =       0.004130166327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390402916
  error estimate for blocks of size 2^( 2) =       0.000399921755
  error estimate for blocks of size 2^( 3) =       0.000409356766
  error estimate for blocks of size 2^( 4) =       0.000416262853
  error estimate for blocks of size 2^( 5) =       0.000420487620
  error estimate for blocks of size 2^( 6) =       0.000423706146
  error estimate for blocks of size 2^( 7) =       0.000424292929

      target function =                  N/A
              le_mean =     -17.215604100464
             les_mean =     296.701173900681
             stat err =       0.000421187387
             autocorr =       1.163923961553
              std dev =       0.552113098588
             le_variance =       0.304828873632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304893749685
                                         uncertainty =       0.004133728026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304893749685
                                         uncertainty =       0.004133728026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390398038
  error estimate for blocks of size 2^( 2) =       0.000399917348
  error estimate for blocks of size 2^( 3) =       0.000409352692
  error estimate for blocks of size 2^( 4) =       0.000416258975
  error estimate for blocks of size 2^( 5) =       0.000420483861
  error estimate for blocks of size 2^( 6) =       0.000423703150
  error estimate for blocks of size 2^( 7) =       0.000424291049

      target function =                  N/A
              le_mean =     -17.215604203337
             les_mean =     296.701223038237
             stat err =       0.000421184259
             autocorr =       1.163935758956
              std dev =       0.552106199908
             le_variance =       0.304821255976


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215604220017        initial  <--
     5.8208e+00     5.8208e+01             5.4540e-05       -17.215604014461
     2.3283e+01     2.3283e+02             1.3971e-05       -17.215604100464
     9.3132e+01     9.3132e+02             3.5144e-06       -17.215604203337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4720
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087984e-02 3 1  ON 3
ci_005                 2.136137e-02 3 1  ON 4
ci_006                -1.910194e-02 3 1  ON 5
ci_007                -1.885098e-02 3 1  ON 6
ci_008                -1.779663e-02 3 1  ON 7
ci_009                -1.737755e-02 3 1  ON 8
ci_010                -1.730647e-02 3 1  ON 9
ci_011                -1.650835e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309439e-02 3 1  ON 13
ci_015                 1.339140e-02 3 1  ON 14
ci_016                 1.632386e-02 3 1  ON 15
ci_017                 1.708221e-02 3 1  ON 16
ci_018                 1.259361e-02 3 1  ON 17
ci_019                 1.259251e-02 3 1  ON 18
ci_020                 1.302608e-02 3 1  ON 19
ci_021                 1.336947e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155467e-02 3 1  ON 23
ci_025                 1.169439e-02 3 1  ON 24
ci_026                 1.109595e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514518e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340077e-02 3 1  ON 31
ci_033                 1.052760e-02 3 1  ON 32
ci_034                 9.979449e-03 3 1  ON 33
ci_035                -4.523057e-03 3 1  ON 34
ci_036                -1.085457e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546064e-03 3 1  ON 37
ci_039                 1.767782e-03 3 1  ON 38
ci_040                -3.967525e-03 3 1  ON 39
ci_041                 1.001781e-02 3 1  ON 40
ci_042                 1.028315e-02 3 1  ON 41
ci_043                -3.122580e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467716e-03 3 1  ON 44
ci_046                 5.036826e-03 3 1  ON 45
ci_047                 6.020499e-03 3 1  ON 46
ci_048                -1.195809e-02 3 1  ON 47
ci_049                -1.163290e-02 3 1  ON 48
ci_050                 7.702972e-03 3 1  ON 49
ci_051                 7.859641e-03 3 1  ON 50
ci_052                -6.683053e-03 3 1  ON 51
ci_053                -6.488513e-03 3 1  ON 52
ci_054                -2.433638e-03 3 1  ON 53
ci_055                -3.000044e-03 3 1  ON 54
ci_056                 4.128510e-03 3 1  ON 55
ci_057                 4.853732e-03 3 1  ON 56
ci_058                -6.390231e-03 3 1  ON 57
ci_059                -6.802662e-03 3 1  ON 58
ci_060                 8.846532e-03 3 1  ON 59
ci_061                 9.074128e-03 3 1  ON 60
ci_062                -3.602562e-03 3 1  ON 61
ci_063                -2.711832e-03 3 1  ON 62
ci_064                -3.136832e-03 3 1  ON 63
ci_065                -3.793617e-03 3 1  ON 64
ci_066                 5.245283e-03 3 1  ON 65
ci_067                 5.402137e-03 3 1  ON 66
ci_068                -4.793950e-03 3 1  ON 67
ci_069                -5.261155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.262644
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1396e-01
  Total weights = 1.956521810e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300944293705
                                         uncertainty =       0.001974028886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300944293705
                                         uncertainty =       0.001974028886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387945712
  error estimate for blocks of size 2^( 2) =       0.000397735722
  error estimate for blocks of size 2^( 3) =       0.000407046423
  error estimate for blocks of size 2^( 4) =       0.000413644199
  error estimate for blocks of size 2^( 5) =       0.000418415594
  error estimate for blocks of size 2^( 6) =       0.000422084834
  error estimate for blocks of size 2^( 7) =       0.000423592088

      target function =                  N/A
              le_mean =     -17.216934968242
             les_mean =     296.736807020660
             stat err =       0.000419434179
             autocorr =       1.168922512183
              std dev =       0.548638087235
             le_variance =       0.301003750765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693496824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216934968302       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216934953692       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216934949001       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216934948844       residual = 1.13e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 6.486133e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216934968302       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216934964636       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216934963458       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216934963417       residual = 1.16e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 1.627792e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216934968302       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216934967385       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216934967090       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216934967079       residual = 1.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 4.073411e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.2618e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.015409e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495031e-02 3 1  ON 2
ci_004                 2.087996e-02 3 1  ON 3
ci_005                 2.136124e-02 3 1  ON 4
ci_006                -1.910178e-02 3 1  ON 5
ci_007                -1.885038e-02 3 1  ON 6
ci_008                -1.779732e-02 3 1  ON 7
ci_009                -1.737862e-02 3 1  ON 8
ci_010                -1.730642e-02 3 1  ON 9
ci_011                -1.650756e-02 3 1  ON 10
ci_012                -1.652882e-02 3 1  ON 11
ci_013                -1.889444e-02 3 1  ON 12
ci_014                 1.309567e-02 3 1  ON 13
ci_015                 1.339178e-02 3 1  ON 14
ci_016                 1.632380e-02 3 1  ON 15
ci_017                 1.708165e-02 3 1  ON 16
ci_018                 1.259329e-02 3 1  ON 17
ci_019                 1.259256e-02 3 1  ON 18
ci_020                 1.302686e-02 3 1  ON 19
ci_021                 1.337001e-02 3 1  ON 20
ci_022                 1.176973e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155500e-02 3 1  ON 23
ci_025                 1.169517e-02 3 1  ON 24
ci_026                 1.109652e-02 3 1  ON 25
ci_027                 1.115436e-02 3 1  ON 26
ci_028                -1.514493e-02 3 1  ON 27
ci_029                -1.460056e-02 3 1  ON 28
ci_030                -1.114937e-02 3 1  ON 29
ci_031                -1.057617e-02 3 1  ON 30
ci_032                -1.340180e-02 3 1  ON 31
ci_033                 1.052760e-02 3 1  ON 32
ci_034                 9.979952e-03 3 1  ON 33
ci_035                -4.523520e-03 3 1  ON 34
ci_036                -1.085482e-02 3 1  ON 35
ci_037                -1.037116e-02 3 1  ON 36
ci_038                 1.546207e-03 3 1  ON 37
ci_039                 1.767501e-03 3 1  ON 38
ci_040                -3.967529e-03 3 1  ON 39
ci_041                 1.001755e-02 3 1  ON 40
ci_042                 1.028294e-02 3 1  ON 41
ci_043                -3.122471e-03 3 1  ON 42
ci_044                -1.553327e-02 3 1  ON 43
ci_045                -1.467905e-03 3 1  ON 44
ci_046                 5.037483e-03 3 1  ON 45
ci_047                 6.019958e-03 3 1  ON 46
ci_048                -1.195765e-02 3 1  ON 47
ci_049                -1.163265e-02 3 1  ON 48
ci_050                 7.701976e-03 3 1  ON 49
ci_051                 7.859106e-03 3 1  ON 50
ci_052                -6.682560e-03 3 1  ON 51
ci_053                -6.489116e-03 3 1  ON 52
ci_054                -2.435266e-03 3 1  ON 53
ci_055                -2.999977e-03 3 1  ON 54
ci_056                 4.128471e-03 3 1  ON 55
ci_057                 4.854147e-03 3 1  ON 56
ci_058                -6.390281e-03 3 1  ON 57
ci_059                -6.801804e-03 3 1  ON 58
ci_060                 8.845687e-03 3 1  ON 59
ci_061                 9.074201e-03 3 1  ON 60
ci_062                -3.601865e-03 3 1  ON 61
ci_063                -2.713435e-03 3 1  ON 62
ci_064                -3.136194e-03 3 1  ON 63
ci_065                -3.795080e-03 3 1  ON 64
ci_066                 5.246889e-03 3 1  ON 65
ci_067                 5.402008e-03 3 1  ON 66
ci_068                -4.794206e-03 3 1  ON 67
ci_069                -5.261029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.246523
====================================================
  Execution time = 1.3785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1587e-01
  Total weights = 1.9565e+06
  Execution time = 2.2397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777414900
                                         uncertainty =       0.002125965965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777414900
                                         uncertainty =       0.002125965965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768054
  error estimate for blocks of size 2^( 2) =       0.000397653097
  error estimate for blocks of size 2^( 3) =       0.000406394862
  error estimate for blocks of size 2^( 4) =       0.000413105313
  error estimate for blocks of size 2^( 5) =       0.000417488498
  error estimate for blocks of size 2^( 6) =       0.000419212811
  error estimate for blocks of size 2^( 7) =       0.000421028323

      target function =                  N/A
              le_mean =     -17.216613712928
             les_mean =     296.727660540497
             stat err =       0.000417708736
             autocorr =       1.160387556691
              std dev =       0.548386840423
             le_variance =       0.300728126749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777657778
                                         uncertainty =       0.002125980166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777657778
                                         uncertainty =       0.002125980166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768207
  error estimate for blocks of size 2^( 2) =       0.000397653192
  error estimate for blocks of size 2^( 3) =       0.000406394879
  error estimate for blocks of size 2^( 4) =       0.000413105346
  error estimate for blocks of size 2^( 5) =       0.000417488540
  error estimate for blocks of size 2^( 6) =       0.000419212590
  error estimate for blocks of size 2^( 7) =       0.000421028070

      target function =                  N/A
              le_mean =     -17.216613676235
             les_mean =     296.727664089414
             stat err =       0.000417708637
             autocorr =       1.160386084266
              std dev =       0.548387057829
             le_variance =       0.300728365195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777533967
                                         uncertainty =       0.002125973050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777533967
                                         uncertainty =       0.002125973050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768129
  error estimate for blocks of size 2^( 2) =       0.000397653143
  error estimate for blocks of size 2^( 3) =       0.000406394868
  error estimate for blocks of size 2^( 4) =       0.000413105327
  error estimate for blocks of size 2^( 5) =       0.000417488517
  error estimate for blocks of size 2^( 6) =       0.000419212698
  error estimate for blocks of size 2^( 7) =       0.000421028194

      target function =                  N/A
              le_mean =     -17.216613694267
             les_mean =     296.727658950749
             stat err =       0.000417708684
             autocorr =       1.160386816423
              std dev =       0.548386946957
             le_variance =       0.300728243593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777429513
                                         uncertainty =       0.002125966847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777429513
                                         uncertainty =       0.002125966847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387768063
  error estimate for blocks of size 2^( 2) =       0.000397653103
  error estimate for blocks of size 2^( 3) =       0.000406394863
  error estimate for blocks of size 2^( 4) =       0.000413105314
  error estimate for blocks of size 2^( 5) =       0.000417488500
  error estimate for blocks of size 2^( 6) =       0.000419212797
  error estimate for blocks of size 2^( 7) =       0.000421028307

      target function =                  N/A
              le_mean =     -17.216613710569
             les_mean =     296.727660110093
             stat err =       0.000417708729
             autocorr =       1.160387464041
              std dev =       0.548386853493
             le_variance =       0.300728141084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216613712928        initial  <--
     5.8208e+01     5.8208e+02             6.4861e-06       -17.216613676235
     2.3283e+02     2.3283e+03             1.6278e-06       -17.216613694267
     9.3132e+02     9.3132e+03             4.0734e-07       -17.216613710569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7737
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087984e-02 3 1  ON 3
ci_005                 2.136137e-02 3 1  ON 4
ci_006                -1.910194e-02 3 1  ON 5
ci_007                -1.885098e-02 3 1  ON 6
ci_008                -1.779663e-02 3 1  ON 7
ci_009                -1.737755e-02 3 1  ON 8
ci_010                -1.730647e-02 3 1  ON 9
ci_011                -1.650835e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309439e-02 3 1  ON 13
ci_015                 1.339140e-02 3 1  ON 14
ci_016                 1.632386e-02 3 1  ON 15
ci_017                 1.708221e-02 3 1  ON 16
ci_018                 1.259361e-02 3 1  ON 17
ci_019                 1.259251e-02 3 1  ON 18
ci_020                 1.302608e-02 3 1  ON 19
ci_021                 1.336947e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155467e-02 3 1  ON 23
ci_025                 1.169439e-02 3 1  ON 24
ci_026                 1.109595e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514518e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340077e-02 3 1  ON 31
ci_033                 1.052760e-02 3 1  ON 32
ci_034                 9.979449e-03 3 1  ON 33
ci_035                -4.523057e-03 3 1  ON 34
ci_036                -1.085457e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546064e-03 3 1  ON 37
ci_039                 1.767782e-03 3 1  ON 38
ci_040                -3.967525e-03 3 1  ON 39
ci_041                 1.001781e-02 3 1  ON 40
ci_042                 1.028315e-02 3 1  ON 41
ci_043                -3.122580e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467716e-03 3 1  ON 44
ci_046                 5.036826e-03 3 1  ON 45
ci_047                 6.020499e-03 3 1  ON 46
ci_048                -1.195809e-02 3 1  ON 47
ci_049                -1.163290e-02 3 1  ON 48
ci_050                 7.702972e-03 3 1  ON 49
ci_051                 7.859641e-03 3 1  ON 50
ci_052                -6.683053e-03 3 1  ON 51
ci_053                -6.488513e-03 3 1  ON 52
ci_054                -2.433638e-03 3 1  ON 53
ci_055                -3.000044e-03 3 1  ON 54
ci_056                 4.128510e-03 3 1  ON 55
ci_057                 4.853732e-03 3 1  ON 56
ci_058                -6.390231e-03 3 1  ON 57
ci_059                -6.802662e-03 3 1  ON 58
ci_060                 8.846532e-03 3 1  ON 59
ci_061                 9.074128e-03 3 1  ON 60
ci_062                -3.602562e-03 3 1  ON 61
ci_063                -2.711832e-03 3 1  ON 62
ci_064                -3.136832e-03 3 1  ON 63
ci_065                -3.793617e-03 3 1  ON 64
ci_066                 5.245283e-03 3 1  ON 65
ci_067                 5.402137e-03 3 1  ON 66
ci_068                -4.793950e-03 3 1  ON 67
ci_069                -5.261155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.0024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2839
    reference variance = 0.374403
====================================================
  Execution time = 1.5099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1551e-01
  Total weights = 1.956737695e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301194122227
                                         uncertainty =       0.002363072091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301194122227
                                         uncertainty =       0.002363072091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385085
  error estimate for blocks of size 2^( 2) =       0.000398532984
  error estimate for blocks of size 2^( 3) =       0.000407442732
  error estimate for blocks of size 2^( 4) =       0.000413917979
  error estimate for blocks of size 2^( 5) =       0.000417509363
  error estimate for blocks of size 2^( 6) =       0.000420669144
  error estimate for blocks of size 2^( 7) =       0.000422809833

      target function =                  N/A
              le_mean =     -17.216878624260
             les_mean =     296.736422123223
             stat err =       0.000418726580
             autocorr =       1.162347461816
              std dev =       0.549259455139
             le_variance =       0.301685949060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687862426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878624284       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216878619723       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216878619028       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216878618992       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 6.292290e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878624284       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216878623143       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216878622969       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216878622960       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 1.573698e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216878624284       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216878623999       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216878623955       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216878623953       residual = 2.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 3.934636e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7618e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.015428e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087980e-02 3 1  ON 3
ci_005                 2.136136e-02 3 1  ON 4
ci_006                -1.910190e-02 3 1  ON 5
ci_007                -1.885090e-02 3 1  ON 6
ci_008                -1.779667e-02 3 1  ON 7
ci_009                -1.737751e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650833e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889358e-02 3 1  ON 12
ci_014                 1.309450e-02 3 1  ON 13
ci_015                 1.339148e-02 3 1  ON 14
ci_016                 1.632383e-02 3 1  ON 15
ci_017                 1.708222e-02 3 1  ON 16
ci_018                 1.259359e-02 3 1  ON 17
ci_019                 1.259251e-02 3 1  ON 18
ci_020                 1.302613e-02 3 1  ON 19
ci_021                 1.336942e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160782e-02 3 1  ON 22
ci_024                 1.155463e-02 3 1  ON 23
ci_025                 1.169444e-02 3 1  ON 24
ci_026                 1.109597e-02 3 1  ON 25
ci_027                 1.115478e-02 3 1  ON 26
ci_028                -1.514513e-02 3 1  ON 27
ci_029                -1.460052e-02 3 1  ON 28
ci_030                -1.114959e-02 3 1  ON 29
ci_031                -1.057496e-02 3 1  ON 30
ci_032                -1.340073e-02 3 1  ON 31
ci_033                 1.052754e-02 3 1  ON 32
ci_034                 9.979453e-03 3 1  ON 33
ci_035                -4.523031e-03 3 1  ON 34
ci_036                -1.085449e-02 3 1  ON 35
ci_037                -1.037077e-02 3 1  ON 36
ci_038                 1.546078e-03 3 1  ON 37
ci_039                 1.767687e-03 3 1  ON 38
ci_040                -3.967548e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028308e-02 3 1  ON 41
ci_043                -3.122543e-03 3 1  ON 42
ci_044                -1.553367e-02 3 1  ON 43
ci_045                -1.467715e-03 3 1  ON 44
ci_046                 5.036856e-03 3 1  ON 45
ci_047                 6.020419e-03 3 1  ON 46
ci_048                -1.195803e-02 3 1  ON 47
ci_049                -1.163293e-02 3 1  ON 48
ci_050                 7.702963e-03 3 1  ON 49
ci_051                 7.859643e-03 3 1  ON 50
ci_052                -6.683107e-03 3 1  ON 51
ci_053                -6.488670e-03 3 1  ON 52
ci_054                -2.433706e-03 3 1  ON 53
ci_055                -3.000037e-03 3 1  ON 54
ci_056                 4.128569e-03 3 1  ON 55
ci_057                 4.853774e-03 3 1  ON 56
ci_058                -6.390166e-03 3 1  ON 57
ci_059                -6.802698e-03 3 1  ON 58
ci_060                 8.846454e-03 3 1  ON 59
ci_061                 9.074163e-03 3 1  ON 60
ci_062                -3.602540e-03 3 1  ON 61
ci_063                -2.711819e-03 3 1  ON 62
ci_064                -3.136780e-03 3 1  ON 63
ci_065                -3.793691e-03 3 1  ON 64
ci_066                 5.245329e-03 3 1  ON 65
ci_067                 5.402226e-03 3 1  ON 66
ci_068                -4.793930e-03 3 1  ON 67
ci_069                -5.261152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.189286
====================================================
  Execution time = 1.3869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1234e-01
  Total weights = 1.9567e+06
  Execution time = 1.8408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588860675
                                         uncertainty =       0.002073159966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588860675
                                         uncertainty =       0.002073159966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387629824
  error estimate for blocks of size 2^( 2) =       0.000397768799
  error estimate for blocks of size 2^( 3) =       0.000407180726
  error estimate for blocks of size 2^( 4) =       0.000413661279
  error estimate for blocks of size 2^( 5) =       0.000417472571
  error estimate for blocks of size 2^( 6) =       0.000419515428
  error estimate for blocks of size 2^( 7) =       0.000421682581

      target function =                  N/A
              le_mean =     -17.216486530938
             les_mean =     296.719752657626
             stat err =       0.000418082965
             autocorr =       1.163296912595
              std dev =       0.548191354724
             le_variance =       0.300513761394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589163918
                                         uncertainty =       0.002073162770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589163918
                                         uncertainty =       0.002073162770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387630020
  error estimate for blocks of size 2^( 2) =       0.000397768988
  error estimate for blocks of size 2^( 3) =       0.000407180913
  error estimate for blocks of size 2^( 4) =       0.000413661451
  error estimate for blocks of size 2^( 5) =       0.000417472740
  error estimate for blocks of size 2^( 6) =       0.000419515586
  error estimate for blocks of size 2^( 7) =       0.000421682735

      target function =                  N/A
              le_mean =     -17.216486522382
             les_mean =     296.719752179945
             stat err =       0.000418083128
             autocorr =       1.163296648231
              std dev =       0.548191631269
             le_variance =       0.300514064593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589012339
                                         uncertainty =       0.002073161369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300589012339
                                         uncertainty =       0.002073161369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387629922
  error estimate for blocks of size 2^( 2) =       0.000397768894
  error estimate for blocks of size 2^( 3) =       0.000407180820
  error estimate for blocks of size 2^( 4) =       0.000413661365
  error estimate for blocks of size 2^( 5) =       0.000417472656
  error estimate for blocks of size 2^( 6) =       0.000419515507
  error estimate for blocks of size 2^( 7) =       0.000421682658

      target function =                  N/A
              le_mean =     -17.216486526656
             les_mean =     296.719752416091
             stat err =       0.000418083046
             autocorr =       1.163296780363
              std dev =       0.548191493035
             le_variance =       0.300513913036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588879633
                                         uncertainty =       0.002073160141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300588879633
                                         uncertainty =       0.002073160141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387629837
  error estimate for blocks of size 2^( 2) =       0.000397768811
  error estimate for blocks of size 2^( 3) =       0.000407180738
  error estimate for blocks of size 2^( 4) =       0.000413661290
  error estimate for blocks of size 2^( 5) =       0.000417472582
  error estimate for blocks of size 2^( 6) =       0.000419515438
  error estimate for blocks of size 2^( 7) =       0.000421682591

      target function =                  N/A
              le_mean =     -17.216486530403
             les_mean =     296.719752627144
             stat err =       0.000418082975
             autocorr =       1.163296896068
              std dev =       0.548191372013
             le_variance =       0.300513780349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216486530938        initial  <--
     5.8208e+02     5.8208e+03             6.2923e-07       -17.216486522382
     2.3283e+03     2.3283e+04             1.5737e-07       -17.216486526656
     9.3132e+03     9.3132e+04             3.9346e-08       -17.216486530403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1233
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087984e-02 3 1  ON 3
ci_005                 2.136137e-02 3 1  ON 4
ci_006                -1.910194e-02 3 1  ON 5
ci_007                -1.885098e-02 3 1  ON 6
ci_008                -1.779663e-02 3 1  ON 7
ci_009                -1.737755e-02 3 1  ON 8
ci_010                -1.730647e-02 3 1  ON 9
ci_011                -1.650835e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309439e-02 3 1  ON 13
ci_015                 1.339140e-02 3 1  ON 14
ci_016                 1.632386e-02 3 1  ON 15
ci_017                 1.708221e-02 3 1  ON 16
ci_018                 1.259361e-02 3 1  ON 17
ci_019                 1.259251e-02 3 1  ON 18
ci_020                 1.302608e-02 3 1  ON 19
ci_021                 1.336947e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155467e-02 3 1  ON 23
ci_025                 1.169439e-02 3 1  ON 24
ci_026                 1.109595e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514518e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340077e-02 3 1  ON 31
ci_033                 1.052760e-02 3 1  ON 32
ci_034                 9.979449e-03 3 1  ON 33
ci_035                -4.523057e-03 3 1  ON 34
ci_036                -1.085457e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546064e-03 3 1  ON 37
ci_039                 1.767782e-03 3 1  ON 38
ci_040                -3.967525e-03 3 1  ON 39
ci_041                 1.001781e-02 3 1  ON 40
ci_042                 1.028315e-02 3 1  ON 41
ci_043                -3.122580e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467716e-03 3 1  ON 44
ci_046                 5.036826e-03 3 1  ON 45
ci_047                 6.020499e-03 3 1  ON 46
ci_048                -1.195809e-02 3 1  ON 47
ci_049                -1.163290e-02 3 1  ON 48
ci_050                 7.702972e-03 3 1  ON 49
ci_051                 7.859641e-03 3 1  ON 50
ci_052                -6.683053e-03 3 1  ON 51
ci_053                -6.488513e-03 3 1  ON 52
ci_054                -2.433638e-03 3 1  ON 53
ci_055                -3.000044e-03 3 1  ON 54
ci_056                 4.128510e-03 3 1  ON 55
ci_057                 4.853732e-03 3 1  ON 56
ci_058                -6.390231e-03 3 1  ON 57
ci_059                -6.802662e-03 3 1  ON 58
ci_060                 8.846532e-03 3 1  ON 59
ci_061                 9.074128e-03 3 1  ON 60
ci_062                -3.602562e-03 3 1  ON 61
ci_063                -2.711832e-03 3 1  ON 62
ci_064                -3.136832e-03 3 1  ON 63
ci_065                -3.793617e-03 3 1  ON 64
ci_066                 5.245283e-03 3 1  ON 65
ci_067                 5.402137e-03 3 1  ON 66
ci_068                -4.793950e-03 3 1  ON 67
ci_069                -5.261155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.243401
====================================================
  Execution time = 1.3808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1506e-01
  Total weights = 1.956644330e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299913806320
                                         uncertainty =       0.001937132210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299913806320
                                         uncertainty =       0.001937132210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387263967
  error estimate for blocks of size 2^( 2) =       0.000397466156
  error estimate for blocks of size 2^( 3) =       0.000406911237
  error estimate for blocks of size 2^( 4) =       0.000413776769
  error estimate for blocks of size 2^( 5) =       0.000418159882
  error estimate for blocks of size 2^( 6) =       0.000421534199
  error estimate for blocks of size 2^( 7) =       0.000424486041

      target function =                  N/A
              le_mean =     -17.216806029666
             les_mean =     296.733473983736
             stat err =       0.000419489223
             autocorr =       1.173349613833
              std dev =       0.547673954891
             le_variance =       0.299946760866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680602967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806029714       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806030519       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806030537       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806030536       residual = 5.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 6.843605e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806029714       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806029916       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806029920       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806029920       residual = 5.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.711009e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216806029714       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216806029765       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216806029766       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806029766       residual = 5.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 4.277591e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6289e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087983e-02 3 1  ON 3
ci_005                 2.136138e-02 3 1  ON 4
ci_006                -1.910194e-02 3 1  ON 5
ci_007                -1.885098e-02 3 1  ON 6
ci_008                -1.779664e-02 3 1  ON 7
ci_009                -1.737756e-02 3 1  ON 8
ci_010                -1.730648e-02 3 1  ON 9
ci_011                -1.650834e-02 3 1  ON 10
ci_012                -1.652862e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309440e-02 3 1  ON 13
ci_015                 1.339139e-02 3 1  ON 14
ci_016                 1.632386e-02 3 1  ON 15
ci_017                 1.708220e-02 3 1  ON 16
ci_018                 1.259361e-02 3 1  ON 17
ci_019                 1.259252e-02 3 1  ON 18
ci_020                 1.302608e-02 3 1  ON 19
ci_021                 1.336946e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155469e-02 3 1  ON 23
ci_025                 1.169439e-02 3 1  ON 24
ci_026                 1.109594e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514516e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340078e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979449e-03 3 1  ON 33
ci_035                -4.523062e-03 3 1  ON 34
ci_036                -1.085456e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546059e-03 3 1  ON 37
ci_039                 1.767779e-03 3 1  ON 38
ci_040                -3.967514e-03 3 1  ON 39
ci_041                 1.001781e-02 3 1  ON 40
ci_042                 1.028315e-02 3 1  ON 41
ci_043                -3.122584e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467718e-03 3 1  ON 44
ci_046                 5.036827e-03 3 1  ON 45
ci_047                 6.020498e-03 3 1  ON 46
ci_048                -1.195808e-02 3 1  ON 47
ci_049                -1.163289e-02 3 1  ON 48
ci_050                 7.702980e-03 3 1  ON 49
ci_051                 7.859641e-03 3 1  ON 50
ci_052                -6.683054e-03 3 1  ON 51
ci_053                -6.488503e-03 3 1  ON 52
ci_054                -2.433640e-03 3 1  ON 53
ci_055                -3.000047e-03 3 1  ON 54
ci_056                 4.128525e-03 3 1  ON 55
ci_057                 4.853726e-03 3 1  ON 56
ci_058                -6.390229e-03 3 1  ON 57
ci_059                -6.802659e-03 3 1  ON 58
ci_060                 8.846521e-03 3 1  ON 59
ci_061                 9.074126e-03 3 1  ON 60
ci_062                -3.602551e-03 3 1  ON 61
ci_063                -2.711836e-03 3 1  ON 62
ci_064                -3.136833e-03 3 1  ON 63
ci_065                -3.793634e-03 3 1  ON 64
ci_066                 5.245290e-03 3 1  ON 65
ci_067                 5.402147e-03 3 1  ON 66
ci_068                -4.793957e-03 3 1  ON 67
ci_069                -5.261152e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.175514
====================================================
  Execution time = 1.3658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0822e-01
  Total weights = 1.9567e+06
  Execution time = 1.8427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872335748
                                         uncertainty =       0.001913410494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872335748
                                         uncertainty =       0.001913410494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385279957
  error estimate for blocks of size 2^( 2) =       0.000395339337
  error estimate for blocks of size 2^( 3) =       0.000404567365
  error estimate for blocks of size 2^( 4) =       0.000410998420
  error estimate for blocks of size 2^( 5) =       0.000416119986
  error estimate for blocks of size 2^( 6) =       0.000418945635
  error estimate for blocks of size 2^( 7) =       0.000419336537

      target function =                  N/A
              le_mean =     -17.216193206344
             les_mean =     296.705524823822
             stat err =       0.000416350144
             autocorr =       1.167789605143
              std dev =       0.544868140681
             le_variance =       0.296881290730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872359959
                                         uncertainty =       0.001913411180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872359959
                                         uncertainty =       0.001913411180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385279973
  error estimate for blocks of size 2^( 2) =       0.000395339351
  error estimate for blocks of size 2^( 3) =       0.000404567378
  error estimate for blocks of size 2^( 4) =       0.000410998433
  error estimate for blocks of size 2^( 5) =       0.000416119997
  error estimate for blocks of size 2^( 6) =       0.000418945645
  error estimate for blocks of size 2^( 7) =       0.000419336546

      target function =                  N/A
              le_mean =     -17.216193206550
             les_mean =     296.705524889998
             stat err =       0.000416350155
             autocorr =       1.167789571895
              std dev =       0.544868162907
             le_variance =       0.296881314949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872347854
                                         uncertainty =       0.001913410837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872347854
                                         uncertainty =       0.001913410837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385279965
  error estimate for blocks of size 2^( 2) =       0.000395339344
  error estimate for blocks of size 2^( 3) =       0.000404567371
  error estimate for blocks of size 2^( 4) =       0.000410998426
  error estimate for blocks of size 2^( 5) =       0.000416119992
  error estimate for blocks of size 2^( 6) =       0.000418945640
  error estimate for blocks of size 2^( 7) =       0.000419336541

      target function =                  N/A
              le_mean =     -17.216193206447
             les_mean =     296.705524856882
             stat err =       0.000416350150
             autocorr =       1.167789588517
              std dev =       0.544868151794
             le_variance =       0.296881302840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872337262
                                         uncertainty =       0.001913410537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296872337262
                                         uncertainty =       0.001913410537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385279958
  error estimate for blocks of size 2^( 2) =       0.000395339338
  error estimate for blocks of size 2^( 3) =       0.000404567366
  error estimate for blocks of size 2^( 4) =       0.000410998421
  error estimate for blocks of size 2^( 5) =       0.000416119987
  error estimate for blocks of size 2^( 6) =       0.000418945635
  error estimate for blocks of size 2^( 7) =       0.000419336537

      target function =                  N/A
              le_mean =     -17.216193206357
             les_mean =     296.705524827951
             stat err =       0.000416350145
             autocorr =       1.167789603067
              std dev =       0.544868142070
             le_variance =       0.296881292243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216193206344        initial
     5.8208e+03     5.8208e+04             6.8436e-08       -17.216193206550  <--
     2.3283e+04     2.3283e+05             1.7110e-08       -17.216193206447
     9.3132e+04     9.3132e+05             4.2776e-09       -17.216193206357

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.2918e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986198e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136140e-02 3 1  ON 4
ci_006                -1.910193e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737758e-02 3 1  ON 8
ci_010                -1.730650e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652861e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309445e-02 3 1  ON 13
ci_015                 1.339138e-02 3 1  ON 14
ci_016                 1.632387e-02 3 1  ON 15
ci_017                 1.708217e-02 3 1  ON 16
ci_018                 1.259359e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176984e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155473e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109591e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514512e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052758e-02 3 1  ON 32
ci_034                 9.979451e-03 3 1  ON 33
ci_035                -4.523078e-03 3 1  ON 34
ci_036                -1.085453e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546046e-03 3 1  ON 37
ci_039                 1.767768e-03 3 1  ON 38
ci_040                -3.967480e-03 3 1  ON 39
ci_041                 1.001779e-02 3 1  ON 40
ci_042                 1.028314e-02 3 1  ON 41
ci_043                -3.122596e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467726e-03 3 1  ON 44
ci_046                 5.036831e-03 3 1  ON 45
ci_047                 6.020494e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703005e-03 3 1  ON 49
ci_051                 7.859640e-03 3 1  ON 50
ci_052                -6.683057e-03 3 1  ON 51
ci_053                -6.488473e-03 3 1  ON 52
ci_054                -2.433644e-03 3 1  ON 53
ci_055                -3.000053e-03 3 1  ON 54
ci_056                 4.128571e-03 3 1  ON 55
ci_057                 4.853709e-03 3 1  ON 56
ci_058                -6.390223e-03 3 1  ON 57
ci_059                -6.802648e-03 3 1  ON 58
ci_060                 8.846488e-03 3 1  ON 59
ci_061                 9.074118e-03 3 1  ON 60
ci_062                -3.602519e-03 3 1  ON 61
ci_063                -2.711847e-03 3 1  ON 62
ci_064                -3.136835e-03 3 1  ON 63
ci_065                -3.793685e-03 3 1  ON 64
ci_066                 5.245313e-03 3 1  ON 65
ci_067                 5.402175e-03 3 1  ON 66
ci_068                -4.793976e-03 3 1  ON 67
ci_069                -5.261144e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2518
    reference variance = 0.224099
====================================================
  Execution time = 1.3638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1373e-01
  Total weights = 1.956743301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297107114815
                                         uncertainty =       0.001904438267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297107114815
                                         uncertainty =       0.001904438267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385387867
  error estimate for blocks of size 2^( 2) =       0.000395523847
  error estimate for blocks of size 2^( 3) =       0.000404318493
  error estimate for blocks of size 2^( 4) =       0.000410696982
  error estimate for blocks of size 2^( 5) =       0.000414701594
  error estimate for blocks of size 2^( 6) =       0.000416306595
  error estimate for blocks of size 2^( 7) =       0.000417203365

      target function =                  N/A
              le_mean =     -17.216317047713
             les_mean =     296.715301565190
             stat err =       0.000414727134
             autocorr =       1.158054038940
              std dev =       0.545020748057
             le_variance =       0.297047615813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631704771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317047759       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317048864       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216317048724       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317048702       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 2.491645e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317047759       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317048035       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216317048000       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317047995       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 6.229754e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216317047759       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216317047828       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216317047819       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216317047818       residual = 2.77e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 1.557479e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6129e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.015426e-02 3 1  ON 0
ci_002                -2.986195e-02 3 1  ON 1
ci_003                -2.495004e-02 3 1  ON 2
ci_004                 2.087985e-02 3 1  ON 3
ci_005                 2.136135e-02 3 1  ON 4
ci_006                -1.910190e-02 3 1  ON 5
ci_007                -1.885094e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737758e-02 3 1  ON 8
ci_010                -1.730648e-02 3 1  ON 9
ci_011                -1.650830e-02 3 1  ON 10
ci_012                -1.652863e-02 3 1  ON 11
ci_013                -1.889365e-02 3 1  ON 12
ci_014                 1.309443e-02 3 1  ON 13
ci_015                 1.339140e-02 3 1  ON 14
ci_016                 1.632385e-02 3 1  ON 15
ci_017                 1.708214e-02 3 1  ON 16
ci_018                 1.259359e-02 3 1  ON 17
ci_019                 1.259254e-02 3 1  ON 18
ci_020                 1.302610e-02 3 1  ON 19
ci_021                 1.336939e-02 3 1  ON 20
ci_022                 1.176981e-02 3 1  ON 21
ci_023                 1.160786e-02 3 1  ON 22
ci_024                 1.155472e-02 3 1  ON 23
ci_025                 1.169441e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115471e-02 3 1  ON 26
ci_028                -1.514505e-02 3 1  ON 27
ci_029                -1.460054e-02 3 1  ON 28
ci_030                -1.114963e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340084e-02 3 1  ON 31
ci_033                 1.052752e-02 3 1  ON 32
ci_034                 9.979490e-03 3 1  ON 33
ci_035                -4.523057e-03 3 1  ON 34
ci_036                -1.085450e-02 3 1  ON 35
ci_037                -1.037079e-02 3 1  ON 36
ci_038                 1.546043e-03 3 1  ON 37
ci_039                 1.767769e-03 3 1  ON 38
ci_040                -3.967443e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028312e-02 3 1  ON 41
ci_043                -3.122599e-03 3 1  ON 42
ci_044                -1.553366e-02 3 1  ON 43
ci_045                -1.467737e-03 3 1  ON 44
ci_046                 5.036855e-03 3 1  ON 45
ci_047                 6.020456e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703000e-03 3 1  ON 49
ci_051                 7.859650e-03 3 1  ON 50
ci_052                -6.683033e-03 3 1  ON 51
ci_053                -6.488481e-03 3 1  ON 52
ci_054                -2.433681e-03 3 1  ON 53
ci_055                -3.000065e-03 3 1  ON 54
ci_056                 4.128592e-03 3 1  ON 55
ci_057                 4.853688e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802672e-03 3 1  ON 58
ci_060                 8.846456e-03 3 1  ON 59
ci_061                 9.074094e-03 3 1  ON 60
ci_062                -3.602489e-03 3 1  ON 61
ci_063                -2.711891e-03 3 1  ON 62
ci_064                -3.136802e-03 3 1  ON 63
ci_065                -3.793735e-03 3 1  ON 64
ci_066                 5.245316e-03 3 1  ON 65
ci_067                 5.402211e-03 3 1  ON 66
ci_068                -4.794013e-03 3 1  ON 67
ci_069                -5.261150e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1887
    reference variance = 0.186236
====================================================
  Execution time = 1.3498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1400e-01
  Total weights = 1.9565e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838720095
                                         uncertainty =       0.001631731971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838720095
                                         uncertainty =       0.001631731971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800256
  error estimate for blocks of size 2^( 2) =       0.000397696915
  error estimate for blocks of size 2^( 3) =       0.000406572514
  error estimate for blocks of size 2^( 4) =       0.000413831381
  error estimate for blocks of size 2^( 5) =       0.000418466672
  error estimate for blocks of size 2^( 6) =       0.000421977675
  error estimate for blocks of size 2^( 7) =       0.000422124285

      target function =                  N/A
              le_mean =     -17.216562876464
             les_mean =     296.724039520753
             stat err =       0.000419100003
             autocorr =       1.167936268722
              std dev =       0.548432381694
             le_variance =       0.300778077290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838632287
                                         uncertainty =       0.001631728579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838632287
                                         uncertainty =       0.001631728579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800200
  error estimate for blocks of size 2^( 2) =       0.000397696864
  error estimate for blocks of size 2^( 3) =       0.000406572473
  error estimate for blocks of size 2^( 4) =       0.000413831350
  error estimate for blocks of size 2^( 5) =       0.000418466639
  error estimate for blocks of size 2^( 6) =       0.000421977652
  error estimate for blocks of size 2^( 7) =       0.000422124259

      target function =                  N/A
              le_mean =     -17.216562873486
             les_mean =     296.724039499205
             stat err =       0.000419099975
             autocorr =       1.167936450534
              std dev =       0.548432302112
             le_variance =       0.300777990000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838676180
                                         uncertainty =       0.001631730275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838676180
                                         uncertainty =       0.001631730275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800228
  error estimate for blocks of size 2^( 2) =       0.000397696889
  error estimate for blocks of size 2^( 3) =       0.000406572494
  error estimate for blocks of size 2^( 4) =       0.000413831365
  error estimate for blocks of size 2^( 5) =       0.000418466656
  error estimate for blocks of size 2^( 6) =       0.000421977663
  error estimate for blocks of size 2^( 7) =       0.000422124272

      target function =                  N/A
              le_mean =     -17.216562874975
             les_mean =     296.724039509606
             stat err =       0.000419099989
             autocorr =       1.167936359644
              std dev =       0.548432341893
             le_variance =       0.300778033634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838714605
                                         uncertainty =       0.001631731759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838714605
                                         uncertainty =       0.001631731759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800253
  error estimate for blocks of size 2^( 2) =       0.000397696911
  error estimate for blocks of size 2^( 3) =       0.000406572512
  error estimate for blocks of size 2^( 4) =       0.000413831379
  error estimate for blocks of size 2^( 5) =       0.000418466670
  error estimate for blocks of size 2^( 6) =       0.000421977673
  error estimate for blocks of size 2^( 7) =       0.000422124283

      target function =                  N/A
              le_mean =     -17.216562876278
             les_mean =     296.724039519319
             stat err =       0.000419100001
             autocorr =       1.167936280080
              std dev =       0.548432376718
             le_variance =       0.300778071832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216562876464        initial  <--
     1.4552e+03     1.4552e+04             2.4916e-07       -17.216562873486
     5.8208e+03     5.8208e+04             6.2298e-08       -17.216562874975
     2.3283e+04     2.3283e+05             1.5575e-08       -17.216562876278

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6878
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986198e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136140e-02 3 1  ON 4
ci_006                -1.910193e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737758e-02 3 1  ON 8
ci_010                -1.730650e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652861e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309445e-02 3 1  ON 13
ci_015                 1.339138e-02 3 1  ON 14
ci_016                 1.632387e-02 3 1  ON 15
ci_017                 1.708217e-02 3 1  ON 16
ci_018                 1.259359e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176984e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155473e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109591e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514512e-02 3 1  ON 27
ci_029                -1.460058e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052758e-02 3 1  ON 32
ci_034                 9.979451e-03 3 1  ON 33
ci_035                -4.523078e-03 3 1  ON 34
ci_036                -1.085453e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546046e-03 3 1  ON 37
ci_039                 1.767768e-03 3 1  ON 38
ci_040                -3.967480e-03 3 1  ON 39
ci_041                 1.001779e-02 3 1  ON 40
ci_042                 1.028314e-02 3 1  ON 41
ci_043                -3.122596e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467726e-03 3 1  ON 44
ci_046                 5.036831e-03 3 1  ON 45
ci_047                 6.020494e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703005e-03 3 1  ON 49
ci_051                 7.859640e-03 3 1  ON 50
ci_052                -6.683057e-03 3 1  ON 51
ci_053                -6.488473e-03 3 1  ON 52
ci_054                -2.433644e-03 3 1  ON 53
ci_055                -3.000053e-03 3 1  ON 54
ci_056                 4.128571e-03 3 1  ON 55
ci_057                 4.853709e-03 3 1  ON 56
ci_058                -6.390223e-03 3 1  ON 57
ci_059                -6.802648e-03 3 1  ON 58
ci_060                 8.846488e-03 3 1  ON 59
ci_061                 9.074118e-03 3 1  ON 60
ci_062                -3.602519e-03 3 1  ON 61
ci_063                -2.711847e-03 3 1  ON 62
ci_064                -3.136835e-03 3 1  ON 63
ci_065                -3.793685e-03 3 1  ON 64
ci_066                 5.245313e-03 3 1  ON 65
ci_067                 5.402175e-03 3 1  ON 66
ci_068                -4.793976e-03 3 1  ON 67
ci_069                -5.261144e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1845
    reference variance = 0.264312
====================================================
  Execution time = 1.4450e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1494e-01
  Total weights = 1.956583242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301344916776
                                         uncertainty =       0.002490606258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301344916776
                                         uncertainty =       0.002490606258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388121479
  error estimate for blocks of size 2^( 2) =       0.000398399774
  error estimate for blocks of size 2^( 3) =       0.000407396749
  error estimate for blocks of size 2^( 4) =       0.000413710930
  error estimate for blocks of size 2^( 5) =       0.000416793717
  error estimate for blocks of size 2^( 6) =       0.000419298824
  error estimate for blocks of size 2^( 7) =       0.000421009055

      target function =                  N/A
              le_mean =     -17.216013361650
             les_mean =     296.706056306697
             stat err =       0.000417703132
             autocorr =       1.158244126939
              std dev =       0.548886659766
             le_variance =       0.301276565269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601336165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216013361659       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216013362039       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216013362069       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216013362069       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.600647e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216013361659       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216013361754       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216013361761       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216013361761       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 6.501731e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216013361659       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216013361683       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216013361684       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216013361684       residual = 5.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 1.625440e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6980e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986198e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136140e-02 3 1  ON 4
ci_006                -1.910193e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737759e-02 3 1  ON 8
ci_010                -1.730650e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652861e-02 3 1  ON 11
ci_013                -1.889360e-02 3 1  ON 12
ci_014                 1.309445e-02 3 1  ON 13
ci_015                 1.339138e-02 3 1  ON 14
ci_016                 1.632387e-02 3 1  ON 15
ci_017                 1.708217e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176983e-02 3 1  ON 21
ci_023                 1.160784e-02 3 1  ON 22
ci_024                 1.155474e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109591e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460057e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057486e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052758e-02 3 1  ON 32
ci_034                 9.979451e-03 3 1  ON 33
ci_035                -4.523077e-03 3 1  ON 34
ci_036                -1.085453e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546042e-03 3 1  ON 37
ci_039                 1.767770e-03 3 1  ON 38
ci_040                -3.967478e-03 3 1  ON 39
ci_041                 1.001779e-02 3 1  ON 40
ci_042                 1.028314e-02 3 1  ON 41
ci_043                -3.122597e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467730e-03 3 1  ON 44
ci_046                 5.036836e-03 3 1  ON 45
ci_047                 6.020494e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703007e-03 3 1  ON 49
ci_051                 7.859636e-03 3 1  ON 50
ci_052                -6.683057e-03 3 1  ON 51
ci_053                -6.488474e-03 3 1  ON 52
ci_054                -2.433643e-03 3 1  ON 53
ci_055                -3.000050e-03 3 1  ON 54
ci_056                 4.128569e-03 3 1  ON 55
ci_057                 4.853707e-03 3 1  ON 56
ci_058                -6.390223e-03 3 1  ON 57
ci_059                -6.802647e-03 3 1  ON 58
ci_060                 8.846483e-03 3 1  ON 59
ci_061                 9.074119e-03 3 1  ON 60
ci_062                -3.602516e-03 3 1  ON 61
ci_063                -2.711845e-03 3 1  ON 62
ci_064                -3.136837e-03 3 1  ON 63
ci_065                -3.793688e-03 3 1  ON 64
ci_066                 5.245314e-03 3 1  ON 65
ci_067                 5.402182e-03 3 1  ON 66
ci_068                -4.793974e-03 3 1  ON 67
ci_069                -5.261143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2946
    reference variance = 0.370908
====================================================
  Execution time = 1.3787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.9566e+06
  Execution time = 1.8414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488867699
                                         uncertainty =       0.001634588153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488867699
                                         uncertainty =       0.001634588153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386306288
  error estimate for blocks of size 2^( 2) =       0.000396199437
  error estimate for blocks of size 2^( 3) =       0.000405061227
  error estimate for blocks of size 2^( 4) =       0.000412271964
  error estimate for blocks of size 2^( 5) =       0.000416255416
  error estimate for blocks of size 2^( 6) =       0.000418379078
  error estimate for blocks of size 2^( 7) =       0.000419965561

      target function =                  N/A
              le_mean =     -17.216164525688
             les_mean =     296.708894007082
             stat err =       0.000416718005
             autocorr =       1.163646251108
              std dev =       0.546319592323
             le_variance =       0.298465096956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488862049
                                         uncertainty =       0.001634588106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488862049
                                         uncertainty =       0.001634588106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386306285
  error estimate for blocks of size 2^( 2) =       0.000396199433
  error estimate for blocks of size 2^( 3) =       0.000405061224
  error estimate for blocks of size 2^( 4) =       0.000412271962
  error estimate for blocks of size 2^( 5) =       0.000416255413
  error estimate for blocks of size 2^( 6) =       0.000418379076
  error estimate for blocks of size 2^( 7) =       0.000419965559

      target function =                  N/A
              le_mean =     -17.216164525779
             les_mean =     296.708894104904
             stat err =       0.000416718002
             autocorr =       1.163646259695
              std dev =       0.546319587163
             le_variance =       0.298465091318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488864873
                                         uncertainty =       0.001634588130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488864873
                                         uncertainty =       0.001634588130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386306287
  error estimate for blocks of size 2^( 2) =       0.000396199435
  error estimate for blocks of size 2^( 3) =       0.000405061226
  error estimate for blocks of size 2^( 4) =       0.000412271963
  error estimate for blocks of size 2^( 5) =       0.000416255414
  error estimate for blocks of size 2^( 6) =       0.000418379077
  error estimate for blocks of size 2^( 7) =       0.000419965560

      target function =                  N/A
              le_mean =     -17.216164525734
             les_mean =     296.708894055918
             stat err =       0.000416718004
             autocorr =       1.163646255407
              std dev =       0.546319589743
             le_variance =       0.298465094137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488867345
                                         uncertainty =       0.001634588150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298488867345
                                         uncertainty =       0.001634588150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386306288
  error estimate for blocks of size 2^( 2) =       0.000396199437
  error estimate for blocks of size 2^( 3) =       0.000405061227
  error estimate for blocks of size 2^( 4) =       0.000412271964
  error estimate for blocks of size 2^( 5) =       0.000416255415
  error estimate for blocks of size 2^( 6) =       0.000418379078
  error estimate for blocks of size 2^( 7) =       0.000419965561

      target function =                  N/A
              le_mean =     -17.216164525694
             les_mean =     296.708894013178
             stat err =       0.000416718005
             autocorr =       1.163646251643
              std dev =       0.546319592000
             le_variance =       0.298465096604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216164525688        initial
     1.4552e+04     1.4552e+05             2.6006e-08       -17.216164525779  <--
     5.8208e+04     5.8208e+05             6.5017e-09       -17.216164525734
     2.3283e+05     2.3283e+06             1.6254e-09       -17.216164525694

*****************************************************************************
Applying the update for shift_i =   1.4552e+04     and shift_s =   1.4552e+05
*****************************************************************************

  Execution time = 2.3114e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0165e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.205295
====================================================
  Execution time = 1.4101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1638e-01
  Total weights = 1.956556482e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299811177941
                                         uncertainty =       0.002711495156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299811177941
                                         uncertainty =       0.002711495156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387294271
  error estimate for blocks of size 2^( 2) =       0.000397491683
  error estimate for blocks of size 2^( 3) =       0.000407048212
  error estimate for blocks of size 2^( 4) =       0.000413791209
  error estimate for blocks of size 2^( 5) =       0.000418587939
  error estimate for blocks of size 2^( 6) =       0.000420542277
  error estimate for blocks of size 2^( 7) =       0.000423567334

      target function =                  N/A
              le_mean =     -17.216500831378
             les_mean =     296.724276973306
             stat err =       0.000419122190
             autocorr =       1.171113975228
              std dev =       0.547716810459
             le_variance =       0.299993704459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650083138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500831393       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500832509       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500832529       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500832531       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 1.035691e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500831393       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500831672       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500831677       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500831677       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 2.589331e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500831393       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216500831462       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216500831464       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500831464       residual = 1.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 6.473392e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6590e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.015424e-02 3 1  ON 0
ci_002                -2.986200e-02 3 1  ON 1
ci_003                -2.495006e-02 3 1  ON 2
ci_004                 2.087981e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910190e-02 3 1  ON 5
ci_007                -1.885096e-02 3 1  ON 6
ci_008                -1.779667e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730648e-02 3 1  ON 9
ci_011                -1.650831e-02 3 1  ON 10
ci_012                -1.652858e-02 3 1  ON 11
ci_013                -1.889363e-02 3 1  ON 12
ci_014                 1.309447e-02 3 1  ON 13
ci_015                 1.339139e-02 3 1  ON 14
ci_016                 1.632387e-02 3 1  ON 15
ci_017                 1.708213e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336942e-02 3 1  ON 20
ci_022                 1.176981e-02 3 1  ON 21
ci_023                 1.160782e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115475e-02 3 1  ON 26
ci_028                -1.514510e-02 3 1  ON 27
ci_029                -1.460056e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057488e-02 3 1  ON 30
ci_032                -1.340081e-02 3 1  ON 31
ci_033                 1.052758e-02 3 1  ON 32
ci_034                 9.979457e-03 3 1  ON 33
ci_035                -4.523086e-03 3 1  ON 34
ci_036                -1.085453e-02 3 1  ON 35
ci_037                -1.037079e-02 3 1  ON 36
ci_038                 1.546046e-03 3 1  ON 37
ci_039                 1.767777e-03 3 1  ON 38
ci_040                -3.967478e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028312e-02 3 1  ON 41
ci_043                -3.122597e-03 3 1  ON 42
ci_044                -1.553369e-02 3 1  ON 43
ci_045                -1.467739e-03 3 1  ON 44
ci_046                 5.036854e-03 3 1  ON 45
ci_047                 6.020487e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163288e-02 3 1  ON 48
ci_050                 7.703005e-03 3 1  ON 49
ci_051                 7.859628e-03 3 1  ON 50
ci_052                -6.683059e-03 3 1  ON 51
ci_053                -6.488490e-03 3 1  ON 52
ci_054                -2.433660e-03 3 1  ON 53
ci_055                -3.000046e-03 3 1  ON 54
ci_056                 4.128574e-03 3 1  ON 55
ci_057                 4.853699e-03 3 1  ON 56
ci_058                -6.390226e-03 3 1  ON 57
ci_059                -6.802636e-03 3 1  ON 58
ci_060                 8.846474e-03 3 1  ON 59
ci_061                 9.074100e-03 3 1  ON 60
ci_062                -3.602512e-03 3 1  ON 61
ci_063                -2.711847e-03 3 1  ON 62
ci_064                -3.136856e-03 3 1  ON 63
ci_065                -3.793710e-03 3 1  ON 64
ci_066                 5.245307e-03 3 1  ON 65
ci_067                 5.402221e-03 3 1  ON 66
ci_068                -4.793960e-03 3 1  ON 67
ci_069                -5.261119e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.235443
====================================================
  Execution time = 1.3137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0999e-01
  Total weights = 1.9565e+06
  Execution time = 1.8460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147328653
                                         uncertainty =       0.001728978909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147328653
                                         uncertainty =       0.001728978909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385430314
  error estimate for blocks of size 2^( 2) =       0.000395180530
  error estimate for blocks of size 2^( 3) =       0.000404081180
  error estimate for blocks of size 2^( 4) =       0.000411089298
  error estimate for blocks of size 2^( 5) =       0.000415415395
  error estimate for blocks of size 2^( 6) =       0.000416873078
  error estimate for blocks of size 2^( 7) =       0.000418360687

      target function =                  N/A
              le_mean =     -17.216483077333
             les_mean =     296.717279635182
             stat err =       0.000415434615
             autocorr =       1.161752518704
              std dev =       0.545080776835
             le_variance =       0.297113053275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147349876
                                         uncertainty =       0.001728976444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147349876
                                         uncertainty =       0.001728976444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385430327
  error estimate for blocks of size 2^( 2) =       0.000395180543
  error estimate for blocks of size 2^( 3) =       0.000404081193
  error estimate for blocks of size 2^( 4) =       0.000411089311
  error estimate for blocks of size 2^( 5) =       0.000415415407
  error estimate for blocks of size 2^( 6) =       0.000416873090
  error estimate for blocks of size 2^( 7) =       0.000418360701

      target function =                  N/A
              le_mean =     -17.216483076324
             les_mean =     296.717279579291
             stat err =       0.000415434628
             autocorr =       1.161752508918
              std dev =       0.545080796157
             le_variance =       0.297113074339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147339265
                                         uncertainty =       0.001728977676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147339265
                                         uncertainty =       0.001728977676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385430320
  error estimate for blocks of size 2^( 2) =       0.000395180537
  error estimate for blocks of size 2^( 3) =       0.000404081187
  error estimate for blocks of size 2^( 4) =       0.000411089305
  error estimate for blocks of size 2^( 5) =       0.000415415401
  error estimate for blocks of size 2^( 6) =       0.000416873084
  error estimate for blocks of size 2^( 7) =       0.000418360694

      target function =                  N/A
              le_mean =     -17.216483076829
             les_mean =     296.717279607196
             stat err =       0.000415434621
             autocorr =       1.161752513810
              std dev =       0.545080786496
             le_variance =       0.297113063807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147329979
                                         uncertainty =       0.001728978755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297147329979
                                         uncertainty =       0.001728978755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385430314
  error estimate for blocks of size 2^( 2) =       0.000395180531
  error estimate for blocks of size 2^( 3) =       0.000404081181
  error estimate for blocks of size 2^( 4) =       0.000411089299
  error estimate for blocks of size 2^( 5) =       0.000415415396
  error estimate for blocks of size 2^( 6) =       0.000416873079
  error estimate for blocks of size 2^( 7) =       0.000418360687

      target function =                  N/A
              le_mean =     -17.216483077270
             les_mean =     296.717279631679
             stat err =       0.000415434615
             autocorr =       1.161752518087
              std dev =       0.545080778043
             le_variance =       0.297113054592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216483077333        initial  <--
     3.6380e+03     3.6380e+04             1.0357e-07       -17.216483076324
     1.4552e+04     1.4552e+05             2.5893e-08       -17.216483076829
     5.8208e+04     5.8208e+05             6.4734e-09       -17.216483077270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4334
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1765
    reference variance = 0.20811
====================================================
  Execution time = 1.3763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0998e-01
  Total weights = 1.956373457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297671025527
                                         uncertainty =       0.001702217172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297671025527
                                         uncertainty =       0.001702217172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385801569
  error estimate for blocks of size 2^( 2) =       0.000395734240
  error estimate for blocks of size 2^( 3) =       0.000405169770
  error estimate for blocks of size 2^( 4) =       0.000411670296
  error estimate for blocks of size 2^( 5) =       0.000416573795
  error estimate for blocks of size 2^( 6) =       0.000419465570
  error estimate for blocks of size 2^( 7) =       0.000420529083

      target function =                  N/A
              le_mean =     -17.216414919246
             les_mean =     296.714926814357
             stat err =       0.000417059686
             autocorr =       1.168606896768
              std dev =       0.545605811246
             le_variance =       0.297685701266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641491925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414919279       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414919524       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414919540       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414919541       residual = 3.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+04 is 8.678532e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414919279       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414919340       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414919344       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414919344       residual = 3.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+05 is 2.169644e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414919279       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414919294       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414919295       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414919281       residual = 3.14e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 5.424116e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6279e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986198e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309447e-02 3 1  ON 13
ci_015                 1.339138e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514510e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979453e-03 3 1  ON 33
ci_035                -4.523073e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546031e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967474e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028312e-02 3 1  ON 41
ci_043                -3.122601e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467747e-03 3 1  ON 44
ci_046                 5.036850e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859622e-03 3 1  ON 50
ci_052                -6.683055e-03 3 1  ON 51
ci_053                -6.488480e-03 3 1  ON 52
ci_054                -2.433643e-03 3 1  ON 53
ci_055                -3.000043e-03 3 1  ON 54
ci_056                 4.128566e-03 3 1  ON 55
ci_057                 4.853701e-03 3 1  ON 56
ci_058                -6.390226e-03 3 1  ON 57
ci_059                -6.802643e-03 3 1  ON 58
ci_060                 8.846468e-03 3 1  ON 59
ci_061                 9.074118e-03 3 1  ON 60
ci_062                -3.602505e-03 3 1  ON 61
ci_063                -2.711841e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793699e-03 3 1  ON 64
ci_066                 5.245317e-03 3 1  ON 65
ci_067                 5.402203e-03 3 1  ON 66
ci_068                -4.793970e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2514
    reference variance = 0.169692
====================================================
  Execution time = 1.3483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1009e-01
  Total weights = 1.9568e+06
  Execution time = 1.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004233738
                                         uncertainty =       0.001801362889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004233738
                                         uncertainty =       0.001801362889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384722549
  error estimate for blocks of size 2^( 2) =       0.000394563192
  error estimate for blocks of size 2^( 3) =       0.000403469163
  error estimate for blocks of size 2^( 4) =       0.000410325184
  error estimate for blocks of size 2^( 5) =       0.000414835757
  error estimate for blocks of size 2^( 6) =       0.000417427313
  error estimate for blocks of size 2^( 7) =       0.000419721297

      target function =                  N/A
              le_mean =     -17.216105251532
             les_mean =     296.704372125498
             stat err =       0.000415577388
             autocorr =       1.166832547794
              std dev =       0.544079846127
             le_variance =       0.296022878961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004234865
                                         uncertainty =       0.001801362718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004234865
                                         uncertainty =       0.001801362718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384722549
  error estimate for blocks of size 2^( 2) =       0.000394563193
  error estimate for blocks of size 2^( 3) =       0.000403469163
  error estimate for blocks of size 2^( 4) =       0.000410325184
  error estimate for blocks of size 2^( 5) =       0.000414835757
  error estimate for blocks of size 2^( 6) =       0.000417427313
  error estimate for blocks of size 2^( 7) =       0.000419721297

      target function =                  N/A
              le_mean =     -17.216105251454
             les_mean =     296.704372147456
             stat err =       0.000415577388
             autocorr =       1.166832545535
              std dev =       0.544079847152
             le_variance =       0.296022880077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004234301
                                         uncertainty =       0.001801362803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004234301
                                         uncertainty =       0.001801362803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384722549
  error estimate for blocks of size 2^( 2) =       0.000394563193
  error estimate for blocks of size 2^( 3) =       0.000403469163
  error estimate for blocks of size 2^( 4) =       0.000410325184
  error estimate for blocks of size 2^( 5) =       0.000414835757
  error estimate for blocks of size 2^( 6) =       0.000417427313
  error estimate for blocks of size 2^( 7) =       0.000419721297

      target function =                  N/A
              le_mean =     -17.216105251493
             les_mean =     296.704372136355
             stat err =       0.000415577388
             autocorr =       1.166832546661
              std dev =       0.544079846640
             le_variance =       0.296022879519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004233808
                                         uncertainty =       0.001801362878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296004233808
                                         uncertainty =       0.001801362878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384722549
  error estimate for blocks of size 2^( 2) =       0.000394563193
  error estimate for blocks of size 2^( 3) =       0.000403469163
  error estimate for blocks of size 2^( 4) =       0.000410325184
  error estimate for blocks of size 2^( 5) =       0.000414835757
  error estimate for blocks of size 2^( 6) =       0.000417427313
  error estimate for blocks of size 2^( 7) =       0.000419721297

      target function =                  N/A
              le_mean =     -17.216105251527
             les_mean =     296.704372126843
             stat err =       0.000415577388
             autocorr =       1.166832547656
              std dev =       0.544079846191
             le_variance =       0.296022879031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216105251532        initial  <--
     3.6380e+04     3.6380e+05             8.6785e-09       -17.216105251454
     1.4552e+05     1.4552e+06             2.1696e-09       -17.216105251493
     5.8208e+05     5.8208e+06             5.4241e-10       -17.216105251527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7476
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1485
    reference variance = 0.179247
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1446e-01
  Total weights = 1.956600743e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302420305855
                                         uncertainty =       0.002382149094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302420305855
                                         uncertainty =       0.002382149094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388797164
  error estimate for blocks of size 2^( 2) =       0.000398757976
  error estimate for blocks of size 2^( 3) =       0.000407258792
  error estimate for blocks of size 2^( 4) =       0.000414235771
  error estimate for blocks of size 2^( 5) =       0.000417594396
  error estimate for blocks of size 2^( 6) =       0.000420472350
  error estimate for blocks of size 2^( 7) =       0.000421571557

      target function =                  N/A
              le_mean =     -17.216961949217
             les_mean =     296.738235672812
             stat err =       0.000418468519
             autocorr =       1.158455633754
              std dev =       0.549842222493
             le_variance =       0.302326469636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696194922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961949251       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961949256       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961949267       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961949266       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 1.327853e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961949251       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961949252       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961949255       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961949255       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 3.319635e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216961949251       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216961949251       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216961949252       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216961949252       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 8.299089e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6557e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433642e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245316e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.231017
====================================================
  Execution time = 1.3605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1850e-01
  Total weights = 1.9566e+06
  Execution time = 1.8374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789869
                                         uncertainty =       0.003163976853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789869
                                         uncertainty =       0.003163976853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389780065
  error estimate for blocks of size 2^( 2) =       0.000399338508
  error estimate for blocks of size 2^( 3) =       0.000408350846
  error estimate for blocks of size 2^( 4) =       0.000415198360
  error estimate for blocks of size 2^( 5) =       0.000418730009
  error estimate for blocks of size 2^( 6) =       0.000421549907
  error estimate for blocks of size 2^( 7) =       0.000424714625

      target function =                  N/A
              le_mean =     -17.216637580373
             les_mean =     296.731106429894
             stat err =       0.000420048225
             autocorr =       1.161339136339
              std dev =       0.551232253623
             le_variance =       0.303856997435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789695
                                         uncertainty =       0.003163976874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789695
                                         uncertainty =       0.003163976874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389780064
  error estimate for blocks of size 2^( 2) =       0.000399338508
  error estimate for blocks of size 2^( 3) =       0.000408350846
  error estimate for blocks of size 2^( 4) =       0.000415198360
  error estimate for blocks of size 2^( 5) =       0.000418730009
  error estimate for blocks of size 2^( 6) =       0.000421549906
  error estimate for blocks of size 2^( 7) =       0.000424714625

      target function =                  N/A
              le_mean =     -17.216637580337
             les_mean =     296.731106429756
             stat err =       0.000420048225
             autocorr =       1.161339136685
              std dev =       0.551232253463
             le_variance =       0.303856997257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789782
                                         uncertainty =       0.003163976863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789782
                                         uncertainty =       0.003163976863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389780064
  error estimate for blocks of size 2^( 2) =       0.000399338508
  error estimate for blocks of size 2^( 3) =       0.000408350846
  error estimate for blocks of size 2^( 4) =       0.000415198360
  error estimate for blocks of size 2^( 5) =       0.000418730009
  error estimate for blocks of size 2^( 6) =       0.000421549906
  error estimate for blocks of size 2^( 7) =       0.000424714625

      target function =                  N/A
              le_mean =     -17.216637580355
             les_mean =     296.731106429825
             stat err =       0.000420048225
             autocorr =       1.161339136507
              std dev =       0.551232253543
             le_variance =       0.303856997346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789859
                                         uncertainty =       0.003163976854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303819789859
                                         uncertainty =       0.003163976854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389780065
  error estimate for blocks of size 2^( 2) =       0.000399338508
  error estimate for blocks of size 2^( 3) =       0.000408350846
  error estimate for blocks of size 2^( 4) =       0.000415198360
  error estimate for blocks of size 2^( 5) =       0.000418730009
  error estimate for blocks of size 2^( 6) =       0.000421549906
  error estimate for blocks of size 2^( 7) =       0.000424714625

      target function =                  N/A
              le_mean =     -17.216637580371
             les_mean =     296.731106429886
             stat err =       0.000420048225
             autocorr =       1.161339136357
              std dev =       0.551232253613
             le_variance =       0.303856997424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216637580373        initial  <--
     3.6380e+05     3.6380e+06             1.3279e-09       -17.216637580337
     1.4552e+06     1.4552e+07             3.3196e-10       -17.216637580355
     5.8208e+06     5.8208e+07             8.2991e-11       -17.216637580371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8918
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2628
    reference variance = 0.214311
====================================================
  Execution time = 1.6071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2267e-01
  Total weights = 1.956816294e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305455876297
                                         uncertainty =       0.003681864499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305455876297
                                         uncertainty =       0.003681864499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390835431
  error estimate for blocks of size 2^( 2) =       0.000400622649
  error estimate for blocks of size 2^( 3) =       0.000409548062
  error estimate for blocks of size 2^( 4) =       0.000416669498
  error estimate for blocks of size 2^( 5) =       0.000420404509
  error estimate for blocks of size 2^( 6) =       0.000422992778
  error estimate for blocks of size 2^( 7) =       0.000424373613

      target function =                  N/A
              le_mean =     -17.216545709690
             les_mean =     296.732116045094
             stat err =       0.000421110100
             autocorr =       1.160923118708
              std dev =       0.552724766984
             le_variance =       0.305504668038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654570969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545709739       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545709740       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545709740       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545709740       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 8.366897e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545709739       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545709739       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545709739       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545705121       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 2.091725e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545709739       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216545709739       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545709739       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545714939       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 5.229287e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8553e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802645e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.151558
====================================================
  Execution time = 1.4730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1530e-01
  Total weights = 1.9568e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299394
                                         uncertainty =       0.002177841976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299394
                                         uncertainty =       0.002177841976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387188152
  error estimate for blocks of size 2^( 2) =       0.000397252047
  error estimate for blocks of size 2^( 3) =       0.000406285258
  error estimate for blocks of size 2^( 4) =       0.000413298945
  error estimate for blocks of size 2^( 5) =       0.000417067670
  error estimate for blocks of size 2^( 6) =       0.000419017650
  error estimate for blocks of size 2^( 7) =       0.000418911088

      target function =                  N/A
              le_mean =     -17.217465203121
             les_mean =     296.756411151273
             stat err =       0.000417073838
             autocorr =       1.160330688642
              std dev =       0.547566735844
             le_variance =       0.299829330202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299429
                                         uncertainty =       0.002177841978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299429
                                         uncertainty =       0.002177841978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387188152
  error estimate for blocks of size 2^( 2) =       0.000397252047
  error estimate for blocks of size 2^( 3) =       0.000406285258
  error estimate for blocks of size 2^( 4) =       0.000413298945
  error estimate for blocks of size 2^( 5) =       0.000417067670
  error estimate for blocks of size 2^( 6) =       0.000419017650
  error estimate for blocks of size 2^( 7) =       0.000418911088

      target function =                  N/A
              le_mean =     -17.217465203121
             les_mean =     296.756411151333
             stat err =       0.000417073838
             autocorr =       1.160330688601
              std dev =       0.547566735876
             le_variance =       0.299829330238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299411
                                         uncertainty =       0.002177841977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299411
                                         uncertainty =       0.002177841977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387188152
  error estimate for blocks of size 2^( 2) =       0.000397252047
  error estimate for blocks of size 2^( 3) =       0.000406285258
  error estimate for blocks of size 2^( 4) =       0.000413298945
  error estimate for blocks of size 2^( 5) =       0.000417067670
  error estimate for blocks of size 2^( 6) =       0.000419017650
  error estimate for blocks of size 2^( 7) =       0.000418911088

      target function =                  N/A
              le_mean =     -17.217465203121
             les_mean =     296.756411151303
             stat err =       0.000417073838
             autocorr =       1.160330688624
              std dev =       0.547566735860
             le_variance =       0.299829330220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299396
                                         uncertainty =       0.002177841976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299888299396
                                         uncertainty =       0.002177841976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387188152
  error estimate for blocks of size 2^( 2) =       0.000397252047
  error estimate for blocks of size 2^( 3) =       0.000406285258
  error estimate for blocks of size 2^( 4) =       0.000413298945
  error estimate for blocks of size 2^( 5) =       0.000417067670
  error estimate for blocks of size 2^( 6) =       0.000419017650
  error estimate for blocks of size 2^( 7) =       0.000418911088

      target function =                  N/A
              le_mean =     -17.217465203121
             les_mean =     296.756411151277
             stat err =       0.000417073838
             autocorr =       1.160330688642
              std dev =       0.547566735846
             le_variance =       0.299829330205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217465203121        initial  <--
     3.6380e+06     3.6380e+07             8.3669e-11       -17.217465203121
     1.4552e+07     1.4552e+08             2.0917e-11       -17.217465203121
     5.8208e+07     5.8208e+08             5.2293e-12       -17.217465203121

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9536
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.154371
====================================================
  Execution time = 1.3910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1437e-01
  Total weights = 1.956591507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298353068955
                                         uncertainty =       0.002137929714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298353068955
                                         uncertainty =       0.002137929714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386202727
  error estimate for blocks of size 2^( 2) =       0.000396086324
  error estimate for blocks of size 2^( 3) =       0.000404957440
  error estimate for blocks of size 2^( 4) =       0.000411502639
  error estimate for blocks of size 2^( 5) =       0.000415947112
  error estimate for blocks of size 2^( 6) =       0.000418450879
  error estimate for blocks of size 2^( 7) =       0.000418578437

      target function =                  N/A
              le_mean =     -17.216145485555
             les_mean =     296.710038472636
             stat err =       0.000416119767
             autocorr =       1.160929962334
              std dev =       0.546173134612
             le_variance =       0.298305092972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614548556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216145485574       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216145485574       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216145485574       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216145485574       residual = 1.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 1.190287e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216145485574       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216145485574       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216145485574       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216145485574       residual = 1.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+08 is 2.975741e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216145485574       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216145485574       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216145485574       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216145485574       residual = 1.15e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+08 is 7.438489e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068966 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6390e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2019
    reference variance = 0.121734
====================================================
  Execution time = 1.3683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1594e-01
  Total weights = 1.9567e+06
  Execution time = 1.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007775
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007775
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388358220
  error estimate for blocks of size 2^( 2) =       0.000398594341
  error estimate for blocks of size 2^( 3) =       0.000407729665
  error estimate for blocks of size 2^( 4) =       0.000413981706
  error estimate for blocks of size 2^( 5) =       0.000418283393
  error estimate for blocks of size 2^( 6) =       0.000420613043
  error estimate for blocks of size 2^( 7) =       0.000421296150

      target function =                  N/A
              le_mean =     -17.216455741081
             les_mean =     296.722288321783
             stat err =       0.000418543573
             autocorr =       1.161492344791
              std dev =       0.549221461223
             le_variance =       0.301644213467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007772
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007772
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388358220
  error estimate for blocks of size 2^( 2) =       0.000398594341
  error estimate for blocks of size 2^( 3) =       0.000407729665
  error estimate for blocks of size 2^( 4) =       0.000413981706
  error estimate for blocks of size 2^( 5) =       0.000418283393
  error estimate for blocks of size 2^( 6) =       0.000420613043
  error estimate for blocks of size 2^( 7) =       0.000421296150

      target function =                  N/A
              le_mean =     -17.216455741081
             les_mean =     296.722288321772
             stat err =       0.000418543573
             autocorr =       1.161492344795
              std dev =       0.549221461220
             le_variance =       0.301644213464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007773
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007773
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388358220
  error estimate for blocks of size 2^( 2) =       0.000398594341
  error estimate for blocks of size 2^( 3) =       0.000407729665
  error estimate for blocks of size 2^( 4) =       0.000413981706
  error estimate for blocks of size 2^( 5) =       0.000418283393
  error estimate for blocks of size 2^( 6) =       0.000420613043
  error estimate for blocks of size 2^( 7) =       0.000421296150

      target function =                  N/A
              le_mean =     -17.216455741081
             les_mean =     296.722288321778
             stat err =       0.000418543573
             autocorr =       1.161492344782
              std dev =       0.549221461221
             le_variance =       0.301644213466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007775
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301594007775
                                         uncertainty =       0.002218346473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388358220
  error estimate for blocks of size 2^( 2) =       0.000398594341
  error estimate for blocks of size 2^( 3) =       0.000407729665
  error estimate for blocks of size 2^( 4) =       0.000413981706
  error estimate for blocks of size 2^( 5) =       0.000418283393
  error estimate for blocks of size 2^( 6) =       0.000420613043
  error estimate for blocks of size 2^( 7) =       0.000421296150

      target function =                  N/A
              le_mean =     -17.216455741081
             les_mean =     296.722288321783
             stat err =       0.000418543573
             autocorr =       1.161492344796
              std dev =       0.549221461222
             le_variance =       0.301644213467


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216455741081        initial  <--
     3.6380e+07     3.6380e+08             1.1903e-11       -17.216455741081
     1.4552e+08     1.4552e+09             2.9757e-12       -17.216455741081
     5.8208e+08     5.8208e+09             7.4385e-13       -17.216455741081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9229
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.3018
    reference variance = 0.198249
====================================================
  Execution time = 1.3938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1089e-01
  Total weights = 1.956662850e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296209113928
                                         uncertainty =       0.001716898835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296209113928
                                         uncertainty =       0.001716898835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384809014
  error estimate for blocks of size 2^( 2) =       0.000394955386
  error estimate for blocks of size 2^( 3) =       0.000404427446
  error estimate for blocks of size 2^( 4) =       0.000411788546
  error estimate for blocks of size 2^( 5) =       0.000416209601
  error estimate for blocks of size 2^( 6) =       0.000419016623
  error estimate for blocks of size 2^( 7) =       0.000419905985

      target function =                  N/A
              le_mean =     -17.215925427387
             les_mean =     296.698974946160
             stat err =       0.000416730188
             autocorr =       1.172787833333
              std dev =       0.544202126298
             le_variance =       0.296155954267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592542739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925427424       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925427424       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215925427424       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 8.932781e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925427424       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925427424       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215925427424       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+09 is 2.233195e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215925427424       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215925427424       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215925427424       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+09 is 5.582988e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6461e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2765
    reference variance = 0.166436
====================================================
  Execution time = 1.3707e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1225e-01
  Total weights = 1.9564e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363468
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363468
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386219742
  error estimate for blocks of size 2^( 2) =       0.000396402098
  error estimate for blocks of size 2^( 3) =       0.000405214096
  error estimate for blocks of size 2^( 4) =       0.000411907093
  error estimate for blocks of size 2^( 5) =       0.000415964796
  error estimate for blocks of size 2^( 6) =       0.000418811343
  error estimate for blocks of size 2^( 7) =       0.000420645308

      target function =                  N/A
              le_mean =     -17.216030334468
             les_mean =     296.703946568666
             stat err =       0.000416832135
             autocorr =       1.164805592181
              std dev =       0.546197197034
             le_variance =       0.298331378048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363467
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363467
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386219742
  error estimate for blocks of size 2^( 2) =       0.000396402098
  error estimate for blocks of size 2^( 3) =       0.000405214096
  error estimate for blocks of size 2^( 4) =       0.000411907093
  error estimate for blocks of size 2^( 5) =       0.000415964796
  error estimate for blocks of size 2^( 6) =       0.000418811343
  error estimate for blocks of size 2^( 7) =       0.000420645308

      target function =                  N/A
              le_mean =     -17.216030334468
             les_mean =     296.703946568666
             stat err =       0.000416832135
             autocorr =       1.164805592185
              std dev =       0.546197197034
             le_variance =       0.298331378048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363467
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363467
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386219742
  error estimate for blocks of size 2^( 2) =       0.000396402098
  error estimate for blocks of size 2^( 3) =       0.000405214096
  error estimate for blocks of size 2^( 4) =       0.000411907093
  error estimate for blocks of size 2^( 5) =       0.000415964796
  error estimate for blocks of size 2^( 6) =       0.000418811343
  error estimate for blocks of size 2^( 7) =       0.000420645308

      target function =                  N/A
              le_mean =     -17.216030334468
             les_mean =     296.703946568666
             stat err =       0.000416832135
             autocorr =       1.164805592176
              std dev =       0.546197197034
             le_variance =       0.298331378048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363468
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298360363468
                                         uncertainty =       0.001809861316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386219742
  error estimate for blocks of size 2^( 2) =       0.000396402098
  error estimate for blocks of size 2^( 3) =       0.000405214096
  error estimate for blocks of size 2^( 4) =       0.000411907093
  error estimate for blocks of size 2^( 5) =       0.000415964796
  error estimate for blocks of size 2^( 6) =       0.000418811343
  error estimate for blocks of size 2^( 7) =       0.000420645308

      target function =                  N/A
              le_mean =     -17.216030334468
             les_mean =     296.703946568666
             stat err =       0.000416832135
             autocorr =       1.164805592175
              std dev =       0.546197197034
             le_variance =       0.298331378048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216030334468        initial  <--
     3.6380e+08     3.6380e+09             8.9328e-13       -17.216030334468
     1.4552e+09     1.4552e+10             2.2332e-13       -17.216030334468
     5.8208e+09     5.8208e+10             5.5830e-14       -17.216030334468

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9140
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2819
    reference variance = 0.198596
====================================================
  Execution time = 1.4396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1561e-01
  Total weights = 1.956515983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299069049364
                                         uncertainty =       0.002098921992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299069049364
                                         uncertainty =       0.002098921992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386717985
  error estimate for blocks of size 2^( 2) =       0.000396719761
  error estimate for blocks of size 2^( 3) =       0.000406385691
  error estimate for blocks of size 2^( 4) =       0.000412738352
  error estimate for blocks of size 2^( 5) =       0.000416929463
  error estimate for blocks of size 2^( 6) =       0.000420136982
  error estimate for blocks of size 2^( 7) =       0.000420633567

      target function =                  N/A
              le_mean =     -17.216533935819
             les_mean =     296.724646538872
             stat err =       0.000417609591
             autocorr =       1.166144016403
              std dev =       0.546901819005
             le_variance =       0.299101599631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653393582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533935871       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533935871       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533935871       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216533935871       residual = 2.24e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 9.855347e-14

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533935871       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533935871       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533935871       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216536650346       residual = 4.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+10 is 2.465524e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216533935871       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216533935871       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216533935871       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216533935871       residual = 2.44e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+10 is 6.158603e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6918e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.292128
====================================================
  Execution time = 1.3560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1324e-01
  Total weights = 1.9568e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385602568
  error estimate for blocks of size 2^( 2) =       0.000395824616
  error estimate for blocks of size 2^( 3) =       0.000404928784
  error estimate for blocks of size 2^( 4) =       0.000411226873
  error estimate for blocks of size 2^( 5) =       0.000415810348
  error estimate for blocks of size 2^( 6) =       0.000418605950
  error estimate for blocks of size 2^( 7) =       0.000421611735

      target function =                  N/A
              le_mean =     -17.216708645988
             les_mean =     296.728300779279
             stat err =       0.000416813726
             autocorr =       1.168434014637
              std dev =       0.545324380685
             le_variance =       0.297378680169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385602568
  error estimate for blocks of size 2^( 2) =       0.000395824616
  error estimate for blocks of size 2^( 3) =       0.000404928784
  error estimate for blocks of size 2^( 4) =       0.000411226873
  error estimate for blocks of size 2^( 5) =       0.000415810348
  error estimate for blocks of size 2^( 6) =       0.000418605950
  error estimate for blocks of size 2^( 7) =       0.000421611735

      target function =                  N/A
              le_mean =     -17.216708645988
             les_mean =     296.728300779278
             stat err =       0.000416813726
             autocorr =       1.168434014649
              std dev =       0.545324380685
             le_variance =       0.297378680169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385602568
  error estimate for blocks of size 2^( 2) =       0.000395824616
  error estimate for blocks of size 2^( 3) =       0.000404928784
  error estimate for blocks of size 2^( 4) =       0.000411226873
  error estimate for blocks of size 2^( 5) =       0.000415810348
  error estimate for blocks of size 2^( 6) =       0.000418605950
  error estimate for blocks of size 2^( 7) =       0.000421611735

      target function =                  N/A
              le_mean =     -17.216708645988
             les_mean =     296.728300779278
             stat err =       0.000416813726
             autocorr =       1.168434014638
              std dev =       0.545324380685
             le_variance =       0.297378680169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297354646297
                                         uncertainty =       0.002113874581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385602568
  error estimate for blocks of size 2^( 2) =       0.000395824616
  error estimate for blocks of size 2^( 3) =       0.000404928784
  error estimate for blocks of size 2^( 4) =       0.000411226873
  error estimate for blocks of size 2^( 5) =       0.000415810348
  error estimate for blocks of size 2^( 6) =       0.000418605950
  error estimate for blocks of size 2^( 7) =       0.000421611735

      target function =                  N/A
              le_mean =     -17.216708645988
             les_mean =     296.728300779279
             stat err =       0.000416813726
             autocorr =       1.168434014636
              std dev =       0.545324380685
             le_variance =       0.297378680169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216708645988        initial  <--
     3.6380e+09     3.6380e+10             9.8553e-14       -17.216708645988
     1.4552e+10     1.4552e+11             2.4655e-14       -17.216708645988
     5.8208e+10     5.8208e+11             6.1586e-15       -17.216708645988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7777
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2823
    reference variance = 0.236057
====================================================
  Execution time = 1.4387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0769e-01
  Total weights = 1.956541024e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295815251305
                                         uncertainty =       0.001603539272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295815251305
                                         uncertainty =       0.001603539272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384562899
  error estimate for blocks of size 2^( 2) =       0.000394640337
  error estimate for blocks of size 2^( 3) =       0.000403469264
  error estimate for blocks of size 2^( 4) =       0.000409721534
  error estimate for blocks of size 2^( 5) =       0.000414252506
  error estimate for blocks of size 2^( 6) =       0.000416947420
  error estimate for blocks of size 2^( 7) =       0.000416650032

      target function =                  N/A
              le_mean =     -17.216950330304
             les_mean =     296.731069315905
             stat err =       0.000414392873
             autocorr =       1.161153909453
              std dev =       0.543854067563
             le_variance =       0.295777246805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695033030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216950330357       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216950330357       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216950330357       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216942199492       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+10 is 1.121494e-14

solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216950330357       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216950330357       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216950330357       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216950330357       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216993578337       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+11 is 2.786542e-15

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216950330357       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216950330357       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216950330357       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217175518337       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217449571242       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216883409436       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217327743186       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217095657784       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216712250694       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217179803285       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216939778392       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217019818598       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216895291406       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216530307553       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217335094963       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216627178445       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216748120702       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217156958268       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217167646540       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216965113049       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216787682835       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216651209166       residual = 5.45e-06           smallest_sin_value = 9.99e-01
davidson iteration   22:   krylov dim =  23   energy =     -17.217218935013       residual = 1.32e-05           smallest_sin_value = 9.98e-01
davidson iteration   23 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+11 is 6.952197e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080955 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6885e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.149
    reference variance = 0.380084
====================================================
  Execution time = 1.3532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1133e-01
  Total weights = 1.9567e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385268809
  error estimate for blocks of size 2^( 2) =       0.000395692245
  error estimate for blocks of size 2^( 3) =       0.000404510658
  error estimate for blocks of size 2^( 4) =       0.000411322183
  error estimate for blocks of size 2^( 5) =       0.000415285551
  error estimate for blocks of size 2^( 6) =       0.000417726948
  error estimate for blocks of size 2^( 7) =       0.000419970181

      target function =                  N/A
              le_mean =     -17.216250964399
             les_mean =     296.710624023094
             stat err =       0.000416076216
             autocorr =       1.166320960803
              std dev =       0.544852375044
             le_variance =       0.296864110592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385268809
  error estimate for blocks of size 2^( 2) =       0.000395692245
  error estimate for blocks of size 2^( 3) =       0.000404510658
  error estimate for blocks of size 2^( 4) =       0.000411322183
  error estimate for blocks of size 2^( 5) =       0.000415285551
  error estimate for blocks of size 2^( 6) =       0.000417726948
  error estimate for blocks of size 2^( 7) =       0.000419970181

      target function =                  N/A
              le_mean =     -17.216250964399
             les_mean =     296.710624023095
             stat err =       0.000416076216
             autocorr =       1.166320960803
              std dev =       0.544852375044
             le_variance =       0.296864110592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385268809
  error estimate for blocks of size 2^( 2) =       0.000395692245
  error estimate for blocks of size 2^( 3) =       0.000404510658
  error estimate for blocks of size 2^( 4) =       0.000411322183
  error estimate for blocks of size 2^( 5) =       0.000415285551
  error estimate for blocks of size 2^( 6) =       0.000417726948
  error estimate for blocks of size 2^( 7) =       0.000419970181

      target function =                  N/A
              le_mean =     -17.216250964399
             les_mean =     296.710624023094
             stat err =       0.000416076216
             autocorr =       1.166320960802
              std dev =       0.544852375044
             le_variance =       0.296864110592

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296784036410
                                         uncertainty =       0.002046450170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385268809
  error estimate for blocks of size 2^( 2) =       0.000395692245
  error estimate for blocks of size 2^( 3) =       0.000404510658
  error estimate for blocks of size 2^( 4) =       0.000411322183
  error estimate for blocks of size 2^( 5) =       0.000415285551
  error estimate for blocks of size 2^( 6) =       0.000417726948
  error estimate for blocks of size 2^( 7) =       0.000419970181

      target function =                  N/A
              le_mean =     -17.216250964399
             les_mean =     296.710624023094
             stat err =       0.000416076216
             autocorr =       1.166320960804
              std dev =       0.544852375044
             le_variance =       0.296864110592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216250964399        initial  <--
     3.6380e+10     3.6380e+11             1.1215e-14       -17.216250964399
     1.4552e+11     1.4552e+12             2.7865e-15       -17.216250964399
     5.8208e+11     5.8208e+12             6.9522e-16       -17.216250964399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7651
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.230109
====================================================
  Execution time = 1.4200e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1314e-01
  Total weights = 1.956684003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298209244650
                                         uncertainty =       0.001971171272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298209244650
                                         uncertainty =       0.001971171272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386119434
  error estimate for blocks of size 2^( 2) =       0.000396429178
  error estimate for blocks of size 2^( 3) =       0.000405281550
  error estimate for blocks of size 2^( 4) =       0.000412086087
  error estimate for blocks of size 2^( 5) =       0.000415896964
  error estimate for blocks of size 2^( 6) =       0.000418798325
  error estimate for blocks of size 2^( 7) =       0.000420381048

      target function =                  N/A
              le_mean =     -17.215509348426
             les_mean =     296.686903060109
             stat err =       0.000416790606
             autocorr =       1.165178662491
              std dev =       0.546055339772
             le_variance =       0.298176434094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721550934843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215509348465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215509348465       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215509348465       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215550591236       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215509348465       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215435247602       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216013606445       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215403077197       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215477244426       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215510369933       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215373782848       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215727775780       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215638571133       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215491274556       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215422919000       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215385718432       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215487664741       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215746079217       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215152837878       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215545867461       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215886530507       residual = 1.96e-06           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -17.216147280497       residual = 6.72e-06           smallest_sin_value = 9.97e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+11 is 9.938206e-16

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215509348465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215509348465       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215509348465       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215509348465       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215509348465       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214693984155       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215630583875       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215717349331       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.218627923164       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217027677534       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215955178839       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218109072839       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214429112831       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217363763079       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.212411618820       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215587383373       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218218616385       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213674215268       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214498101052       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216403005487       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219452753040       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216098417952       residual = 2.10e-05           smallest_sin_value = 9.99e-01
davidson iteration   22:   krylov dim =  23   energy =     -17.216150396262       residual = 1.87e-04           smallest_sin_value = 9.99e-01
davidson iteration   23 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+12 is 2.488238e-16

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215509348465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215509348465       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6740e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2654
    reference variance = 0.295963
====================================================
  Execution time = 1.3904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0971e-01
  Total weights = 1.9566e+06
  Execution time = 1.8349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384665905
  error estimate for blocks of size 2^( 2) =       0.000394584286
  error estimate for blocks of size 2^( 3) =       0.000403696662
  error estimate for blocks of size 2^( 4) =       0.000409604786
  error estimate for blocks of size 2^( 5) =       0.000414230011
  error estimate for blocks of size 2^( 6) =       0.000417378385
  error estimate for blocks of size 2^( 7) =       0.000420122758

      target function =                  N/A
              le_mean =     -17.216369048787
             les_mean =     296.713074314499
             stat err =       0.000415333985
             autocorr =       1.165809388986
              std dev =       0.543999740144
             le_variance =       0.295935717277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384665905
  error estimate for blocks of size 2^( 2) =       0.000394584286
  error estimate for blocks of size 2^( 3) =       0.000403696662
  error estimate for blocks of size 2^( 4) =       0.000409604786
  error estimate for blocks of size 2^( 5) =       0.000414230011
  error estimate for blocks of size 2^( 6) =       0.000417378385
  error estimate for blocks of size 2^( 7) =       0.000420122758

      target function =                  N/A
              le_mean =     -17.216369048787
             les_mean =     296.713074314499
             stat err =       0.000415333985
             autocorr =       1.165809388986
              std dev =       0.543999740144
             le_variance =       0.295935717277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384665905
  error estimate for blocks of size 2^( 2) =       0.000394584286
  error estimate for blocks of size 2^( 3) =       0.000403696662
  error estimate for blocks of size 2^( 4) =       0.000409604786
  error estimate for blocks of size 2^( 5) =       0.000414230011
  error estimate for blocks of size 2^( 6) =       0.000417378385
  error estimate for blocks of size 2^( 7) =       0.000420122758

      target function =                  N/A
              le_mean =     -17.216369048787
             les_mean =     296.713074314499
             stat err =       0.000415333985
             autocorr =       1.165809388983
              std dev =       0.543999740144
             le_variance =       0.295935717277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295924974420
                                         uncertainty =       0.001768475840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384665905
  error estimate for blocks of size 2^( 2) =       0.000394584286
  error estimate for blocks of size 2^( 3) =       0.000403696662
  error estimate for blocks of size 2^( 4) =       0.000409604786
  error estimate for blocks of size 2^( 5) =       0.000414230011
  error estimate for blocks of size 2^( 6) =       0.000417378385
  error estimate for blocks of size 2^( 7) =       0.000420122758

      target function =                  N/A
              le_mean =     -17.216369048787
             les_mean =     296.713074314499
             stat err =       0.000415333985
             autocorr =       1.165809388986
              std dev =       0.543999740144
             le_variance =       0.295935717277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216369048787        initial  <--
     3.6380e+11     3.6380e+12             9.9382e-16       -17.216369048787
     1.4552e+12     1.4552e+13             2.4882e-16       -17.216369048787
     5.8208e+12     5.8208e+13             0.0000e+00       -17.216369048787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1306
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.3045
    reference variance = 0.205704
====================================================
  Execution time = 1.4699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1048e-01
  Total weights = 1.956628520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294754158461
                                         uncertainty =       0.001825655575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294754158461
                                         uncertainty =       0.001825655575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383988286
  error estimate for blocks of size 2^( 2) =       0.000394226085
  error estimate for blocks of size 2^( 3) =       0.000403272096
  error estimate for blocks of size 2^( 4) =       0.000410154179
  error estimate for blocks of size 2^( 5) =       0.000414222127
  error estimate for blocks of size 2^( 6) =       0.000417674331
  error estimate for blocks of size 2^( 7) =       0.000419377119

      target function =                  N/A
              le_mean =     -17.216587472183
             les_mean =     296.721366847432
             stat err =       0.000415356939
             autocorr =       1.170056921656
              std dev =       0.543041441272
             le_variance =       0.294894006939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658747218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587472270       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587472270       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587472270       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216366216031       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216770685488       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217028282879       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214212010928       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214738012821       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214433057497       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214466065374       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216989935978       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216047788159       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213595890752       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216934656888       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216540928450       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214726557833       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213417973602       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215045685630       residual = 6.97e-04           smallest_sin_value = 9.98e-01
davidson iteration   18 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+12 is 7.641218e-17

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587472270       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587472270       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587472270       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587472270       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211877559161       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213686173691       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215118815059       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218725687237       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216791719194       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.208694991753       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.202880578058       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.205493046358       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.197899857962       residual = 6.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.238112521701       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.219287142495       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.234118673102       residual = 7.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.200323000587       residual = 5.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.239852835939       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211210822465       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217867541426       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218225824468       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.224898417676       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218382878954       residual = 4.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218028612498       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.193963932360       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.205800921227       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.213284339648       residual = 3.95e-02           smallest_sin_value = 9.97e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+13 is 1.879813e-17

solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587472270       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587472270       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587472270       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587472270       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.228576610065       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587452891       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.231610490137       residual = 9.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.181227261456       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.204710721488       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.157993985348       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.229457180237       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.306582173151       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.226939589135       residual = 9.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.078136112816       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.979280978571       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.164905082637       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.171304347371       residual = 3.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.143899256956       residual = 2.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213023841247       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.243857148682       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.251444126245       residual = 1.43e-01           smallest_sin_value = 9.99e-01
davidson iteration   21:   krylov dim =  22   energy =     -17.163624001556       residual = 3.38e-01           smallest_sin_value = 9.96e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+13 is 4.699533e-18

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7204e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.355592
====================================================
  Execution time = 1.4711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1427e-01
  Total weights = 1.9565e+06
  Execution time = 1.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641590
  error estimate for blocks of size 2^( 2) =       0.000396674614
  error estimate for blocks of size 2^( 3) =       0.000405573399
  error estimate for blocks of size 2^( 4) =       0.000412753742
  error estimate for blocks of size 2^( 5) =       0.000416562977
  error estimate for blocks of size 2^( 6) =       0.000418381375
  error estimate for blocks of size 2^( 7) =       0.000420963103

      target function =                  N/A
              le_mean =     -17.215980129616
             les_mean =     296.704245982193
             stat err =       0.000417165300
             autocorr =       1.164123927210
              std dev =       0.546793780306
             le_variance =       0.298983438182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641590
  error estimate for blocks of size 2^( 2) =       0.000396674614
  error estimate for blocks of size 2^( 3) =       0.000405573399
  error estimate for blocks of size 2^( 4) =       0.000412753742
  error estimate for blocks of size 2^( 5) =       0.000416562977
  error estimate for blocks of size 2^( 6) =       0.000418381375
  error estimate for blocks of size 2^( 7) =       0.000420963103

      target function =                  N/A
              le_mean =     -17.215980129616
             les_mean =     296.704245982193
             stat err =       0.000417165300
             autocorr =       1.164123927211
              std dev =       0.546793780306
             le_variance =       0.298983438182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641590
  error estimate for blocks of size 2^( 2) =       0.000396674614
  error estimate for blocks of size 2^( 3) =       0.000405573399
  error estimate for blocks of size 2^( 4) =       0.000412753742
  error estimate for blocks of size 2^( 5) =       0.000416562977
  error estimate for blocks of size 2^( 6) =       0.000418381375
  error estimate for blocks of size 2^( 7) =       0.000420963103

      target function =                  N/A
              le_mean =     -17.215980129616
             les_mean =     296.704245982193
             stat err =       0.000417165300
             autocorr =       1.164123927211
              std dev =       0.546793780306
             le_variance =       0.298983438182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968164005
                                         uncertainty =       0.001912616292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641590
  error estimate for blocks of size 2^( 2) =       0.000396674614
  error estimate for blocks of size 2^( 3) =       0.000405573399
  error estimate for blocks of size 2^( 4) =       0.000412753742
  error estimate for blocks of size 2^( 5) =       0.000416562977
  error estimate for blocks of size 2^( 6) =       0.000418381375
  error estimate for blocks of size 2^( 7) =       0.000420963103

      target function =                  N/A
              le_mean =     -17.215980129616
             les_mean =     296.704245982193
             stat err =       0.000417165300
             autocorr =       1.164123927211
              std dev =       0.546793780306
             le_variance =       0.298983438182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215980129616        initial  <--
     3.6380e+12     3.6380e+13             7.6412e-17       -17.215980129616
     1.4552e+13     1.4552e+14             1.8798e-17       -17.215980129616
     5.8208e+13     5.8208e+14             4.6995e-18       -17.215980129616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0006
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2595
    reference variance = 0.27642
====================================================
  Execution time = 1.4281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1431e-01
  Total weights = 1.956585344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300253370582
                                         uncertainty =       0.002683745695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300253370582
                                         uncertainty =       0.002683745695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387471068
  error estimate for blocks of size 2^( 2) =       0.000397596508
  error estimate for blocks of size 2^( 3) =       0.000407156707
  error estimate for blocks of size 2^( 4) =       0.000413896394
  error estimate for blocks of size 2^( 5) =       0.000418625492
  error estimate for blocks of size 2^( 6) =       0.000420554329
  error estimate for blocks of size 2^( 7) =       0.000421488779

      target function =                  N/A
              le_mean =     -17.217109904075
             les_mean =     296.743180239658
             stat err =       0.000418641249
             autocorr =       1.167361793226
              std dev =       0.547966839047
             le_variance =       0.300267656695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710990407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+13, overlap shift 3.6380e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109904160       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109904160       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109904160       residual = 8.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218652179287       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213496965264       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217691540221       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.212388650285       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.266333361330       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.202295244782       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.264644103124       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.189112766780       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.147034107501       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.189060683692       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.272856116783       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.227725154511       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.301643203542       residual = 7.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.264415074474       residual = 5.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.247163431899       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.182718049141       residual = 5.50e-01           smallest_sin_value = 9.95e-01
davidson iteration   19 stopping due to small subspace S singular value of 9.48e-01
davidson solver did not converge after         19 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+13 is 1.038089e-17

solving harmonic davidson linear method for identity shift 1.4552e+14, overlap shift 1.4552e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109904160       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109904160       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109904160       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109904160       residual = 3.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109904160       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.400991731955       residual = 5.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.423110205663       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.302477407059       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.164751755484       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.230475351213       residual = 2.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.266353112126       residual = 9.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.263299495743       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.172130213632       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.225912093771       residual = 2.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.209937369709       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.184757295692       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.158749967722       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.382876812524       residual = 7.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.221341601965       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.251174906031       residual = 6.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.279627035837       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.246351256260       residual = 6.56e-01           smallest_sin_value = 9.99e-01
davidson iteration   22:   krylov dim =  23   energy =     -17.422143187979       residual = 8.75e-01           smallest_sin_value = 9.99e-01
davidson iteration   23:   krylov dim =  24   energy =     -17.180661642702       residual = 9.34e+00           smallest_sin_value = 9.96e-01
davidson iteration   24: stopping due to imaginary component in cost function
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+14 is 2.626795e-18

solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109904160       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217109904160       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217109904160       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217109904160       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217109907433       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.312810737185       residual = 6.30e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.193007961567       residual = 7.07e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.122873483109       residual = 1.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.158708544418       residual = 3.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.927792533380       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.206992008769       residual = 1.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.149535603378       residual = 2.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.226857040172       residual = 1.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.061746831852       residual = 7.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.185873839211       residual = 8.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.044149661709       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.048148434695       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   17: stopping due to imaginary component in cost function
davidson solver did not converge after         17 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+14 is 6.488058e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6781e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2548
    reference variance = 0.180655
====================================================
  Execution time = 1.6258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1378e-01
  Total weights = 1.9564e+06
  Execution time = 1.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386780741
  error estimate for blocks of size 2^( 2) =       0.000396677105
  error estimate for blocks of size 2^( 3) =       0.000405452840
  error estimate for blocks of size 2^( 4) =       0.000412479113
  error estimate for blocks of size 2^( 5) =       0.000415625853
  error estimate for blocks of size 2^( 6) =       0.000417343258
  error estimate for blocks of size 2^( 7) =       0.000419581734

      target function =                  N/A
              le_mean =     -17.216243558407
             les_mean =     296.712825773657
             stat err =       0.000416257489
             autocorr =       1.158229011929
              std dev =       0.546990569414
             le_variance =       0.299198683028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386780741
  error estimate for blocks of size 2^( 2) =       0.000396677105
  error estimate for blocks of size 2^( 3) =       0.000405452840
  error estimate for blocks of size 2^( 4) =       0.000412479113
  error estimate for blocks of size 2^( 5) =       0.000415625853
  error estimate for blocks of size 2^( 6) =       0.000417343258
  error estimate for blocks of size 2^( 7) =       0.000419581734

      target function =                  N/A
              le_mean =     -17.216243558407
             les_mean =     296.712825773657
             stat err =       0.000416257489
             autocorr =       1.158229011930
              std dev =       0.546990569414
             le_variance =       0.299198683028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386780741
  error estimate for blocks of size 2^( 2) =       0.000396677105
  error estimate for blocks of size 2^( 3) =       0.000405452840
  error estimate for blocks of size 2^( 4) =       0.000412479113
  error estimate for blocks of size 2^( 5) =       0.000415625853
  error estimate for blocks of size 2^( 6) =       0.000417343258
  error estimate for blocks of size 2^( 7) =       0.000419581734

      target function =                  N/A
              le_mean =     -17.216243558407
             les_mean =     296.712825773657
             stat err =       0.000416257489
             autocorr =       1.158229011928
              std dev =       0.546990569414
             le_variance =       0.299198683028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299034954922
                                         uncertainty =       0.002248673046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386780741
  error estimate for blocks of size 2^( 2) =       0.000396677105
  error estimate for blocks of size 2^( 3) =       0.000405452840
  error estimate for blocks of size 2^( 4) =       0.000412479113
  error estimate for blocks of size 2^( 5) =       0.000415625853
  error estimate for blocks of size 2^( 6) =       0.000417343258
  error estimate for blocks of size 2^( 7) =       0.000419581734

      target function =                  N/A
              le_mean =     -17.216243558407
             les_mean =     296.712825773657
             stat err =       0.000416257489
             autocorr =       1.158229011932
              std dev =       0.546990569414
             le_variance =       0.299198683028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216243558407        initial  <--
     3.6380e+13     3.6380e+14             1.0381e-17       -17.216243558407
     1.4552e+14     1.4552e+15             2.6268e-18       -17.216243558407
     5.8208e+14     5.8208e+15             6.4881e-19       -17.216243558407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.5245
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1678
    reference variance = 0.202223
====================================================
  Execution time = 1.4561e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1216e-01
  Total weights = 1.956701030e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298424494174
                                         uncertainty =       0.001933691503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298424494174
                                         uncertainty =       0.001933691503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386225842
  error estimate for blocks of size 2^( 2) =       0.000396317451
  error estimate for blocks of size 2^( 3) =       0.000405823604
  error estimate for blocks of size 2^( 4) =       0.000413183700
  error estimate for blocks of size 2^( 5) =       0.000416412588
  error estimate for blocks of size 2^( 6) =       0.000418334313
  error estimate for blocks of size 2^( 7) =       0.000419748964

      target function =                  N/A
              le_mean =     -17.216313656574
             les_mean =     296.713618196130
             stat err =       0.000416919891
             autocorr =       1.165259290916
              std dev =       0.546205823752
             le_variance =       0.298340801901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631365657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+14, overlap shift 3.6380e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+15, overlap shift 1.4552e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216313656608       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.38e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7102e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.170023
====================================================
  Execution time = 1.4115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1052e-01
  Total weights = 1.9566e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385175425
  error estimate for blocks of size 2^( 2) =       0.000395114723
  error estimate for blocks of size 2^( 3) =       0.000404327818
  error estimate for blocks of size 2^( 4) =       0.000411042130
  error estimate for blocks of size 2^( 5) =       0.000415469730
  error estimate for blocks of size 2^( 6) =       0.000417372449
  error estimate for blocks of size 2^( 7) =       0.000419874466

      target function =                  N/A
              le_mean =     -17.216097550102
             les_mean =     296.704538753837
             stat err =       0.000415939694
             autocorr =       1.166120943614
              std dev =       0.544720309517
             le_variance =       0.296720215600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385175425
  error estimate for blocks of size 2^( 2) =       0.000395114723
  error estimate for blocks of size 2^( 3) =       0.000404327818
  error estimate for blocks of size 2^( 4) =       0.000411042130
  error estimate for blocks of size 2^( 5) =       0.000415469730
  error estimate for blocks of size 2^( 6) =       0.000417372449
  error estimate for blocks of size 2^( 7) =       0.000419874466

      target function =                  N/A
              le_mean =     -17.216097550102
             les_mean =     296.704538753837
             stat err =       0.000415939694
             autocorr =       1.166120943614
              std dev =       0.544720309517
             le_variance =       0.296720215600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385175425
  error estimate for blocks of size 2^( 2) =       0.000395114723
  error estimate for blocks of size 2^( 3) =       0.000404327818
  error estimate for blocks of size 2^( 4) =       0.000411042130
  error estimate for blocks of size 2^( 5) =       0.000415469730
  error estimate for blocks of size 2^( 6) =       0.000417372449
  error estimate for blocks of size 2^( 7) =       0.000419874466

      target function =                  N/A
              le_mean =     -17.216097550102
             les_mean =     296.704538753837
             stat err =       0.000415939694
             autocorr =       1.166120943614
              std dev =       0.544720309517
             le_variance =       0.296720215600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296728476669
                                         uncertainty =       0.001820958540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385175425
  error estimate for blocks of size 2^( 2) =       0.000395114723
  error estimate for blocks of size 2^( 3) =       0.000404327818
  error estimate for blocks of size 2^( 4) =       0.000411042130
  error estimate for blocks of size 2^( 5) =       0.000415469730
  error estimate for blocks of size 2^( 6) =       0.000417372449
  error estimate for blocks of size 2^( 7) =       0.000419874466

      target function =                  N/A
              le_mean =     -17.216097550102
             les_mean =     296.704538753837
             stat err =       0.000415939694
             autocorr =       1.166120943614
              std dev =       0.544720309517
             le_variance =       0.296720215600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216097550102        initial  <--
     3.6380e+14     3.6380e+15             0.0000e+00       -17.216097550102
     1.4552e+15     1.4552e+16             0.0000e+00       -17.216097550102
     5.8208e+15     5.8208e+16             0.0000e+00       -17.216097550102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3360
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2662
    reference variance = 0.504547
====================================================
  Execution time = 1.3626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2107e-01
  Total weights = 1.956925451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305792442374
                                         uncertainty =       0.003722355252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305792442374
                                         uncertainty =       0.003722355252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391045032
  error estimate for blocks of size 2^( 2) =       0.000400837484
  error estimate for blocks of size 2^( 3) =       0.000409543560
  error estimate for blocks of size 2^( 4) =       0.000416272854
  error estimate for blocks of size 2^( 5) =       0.000420853810
  error estimate for blocks of size 2^( 6) =       0.000422442422
  error estimate for blocks of size 2^( 7) =       0.000424515218

      target function =                  N/A
              le_mean =     -17.215942209328
             les_mean =     296.709733373437
             stat err =       0.000421021076
             autocorr =       1.159188671855
              std dev =       0.553021187405
             le_variance =       0.305832433718


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721594220933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+15, overlap shift 3.6380e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+16, overlap shift 1.4552e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215942209331       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6163e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1499
    reference variance = 0.396913
====================================================
  Execution time = 1.3323e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1595e-01
  Total weights = 1.9569e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386855675
  error estimate for blocks of size 2^( 2) =       0.000396997545
  error estimate for blocks of size 2^( 3) =       0.000406630166
  error estimate for blocks of size 2^( 4) =       0.000413641866
  error estimate for blocks of size 2^( 5) =       0.000417668102
  error estimate for blocks of size 2^( 6) =       0.000420913644
  error estimate for blocks of size 2^( 7) =       0.000423519532

      target function =                  N/A
              le_mean =     -17.216107117855
             les_mean =     296.710293129161
             stat err =       0.000418935786
             autocorr =       1.172727136184
              std dev =       0.547096542708
             le_variance =       0.299314627043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386855675
  error estimate for blocks of size 2^( 2) =       0.000396997545
  error estimate for blocks of size 2^( 3) =       0.000406630166
  error estimate for blocks of size 2^( 4) =       0.000413641866
  error estimate for blocks of size 2^( 5) =       0.000417668102
  error estimate for blocks of size 2^( 6) =       0.000420913644
  error estimate for blocks of size 2^( 7) =       0.000423519532

      target function =                  N/A
              le_mean =     -17.216107117855
             les_mean =     296.710293129161
             stat err =       0.000418935786
             autocorr =       1.172727136184
              std dev =       0.547096542708
             le_variance =       0.299314627043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386855675
  error estimate for blocks of size 2^( 2) =       0.000396997545
  error estimate for blocks of size 2^( 3) =       0.000406630166
  error estimate for blocks of size 2^( 4) =       0.000413641866
  error estimate for blocks of size 2^( 5) =       0.000417668102
  error estimate for blocks of size 2^( 6) =       0.000420913644
  error estimate for blocks of size 2^( 7) =       0.000423519532

      target function =                  N/A
              le_mean =     -17.216107117855
             les_mean =     296.710293129161
             stat err =       0.000418935786
             autocorr =       1.172727136184
              std dev =       0.547096542708
             le_variance =       0.299314627043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299194862620
                                         uncertainty =       0.001959732295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386855675
  error estimate for blocks of size 2^( 2) =       0.000396997545
  error estimate for blocks of size 2^( 3) =       0.000406630166
  error estimate for blocks of size 2^( 4) =       0.000413641866
  error estimate for blocks of size 2^( 5) =       0.000417668102
  error estimate for blocks of size 2^( 6) =       0.000420913644
  error estimate for blocks of size 2^( 7) =       0.000423519532

      target function =                  N/A
              le_mean =     -17.216107117855
             les_mean =     296.710293129161
             stat err =       0.000418935786
             autocorr =       1.172727136184
              std dev =       0.547096542708
             le_variance =       0.299314627043


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216107117855        initial  <--
     3.6380e+15     3.6380e+16             0.0000e+00       -17.216107117855
     1.4552e+16     1.4552e+17             0.0000e+00       -17.216107117855
     5.8208e+16     5.8208e+17             0.0000e+00       -17.216107117855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5555
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8817e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.24681
====================================================
  Execution time = 1.3590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1677e-01
  Total weights = 1.956778798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301642520221
                                         uncertainty =       0.002586140014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301642520221
                                         uncertainty =       0.002586140014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388370594
  error estimate for blocks of size 2^( 2) =       0.000398647650
  error estimate for blocks of size 2^( 3) =       0.000407871037
  error estimate for blocks of size 2^( 4) =       0.000414652931
  error estimate for blocks of size 2^( 5) =       0.000419546590
  error estimate for blocks of size 2^( 6) =       0.000423165775
  error estimate for blocks of size 2^( 7) =       0.000425101426

      target function =                  N/A
              le_mean =     -17.217048272406
             les_mean =     296.743522490064
             stat err =       0.000420616680
             autocorr =       1.172952171044
              std dev =       0.549238961955
             le_variance =       0.301663437330


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704827241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+16, overlap shift 3.6380e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048272449       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048272449       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217048272449       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 9.31e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+16 is 9.169175e-21

solving harmonic davidson linear method for identity shift 1.4552e+17, overlap shift 1.4552e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048272449       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048272449       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217048272449       residual = 3.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217048272448       residual = 9.64e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217048209852       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217048127086       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+17 is 2.292294e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048272449       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048272449       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217048272449       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+17 is 5.730734e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6065e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.176
    reference variance = 0.137005
====================================================
  Execution time = 1.3537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1357e-01
  Total weights = 1.9567e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386670697
  error estimate for blocks of size 2^( 2) =       0.000396631744
  error estimate for blocks of size 2^( 3) =       0.000405782549
  error estimate for blocks of size 2^( 4) =       0.000412774346
  error estimate for blocks of size 2^( 5) =       0.000417882121
  error estimate for blocks of size 2^( 6) =       0.000420353998
  error estimate for blocks of size 2^( 7) =       0.000421530298

      target function =                  N/A
              le_mean =     -17.216499958003
             les_mean =     296.721445457663
             stat err =       0.000418135191
             autocorr =       1.169367225566
              std dev =       0.546834943806
             le_variance =       0.299028455768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386670697
  error estimate for blocks of size 2^( 2) =       0.000396631744
  error estimate for blocks of size 2^( 3) =       0.000405782549
  error estimate for blocks of size 2^( 4) =       0.000412774346
  error estimate for blocks of size 2^( 5) =       0.000417882121
  error estimate for blocks of size 2^( 6) =       0.000420353998
  error estimate for blocks of size 2^( 7) =       0.000421530298

      target function =                  N/A
              le_mean =     -17.216499958003
             les_mean =     296.721445457663
             stat err =       0.000418135191
             autocorr =       1.169367225566
              std dev =       0.546834943806
             le_variance =       0.299028455768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386670697
  error estimate for blocks of size 2^( 2) =       0.000396631744
  error estimate for blocks of size 2^( 3) =       0.000405782549
  error estimate for blocks of size 2^( 4) =       0.000412774346
  error estimate for blocks of size 2^( 5) =       0.000417882121
  error estimate for blocks of size 2^( 6) =       0.000420353998
  error estimate for blocks of size 2^( 7) =       0.000421530298

      target function =                  N/A
              le_mean =     -17.216499958003
             les_mean =     296.721445457663
             stat err =       0.000418135191
             autocorr =       1.169367225566
              std dev =       0.546834943806
             le_variance =       0.299028455768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299122044324
                                         uncertainty =       0.001998907864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386670697
  error estimate for blocks of size 2^( 2) =       0.000396631744
  error estimate for blocks of size 2^( 3) =       0.000405782549
  error estimate for blocks of size 2^( 4) =       0.000412774346
  error estimate for blocks of size 2^( 5) =       0.000417882121
  error estimate for blocks of size 2^( 6) =       0.000420353998
  error estimate for blocks of size 2^( 7) =       0.000421530298

      target function =                  N/A
              le_mean =     -17.216499958003
             les_mean =     296.721445457663
             stat err =       0.000418135191
             autocorr =       1.169367225566
              std dev =       0.546834943806
             le_variance =       0.299028455768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216499958003        initial  <--
     3.6380e+16     3.6380e+17             9.1692e-21       -17.216499958003
     1.4552e+17     1.4552e+18             2.2923e-21       -17.216499958003
     5.8208e+17     5.8208e+18             5.7307e-22       -17.216499958003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7829
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2773
    reference variance = 0.395632
====================================================
  Execution time = 1.3593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1170e-01
  Total weights = 1.956861197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298122353672
                                         uncertainty =       0.001721384267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298122353672
                                         uncertainty =       0.001721384267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386088123
  error estimate for blocks of size 2^( 2) =       0.000396675399
  error estimate for blocks of size 2^( 3) =       0.000405431075
  error estimate for blocks of size 2^( 4) =       0.000412333525
  error estimate for blocks of size 2^( 5) =       0.000416203639
  error estimate for blocks of size 2^( 6) =       0.000419645146
  error estimate for blocks of size 2^( 7) =       0.000420586933

      target function =                  N/A
              le_mean =     -17.216160439514
             les_mean =     296.707877221227
             stat err =       0.000417192311
             autocorr =       1.167615109471
              std dev =       0.546011060068
             le_variance =       0.298128077717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616043951e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+17, overlap shift 3.6380e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+18, overlap shift 1.4552e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160439542       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6110e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.269
    reference variance = 0.171244
====================================================
  Execution time = 1.3314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1100e-01
  Total weights = 1.9568e+06
  Execution time = 1.8287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228207
  error estimate for blocks of size 2^( 2) =       0.000396328941
  error estimate for blocks of size 2^( 3) =       0.000405860248
  error estimate for blocks of size 2^( 4) =       0.000412844601
  error estimate for blocks of size 2^( 5) =       0.000417285543
  error estimate for blocks of size 2^( 6) =       0.000419632387
  error estimate for blocks of size 2^( 7) =       0.000422051784

      target function =                  N/A
              le_mean =     -17.216287541887
             les_mean =     296.711554983505
             stat err =       0.000417953579
             autocorr =       1.171030267924
              std dev =       0.546209168697
             le_variance =       0.298344455968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228207
  error estimate for blocks of size 2^( 2) =       0.000396328941
  error estimate for blocks of size 2^( 3) =       0.000405860248
  error estimate for blocks of size 2^( 4) =       0.000412844601
  error estimate for blocks of size 2^( 5) =       0.000417285543
  error estimate for blocks of size 2^( 6) =       0.000419632387
  error estimate for blocks of size 2^( 7) =       0.000422051784

      target function =                  N/A
              le_mean =     -17.216287541887
             les_mean =     296.711554983505
             stat err =       0.000417953579
             autocorr =       1.171030267924
              std dev =       0.546209168697
             le_variance =       0.298344455968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228207
  error estimate for blocks of size 2^( 2) =       0.000396328941
  error estimate for blocks of size 2^( 3) =       0.000405860248
  error estimate for blocks of size 2^( 4) =       0.000412844601
  error estimate for blocks of size 2^( 5) =       0.000417285543
  error estimate for blocks of size 2^( 6) =       0.000419632387
  error estimate for blocks of size 2^( 7) =       0.000422051784

      target function =                  N/A
              le_mean =     -17.216287541887
             les_mean =     296.711554983505
             stat err =       0.000417953579
             autocorr =       1.171030267924
              std dev =       0.546209168697
             le_variance =       0.298344455968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298379465878
                                         uncertainty =       0.001697211125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228207
  error estimate for blocks of size 2^( 2) =       0.000396328941
  error estimate for blocks of size 2^( 3) =       0.000405860248
  error estimate for blocks of size 2^( 4) =       0.000412844601
  error estimate for blocks of size 2^( 5) =       0.000417285543
  error estimate for blocks of size 2^( 6) =       0.000419632387
  error estimate for blocks of size 2^( 7) =       0.000422051784

      target function =                  N/A
              le_mean =     -17.216287541887
             les_mean =     296.711554983505
             stat err =       0.000417953579
             autocorr =       1.171030267924
              std dev =       0.546209168697
             le_variance =       0.298344455968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216287541887        initial  <--
     3.6380e+17     3.6380e+18             0.0000e+00       -17.216287541887
     1.4552e+18     1.4552e+19             0.0000e+00       -17.216287541887
     5.8208e+18     5.8208e+19             0.0000e+00       -17.216287541887

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5116
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8644e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.3065
    reference variance = 1.05047
====================================================
  Execution time = 1.3649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1503e-01
  Total weights = 1.956856396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300606702166
                                         uncertainty =       0.001841106419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300606702166
                                         uncertainty =       0.001841106419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387781291
  error estimate for blocks of size 2^( 2) =       0.000397424291
  error estimate for blocks of size 2^( 3) =       0.000406187115
  error estimate for blocks of size 2^( 4) =       0.000412515428
  error estimate for blocks of size 2^( 5) =       0.000416817753
  error estimate for blocks of size 2^( 6) =       0.000419237034
  error estimate for blocks of size 2^( 7) =       0.000421784427

      target function =                  N/A
              le_mean =     -17.216143316507
             les_mean =     296.710616433770
             stat err =       0.000417588660
             autocorr =       1.159641339737
              std dev =       0.548405561242
             le_variance =       0.300748659601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614331651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+18, overlap shift 3.6380e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+19, overlap shift 1.4552e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216143316569       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6134e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1925
    reference variance = 0.226725
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1774e-01
  Total weights = 1.9564e+06
  Execution time = 1.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389515662
  error estimate for blocks of size 2^( 2) =       0.000399196301
  error estimate for blocks of size 2^( 3) =       0.000408102079
  error estimate for blocks of size 2^( 4) =       0.000414392134
  error estimate for blocks of size 2^( 5) =       0.000417921046
  error estimate for blocks of size 2^( 6) =       0.000419675741
  error estimate for blocks of size 2^( 7) =       0.000419102885

      target function =                  N/A
              le_mean =     -17.216827118563
             les_mean =     296.736872079285
             stat err =       0.000417772951
             autocorr =       1.150352093205
              std dev =       0.550858331831
             le_variance =       0.303444901747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389515662
  error estimate for blocks of size 2^( 2) =       0.000399196301
  error estimate for blocks of size 2^( 3) =       0.000408102079
  error estimate for blocks of size 2^( 4) =       0.000414392134
  error estimate for blocks of size 2^( 5) =       0.000417921046
  error estimate for blocks of size 2^( 6) =       0.000419675741
  error estimate for blocks of size 2^( 7) =       0.000419102885

      target function =                  N/A
              le_mean =     -17.216827118563
             les_mean =     296.736872079285
             stat err =       0.000417772951
             autocorr =       1.150352093205
              std dev =       0.550858331831
             le_variance =       0.303444901747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389515662
  error estimate for blocks of size 2^( 2) =       0.000399196301
  error estimate for blocks of size 2^( 3) =       0.000408102079
  error estimate for blocks of size 2^( 4) =       0.000414392134
  error estimate for blocks of size 2^( 5) =       0.000417921046
  error estimate for blocks of size 2^( 6) =       0.000419675741
  error estimate for blocks of size 2^( 7) =       0.000419102885

      target function =                  N/A
              le_mean =     -17.216827118563
             les_mean =     296.736872079285
             stat err =       0.000417772951
             autocorr =       1.150352093205
              std dev =       0.550858331831
             le_variance =       0.303444901747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303497069289
                                         uncertainty =       0.002389383063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389515662
  error estimate for blocks of size 2^( 2) =       0.000399196301
  error estimate for blocks of size 2^( 3) =       0.000408102079
  error estimate for blocks of size 2^( 4) =       0.000414392134
  error estimate for blocks of size 2^( 5) =       0.000417921046
  error estimate for blocks of size 2^( 6) =       0.000419675741
  error estimate for blocks of size 2^( 7) =       0.000419102885

      target function =                  N/A
              le_mean =     -17.216827118563
             les_mean =     296.736872079285
             stat err =       0.000417772951
             autocorr =       1.150352093205
              std dev =       0.550858331831
             le_variance =       0.303444901747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216827118563        initial  <--
     3.6380e+18     3.6380e+19             0.0000e+00       -17.216827118563
     1.4552e+19     1.4552e+20             0.0000e+00       -17.216827118563
     5.8208e+19     5.8208e+20             0.0000e+00       -17.216827118563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0670
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.352233
====================================================
  Execution time = 1.4320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1070e-01
  Total weights = 1.956802643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297633295538
                                         uncertainty =       0.002128832864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297633295538
                                         uncertainty =       0.002128832864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385754525
  error estimate for blocks of size 2^( 2) =       0.000395832088
  error estimate for blocks of size 2^( 3) =       0.000404693221
  error estimate for blocks of size 2^( 4) =       0.000411522560
  error estimate for blocks of size 2^( 5) =       0.000415732912
  error estimate for blocks of size 2^( 6) =       0.000419047229
  error estimate for blocks of size 2^( 7) =       0.000420409581

      target function =                  N/A
              le_mean =     -17.216096523621
             les_mean =     296.704675115266
             stat err =       0.000416678071
             autocorr =       1.166753817886
              std dev =       0.545539280919
             le_variance =       0.297613107025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609652362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+19, overlap shift 3.6380e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+20, overlap shift 1.4552e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216096523646       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6795e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.222
    reference variance = 0.162331
====================================================
  Execution time = 1.3415e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2038e-01
  Total weights = 1.9566e+06
  Execution time = 1.8449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389001137
  error estimate for blocks of size 2^( 2) =       0.000399192485
  error estimate for blocks of size 2^( 3) =       0.000408007490
  error estimate for blocks of size 2^( 4) =       0.000414326098
  error estimate for blocks of size 2^( 5) =       0.000418483727
  error estimate for blocks of size 2^( 6) =       0.000420557673
  error estimate for blocks of size 2^( 7) =       0.000421582674

      target function =                  N/A
              le_mean =     -17.217036727862
             les_mean =     296.746730740305
             stat err =       0.000418737543
             autocorr =       1.158729487515
              std dev =       0.550130683846
             le_variance =       0.302643769309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389001137
  error estimate for blocks of size 2^( 2) =       0.000399192485
  error estimate for blocks of size 2^( 3) =       0.000408007490
  error estimate for blocks of size 2^( 4) =       0.000414326098
  error estimate for blocks of size 2^( 5) =       0.000418483727
  error estimate for blocks of size 2^( 6) =       0.000420557673
  error estimate for blocks of size 2^( 7) =       0.000421582674

      target function =                  N/A
              le_mean =     -17.217036727862
             les_mean =     296.746730740305
             stat err =       0.000418737543
             autocorr =       1.158729487515
              std dev =       0.550130683846
             le_variance =       0.302643769309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389001137
  error estimate for blocks of size 2^( 2) =       0.000399192485
  error estimate for blocks of size 2^( 3) =       0.000408007490
  error estimate for blocks of size 2^( 4) =       0.000414326098
  error estimate for blocks of size 2^( 5) =       0.000418483727
  error estimate for blocks of size 2^( 6) =       0.000420557673
  error estimate for blocks of size 2^( 7) =       0.000421582674

      target function =                  N/A
              le_mean =     -17.217036727862
             les_mean =     296.746730740305
             stat err =       0.000418737543
             autocorr =       1.158729487515
              std dev =       0.550130683846
             le_variance =       0.302643769309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302627450493
                                         uncertainty =       0.002093108275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389001137
  error estimate for blocks of size 2^( 2) =       0.000399192485
  error estimate for blocks of size 2^( 3) =       0.000408007490
  error estimate for blocks of size 2^( 4) =       0.000414326098
  error estimate for blocks of size 2^( 5) =       0.000418483727
  error estimate for blocks of size 2^( 6) =       0.000420557673
  error estimate for blocks of size 2^( 7) =       0.000421582674

      target function =                  N/A
              le_mean =     -17.217036727862
             les_mean =     296.746730740305
             stat err =       0.000418737543
             autocorr =       1.158729487515
              std dev =       0.550130683846
             le_variance =       0.302643769309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217036727862        initial  <--
     3.6380e+19     3.6380e+20             0.0000e+00       -17.217036727862
     1.4552e+20     1.4552e+21             0.0000e+00       -17.217036727862
     5.8208e+20     5.8208e+21             0.0000e+00       -17.217036727862

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6786
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9889e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.461085
====================================================
  Execution time = 1.4249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1349e-01
  Total weights = 1.956724496e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298365376113
                                         uncertainty =       0.003799988306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298365376113
                                         uncertainty =       0.003799988306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386225813
  error estimate for blocks of size 2^( 2) =       0.000396518751
  error estimate for blocks of size 2^( 3) =       0.000405960499
  error estimate for blocks of size 2^( 4) =       0.000412865474
  error estimate for blocks of size 2^( 5) =       0.000417784489
  error estimate for blocks of size 2^( 6) =       0.000419663237
  error estimate for blocks of size 2^( 7) =       0.000420592821

      target function =                  N/A
              le_mean =     -17.217009573412
             les_mean =     296.738906130788
             stat err =       0.000417726505
             autocorr =       1.169772677816
              std dev =       0.546205782610
             le_variance =       0.298340756956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700957341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+20, overlap shift 3.6380e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009573439       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+20 is 2.558571e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+21, overlap shift 1.4552e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009573439       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+21 is 6.396428e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+21, overlap shift 5.8208e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217009573439       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217009573439       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+21 is 1.599107e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140241 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6737e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1951
    reference variance = 0.198054
====================================================
  Execution time = 1.3507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1627e-01
  Total weights = 1.9565e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388500953
  error estimate for blocks of size 2^( 2) =       0.000398249279
  error estimate for blocks of size 2^( 3) =       0.000406825751
  error estimate for blocks of size 2^( 4) =       0.000413500751
  error estimate for blocks of size 2^( 5) =       0.000417356411
  error estimate for blocks of size 2^( 6) =       0.000419419976
  error estimate for blocks of size 2^( 7) =       0.000419488228

      target function =                  N/A
              le_mean =     -17.215969826070
             les_mean =     296.705882468089
             stat err =       0.000417441341
             autocorr =       1.154534026035
              std dev =       0.549423317382
             le_variance =       0.301865981683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388500953
  error estimate for blocks of size 2^( 2) =       0.000398249279
  error estimate for blocks of size 2^( 3) =       0.000406825751
  error estimate for blocks of size 2^( 4) =       0.000413500751
  error estimate for blocks of size 2^( 5) =       0.000417356411
  error estimate for blocks of size 2^( 6) =       0.000419419976
  error estimate for blocks of size 2^( 7) =       0.000419488228

      target function =                  N/A
              le_mean =     -17.215969826070
             les_mean =     296.705882468089
             stat err =       0.000417441341
             autocorr =       1.154534026035
              std dev =       0.549423317382
             le_variance =       0.301865981683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388500953
  error estimate for blocks of size 2^( 2) =       0.000398249279
  error estimate for blocks of size 2^( 3) =       0.000406825751
  error estimate for blocks of size 2^( 4) =       0.000413500751
  error estimate for blocks of size 2^( 5) =       0.000417356411
  error estimate for blocks of size 2^( 6) =       0.000419419976
  error estimate for blocks of size 2^( 7) =       0.000419488228

      target function =                  N/A
              le_mean =     -17.215969826070
             les_mean =     296.705882468089
             stat err =       0.000417441341
             autocorr =       1.154534026035
              std dev =       0.549423317382
             le_variance =       0.301865981683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301880288554
                                         uncertainty =       0.002443408487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388500953
  error estimate for blocks of size 2^( 2) =       0.000398249279
  error estimate for blocks of size 2^( 3) =       0.000406825751
  error estimate for blocks of size 2^( 4) =       0.000413500751
  error estimate for blocks of size 2^( 5) =       0.000417356411
  error estimate for blocks of size 2^( 6) =       0.000419419976
  error estimate for blocks of size 2^( 7) =       0.000419488228

      target function =                  N/A
              le_mean =     -17.215969826070
             les_mean =     296.705882468089
             stat err =       0.000417441341
             autocorr =       1.154534026035
              std dev =       0.549423317382
             le_variance =       0.301865981683


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215969826070        initial  <--
     3.6380e+20     3.6380e+21             2.5586e-24       -17.215969826070
     1.4552e+21     1.4552e+22             6.3964e-25       -17.215969826070
     5.8208e+21     5.8208e+22             1.5991e-25       -17.215969826070

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7754
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2091
    reference variance = 0.290962
====================================================
  Execution time = 1.6226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1981e-01
  Total weights = 1.956514377e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304710954554
                                         uncertainty =       0.002276544701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304710954554
                                         uncertainty =       0.002276544701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390255684
  error estimate for blocks of size 2^( 2) =       0.000400401167
  error estimate for blocks of size 2^( 3) =       0.000409349389
  error estimate for blocks of size 2^( 4) =       0.000416564714
  error estimate for blocks of size 2^( 5) =       0.000420714899
  error estimate for blocks of size 2^( 6) =       0.000423795514
  error estimate for blocks of size 2^( 7) =       0.000424144870

      target function =                  N/A
              le_mean =     -17.217136190172
             les_mean =     296.749591852859
             stat err =       0.000421304999
             autocorr =       1.165452961939
              std dev =       0.551904881567
             le_variance =       0.304598998297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713619017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+21, overlap shift 3.6380e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+22, overlap shift 1.4552e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+22, overlap shift 5.8208e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217136190213       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8743e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.248065
====================================================
  Execution time = 1.3301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1469e-01
  Total weights = 1.9567e+06
  Execution time = 1.8484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387646528
  error estimate for blocks of size 2^( 2) =       0.000397622085
  error estimate for blocks of size 2^( 3) =       0.000406727476
  error estimate for blocks of size 2^( 4) =       0.000413343899
  error estimate for blocks of size 2^( 5) =       0.000417750224
  error estimate for blocks of size 2^( 6) =       0.000419942511
  error estimate for blocks of size 2^( 7) =       0.000421378948

      target function =                  N/A
              le_mean =     -17.216747483402
             les_mean =     296.731083591365
             stat err =       0.000418103896
             autocorr =       1.163313134706
              std dev =       0.548214976925
             le_variance =       0.300539660925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387646528
  error estimate for blocks of size 2^( 2) =       0.000397622085
  error estimate for blocks of size 2^( 3) =       0.000406727476
  error estimate for blocks of size 2^( 4) =       0.000413343899
  error estimate for blocks of size 2^( 5) =       0.000417750224
  error estimate for blocks of size 2^( 6) =       0.000419942511
  error estimate for blocks of size 2^( 7) =       0.000421378948

      target function =                  N/A
              le_mean =     -17.216747483402
             les_mean =     296.731083591365
             stat err =       0.000418103896
             autocorr =       1.163313134706
              std dev =       0.548214976925
             le_variance =       0.300539660925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387646528
  error estimate for blocks of size 2^( 2) =       0.000397622085
  error estimate for blocks of size 2^( 3) =       0.000406727476
  error estimate for blocks of size 2^( 4) =       0.000413343899
  error estimate for blocks of size 2^( 5) =       0.000417750224
  error estimate for blocks of size 2^( 6) =       0.000419942511
  error estimate for blocks of size 2^( 7) =       0.000421378948

      target function =                  N/A
              le_mean =     -17.216747483402
             les_mean =     296.731083591365
             stat err =       0.000418103896
             autocorr =       1.163313134706
              std dev =       0.548214976925
             le_variance =       0.300539660925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300431319150
                                         uncertainty =       0.001802947507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387646528
  error estimate for blocks of size 2^( 2) =       0.000397622085
  error estimate for blocks of size 2^( 3) =       0.000406727476
  error estimate for blocks of size 2^( 4) =       0.000413343899
  error estimate for blocks of size 2^( 5) =       0.000417750224
  error estimate for blocks of size 2^( 6) =       0.000419942511
  error estimate for blocks of size 2^( 7) =       0.000421378948

      target function =                  N/A
              le_mean =     -17.216747483402
             les_mean =     296.731083591365
             stat err =       0.000418103896
             autocorr =       1.163313134706
              std dev =       0.548214976925
             le_variance =       0.300539660925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216747483402        initial  <--
     3.6380e+21     3.6380e+22             0.0000e+00       -17.216747483402
     1.4552e+22     1.4552e+23             0.0000e+00       -17.216747483402
     5.8208e+22     5.8208e+23             0.0000e+00       -17.216747483402

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5925
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.304276
====================================================
  Execution time = 1.3624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1079e-01
  Total weights = 1.956412314e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297596558361
                                         uncertainty =       0.001869859199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297596558361
                                         uncertainty =       0.001869859199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385707775
  error estimate for blocks of size 2^( 2) =       0.000395550769
  error estimate for blocks of size 2^( 3) =       0.000404039545
  error estimate for blocks of size 2^( 4) =       0.000410977895
  error estimate for blocks of size 2^( 5) =       0.000414695758
  error estimate for blocks of size 2^( 6) =       0.000417483072
  error estimate for blocks of size 2^( 7) =       0.000419780256

      target function =                  N/A
              le_mean =     -17.215627598345
             les_mean =     296.688625618278
             stat err =       0.000415734245
             autocorr =       1.161755705695
              std dev =       0.545473166001
             le_variance =       0.297540974827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721562759835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+22, overlap shift 3.6380e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215627598395       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215627598395       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215627598395       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+22 is 1.033324e-26

solving harmonic davidson linear method for identity shift 1.4552e+23, overlap shift 1.4552e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215627598395       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215627598395       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215627598395       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+23 is 2.700926e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+23, overlap shift 5.8208e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215627598395       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215627598395       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215627598395       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+23 is 6.752314e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6097e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.204732
====================================================
  Execution time = 1.3352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1728e-01
  Total weights = 1.9567e+06
  Execution time = 1.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390215603
  error estimate for blocks of size 2^( 2) =       0.000400003301
  error estimate for blocks of size 2^( 3) =       0.000408720654
  error estimate for blocks of size 2^( 4) =       0.000415670636
  error estimate for blocks of size 2^( 5) =       0.000419844106
  error estimate for blocks of size 2^( 6) =       0.000422950697
  error estimate for blocks of size 2^( 7) =       0.000422673043

      target function =                  N/A
              le_mean =     -17.216563112720
             les_mean =     296.727322625327
             stat err =       0.000420284620
             autocorr =       1.160052737408
              std dev =       0.551848198485
             le_variance =       0.304536434171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390215603
  error estimate for blocks of size 2^( 2) =       0.000400003301
  error estimate for blocks of size 2^( 3) =       0.000408720654
  error estimate for blocks of size 2^( 4) =       0.000415670636
  error estimate for blocks of size 2^( 5) =       0.000419844106
  error estimate for blocks of size 2^( 6) =       0.000422950697
  error estimate for blocks of size 2^( 7) =       0.000422673043

      target function =                  N/A
              le_mean =     -17.216563112720
             les_mean =     296.727322625327
             stat err =       0.000420284620
             autocorr =       1.160052737408
              std dev =       0.551848198485
             le_variance =       0.304536434171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390215603
  error estimate for blocks of size 2^( 2) =       0.000400003301
  error estimate for blocks of size 2^( 3) =       0.000408720654
  error estimate for blocks of size 2^( 4) =       0.000415670636
  error estimate for blocks of size 2^( 5) =       0.000419844106
  error estimate for blocks of size 2^( 6) =       0.000422950697
  error estimate for blocks of size 2^( 7) =       0.000422673043

      target function =                  N/A
              le_mean =     -17.216563112720
             les_mean =     296.727322625327
             stat err =       0.000420284620
             autocorr =       1.160052737408
              std dev =       0.551848198485
             le_variance =       0.304536434171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304573738551
                                         uncertainty =       0.002174531518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390215603
  error estimate for blocks of size 2^( 2) =       0.000400003301
  error estimate for blocks of size 2^( 3) =       0.000408720654
  error estimate for blocks of size 2^( 4) =       0.000415670636
  error estimate for blocks of size 2^( 5) =       0.000419844106
  error estimate for blocks of size 2^( 6) =       0.000422950697
  error estimate for blocks of size 2^( 7) =       0.000422673043

      target function =                  N/A
              le_mean =     -17.216563112720
             les_mean =     296.727322625327
             stat err =       0.000420284620
             autocorr =       1.160052737408
              std dev =       0.551848198485
             le_variance =       0.304536434171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216563112720        initial  <--
     3.6380e+22     3.6380e+23             1.0333e-26       -17.216563112720
     1.4552e+23     1.4552e+24             2.7009e-27       -17.216563112720
     5.8208e+23     5.8208e+24             6.7523e-28       -17.216563112720

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6065
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2697
    reference variance = 0.235626
====================================================
  Execution time = 1.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2061e-01
  Total weights = 1.956470452e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303053033028
                                         uncertainty =       0.002752001398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303053033028
                                         uncertainty =       0.002752001398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389280955
  error estimate for blocks of size 2^( 2) =       0.000399120383
  error estimate for blocks of size 2^( 3) =       0.000408137552
  error estimate for blocks of size 2^( 4) =       0.000414905464
  error estimate for blocks of size 2^( 5) =       0.000419687918
  error estimate for blocks of size 2^( 6) =       0.000421326265
  error estimate for blocks of size 2^( 7) =       0.000420368125

      target function =                  N/A
              le_mean =     -17.216274263349
             les_mean =     296.720714232093
             stat err =       0.000419071943
             autocorr =       1.158913064550
              std dev =       0.550526405533
             le_variance =       0.303079323189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627426335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+23, overlap shift 3.6380e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274263392       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274263392       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216274263392       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216274263392       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216274263392       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+23 is 1.280055e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+24, overlap shift 1.4552e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274263392       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274263392       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216274263392       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216274263392       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216274309625       residual = 4.51e+05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.180526677661       residual = 2.22e+05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+24 is 3.200137e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+24, overlap shift 5.8208e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274263392       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274263392       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216274263392       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216274263392       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216274263395       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+24 is 8.000343e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6291e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.433279
====================================================
  Execution time = 1.3333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0902e-01
  Total weights = 1.9567e+06
  Execution time = 1.8326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384426310
  error estimate for blocks of size 2^( 2) =       0.000394746470
  error estimate for blocks of size 2^( 3) =       0.000403469446
  error estimate for blocks of size 2^( 4) =       0.000410391122
  error estimate for blocks of size 2^( 5) =       0.000413981257
  error estimate for blocks of size 2^( 6) =       0.000415971594
  error estimate for blocks of size 2^( 7) =       0.000415330522

      target function =                  N/A
              le_mean =     -17.216404275470
             les_mean =     296.713591524339
             stat err =       0.000413918624
             autocorr =       1.159321070084
              std dev =       0.543660901088
             le_variance =       0.295567175371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384426310
  error estimate for blocks of size 2^( 2) =       0.000394746470
  error estimate for blocks of size 2^( 3) =       0.000403469446
  error estimate for blocks of size 2^( 4) =       0.000410391122
  error estimate for blocks of size 2^( 5) =       0.000413981257
  error estimate for blocks of size 2^( 6) =       0.000415971594
  error estimate for blocks of size 2^( 7) =       0.000415330522

      target function =                  N/A
              le_mean =     -17.216404275470
             les_mean =     296.713591524339
             stat err =       0.000413918624
             autocorr =       1.159321070084
              std dev =       0.543660901088
             le_variance =       0.295567175371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384426310
  error estimate for blocks of size 2^( 2) =       0.000394746470
  error estimate for blocks of size 2^( 3) =       0.000403469446
  error estimate for blocks of size 2^( 4) =       0.000410391122
  error estimate for blocks of size 2^( 5) =       0.000413981257
  error estimate for blocks of size 2^( 6) =       0.000415971594
  error estimate for blocks of size 2^( 7) =       0.000415330522

      target function =                  N/A
              le_mean =     -17.216404275470
             les_mean =     296.713591524339
             stat err =       0.000413918624
             autocorr =       1.159321070084
              std dev =       0.543660901088
             le_variance =       0.295567175371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295584353432
                                         uncertainty =       0.001709505124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384426310
  error estimate for blocks of size 2^( 2) =       0.000394746470
  error estimate for blocks of size 2^( 3) =       0.000403469446
  error estimate for blocks of size 2^( 4) =       0.000410391122
  error estimate for blocks of size 2^( 5) =       0.000413981257
  error estimate for blocks of size 2^( 6) =       0.000415971594
  error estimate for blocks of size 2^( 7) =       0.000415330522

      target function =                  N/A
              le_mean =     -17.216404275470
             les_mean =     296.713591524339
             stat err =       0.000413918624
             autocorr =       1.159321070084
              std dev =       0.543660901088
             le_variance =       0.295567175371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216404275470        initial  <--
     3.6380e+23     3.6380e+24             1.2801e-27       -17.216404275470
     1.4552e+24     1.4552e+25             3.2001e-28       -17.216404275470
     5.8208e+24     5.8208e+25             8.0003e-29       -17.216404275470

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6333
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9018e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.173401
====================================================
  Execution time = 1.3776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1005e-01
  Total weights = 1.956713074e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296823284769
                                         uncertainty =       0.001815928980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296823284769
                                         uncertainty =       0.001815928980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385247011
  error estimate for blocks of size 2^( 2) =       0.000395640710
  error estimate for blocks of size 2^( 3) =       0.000404922894
  error estimate for blocks of size 2^( 4) =       0.000411577783
  error estimate for blocks of size 2^( 5) =       0.000415296568
  error estimate for blocks of size 2^( 6) =       0.000418700156
  error estimate for blocks of size 2^( 7) =       0.000420622255

      target function =                  N/A
              le_mean =     -17.216584018465
             les_mean =     296.720815707936
             stat err =       0.000416549191
             autocorr =       1.169106392527
              std dev =       0.544821547280
             le_variance =       0.296830518380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658401847e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+24, overlap shift 3.6380e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584018501       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584018501       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584018501       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584018501       residual = 1.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+24 is 7.447945e-29

solving harmonic davidson linear method for identity shift 1.4552e+25, overlap shift 1.4552e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584018501       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584018501       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584018501       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584018501       residual = 1.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+25 is 1.861986e-29

solving harmonic davidson linear method for identity shift 5.8208e+25, overlap shift 5.8208e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216584018501       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216584018501       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216584018501       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216584018501       residual = 1.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+25 is 4.654966e-30

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6303e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2404
    reference variance = 0.164107
====================================================
  Execution time = 1.3450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1292e-01
  Total weights = 1.9568e+06
  Execution time = 1.8404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796265
  error estimate for blocks of size 2^( 2) =       0.000396736636
  error estimate for blocks of size 2^( 3) =       0.000405496659
  error estimate for blocks of size 2^( 4) =       0.000412480908
  error estimate for blocks of size 2^( 5) =       0.000416889363
  error estimate for blocks of size 2^( 6) =       0.000419703448
  error estimate for blocks of size 2^( 7) =       0.000420333255

      target function =                  N/A
              le_mean =     -17.216831108700
             les_mean =     296.732190717955
             stat err =       0.000417351744
             autocorr =       1.164233039745
              std dev =       0.547012524338
             le_variance =       0.299222701783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796265
  error estimate for blocks of size 2^( 2) =       0.000396736636
  error estimate for blocks of size 2^( 3) =       0.000405496659
  error estimate for blocks of size 2^( 4) =       0.000412480908
  error estimate for blocks of size 2^( 5) =       0.000416889363
  error estimate for blocks of size 2^( 6) =       0.000419703448
  error estimate for blocks of size 2^( 7) =       0.000420333255

      target function =                  N/A
              le_mean =     -17.216831108700
             les_mean =     296.732190717955
             stat err =       0.000417351744
             autocorr =       1.164233039745
              std dev =       0.547012524338
             le_variance =       0.299222701783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796265
  error estimate for blocks of size 2^( 2) =       0.000396736636
  error estimate for blocks of size 2^( 3) =       0.000405496659
  error estimate for blocks of size 2^( 4) =       0.000412480908
  error estimate for blocks of size 2^( 5) =       0.000416889363
  error estimate for blocks of size 2^( 6) =       0.000419703448
  error estimate for blocks of size 2^( 7) =       0.000420333255

      target function =                  N/A
              le_mean =     -17.216831108700
             les_mean =     296.732190717955
             stat err =       0.000417351744
             autocorr =       1.164233039745
              std dev =       0.547012524338
             le_variance =       0.299222701783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299299182019
                                         uncertainty =       0.002019821192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386796265
  error estimate for blocks of size 2^( 2) =       0.000396736636
  error estimate for blocks of size 2^( 3) =       0.000405496659
  error estimate for blocks of size 2^( 4) =       0.000412480908
  error estimate for blocks of size 2^( 5) =       0.000416889363
  error estimate for blocks of size 2^( 6) =       0.000419703448
  error estimate for blocks of size 2^( 7) =       0.000420333255

      target function =                  N/A
              le_mean =     -17.216831108700
             les_mean =     296.732190717955
             stat err =       0.000417351744
             autocorr =       1.164233039745
              std dev =       0.547012524338
             le_variance =       0.299222701783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216831108700        initial  <--
     3.6380e+24     3.6380e+25             7.4479e-29       -17.216831108700
     1.4552e+25     1.4552e+26             1.8620e-29       -17.216831108700
     5.8208e+25     5.8208e+26             4.6550e-30       -17.216831108700

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7179
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2342
    reference variance = 0.396828
====================================================
  Execution time = 1.4698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1120e-01
  Total weights = 1.956437895e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297471849538
                                         uncertainty =       0.001719305763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297471849538
                                         uncertainty =       0.001719305763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385637854
  error estimate for blocks of size 2^( 2) =       0.000395316227
  error estimate for blocks of size 2^( 3) =       0.000404203295
  error estimate for blocks of size 2^( 4) =       0.000411118396
  error estimate for blocks of size 2^( 5) =       0.000414470453
  error estimate for blocks of size 2^( 6) =       0.000417318966
  error estimate for blocks of size 2^( 7) =       0.000419444042

      target function =                  N/A
              le_mean =     -17.216040739102
             les_mean =     296.703260524952
             stat err =       0.000415587964
             autocorr =       1.161359317157
              std dev =       0.545374283250
             le_variance =       0.297433108830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604073910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+25, overlap shift 3.6380e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+26, overlap shift 1.4552e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+26, overlap shift 5.8208e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040739129       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7187e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.385013
====================================================
  Execution time = 1.3504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 1.9564e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387476780
  error estimate for blocks of size 2^( 2) =       0.000397266300
  error estimate for blocks of size 2^( 3) =       0.000406665894
  error estimate for blocks of size 2^( 4) =       0.000413271652
  error estimate for blocks of size 2^( 5) =       0.000415974171
  error estimate for blocks of size 2^( 6) =       0.000419501418
  error estimate for blocks of size 2^( 7) =       0.000422531216

      target function =                  N/A
              le_mean =     -17.216791963126
             les_mean =     296.734278491314
             stat err =       0.000417819614
             autocorr =       1.162749825889
              std dev =       0.547974917654
             le_variance =       0.300276510378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387476780
  error estimate for blocks of size 2^( 2) =       0.000397266300
  error estimate for blocks of size 2^( 3) =       0.000406665894
  error estimate for blocks of size 2^( 4) =       0.000413271652
  error estimate for blocks of size 2^( 5) =       0.000415974171
  error estimate for blocks of size 2^( 6) =       0.000419501418
  error estimate for blocks of size 2^( 7) =       0.000422531216

      target function =                  N/A
              le_mean =     -17.216791963126
             les_mean =     296.734278491314
             stat err =       0.000417819614
             autocorr =       1.162749825889
              std dev =       0.547974917654
             le_variance =       0.300276510378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387476780
  error estimate for blocks of size 2^( 2) =       0.000397266300
  error estimate for blocks of size 2^( 3) =       0.000406665894
  error estimate for blocks of size 2^( 4) =       0.000413271652
  error estimate for blocks of size 2^( 5) =       0.000415974171
  error estimate for blocks of size 2^( 6) =       0.000419501418
  error estimate for blocks of size 2^( 7) =       0.000422531216

      target function =                  N/A
              le_mean =     -17.216791963126
             les_mean =     296.734278491314
             stat err =       0.000417819614
             autocorr =       1.162749825889
              std dev =       0.547974917654
             le_variance =       0.300276510378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300265542396
                                         uncertainty =       0.003130665737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387476780
  error estimate for blocks of size 2^( 2) =       0.000397266300
  error estimate for blocks of size 2^( 3) =       0.000406665894
  error estimate for blocks of size 2^( 4) =       0.000413271652
  error estimate for blocks of size 2^( 5) =       0.000415974171
  error estimate for blocks of size 2^( 6) =       0.000419501418
  error estimate for blocks of size 2^( 7) =       0.000422531216

      target function =                  N/A
              le_mean =     -17.216791963126
             les_mean =     296.734278491314
             stat err =       0.000417819614
             autocorr =       1.162749825889
              std dev =       0.547974917654
             le_variance =       0.300276510378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216791963126        initial  <--
     3.6380e+25     3.6380e+26             0.0000e+00       -17.216791963126
     1.4552e+26     1.4552e+27             0.0000e+00       -17.216791963126
     5.8208e+26     5.8208e+27             0.0000e+00       -17.216791963126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9133
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1943
    reference variance = 0.165844
====================================================
  Execution time = 1.3681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1606e-01
  Total weights = 1.956718548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300278496437
                                         uncertainty =       0.001912894583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300278496437
                                         uncertainty =       0.001912894583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387474687
  error estimate for blocks of size 2^( 2) =       0.000397110242
  error estimate for blocks of size 2^( 3) =       0.000406728950
  error estimate for blocks of size 2^( 4) =       0.000413792937
  error estimate for blocks of size 2^( 5) =       0.000418538080
  error estimate for blocks of size 2^( 6) =       0.000421592785
  error estimate for blocks of size 2^( 7) =       0.000422684035

      target function =                  N/A
              le_mean =     -17.215617177959
             les_mean =     296.693537909475
             stat err =       0.000419151959
             autocorr =       1.170189856303
              std dev =       0.547971957291
             le_variance =       0.300273265977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721561717796e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+26, overlap shift 3.6380e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+27, overlap shift 1.4552e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+27, overlap shift 5.8208e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215617178009       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6194e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2355
    reference variance = 0.162672
====================================================
  Execution time = 1.3961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1106e-01
  Total weights = 1.9567e+06
  Execution time = 1.8435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386074654
  error estimate for blocks of size 2^( 2) =       0.000396139354
  error estimate for blocks of size 2^( 3) =       0.000405816680
  error estimate for blocks of size 2^( 4) =       0.000412289761
  error estimate for blocks of size 2^( 5) =       0.000415541575
  error estimate for blocks of size 2^( 6) =       0.000417597835
  error estimate for blocks of size 2^( 7) =       0.000418578223

      target function =                  N/A
              le_mean =     -17.216287775571
             les_mean =     296.711620796295
             stat err =       0.000416001848
             autocorr =       1.161042024028
              std dev =       0.545992011143
             le_variance =       0.298107276232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386074654
  error estimate for blocks of size 2^( 2) =       0.000396139354
  error estimate for blocks of size 2^( 3) =       0.000405816680
  error estimate for blocks of size 2^( 4) =       0.000412289761
  error estimate for blocks of size 2^( 5) =       0.000415541575
  error estimate for blocks of size 2^( 6) =       0.000417597835
  error estimate for blocks of size 2^( 7) =       0.000418578223

      target function =                  N/A
              le_mean =     -17.216287775571
             les_mean =     296.711620796295
             stat err =       0.000416001848
             autocorr =       1.161042024028
              std dev =       0.545992011143
             le_variance =       0.298107276232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386074654
  error estimate for blocks of size 2^( 2) =       0.000396139354
  error estimate for blocks of size 2^( 3) =       0.000405816680
  error estimate for blocks of size 2^( 4) =       0.000412289761
  error estimate for blocks of size 2^( 5) =       0.000415541575
  error estimate for blocks of size 2^( 6) =       0.000417597835
  error estimate for blocks of size 2^( 7) =       0.000418578223

      target function =                  N/A
              le_mean =     -17.216287775571
             les_mean =     296.711620796295
             stat err =       0.000416001848
             autocorr =       1.161042024028
              std dev =       0.545992011143
             le_variance =       0.298107276232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298178704223
                                         uncertainty =       0.001885911555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386074654
  error estimate for blocks of size 2^( 2) =       0.000396139354
  error estimate for blocks of size 2^( 3) =       0.000405816680
  error estimate for blocks of size 2^( 4) =       0.000412289761
  error estimate for blocks of size 2^( 5) =       0.000415541575
  error estimate for blocks of size 2^( 6) =       0.000417597835
  error estimate for blocks of size 2^( 7) =       0.000418578223

      target function =                  N/A
              le_mean =     -17.216287775571
             les_mean =     296.711620796295
             stat err =       0.000416001848
             autocorr =       1.161042024028
              std dev =       0.545992011143
             le_variance =       0.298107276232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216287775571        initial  <--
     3.6380e+26     3.6380e+27             0.0000e+00       -17.216287775571
     1.4552e+27     1.4552e+28             0.0000e+00       -17.216287775571
     5.8208e+27     5.8208e+28             0.0000e+00       -17.216287775571

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2299
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9690e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 0.24919
====================================================
  Execution time = 1.3527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0827e-01
  Total weights = 1.956926909e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295992473588
                                         uncertainty =       0.002042280382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295992473588
                                         uncertainty =       0.002042280382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384750403
  error estimate for blocks of size 2^( 2) =       0.000394861412
  error estimate for blocks of size 2^( 3) =       0.000404374786
  error estimate for blocks of size 2^( 4) =       0.000411554396
  error estimate for blocks of size 2^( 5) =       0.000415577622
  error estimate for blocks of size 2^( 6) =       0.000417862140
  error estimate for blocks of size 2^( 7) =       0.000420551758

      target function =                  N/A
              le_mean =     -17.216639512550
             les_mean =     296.720946714570
             stat err =       0.000416386479
             autocorr =       1.171210807962
              std dev =       0.544119237528
             le_variance =       0.296065744648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663951255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+27, overlap shift 3.6380e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+28, overlap shift 1.4552e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+28, overlap shift 5.8208e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216639512569       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148689 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6009e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.3732
    reference variance = 0.770141
====================================================
  Execution time = 1.3513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1259e-01
  Total weights = 1.9564e+06
  Execution time = 1.8414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374430
  error estimate for blocks of size 2^( 2) =       0.000397712108
  error estimate for blocks of size 2^( 3) =       0.000406490972
  error estimate for blocks of size 2^( 4) =       0.000412911953
  error estimate for blocks of size 2^( 5) =       0.000416508338
  error estimate for blocks of size 2^( 6) =       0.000418509668
  error estimate for blocks of size 2^( 7) =       0.000419760850

      target function =                  N/A
              le_mean =     -17.216468641717
             les_mean =     296.719386896832
             stat err =       0.000416922702
             autocorr =       1.158375027031
              std dev =       0.547830173254
             le_variance =       0.300117898727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374430
  error estimate for blocks of size 2^( 2) =       0.000397712108
  error estimate for blocks of size 2^( 3) =       0.000406490972
  error estimate for blocks of size 2^( 4) =       0.000412911953
  error estimate for blocks of size 2^( 5) =       0.000416508338
  error estimate for blocks of size 2^( 6) =       0.000418509668
  error estimate for blocks of size 2^( 7) =       0.000419760850

      target function =                  N/A
              le_mean =     -17.216468641717
             les_mean =     296.719386896832
             stat err =       0.000416922702
             autocorr =       1.158375027031
              std dev =       0.547830173254
             le_variance =       0.300117898727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374430
  error estimate for blocks of size 2^( 2) =       0.000397712108
  error estimate for blocks of size 2^( 3) =       0.000406490972
  error estimate for blocks of size 2^( 4) =       0.000412911953
  error estimate for blocks of size 2^( 5) =       0.000416508338
  error estimate for blocks of size 2^( 6) =       0.000418509668
  error estimate for blocks of size 2^( 7) =       0.000419760850

      target function =                  N/A
              le_mean =     -17.216468641717
             les_mean =     296.719386896832
             stat err =       0.000416922702
             autocorr =       1.158375027031
              std dev =       0.547830173254
             le_variance =       0.300117898727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136839066
                                         uncertainty =       0.001999088507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387374430
  error estimate for blocks of size 2^( 2) =       0.000397712108
  error estimate for blocks of size 2^( 3) =       0.000406490972
  error estimate for blocks of size 2^( 4) =       0.000412911953
  error estimate for blocks of size 2^( 5) =       0.000416508338
  error estimate for blocks of size 2^( 6) =       0.000418509668
  error estimate for blocks of size 2^( 7) =       0.000419760850

      target function =                  N/A
              le_mean =     -17.216468641717
             les_mean =     296.719386896832
             stat err =       0.000416922702
             autocorr =       1.158375027031
              std dev =       0.547830173254
             le_variance =       0.300117898727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216468641717        initial  <--
     3.6380e+27     3.6380e+28             0.0000e+00       -17.216468641717
     1.4552e+28     1.4552e+29             0.0000e+00       -17.216468641717
     5.8208e+28     5.8208e+29             0.0000e+00       -17.216468641717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9196
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.0937
    reference variance = 0.39278
====================================================
  Execution time = 1.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1442e-01
  Total weights = 1.956643369e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299542922839
                                         uncertainty =       0.002603706410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299542922839
                                         uncertainty =       0.002603706410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386985964
  error estimate for blocks of size 2^( 2) =       0.000396899651
  error estimate for blocks of size 2^( 3) =       0.000406022422
  error estimate for blocks of size 2^( 4) =       0.000413028794
  error estimate for blocks of size 2^( 5) =       0.000417770091
  error estimate for blocks of size 2^( 6) =       0.000420172118
  error estimate for blocks of size 2^( 7) =       0.000421626970

      target function =                  N/A
              le_mean =     -17.216157108310
             les_mean =     296.710488729907
             stat err =       0.000418149493
             autocorr =       1.167542568522
              std dev =       0.547280798033
             le_variance =       0.299516271896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615710831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+28, overlap shift 3.6380e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+29, overlap shift 1.4552e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+29, overlap shift 5.8208e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216157108334       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6267e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2362
    reference variance = 0.168377
====================================================
  Execution time = 1.3106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1968e-01
  Total weights = 1.9565e+06
  Execution time = 2.3045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389672199
  error estimate for blocks of size 2^( 2) =       0.000399773965
  error estimate for blocks of size 2^( 3) =       0.000408305858
  error estimate for blocks of size 2^( 4) =       0.000414358600
  error estimate for blocks of size 2^( 5) =       0.000418191648
  error estimate for blocks of size 2^( 6) =       0.000419544646
  error estimate for blocks of size 2^( 7) =       0.000420515876

      target function =                  N/A
              le_mean =     -17.216756527024
             les_mean =     296.736383954083
             stat err =       0.000418152693
             autocorr =       1.151518582898
              std dev =       0.551079708638
             le_variance =       0.303688845272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389672199
  error estimate for blocks of size 2^( 2) =       0.000399773965
  error estimate for blocks of size 2^( 3) =       0.000408305858
  error estimate for blocks of size 2^( 4) =       0.000414358600
  error estimate for blocks of size 2^( 5) =       0.000418191648
  error estimate for blocks of size 2^( 6) =       0.000419544646
  error estimate for blocks of size 2^( 7) =       0.000420515876

      target function =                  N/A
              le_mean =     -17.216756527024
             les_mean =     296.736383954083
             stat err =       0.000418152693
             autocorr =       1.151518582898
              std dev =       0.551079708638
             le_variance =       0.303688845272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389672199
  error estimate for blocks of size 2^( 2) =       0.000399773965
  error estimate for blocks of size 2^( 3) =       0.000408305858
  error estimate for blocks of size 2^( 4) =       0.000414358600
  error estimate for blocks of size 2^( 5) =       0.000418191648
  error estimate for blocks of size 2^( 6) =       0.000419544646
  error estimate for blocks of size 2^( 7) =       0.000420515876

      target function =                  N/A
              le_mean =     -17.216756527024
             les_mean =     296.736383954083
             stat err =       0.000418152693
             autocorr =       1.151518582898
              std dev =       0.551079708638
             le_variance =       0.303688845272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303746857350
                                         uncertainty =       0.004568942757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389672199
  error estimate for blocks of size 2^( 2) =       0.000399773965
  error estimate for blocks of size 2^( 3) =       0.000408305858
  error estimate for blocks of size 2^( 4) =       0.000414358600
  error estimate for blocks of size 2^( 5) =       0.000418191648
  error estimate for blocks of size 2^( 6) =       0.000419544646
  error estimate for blocks of size 2^( 7) =       0.000420515876

      target function =                  N/A
              le_mean =     -17.216756527024
             les_mean =     296.736383954083
             stat err =       0.000418152693
             autocorr =       1.151518582898
              std dev =       0.551079708638
             le_variance =       0.303688845272


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216756527024        initial  <--
     3.6380e+28     3.6380e+29             0.0000e+00       -17.216756527024
     1.4552e+29     1.4552e+30             0.0000e+00       -17.216756527024
     5.8208e+29     5.8208e+30             0.0000e+00       -17.216756527024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.7223
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.646729
====================================================
  Execution time = 1.3500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0851e-01
  Total weights = 1.956381148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296349104505
                                         uncertainty =       0.001947718060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296349104505
                                         uncertainty =       0.001947718060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384974992
  error estimate for blocks of size 2^( 2) =       0.000395100231
  error estimate for blocks of size 2^( 3) =       0.000404016933
  error estimate for blocks of size 2^( 4) =       0.000410147050
  error estimate for blocks of size 2^( 5) =       0.000415013131
  error estimate for blocks of size 2^( 6) =       0.000417536979
  error estimate for blocks of size 2^( 7) =       0.000418398738

      target function =                  N/A
              le_mean =     -17.216466834246
             les_mean =     296.715245005573
             stat err =       0.000415273975
             autocorr =       1.163601820106
              std dev =       0.544436855006
             le_variance =       0.296411489089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646683425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+29, overlap shift 3.6380e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216466834274       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216466834274       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216466834303       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+29 is 8.661118e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+30, overlap shift 1.4552e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216466834274       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216466834274       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216466834303       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+30 is 2.165280e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+30, overlap shift 5.8208e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216466834274       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216466834274       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216466833837       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+30 is 5.413199e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6020e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.123
    reference variance = 0.134462
====================================================
  Execution time = 1.3635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1737e-01
  Total weights = 1.9566e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211006
  error estimate for blocks of size 2^( 2) =       0.000397965178
  error estimate for blocks of size 2^( 3) =       0.000406939688
  error estimate for blocks of size 2^( 4) =       0.000414217393
  error estimate for blocks of size 2^( 5) =       0.000418074008
  error estimate for blocks of size 2^( 6) =       0.000422043155
  error estimate for blocks of size 2^( 7) =       0.000423249481

      target function =                  N/A
              le_mean =     -17.216273177902
             les_mean =     296.717434299814
             stat err =       0.000419396009
             autocorr =       1.167112981787
              std dev =       0.549013270090
             le_variance =       0.301415570734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211006
  error estimate for blocks of size 2^( 2) =       0.000397965178
  error estimate for blocks of size 2^( 3) =       0.000406939688
  error estimate for blocks of size 2^( 4) =       0.000414217393
  error estimate for blocks of size 2^( 5) =       0.000418074008
  error estimate for blocks of size 2^( 6) =       0.000422043155
  error estimate for blocks of size 2^( 7) =       0.000423249481

      target function =                  N/A
              le_mean =     -17.216273177902
             les_mean =     296.717434299814
             stat err =       0.000419396009
             autocorr =       1.167112981787
              std dev =       0.549013270090
             le_variance =       0.301415570734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211006
  error estimate for blocks of size 2^( 2) =       0.000397965178
  error estimate for blocks of size 2^( 3) =       0.000406939688
  error estimate for blocks of size 2^( 4) =       0.000414217393
  error estimate for blocks of size 2^( 5) =       0.000418074008
  error estimate for blocks of size 2^( 6) =       0.000422043155
  error estimate for blocks of size 2^( 7) =       0.000423249481

      target function =                  N/A
              le_mean =     -17.216273177902
             les_mean =     296.717434299814
             stat err =       0.000419396009
             autocorr =       1.167112981787
              std dev =       0.549013270090
             le_variance =       0.301415570734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301295644526
                                         uncertainty =       0.002018491145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388211006
  error estimate for blocks of size 2^( 2) =       0.000397965178
  error estimate for blocks of size 2^( 3) =       0.000406939688
  error estimate for blocks of size 2^( 4) =       0.000414217393
  error estimate for blocks of size 2^( 5) =       0.000418074008
  error estimate for blocks of size 2^( 6) =       0.000422043155
  error estimate for blocks of size 2^( 7) =       0.000423249481

      target function =                  N/A
              le_mean =     -17.216273177902
             les_mean =     296.717434299814
             stat err =       0.000419396009
             autocorr =       1.167112981787
              std dev =       0.549013270090
             le_variance =       0.301415570734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216273177902        initial  <--
     3.6380e+29     3.6380e+30             8.6611e-34       -17.216273177902
     1.4552e+30     1.4552e+31             2.1653e-34       -17.216273177902
     5.8208e+30     5.8208e+31             5.4132e-35       -17.216273177902

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8910
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.191783
====================================================
  Execution time = 1.3596e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1808e-01
  Total weights = 1.956844578e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304116952727
                                         uncertainty =       0.002519539136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304116952727
                                         uncertainty =       0.002519539136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390208597
  error estimate for blocks of size 2^( 2) =       0.000400074049
  error estimate for blocks of size 2^( 3) =       0.000409259476
  error estimate for blocks of size 2^( 4) =       0.000416040033
  error estimate for blocks of size 2^( 5) =       0.000420269541
  error estimate for blocks of size 2^( 6) =       0.000422647957
  error estimate for blocks of size 2^( 7) =       0.000422063663

      target function =                  N/A
              le_mean =     -17.216507239855
             les_mean =     296.726198357722
             stat err =       0.000420255299
             autocorr =       1.159932529223
              std dev =       0.551838290317
             le_variance =       0.304525498660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650723986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+30, overlap shift 3.6380e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+31, overlap shift 1.4552e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+31, overlap shift 5.8208e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507239913       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6124e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1821
    reference variance = 0.382244
====================================================
  Execution time = 1.3431e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1769e-01
  Total weights = 1.9568e+06
  Execution time = 1.8381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388604273
  error estimate for blocks of size 2^( 2) =       0.000398668263
  error estimate for blocks of size 2^( 3) =       0.000408041921
  error estimate for blocks of size 2^( 4) =       0.000414571246
  error estimate for blocks of size 2^( 5) =       0.000419210492
  error estimate for blocks of size 2^( 6) =       0.000422306255
  error estimate for blocks of size 2^( 7) =       0.000422207598

      target function =                  N/A
              le_mean =     -17.216413953354
             les_mean =     296.722596459674
             stat err =       0.000419573898
             autocorr =       1.165740223913
              std dev =       0.549569432979
             le_variance =       0.302026561665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388604273
  error estimate for blocks of size 2^( 2) =       0.000398668263
  error estimate for blocks of size 2^( 3) =       0.000408041921
  error estimate for blocks of size 2^( 4) =       0.000414571246
  error estimate for blocks of size 2^( 5) =       0.000419210492
  error estimate for blocks of size 2^( 6) =       0.000422306255
  error estimate for blocks of size 2^( 7) =       0.000422207598

      target function =                  N/A
              le_mean =     -17.216413953354
             les_mean =     296.722596459674
             stat err =       0.000419573898
             autocorr =       1.165740223913
              std dev =       0.549569432979
             le_variance =       0.302026561665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388604273
  error estimate for blocks of size 2^( 2) =       0.000398668263
  error estimate for blocks of size 2^( 3) =       0.000408041921
  error estimate for blocks of size 2^( 4) =       0.000414571246
  error estimate for blocks of size 2^( 5) =       0.000419210492
  error estimate for blocks of size 2^( 6) =       0.000422306255
  error estimate for blocks of size 2^( 7) =       0.000422207598

      target function =                  N/A
              le_mean =     -17.216413953354
             les_mean =     296.722596459674
             stat err =       0.000419573898
             autocorr =       1.165740223913
              std dev =       0.549569432979
             le_variance =       0.302026561665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302082645126
                                         uncertainty =       0.002123358818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388604273
  error estimate for blocks of size 2^( 2) =       0.000398668263
  error estimate for blocks of size 2^( 3) =       0.000408041921
  error estimate for blocks of size 2^( 4) =       0.000414571246
  error estimate for blocks of size 2^( 5) =       0.000419210492
  error estimate for blocks of size 2^( 6) =       0.000422306255
  error estimate for blocks of size 2^( 7) =       0.000422207598

      target function =                  N/A
              le_mean =     -17.216413953354
             les_mean =     296.722596459674
             stat err =       0.000419573898
             autocorr =       1.165740223913
              std dev =       0.549569432979
             le_variance =       0.302026561665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216413953354        initial  <--
     3.6380e+30     3.6380e+31             0.0000e+00       -17.216413953354
     1.4552e+31     1.4552e+32             0.0000e+00       -17.216413953354
     5.8208e+31     5.8208e+32             0.0000e+00       -17.216413953354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6712
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.305438
====================================================
  Execution time = 1.4176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1563e-01
  Total weights = 1.956721417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302890742843
                                         uncertainty =       0.002424127831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302890742843
                                         uncertainty =       0.002424127831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389163294
  error estimate for blocks of size 2^( 2) =       0.000398901904
  error estimate for blocks of size 2^( 3) =       0.000408008900
  error estimate for blocks of size 2^( 4) =       0.000414389136
  error estimate for blocks of size 2^( 5) =       0.000418491101
  error estimate for blocks of size 2^( 6) =       0.000421443298
  error estimate for blocks of size 2^( 7) =       0.000422680609

      target function =                  N/A
              le_mean =     -17.216420838839
             les_mean =     296.720773118017
             stat err =       0.000419251036
             autocorr =       1.160605292732
              std dev =       0.550360008778
             le_variance =       0.302896139262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642083884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+31, overlap shift 3.6380e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+32, overlap shift 1.4552e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+32 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+32, overlap shift 5.8208e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420838913       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6672e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.257335
====================================================
  Execution time = 1.3354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1616e-01
  Total weights = 1.9563e+06
  Execution time = 1.8464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387576931
  error estimate for blocks of size 2^( 2) =       0.000397602561
  error estimate for blocks of size 2^( 3) =       0.000406698141
  error estimate for blocks of size 2^( 4) =       0.000413898492
  error estimate for blocks of size 2^( 5) =       0.000418212827
  error estimate for blocks of size 2^( 6) =       0.000420731009
  error estimate for blocks of size 2^( 7) =       0.000419858821

      target function =                  N/A
              le_mean =     -17.216157314190
             les_mean =     296.712227758760
             stat err =       0.000418175287
             autocorr =       1.164128408471
              std dev =       0.548116552904
             le_variance =       0.300431755568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387576931
  error estimate for blocks of size 2^( 2) =       0.000397602561
  error estimate for blocks of size 2^( 3) =       0.000406698141
  error estimate for blocks of size 2^( 4) =       0.000413898492
  error estimate for blocks of size 2^( 5) =       0.000418212827
  error estimate for blocks of size 2^( 6) =       0.000420731009
  error estimate for blocks of size 2^( 7) =       0.000419858821

      target function =                  N/A
              le_mean =     -17.216157314190
             les_mean =     296.712227758760
             stat err =       0.000418175287
             autocorr =       1.164128408471
              std dev =       0.548116552904
             le_variance =       0.300431755568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387576931
  error estimate for blocks of size 2^( 2) =       0.000397602561
  error estimate for blocks of size 2^( 3) =       0.000406698141
  error estimate for blocks of size 2^( 4) =       0.000413898492
  error estimate for blocks of size 2^( 5) =       0.000418212827
  error estimate for blocks of size 2^( 6) =       0.000420731009
  error estimate for blocks of size 2^( 7) =       0.000419858821

      target function =                  N/A
              le_mean =     -17.216157314190
             les_mean =     296.712227758760
             stat err =       0.000418175287
             autocorr =       1.164128408471
              std dev =       0.548116552904
             le_variance =       0.300431755568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300448510991
                                         uncertainty =       0.002179777395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387576931
  error estimate for blocks of size 2^( 2) =       0.000397602561
  error estimate for blocks of size 2^( 3) =       0.000406698141
  error estimate for blocks of size 2^( 4) =       0.000413898492
  error estimate for blocks of size 2^( 5) =       0.000418212827
  error estimate for blocks of size 2^( 6) =       0.000420731009
  error estimate for blocks of size 2^( 7) =       0.000419858821

      target function =                  N/A
              le_mean =     -17.216157314190
             les_mean =     296.712227758760
             stat err =       0.000418175287
             autocorr =       1.164128408471
              std dev =       0.548116552904
             le_variance =       0.300431755568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216157314190        initial  <--
     3.6380e+31     3.6380e+32             0.0000e+00       -17.216157314190
     1.4552e+32     1.4552e+33             0.0000e+00       -17.216157314190
     5.8208e+32     5.8208e+33             0.0000e+00       -17.216157314190

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6403
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.204114
====================================================
  Execution time = 1.3745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1283e-01
  Total weights = 1.956429201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447238655
                                         uncertainty =       0.001519924845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299447238655
                                         uncertainty =       0.001519924845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386925577
  error estimate for blocks of size 2^( 2) =       0.000396730632
  error estimate for blocks of size 2^( 3) =       0.000405830788
  error estimate for blocks of size 2^( 4) =       0.000413089251
  error estimate for blocks of size 2^( 5) =       0.000417674479
  error estimate for blocks of size 2^( 6) =       0.000420370196
  error estimate for blocks of size 2^( 7) =       0.000423125071

      target function =                  N/A
              le_mean =     -17.215729684320
             les_mean =     296.694178293273
             stat err =       0.000418564749
             autocorr =       1.170227828554
              std dev =       0.547195399252
             le_variance =       0.299422804962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572968432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+32, overlap shift 3.6380e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+33, overlap shift 1.4552e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+33, overlap shift 5.8208e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215729684342       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154137 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6226e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.239405
====================================================
  Execution time = 1.3677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1575e-01
  Total weights = 1.9566e+06
  Execution time = 1.8485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895603
  error estimate for blocks of size 2^( 2) =       0.000396952369
  error estimate for blocks of size 2^( 3) =       0.000405773776
  error estimate for blocks of size 2^( 4) =       0.000411987594
  error estimate for blocks of size 2^( 5) =       0.000415816780
  error estimate for blocks of size 2^( 6) =       0.000417459441
  error estimate for blocks of size 2^( 7) =       0.000417845568

      target function =                  N/A
              le_mean =     -17.216829138351
             les_mean =     296.734958139777
             stat err =       0.000415777346
             autocorr =       1.154872546854
              std dev =       0.547153008556
             le_variance =       0.299376414772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895603
  error estimate for blocks of size 2^( 2) =       0.000396952369
  error estimate for blocks of size 2^( 3) =       0.000405773776
  error estimate for blocks of size 2^( 4) =       0.000411987594
  error estimate for blocks of size 2^( 5) =       0.000415816780
  error estimate for blocks of size 2^( 6) =       0.000417459441
  error estimate for blocks of size 2^( 7) =       0.000417845568

      target function =                  N/A
              le_mean =     -17.216829138351
             les_mean =     296.734958139777
             stat err =       0.000415777346
             autocorr =       1.154872546854
              std dev =       0.547153008556
             le_variance =       0.299376414772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895603
  error estimate for blocks of size 2^( 2) =       0.000396952369
  error estimate for blocks of size 2^( 3) =       0.000405773776
  error estimate for blocks of size 2^( 4) =       0.000411987594
  error estimate for blocks of size 2^( 5) =       0.000415816780
  error estimate for blocks of size 2^( 6) =       0.000417459441
  error estimate for blocks of size 2^( 7) =       0.000417845568

      target function =                  N/A
              le_mean =     -17.216829138351
             les_mean =     296.734958139777
             stat err =       0.000415777346
             autocorr =       1.154872546854
              std dev =       0.547153008556
             le_variance =       0.299376414772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299398022006
                                         uncertainty =       0.001723676747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386895603
  error estimate for blocks of size 2^( 2) =       0.000396952369
  error estimate for blocks of size 2^( 3) =       0.000405773776
  error estimate for blocks of size 2^( 4) =       0.000411987594
  error estimate for blocks of size 2^( 5) =       0.000415816780
  error estimate for blocks of size 2^( 6) =       0.000417459441
  error estimate for blocks of size 2^( 7) =       0.000417845568

      target function =                  N/A
              le_mean =     -17.216829138351
             les_mean =     296.734958139777
             stat err =       0.000415777346
             autocorr =       1.154872546854
              std dev =       0.547153008556
             le_variance =       0.299376414772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216829138351        initial  <--
     3.6380e+32     3.6380e+33             0.0000e+00       -17.216829138351
     1.4552e+33     1.4552e+34             0.0000e+00       -17.216829138351
     5.8208e+33     5.8208e+34             0.0000e+00       -17.216829138351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9738
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.414061
====================================================
  Execution time = 1.3951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1164e-01
  Total weights = 1.956652753e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296910915773
                                         uncertainty =       0.001750363245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296910915773
                                         uncertainty =       0.001750363245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385285314
  error estimate for blocks of size 2^( 2) =       0.000395123300
  error estimate for blocks of size 2^( 3) =       0.000403799485
  error estimate for blocks of size 2^( 4) =       0.000410644924
  error estimate for blocks of size 2^( 5) =       0.000414423851
  error estimate for blocks of size 2^( 6) =       0.000416764974
  error estimate for blocks of size 2^( 7) =       0.000420619775

      target function =                  N/A
              le_mean =     -17.215584742838
             les_mean =     296.688002173824
             stat err =       0.000415613381
             autocorr =       1.163627917921
              std dev =       0.544875716893
             le_variance =       0.296889546860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721558474284e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+33, overlap shift 3.6380e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+34, overlap shift 1.4552e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+34, overlap shift 5.8208e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215584742854       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6435e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.137
    reference variance = 0.833585
====================================================
  Execution time = 1.3254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1475e-01
  Total weights = 1.9566e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385746714
  error estimate for blocks of size 2^( 2) =       0.000395948837
  error estimate for blocks of size 2^( 3) =       0.000405206791
  error estimate for blocks of size 2^( 4) =       0.000411482208
  error estimate for blocks of size 2^( 5) =       0.000415911432
  error estimate for blocks of size 2^( 6) =       0.000420104678
  error estimate for blocks of size 2^( 7) =       0.000421823565

      target function =                  N/A
              le_mean =     -17.216457786634
             les_mean =     296.721172192824
             stat err =       0.000417330471
             autocorr =       1.170457693842
              std dev =       0.545528234195
             le_variance =       0.297601054304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385746714
  error estimate for blocks of size 2^( 2) =       0.000395948837
  error estimate for blocks of size 2^( 3) =       0.000405206791
  error estimate for blocks of size 2^( 4) =       0.000411482208
  error estimate for blocks of size 2^( 5) =       0.000415911432
  error estimate for blocks of size 2^( 6) =       0.000420104678
  error estimate for blocks of size 2^( 7) =       0.000421823565

      target function =                  N/A
              le_mean =     -17.216457786634
             les_mean =     296.721172192824
             stat err =       0.000417330471
             autocorr =       1.170457693842
              std dev =       0.545528234195
             le_variance =       0.297601054304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385746714
  error estimate for blocks of size 2^( 2) =       0.000395948837
  error estimate for blocks of size 2^( 3) =       0.000405206791
  error estimate for blocks of size 2^( 4) =       0.000411482208
  error estimate for blocks of size 2^( 5) =       0.000415911432
  error estimate for blocks of size 2^( 6) =       0.000420104678
  error estimate for blocks of size 2^( 7) =       0.000421823565

      target function =                  N/A
              le_mean =     -17.216457786634
             les_mean =     296.721172192824
             stat err =       0.000417330471
             autocorr =       1.170457693842
              std dev =       0.545528234195
             le_variance =       0.297601054304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613810936
                                         uncertainty =       0.002175040214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385746714
  error estimate for blocks of size 2^( 2) =       0.000395948837
  error estimate for blocks of size 2^( 3) =       0.000405206791
  error estimate for blocks of size 2^( 4) =       0.000411482208
  error estimate for blocks of size 2^( 5) =       0.000415911432
  error estimate for blocks of size 2^( 6) =       0.000420104678
  error estimate for blocks of size 2^( 7) =       0.000421823565

      target function =                  N/A
              le_mean =     -17.216457786634
             les_mean =     296.721172192824
             stat err =       0.000417330471
             autocorr =       1.170457693842
              std dev =       0.545528234195
             le_variance =       0.297601054304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216457786634        initial  <--
     3.6380e+33     3.6380e+34             0.0000e+00       -17.216457786634
     1.4552e+34     1.4552e+35             0.0000e+00       -17.216457786634
     5.8208e+34     5.8208e+35             0.0000e+00       -17.216457786634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4989
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.65271
====================================================
  Execution time = 1.3722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1735e-01
  Total weights = 1.956627661e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303167995599
                                         uncertainty =       0.002401942220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303167995599
                                         uncertainty =       0.002401942220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389368506
  error estimate for blocks of size 2^( 2) =       0.000399589605
  error estimate for blocks of size 2^( 3) =       0.000408376151
  error estimate for blocks of size 2^( 4) =       0.000415564959
  error estimate for blocks of size 2^( 5) =       0.000419706824
  error estimate for blocks of size 2^( 6) =       0.000421343118
  error estimate for blocks of size 2^( 7) =       0.000422401105

      target function =                  N/A
              le_mean =     -17.216646086897
             les_mean =     296.730256503718
             stat err =       0.000419754002
             autocorr =       1.162165690601
              std dev =       0.550650221373
             le_variance =       0.303215666298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664608690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+34, overlap shift 3.6380e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646086975       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646086975       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216646086975       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+34 is 1.147974e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+35, overlap shift 1.4552e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646086975       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646086975       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216646086975       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+35 is 2.869935e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+35, overlap shift 5.8208e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646086975       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646086975       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216646086975       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+35 is 7.174838e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156422 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6204e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.31
    reference variance = 0.358787
====================================================
  Execution time = 1.3229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1859e-01
  Total weights = 1.9566e+06
  Execution time = 1.8333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800196
  error estimate for blocks of size 2^( 2) =       0.000398131933
  error estimate for blocks of size 2^( 3) =       0.000407134858
  error estimate for blocks of size 2^( 4) =       0.000413649579
  error estimate for blocks of size 2^( 5) =       0.000417899345
  error estimate for blocks of size 2^( 6) =       0.000420541675
  error estimate for blocks of size 2^( 7) =       0.000422814308

      target function =                  N/A
              le_mean =     -17.216949476598
             les_mean =     296.741940358566
             stat err =       0.000418726227
             autocorr =       1.165854297627
              std dev =       0.548432296840
             le_variance =       0.300777984218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800196
  error estimate for blocks of size 2^( 2) =       0.000398131933
  error estimate for blocks of size 2^( 3) =       0.000407134858
  error estimate for blocks of size 2^( 4) =       0.000413649579
  error estimate for blocks of size 2^( 5) =       0.000417899345
  error estimate for blocks of size 2^( 6) =       0.000420541675
  error estimate for blocks of size 2^( 7) =       0.000422814308

      target function =                  N/A
              le_mean =     -17.216949476598
             les_mean =     296.741940358566
             stat err =       0.000418726227
             autocorr =       1.165854297627
              std dev =       0.548432296840
             le_variance =       0.300777984218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800196
  error estimate for blocks of size 2^( 2) =       0.000398131933
  error estimate for blocks of size 2^( 3) =       0.000407134858
  error estimate for blocks of size 2^( 4) =       0.000413649579
  error estimate for blocks of size 2^( 5) =       0.000417899345
  error estimate for blocks of size 2^( 6) =       0.000420541675
  error estimate for blocks of size 2^( 7) =       0.000422814308

      target function =                  N/A
              le_mean =     -17.216949476598
             les_mean =     296.741940358566
             stat err =       0.000418726227
             autocorr =       1.165854297627
              std dev =       0.548432296840
             le_variance =       0.300777984218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300762368797
                                         uncertainty =       0.002061955885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387800196
  error estimate for blocks of size 2^( 2) =       0.000398131933
  error estimate for blocks of size 2^( 3) =       0.000407134858
  error estimate for blocks of size 2^( 4) =       0.000413649579
  error estimate for blocks of size 2^( 5) =       0.000417899345
  error estimate for blocks of size 2^( 6) =       0.000420541675
  error estimate for blocks of size 2^( 7) =       0.000422814308

      target function =                  N/A
              le_mean =     -17.216949476598
             les_mean =     296.741940358566
             stat err =       0.000418726227
             autocorr =       1.165854297627
              std dev =       0.548432296840
             le_variance =       0.300777984218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216949476598        initial  <--
     3.6380e+34     3.6380e+35             1.1480e-38       -17.216949476598
     1.4552e+35     1.4552e+36             2.8699e-39       -17.216949476598
     5.8208e+35     5.8208e+36             7.1748e-40       -17.216949476598

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4684
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1673
    reference variance = 0.243273
====================================================
  Execution time = 1.3429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1222e-01
  Total weights = 1.956799501e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295777987636
                                         uncertainty =       0.001792069656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295777987636
                                         uncertainty =       0.001792069656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384565038
  error estimate for blocks of size 2^( 2) =       0.000394650218
  error estimate for blocks of size 2^( 3) =       0.000403317998
  error estimate for blocks of size 2^( 4) =       0.000409784211
  error estimate for blocks of size 2^( 5) =       0.000414910838
  error estimate for blocks of size 2^( 6) =       0.000417066106
  error estimate for blocks of size 2^( 7) =       0.000418577003

      target function =                  N/A
              le_mean =     -17.217087202700
             les_mean =     296.740313844356
             stat err =       0.000415084540
             autocorr =       1.165020370254
              std dev =       0.543857091914
             le_variance =       0.295780536426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708720270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+35, overlap shift 3.6380e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+36, overlap shift 1.4552e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+36, overlap shift 5.8208e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217087202743       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6008e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.238804
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1137e-01
  Total weights = 1.9566e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386341830
  error estimate for blocks of size 2^( 2) =       0.000396296162
  error estimate for blocks of size 2^( 3) =       0.000405299131
  error estimate for blocks of size 2^( 4) =       0.000411370468
  error estimate for blocks of size 2^( 5) =       0.000415591253
  error estimate for blocks of size 2^( 6) =       0.000419106536
  error estimate for blocks of size 2^( 7) =       0.000420202364

      target function =                  N/A
              le_mean =     -17.216831921179
             les_mean =     296.730666561873
             stat err =       0.000416567655
             autocorr =       1.162592790312
              std dev =       0.546369856271
             le_variance =       0.298520019842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386341830
  error estimate for blocks of size 2^( 2) =       0.000396296162
  error estimate for blocks of size 2^( 3) =       0.000405299131
  error estimate for blocks of size 2^( 4) =       0.000411370468
  error estimate for blocks of size 2^( 5) =       0.000415591253
  error estimate for blocks of size 2^( 6) =       0.000419106536
  error estimate for blocks of size 2^( 7) =       0.000420202364

      target function =                  N/A
              le_mean =     -17.216831921179
             les_mean =     296.730666561873
             stat err =       0.000416567655
             autocorr =       1.162592790312
              std dev =       0.546369856271
             le_variance =       0.298520019842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386341830
  error estimate for blocks of size 2^( 2) =       0.000396296162
  error estimate for blocks of size 2^( 3) =       0.000405299131
  error estimate for blocks of size 2^( 4) =       0.000411370468
  error estimate for blocks of size 2^( 5) =       0.000415591253
  error estimate for blocks of size 2^( 6) =       0.000419106536
  error estimate for blocks of size 2^( 7) =       0.000420202364

      target function =                  N/A
              le_mean =     -17.216831921179
             les_mean =     296.730666561873
             stat err =       0.000416567655
             autocorr =       1.162592790312
              std dev =       0.546369856271
             le_variance =       0.298520019842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298533121459
                                         uncertainty =       0.001921965654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386341830
  error estimate for blocks of size 2^( 2) =       0.000396296162
  error estimate for blocks of size 2^( 3) =       0.000405299131
  error estimate for blocks of size 2^( 4) =       0.000411370468
  error estimate for blocks of size 2^( 5) =       0.000415591253
  error estimate for blocks of size 2^( 6) =       0.000419106536
  error estimate for blocks of size 2^( 7) =       0.000420202364

      target function =                  N/A
              le_mean =     -17.216831921179
             les_mean =     296.730666561873
             stat err =       0.000416567655
             autocorr =       1.162592790312
              std dev =       0.546369856271
             le_variance =       0.298520019842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216831921179        initial  <--
     3.6380e+35     3.6380e+36             0.0000e+00       -17.216831921179
     1.4552e+36     1.4552e+37             0.0000e+00       -17.216831921179
     5.8208e+36     5.8208e+37             0.0000e+00       -17.216831921179

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8525
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1134
    reference variance = 0.201444
====================================================
  Execution time = 1.4076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1611e-01
  Total weights = 1.956674167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301937185699
                                         uncertainty =       0.001967768992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301937185699
                                         uncertainty =       0.001967768992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388531281
  error estimate for blocks of size 2^( 2) =       0.000398418911
  error estimate for blocks of size 2^( 3) =       0.000407641843
  error estimate for blocks of size 2^( 4) =       0.000414543940
  error estimate for blocks of size 2^( 5) =       0.000419071846
  error estimate for blocks of size 2^( 6) =       0.000421249524
  error estimate for blocks of size 2^( 7) =       0.000421576834

      target function =                  N/A
              le_mean =     -17.216520063478
             les_mean =     296.724673614740
             stat err =       0.000419110536
             autocorr =       1.163603922335
              std dev =       0.549466207328
             le_variance =       0.301913112996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652006348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+36, overlap shift 3.6380e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520063526       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520063526       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520063579       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+36 is 8.415908e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+37, overlap shift 1.4552e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520063526       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520063526       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520063579       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+37 is 2.103977e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+37, overlap shift 5.8208e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520063526       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520063526       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520063579       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+37 is 5.259942e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0168e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2636
    reference variance = 0.3517
====================================================
  Execution time = 1.4203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1632e-01
  Total weights = 1.9566e+06
  Execution time = 1.8400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387748703
  error estimate for blocks of size 2^( 2) =       0.000397896701
  error estimate for blocks of size 2^( 3) =       0.000407071627
  error estimate for blocks of size 2^( 4) =       0.000413650513
  error estimate for blocks of size 2^( 5) =       0.000417227858
  error estimate for blocks of size 2^( 6) =       0.000420152664
  error estimate for blocks of size 2^( 7) =       0.000421596739

      target function =                  N/A
              le_mean =     -17.215902928542
             les_mean =     296.703636520434
             stat err =       0.000418156944
             autocorr =       1.162995190641
              std dev =       0.548359473976
             le_variance =       0.300698112700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387748703
  error estimate for blocks of size 2^( 2) =       0.000397896701
  error estimate for blocks of size 2^( 3) =       0.000407071627
  error estimate for blocks of size 2^( 4) =       0.000413650513
  error estimate for blocks of size 2^( 5) =       0.000417227858
  error estimate for blocks of size 2^( 6) =       0.000420152664
  error estimate for blocks of size 2^( 7) =       0.000421596739

      target function =                  N/A
              le_mean =     -17.215902928542
             les_mean =     296.703636520434
             stat err =       0.000418156944
             autocorr =       1.162995190641
              std dev =       0.548359473976
             le_variance =       0.300698112700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387748703
  error estimate for blocks of size 2^( 2) =       0.000397896701
  error estimate for blocks of size 2^( 3) =       0.000407071627
  error estimate for blocks of size 2^( 4) =       0.000413650513
  error estimate for blocks of size 2^( 5) =       0.000417227858
  error estimate for blocks of size 2^( 6) =       0.000420152664
  error estimate for blocks of size 2^( 7) =       0.000421596739

      target function =                  N/A
              le_mean =     -17.215902928542
             les_mean =     296.703636520434
             stat err =       0.000418156944
             autocorr =       1.162995190641
              std dev =       0.548359473976
             le_variance =       0.300698112700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300472227718
                                         uncertainty =       0.002736793705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387748703
  error estimate for blocks of size 2^( 2) =       0.000397896701
  error estimate for blocks of size 2^( 3) =       0.000407071627
  error estimate for blocks of size 2^( 4) =       0.000413650513
  error estimate for blocks of size 2^( 5) =       0.000417227858
  error estimate for blocks of size 2^( 6) =       0.000420152664
  error estimate for blocks of size 2^( 7) =       0.000421596739

      target function =                  N/A
              le_mean =     -17.215902928542
             les_mean =     296.703636520434
             stat err =       0.000418156944
             autocorr =       1.162995190641
              std dev =       0.548359473976
             le_variance =       0.300698112700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215902928542        initial  <--
     3.6380e+36     3.6380e+37             8.4159e-41       -17.215902928542
     1.4552e+37     1.4552e+38             2.1040e-41       -17.215902928542
     5.8208e+37     5.8208e+38             5.2599e-42       -17.215902928542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6222
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1422
    reference variance = 0.244783
====================================================
  Execution time = 1.4044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1573e-01
  Total weights = 1.956445503e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299716709776
                                         uncertainty =       0.001711823766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299716709776
                                         uncertainty =       0.001711823766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387131388
  error estimate for blocks of size 2^( 2) =       0.000397577426
  error estimate for blocks of size 2^( 3) =       0.000407077121
  error estimate for blocks of size 2^( 4) =       0.000413379695
  error estimate for blocks of size 2^( 5) =       0.000417283015
  error estimate for blocks of size 2^( 6) =       0.000419894331
  error estimate for blocks of size 2^( 7) =       0.000421847817

      target function =                  N/A
              le_mean =     -17.215844325286
             les_mean =     296.701026036063
             stat err =       0.000418101215
             autocorr =       1.166396183477
              std dev =       0.547486458958
             le_variance =       0.299741422742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584432529e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+37, overlap shift 3.6380e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844325331       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844325331       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215844325331       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+37 is 9.255894e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+38, overlap shift 1.4552e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844325331       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844325331       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215844325331       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+38 is 2.367289e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+38, overlap shift 5.8208e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844325331       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844325331       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215844325331       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+38 is 5.918222e-43

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6619e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2558
    reference variance = 0.1889
====================================================
  Execution time = 1.3623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1624e-01
  Total weights = 1.9570e+06
  Execution time = 1.8384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385724694
  error estimate for blocks of size 2^( 2) =       0.000395400395
  error estimate for blocks of size 2^( 3) =       0.000404181561
  error estimate for blocks of size 2^( 4) =       0.000410185480
  error estimate for blocks of size 2^( 5) =       0.000414074187
  error estimate for blocks of size 2^( 6) =       0.000414838519
  error estimate for blocks of size 2^( 7) =       0.000415281020

      target function =                  N/A
              le_mean =     -17.216234288873
             les_mean =     296.714964997569
             stat err =       0.000413594802
             autocorr =       1.149728391843
              std dev =       0.545497093870
             le_variance =       0.297567079421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385724694
  error estimate for blocks of size 2^( 2) =       0.000395400395
  error estimate for blocks of size 2^( 3) =       0.000404181561
  error estimate for blocks of size 2^( 4) =       0.000410185480
  error estimate for blocks of size 2^( 5) =       0.000414074187
  error estimate for blocks of size 2^( 6) =       0.000414838519
  error estimate for blocks of size 2^( 7) =       0.000415281020

      target function =                  N/A
              le_mean =     -17.216234288873
             les_mean =     296.714964997569
             stat err =       0.000413594802
             autocorr =       1.149728391843
              std dev =       0.545497093870
             le_variance =       0.297567079421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385724694
  error estimate for blocks of size 2^( 2) =       0.000395400395
  error estimate for blocks of size 2^( 3) =       0.000404181561
  error estimate for blocks of size 2^( 4) =       0.000410185480
  error estimate for blocks of size 2^( 5) =       0.000414074187
  error estimate for blocks of size 2^( 6) =       0.000414838519
  error estimate for blocks of size 2^( 7) =       0.000415281020

      target function =                  N/A
              le_mean =     -17.216234288873
             les_mean =     296.714964997569
             stat err =       0.000413594802
             autocorr =       1.149728391843
              std dev =       0.545497093870
             le_variance =       0.297567079421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297613656385
                                         uncertainty =       0.002104675004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385724694
  error estimate for blocks of size 2^( 2) =       0.000395400395
  error estimate for blocks of size 2^( 3) =       0.000404181561
  error estimate for blocks of size 2^( 4) =       0.000410185480
  error estimate for blocks of size 2^( 5) =       0.000414074187
  error estimate for blocks of size 2^( 6) =       0.000414838519
  error estimate for blocks of size 2^( 7) =       0.000415281020

      target function =                  N/A
              le_mean =     -17.216234288873
             les_mean =     296.714964997569
             stat err =       0.000413594802
             autocorr =       1.149728391843
              std dev =       0.545497093870
             le_variance =       0.297567079421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216234288873        initial  <--
     3.6380e+37     3.6380e+38             9.2559e-42       -17.216234288873
     1.4552e+38     1.4552e+39             2.3673e-42       -17.216234288873
     5.8208e+38     5.8208e+39             5.9182e-43       -17.216234288873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9352
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9678e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2358
    reference variance = 0.337373
====================================================
  Execution time = 1.3827e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1682e-01
  Total weights = 1.956639234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301357856045
                                         uncertainty =       0.001943854937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301357856045
                                         uncertainty =       0.001943854937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388141799
  error estimate for blocks of size 2^( 2) =       0.000397900033
  error estimate for blocks of size 2^( 3) =       0.000407079315
  error estimate for blocks of size 2^( 4) =       0.000414220218
  error estimate for blocks of size 2^( 5) =       0.000418013714
  error estimate for blocks of size 2^( 6) =       0.000420747447
  error estimate for blocks of size 2^( 7) =       0.000422844995

      target function =                  N/A
              le_mean =     -17.216324794128
             les_mean =     296.718663901813
             stat err =       0.000418956593
             autocorr =       1.165083978273
              std dev =       0.548915396484
             le_variance =       0.301308112497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632479413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+38, overlap shift 3.6380e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+39, overlap shift 1.4552e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+39, overlap shift 5.8208e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324794214       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6336e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.247311
====================================================
  Execution time = 1.3430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1169e-01
  Total weights = 1.9569e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386369268
  error estimate for blocks of size 2^( 2) =       0.000396028605
  error estimate for blocks of size 2^( 3) =       0.000405090206
  error estimate for blocks of size 2^( 4) =       0.000412042974
  error estimate for blocks of size 2^( 5) =       0.000416974554
  error estimate for blocks of size 2^( 6) =       0.000419029493
  error estimate for blocks of size 2^( 7) =       0.000422176453

      target function =                  N/A
              le_mean =     -17.216644048158
             les_mean =     296.724522995190
             stat err =       0.000417555869
             autocorr =       1.167949415473
              std dev =       0.546408658986
             le_variance =       0.298562422614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386369268
  error estimate for blocks of size 2^( 2) =       0.000396028605
  error estimate for blocks of size 2^( 3) =       0.000405090206
  error estimate for blocks of size 2^( 4) =       0.000412042974
  error estimate for blocks of size 2^( 5) =       0.000416974554
  error estimate for blocks of size 2^( 6) =       0.000419029493
  error estimate for blocks of size 2^( 7) =       0.000422176453

      target function =                  N/A
              le_mean =     -17.216644048158
             les_mean =     296.724522995190
             stat err =       0.000417555869
             autocorr =       1.167949415473
              std dev =       0.546408658986
             le_variance =       0.298562422614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386369268
  error estimate for blocks of size 2^( 2) =       0.000396028605
  error estimate for blocks of size 2^( 3) =       0.000405090206
  error estimate for blocks of size 2^( 4) =       0.000412042974
  error estimate for blocks of size 2^( 5) =       0.000416974554
  error estimate for blocks of size 2^( 6) =       0.000419029493
  error estimate for blocks of size 2^( 7) =       0.000422176453

      target function =                  N/A
              le_mean =     -17.216644048158
             les_mean =     296.724522995190
             stat err =       0.000417555869
             autocorr =       1.167949415473
              std dev =       0.546408658986
             le_variance =       0.298562422614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298426868650
                                         uncertainty =       0.002029319715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386369268
  error estimate for blocks of size 2^( 2) =       0.000396028605
  error estimate for blocks of size 2^( 3) =       0.000405090206
  error estimate for blocks of size 2^( 4) =       0.000412042974
  error estimate for blocks of size 2^( 5) =       0.000416974554
  error estimate for blocks of size 2^( 6) =       0.000419029493
  error estimate for blocks of size 2^( 7) =       0.000422176453

      target function =                  N/A
              le_mean =     -17.216644048158
             les_mean =     296.724522995190
             stat err =       0.000417555869
             autocorr =       1.167949415473
              std dev =       0.546408658986
             le_variance =       0.298562422614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216644048158        initial  <--
     3.6380e+38     3.6380e+39             0.0000e+00       -17.216644048158
     1.4552e+39     1.4552e+40             0.0000e+00       -17.216644048158
     5.8208e+39     5.8208e+40             0.0000e+00       -17.216644048158

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7265
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.407298
====================================================
  Execution time = 1.4038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1680e-01
  Total weights = 1.956550391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302575741122
                                         uncertainty =       0.002067997065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302575741122
                                         uncertainty =       0.002067997065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388933336
  error estimate for blocks of size 2^( 2) =       0.000398951146
  error estimate for blocks of size 2^( 3) =       0.000408400032
  error estimate for blocks of size 2^( 4) =       0.000414925350
  error estimate for blocks of size 2^( 5) =       0.000420475733
  error estimate for blocks of size 2^( 6) =       0.000421488191
  error estimate for blocks of size 2^( 7) =       0.000422022771

      target function =                  N/A
              le_mean =     -17.216182800805
             les_mean =     296.713750027405
             stat err =       0.000419728011
             autocorr =       1.164623555814
              std dev =       0.550034798130
             le_variance =       0.302538279154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618280081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+39, overlap shift 3.6380e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182800853       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182800853       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182800853       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182800853       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+39 is 1.088148e-43

solving harmonic davidson linear method for identity shift 1.4552e+40, overlap shift 1.4552e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182800853       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182800853       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182800853       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182827950       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.000000000000       residual = 2.12e+05           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+40 is 2.710558e-44

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+40, overlap shift 5.8208e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216182800853       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216182800853       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216182800853       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216182800853       residual = 1.60e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+40 is 6.800928e-45

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6544e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2327
    reference variance = 0.470433
====================================================
  Execution time = 1.3844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1089e-01
  Total weights = 1.9567e+06
  Execution time = 1.8388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385294771
  error estimate for blocks of size 2^( 2) =       0.000395219660
  error estimate for blocks of size 2^( 3) =       0.000404343818
  error estimate for blocks of size 2^( 4) =       0.000411577610
  error estimate for blocks of size 2^( 5) =       0.000416244636
  error estimate for blocks of size 2^( 6) =       0.000417700264
  error estimate for blocks of size 2^( 7) =       0.000418784811

      target function =                  N/A
              le_mean =     -17.216389491149
             les_mean =     296.714961116270
             stat err =       0.000416076830
             autocorr =       1.166167235934
              std dev =       0.544889089985
             le_variance =       0.296904120385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385294771
  error estimate for blocks of size 2^( 2) =       0.000395219660
  error estimate for blocks of size 2^( 3) =       0.000404343818
  error estimate for blocks of size 2^( 4) =       0.000411577610
  error estimate for blocks of size 2^( 5) =       0.000416244636
  error estimate for blocks of size 2^( 6) =       0.000417700264
  error estimate for blocks of size 2^( 7) =       0.000418784811

      target function =                  N/A
              le_mean =     -17.216389491149
             les_mean =     296.714961116270
             stat err =       0.000416076830
             autocorr =       1.166167235934
              std dev =       0.544889089985
             le_variance =       0.296904120385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385294771
  error estimate for blocks of size 2^( 2) =       0.000395219660
  error estimate for blocks of size 2^( 3) =       0.000404343818
  error estimate for blocks of size 2^( 4) =       0.000411577610
  error estimate for blocks of size 2^( 5) =       0.000416244636
  error estimate for blocks of size 2^( 6) =       0.000417700264
  error estimate for blocks of size 2^( 7) =       0.000418784811

      target function =                  N/A
              le_mean =     -17.216389491149
             les_mean =     296.714961116270
             stat err =       0.000416076830
             autocorr =       1.166167235934
              std dev =       0.544889089985
             le_variance =       0.296904120385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296947338103
                                         uncertainty =       0.001948698245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385294771
  error estimate for blocks of size 2^( 2) =       0.000395219660
  error estimate for blocks of size 2^( 3) =       0.000404343818
  error estimate for blocks of size 2^( 4) =       0.000411577610
  error estimate for blocks of size 2^( 5) =       0.000416244636
  error estimate for blocks of size 2^( 6) =       0.000417700264
  error estimate for blocks of size 2^( 7) =       0.000418784811

      target function =                  N/A
              le_mean =     -17.216389491149
             les_mean =     296.714961116270
             stat err =       0.000416076830
             autocorr =       1.166167235934
              std dev =       0.544889089985
             le_variance =       0.296904120385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216389491149        initial  <--
     3.6380e+39     3.6380e+40             1.0881e-43       -17.216389491149
     1.4552e+40     1.4552e+41             2.7106e-44       -17.216389491149
     5.8208e+40     5.8208e+41             6.8009e-45       -17.216389491149

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1357
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2064
    reference variance = 0.189427
====================================================
  Execution time = 1.3888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5314e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1215e-01
  Total weights = 1.956442658e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299059384972
                                         uncertainty =       0.002332246982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299059384972
                                         uncertainty =       0.002332246982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641074
  error estimate for blocks of size 2^( 2) =       0.000396477949
  error estimate for blocks of size 2^( 3) =       0.000405660517
  error estimate for blocks of size 2^( 4) =       0.000412474904
  error estimate for blocks of size 2^( 5) =       0.000417075454
  error estimate for blocks of size 2^( 6) =       0.000419270095
  error estimate for blocks of size 2^( 7) =       0.000420208509

      target function =                  N/A
              le_mean =     -17.216275884885
             les_mean =     296.712304003883
             stat err =       0.000417257241
             autocorr =       1.164640226210
              std dev =       0.546793050604
             le_variance =       0.298982640189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627588489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+40, overlap shift 3.6380e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216275884931       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216275884931       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216275884931       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216278076172       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+40 is 8.518155e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+41, overlap shift 1.4552e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216275884931       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216275884931       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216308593750       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+41 is 2.246915e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+41, overlap shift 5.8208e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216275884931       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216275884931       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+41 is 5.617288e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6408e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.198
    reference variance = 0.225445
====================================================
  Execution time = 1.3676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1689e-01
  Total weights = 1.9568e+06
  Execution time = 1.8369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388283593
  error estimate for blocks of size 2^( 2) =       0.000398012393
  error estimate for blocks of size 2^( 3) =       0.000407091310
  error estimate for blocks of size 2^( 4) =       0.000414138247
  error estimate for blocks of size 2^( 5) =       0.000418303421
  error estimate for blocks of size 2^( 6) =       0.000420651333
  error estimate for blocks of size 2^( 7) =       0.000419909052

      target function =                  N/A
              le_mean =     -17.217261779371
             les_mean =     296.750992274717
             stat err =       0.000418250513
             autocorr =       1.160312275088
              std dev =       0.549115922724
             le_variance =       0.301528296589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388283593
  error estimate for blocks of size 2^( 2) =       0.000398012393
  error estimate for blocks of size 2^( 3) =       0.000407091310
  error estimate for blocks of size 2^( 4) =       0.000414138247
  error estimate for blocks of size 2^( 5) =       0.000418303421
  error estimate for blocks of size 2^( 6) =       0.000420651333
  error estimate for blocks of size 2^( 7) =       0.000419909052

      target function =                  N/A
              le_mean =     -17.217261779371
             les_mean =     296.750992274717
             stat err =       0.000418250513
             autocorr =       1.160312275088
              std dev =       0.549115922724
             le_variance =       0.301528296589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388283593
  error estimate for blocks of size 2^( 2) =       0.000398012393
  error estimate for blocks of size 2^( 3) =       0.000407091310
  error estimate for blocks of size 2^( 4) =       0.000414138247
  error estimate for blocks of size 2^( 5) =       0.000418303421
  error estimate for blocks of size 2^( 6) =       0.000420651333
  error estimate for blocks of size 2^( 7) =       0.000419909052

      target function =                  N/A
              le_mean =     -17.217261779371
             les_mean =     296.750992274717
             stat err =       0.000418250513
             autocorr =       1.160312275088
              std dev =       0.549115922724
             le_variance =       0.301528296589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301583513654
                                         uncertainty =       0.001842868705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388283593
  error estimate for blocks of size 2^( 2) =       0.000398012393
  error estimate for blocks of size 2^( 3) =       0.000407091310
  error estimate for blocks of size 2^( 4) =       0.000414138247
  error estimate for blocks of size 2^( 5) =       0.000418303421
  error estimate for blocks of size 2^( 6) =       0.000420651333
  error estimate for blocks of size 2^( 7) =       0.000419909052

      target function =                  N/A
              le_mean =     -17.217261779371
             les_mean =     296.750992274717
             stat err =       0.000418250513
             autocorr =       1.160312275088
              std dev =       0.549115922724
             le_variance =       0.301528296589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217261779371        initial  <--
     3.6380e+40     3.6380e+41             8.5182e-45       -17.217261779371
     1.4552e+41     1.4552e+42             2.2469e-45       -17.217261779371
     5.8208e+41     5.8208e+42             5.6173e-46       -17.217261779371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9805
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2314
    reference variance = 0.521048
====================================================
  Execution time = 1.4220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0758e-01
  Total weights = 1.956438366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295793711999
                                         uncertainty =       0.001824808912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295793711999
                                         uncertainty =       0.001824808912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384557900
  error estimate for blocks of size 2^( 2) =       0.000394453101
  error estimate for blocks of size 2^( 3) =       0.000403702055
  error estimate for blocks of size 2^( 4) =       0.000410491309
  error estimate for blocks of size 2^( 5) =       0.000414913807
  error estimate for blocks of size 2^( 6) =       0.000417014283
  error estimate for blocks of size 2^( 7) =       0.000419142742

      target function =                  N/A
              le_mean =     -17.216271873658
             les_mean =     296.707593222556
             stat err =       0.000415390535
             autocorr =       1.166781998133
              std dev =       0.543846997138
             le_variance =       0.295769556296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627187366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+41, overlap shift 3.6380e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+42, overlap shift 1.4552e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+42, overlap shift 5.8208e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216271873680       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6750e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.189525
====================================================
  Execution time = 1.3972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1685e-01
  Total weights = 1.9568e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388303841
  error estimate for blocks of size 2^( 2) =       0.000398239697
  error estimate for blocks of size 2^( 3) =       0.000406978628
  error estimate for blocks of size 2^( 4) =       0.000414001570
  error estimate for blocks of size 2^( 5) =       0.000419267878
  error estimate for blocks of size 2^( 6) =       0.000421490975
  error estimate for blocks of size 2^( 7) =       0.000421697908

      target function =                  N/A
              le_mean =     -17.216851728458
             les_mean =     296.736831037862
             stat err =       0.000419114583
             autocorr =       1.164989927387
              std dev =       0.549144558537
             le_variance =       0.301559746171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388303841
  error estimate for blocks of size 2^( 2) =       0.000398239697
  error estimate for blocks of size 2^( 3) =       0.000406978628
  error estimate for blocks of size 2^( 4) =       0.000414001570
  error estimate for blocks of size 2^( 5) =       0.000419267878
  error estimate for blocks of size 2^( 6) =       0.000421490975
  error estimate for blocks of size 2^( 7) =       0.000421697908

      target function =                  N/A
              le_mean =     -17.216851728458
             les_mean =     296.736831037862
             stat err =       0.000419114583
             autocorr =       1.164989927387
              std dev =       0.549144558537
             le_variance =       0.301559746171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388303841
  error estimate for blocks of size 2^( 2) =       0.000398239697
  error estimate for blocks of size 2^( 3) =       0.000406978628
  error estimate for blocks of size 2^( 4) =       0.000414001570
  error estimate for blocks of size 2^( 5) =       0.000419267878
  error estimate for blocks of size 2^( 6) =       0.000421490975
  error estimate for blocks of size 2^( 7) =       0.000421697908

      target function =                  N/A
              le_mean =     -17.216851728458
             les_mean =     296.736831037862
             stat err =       0.000419114583
             autocorr =       1.164989927387
              std dev =       0.549144558537
             le_variance =       0.301559746171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301629864416
                                         uncertainty =       0.001939826766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388303841
  error estimate for blocks of size 2^( 2) =       0.000398239697
  error estimate for blocks of size 2^( 3) =       0.000406978628
  error estimate for blocks of size 2^( 4) =       0.000414001570
  error estimate for blocks of size 2^( 5) =       0.000419267878
  error estimate for blocks of size 2^( 6) =       0.000421490975
  error estimate for blocks of size 2^( 7) =       0.000421697908

      target function =                  N/A
              le_mean =     -17.216851728458
             les_mean =     296.736831037862
             stat err =       0.000419114583
             autocorr =       1.164989927387
              std dev =       0.549144558537
             le_variance =       0.301559746171


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216851728458        initial  <--
     3.6380e+41     3.6380e+42             0.0000e+00       -17.216851728458
     1.4552e+42     1.4552e+43             0.0000e+00       -17.216851728458
     5.8208e+42     5.8208e+43             0.0000e+00       -17.216851728458

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3805
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2834
    reference variance = 0.516554
====================================================
  Execution time = 1.3920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.956819623e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300178304922
                                         uncertainty =       0.002180679698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300178304922
                                         uncertainty =       0.002180679698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387421038
  error estimate for blocks of size 2^( 2) =       0.000396932661
  error estimate for blocks of size 2^( 3) =       0.000406227309
  error estimate for blocks of size 2^( 4) =       0.000412985194
  error estimate for blocks of size 2^( 5) =       0.000416060138
  error estimate for blocks of size 2^( 6) =       0.000418173070
  error estimate for blocks of size 2^( 7) =       0.000417744033

      target function =                  N/A
              le_mean =     -17.216276627205
             les_mean =     296.713812406400
             stat err =       0.000416240609
             autocorr =       1.154310100345
              std dev =       0.547896085842
             le_variance =       0.300190120880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627662720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+42, overlap shift 3.6380e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+43, overlap shift 1.4552e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+43, overlap shift 5.8208e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216276627251       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6487e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.266436
====================================================
  Execution time = 1.3890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1423e-01
  Total weights = 1.9571e+06
  Execution time = 1.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387790395
  error estimate for blocks of size 2^( 2) =       0.000397650622
  error estimate for blocks of size 2^( 3) =       0.000406491065
  error estimate for blocks of size 2^( 4) =       0.000413432794
  error estimate for blocks of size 2^( 5) =       0.000418028804
  error estimate for blocks of size 2^( 6) =       0.000418958421
  error estimate for blocks of size 2^( 7) =       0.000421131803

      target function =                  N/A
              le_mean =     -17.216493613544
             les_mean =     296.721878207635
             stat err =       0.000417887955
             autocorr =       1.161249691268
              std dev =       0.548418436007
             le_variance =       0.300762780952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387790395
  error estimate for blocks of size 2^( 2) =       0.000397650622
  error estimate for blocks of size 2^( 3) =       0.000406491065
  error estimate for blocks of size 2^( 4) =       0.000413432794
  error estimate for blocks of size 2^( 5) =       0.000418028804
  error estimate for blocks of size 2^( 6) =       0.000418958421
  error estimate for blocks of size 2^( 7) =       0.000421131803

      target function =                  N/A
              le_mean =     -17.216493613544
             les_mean =     296.721878207635
             stat err =       0.000417887955
             autocorr =       1.161249691268
              std dev =       0.548418436007
             le_variance =       0.300762780952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387790395
  error estimate for blocks of size 2^( 2) =       0.000397650622
  error estimate for blocks of size 2^( 3) =       0.000406491065
  error estimate for blocks of size 2^( 4) =       0.000413432794
  error estimate for blocks of size 2^( 5) =       0.000418028804
  error estimate for blocks of size 2^( 6) =       0.000418958421
  error estimate for blocks of size 2^( 7) =       0.000421131803

      target function =                  N/A
              le_mean =     -17.216493613544
             les_mean =     296.721878207635
             stat err =       0.000417887955
             autocorr =       1.161249691268
              std dev =       0.548418436007
             le_variance =       0.300762780952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300765474490
                                         uncertainty =       0.003626958871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387790395
  error estimate for blocks of size 2^( 2) =       0.000397650622
  error estimate for blocks of size 2^( 3) =       0.000406491065
  error estimate for blocks of size 2^( 4) =       0.000413432794
  error estimate for blocks of size 2^( 5) =       0.000418028804
  error estimate for blocks of size 2^( 6) =       0.000418958421
  error estimate for blocks of size 2^( 7) =       0.000421131803

      target function =                  N/A
              le_mean =     -17.216493613544
             les_mean =     296.721878207635
             stat err =       0.000417887955
             autocorr =       1.161249691268
              std dev =       0.548418436007
             le_variance =       0.300762780952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216493613544        initial  <--
     3.6380e+42     3.6380e+43             0.0000e+00       -17.216493613544
     1.4552e+43     1.4552e+44             0.0000e+00       -17.216493613544
     5.8208e+43     5.8208e+44             0.0000e+00       -17.216493613544

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2035
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1438
    reference variance = 0.399364
====================================================
  Execution time = 1.4198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2458e-01
  Total weights = 1.956525851e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306240371130
                                         uncertainty =       0.003459941925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306240371130
                                         uncertainty =       0.003459941925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391278207
  error estimate for blocks of size 2^( 2) =       0.000401555151
  error estimate for blocks of size 2^( 3) =       0.000411059243
  error estimate for blocks of size 2^( 4) =       0.000418567915
  error estimate for blocks of size 2^( 5) =       0.000423322930
  error estimate for blocks of size 2^( 6) =       0.000428216031
  error estimate for blocks of size 2^( 7) =       0.000432721345

      target function =                  N/A
              le_mean =     -17.216740611682
             les_mean =     296.740739217603
             stat err =       0.000425707056
             autocorr =       1.183723792122
              std dev =       0.553350947053
             le_variance =       0.306197270605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674061168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+43, overlap shift 3.6380e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+44, overlap shift 1.4552e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+44, overlap shift 5.8208e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740611710       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166809 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6718e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.231214
====================================================
  Execution time = 1.3645e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1784e-01
  Total weights = 1.9564e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388463698
  error estimate for blocks of size 2^( 2) =       0.000398722477
  error estimate for blocks of size 2^( 3) =       0.000407752838
  error estimate for blocks of size 2^( 4) =       0.000414022332
  error estimate for blocks of size 2^( 5) =       0.000418000550
  error estimate for blocks of size 2^( 6) =       0.000420090707
  error estimate for blocks of size 2^( 7) =       0.000423126609

      target function =                  N/A
              le_mean =     -17.216116136152
             les_mean =     296.712493956019
             stat err =       0.000418810049
             autocorr =       1.162340336060
              std dev =       0.549370629510
             le_variance =       0.301808088568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388463698
  error estimate for blocks of size 2^( 2) =       0.000398722477
  error estimate for blocks of size 2^( 3) =       0.000407752838
  error estimate for blocks of size 2^( 4) =       0.000414022332
  error estimate for blocks of size 2^( 5) =       0.000418000550
  error estimate for blocks of size 2^( 6) =       0.000420090707
  error estimate for blocks of size 2^( 7) =       0.000423126609

      target function =                  N/A
              le_mean =     -17.216116136152
             les_mean =     296.712493956019
             stat err =       0.000418810049
             autocorr =       1.162340336060
              std dev =       0.549370629510
             le_variance =       0.301808088568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388463698
  error estimate for blocks of size 2^( 2) =       0.000398722477
  error estimate for blocks of size 2^( 3) =       0.000407752838
  error estimate for blocks of size 2^( 4) =       0.000414022332
  error estimate for blocks of size 2^( 5) =       0.000418000550
  error estimate for blocks of size 2^( 6) =       0.000420090707
  error estimate for blocks of size 2^( 7) =       0.000423126609

      target function =                  N/A
              le_mean =     -17.216116136152
             les_mean =     296.712493956019
             stat err =       0.000418810049
             autocorr =       1.162340336060
              std dev =       0.549370629510
             le_variance =       0.301808088568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301665734449
                                         uncertainty =       0.002447430879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388463698
  error estimate for blocks of size 2^( 2) =       0.000398722477
  error estimate for blocks of size 2^( 3) =       0.000407752838
  error estimate for blocks of size 2^( 4) =       0.000414022332
  error estimate for blocks of size 2^( 5) =       0.000418000550
  error estimate for blocks of size 2^( 6) =       0.000420090707
  error estimate for blocks of size 2^( 7) =       0.000423126609

      target function =                  N/A
              le_mean =     -17.216116136152
             les_mean =     296.712493956019
             stat err =       0.000418810049
             autocorr =       1.162340336060
              std dev =       0.549370629510
             le_variance =       0.301808088568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216116136152        initial  <--
     3.6380e+43     3.6380e+44             0.0000e+00       -17.216116136152
     1.4552e+44     1.4552e+45             0.0000e+00       -17.216116136152
     5.8208e+44     5.8208e+45             0.0000e+00       -17.216116136152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.7248
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3504e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.328401
====================================================
  Execution time = 1.4064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1351e-01
  Total weights = 1.956462568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300209295023
                                         uncertainty =       0.002082274867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300209295023
                                         uncertainty =       0.002082274867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387402720
  error estimate for blocks of size 2^( 2) =       0.000397313506
  error estimate for blocks of size 2^( 3) =       0.000405821775
  error estimate for blocks of size 2^( 4) =       0.000411624590
  error estimate for blocks of size 2^( 5) =       0.000416914733
  error estimate for blocks of size 2^( 6) =       0.000418982092
  error estimate for blocks of size 2^( 7) =       0.000419532986

      target function =                  N/A
              le_mean =     -17.215999344868
             les_mean =     296.704143887712
             stat err =       0.000416763600
             autocorr =       1.157322061976
              std dev =       0.547870180026
             le_variance =       0.300161734162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721599934487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+44, overlap shift 3.6380e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215999344914       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215999344914       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216003417969       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+44 is 1.007560e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+45, overlap shift 1.4552e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215999344914       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215999344914       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+45 is 2.518901e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+45, overlap shift 5.8208e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215999344914       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215999344914       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+45 is 6.297252e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6588e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.292345
====================================================
  Execution time = 1.3220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.9569e+06
  Execution time = 1.8331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233353
  error estimate for blocks of size 2^( 2) =       0.000395874826
  error estimate for blocks of size 2^( 3) =       0.000404243933
  error estimate for blocks of size 2^( 4) =       0.000410769466
  error estimate for blocks of size 2^( 5) =       0.000414717295
  error estimate for blocks of size 2^( 6) =       0.000416682081
  error estimate for blocks of size 2^( 7) =       0.000418829444

      target function =                  N/A
              le_mean =     -17.216453012763
             les_mean =     296.718391109280
             stat err =       0.000415249571
             autocorr =       1.155896205435
              std dev =       0.546216445467
             le_variance =       0.298352405298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233353
  error estimate for blocks of size 2^( 2) =       0.000395874826
  error estimate for blocks of size 2^( 3) =       0.000404243933
  error estimate for blocks of size 2^( 4) =       0.000410769466
  error estimate for blocks of size 2^( 5) =       0.000414717295
  error estimate for blocks of size 2^( 6) =       0.000416682081
  error estimate for blocks of size 2^( 7) =       0.000418829444

      target function =                  N/A
              le_mean =     -17.216453012763
             les_mean =     296.718391109280
             stat err =       0.000415249571
             autocorr =       1.155896205435
              std dev =       0.546216445467
             le_variance =       0.298352405298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233353
  error estimate for blocks of size 2^( 2) =       0.000395874826
  error estimate for blocks of size 2^( 3) =       0.000404243933
  error estimate for blocks of size 2^( 4) =       0.000410769466
  error estimate for blocks of size 2^( 5) =       0.000414717295
  error estimate for blocks of size 2^( 6) =       0.000416682081
  error estimate for blocks of size 2^( 7) =       0.000418829444

      target function =                  N/A
              le_mean =     -17.216453012763
             les_mean =     296.718391109280
             stat err =       0.000415249571
             autocorr =       1.155896205435
              std dev =       0.546216445467
             le_variance =       0.298352405298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298433493278
                                         uncertainty =       0.001917156615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386233353
  error estimate for blocks of size 2^( 2) =       0.000395874826
  error estimate for blocks of size 2^( 3) =       0.000404243933
  error estimate for blocks of size 2^( 4) =       0.000410769466
  error estimate for blocks of size 2^( 5) =       0.000414717295
  error estimate for blocks of size 2^( 6) =       0.000416682081
  error estimate for blocks of size 2^( 7) =       0.000418829444

      target function =                  N/A
              le_mean =     -17.216453012763
             les_mean =     296.718391109280
             stat err =       0.000415249571
             autocorr =       1.155896205435
              std dev =       0.546216445467
             le_variance =       0.298352405298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216453012763        initial  <--
     3.6380e+44     3.6380e+45             1.0076e-48       -17.216453012763
     1.4552e+45     1.4552e+46             2.5189e-49       -17.216453012763
     5.8208e+45     5.8208e+46             6.2973e-50       -17.216453012763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5111
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9146e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2688
    reference variance = 0.345132
====================================================
  Execution time = 1.4403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5321e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1030e-01
  Total weights = 1.956503731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294976588085
                                         uncertainty =       0.001940913059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294976588085
                                         uncertainty =       0.001940913059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384137622
  error estimate for blocks of size 2^( 2) =       0.000393817415
  error estimate for blocks of size 2^( 3) =       0.000402738826
  error estimate for blocks of size 2^( 4) =       0.000408964126
  error estimate for blocks of size 2^( 5) =       0.000413920185
  error estimate for blocks of size 2^( 6) =       0.000416359191
  error estimate for blocks of size 2^( 7) =       0.000417744048

      target function =                  N/A
              le_mean =     -17.215538693883
             les_mean =     296.685067869990
             stat err =       0.000414246888
             autocorr =       1.162906564410
              std dev =       0.543252634320
             le_variance =       0.295123424696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721553869388e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+45, overlap shift 3.6380e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538693886       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538693886       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215538693886       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218750000000       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.187500000000       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+45 is 9.492474e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+46, overlap shift 1.4552e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538693886       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538693886       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215538693886       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218750000000       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.250000000000       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+46 is 2.373119e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+46, overlap shift 5.8208e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215538693886       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215538693886       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215538693886       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.187500000000       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+46 is 5.932797e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6912e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1356
    reference variance = 0.225053
====================================================
  Execution time = 1.3483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1547e-01
  Total weights = 1.9567e+06
  Execution time = 1.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386665962
  error estimate for blocks of size 2^( 2) =       0.000396546008
  error estimate for blocks of size 2^( 3) =       0.000405829433
  error estimate for blocks of size 2^( 4) =       0.000412176718
  error estimate for blocks of size 2^( 5) =       0.000416279356
  error estimate for blocks of size 2^( 6) =       0.000419116060
  error estimate for blocks of size 2^( 7) =       0.000421038254

      target function =                  N/A
              le_mean =     -17.216717910485
             les_mean =     296.730840860754
             stat err =       0.000417152597
             autocorr =       1.163906293746
              std dev =       0.546828248080
             le_variance =       0.299021132898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386665962
  error estimate for blocks of size 2^( 2) =       0.000396546008
  error estimate for blocks of size 2^( 3) =       0.000405829433
  error estimate for blocks of size 2^( 4) =       0.000412176718
  error estimate for blocks of size 2^( 5) =       0.000416279356
  error estimate for blocks of size 2^( 6) =       0.000419116060
  error estimate for blocks of size 2^( 7) =       0.000421038254

      target function =                  N/A
              le_mean =     -17.216717910485
             les_mean =     296.730840860754
             stat err =       0.000417152597
             autocorr =       1.163906293746
              std dev =       0.546828248080
             le_variance =       0.299021132898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386665962
  error estimate for blocks of size 2^( 2) =       0.000396546008
  error estimate for blocks of size 2^( 3) =       0.000405829433
  error estimate for blocks of size 2^( 4) =       0.000412176718
  error estimate for blocks of size 2^( 5) =       0.000416279356
  error estimate for blocks of size 2^( 6) =       0.000419116060
  error estimate for blocks of size 2^( 7) =       0.000421038254

      target function =                  N/A
              le_mean =     -17.216717910485
             les_mean =     296.730840860754
             stat err =       0.000417152597
             autocorr =       1.163906293746
              std dev =       0.546828248080
             le_variance =       0.299021132898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299113649369
                                         uncertainty =       0.002077572448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386665962
  error estimate for blocks of size 2^( 2) =       0.000396546008
  error estimate for blocks of size 2^( 3) =       0.000405829433
  error estimate for blocks of size 2^( 4) =       0.000412176718
  error estimate for blocks of size 2^( 5) =       0.000416279356
  error estimate for blocks of size 2^( 6) =       0.000419116060
  error estimate for blocks of size 2^( 7) =       0.000421038254

      target function =                  N/A
              le_mean =     -17.216717910485
             les_mean =     296.730840860754
             stat err =       0.000417152597
             autocorr =       1.163906293746
              std dev =       0.546828248080
             le_variance =       0.299021132898


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216717910485        initial  <--
     3.6380e+45     3.6380e+46             9.4925e-50       -17.216717910485
     1.4552e+46     1.4552e+47             2.3731e-50       -17.216717910485
     5.8208e+46     5.8208e+47             5.9328e-51       -17.216717910485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9996
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1895
    reference variance = 0.226405
====================================================
  Execution time = 1.4255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1476e-01
  Total weights = 1.957008123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300802574315
                                         uncertainty =       0.002105714939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300802574315
                                         uncertainty =       0.002105714939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387840083
  error estimate for blocks of size 2^( 2) =       0.000397765150
  error estimate for blocks of size 2^( 3) =       0.000407288707
  error estimate for blocks of size 2^( 4) =       0.000413409594
  error estimate for blocks of size 2^( 5) =       0.000417567289
  error estimate for blocks of size 2^( 6) =       0.000418733919
  error estimate for blocks of size 2^( 7) =       0.000420961620

      target function =                  N/A
              le_mean =     -17.215846598796
             les_mean =     296.700131267717
             stat err =       0.000417668105
             autocorr =       1.159730937356
              std dev =       0.548488705177
             le_variance =       0.300839859707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584659880e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+46, overlap shift 3.6380e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+47, overlap shift 1.4552e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+47, overlap shift 5.8208e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215846598826       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6772e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.195594
====================================================
  Execution time = 1.3598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1763e-01
  Total weights = 1.9567e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387619322
  error estimate for blocks of size 2^( 2) =       0.000397723129
  error estimate for blocks of size 2^( 3) =       0.000406773244
  error estimate for blocks of size 2^( 4) =       0.000413055729
  error estimate for blocks of size 2^( 5) =       0.000416541750
  error estimate for blocks of size 2^( 6) =       0.000421165884
  error estimate for blocks of size 2^( 7) =       0.000423031649

      target function =                  N/A
              le_mean =     -17.216152536730
             les_mean =     296.713540114133
             stat err =       0.000418448753
             autocorr =       1.165396527980
              std dev =       0.548176502872
             le_variance =       0.300497478301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387619322
  error estimate for blocks of size 2^( 2) =       0.000397723129
  error estimate for blocks of size 2^( 3) =       0.000406773244
  error estimate for blocks of size 2^( 4) =       0.000413055729
  error estimate for blocks of size 2^( 5) =       0.000416541750
  error estimate for blocks of size 2^( 6) =       0.000421165884
  error estimate for blocks of size 2^( 7) =       0.000423031649

      target function =                  N/A
              le_mean =     -17.216152536730
             les_mean =     296.713540114133
             stat err =       0.000418448753
             autocorr =       1.165396527980
              std dev =       0.548176502872
             le_variance =       0.300497478301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387619322
  error estimate for blocks of size 2^( 2) =       0.000397723129
  error estimate for blocks of size 2^( 3) =       0.000406773244
  error estimate for blocks of size 2^( 4) =       0.000413055729
  error estimate for blocks of size 2^( 5) =       0.000416541750
  error estimate for blocks of size 2^( 6) =       0.000421165884
  error estimate for blocks of size 2^( 7) =       0.000423031649

      target function =                  N/A
              le_mean =     -17.216152536730
             les_mean =     296.713540114133
             stat err =       0.000418448753
             autocorr =       1.165396527980
              std dev =       0.548176502872
             le_variance =       0.300497478301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300454318709
                                         uncertainty =       0.002141580062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387619322
  error estimate for blocks of size 2^( 2) =       0.000397723129
  error estimate for blocks of size 2^( 3) =       0.000406773244
  error estimate for blocks of size 2^( 4) =       0.000413055729
  error estimate for blocks of size 2^( 5) =       0.000416541750
  error estimate for blocks of size 2^( 6) =       0.000421165884
  error estimate for blocks of size 2^( 7) =       0.000423031649

      target function =                  N/A
              le_mean =     -17.216152536730
             les_mean =     296.713540114133
             stat err =       0.000418448753
             autocorr =       1.165396527980
              std dev =       0.548176502872
             le_variance =       0.300497478301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216152536730        initial  <--
     3.6380e+46     3.6380e+47             0.0000e+00       -17.216152536730
     1.4552e+47     1.4552e+48             0.0000e+00       -17.216152536730
     5.8208e+47     5.8208e+48             0.0000e+00       -17.216152536730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8860
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.55706
====================================================
  Execution time = 1.3678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1412e-01
  Total weights = 1.956626691e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298621480734
                                         uncertainty =       0.001789955093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298621480734
                                         uncertainty =       0.001789955093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386583582
  error estimate for blocks of size 2^( 2) =       0.000396767947
  error estimate for blocks of size 2^( 3) =       0.000405895372
  error estimate for blocks of size 2^( 4) =       0.000412985287
  error estimate for blocks of size 2^( 5) =       0.000416876052
  error estimate for blocks of size 2^( 6) =       0.000418609128
  error estimate for blocks of size 2^( 7) =       0.000418996103

      target function =                  N/A
              le_mean =     -17.216898497836
             les_mean =     296.735711772026
             stat err =       0.000416866642
             autocorr =       1.162806572659
              std dev =       0.546711743955
             le_variance =       0.298893730979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689849784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+47, overlap shift 3.6380e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+48, overlap shift 1.4552e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+48, overlap shift 5.8208e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216898497850       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174747 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6188e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.209363
====================================================
  Execution time = 1.3491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1462e-01
  Total weights = 1.9569e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386565907
  error estimate for blocks of size 2^( 2) =       0.000396700170
  error estimate for blocks of size 2^( 3) =       0.000405884152
  error estimate for blocks of size 2^( 4) =       0.000412889062
  error estimate for blocks of size 2^( 5) =       0.000416272029
  error estimate for blocks of size 2^( 6) =       0.000418663010
  error estimate for blocks of size 2^( 7) =       0.000421253998

      target function =                  N/A
              le_mean =     -17.217099545908
             les_mean =     296.743138379643
             stat err =       0.000417269525
             autocorr =       1.165161793650
              std dev =       0.546686748777
             le_variance =       0.298866401288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386565907
  error estimate for blocks of size 2^( 2) =       0.000396700170
  error estimate for blocks of size 2^( 3) =       0.000405884152
  error estimate for blocks of size 2^( 4) =       0.000412889062
  error estimate for blocks of size 2^( 5) =       0.000416272029
  error estimate for blocks of size 2^( 6) =       0.000418663010
  error estimate for blocks of size 2^( 7) =       0.000421253998

      target function =                  N/A
              le_mean =     -17.217099545908
             les_mean =     296.743138379643
             stat err =       0.000417269525
             autocorr =       1.165161793650
              std dev =       0.546686748777
             le_variance =       0.298866401288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386565907
  error estimate for blocks of size 2^( 2) =       0.000396700170
  error estimate for blocks of size 2^( 3) =       0.000405884152
  error estimate for blocks of size 2^( 4) =       0.000412889062
  error estimate for blocks of size 2^( 5) =       0.000416272029
  error estimate for blocks of size 2^( 6) =       0.000418663010
  error estimate for blocks of size 2^( 7) =       0.000421253998

      target function =                  N/A
              le_mean =     -17.217099545908
             les_mean =     296.743138379643
             stat err =       0.000417269525
             autocorr =       1.165161793650
              std dev =       0.546686748777
             le_variance =       0.298866401288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298976207620
                                         uncertainty =       0.002693351270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386565907
  error estimate for blocks of size 2^( 2) =       0.000396700170
  error estimate for blocks of size 2^( 3) =       0.000405884152
  error estimate for blocks of size 2^( 4) =       0.000412889062
  error estimate for blocks of size 2^( 5) =       0.000416272029
  error estimate for blocks of size 2^( 6) =       0.000418663010
  error estimate for blocks of size 2^( 7) =       0.000421253998

      target function =                  N/A
              le_mean =     -17.217099545908
             les_mean =     296.743138379643
             stat err =       0.000417269525
             autocorr =       1.165161793650
              std dev =       0.546686748777
             le_variance =       0.298866401288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217099545908        initial  <--
     3.6380e+47     3.6380e+48             0.0000e+00       -17.217099545908
     1.4552e+48     1.4552e+49             0.0000e+00       -17.217099545908
     5.8208e+48     5.8208e+49             0.0000e+00       -17.217099545908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7912
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9033e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.760627
====================================================
  Execution time = 1.3994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1973e-01
  Total weights = 1.956467187e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302314526447
                                         uncertainty =       0.001991525943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302314526447
                                         uncertainty =       0.001991525943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388909301
  error estimate for blocks of size 2^( 2) =       0.000399031791
  error estimate for blocks of size 2^( 3) =       0.000407986083
  error estimate for blocks of size 2^( 4) =       0.000415029054
  error estimate for blocks of size 2^( 5) =       0.000420396568
  error estimate for blocks of size 2^( 6) =       0.000423298357
  error estimate for blocks of size 2^( 7) =       0.000424564859

      target function =                  N/A
              le_mean =     -17.216391269532
             les_mean =     296.723854608585
             stat err =       0.000420822209
             autocorr =       1.170848341007
              std dev =       0.550000807805
             le_variance =       0.302500888587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639126953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+48, overlap shift 3.6380e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+49, overlap shift 1.4552e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+49, overlap shift 5.8208e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391269542       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175770 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6510e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.233838
====================================================
  Execution time = 1.3334e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1738e-01
  Total weights = 1.9567e+06
  Execution time = 1.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388248223
  error estimate for blocks of size 2^( 2) =       0.000398324015
  error estimate for blocks of size 2^( 3) =       0.000407264709
  error estimate for blocks of size 2^( 4) =       0.000413814783
  error estimate for blocks of size 2^( 5) =       0.000419166150
  error estimate for blocks of size 2^( 6) =       0.000421150899
  error estimate for blocks of size 2^( 7) =       0.000423824194

      target function =                  N/A
              le_mean =     -17.216307588506
             les_mean =     296.718627859525
             stat err =       0.000419489007
             autocorr =       1.167406787576
              std dev =       0.549065902705
             le_variance =       0.301473365513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388248223
  error estimate for blocks of size 2^( 2) =       0.000398324015
  error estimate for blocks of size 2^( 3) =       0.000407264709
  error estimate for blocks of size 2^( 4) =       0.000413814783
  error estimate for blocks of size 2^( 5) =       0.000419166150
  error estimate for blocks of size 2^( 6) =       0.000421150899
  error estimate for blocks of size 2^( 7) =       0.000423824194

      target function =                  N/A
              le_mean =     -17.216307588506
             les_mean =     296.718627859525
             stat err =       0.000419489007
             autocorr =       1.167406787576
              std dev =       0.549065902705
             le_variance =       0.301473365513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388248223
  error estimate for blocks of size 2^( 2) =       0.000398324015
  error estimate for blocks of size 2^( 3) =       0.000407264709
  error estimate for blocks of size 2^( 4) =       0.000413814783
  error estimate for blocks of size 2^( 5) =       0.000419166150
  error estimate for blocks of size 2^( 6) =       0.000421150899
  error estimate for blocks of size 2^( 7) =       0.000423824194

      target function =                  N/A
              le_mean =     -17.216307588506
             les_mean =     296.718627859525
             stat err =       0.000419489007
             autocorr =       1.167406787576
              std dev =       0.549065902705
             le_variance =       0.301473365513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301479158492
                                         uncertainty =       0.002199074048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388248223
  error estimate for blocks of size 2^( 2) =       0.000398324015
  error estimate for blocks of size 2^( 3) =       0.000407264709
  error estimate for blocks of size 2^( 4) =       0.000413814783
  error estimate for blocks of size 2^( 5) =       0.000419166150
  error estimate for blocks of size 2^( 6) =       0.000421150899
  error estimate for blocks of size 2^( 7) =       0.000423824194

      target function =                  N/A
              le_mean =     -17.216307588506
             les_mean =     296.718627859525
             stat err =       0.000419489007
             autocorr =       1.167406787576
              std dev =       0.549065902705
             le_variance =       0.301473365513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216307588506        initial  <--
     3.6380e+48     3.6380e+49             0.0000e+00       -17.216307588506
     1.4552e+49     1.4552e+50             0.0000e+00       -17.216307588506
     5.8208e+49     5.8208e+50             0.0000e+00       -17.216307588506

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6403
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9245e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.196
    reference variance = 0.29095
====================================================
  Execution time = 1.3573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1689e-01
  Total weights = 1.956523276e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300628896028
                                         uncertainty =       0.002384919320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300628896028
                                         uncertainty =       0.002384919320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387623408
  error estimate for blocks of size 2^( 2) =       0.000397455694
  error estimate for blocks of size 2^( 3) =       0.000406307394
  error estimate for blocks of size 2^( 4) =       0.000412357179
  error estimate for blocks of size 2^( 5) =       0.000417101160
  error estimate for blocks of size 2^( 6) =       0.000419483598
  error estimate for blocks of size 2^( 7) =       0.000421164986

      target function =                  N/A
              le_mean =     -17.216455559993
             les_mean =     296.723233306876
             stat err =       0.000417526731
             autocorr =       1.160241992367
              std dev =       0.548182280117
             le_variance =       0.300503812234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645555999e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+49, overlap shift 3.6380e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455560047       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455560047       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455560047       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+49 is 9.717522e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+50, overlap shift 1.4552e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455560047       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455560047       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455560047       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+50 is 2.429380e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+50, overlap shift 5.8208e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455560047       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455560047       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+50 is 6.015177e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6068e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2045
    reference variance = 0.676091
====================================================
  Execution time = 1.3581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1536e-01
  Total weights = 1.9568e+06
  Execution time = 1.8357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387497666
  error estimate for blocks of size 2^( 2) =       0.000397427945
  error estimate for blocks of size 2^( 3) =       0.000406010134
  error estimate for blocks of size 2^( 4) =       0.000412626066
  error estimate for blocks of size 2^( 5) =       0.000416799925
  error estimate for blocks of size 2^( 6) =       0.000418791406
  error estimate for blocks of size 2^( 7) =       0.000420842910

      target function =                  N/A
              le_mean =     -17.216144710679
             les_mean =     296.710999420203
             stat err =       0.000417265077
             autocorr =       1.159540424112
              std dev =       0.548004454785
             le_variance =       0.300308882464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387497666
  error estimate for blocks of size 2^( 2) =       0.000397427945
  error estimate for blocks of size 2^( 3) =       0.000406010134
  error estimate for blocks of size 2^( 4) =       0.000412626066
  error estimate for blocks of size 2^( 5) =       0.000416799925
  error estimate for blocks of size 2^( 6) =       0.000418791406
  error estimate for blocks of size 2^( 7) =       0.000420842910

      target function =                  N/A
              le_mean =     -17.216144710679
             les_mean =     296.710999420203
             stat err =       0.000417265077
             autocorr =       1.159540424112
              std dev =       0.548004454785
             le_variance =       0.300308882464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387497666
  error estimate for blocks of size 2^( 2) =       0.000397427945
  error estimate for blocks of size 2^( 3) =       0.000406010134
  error estimate for blocks of size 2^( 4) =       0.000412626066
  error estimate for blocks of size 2^( 5) =       0.000416799925
  error estimate for blocks of size 2^( 6) =       0.000418791406
  error estimate for blocks of size 2^( 7) =       0.000420842910

      target function =                  N/A
              le_mean =     -17.216144710679
             les_mean =     296.710999420203
             stat err =       0.000417265077
             autocorr =       1.159540424112
              std dev =       0.548004454785
             le_variance =       0.300308882464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300272341731
                                         uncertainty =       0.002832616424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387497666
  error estimate for blocks of size 2^( 2) =       0.000397427945
  error estimate for blocks of size 2^( 3) =       0.000406010134
  error estimate for blocks of size 2^( 4) =       0.000412626066
  error estimate for blocks of size 2^( 5) =       0.000416799925
  error estimate for blocks of size 2^( 6) =       0.000418791406
  error estimate for blocks of size 2^( 7) =       0.000420842910

      target function =                  N/A
              le_mean =     -17.216144710679
             les_mean =     296.710999420203
             stat err =       0.000417265077
             autocorr =       1.159540424112
              std dev =       0.548004454785
             le_variance =       0.300308882464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216144710679        initial  <--
     3.6380e+49     3.6380e+50             9.7175e-54       -17.216144710679
     1.4552e+50     1.4552e+51             2.4294e-54       -17.216144710679
     5.8208e+50     5.8208e+51             6.0152e-55       -17.216144710679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8597
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1513
    reference variance = 0.275769
====================================================
  Execution time = 1.3586e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1390e-01
  Total weights = 1.956660396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793222634
                                         uncertainty =       0.002149646756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299793222634
                                         uncertainty =       0.002149646756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125895
  error estimate for blocks of size 2^( 2) =       0.000397337182
  error estimate for blocks of size 2^( 3) =       0.000406452117
  error estimate for blocks of size 2^( 4) =       0.000412334068
  error estimate for blocks of size 2^( 5) =       0.000416969840
  error estimate for blocks of size 2^( 6) =       0.000418471257
  error estimate for blocks of size 2^( 7) =       0.000420905672

      target function =                  N/A
              le_mean =     -17.216326074009
             les_mean =     296.715786075014
             stat err =       0.000417170209
             autocorr =       1.161240380766
              std dev =       0.547478690999
             le_variance =       0.299732917098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632607401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+50, overlap shift 3.6380e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+51, overlap shift 1.4552e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+51, overlap shift 5.8208e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216326074026       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6096e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1826
    reference variance = 0.268624
====================================================
  Execution time = 1.3227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1644e-01
  Total weights = 1.9563e+06
  Execution time = 1.8287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117042
  error estimate for blocks of size 2^( 2) =       0.000396961059
  error estimate for blocks of size 2^( 3) =       0.000406292728
  error estimate for blocks of size 2^( 4) =       0.000412222435
  error estimate for blocks of size 2^( 5) =       0.000415639077
  error estimate for blocks of size 2^( 6) =       0.000417475516
  error estimate for blocks of size 2^( 7) =       0.000417013056

      target function =                  N/A
              le_mean =     -17.216542366126
             les_mean =     296.725773515222
             stat err =       0.000415587521
             autocorr =       1.152498622933
              std dev =       0.547466171552
             le_variance =       0.299719208994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117042
  error estimate for blocks of size 2^( 2) =       0.000396961059
  error estimate for blocks of size 2^( 3) =       0.000406292728
  error estimate for blocks of size 2^( 4) =       0.000412222435
  error estimate for blocks of size 2^( 5) =       0.000415639077
  error estimate for blocks of size 2^( 6) =       0.000417475516
  error estimate for blocks of size 2^( 7) =       0.000417013056

      target function =                  N/A
              le_mean =     -17.216542366126
             les_mean =     296.725773515222
             stat err =       0.000415587521
             autocorr =       1.152498622933
              std dev =       0.547466171552
             le_variance =       0.299719208994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117042
  error estimate for blocks of size 2^( 2) =       0.000396961059
  error estimate for blocks of size 2^( 3) =       0.000406292728
  error estimate for blocks of size 2^( 4) =       0.000412222435
  error estimate for blocks of size 2^( 5) =       0.000415639077
  error estimate for blocks of size 2^( 6) =       0.000417475516
  error estimate for blocks of size 2^( 7) =       0.000417013056

      target function =                  N/A
              le_mean =     -17.216542366126
             les_mean =     296.725773515222
             stat err =       0.000415587521
             autocorr =       1.152498622933
              std dev =       0.547466171552
             le_variance =       0.299719208994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299774496526
                                         uncertainty =       0.001888483456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117042
  error estimate for blocks of size 2^( 2) =       0.000396961059
  error estimate for blocks of size 2^( 3) =       0.000406292728
  error estimate for blocks of size 2^( 4) =       0.000412222435
  error estimate for blocks of size 2^( 5) =       0.000415639077
  error estimate for blocks of size 2^( 6) =       0.000417475516
  error estimate for blocks of size 2^( 7) =       0.000417013056

      target function =                  N/A
              le_mean =     -17.216542366126
             les_mean =     296.725773515222
             stat err =       0.000415587521
             autocorr =       1.152498622933
              std dev =       0.547466171552
             le_variance =       0.299719208994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216542366126        initial  <--
     3.6380e+50     3.6380e+51             0.0000e+00       -17.216542366126
     1.4552e+51     1.4552e+52             0.0000e+00       -17.216542366126
     5.8208e+51     5.8208e+52             0.0000e+00       -17.216542366126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5112
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.221105
====================================================
  Execution time = 1.4228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1221e-01
  Total weights = 1.956488993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.0148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298577310534
                                         uncertainty =       0.001727239740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298577310534
                                         uncertainty =       0.001727239740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386332525
  error estimate for blocks of size 2^( 2) =       0.000396585151
  error estimate for blocks of size 2^( 3) =       0.000405726583
  error estimate for blocks of size 2^( 4) =       0.000411934602
  error estimate for blocks of size 2^( 5) =       0.000415712724
  error estimate for blocks of size 2^( 6) =       0.000416566766
  error estimate for blocks of size 2^( 7) =       0.000416496792

      target function =                  N/A
              le_mean =     -17.217142643168
             les_mean =     296.742207959892
             stat err =       0.000415177721
             autocorr =       1.154903069002
              std dev =       0.546356696894
             le_variance =       0.298505640241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714264317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+51, overlap shift 3.6380e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+52, overlap shift 1.4552e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+52, overlap shift 5.8208e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217142643184       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0227e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1547
    reference variance = 0.280629
====================================================
  Execution time = 1.3586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1804e-01
  Total weights = 1.9569e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387270163
  error estimate for blocks of size 2^( 2) =       0.000397790302
  error estimate for blocks of size 2^( 3) =       0.000407037093
  error estimate for blocks of size 2^( 4) =       0.000414143338
  error estimate for blocks of size 2^( 5) =       0.000419609129
  error estimate for blocks of size 2^( 6) =       0.000420119912
  error estimate for blocks of size 2^( 7) =       0.000419683173

      target function =                  N/A
              le_mean =     -17.215702634017
             les_mean =     296.698457729088
             stat err =       0.000418388888
             autocorr =       1.167164868504
              std dev =       0.547682716878
             le_variance =       0.299956358367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387270163
  error estimate for blocks of size 2^( 2) =       0.000397790302
  error estimate for blocks of size 2^( 3) =       0.000407037093
  error estimate for blocks of size 2^( 4) =       0.000414143338
  error estimate for blocks of size 2^( 5) =       0.000419609129
  error estimate for blocks of size 2^( 6) =       0.000420119912
  error estimate for blocks of size 2^( 7) =       0.000419683173

      target function =                  N/A
              le_mean =     -17.215702634017
             les_mean =     296.698457729088
             stat err =       0.000418388888
             autocorr =       1.167164868504
              std dev =       0.547682716878
             le_variance =       0.299956358367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387270163
  error estimate for blocks of size 2^( 2) =       0.000397790302
  error estimate for blocks of size 2^( 3) =       0.000407037093
  error estimate for blocks of size 2^( 4) =       0.000414143338
  error estimate for blocks of size 2^( 5) =       0.000419609129
  error estimate for blocks of size 2^( 6) =       0.000420119912
  error estimate for blocks of size 2^( 7) =       0.000419683173

      target function =                  N/A
              le_mean =     -17.215702634017
             les_mean =     296.698457729088
             stat err =       0.000418388888
             autocorr =       1.167164868504
              std dev =       0.547682716878
             le_variance =       0.299956358367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299945224402
                                         uncertainty =       0.002343136501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387270163
  error estimate for blocks of size 2^( 2) =       0.000397790302
  error estimate for blocks of size 2^( 3) =       0.000407037093
  error estimate for blocks of size 2^( 4) =       0.000414143338
  error estimate for blocks of size 2^( 5) =       0.000419609129
  error estimate for blocks of size 2^( 6) =       0.000420119912
  error estimate for blocks of size 2^( 7) =       0.000419683173

      target function =                  N/A
              le_mean =     -17.215702634017
             les_mean =     296.698457729088
             stat err =       0.000418388888
             autocorr =       1.167164868504
              std dev =       0.547682716878
             le_variance =       0.299956358367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215702634017        initial  <--
     3.6380e+51     3.6380e+52             0.0000e+00       -17.215702634017
     1.4552e+52     1.4552e+53             0.0000e+00       -17.215702634017
     5.8208e+52     5.8208e+53             0.0000e+00       -17.215702634017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8976
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2634
    reference variance = 0.202462
====================================================
  Execution time = 1.3479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.956343805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298189410663
                                         uncertainty =       0.002339235846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298189410663
                                         uncertainty =       0.002339235846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386079856
  error estimate for blocks of size 2^( 2) =       0.000396185265
  error estimate for blocks of size 2^( 3) =       0.000405140247
  error estimate for blocks of size 2^( 4) =       0.000412259043
  error estimate for blocks of size 2^( 5) =       0.000416639270
  error estimate for blocks of size 2^( 6) =       0.000420323732
  error estimate for blocks of size 2^( 7) =       0.000422468090

      target function =                  N/A
              le_mean =     -17.216393178855
             les_mean =     296.716766027496
             stat err =       0.000417922534
             autocorr =       1.171756281590
              std dev =       0.545999369187
             le_variance =       0.298115311153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639317886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+52, overlap shift 3.6380e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216393178855       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216393178855       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+52 is 9.265640e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+53, overlap shift 1.4552e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216393178855       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216393178855       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+53 is 2.316410e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+53, overlap shift 5.8208e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216393178855       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216393178855       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+53 is 5.791025e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.5979e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1761
    reference variance = 0.187939
====================================================
  Execution time = 1.3807e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1361e-01
  Total weights = 1.9567e+06
  Execution time = 1.8285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085304
  error estimate for blocks of size 2^( 2) =       0.000396165255
  error estimate for blocks of size 2^( 3) =       0.000405054730
  error estimate for blocks of size 2^( 4) =       0.000411472815
  error estimate for blocks of size 2^( 5) =       0.000415126927
  error estimate for blocks of size 2^( 6) =       0.000418165529
  error estimate for blocks of size 2^( 7) =       0.000419006401

      target function =                  N/A
              le_mean =     -17.216341848464
             les_mean =     296.716032328666
             stat err =       0.000415942918
             autocorr =       1.160649068983
              std dev =       0.546007072980
             le_variance =       0.298123723745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085304
  error estimate for blocks of size 2^( 2) =       0.000396165255
  error estimate for blocks of size 2^( 3) =       0.000405054730
  error estimate for blocks of size 2^( 4) =       0.000411472815
  error estimate for blocks of size 2^( 5) =       0.000415126927
  error estimate for blocks of size 2^( 6) =       0.000418165529
  error estimate for blocks of size 2^( 7) =       0.000419006401

      target function =                  N/A
              le_mean =     -17.216341848464
             les_mean =     296.716032328666
             stat err =       0.000415942918
             autocorr =       1.160649068983
              std dev =       0.546007072980
             le_variance =       0.298123723745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085304
  error estimate for blocks of size 2^( 2) =       0.000396165255
  error estimate for blocks of size 2^( 3) =       0.000405054730
  error estimate for blocks of size 2^( 4) =       0.000411472815
  error estimate for blocks of size 2^( 5) =       0.000415126927
  error estimate for blocks of size 2^( 6) =       0.000418165529
  error estimate for blocks of size 2^( 7) =       0.000419006401

      target function =                  N/A
              le_mean =     -17.216341848464
             les_mean =     296.716032328666
             stat err =       0.000415942918
             autocorr =       1.160649068983
              std dev =       0.546007072980
             le_variance =       0.298123723745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298163844976
                                         uncertainty =       0.001945791266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386085304
  error estimate for blocks of size 2^( 2) =       0.000396165255
  error estimate for blocks of size 2^( 3) =       0.000405054730
  error estimate for blocks of size 2^( 4) =       0.000411472815
  error estimate for blocks of size 2^( 5) =       0.000415126927
  error estimate for blocks of size 2^( 6) =       0.000418165529
  error estimate for blocks of size 2^( 7) =       0.000419006401

      target function =                  N/A
              le_mean =     -17.216341848464
             les_mean =     296.716032328666
             stat err =       0.000415942918
             autocorr =       1.160649068983
              std dev =       0.546007072980
             le_variance =       0.298123723745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216341848464        initial  <--
     3.6380e+52     3.6380e+53             9.2656e-57       -17.216341848464
     1.4552e+53     1.4552e+54             2.3164e-57       -17.216341848464
     5.8208e+53     5.8208e+54             5.7910e-58       -17.216341848464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0733
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1746
    reference variance = 0.422749
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1493e-01
  Total weights = 1.956530174e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300692369214
                                         uncertainty =       0.002293133388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300692369214
                                         uncertainty =       0.002293133388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387740283
  error estimate for blocks of size 2^( 2) =       0.000398129267
  error estimate for blocks of size 2^( 3) =       0.000407355657
  error estimate for blocks of size 2^( 4) =       0.000413968661
  error estimate for blocks of size 2^( 5) =       0.000419341891
  error estimate for blocks of size 2^( 6) =       0.000421295699
  error estimate for blocks of size 2^( 7) =       0.000423018534

      target function =                  N/A
              le_mean =     -17.216392098510
             les_mean =     296.719089161684
             stat err =       0.000419406196
             autocorr =       1.170005324867
              std dev =       0.548347567297
             le_variance =       0.300685054560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639209851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+53, overlap shift 3.6380e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+54, overlap shift 1.4552e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+54, overlap shift 5.8208e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216392098571       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6259e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.249905
====================================================
  Execution time = 1.3220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1335e-01
  Total weights = 1.9566e+06
  Execution time = 1.8343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386358369
  error estimate for blocks of size 2^( 2) =       0.000396454584
  error estimate for blocks of size 2^( 3) =       0.000405687940
  error estimate for blocks of size 2^( 4) =       0.000412641385
  error estimate for blocks of size 2^( 5) =       0.000417505613
  error estimate for blocks of size 2^( 6) =       0.000421043806
  error estimate for blocks of size 2^( 7) =       0.000421179263

      target function =                  N/A
              le_mean =     -17.216501292044
             les_mean =     296.721270969043
             stat err =       0.000418092517
             autocorr =       1.171019538822
              std dev =       0.546393245227
             le_variance =       0.298545578430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386358369
  error estimate for blocks of size 2^( 2) =       0.000396454584
  error estimate for blocks of size 2^( 3) =       0.000405687940
  error estimate for blocks of size 2^( 4) =       0.000412641385
  error estimate for blocks of size 2^( 5) =       0.000417505613
  error estimate for blocks of size 2^( 6) =       0.000421043806
  error estimate for blocks of size 2^( 7) =       0.000421179263

      target function =                  N/A
              le_mean =     -17.216501292044
             les_mean =     296.721270969043
             stat err =       0.000418092517
             autocorr =       1.171019538822
              std dev =       0.546393245227
             le_variance =       0.298545578430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386358369
  error estimate for blocks of size 2^( 2) =       0.000396454584
  error estimate for blocks of size 2^( 3) =       0.000405687940
  error estimate for blocks of size 2^( 4) =       0.000412641385
  error estimate for blocks of size 2^( 5) =       0.000417505613
  error estimate for blocks of size 2^( 6) =       0.000421043806
  error estimate for blocks of size 2^( 7) =       0.000421179263

      target function =                  N/A
              le_mean =     -17.216501292044
             les_mean =     296.721270969043
             stat err =       0.000418092517
             autocorr =       1.171019538822
              std dev =       0.546393245227
             le_variance =       0.298545578430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298576297262
                                         uncertainty =       0.001833685175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386358369
  error estimate for blocks of size 2^( 2) =       0.000396454584
  error estimate for blocks of size 2^( 3) =       0.000405687940
  error estimate for blocks of size 2^( 4) =       0.000412641385
  error estimate for blocks of size 2^( 5) =       0.000417505613
  error estimate for blocks of size 2^( 6) =       0.000421043806
  error estimate for blocks of size 2^( 7) =       0.000421179263

      target function =                  N/A
              le_mean =     -17.216501292044
             les_mean =     296.721270969043
             stat err =       0.000418092517
             autocorr =       1.171019538822
              std dev =       0.546393245227
             le_variance =       0.298545578430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216501292044        initial  <--
     3.6380e+53     3.6380e+54             0.0000e+00       -17.216501292044
     1.4552e+54     1.4552e+55             0.0000e+00       -17.216501292044
     5.8208e+54     5.8208e+55             0.0000e+00       -17.216501292044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5204
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.406524
====================================================
  Execution time = 1.3755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1361e-01
  Total weights = 1.956430090e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217946529
                                         uncertainty =       0.002127840148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299217946529
                                         uncertainty =       0.002127840148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386843310
  error estimate for blocks of size 2^( 2) =       0.000396919635
  error estimate for blocks of size 2^( 3) =       0.000405994774
  error estimate for blocks of size 2^( 4) =       0.000412670512
  error estimate for blocks of size 2^( 5) =       0.000416498148
  error estimate for blocks of size 2^( 6) =       0.000420555703
  error estimate for blocks of size 2^( 7) =       0.000420927577

      target function =                  N/A
              le_mean =     -17.216621978691
             les_mean =     296.725684795012
             stat err =       0.000417662985
             autocorr =       1.165686573901
              std dev =       0.547079055753
             le_variance =       0.299295493244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662197869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+54, overlap shift 3.6380e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+54 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+55, overlap shift 1.4552e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+55 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+55, overlap shift 5.8208e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621978757       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6257e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2563
    reference variance = 0.241821
====================================================
  Execution time = 1.3371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1311e-01
  Total weights = 1.9568e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386610274
  error estimate for blocks of size 2^( 2) =       0.000396977904
  error estimate for blocks of size 2^( 3) =       0.000405963370
  error estimate for blocks of size 2^( 4) =       0.000412789396
  error estimate for blocks of size 2^( 5) =       0.000416273747
  error estimate for blocks of size 2^( 6) =       0.000418572106
  error estimate for blocks of size 2^( 7) =       0.000418753819

      target function =                  N/A
              le_mean =     -17.216152542216
             les_mean =     296.709015145642
             stat err =       0.000416597267
             autocorr =       1.161143914359
              std dev =       0.546749493163
             le_variance =       0.298935008274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386610274
  error estimate for blocks of size 2^( 2) =       0.000396977904
  error estimate for blocks of size 2^( 3) =       0.000405963370
  error estimate for blocks of size 2^( 4) =       0.000412789396
  error estimate for blocks of size 2^( 5) =       0.000416273747
  error estimate for blocks of size 2^( 6) =       0.000418572106
  error estimate for blocks of size 2^( 7) =       0.000418753819

      target function =                  N/A
              le_mean =     -17.216152542216
             les_mean =     296.709015145642
             stat err =       0.000416597267
             autocorr =       1.161143914359
              std dev =       0.546749493163
             le_variance =       0.298935008274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386610274
  error estimate for blocks of size 2^( 2) =       0.000396977904
  error estimate for blocks of size 2^( 3) =       0.000405963370
  error estimate for blocks of size 2^( 4) =       0.000412789396
  error estimate for blocks of size 2^( 5) =       0.000416273747
  error estimate for blocks of size 2^( 6) =       0.000418572106
  error estimate for blocks of size 2^( 7) =       0.000418753819

      target function =                  N/A
              le_mean =     -17.216152542216
             les_mean =     296.709015145642
             stat err =       0.000416597267
             autocorr =       1.161143914359
              std dev =       0.546749493163
             le_variance =       0.298935008274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298999946106
                                         uncertainty =       0.001900658582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386610274
  error estimate for blocks of size 2^( 2) =       0.000396977904
  error estimate for blocks of size 2^( 3) =       0.000405963370
  error estimate for blocks of size 2^( 4) =       0.000412789396
  error estimate for blocks of size 2^( 5) =       0.000416273747
  error estimate for blocks of size 2^( 6) =       0.000418572106
  error estimate for blocks of size 2^( 7) =       0.000418753819

      target function =                  N/A
              le_mean =     -17.216152542216
             les_mean =     296.709015145642
             stat err =       0.000416597267
             autocorr =       1.161143914359
              std dev =       0.546749493163
             le_variance =       0.298935008274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216152542216        initial  <--
     3.6380e+54     3.6380e+55             0.0000e+00       -17.216152542216
     1.4552e+55     1.4552e+56             0.0000e+00       -17.216152542216
     5.8208e+55     5.8208e+56             0.0000e+00       -17.216152542216

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6611
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1061
    reference variance = 0.184458
====================================================
  Execution time = 1.3622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0790e-01
  Total weights = 1.956749219e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295247766112
                                         uncertainty =       0.001754783531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295247766112
                                         uncertainty =       0.001754783531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384192441
  error estimate for blocks of size 2^( 2) =       0.000394149233
  error estimate for blocks of size 2^( 3) =       0.000403346141
  error estimate for blocks of size 2^( 4) =       0.000410590291
  error estimate for blocks of size 2^( 5) =       0.000414911561
  error estimate for blocks of size 2^( 6) =       0.000418010404
  error estimate for blocks of size 2^( 7) =       0.000419735014

      target function =                  N/A
              le_mean =     -17.216298672815
             les_mean =     296.708844804904
             stat err =       0.000415811818
             autocorr =       1.171375201504
              std dev =       0.543330159948
             le_variance =       0.295207662709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629867281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+55, overlap shift 3.6380e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+56, overlap shift 1.4552e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+56, overlap shift 5.8208e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298672914       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6131e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.15
    reference variance = 0.163446
====================================================
  Execution time = 1.3476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1795e-01
  Total weights = 1.9564e+06
  Execution time = 1.8413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389185718
  error estimate for blocks of size 2^( 2) =       0.000398955251
  error estimate for blocks of size 2^( 3) =       0.000408079321
  error estimate for blocks of size 2^( 4) =       0.000414466356
  error estimate for blocks of size 2^( 5) =       0.000418934662
  error estimate for blocks of size 2^( 6) =       0.000420112151
  error estimate for blocks of size 2^( 7) =       0.000419607581

      target function =                  N/A
              le_mean =     -17.217151686153
             les_mean =     296.748261415815
             stat err =       0.000418280187
             autocorr =       1.155103231215
              std dev =       0.550391720629
             le_variance =       0.302931046137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389185718
  error estimate for blocks of size 2^( 2) =       0.000398955251
  error estimate for blocks of size 2^( 3) =       0.000408079321
  error estimate for blocks of size 2^( 4) =       0.000414466356
  error estimate for blocks of size 2^( 5) =       0.000418934662
  error estimate for blocks of size 2^( 6) =       0.000420112151
  error estimate for blocks of size 2^( 7) =       0.000419607581

      target function =                  N/A
              le_mean =     -17.217151686153
             les_mean =     296.748261415815
             stat err =       0.000418280187
             autocorr =       1.155103231215
              std dev =       0.550391720629
             le_variance =       0.302931046137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389185718
  error estimate for blocks of size 2^( 2) =       0.000398955251
  error estimate for blocks of size 2^( 3) =       0.000408079321
  error estimate for blocks of size 2^( 4) =       0.000414466356
  error estimate for blocks of size 2^( 5) =       0.000418934662
  error estimate for blocks of size 2^( 6) =       0.000420112151
  error estimate for blocks of size 2^( 7) =       0.000419607581

      target function =                  N/A
              le_mean =     -17.217151686153
             les_mean =     296.748261415815
             stat err =       0.000418280187
             autocorr =       1.155103231215
              std dev =       0.550391720629
             le_variance =       0.302931046137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937562090
                                         uncertainty =       0.002679615514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389185718
  error estimate for blocks of size 2^( 2) =       0.000398955251
  error estimate for blocks of size 2^( 3) =       0.000408079321
  error estimate for blocks of size 2^( 4) =       0.000414466356
  error estimate for blocks of size 2^( 5) =       0.000418934662
  error estimate for blocks of size 2^( 6) =       0.000420112151
  error estimate for blocks of size 2^( 7) =       0.000419607581

      target function =                  N/A
              le_mean =     -17.217151686153
             les_mean =     296.748261415815
             stat err =       0.000418280187
             autocorr =       1.155103231215
              std dev =       0.550391720629
             le_variance =       0.302931046137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217151686153        initial  <--
     3.6380e+55     3.6380e+56             0.0000e+00       -17.217151686153
     1.4552e+56     1.4552e+57             0.0000e+00       -17.217151686153
     5.8208e+56     5.8208e+57             0.0000e+00       -17.217151686153

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8403
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.224
    reference variance = 0.330836
====================================================
  Execution time = 1.3539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1558e-01
  Total weights = 1.956647451e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300491990718
                                         uncertainty =       0.001858632390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300491990718
                                         uncertainty =       0.001858632390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387616676
  error estimate for blocks of size 2^( 2) =       0.000397600176
  error estimate for blocks of size 2^( 3) =       0.000406684061
  error estimate for blocks of size 2^( 4) =       0.000413378919
  error estimate for blocks of size 2^( 5) =       0.000417365052
  error estimate for blocks of size 2^( 6) =       0.000419453602
  error estimate for blocks of size 2^( 7) =       0.000421714283

      target function =                  N/A
              le_mean =     -17.216919076255
             les_mean =     296.737883207310
             stat err =       0.000417977964
             autocorr =       1.162791550133
              std dev =       0.548172760064
             le_variance =       0.300493374876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691907626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+56, overlap shift 3.6380e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+57, overlap shift 1.4552e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+57, overlap shift 5.8208e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216919076274       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6057e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1614
    reference variance = 0.188784
====================================================
  Execution time = 1.3380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0985e-01
  Total weights = 1.9563e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384406641
  error estimate for blocks of size 2^( 2) =       0.000394514876
  error estimate for blocks of size 2^( 3) =       0.000403431055
  error estimate for blocks of size 2^( 4) =       0.000410168851
  error estimate for blocks of size 2^( 5) =       0.000413805730
  error estimate for blocks of size 2^( 6) =       0.000416412582
  error estimate for blocks of size 2^( 7) =       0.000417680717

      target function =                  N/A
              le_mean =     -17.217148818150
             les_mean =     296.740060736956
             stat err =       0.000414516970
             autocorr =       1.162794223926
              std dev =       0.543633085406
             le_variance =       0.295536931548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384406641
  error estimate for blocks of size 2^( 2) =       0.000394514876
  error estimate for blocks of size 2^( 3) =       0.000403431055
  error estimate for blocks of size 2^( 4) =       0.000410168851
  error estimate for blocks of size 2^( 5) =       0.000413805730
  error estimate for blocks of size 2^( 6) =       0.000416412582
  error estimate for blocks of size 2^( 7) =       0.000417680717

      target function =                  N/A
              le_mean =     -17.217148818150
             les_mean =     296.740060736956
             stat err =       0.000414516970
             autocorr =       1.162794223926
              std dev =       0.543633085406
             le_variance =       0.295536931548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384406641
  error estimate for blocks of size 2^( 2) =       0.000394514876
  error estimate for blocks of size 2^( 3) =       0.000403431055
  error estimate for blocks of size 2^( 4) =       0.000410168851
  error estimate for blocks of size 2^( 5) =       0.000413805730
  error estimate for blocks of size 2^( 6) =       0.000416412582
  error estimate for blocks of size 2^( 7) =       0.000417680717

      target function =                  N/A
              le_mean =     -17.217148818150
             les_mean =     296.740060736956
             stat err =       0.000414516970
             autocorr =       1.162794223926
              std dev =       0.543633085406
             le_variance =       0.295536931548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295550929617
                                         uncertainty =       0.001617931937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384406641
  error estimate for blocks of size 2^( 2) =       0.000394514876
  error estimate for blocks of size 2^( 3) =       0.000403431055
  error estimate for blocks of size 2^( 4) =       0.000410168851
  error estimate for blocks of size 2^( 5) =       0.000413805730
  error estimate for blocks of size 2^( 6) =       0.000416412582
  error estimate for blocks of size 2^( 7) =       0.000417680717

      target function =                  N/A
              le_mean =     -17.217148818150
             les_mean =     296.740060736956
             stat err =       0.000414516970
             autocorr =       1.162794223926
              std dev =       0.543633085406
             le_variance =       0.295536931548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217148818150        initial  <--
     3.6380e+56     3.6380e+57             0.0000e+00       -17.217148818150
     1.4552e+57     1.4552e+58             0.0000e+00       -17.217148818150
     5.8208e+57     5.8208e+58             0.0000e+00       -17.217148818150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6723
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.525517
====================================================
  Execution time = 1.4042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1227e-01
  Total weights = 1.956935961e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299963027290
                                         uncertainty =       0.002074699460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299963027290
                                         uncertainty =       0.002074699460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387277863
  error estimate for blocks of size 2^( 2) =       0.000397586506
  error estimate for blocks of size 2^( 3) =       0.000406799664
  error estimate for blocks of size 2^( 4) =       0.000413387301
  error estimate for blocks of size 2^( 5) =       0.000418007009
  error estimate for blocks of size 2^( 6) =       0.000421426210
  error estimate for blocks of size 2^( 7) =       0.000422527031

      target function =                  N/A
              le_mean =     -17.216974559108
             les_mean =     296.736487926798
             stat err =       0.000418836888
             autocorr =       1.169619233990
              std dev =       0.547693606028
             le_variance =       0.299968286083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697455911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+57, overlap shift 3.6380e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+58, overlap shift 1.4552e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+58, overlap shift 5.8208e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216974559148       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6567e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.226
    reference variance = 0.42945
====================================================
  Execution time = 1.3208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1374e-01
  Total weights = 1.9565e+06
  Execution time = 1.8377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387168021
  error estimate for blocks of size 2^( 2) =       0.000397157620
  error estimate for blocks of size 2^( 3) =       0.000406013280
  error estimate for blocks of size 2^( 4) =       0.000412751075
  error estimate for blocks of size 2^( 5) =       0.000417746363
  error estimate for blocks of size 2^( 6) =       0.000420321692
  error estimate for blocks of size 2^( 7) =       0.000421216600

      target function =                  N/A
              le_mean =     -17.216096362941
             les_mean =     296.707709572032
             stat err =       0.000418008932
             autocorr =       1.165660735225
              std dev =       0.547538266036
             le_variance =       0.299798152774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387168021
  error estimate for blocks of size 2^( 2) =       0.000397157620
  error estimate for blocks of size 2^( 3) =       0.000406013280
  error estimate for blocks of size 2^( 4) =       0.000412751075
  error estimate for blocks of size 2^( 5) =       0.000417746363
  error estimate for blocks of size 2^( 6) =       0.000420321692
  error estimate for blocks of size 2^( 7) =       0.000421216600

      target function =                  N/A
              le_mean =     -17.216096362941
             les_mean =     296.707709572032
             stat err =       0.000418008932
             autocorr =       1.165660735225
              std dev =       0.547538266036
             le_variance =       0.299798152774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387168021
  error estimate for blocks of size 2^( 2) =       0.000397157620
  error estimate for blocks of size 2^( 3) =       0.000406013280
  error estimate for blocks of size 2^( 4) =       0.000412751075
  error estimate for blocks of size 2^( 5) =       0.000417746363
  error estimate for blocks of size 2^( 6) =       0.000420321692
  error estimate for blocks of size 2^( 7) =       0.000421216600

      target function =                  N/A
              le_mean =     -17.216096362941
             les_mean =     296.707709572032
             stat err =       0.000418008932
             autocorr =       1.165660735225
              std dev =       0.547538266036
             le_variance =       0.299798152774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299799750923
                                         uncertainty =       0.003403527083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387168021
  error estimate for blocks of size 2^( 2) =       0.000397157620
  error estimate for blocks of size 2^( 3) =       0.000406013280
  error estimate for blocks of size 2^( 4) =       0.000412751075
  error estimate for blocks of size 2^( 5) =       0.000417746363
  error estimate for blocks of size 2^( 6) =       0.000420321692
  error estimate for blocks of size 2^( 7) =       0.000421216600

      target function =                  N/A
              le_mean =     -17.216096362941
             les_mean =     296.707709572032
             stat err =       0.000418008932
             autocorr =       1.165660735225
              std dev =       0.547538266036
             le_variance =       0.299798152774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216096362941        initial  <--
     3.6380e+57     3.6380e+58             0.0000e+00       -17.216096362941
     1.4552e+58     1.4552e+59             0.0000e+00       -17.216096362941
     5.8208e+58     5.8208e+59             0.0000e+00       -17.216096362941

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5152
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.191151
====================================================
  Execution time = 1.4194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0782e-01
  Total weights = 1.956836439e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295655981944
                                         uncertainty =       0.001609892692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295655981944
                                         uncertainty =       0.001609892692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384466416
  error estimate for blocks of size 2^( 2) =       0.000394250116
  error estimate for blocks of size 2^( 3) =       0.000403619408
  error estimate for blocks of size 2^( 4) =       0.000410076153
  error estimate for blocks of size 2^( 5) =       0.000415351156
  error estimate for blocks of size 2^( 6) =       0.000417400368
  error estimate for blocks of size 2^( 7) =       0.000417987897

      target function =                  N/A
              le_mean =     -17.216349004328
             les_mean =     296.710493270555
             stat err =       0.000415203893
             autocorr =       1.166288560653
              std dev =       0.543717619966
             le_variance =       0.295628850261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634900433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+58, overlap shift 3.6380e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+59, overlap shift 1.4552e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+59, overlap shift 5.8208e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349004379       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6698e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.229
    reference variance = 0.478096
====================================================
  Execution time = 1.3468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1907e-01
  Total weights = 1.9568e+06
  Execution time = 1.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389147421
  error estimate for blocks of size 2^( 2) =       0.000398973521
  error estimate for blocks of size 2^( 3) =       0.000407995885
  error estimate for blocks of size 2^( 4) =       0.000415063360
  error estimate for blocks of size 2^( 5) =       0.000418537224
  error estimate for blocks of size 2^( 6) =       0.000420661663
  error estimate for blocks of size 2^( 7) =       0.000421694805

      target function =                  N/A
              le_mean =     -17.216292211228
             les_mean =     296.719790271876
             stat err =       0.000418989263
             autocorr =       1.159250989484
              std dev =       0.550337560049
             le_variance =       0.302871430000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389147421
  error estimate for blocks of size 2^( 2) =       0.000398973521
  error estimate for blocks of size 2^( 3) =       0.000407995885
  error estimate for blocks of size 2^( 4) =       0.000415063360
  error estimate for blocks of size 2^( 5) =       0.000418537224
  error estimate for blocks of size 2^( 6) =       0.000420661663
  error estimate for blocks of size 2^( 7) =       0.000421694805

      target function =                  N/A
              le_mean =     -17.216292211228
             les_mean =     296.719790271876
             stat err =       0.000418989263
             autocorr =       1.159250989484
              std dev =       0.550337560049
             le_variance =       0.302871430000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389147421
  error estimate for blocks of size 2^( 2) =       0.000398973521
  error estimate for blocks of size 2^( 3) =       0.000407995885
  error estimate for blocks of size 2^( 4) =       0.000415063360
  error estimate for blocks of size 2^( 5) =       0.000418537224
  error estimate for blocks of size 2^( 6) =       0.000420661663
  error estimate for blocks of size 2^( 7) =       0.000421694805

      target function =                  N/A
              le_mean =     -17.216292211228
             les_mean =     296.719790271876
             stat err =       0.000418989263
             autocorr =       1.159250989484
              std dev =       0.550337560049
             le_variance =       0.302871430000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302797689863
                                         uncertainty =       0.002421894567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389147421
  error estimate for blocks of size 2^( 2) =       0.000398973521
  error estimate for blocks of size 2^( 3) =       0.000407995885
  error estimate for blocks of size 2^( 4) =       0.000415063360
  error estimate for blocks of size 2^( 5) =       0.000418537224
  error estimate for blocks of size 2^( 6) =       0.000420661663
  error estimate for blocks of size 2^( 7) =       0.000421694805

      target function =                  N/A
              le_mean =     -17.216292211228
             les_mean =     296.719790271876
             stat err =       0.000418989263
             autocorr =       1.159250989484
              std dev =       0.550337560049
             le_variance =       0.302871430000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216292211228        initial  <--
     3.6380e+58     3.6380e+59             0.0000e+00       -17.216292211228
     1.4552e+59     1.4552e+60             0.0000e+00       -17.216292211228
     5.8208e+59     5.8208e+60             0.0000e+00       -17.216292211228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 25.9097
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2138
    reference variance = 0.175761
====================================================
  Execution time = 1.4673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1854e-01
  Total weights = 1.956580548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304480982676
                                         uncertainty =       0.008204973806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304480982676
                                         uncertainty =       0.008204973806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390196637
  error estimate for blocks of size 2^( 2) =       0.000399866414
  error estimate for blocks of size 2^( 3) =       0.000408434874
  error estimate for blocks of size 2^( 4) =       0.000415114722
  error estimate for blocks of size 2^( 5) =       0.000420000903
  error estimate for blocks of size 2^( 6) =       0.000421129962
  error estimate for blocks of size 2^( 7) =       0.000421408020

      target function =                  N/A
              le_mean =     -17.216507152638
             les_mean =     296.726662755141
             stat err =       0.000419413402
             autocorr =       1.155360626266
              std dev =       0.551821376491
             le_variance =       0.304506831552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650715264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+59, overlap shift 3.6380e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+60, overlap shift 1.4552e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+60, overlap shift 5.8208e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216507152648       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7174e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.207041
====================================================
  Execution time = 1.3177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1924e-01
  Total weights = 1.9565e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390126209
  error estimate for blocks of size 2^( 2) =       0.000399807287
  error estimate for blocks of size 2^( 3) =       0.000408458053
  error estimate for blocks of size 2^( 4) =       0.000416040857
  error estimate for blocks of size 2^( 5) =       0.000420055350
  error estimate for blocks of size 2^( 6) =       0.000420533342
  error estimate for blocks of size 2^( 7) =       0.000422019422

      target function =                  N/A
              le_mean =     -17.216139037585
             les_mean =     296.714682128929
             stat err =       0.000419662243
             autocorr =       1.157149681001
              std dev =       0.551721775430
             le_variance =       0.304396917484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390126209
  error estimate for blocks of size 2^( 2) =       0.000399807287
  error estimate for blocks of size 2^( 3) =       0.000408458053
  error estimate for blocks of size 2^( 4) =       0.000416040857
  error estimate for blocks of size 2^( 5) =       0.000420055350
  error estimate for blocks of size 2^( 6) =       0.000420533342
  error estimate for blocks of size 2^( 7) =       0.000422019422

      target function =                  N/A
              le_mean =     -17.216139037585
             les_mean =     296.714682128929
             stat err =       0.000419662243
             autocorr =       1.157149681001
              std dev =       0.551721775430
             le_variance =       0.304396917484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390126209
  error estimate for blocks of size 2^( 2) =       0.000399807287
  error estimate for blocks of size 2^( 3) =       0.000408458053
  error estimate for blocks of size 2^( 4) =       0.000416040857
  error estimate for blocks of size 2^( 5) =       0.000420055350
  error estimate for blocks of size 2^( 6) =       0.000420533342
  error estimate for blocks of size 2^( 7) =       0.000422019422

      target function =                  N/A
              le_mean =     -17.216139037585
             les_mean =     296.714682128929
             stat err =       0.000419662243
             autocorr =       1.157149681001
              std dev =       0.551721775430
             le_variance =       0.304396917484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304412462519
                                         uncertainty =       0.003331355377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390126209
  error estimate for blocks of size 2^( 2) =       0.000399807287
  error estimate for blocks of size 2^( 3) =       0.000408458053
  error estimate for blocks of size 2^( 4) =       0.000416040857
  error estimate for blocks of size 2^( 5) =       0.000420055350
  error estimate for blocks of size 2^( 6) =       0.000420533342
  error estimate for blocks of size 2^( 7) =       0.000422019422

      target function =                  N/A
              le_mean =     -17.216139037585
             les_mean =     296.714682128929
             stat err =       0.000419662243
             autocorr =       1.157149681001
              std dev =       0.551721775430
             le_variance =       0.304396917484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216139037585        initial  <--
     3.6380e+59     3.6380e+60             0.0000e+00       -17.216139037585
     1.4552e+60     1.4552e+61             0.0000e+00       -17.216139037585
     5.8208e+60     5.8208e+61             0.0000e+00       -17.216139037585

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5116
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.184782
====================================================
  Execution time = 1.4461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1054e-01
  Total weights = 1.956711942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297491192619
                                         uncertainty =       0.002350427428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297491192619
                                         uncertainty =       0.002350427428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385656941
  error estimate for blocks of size 2^( 2) =       0.000395904220
  error estimate for blocks of size 2^( 3) =       0.000404788926
  error estimate for blocks of size 2^( 4) =       0.000411955839
  error estimate for blocks of size 2^( 5) =       0.000415842773
  error estimate for blocks of size 2^( 6) =       0.000417693126
  error estimate for blocks of size 2^( 7) =       0.000419163686

      target function =                  N/A
              le_mean =     -17.215841985307
             les_mean =     296.695757849424
             stat err =       0.000416163856
             autocorr =       1.164464931538
              std dev =       0.545401276077
             le_variance =       0.297462551946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584198531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+60, overlap shift 3.6380e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+61, overlap shift 1.4552e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+61, overlap shift 5.8208e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215841985334       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7054e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2576
    reference variance = 0.264455
====================================================
  Execution time = 1.3286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1433e-01
  Total weights = 1.9565e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125074
  error estimate for blocks of size 2^( 2) =       0.000397053565
  error estimate for blocks of size 2^( 3) =       0.000406104012
  error estimate for blocks of size 2^( 4) =       0.000413508631
  error estimate for blocks of size 2^( 5) =       0.000418486637
  error estimate for blocks of size 2^( 6) =       0.000420645562
  error estimate for blocks of size 2^( 7) =       0.000422381886

      target function =                  N/A
              le_mean =     -17.215721449786
             les_mean =     296.695397099280
             stat err =       0.000418755679
             autocorr =       1.170088786160
              std dev =       0.547477529501
             le_variance =       0.299731645308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125074
  error estimate for blocks of size 2^( 2) =       0.000397053565
  error estimate for blocks of size 2^( 3) =       0.000406104012
  error estimate for blocks of size 2^( 4) =       0.000413508631
  error estimate for blocks of size 2^( 5) =       0.000418486637
  error estimate for blocks of size 2^( 6) =       0.000420645562
  error estimate for blocks of size 2^( 7) =       0.000422381886

      target function =                  N/A
              le_mean =     -17.215721449786
             les_mean =     296.695397099280
             stat err =       0.000418755679
             autocorr =       1.170088786160
              std dev =       0.547477529501
             le_variance =       0.299731645308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125074
  error estimate for blocks of size 2^( 2) =       0.000397053565
  error estimate for blocks of size 2^( 3) =       0.000406104012
  error estimate for blocks of size 2^( 4) =       0.000413508631
  error estimate for blocks of size 2^( 5) =       0.000418486637
  error estimate for blocks of size 2^( 6) =       0.000420645562
  error estimate for blocks of size 2^( 7) =       0.000422381886

      target function =                  N/A
              le_mean =     -17.215721449786
             les_mean =     296.695397099280
             stat err =       0.000418755679
             autocorr =       1.170088786160
              std dev =       0.547477529501
             le_variance =       0.299731645308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299771390940
                                         uncertainty =       0.002825564655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125074
  error estimate for blocks of size 2^( 2) =       0.000397053565
  error estimate for blocks of size 2^( 3) =       0.000406104012
  error estimate for blocks of size 2^( 4) =       0.000413508631
  error estimate for blocks of size 2^( 5) =       0.000418486637
  error estimate for blocks of size 2^( 6) =       0.000420645562
  error estimate for blocks of size 2^( 7) =       0.000422381886

      target function =                  N/A
              le_mean =     -17.215721449786
             les_mean =     296.695397099280
             stat err =       0.000418755679
             autocorr =       1.170088786160
              std dev =       0.547477529501
             le_variance =       0.299731645308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215721449786        initial  <--
     3.6380e+60     3.6380e+61             0.0000e+00       -17.215721449786
     1.4552e+61     1.4552e+62             0.0000e+00       -17.215721449786
     5.8208e+61     5.8208e+62             0.0000e+00       -17.215721449786

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6109
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2391
    reference variance = 0.188744
====================================================
  Execution time = 1.3698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1717e-01
  Total weights = 1.956460406e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301054771040
                                         uncertainty =       0.002052264291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301054771040
                                         uncertainty =       0.002052264291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388022311
  error estimate for blocks of size 2^( 2) =       0.000398191205
  error estimate for blocks of size 2^( 3) =       0.000407673847
  error estimate for blocks of size 2^( 4) =       0.000414466944
  error estimate for blocks of size 2^( 5) =       0.000418416876
  error estimate for blocks of size 2^( 6) =       0.000421118223
  error estimate for blocks of size 2^( 7) =       0.000422646061

      target function =                  N/A
              le_mean =     -17.216209964939
             les_mean =     296.715056508840
             stat err =       0.000419162026
             autocorr =       1.166945212704
              std dev =       0.548746414504
             le_variance =       0.301122627431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620996494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+61, overlap shift 3.6380e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+62, overlap shift 1.4552e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+62, overlap shift 5.8208e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216209964993       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6217e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.165036
====================================================
  Execution time = 1.3831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1581e-01
  Total weights = 1.9566e+06
  Execution time = 1.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386887230
  error estimate for blocks of size 2^( 2) =       0.000396649778
  error estimate for blocks of size 2^( 3) =       0.000405147455
  error estimate for blocks of size 2^( 4) =       0.000412041546
  error estimate for blocks of size 2^( 5) =       0.000415457965
  error estimate for blocks of size 2^( 6) =       0.000417878893
  error estimate for blocks of size 2^( 7) =       0.000420872974

      target function =                  N/A
              le_mean =     -17.215958420241
             les_mean =     296.705034314389
             stat err =       0.000416562844
             autocorr =       1.159290479346
              std dev =       0.547141168285
             le_variance =       0.299363458033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386887230
  error estimate for blocks of size 2^( 2) =       0.000396649778
  error estimate for blocks of size 2^( 3) =       0.000405147455
  error estimate for blocks of size 2^( 4) =       0.000412041546
  error estimate for blocks of size 2^( 5) =       0.000415457965
  error estimate for blocks of size 2^( 6) =       0.000417878893
  error estimate for blocks of size 2^( 7) =       0.000420872974

      target function =                  N/A
              le_mean =     -17.215958420241
             les_mean =     296.705034314389
             stat err =       0.000416562844
             autocorr =       1.159290479346
              std dev =       0.547141168285
             le_variance =       0.299363458033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386887230
  error estimate for blocks of size 2^( 2) =       0.000396649778
  error estimate for blocks of size 2^( 3) =       0.000405147455
  error estimate for blocks of size 2^( 4) =       0.000412041546
  error estimate for blocks of size 2^( 5) =       0.000415457965
  error estimate for blocks of size 2^( 6) =       0.000417878893
  error estimate for blocks of size 2^( 7) =       0.000420872974

      target function =                  N/A
              le_mean =     -17.215958420241
             les_mean =     296.705034314389
             stat err =       0.000416562844
             autocorr =       1.159290479346
              std dev =       0.547141168285
             le_variance =       0.299363458033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299432874677
                                         uncertainty =       0.003175928913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386887230
  error estimate for blocks of size 2^( 2) =       0.000396649778
  error estimate for blocks of size 2^( 3) =       0.000405147455
  error estimate for blocks of size 2^( 4) =       0.000412041546
  error estimate for blocks of size 2^( 5) =       0.000415457965
  error estimate for blocks of size 2^( 6) =       0.000417878893
  error estimate for blocks of size 2^( 7) =       0.000420872974

      target function =                  N/A
              le_mean =     -17.215958420241
             les_mean =     296.705034314389
             stat err =       0.000416562844
             autocorr =       1.159290479346
              std dev =       0.547141168285
             le_variance =       0.299363458033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215958420241        initial  <--
     3.6380e+61     3.6380e+62             0.0000e+00       -17.215958420241
     1.4552e+62     1.4552e+63             0.0000e+00       -17.215958420241
     5.8208e+62     5.8208e+63             0.0000e+00       -17.215958420241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1271
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.278559
====================================================
  Execution time = 1.3828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1251e-01
  Total weights = 1.956732856e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296972816841
                                         uncertainty =       0.001835972397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296972816841
                                         uncertainty =       0.001835972397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385349020
  error estimate for blocks of size 2^( 2) =       0.000395630974
  error estimate for blocks of size 2^( 3) =       0.000404731028
  error estimate for blocks of size 2^( 4) =       0.000411838435
  error estimate for blocks of size 2^( 5) =       0.000416819326
  error estimate for blocks of size 2^( 6) =       0.000419655298
  error estimate for blocks of size 2^( 7) =       0.000418448707

      target function =                  N/A
              le_mean =     -17.215905037083
             les_mean =     296.699896732267
             stat err =       0.000416690442
             autocorr =       1.169280102965
              std dev =       0.544965810095
             le_variance =       0.296987734173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590503708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+62, overlap shift 3.6380e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215905037141       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215905037141       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+62 is 1.397612e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+63, overlap shift 1.4552e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215905037141       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215905037141       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+63 is 3.494031e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+63, overlap shift 5.8208e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215905037141       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215905037141       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+63 is 8.735076e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6350e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.185962
====================================================
  Execution time = 1.3638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1164e-01
  Total weights = 1.9570e+06
  Execution time = 1.8344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385953172
  error estimate for blocks of size 2^( 2) =       0.000396145344
  error estimate for blocks of size 2^( 3) =       0.000405024295
  error estimate for blocks of size 2^( 4) =       0.000412119631
  error estimate for blocks of size 2^( 5) =       0.000416289177
  error estimate for blocks of size 2^( 6) =       0.000418599564
  error estimate for blocks of size 2^( 7) =       0.000420857586

      target function =                  N/A
              le_mean =     -17.216006953700
             les_mean =     296.702530789675
             stat err =       0.000416966490
             autocorr =       1.167167211432
              std dev =       0.545820209618
             le_variance =       0.297919701227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385953172
  error estimate for blocks of size 2^( 2) =       0.000396145344
  error estimate for blocks of size 2^( 3) =       0.000405024295
  error estimate for blocks of size 2^( 4) =       0.000412119631
  error estimate for blocks of size 2^( 5) =       0.000416289177
  error estimate for blocks of size 2^( 6) =       0.000418599564
  error estimate for blocks of size 2^( 7) =       0.000420857586

      target function =                  N/A
              le_mean =     -17.216006953700
             les_mean =     296.702530789675
             stat err =       0.000416966490
             autocorr =       1.167167211432
              std dev =       0.545820209618
             le_variance =       0.297919701227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385953172
  error estimate for blocks of size 2^( 2) =       0.000396145344
  error estimate for blocks of size 2^( 3) =       0.000405024295
  error estimate for blocks of size 2^( 4) =       0.000412119631
  error estimate for blocks of size 2^( 5) =       0.000416289177
  error estimate for blocks of size 2^( 6) =       0.000418599564
  error estimate for blocks of size 2^( 7) =       0.000420857586

      target function =                  N/A
              le_mean =     -17.216006953700
             les_mean =     296.702530789675
             stat err =       0.000416966490
             autocorr =       1.167167211432
              std dev =       0.545820209618
             le_variance =       0.297919701227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297902297049
                                         uncertainty =       0.001941222523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385953172
  error estimate for blocks of size 2^( 2) =       0.000396145344
  error estimate for blocks of size 2^( 3) =       0.000405024295
  error estimate for blocks of size 2^( 4) =       0.000412119631
  error estimate for blocks of size 2^( 5) =       0.000416289177
  error estimate for blocks of size 2^( 6) =       0.000418599564
  error estimate for blocks of size 2^( 7) =       0.000420857586

      target function =                  N/A
              le_mean =     -17.216006953700
             les_mean =     296.702530789675
             stat err =       0.000416966490
             autocorr =       1.167167211432
              std dev =       0.545820209618
             le_variance =       0.297919701227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216006953700        initial  <--
     3.6380e+62     3.6380e+63             1.3976e-66       -17.216006953700
     1.4552e+63     1.4552e+64             3.4940e-67       -17.216006953700
     5.8208e+63     5.8208e+64             8.7351e-68       -17.216006953700

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9316
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.015425e-02 3 1  ON 0
ci_002                -2.986199e-02 3 1  ON 1
ci_003                -2.495003e-02 3 1  ON 2
ci_004                 2.087982e-02 3 1  ON 3
ci_005                 2.136139e-02 3 1  ON 4
ci_006                -1.910191e-02 3 1  ON 5
ci_007                -1.885097e-02 3 1  ON 6
ci_008                -1.779666e-02 3 1  ON 7
ci_009                -1.737760e-02 3 1  ON 8
ci_010                -1.730649e-02 3 1  ON 9
ci_011                -1.650832e-02 3 1  ON 10
ci_012                -1.652860e-02 3 1  ON 11
ci_013                -1.889361e-02 3 1  ON 12
ci_014                 1.309446e-02 3 1  ON 13
ci_015                 1.339137e-02 3 1  ON 14
ci_016                 1.632388e-02 3 1  ON 15
ci_017                 1.708215e-02 3 1  ON 16
ci_018                 1.259360e-02 3 1  ON 17
ci_019                 1.259253e-02 3 1  ON 18
ci_020                 1.302609e-02 3 1  ON 19
ci_021                 1.336943e-02 3 1  ON 20
ci_022                 1.176982e-02 3 1  ON 21
ci_023                 1.160783e-02 3 1  ON 22
ci_024                 1.155475e-02 3 1  ON 23
ci_025                 1.169438e-02 3 1  ON 24
ci_026                 1.109590e-02 3 1  ON 25
ci_027                 1.115474e-02 3 1  ON 26
ci_028                -1.514511e-02 3 1  ON 27
ci_029                -1.460055e-02 3 1  ON 28
ci_030                -1.114964e-02 3 1  ON 29
ci_031                -1.057487e-02 3 1  ON 30
ci_032                -1.340082e-02 3 1  ON 31
ci_033                 1.052759e-02 3 1  ON 32
ci_034                 9.979452e-03 3 1  ON 33
ci_035                -4.523072e-03 3 1  ON 34
ci_036                -1.085452e-02 3 1  ON 35
ci_037                -1.037078e-02 3 1  ON 36
ci_038                 1.546030e-03 3 1  ON 37
ci_039                 1.767778e-03 3 1  ON 38
ci_040                -3.967473e-03 3 1  ON 39
ci_041                 1.001780e-02 3 1  ON 40
ci_042                 1.028313e-02 3 1  ON 41
ci_043                -3.122600e-03 3 1  ON 42
ci_044                -1.553368e-02 3 1  ON 43
ci_045                -1.467745e-03 3 1  ON 44
ci_046                 5.036849e-03 3 1  ON 45
ci_047                 6.020492e-03 3 1  ON 46
ci_048                -1.195807e-02 3 1  ON 47
ci_049                -1.163287e-02 3 1  ON 48
ci_050                 7.703012e-03 3 1  ON 49
ci_051                 7.859623e-03 3 1  ON 50
ci_052                -6.683056e-03 3 1  ON 51
ci_053                -6.488479e-03 3 1  ON 52
ci_054                -2.433641e-03 3 1  ON 53
ci_055                -3.000042e-03 3 1  ON 54
ci_056                 4.128565e-03 3 1  ON 55
ci_057                 4.853702e-03 3 1  ON 56
ci_058                -6.390224e-03 3 1  ON 57
ci_059                -6.802644e-03 3 1  ON 58
ci_060                 8.846470e-03 3 1  ON 59
ci_061                 9.074120e-03 3 1  ON 60
ci_062                -3.602506e-03 3 1  ON 61
ci_063                -2.711840e-03 3 1  ON 62
ci_064                -3.136841e-03 3 1  ON 63
ci_065                -3.793698e-03 3 1  ON 64
ci_066                 5.245315e-03 3 1  ON 65
ci_067                 5.402201e-03 3 1  ON 66
ci_068                -4.793969e-03 3 1  ON 67
ci_069                -5.261138e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9716e+01 secs
  Total Execution time = 4.0187e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
