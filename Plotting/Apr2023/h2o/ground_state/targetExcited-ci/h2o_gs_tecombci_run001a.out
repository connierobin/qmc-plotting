--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0243.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 85646 MB
Rank =    1  Free Memory = 85641 MB
Rank =    2  Free Memory = 85640 MB
Rank =    3  Free Memory = 85640 MB
Rank =    4  Free Memory = 85639 MB
Rank =    5  Free Memory = 85639 MB
Rank =    6  Free Memory = 85639 MB
Rank =    7  Free Memory = 85638 MB
Rank =    8  Free Memory = 85638 MB
Rank =    9  Free Memory = 85638 MB
Rank =   10  Free Memory = 85638 MB
Rank =   11  Free Memory = 85638 MB
Rank =   12  Free Memory = 85638 MB
Rank =   13  Free Memory = 85638 MB
Rank =   14  Free Memory = 85638 MB
Rank =   15  Free Memory = 85638 MB
Rank =   16  Free Memory = 85638 MB
Rank =   17  Free Memory = 85638 MB
Rank =   18  Free Memory = 85638 MB
Rank =   19  Free Memory = 85638 MB
Rank =   20  Free Memory = 85638 MB
Rank =   21  Free Memory = 85638 MB
Rank =   22  Free Memory = 85638 MB
Rank =   23  Free Memory = 85638 MB
Rank =   24  Free Memory = 85638 MB
Rank =   25  Free Memory = 85638 MB
Rank =   26  Free Memory = 85638 MB
Rank =   27  Free Memory = 85638 MB
Rank =   28  Free Memory = 85638 MB
Rank =   29  Free Memory = 85638 MB
Rank =   30  Free Memory = 85638 MB
Rank =   31  Free Memory = 85638 MB
Rank =   32  Free Memory = 85638 MB
Rank =   33  Free Memory = 85638 MB
Rank =   34  Free Memory = 85638 MB
Rank =   35  Free Memory = 85638 MB
Rank =   36  Free Memory = 85638 MB
Rank =   37  Free Memory = 85638 MB
Rank =   38  Free Memory = 85638 MB
Rank =   39  Free Memory = 85638 MB
Rank =   40  Free Memory = 85815 MB
Rank =   41  Free Memory = 85815 MB
Rank =   42  Free Memory = 85815 MB
Rank =   43  Free Memory = 85815 MB
Rank =   44  Free Memory = 85815 MB
Rank =   45  Free Memory = 85815 MB
Rank =   46  Free Memory = 85815 MB
Rank =   47  Free Memory = 85815 MB
Rank =   48  Free Memory = 85815 MB
Rank =   49  Free Memory = 85815 MB
Rank =   50  Free Memory = 85815 MB
Rank =   51  Free Memory = 85815 MB
Rank =   52  Free Memory = 85815 MB
Rank =   53  Free Memory = 85815 MB
Rank =   54  Free Memory = 85815 MB
Rank =   55  Free Memory = 85815 MB
Rank =   56  Free Memory = 85815 MB
Rank =   57  Free Memory = 85815 MB
Rank =   58  Free Memory = 85815 MB
Rank =   59  Free Memory = 85815 MB
Rank =   60  Free Memory = 85815 MB
Rank =   61  Free Memory = 85815 MB
Rank =   62  Free Memory = 85815 MB
Rank =   63  Free Memory = 85815 MB
Rank =   64  Free Memory = 85815 MB
Rank =   65  Free Memory = 85815 MB
Rank =   66  Free Memory = 85815 MB
Rank =   67  Free Memory = 85815 MB
Rank =   68  Free Memory = 85815 MB
Rank =   69  Free Memory = 85815 MB
Rank =   70  Free Memory = 85815 MB
Rank =   71  Free Memory = 85815 MB
Rank =   72  Free Memory = 85815 MB
Rank =   73  Free Memory = 85815 MB
Rank =   74  Free Memory = 85815 MB
Rank =   75  Free Memory = 85815 MB
Rank =   76  Free Memory = 85815 MB
Rank =   77  Free Memory = 85815 MB
Rank =   78  Free Memory = 85815 MB
Rank =   79  Free Memory = 85815 MB
Rank =   80  Free Memory = 85809 MB
Rank =   81  Free Memory = 85809 MB
Rank =   82  Free Memory = 85809 MB
Rank =   83  Free Memory = 85809 MB
Rank =   84  Free Memory = 85809 MB
Rank =   85  Free Memory = 85809 MB
Rank =   86  Free Memory = 85809 MB
Rank =   87  Free Memory = 85809 MB
Rank =   88  Free Memory = 85809 MB
Rank =   89  Free Memory = 85809 MB
Rank =   90  Free Memory = 85809 MB
Rank =   91  Free Memory = 85809 MB
Rank =   92  Free Memory = 85809 MB
Rank =   93  Free Memory = 85809 MB
Rank =   94  Free Memory = 85809 MB
Rank =   95  Free Memory = 85809 MB
Rank =   96  Free Memory = 85809 MB
Rank =   97  Free Memory = 85809 MB
Rank =   98  Free Memory = 85809 MB
Rank =   99  Free Memory = 85809 MB
Rank =  100  Free Memory = 85809 MB
Rank =  101  Free Memory = 85809 MB
Rank =  102  Free Memory = 85809 MB
Rank =  103  Free Memory = 85809 MB
Rank =  104  Free Memory = 85809 MB
Rank =  105  Free Memory = 85809 MB
Rank =  106  Free Memory = 85809 MB
Rank =  107  Free Memory = 85809 MB
Rank =  108  Free Memory = 85809 MB
Rank =  109  Free Memory = 85809 MB
Rank =  110  Free Memory = 85809 MB
Rank =  111  Free Memory = 85809 MB
Rank =  112  Free Memory = 85809 MB
Rank =  113  Free Memory = 85809 MB
Rank =  114  Free Memory = 85809 MB
Rank =  115  Free Memory = 85809 MB
Rank =  116  Free Memory = 85809 MB
Rank =  117  Free Memory = 85809 MB
Rank =  118  Free Memory = 85809 MB
Rank =  119  Free Memory = 85809 MB
  Input file(s): opt_h2o_gs_tecombci_run001a.xml 
Rank =  120  Free Memory = 87174 MB
Rank =  121  Free Memory = 87174 MB
Rank =  122  Free Memory = 87174 MB
Rank =  123  Free Memory = 87174 MB
Rank =  124  Free Memory = 87174 MB
Rank =  125  Free Memory = 87174 MB
Rank =  127  Free Memory = 87174 MB
Rank =  126  Free Memory = 87174 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tecombci_run001a.xml

  Project = H2O
  date    = 2023-04-11 20:42:00 PDT
  host    = n0240.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 136

  Range of prime numbers to use as seeds over processors and threads = 787-1699


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.061949e-01    1         1 OFF
     uu_1                 4.539117e-02    1         1 OFF
     uu_2                -4.680481e-02    1         1 OFF
     uu_3                -9.936272e-02    1         1 OFF
     uu_4                -1.304449e-01    1         1 OFF
     uu_5                -1.356413e-01    1         1 OFF
     uu_6                -1.130357e-01    1         1 OFF
     uu_7                -3.972344e-02    1         1 OFF
     uu_8                 9.988696e-02    1         1 OFF
     uu_9                 1.208933e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.495801e-01    1         1 OFF
     ud_1                 9.178565e-02    1         1 OFF
     ud_2                -1.648758e-02    1         1 OFF
     ud_3                -7.596335e-02    1         1 OFF
     ud_4                -1.217524e-01    1         1 OFF
     ud_5                -1.523214e-01    1         1 OFF
     ud_6                -1.544624e-01    1         1 OFF
     ud_7                -1.100034e-01    1         1 OFF
     ud_8                 4.463187e-03    1         1 OFF
     ud_9                 9.258159e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.504332e-01    1         1 OFF
     eO_1                -4.354966e-01    1         1 OFF
     eO_2                -3.598301e-02    1         1 OFF
     eO_3                 2.081612e-01    1         1 OFF
     eO_4                 2.891481e-01    1         1 OFF
     eO_5                 3.052708e-01    1         1 OFF
     eO_6                 2.501148e-01    1         1 OFF
     eO_7                 1.121837e-01    1         1 OFF
     eO_8                 2.793060e-02    1         1 OFF
     eO_9                 1.846823e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820113e-01    1         1 OFF
     eH1_1                -1.027126e-01    1         1 OFF
     eH1_2                -6.202978e-02    1         1 OFF
     eH1_3                -2.594624e-02    1         1 OFF
     eH1_4                 1.931583e-02    1         1 OFF
     eH1_5                 3.552903e-02    1         1 OFF
     eH1_6                 7.728065e-02    1         1 OFF
     eH1_7                 1.103061e-01    1         1 OFF
     eH1_8                 9.073801e-02    1         1 OFF
     eH1_9                 2.428776e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835289e-01    1         1 OFF
     eH2_1                -1.038380e-01    1         1 OFF
     eH2_2                -6.350521e-02    1         1 OFF
     eH2_3                -2.706107e-02    1         1 OFF
     eH2_4                 1.856801e-02    1         1 OFF
     eH2_5                 3.504988e-02    1         1 OFF
     eH2_6                 7.827831e-02    1         1 OFF
     eH2_7                 1.134121e-01    1         1 OFF
     eH2_8                 9.397367e-02    1         1 OFF
     eH2_9                 2.639279e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.5187e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0240.savio3:228738] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0240.savio3:228738] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.324919
====================================================
  Execution time = 1.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.7197e+01
  VMC Evar = 4.5456e-01
  Total weights = 1.954417495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428511255860
                                         uncertainty =       0.004312558499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.428511255860
                                         uncertainty =       0.004312558499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000462823952
  error estimate for blocks of size 2^( 2) =       0.000474224688
  error estimate for blocks of size 2^( 3) =       0.000484839321
  error estimate for blocks of size 2^( 4) =       0.000492350831
  error estimate for blocks of size 2^( 5) =       0.000496981826
  error estimate for blocks of size 2^( 6) =       0.000499177387
  error estimate for blocks of size 2^( 7) =       0.000500876993

      target function =      -0.741389384153
              le_mean =     -17.197368040635
             les_mean =     296.204027599990
             stat err =       0.000497346759
             autocorr =       1.154747239295
   target nu stat err =       0.000497346759
   target dn stat err =       0.006543385054
      target stat err =       0.005482118630
              std dev =       0.654531909385
             le_variance =       0.428412020403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.719736804064e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741428424429       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.764893121818       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.769964614412       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.771732168721       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.772110837609       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.772186949431       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.772204173030       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.772210185905       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.772211352781       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.772211465301       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.772211168216       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.772211124192       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.772211139205       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.772211135103       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 6.015503e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741428424429       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748186328749       residual = 3.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749561490260       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750015890834       residual = 2.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750107761404       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750125303623       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750129115133       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750130509150       residual = 3.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750130753008       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750130763346       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750130698654       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750130691361       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750130693564       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.789101e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741428424429       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743181972994       residual = 3.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743531578156       residual = 9.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743645159094       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743667710378       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743671950064       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743672860158       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743673198128       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743673255269       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743673256703       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743673241364       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743673239798       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743673240234       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.686347e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6557e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -6.475700e-02                3 1 ON  0
ci_002 -5.038257e-02                3 1 ON  1
ci_003 -3.611197e-02                3 1 ON  2
ci_004 3.562167e-02                 3 1 ON  3
ci_005 3.563193e-02                 3 1 ON  4
ci_006 -3.444125e-02                3 1 ON  5
ci_007 -3.444435e-02                3 1 ON  6
ci_008 -2.974950e-02                3 1 ON  7
ci_009 -2.846472e-02                3 1 ON  8
ci_010 -2.760375e-02                3 1 ON  9
ci_011 -2.736850e-02                3 1 ON  10
ci_012 -2.742954e-02                3 1 ON  11
ci_013 -2.657063e-02                3 1 ON  12
ci_014 2.571845e-02                 3 1 ON  13
ci_015 2.569953e-02                 3 1 ON  14
ci_016 2.487740e-02                 3 1 ON  15
ci_017 2.493483e-02                 3 1 ON  16
ci_018 2.402438e-02                 3 1 ON  17
ci_019 2.401827e-02                 3 1 ON  18
ci_020 2.415072e-02                 3 1 ON  19
ci_021 2.422115e-02                 3 1 ON  20
ci_022 2.119054e-02                 3 1 ON  21
ci_023 2.110320e-02                 3 1 ON  22
ci_024 2.107546e-02                 3 1 ON  23
ci_025 2.116993e-02                 3 1 ON  24
ci_026 2.096275e-02                 3 1 ON  25
ci_027 2.096511e-02                 3 1 ON  26
ci_028 -2.085412e-02                3 1 ON  27
ci_029 -2.086671e-02                3 1 ON  28
ci_030 -1.937376e-02                3 1 ON  29
ci_031 -1.927721e-02                3 1 ON  30
ci_032 -1.845052e-02                3 1 ON  31
ci_033 1.761147e-02                 3 1 ON  32
ci_034 1.749728e-02                 3 1 ON  33
ci_035 -1.717218e-02                3 1 ON  34
ci_036 -1.773299e-02                3 1 ON  35
ci_037 -1.774537e-02                3 1 ON  36
ci_038 1.644615e-02                 3 1 ON  37
ci_039 1.650485e-02                 3 1 ON  38
ci_040 -1.569816e-02                3 1 ON  39
ci_041 1.595752e-02                 3 1 ON  40
ci_042 1.606711e-02                 3 1 ON  41
ci_043 -1.537392e-02                3 1 ON  42
ci_044 -1.524292e-02                3 1 ON  43
ci_045 -1.485790e-02                3 1 ON  44
ci_046 1.442734e-02                 3 1 ON  45
ci_047 1.433079e-02                 3 1 ON  46
ci_048 -1.429304e-02                3 1 ON  47
ci_049 -1.437438e-02                3 1 ON  48
ci_050 1.283254e-02                 3 1 ON  49
ci_051 1.286589e-02                 3 1 ON  50
ci_052 -1.203357e-02                3 1 ON  51
ci_053 -1.208776e-02                3 1 ON  52
ci_054 -1.203725e-02                3 1 ON  53
ci_055 -1.203073e-02                3 1 ON  54
ci_056 1.203119e-02                 3 1 ON  55
ci_057 1.201193e-02                 3 1 ON  56
ci_058 -1.170956e-02                3 1 ON  57
ci_059 -1.172799e-02                3 1 ON  58
ci_060 1.141074e-02                 3 1 ON  59
ci_061 1.152863e-02                 3 1 ON  60
ci_062 -1.088637e-02                3 1 ON  61
ci_063 -1.104691e-02                3 1 ON  62
ci_064 -1.043513e-02                3 1 ON  63
ci_065 -1.042945e-02                3 1 ON  64
ci_066 1.026824e-02                 3 1 ON  65
ci_067 1.031415e-02                 3 1 ON  66
ci_068 -9.652522e-03                3 1 ON  67
ci_069 -9.694743e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2792
    reference variance = 0.91003
====================================================
  Execution time = 1.3322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.3630e-01
  Total weights = 1.9542e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437445345628
                                         uncertainty =       0.004474134660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437445345628
                                         uncertainty =       0.004474134660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467675574
  error estimate for blocks of size 2^( 2) =       0.000479310869
  error estimate for blocks of size 2^( 3) =       0.000489600585
  error estimate for blocks of size 2^( 4) =       0.000496952683
  error estimate for blocks of size 2^( 5) =       0.000501958189
  error estimate for blocks of size 2^( 6) =       0.000505193053
  error estimate for blocks of size 2^( 7) =       0.000508467892

      target function =      -0.704590312410
              le_mean =     -17.200386937027
             les_mean =     296.353746967536
             stat err =       0.000503142954
             autocorr =       1.157426481992
   target nu stat err =       0.000503142954
   target dn stat err =       0.017434142741
      target stat err =       0.013198963619
              std dev =       0.661393139842
             le_variance =       0.437440885430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.671306183584
                                         uncertainty =       0.294284362504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.671306183584
                                         uncertainty =       0.294284362504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000579089597
  error estimate for blocks of size 2^( 2) =       0.000587290705
  error estimate for blocks of size 2^( 3) =       0.000594721224
  error estimate for blocks of size 2^( 4) =       0.000600105086
  error estimate for blocks of size 2^( 5) =       0.000604047261
  error estimate for blocks of size 2^( 6) =       0.000607725467
  error estimate for blocks of size 2^( 7) =       0.000608647324

      target function =      -0.029549978018
              le_mean =     -17.200839353721
             les_mean =     307.464161894000
             stat err =       0.000605131284
             autocorr =       1.091962404352
   target nu stat err =       0.000605131284
   target dn stat err =      11.070857959697
      target stat err =       0.027203695160
              std dev =       0.818956361403
             le_variance =       0.670689521882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394370492084
                                         uncertainty =       0.003864551485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394370492084
                                         uncertainty =       0.003864551485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444042665
  error estimate for blocks of size 2^( 2) =       0.000455181832
  error estimate for blocks of size 2^( 3) =       0.000465058968
  error estimate for blocks of size 2^( 4) =       0.000472349188
  error estimate for blocks of size 2^( 5) =       0.000477050554
  error estimate for blocks of size 2^( 6) =       0.000480250597
  error estimate for blocks of size 2^( 7) =       0.000483059298

      target function =      -0.730467848970
              le_mean =     -17.200519560769
             les_mean =     296.324632181102
             stat err =       0.000478177409
             autocorr =       1.159654744312
   target nu stat err =       0.000478177409
   target dn stat err =       0.029723655909
      target stat err =       0.024194936241
              std dev =       0.627971158428
             le_variance =       0.394347775818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430401508479
                                         uncertainty =       0.004336959882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.430401508479
                                         uncertainty =       0.004336959882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000463894147
  error estimate for blocks of size 2^( 2) =       0.000475479147
  error estimate for blocks of size 2^( 3) =       0.000485732218
  error estimate for blocks of size 2^( 4) =       0.000493302518
  error estimate for blocks of size 2^( 5) =       0.000498180016
  error estimate for blocks of size 2^( 6) =       0.000501439205
  error estimate for blocks of size 2^( 7) =       0.000504653105

      target function =      -0.724284679662
              le_mean =     -17.200370152595
             les_mean =     296.328025016653
             stat err =       0.000499393711
             autocorr =       1.158906376436
   target nu stat err =       0.000499393711
   target dn stat err =       0.010952066094
      target stat err =       0.008769548509
              std dev =       0.656045393977
             le_variance =       0.430395558959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.704590312410        initial
     2.5000e-01     2.5000e+00             6.0155e-03        -0.029549978018
     1.0000e+00     1.0000e+01             1.7891e-03        -0.730467848970  <--
     4.0000e+00     4.0000e+01             4.6863e-04        -0.724284679662

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2865e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -6.475700e-02 3 1  ON 0
ci_002                -5.038257e-02 3 1  ON 1
ci_003                -3.611197e-02 3 1  ON 2
ci_004                 3.562167e-02 3 1  ON 3
ci_005                 3.563193e-02 3 1  ON 4
ci_006                -3.444125e-02 3 1  ON 5
ci_007                -3.444435e-02 3 1  ON 6
ci_008                -2.974950e-02 3 1  ON 7
ci_009                -2.846472e-02 3 1  ON 8
ci_010                -2.760375e-02 3 1  ON 9
ci_011                -2.736850e-02 3 1  ON 10
ci_012                -2.742954e-02 3 1  ON 11
ci_013                -2.657063e-02 3 1  ON 12
ci_014                 2.571845e-02 3 1  ON 13
ci_015                 2.569953e-02 3 1  ON 14
ci_016                 2.487740e-02 3 1  ON 15
ci_017                 2.493483e-02 3 1  ON 16
ci_018                 2.402438e-02 3 1  ON 17
ci_019                 2.401827e-02 3 1  ON 18
ci_020                 2.415072e-02 3 1  ON 19
ci_021                 2.422115e-02 3 1  ON 20
ci_022                 2.119054e-02 3 1  ON 21
ci_023                 2.110320e-02 3 1  ON 22
ci_024                 2.107546e-02 3 1  ON 23
ci_025                 2.116993e-02 3 1  ON 24
ci_026                 2.096275e-02 3 1  ON 25
ci_027                 2.096511e-02 3 1  ON 26
ci_028                -2.085412e-02 3 1  ON 27
ci_029                -2.086671e-02 3 1  ON 28
ci_030                -1.937376e-02 3 1  ON 29
ci_031                -1.927721e-02 3 1  ON 30
ci_032                -1.845052e-02 3 1  ON 31
ci_033                 1.761147e-02 3 1  ON 32
ci_034                 1.749728e-02 3 1  ON 33
ci_035                -1.717218e-02 3 1  ON 34
ci_036                -1.773299e-02 3 1  ON 35
ci_037                -1.774537e-02 3 1  ON 36
ci_038                 1.644615e-02 3 1  ON 37
ci_039                 1.650485e-02 3 1  ON 38
ci_040                -1.569816e-02 3 1  ON 39
ci_041                 1.595752e-02 3 1  ON 40
ci_042                 1.606711e-02 3 1  ON 41
ci_043                -1.537392e-02 3 1  ON 42
ci_044                -1.524292e-02 3 1  ON 43
ci_045                -1.485790e-02 3 1  ON 44
ci_046                 1.442734e-02 3 1  ON 45
ci_047                 1.433079e-02 3 1  ON 46
ci_048                -1.429304e-02 3 1  ON 47
ci_049                -1.437438e-02 3 1  ON 48
ci_050                 1.283254e-02 3 1  ON 49
ci_051                 1.286589e-02 3 1  ON 50
ci_052                -1.203357e-02 3 1  ON 51
ci_053                -1.208776e-02 3 1  ON 52
ci_054                -1.203725e-02 3 1  ON 53
ci_055                -1.203073e-02 3 1  ON 54
ci_056                 1.203119e-02 3 1  ON 55
ci_057                 1.201193e-02 3 1  ON 56
ci_058                -1.170956e-02 3 1  ON 57
ci_059                -1.172799e-02 3 1  ON 58
ci_060                 1.141074e-02 3 1  ON 59
ci_061                 1.152863e-02 3 1  ON 60
ci_062                -1.088637e-02 3 1  ON 61
ci_063                -1.104691e-02 3 1  ON 62
ci_064                -1.043513e-02 3 1  ON 63
ci_065                -1.042945e-02 3 1  ON 64
ci_066                 1.026824e-02 3 1  ON 65
ci_067                 1.031415e-02 3 1  ON 66
ci_068                -9.652522e-03 3 1  ON 67
ci_069                -9.694743e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1693
    reference variance = 0.333786
====================================================
  Execution time = 1.3663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.4812e-01
  Total weights = 1.954441204e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412775008700
                                         uncertainty =       0.003203484005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412775008700
                                         uncertainty =       0.003203484005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000454348877
  error estimate for blocks of size 2^( 2) =       0.000466081161
  error estimate for blocks of size 2^( 3) =       0.000475763386
  error estimate for blocks of size 2^( 4) =       0.000482351978
  error estimate for blocks of size 2^( 5) =       0.000486973995
  error estimate for blocks of size 2^( 6) =       0.000489352574
  error estimate for blocks of size 2^( 7) =       0.000490481159

      target function =      -0.746733176305
              le_mean =     -17.200198096108
             les_mean =     296.294936496727
             stat err =       0.000487289927
             autocorr =       1.150259819525
   target nu stat err =       0.000487289927
   target dn stat err =       0.006919602209
      target stat err =       0.005901859574
              std dev =       0.642546343720
             le_variance =       0.412865803828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720019809611e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778975084       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.769003219677       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.774012152977       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.775551158516       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.775750907841       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.775800926742       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.775810718141       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.775812036113       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.775812053811       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.775812128420       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.775812132343       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.775812103574       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.775812130612       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.587478e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778975084       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.753208031199       residual = 3.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.754573776880       residual = 7.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.754967187378       residual = 9.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.755015947080       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.755027527793       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.755029597501       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.755029834006       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.755029830309       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.755029839023       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.755029846802       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.755029838550       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.755029843486       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.668758e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746778975084       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748449553511       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748797385272       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748895552115       residual = 9.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748907547465       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748910350633       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748910837101       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748910889568       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748910888171       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748910889816       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748910891992       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748910890003       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748910891114       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.377160e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6198e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -6.316853e-02 3 1  ON 0
ci_002                -4.896111e-02 3 1  ON 1
ci_003                -3.547229e-02 3 1  ON 2
ci_004                 3.479802e-02 3 1  ON 3
ci_005                 3.475836e-02 3 1  ON 4
ci_006                -3.347651e-02 3 1  ON 5
ci_007                -3.338591e-02 3 1  ON 6
ci_008                -2.808074e-02 3 1  ON 7
ci_009                -2.755649e-02 3 1  ON 8
ci_010                -2.611641e-02 3 1  ON 9
ci_011                -2.601230e-02 3 1  ON 10
ci_012                -2.617920e-02 3 1  ON 11
ci_013                -2.623390e-02 3 1  ON 12
ci_014                 2.472497e-02 3 1  ON 13
ci_015                 2.467672e-02 3 1  ON 14
ci_016                 2.428080e-02 3 1  ON 15
ci_017                 2.430513e-02 3 1  ON 16
ci_018                 2.295010e-02 3 1  ON 17
ci_019                 2.286982e-02 3 1  ON 18
ci_020                 2.366671e-02 3 1  ON 19
ci_021                 2.376433e-02 3 1  ON 20
ci_022                 2.029522e-02 3 1  ON 21
ci_023                 2.018218e-02 3 1  ON 22
ci_024                 2.033269e-02 3 1  ON 23
ci_025                 2.041648e-02 3 1  ON 24
ci_026                 2.022785e-02 3 1  ON 25
ci_027                 2.036697e-02 3 1  ON 26
ci_028                -2.034037e-02 3 1  ON 27
ci_029                -2.040536e-02 3 1  ON 28
ci_030                -1.863012e-02 3 1  ON 29
ci_031                -1.852883e-02 3 1  ON 30
ci_032                -1.822002e-02 3 1  ON 31
ci_033                 1.684006e-02 3 1  ON 32
ci_034                 1.666144e-02 3 1  ON 33
ci_035                -1.619566e-02 3 1  ON 34
ci_036                -1.750645e-02 3 1  ON 35
ci_037                -1.745763e-02 3 1  ON 36
ci_038                 1.527982e-02 3 1  ON 37
ci_039                 1.533264e-02 3 1  ON 38
ci_040                -1.467129e-02 3 1  ON 39
ci_041                 1.545672e-02 3 1  ON 40
ci_042                 1.553642e-02 3 1  ON 41
ci_043                -1.445703e-02 3 1  ON 42
ci_044                -1.456287e-02 3 1  ON 43
ci_045                -1.390024e-02 3 1  ON 44
ci_046                 1.377361e-02 3 1  ON 45
ci_047                 1.375395e-02 3 1  ON 46
ci_048                -1.420993e-02 3 1  ON 47
ci_049                -1.420158e-02 3 1  ON 48
ci_050                 1.202570e-02 3 1  ON 49
ci_051                 1.219282e-02 3 1  ON 50
ci_052                -1.128112e-02 3 1  ON 51
ci_053                -1.134903e-02 3 1  ON 52
ci_054                -1.136301e-02 3 1  ON 53
ci_055                -1.137978e-02 3 1  ON 54
ci_056                 1.146840e-02 3 1  ON 55
ci_057                 1.145459e-02 3 1  ON 56
ci_058                -1.100035e-02 3 1  ON 57
ci_059                -1.098723e-02 3 1  ON 58
ci_060                 1.097249e-02 3 1  ON 59
ci_061                 1.113952e-02 3 1  ON 60
ci_062                -1.040043e-02 3 1  ON 61
ci_063                -1.054132e-02 3 1  ON 62
ci_064                -9.875518e-03 3 1  ON 63
ci_065                -9.901385e-03 3 1  ON 64
ci_066                 9.857123e-03 3 1  ON 65
ci_067                 9.854068e-03 3 1  ON 66
ci_068                -9.310136e-03 3 1  ON 67
ci_069                -9.266742e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2727
    reference variance = 0.244627
====================================================
  Execution time = 1.3380e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7202e+01
  VMC Evar = 4.1227e-01
  Total weights = 1.9546e+06
  Execution time = 1.8632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412053619958
                                         uncertainty =       0.003184890899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.412053619958
                                         uncertainty =       0.003184890899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000453855443
  error estimate for blocks of size 2^( 2) =       0.000465317251
  error estimate for blocks of size 2^( 3) =       0.000475691793
  error estimate for blocks of size 2^( 4) =       0.000482647796
  error estimate for blocks of size 2^( 5) =       0.000486252130
  error estimate for blocks of size 2^( 6) =       0.000488476636
  error estimate for blocks of size 2^( 7) =       0.000488439215

      target function =      -0.436252474664
              le_mean =     -17.202213727855
             les_mean =     296.879657773030
             stat err =       0.000486453944
             autocorr =       1.148810408680
   target nu stat err =       0.000486453944
   target dn stat err =       0.389061562994
      target stat err =       0.121921491733
              std dev =       0.641848522949
             le_variance =       0.411969526412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370579434080
                                         uncertainty =       0.009725134604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.370579434080
                                         uncertainty =       0.009725134604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430409591
  error estimate for blocks of size 2^( 2) =       0.000440640855
  error estimate for blocks of size 2^( 3) =       0.000450082875
  error estimate for blocks of size 2^( 4) =       0.000456204363
  error estimate for blocks of size 2^( 5) =       0.000459972981
  error estimate for blocks of size 2^( 6) =       0.000462914671
  error estimate for blocks of size 2^( 7) =       0.000462972397

      target function =      -0.419149187116
              le_mean =     -17.202810264803
             les_mean =     296.934021332320
             stat err =       0.000460516103
             autocorr =       1.144789827273
   target nu stat err =       0.000460516103
   target dn stat err =       0.439515439046
      target stat err =       0.129262838962
              std dev =       0.608691080568
             le_variance =       0.370504831563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385500422783
                                         uncertainty =       0.012143622972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385500422783
                                         uncertainty =       0.012143622972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438997624
  error estimate for blocks of size 2^( 2) =       0.000449819520
  error estimate for blocks of size 2^( 3) =       0.000459584660
  error estimate for blocks of size 2^( 4) =       0.000466272339
  error estimate for blocks of size 2^( 5) =       0.000469734808
  error estimate for blocks of size 2^( 6) =       0.000472131667
  error estimate for blocks of size 2^( 7) =       0.000471852571

      target function =      -0.705596136885
              le_mean =     -17.202438698863
             les_mean =     296.414636330684
             stat err =       0.000469997846
             autocorr =       1.146218452446
   target nu stat err =       0.000469997846
   target dn stat err =       0.088225928142
      target stat err =       0.067735693991
              std dev =       0.620836393854
             le_variance =       0.385437827934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406039168122
                                         uncertainty =       0.003367348165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.406039168122
                                         uncertainty =       0.003367348165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000450534098
  error estimate for blocks of size 2^( 2) =       0.000461961755
  error estimate for blocks of size 2^( 3) =       0.000472254251
  error estimate for blocks of size 2^( 4) =       0.000479121115
  error estimate for blocks of size 2^( 5) =       0.000482675770
  error estimate for blocks of size 2^( 6) =       0.000484738091
  error estimate for blocks of size 2^( 7) =       0.000484537110

      target function =      -0.686781345054
              le_mean =     -17.202277106023
             les_mean =     296.439449033712
             stat err =       0.000482768022
             autocorr =       1.148210882360
   target nu stat err =       0.000482768022
   target dn stat err =       0.057938508381
      target stat err =       0.041903833571
              std dev =       0.637151431719
             le_variance =       0.405961946942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.436252474664        initial
     2.5000e-01     2.5000e+00             5.5875e-03        -0.419149187116
     1.0000e+00     1.0000e+01             1.6688e-03        -0.705596136885  <--
     4.0000e+00     4.0000e+01             4.3772e-04        -0.686781345054

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2760e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -6.316853e-02 3 1  ON 0
ci_002                -4.896111e-02 3 1  ON 1
ci_003                -3.547229e-02 3 1  ON 2
ci_004                 3.479802e-02 3 1  ON 3
ci_005                 3.475836e-02 3 1  ON 4
ci_006                -3.347651e-02 3 1  ON 5
ci_007                -3.338591e-02 3 1  ON 6
ci_008                -2.808074e-02 3 1  ON 7
ci_009                -2.755649e-02 3 1  ON 8
ci_010                -2.611641e-02 3 1  ON 9
ci_011                -2.601230e-02 3 1  ON 10
ci_012                -2.617920e-02 3 1  ON 11
ci_013                -2.623390e-02 3 1  ON 12
ci_014                 2.472497e-02 3 1  ON 13
ci_015                 2.467672e-02 3 1  ON 14
ci_016                 2.428080e-02 3 1  ON 15
ci_017                 2.430513e-02 3 1  ON 16
ci_018                 2.295010e-02 3 1  ON 17
ci_019                 2.286982e-02 3 1  ON 18
ci_020                 2.366671e-02 3 1  ON 19
ci_021                 2.376433e-02 3 1  ON 20
ci_022                 2.029522e-02 3 1  ON 21
ci_023                 2.018218e-02 3 1  ON 22
ci_024                 2.033269e-02 3 1  ON 23
ci_025                 2.041648e-02 3 1  ON 24
ci_026                 2.022785e-02 3 1  ON 25
ci_027                 2.036697e-02 3 1  ON 26
ci_028                -2.034037e-02 3 1  ON 27
ci_029                -2.040536e-02 3 1  ON 28
ci_030                -1.863012e-02 3 1  ON 29
ci_031                -1.852883e-02 3 1  ON 30
ci_032                -1.822002e-02 3 1  ON 31
ci_033                 1.684006e-02 3 1  ON 32
ci_034                 1.666144e-02 3 1  ON 33
ci_035                -1.619566e-02 3 1  ON 34
ci_036                -1.750645e-02 3 1  ON 35
ci_037                -1.745763e-02 3 1  ON 36
ci_038                 1.527982e-02 3 1  ON 37
ci_039                 1.533264e-02 3 1  ON 38
ci_040                -1.467129e-02 3 1  ON 39
ci_041                 1.545672e-02 3 1  ON 40
ci_042                 1.553642e-02 3 1  ON 41
ci_043                -1.445703e-02 3 1  ON 42
ci_044                -1.456287e-02 3 1  ON 43
ci_045                -1.390024e-02 3 1  ON 44
ci_046                 1.377361e-02 3 1  ON 45
ci_047                 1.375395e-02 3 1  ON 46
ci_048                -1.420993e-02 3 1  ON 47
ci_049                -1.420158e-02 3 1  ON 48
ci_050                 1.202570e-02 3 1  ON 49
ci_051                 1.219282e-02 3 1  ON 50
ci_052                -1.128112e-02 3 1  ON 51
ci_053                -1.134903e-02 3 1  ON 52
ci_054                -1.136301e-02 3 1  ON 53
ci_055                -1.137978e-02 3 1  ON 54
ci_056                 1.146840e-02 3 1  ON 55
ci_057                 1.145459e-02 3 1  ON 56
ci_058                -1.100035e-02 3 1  ON 57
ci_059                -1.098723e-02 3 1  ON 58
ci_060                 1.097249e-02 3 1  ON 59
ci_061                 1.113952e-02 3 1  ON 60
ci_062                -1.040043e-02 3 1  ON 61
ci_063                -1.054132e-02 3 1  ON 62
ci_064                -9.875518e-03 3 1  ON 63
ci_065                -9.901385e-03 3 1  ON 64
ci_066                 9.857123e-03 3 1  ON 65
ci_067                 9.854068e-03 3 1  ON 66
ci_068                -9.310136e-03 3 1  ON 67
ci_069                -9.266742e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8967e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.41643
====================================================
  Execution time = 1.3912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7203e+01
  VMC Evar = 4.0839e-01
  Total weights = 1.954472966e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388479063862
                                         uncertainty =       0.002386466669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388479063862
                                         uncertainty =       0.002386466669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440725625
  error estimate for blocks of size 2^( 2) =       0.000452191456
  error estimate for blocks of size 2^( 3) =       0.000461921507
  error estimate for blocks of size 2^( 4) =       0.000469397656
  error estimate for blocks of size 2^( 5) =       0.000472474062
  error estimate for blocks of size 2^( 6) =       0.000473757022
  error estimate for blocks of size 2^( 7) =       0.000476709604

      target function =      -0.782186564854
              le_mean =     -17.202938290111
             les_mean =     296.349475013925
             stat err =       0.000473084586
             autocorr =       1.152234808268
   target nu stat err =       0.000473084586
   target dn stat err =       0.003380816362
      target stat err =       0.003213168848
              std dev =       0.623280156632
             le_variance =       0.388478153651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720293829011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.782199099073       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.801947231627       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.806041620854       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.807411385012       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.807567730676       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.807601308973       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.807604246328       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.807605005394       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.807605175258       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.807605045558       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.807605065896       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.807605068551       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.807605061283       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.322778e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.782199099073       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.787962589494       residual = 2.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.789094460903       residual = 6.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.789450803452       residual = 7.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.789489502107       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.789497292837       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.789497879641       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.789498078984       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.789498038042       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.789498028362       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.789498032483       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.789498032023       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.789498030829       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.581575e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.782199099073       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.783700998078       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.783990550451       residual = 6.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.784079959882       residual = 7.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.784089520771       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.784091406417       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.784091543771       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.784091590265       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.784091582649       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.784091578377       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.784091579389       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.784091579423       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.784091579133       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.155250e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6449e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -6.164006e-02 3 1  ON 0
ci_002                -4.769229e-02 3 1  ON 1
ci_003                -3.485353e-02 3 1  ON 2
ci_004                 3.403274e-02 3 1  ON 3
ci_005                 3.396483e-02 3 1  ON 4
ci_006                -3.249691e-02 3 1  ON 5
ci_007                -3.244976e-02 3 1  ON 6
ci_008                -2.649917e-02 3 1  ON 7
ci_009                -2.661953e-02 3 1  ON 8
ci_010                -2.501793e-02 3 1  ON 9
ci_011                -2.493353e-02 3 1  ON 10
ci_012                -2.496337e-02 3 1  ON 11
ci_013                -2.583348e-02 3 1  ON 12
ci_014                 2.377647e-02 3 1  ON 13
ci_015                 2.373284e-02 3 1  ON 14
ci_016                 2.367846e-02 3 1  ON 15
ci_017                 2.366800e-02 3 1  ON 16
ci_018                 2.191736e-02 3 1  ON 17
ci_019                 2.194850e-02 3 1  ON 18
ci_020                 2.314419e-02 3 1  ON 19
ci_021                 2.325505e-02 3 1  ON 20
ci_022                 1.949143e-02 3 1  ON 21
ci_023                 1.933349e-02 3 1  ON 22
ci_024                 1.962881e-02 3 1  ON 23
ci_025                 1.972989e-02 3 1  ON 24
ci_026                 1.964736e-02 3 1  ON 25
ci_027                 1.959169e-02 3 1  ON 26
ci_028                -2.000323e-02 3 1  ON 27
ci_029                -2.001532e-02 3 1  ON 28
ci_030                -1.790963e-02 3 1  ON 29
ci_031                -1.784551e-02 3 1  ON 30
ci_032                -1.790859e-02 3 1  ON 31
ci_033                 1.607844e-02 3 1  ON 32
ci_034                 1.595193e-02 3 1  ON 33
ci_035                -1.525436e-02 3 1  ON 34
ci_036                -1.716790e-02 3 1  ON 35
ci_037                -1.706844e-02 3 1  ON 36
ci_038                 1.424778e-02 3 1  ON 37
ci_039                 1.431155e-02 3 1  ON 38
ci_040                -1.372655e-02 3 1  ON 39
ci_041                 1.493767e-02 3 1  ON 40
ci_042                 1.498943e-02 3 1  ON 41
ci_043                -1.357526e-02 3 1  ON 42
ci_044                -1.388670e-02 3 1  ON 43
ci_045                -1.300857e-02 3 1  ON 44
ci_046                 1.319111e-02 3 1  ON 45
ci_047                 1.312859e-02 3 1  ON 46
ci_048                -1.401571e-02 3 1  ON 47
ci_049                -1.404193e-02 3 1  ON 48
ci_050                 1.133467e-02 3 1  ON 49
ci_051                 1.149605e-02 3 1  ON 50
ci_052                -1.064799e-02 3 1  ON 51
ci_053                -1.066481e-02 3 1  ON 52
ci_054                -1.069062e-02 3 1  ON 53
ci_055                -1.077810e-02 3 1  ON 54
ci_056                 1.102490e-02 3 1  ON 55
ci_057                 1.095665e-02 3 1  ON 56
ci_058                -1.033520e-02 3 1  ON 57
ci_059                -1.027914e-02 3 1  ON 58
ci_060                 1.061411e-02 3 1  ON 59
ci_061                 1.077659e-02 3 1  ON 60
ci_062                -9.924274e-03 3 1  ON 61
ci_063                -1.004482e-02 3 1  ON 62
ci_064                -9.321317e-03 3 1  ON 63
ci_065                -9.419342e-03 3 1  ON 64
ci_066                 9.414097e-03 3 1  ON 65
ci_067                 9.438307e-03 3 1  ON 66
ci_068                -8.894605e-03 3 1  ON 67
ci_069                -8.968929e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2396
    reference variance = 1.26091
====================================================
  Execution time = 1.3472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7204e+01
  VMC Evar = 4.0127e-01
  Total weights = 1.9548e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394670046033
                                         uncertainty =       0.003880173006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.394670046033
                                         uncertainty =       0.003880173006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444244651
  error estimate for blocks of size 2^( 2) =       0.000455561145
  error estimate for blocks of size 2^( 3) =       0.000464895873
  error estimate for blocks of size 2^( 4) =       0.000471059512
  error estimate for blocks of size 2^( 5) =       0.000474819166
  error estimate for blocks of size 2^( 6) =       0.000476409621
  error estimate for blocks of size 2^( 7) =       0.000478166683

      target function =      -0.389799346886
              le_mean =     -17.204369755281
             les_mean =     297.034598504910
             stat err =       0.000475113746
             autocorr =       1.143801802091
   target nu stat err =       0.000475113746
   target dn stat err =       0.547837567567
      target stat err =       0.145263891994
              std dev =       0.628256810306
             le_variance =       0.394706619695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573723792589
                                         uncertainty =       0.164596233268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.573723792589
                                         uncertainty =       0.164596233268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000535260347
  error estimate for blocks of size 2^( 2) =       0.000543609563
  error estimate for blocks of size 2^( 3) =       0.000550803040
  error estimate for blocks of size 2^( 4) =       0.000555636431
  error estimate for blocks of size 2^( 5) =       0.000559697357
  error estimate for blocks of size 2^( 6) =       0.000559964800
  error estimate for blocks of size 2^( 7) =       0.000561102629

      target function =      -0.164934811842
              le_mean =     -17.204577509163
             les_mean =     298.663390022794
             stat err =       0.000559100304
             autocorr =       1.091061710943
   target nu stat err =       0.000559100304
   target dn stat err =       1.635266181093
      target stat err =       0.087245131098
              std dev =       0.756972441596
             le_variance =       0.573007277336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361859144009
                                         uncertainty =       0.002514566353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361859144009
                                         uncertainty =       0.002514566353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425389168
  error estimate for blocks of size 2^( 2) =       0.000436113821
  error estimate for blocks of size 2^( 3) =       0.000445071395
  error estimate for blocks of size 2^( 4) =       0.000451129461
  error estimate for blocks of size 2^( 5) =       0.000454911321
  error estimate for blocks of size 2^( 6) =       0.000456472539
  error estimate for blocks of size 2^( 7) =       0.000458151879

      target function =      -0.796091160336
              le_mean =     -17.204483511757
             les_mean =     296.388052512425
             stat err =       0.000455166300
             autocorr =       1.144899448218
   target nu stat err =       0.000455166300
   target dn stat err =       0.008007958049
      target stat err =       0.007799442082
              std dev =       0.601591130774
             le_variance =       0.361911888626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389242304714
                                         uncertainty =       0.003220292328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389242304714
                                         uncertainty =       0.003220292328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441182103
  error estimate for blocks of size 2^( 2) =       0.000452406822
  error estimate for blocks of size 2^( 3) =       0.000461664046
  error estimate for blocks of size 2^( 4) =       0.000467827569
  error estimate for blocks of size 2^( 5) =       0.000471597677
  error estimate for blocks of size 2^( 6) =       0.000473161170
  error estimate for blocks of size 2^( 7) =       0.000474888795

      target function =      -0.708939545396
              le_mean =     -17.204350520299
             les_mean =     296.481180657056
             stat err =       0.000471868803
             autocorr =       1.143949250195
   target nu stat err =       0.000471868803
   target dn stat err =       0.053640946592
      target stat err =       0.041458353223
              std dev =       0.623925713174
             le_variance =       0.389283295560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.389799346886        initial
     2.5000e-01     2.5000e+00             5.3228e-03        -0.164934811842
     1.0000e+00     1.0000e+01             1.5816e-03        -0.796091160336  <--
     4.0000e+00     4.0000e+01             4.1552e-04        -0.708939545396

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2869e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -6.164006e-02 3 1  ON 0
ci_002                -4.769229e-02 3 1  ON 1
ci_003                -3.485353e-02 3 1  ON 2
ci_004                 3.403274e-02 3 1  ON 3
ci_005                 3.396483e-02 3 1  ON 4
ci_006                -3.249691e-02 3 1  ON 5
ci_007                -3.244976e-02 3 1  ON 6
ci_008                -2.649917e-02 3 1  ON 7
ci_009                -2.661953e-02 3 1  ON 8
ci_010                -2.501793e-02 3 1  ON 9
ci_011                -2.493353e-02 3 1  ON 10
ci_012                -2.496337e-02 3 1  ON 11
ci_013                -2.583348e-02 3 1  ON 12
ci_014                 2.377647e-02 3 1  ON 13
ci_015                 2.373284e-02 3 1  ON 14
ci_016                 2.367846e-02 3 1  ON 15
ci_017                 2.366800e-02 3 1  ON 16
ci_018                 2.191736e-02 3 1  ON 17
ci_019                 2.194850e-02 3 1  ON 18
ci_020                 2.314419e-02 3 1  ON 19
ci_021                 2.325505e-02 3 1  ON 20
ci_022                 1.949143e-02 3 1  ON 21
ci_023                 1.933349e-02 3 1  ON 22
ci_024                 1.962881e-02 3 1  ON 23
ci_025                 1.972989e-02 3 1  ON 24
ci_026                 1.964736e-02 3 1  ON 25
ci_027                 1.959169e-02 3 1  ON 26
ci_028                -2.000323e-02 3 1  ON 27
ci_029                -2.001532e-02 3 1  ON 28
ci_030                -1.790963e-02 3 1  ON 29
ci_031                -1.784551e-02 3 1  ON 30
ci_032                -1.790859e-02 3 1  ON 31
ci_033                 1.607844e-02 3 1  ON 32
ci_034                 1.595193e-02 3 1  ON 33
ci_035                -1.525436e-02 3 1  ON 34
ci_036                -1.716790e-02 3 1  ON 35
ci_037                -1.706844e-02 3 1  ON 36
ci_038                 1.424778e-02 3 1  ON 37
ci_039                 1.431155e-02 3 1  ON 38
ci_040                -1.372655e-02 3 1  ON 39
ci_041                 1.493767e-02 3 1  ON 40
ci_042                 1.498943e-02 3 1  ON 41
ci_043                -1.357526e-02 3 1  ON 42
ci_044                -1.388670e-02 3 1  ON 43
ci_045                -1.300857e-02 3 1  ON 44
ci_046                 1.319111e-02 3 1  ON 45
ci_047                 1.312859e-02 3 1  ON 46
ci_048                -1.401571e-02 3 1  ON 47
ci_049                -1.404193e-02 3 1  ON 48
ci_050                 1.133467e-02 3 1  ON 49
ci_051                 1.149605e-02 3 1  ON 50
ci_052                -1.064799e-02 3 1  ON 51
ci_053                -1.066481e-02 3 1  ON 52
ci_054                -1.069062e-02 3 1  ON 53
ci_055                -1.077810e-02 3 1  ON 54
ci_056                 1.102490e-02 3 1  ON 55
ci_057                 1.095665e-02 3 1  ON 56
ci_058                -1.033520e-02 3 1  ON 57
ci_059                -1.027914e-02 3 1  ON 58
ci_060                 1.061411e-02 3 1  ON 59
ci_061                 1.077659e-02 3 1  ON 60
ci_062                -9.924274e-03 3 1  ON 61
ci_063                -1.004482e-02 3 1  ON 62
ci_064                -9.321317e-03 3 1  ON 63
ci_065                -9.419342e-03 3 1  ON 64
ci_066                 9.414097e-03 3 1  ON 65
ci_067                 9.438307e-03 3 1  ON 66
ci_068                -8.894605e-03 3 1  ON 67
ci_069                -8.968929e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7236e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1488
    reference variance = 0.274767
====================================================
  Execution time = 1.4055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7205e+01
  VMC Evar = 3.9880e-01
  Total weights = 1.954669231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378333260531
                                         uncertainty =       0.002507000565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378333260531
                                         uncertainty =       0.002507000565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000434944605
  error estimate for blocks of size 2^( 2) =       0.000446218957
  error estimate for blocks of size 2^( 3) =       0.000455844347
  error estimate for blocks of size 2^( 4) =       0.000462502047
  error estimate for blocks of size 2^( 5) =       0.000466593543
  error estimate for blocks of size 2^( 6) =       0.000469261177
  error estimate for blocks of size 2^( 7) =       0.000473600378

      target function =      -0.791354365349
              le_mean =     -17.205291401961
             les_mean =     296.420852339858
             stat err =       0.000467989286
             autocorr =       1.157721035657
   target nu stat err =       0.000467989286
   target dn stat err =       0.003580100660
      target stat err =       0.003487385242
              std dev =       0.615104559619
             le_variance =       0.378353619264


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720529140196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.791369010114       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.808900443843       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.812226524550       residual = 7.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.813392053631       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.813576494573       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.813623595063       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.813635291022       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.813638833601       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.813639124776       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.813639131355       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.813639129759       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.813639112879       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.813639116219       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.996024e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.791369010114       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.796499393697       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.797428565360       residual = 6.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.797734170029       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.797780452837       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.797791662572       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.797794322324       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.797795134980       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.797795180191       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.797795178303       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.797795177015       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.797795172222       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.797795172977       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.437096e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.791369010114       residual = 1.30e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.792707224447       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.792945770547       residual = 6.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.793022650504       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.793034136191       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.793036870797       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.793037510791       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.793037707063       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.793037716381       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.793037715698       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.793037715315       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.793037714098       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.793037714276       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.728254e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6580e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -6.020296e-02 3 1  ON 0
ci_002                -4.650403e-02 3 1  ON 1
ci_003                -3.433179e-02 3 1  ON 2
ci_004                 3.329735e-02 3 1  ON 3
ci_005                 3.315641e-02 3 1  ON 4
ci_006                -3.163434e-02 3 1  ON 5
ci_007                -3.156132e-02 3 1  ON 6
ci_008                -2.516542e-02 3 1  ON 7
ci_009                -2.568416e-02 3 1  ON 8
ci_010                -2.387180e-02 3 1  ON 9
ci_011                -2.383846e-02 3 1  ON 10
ci_012                -2.393612e-02 3 1  ON 11
ci_013                -2.543943e-02 3 1  ON 12
ci_014                 2.292961e-02 3 1  ON 13
ci_015                 2.289520e-02 3 1  ON 14
ci_016                 2.307883e-02 3 1  ON 15
ci_017                 2.311032e-02 3 1  ON 16
ci_018                 2.104076e-02 3 1  ON 17
ci_019                 2.105076e-02 3 1  ON 18
ci_020                 2.272631e-02 3 1  ON 19
ci_021                 2.278130e-02 3 1  ON 20
ci_022                 1.874240e-02 3 1  ON 21
ci_023                 1.854472e-02 3 1  ON 22
ci_024                 1.897861e-02 3 1  ON 23
ci_025                 1.912159e-02 3 1  ON 24
ci_026                 1.899042e-02 3 1  ON 25
ci_027                 1.893246e-02 3 1  ON 26
ci_028                -1.960359e-02 3 1  ON 27
ci_029                -1.962454e-02 3 1  ON 28
ci_030                -1.722826e-02 3 1  ON 29
ci_031                -1.717010e-02 3 1  ON 30
ci_032                -1.768230e-02 3 1  ON 31
ci_033                 1.535350e-02 3 1  ON 32
ci_034                 1.525654e-02 3 1  ON 33
ci_035                -1.438092e-02 3 1  ON 34
ci_036                -1.680031e-02 3 1  ON 35
ci_037                -1.671137e-02 3 1  ON 36
ci_038                 1.325961e-02 3 1  ON 37
ci_039                 1.333141e-02 3 1  ON 38
ci_040                -1.284211e-02 3 1  ON 39
ci_041                 1.447135e-02 3 1  ON 40
ci_042                 1.456403e-02 3 1  ON 41
ci_043                -1.277629e-02 3 1  ON 42
ci_044                -1.312210e-02 3 1  ON 43
ci_045                -1.220160e-02 3 1  ON 44
ci_046                 1.268355e-02 3 1  ON 45
ci_047                 1.258952e-02 3 1  ON 46
ci_048                -1.386248e-02 3 1  ON 47
ci_049                -1.392941e-02 3 1  ON 48
ci_050                 1.071367e-02 3 1  ON 49
ci_051                 1.087417e-02 3 1  ON 50
ci_052                -1.009544e-02 3 1  ON 51
ci_053                -1.005842e-02 3 1  ON 52
ci_054                -1.013967e-02 3 1  ON 53
ci_055                -1.023782e-02 3 1  ON 54
ci_056                 1.051399e-02 3 1  ON 55
ci_057                 1.055138e-02 3 1  ON 56
ci_058                -9.681421e-03 3 1  ON 57
ci_059                -9.709361e-03 3 1  ON 58
ci_060                 1.036135e-02 3 1  ON 59
ci_061                 1.048918e-02 3 1  ON 60
ci_062                -9.514875e-03 3 1  ON 61
ci_063                -9.598575e-03 3 1  ON 62
ci_064                -8.768918e-03 3 1  ON 63
ci_065                -8.971405e-03 3 1  ON 64
ci_066                 9.064866e-03 3 1  ON 65
ci_067                 9.094229e-03 3 1  ON 66
ci_068                -8.649755e-03 3 1  ON 67
ci_069                -8.647050e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2831
    reference variance = 0.364041
====================================================
  Execution time = 1.3288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.9350e-01
  Total weights = 1.9546e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389813957545
                                         uncertainty =       0.003903439589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389813957545
                                         uncertainty =       0.003903439589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441457192
  error estimate for blocks of size 2^( 2) =       0.000452324290
  error estimate for blocks of size 2^( 3) =       0.000461520684
  error estimate for blocks of size 2^( 4) =       0.000467907776
  error estimate for blocks of size 2^( 5) =       0.000471602628
  error estimate for blocks of size 2^( 6) =       0.000473338845
  error estimate for blocks of size 2^( 7) =       0.000474859703

      target function =      -0.739834252774
              le_mean =     -17.206939959891
             les_mean =     296.533542855359
             stat err =       0.000471927238
             autocorr =       1.142807007339
   target nu stat err =       0.000471927238
   target dn stat err =       0.033943867588
      target stat err =       0.028632922324
              std dev =       0.624314748464
             le_variance =       0.389768905150

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0495539
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347008589013
                                         uncertainty =       0.003070538439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347008589013
                                         uncertainty =       0.003070538439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416521256
  error estimate for blocks of size 2^( 2) =       0.000426864107
  error estimate for blocks of size 2^( 3) =       0.000435640056
  error estimate for blocks of size 2^( 4) =       0.000441712594
  error estimate for blocks of size 2^( 5) =       0.000445473246
  error estimate for blocks of size 2^( 6) =       0.000447520771
  error estimate for blocks of size 2^( 7) =       0.000449173531

      target function =      -0.789518139931
              le_mean =     -17.207423850344
             les_mean =     296.495579661068
             stat err =       0.000445970035
             autocorr =       1.146402227850
   target nu stat err =       0.000445970035
   target dn stat err =       0.023299388990
      target stat err =       0.022386048122
              std dev =       0.589050008767
             le_variance =       0.346979912828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360836535943
                                         uncertainty =       0.002957716002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360836535943
                                         uncertainty =       0.002957716002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424738298
  error estimate for blocks of size 2^( 2) =       0.000435281825
  error estimate for blocks of size 2^( 3) =       0.000444197992
  error estimate for blocks of size 2^( 4) =       0.000450388345
  error estimate for blocks of size 2^( 5) =       0.000454096938
  error estimate for blocks of size 2^( 6) =       0.000456066322
  error estimate for blocks of size 2^( 7) =       0.000457635862

      target function =      -0.790722571422
              le_mean =     -17.206968046199
             les_mean =     296.479010931587
             stat err =       0.000454546867
             autocorr =       1.145287422281
   target nu stat err =       0.000454546867
   target dn stat err =       0.014998855594
      target stat err =       0.014444335000
              std dev =       0.600670662123
             le_variance =       0.360805244336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385039610487
                                         uncertainty =       0.003668430620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385039610487
                                         uncertainty =       0.003668430620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000438746889
  error estimate for blocks of size 2^( 2) =       0.000449581393
  error estimate for blocks of size 2^( 3) =       0.000458731036
  error estimate for blocks of size 2^( 4) =       0.000465064820
  error estimate for blocks of size 2^( 5) =       0.000468742596
  error estimate for blocks of size 2^( 6) =       0.000470505671
  error estimate for blocks of size 2^( 7) =       0.000472020013

      target function =      -0.760347104463
              le_mean =     -17.206890587496
             les_mean =     296.509004971441
             stat err =       0.000469083275
             autocorr =       1.143067287044
   target nu stat err =       0.000469083275
   target dn stat err =       0.019653277322
      target stat err =       0.017497590981
              std dev =       0.620481801575
             le_variance =       0.384997666086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739834252774        initial
     2.5000e-01     2.5000e+00             4.9960e-03        -0.789518139931
     1.0000e+00     1.0000e+01             1.4371e-03        -0.790722571422  <--
     4.0000e+00     4.0000e+01             3.7283e-04        -0.760347104463

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2607e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -6.020296e-02 3 1  ON 0
ci_002                -4.650403e-02 3 1  ON 1
ci_003                -3.433179e-02 3 1  ON 2
ci_004                 3.329735e-02 3 1  ON 3
ci_005                 3.315641e-02 3 1  ON 4
ci_006                -3.163434e-02 3 1  ON 5
ci_007                -3.156132e-02 3 1  ON 6
ci_008                -2.516542e-02 3 1  ON 7
ci_009                -2.568416e-02 3 1  ON 8
ci_010                -2.387180e-02 3 1  ON 9
ci_011                -2.383846e-02 3 1  ON 10
ci_012                -2.393612e-02 3 1  ON 11
ci_013                -2.543943e-02 3 1  ON 12
ci_014                 2.292961e-02 3 1  ON 13
ci_015                 2.289520e-02 3 1  ON 14
ci_016                 2.307883e-02 3 1  ON 15
ci_017                 2.311032e-02 3 1  ON 16
ci_018                 2.104076e-02 3 1  ON 17
ci_019                 2.105076e-02 3 1  ON 18
ci_020                 2.272631e-02 3 1  ON 19
ci_021                 2.278130e-02 3 1  ON 20
ci_022                 1.874240e-02 3 1  ON 21
ci_023                 1.854472e-02 3 1  ON 22
ci_024                 1.897861e-02 3 1  ON 23
ci_025                 1.912159e-02 3 1  ON 24
ci_026                 1.899042e-02 3 1  ON 25
ci_027                 1.893246e-02 3 1  ON 26
ci_028                -1.960359e-02 3 1  ON 27
ci_029                -1.962454e-02 3 1  ON 28
ci_030                -1.722826e-02 3 1  ON 29
ci_031                -1.717010e-02 3 1  ON 30
ci_032                -1.768230e-02 3 1  ON 31
ci_033                 1.535350e-02 3 1  ON 32
ci_034                 1.525654e-02 3 1  ON 33
ci_035                -1.438092e-02 3 1  ON 34
ci_036                -1.680031e-02 3 1  ON 35
ci_037                -1.671137e-02 3 1  ON 36
ci_038                 1.325961e-02 3 1  ON 37
ci_039                 1.333141e-02 3 1  ON 38
ci_040                -1.284211e-02 3 1  ON 39
ci_041                 1.447135e-02 3 1  ON 40
ci_042                 1.456403e-02 3 1  ON 41
ci_043                -1.277629e-02 3 1  ON 42
ci_044                -1.312210e-02 3 1  ON 43
ci_045                -1.220160e-02 3 1  ON 44
ci_046                 1.268355e-02 3 1  ON 45
ci_047                 1.258952e-02 3 1  ON 46
ci_048                -1.386248e-02 3 1  ON 47
ci_049                -1.392941e-02 3 1  ON 48
ci_050                 1.071367e-02 3 1  ON 49
ci_051                 1.087417e-02 3 1  ON 50
ci_052                -1.009544e-02 3 1  ON 51
ci_053                -1.005842e-02 3 1  ON 52
ci_054                -1.013967e-02 3 1  ON 53
ci_055                -1.023782e-02 3 1  ON 54
ci_056                 1.051399e-02 3 1  ON 55
ci_057                 1.055138e-02 3 1  ON 56
ci_058                -9.681421e-03 3 1  ON 57
ci_059                -9.709361e-03 3 1  ON 58
ci_060                 1.036135e-02 3 1  ON 59
ci_061                 1.048918e-02 3 1  ON 60
ci_062                -9.514875e-03 3 1  ON 61
ci_063                -9.598575e-03 3 1  ON 62
ci_064                -8.768918e-03 3 1  ON 63
ci_065                -8.971405e-03 3 1  ON 64
ci_066                 9.064866e-03 3 1  ON 65
ci_067                 9.094229e-03 3 1  ON 66
ci_068                -8.649755e-03 3 1  ON 67
ci_069                -8.647050e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1804
    reference variance = 0.197122
====================================================
  Execution time = 1.3871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7206e+01
  VMC Evar = 3.8393e-01
  Total weights = 1.955185688e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365012806539
                                         uncertainty =       0.002271494737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.365012806539
                                         uncertainty =       0.002271494737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427206790
  error estimate for blocks of size 2^( 2) =       0.000438580964
  error estimate for blocks of size 2^( 3) =       0.000448318338
  error estimate for blocks of size 2^( 4) =       0.000455532932
  error estimate for blocks of size 2^( 5) =       0.000459583807
  error estimate for blocks of size 2^( 6) =       0.000459638147
  error estimate for blocks of size 2^( 7) =       0.000461764291

      target function =      -0.805977382344
              le_mean =     -17.206387757653
             les_mean =     296.443707544954
             stat err =       0.000459129794
             autocorr =       1.155033707916
   target nu stat err =       0.000459129794
   target dn stat err =       0.003558688222
      target stat err =       0.003598970498
              std dev =       0.604161636838
             le_variance =       0.365011283427


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720638775765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.805992727348       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.822330649872       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825433030019       residual = 5.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826320647695       residual = 7.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826424972548       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826453535949       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826459025953       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826460794807       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826460545335       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826460640382       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826460582794       residual = 8.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826460564936       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.826460567700       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.555611e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.805992727348       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.810799032142       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.811664780787       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.811897876130       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.811924107607       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.811931323019       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.811932586404       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.811932986743       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.811932922504       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.811932943365       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.811932930394       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.811932926367       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.313086e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.805992727348       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.807248531355       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.807470732205       residual = 4.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.807529412612       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.807535931946       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.807537727734       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.807538032618       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.807538128941       residual = 9.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.807538112974       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.807538117951       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.807538114844       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.807538113878       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.408948e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6426e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.888987e-02 3 1  ON 0
ci_002                -4.541503e-02 3 1  ON 1
ci_003                -3.368797e-02 3 1  ON 2
ci_004                 3.258824e-02 3 1  ON 3
ci_005                 3.248821e-02 3 1  ON 4
ci_006                -3.077528e-02 3 1  ON 5
ci_007                -3.070663e-02 3 1  ON 6
ci_008                -2.390209e-02 3 1  ON 7
ci_009                -2.477804e-02 3 1  ON 8
ci_010                -2.292196e-02 3 1  ON 9
ci_011                -2.280530e-02 3 1  ON 10
ci_012                -2.297757e-02 3 1  ON 11
ci_013                -2.507810e-02 3 1  ON 12
ci_014                 2.213685e-02 3 1  ON 13
ci_015                 2.204151e-02 3 1  ON 14
ci_016                 2.261008e-02 3 1  ON 15
ci_017                 2.263527e-02 3 1  ON 16
ci_018                 2.023629e-02 3 1  ON 17
ci_019                 2.019007e-02 3 1  ON 18
ci_020                 2.230856e-02 3 1  ON 19
ci_021                 2.221941e-02 3 1  ON 20
ci_022                 1.801184e-02 3 1  ON 21
ci_023                 1.783436e-02 3 1  ON 22
ci_024                 1.840174e-02 3 1  ON 23
ci_025                 1.848635e-02 3 1  ON 24
ci_026                 1.839368e-02 3 1  ON 25
ci_027                 1.831162e-02 3 1  ON 26
ci_028                -1.921931e-02 3 1  ON 27
ci_029                -1.929081e-02 3 1  ON 28
ci_030                -1.666476e-02 3 1  ON 29
ci_031                -1.657280e-02 3 1  ON 30
ci_032                -1.750937e-02 3 1  ON 31
ci_033                 1.466168e-02 3 1  ON 32
ci_034                 1.462528e-02 3 1  ON 33
ci_035                -1.363605e-02 3 1  ON 34
ci_036                -1.654647e-02 3 1  ON 35
ci_037                -1.640218e-02 3 1  ON 36
ci_038                 1.234429e-02 3 1  ON 37
ci_039                 1.248848e-02 3 1  ON 38
ci_040                -1.203353e-02 3 1  ON 39
ci_041                 1.403788e-02 3 1  ON 40
ci_042                 1.400559e-02 3 1  ON 41
ci_043                -1.202787e-02 3 1  ON 42
ci_044                -1.248986e-02 3 1  ON 43
ci_045                -1.142604e-02 3 1  ON 44
ci_046                 1.217589e-02 3 1  ON 45
ci_047                 1.207526e-02 3 1  ON 46
ci_048                -1.376468e-02 3 1  ON 47
ci_049                -1.375039e-02 3 1  ON 48
ci_050                 1.015974e-02 3 1  ON 49
ci_051                 1.028637e-02 3 1  ON 50
ci_052                -9.485069e-03 3 1  ON 51
ci_053                -9.474874e-03 3 1  ON 52
ci_054                -9.659808e-03 3 1  ON 53
ci_055                -9.748420e-03 3 1  ON 54
ci_056                 1.014144e-02 3 1  ON 55
ci_057                 1.018022e-02 3 1  ON 56
ci_058                -9.110604e-03 3 1  ON 57
ci_059                -9.003674e-03 3 1  ON 58
ci_060                 1.006028e-02 3 1  ON 59
ci_061                 1.012379e-02 3 1  ON 60
ci_062                -9.065861e-03 3 1  ON 61
ci_063                -9.171158e-03 3 1  ON 62
ci_064                -8.289139e-03 3 1  ON 63
ci_065                -8.574807e-03 3 1  ON 64
ci_066                 8.727472e-03 3 1  ON 65
ci_067                 8.731773e-03 3 1  ON 66
ci_068                -8.359568e-03 3 1  ON 67
ci_069                -8.298549e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1675
    reference variance = 0.306188
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.7689e-01
  Total weights = 1.9547e+06
  Execution time = 1.8559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369158843797
                                         uncertainty =       0.003052566961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.369158843797
                                         uncertainty =       0.003052566961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000429734018
  error estimate for blocks of size 2^( 2) =       0.000440657978
  error estimate for blocks of size 2^( 3) =       0.000449883821
  error estimate for blocks of size 2^( 4) =       0.000456059808
  error estimate for blocks of size 2^( 5) =       0.000460082942
  error estimate for blocks of size 2^( 6) =       0.000460166399
  error estimate for blocks of size 2^( 7) =       0.000461494731

      target function =      -0.656244052692
              le_mean =     -17.208272889670
             les_mean =     296.674560320924
             stat err =       0.000459450970
             autocorr =       1.143085926487
   target nu stat err =       0.000459450970
   target dn stat err =       0.131418355923
      target stat err =       0.088853369137
              std dev =       0.607735676434
             le_variance =       0.369342652411

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.252418
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343607888782
                                         uncertainty =       0.006179641457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343607888782
                                         uncertainty =       0.006179641457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414570429
  error estimate for blocks of size 2^( 2) =       0.000424739126
  error estimate for blocks of size 2^( 3) =       0.000433523818
  error estimate for blocks of size 2^( 4) =       0.000439512062
  error estimate for blocks of size 2^( 5) =       0.000442956455
  error estimate for blocks of size 2^( 6) =       0.000442759265
  error estimate for blocks of size 2^( 7) =       0.000444132521

      target function =      -0.506641362994
              le_mean =     -17.208824958296
             les_mean =     296.944097102653
             stat err =       0.000442340076
             autocorr =       1.138455169062
   target nu stat err =       0.000442340076
   target dn stat err =       0.267777693382
      target stat err =       0.111162228424
              std dev =       0.586291123839
             le_variance =       0.343737281892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344914555274
                                         uncertainty =       0.002532252579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344914555274
                                         uncertainty =       0.002532252579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415389519
  error estimate for blocks of size 2^( 2) =       0.000425881120
  error estimate for blocks of size 2^( 3) =       0.000434933187
  error estimate for blocks of size 2^( 4) =       0.000440925439
  error estimate for blocks of size 2^( 5) =       0.000444818547
  error estimate for blocks of size 2^( 6) =       0.000444972266
  error estimate for blocks of size 2^( 7) =       0.000446286199

      target function =      -0.775502954266
              le_mean =     -17.208389632081
             les_mean =     296.542614126254
             stat err =       0.000444250613
             autocorr =       1.143786595125
   target nu stat err =       0.000444250613
   target dn stat err =       0.038094397360
      target stat err =       0.035404615028
              std dev =       0.587449491308
             le_variance =       0.345096904838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366773520324
                                         uncertainty =       0.004382678669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366773520324
                                         uncertainty =       0.004382678669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428344473
  error estimate for blocks of size 2^( 2) =       0.000439157079
  error estimate for blocks of size 2^( 3) =       0.000448371780
  error estimate for blocks of size 2^( 4) =       0.000454586755
  error estimate for blocks of size 2^( 5) =       0.000458697512
  error estimate for blocks of size 2^( 6) =       0.000458980525
  error estimate for blocks of size 2^( 7) =       0.000460373019

      target function =      -0.754676938251
              le_mean =     -17.208252878988
             les_mean =     296.561714362199
             stat err =       0.000458159453
             autocorr =       1.144055166472
   target nu stat err =       0.000458159453
   target dn stat err =       0.029512212538
      target stat err =       0.025948672836
              std dev =       0.605770563649
             le_variance =       0.366957975783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.656244052692        initial
     2.5000e-01     2.5000e+00             4.5556e-03        -0.506641362994
     1.0000e+00     1.0000e+01             1.3131e-03        -0.775502954266  <--
     4.0000e+00     4.0000e+01             3.4089e-04        -0.754676938251

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2969e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.888987e-02 3 1  ON 0
ci_002                -4.541503e-02 3 1  ON 1
ci_003                -3.368797e-02 3 1  ON 2
ci_004                 3.258824e-02 3 1  ON 3
ci_005                 3.248821e-02 3 1  ON 4
ci_006                -3.077528e-02 3 1  ON 5
ci_007                -3.070663e-02 3 1  ON 6
ci_008                -2.390209e-02 3 1  ON 7
ci_009                -2.477804e-02 3 1  ON 8
ci_010                -2.292196e-02 3 1  ON 9
ci_011                -2.280530e-02 3 1  ON 10
ci_012                -2.297757e-02 3 1  ON 11
ci_013                -2.507810e-02 3 1  ON 12
ci_014                 2.213685e-02 3 1  ON 13
ci_015                 2.204151e-02 3 1  ON 14
ci_016                 2.261008e-02 3 1  ON 15
ci_017                 2.263527e-02 3 1  ON 16
ci_018                 2.023629e-02 3 1  ON 17
ci_019                 2.019007e-02 3 1  ON 18
ci_020                 2.230856e-02 3 1  ON 19
ci_021                 2.221941e-02 3 1  ON 20
ci_022                 1.801184e-02 3 1  ON 21
ci_023                 1.783436e-02 3 1  ON 22
ci_024                 1.840174e-02 3 1  ON 23
ci_025                 1.848635e-02 3 1  ON 24
ci_026                 1.839368e-02 3 1  ON 25
ci_027                 1.831162e-02 3 1  ON 26
ci_028                -1.921931e-02 3 1  ON 27
ci_029                -1.929081e-02 3 1  ON 28
ci_030                -1.666476e-02 3 1  ON 29
ci_031                -1.657280e-02 3 1  ON 30
ci_032                -1.750937e-02 3 1  ON 31
ci_033                 1.466168e-02 3 1  ON 32
ci_034                 1.462528e-02 3 1  ON 33
ci_035                -1.363605e-02 3 1  ON 34
ci_036                -1.654647e-02 3 1  ON 35
ci_037                -1.640218e-02 3 1  ON 36
ci_038                 1.234429e-02 3 1  ON 37
ci_039                 1.248848e-02 3 1  ON 38
ci_040                -1.203353e-02 3 1  ON 39
ci_041                 1.403788e-02 3 1  ON 40
ci_042                 1.400559e-02 3 1  ON 41
ci_043                -1.202787e-02 3 1  ON 42
ci_044                -1.248986e-02 3 1  ON 43
ci_045                -1.142604e-02 3 1  ON 44
ci_046                 1.217589e-02 3 1  ON 45
ci_047                 1.207526e-02 3 1  ON 46
ci_048                -1.376468e-02 3 1  ON 47
ci_049                -1.375039e-02 3 1  ON 48
ci_050                 1.015974e-02 3 1  ON 49
ci_051                 1.028637e-02 3 1  ON 50
ci_052                -9.485069e-03 3 1  ON 51
ci_053                -9.474874e-03 3 1  ON 52
ci_054                -9.659808e-03 3 1  ON 53
ci_055                -9.748420e-03 3 1  ON 54
ci_056                 1.014144e-02 3 1  ON 55
ci_057                 1.018022e-02 3 1  ON 56
ci_058                -9.110604e-03 3 1  ON 57
ci_059                -9.003674e-03 3 1  ON 58
ci_060                 1.006028e-02 3 1  ON 59
ci_061                 1.012379e-02 3 1  ON 60
ci_062                -9.065861e-03 3 1  ON 61
ci_063                -9.171158e-03 3 1  ON 62
ci_064                -8.289139e-03 3 1  ON 63
ci_065                -8.574807e-03 3 1  ON 64
ci_066                 8.727472e-03 3 1  ON 65
ci_067                 8.731773e-03 3 1  ON 66
ci_068                -8.359568e-03 3 1  ON 67
ci_069                -8.298549e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.140693
====================================================
  Execution time = 1.3948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.7208e+01
  VMC Evar = 3.7110e-01
  Total weights = 1.954827885e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5128e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352176589777
                                         uncertainty =       0.002157259425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352176589777
                                         uncertainty =       0.002157259425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419585679
  error estimate for blocks of size 2^( 2) =       0.000430496982
  error estimate for blocks of size 2^( 3) =       0.000439020202
  error estimate for blocks of size 2^( 4) =       0.000445140724
  error estimate for blocks of size 2^( 5) =       0.000449404792
  error estimate for blocks of size 2^( 6) =       0.000451636153
  error estimate for blocks of size 2^( 7) =       0.000453238942

      target function =      -0.819150215500
              le_mean =     -17.208310031939
             les_mean =     296.497037281937
             stat err =       0.000449855153
             autocorr =       1.149487055629
   target nu stat err =       0.000449855153
   target dn stat err =       0.003038136203
      target stat err =       0.003194094547
              std dev =       0.593383758152
             le_variance =       0.352104284439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720831003194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819161981467       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.833389379883       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.836255830507       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.837064876330       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.837161020765       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.837190490890       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.837194380729       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.837195115586       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.837195223635       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.837195222077       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.837195205336       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.837195169461       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.837195164798       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.394966e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819161981467       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.823367777665       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.824174373964       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.824388082695       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.824412344587       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.824419481226       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.824420354158       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824420493800       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.824420525724       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.824420522058       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.824420518812       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.824420510584       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.824420509549       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.269947e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.819161981467       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.820262682944       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.820470285100       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.820524186375       residual = 5.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.820530220568       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.820531973065       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.820532183746       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.820532215155       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.820532223381       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.820532222291       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.820532221542       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.820532219561       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.300097e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6472e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.761993e-02 3 1  ON 0
ci_002                -4.432868e-02 3 1  ON 1
ci_003                -3.309839e-02 3 1  ON 2
ci_004                 3.187600e-02 3 1  ON 3
ci_005                 3.182844e-02 3 1  ON 4
ci_006                -2.996823e-02 3 1  ON 5
ci_007                -2.999514e-02 3 1  ON 6
ci_008                -2.272675e-02 3 1  ON 7
ci_009                -2.408846e-02 3 1  ON 8
ci_010                -2.195931e-02 3 1  ON 9
ci_011                -2.190375e-02 3 1  ON 10
ci_012                -2.201054e-02 3 1  ON 11
ci_013                -2.473604e-02 3 1  ON 12
ci_014                 2.143496e-02 3 1  ON 13
ci_015                 2.126465e-02 3 1  ON 14
ci_016                 2.215872e-02 3 1  ON 15
ci_017                 2.218319e-02 3 1  ON 16
ci_018                 1.954220e-02 3 1  ON 17
ci_019                 1.938323e-02 3 1  ON 18
ci_020                 2.185189e-02 3 1  ON 19
ci_021                 2.174473e-02 3 1  ON 20
ci_022                 1.734733e-02 3 1  ON 21
ci_023                 1.713408e-02 3 1  ON 22
ci_024                 1.780884e-02 3 1  ON 23
ci_025                 1.792385e-02 3 1  ON 24
ci_026                 1.779983e-02 3 1  ON 25
ci_027                 1.777274e-02 3 1  ON 26
ci_028                -1.894705e-02 3 1  ON 27
ci_029                -1.907232e-02 3 1  ON 28
ci_030                -1.609484e-02 3 1  ON 29
ci_031                -1.600446e-02 3 1  ON 30
ci_032                -1.734703e-02 3 1  ON 31
ci_033                 1.408789e-02 3 1  ON 32
ci_034                 1.402405e-02 3 1  ON 33
ci_035                -1.291724e-02 3 1  ON 34
ci_036                -1.628023e-02 3 1  ON 35
ci_037                -1.612237e-02 3 1  ON 36
ci_038                 1.150460e-02 3 1  ON 37
ci_039                 1.168343e-02 3 1  ON 38
ci_040                -1.130528e-02 3 1  ON 39
ci_041                 1.359791e-02 3 1  ON 40
ci_042                 1.364985e-02 3 1  ON 41
ci_043                -1.135515e-02 3 1  ON 42
ci_044                -1.194089e-02 3 1  ON 43
ci_045                -1.069128e-02 3 1  ON 44
ci_046                 1.163433e-02 3 1  ON 45
ci_047                 1.156390e-02 3 1  ON 46
ci_048                -1.363377e-02 3 1  ON 47
ci_049                -1.364805e-02 3 1  ON 48
ci_050                 9.643585e-03 3 1  ON 49
ci_051                 9.787344e-03 3 1  ON 50
ci_052                -8.920857e-03 3 1  ON 51
ci_053                -8.961307e-03 3 1  ON 52
ci_054                -9.154922e-03 3 1  ON 53
ci_055                -9.285931e-03 3 1  ON 54
ci_056                 9.746506e-03 3 1  ON 55
ci_057                 9.829670e-03 3 1  ON 56
ci_058                -8.546700e-03 3 1  ON 57
ci_059                -8.518018e-03 3 1  ON 58
ci_060                 9.732204e-03 3 1  ON 59
ci_061                 9.850172e-03 3 1  ON 60
ci_062                -8.704411e-03 3 1  ON 61
ci_063                -8.778062e-03 3 1  ON 62
ci_064                -7.829026e-03 3 1  ON 63
ci_065                -8.182832e-03 3 1  ON 64
ci_066                 8.423233e-03 3 1  ON 65
ci_067                 8.409703e-03 3 1  ON 66
ci_068                -8.029260e-03 3 1  ON 67
ci_069                -8.094362e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1928
    reference variance = 0.325311
====================================================
  Execution time = 1.3571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7209e+01
  VMC Evar = 3.6484e-01
  Total weights = 1.9555e+06
  Execution time = 1.8539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361831805687
                                         uncertainty =       0.004598843637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361831805687
                                         uncertainty =       0.004598843637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425346305
  error estimate for blocks of size 2^( 2) =       0.000435584230
  error estimate for blocks of size 2^( 3) =       0.000444435487
  error estimate for blocks of size 2^( 4) =       0.000450466926
  error estimate for blocks of size 2^( 5) =       0.000454120824
  error estimate for blocks of size 2^( 6) =       0.000455664762
  error estimate for blocks of size 2^( 7) =       0.000457974362

      target function =      -0.637035428071
              le_mean =     -17.209270777606
             les_mean =     296.721651470962
             stat err =       0.000454556719
             autocorr =       1.142065030312
   target nu stat err =       0.000454556719
   target dn stat err =       0.184335811149
      target stat err =       0.119571726325
              std dev =       0.601530513123
             le_variance =       0.361838958218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327668073620
                                         uncertainty =       0.001892617668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327668073620
                                         uncertainty =       0.001892617668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404768736
  error estimate for blocks of size 2^( 2) =       0.000414560053
  error estimate for blocks of size 2^( 3) =       0.000423126974
  error estimate for blocks of size 2^( 4) =       0.000429309855
  error estimate for blocks of size 2^( 5) =       0.000432775116
  error estimate for blocks of size 2^( 6) =       0.000434405586
  error estimate for blocks of size 2^( 7) =       0.000436465148

      target function =      -0.841153734158
              le_mean =     -17.209687441115
             les_mean =     296.523874006319
             stat err =       0.000433238926
             autocorr =       1.145621144233
   target nu stat err =       0.000433238926
   target dn stat err =       0.003730217057
      target stat err =       0.004116654831
              std dev =       0.572429436150
             le_variance =       0.327675459371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338670664545
                                         uncertainty =       0.001882963133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338670664545
                                         uncertainty =       0.001882963133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411510558
  error estimate for blocks of size 2^( 2) =       0.000421549647
  error estimate for blocks of size 2^( 3) =       0.000430196514
  error estimate for blocks of size 2^( 4) =       0.000436188491
  error estimate for blocks of size 2^( 5) =       0.000439620013
  error estimate for blocks of size 2^( 6) =       0.000441174581
  error estimate for blocks of size 2^( 7) =       0.000443289775

      target function =      -0.809514192804
              le_mean =     -17.209360613838
             les_mean =     296.542314440126
             stat err =       0.000440068215
             autocorr =       1.143610248960
   target nu stat err =       0.000440068215
   target dn stat err =       0.017494960512
      target stat err =       0.017721821341
              std dev =       0.581963812288
             le_variance =       0.338681878813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355307226203
                                         uncertainty =       0.002020514331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355307226203
                                         uncertainty =       0.002020514331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421499063
  error estimate for blocks of size 2^( 2) =       0.000431734589
  error estimate for blocks of size 2^( 3) =       0.000440627738
  error estimate for blocks of size 2^( 4) =       0.000446672234
  error estimate for blocks of size 2^( 5) =       0.000450231204
  error estimate for blocks of size 2^( 6) =       0.000451759549
  error estimate for blocks of size 2^( 7) =       0.000454051621

      target function =      -0.794837807794
              le_mean =     -17.209300465617
             les_mean =     296.554892695390
             stat err =       0.000450678652
             autocorr =       1.143248781422
   target nu stat err =       0.000450678652
   target dn stat err =       0.020211837984
      target stat err =       0.019737409878
              std dev =       0.596089690981
             le_variance =       0.355322919694


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.637035428071        initial
     2.5000e-01     2.5000e+00             4.3950e-03        -0.841153734158  <--
     1.0000e+00     1.0000e+01             1.2699e-03        -0.809514192804
     4.0000e+00     4.0000e+01             3.3001e-04        -0.794837807794

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2893e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.449491e-02 3 1  ON 0
ci_002                -4.169135e-02 3 1  ON 1
ci_003                -3.162779e-02 3 1  ON 2
ci_004                 3.011523e-02 3 1  ON 3
ci_005                 3.020098e-02 3 1  ON 4
ci_006                -2.801084e-02 3 1  ON 5
ci_007                -2.827069e-02 3 1  ON 6
ci_008                -2.000523e-02 3 1  ON 7
ci_009                -2.245458e-02 3 1  ON 8
ci_010                -1.965878e-02 3 1  ON 9
ci_011                -1.976264e-02 3 1  ON 10
ci_012                -1.971177e-02 3 1  ON 11
ci_013                -2.389275e-02 3 1  ON 12
ci_014                 1.976510e-02 3 1  ON 13
ci_015                 1.941696e-02 3 1  ON 14
ci_016                 2.109524e-02 3 1  ON 15
ci_017                 2.111705e-02 3 1  ON 16
ci_018                 1.789938e-02 3 1  ON 17
ci_019                 1.747850e-02 3 1  ON 18
ci_020                 2.071817e-02 3 1  ON 19
ci_021                 2.057087e-02 3 1  ON 20
ci_022                 1.577391e-02 3 1  ON 21
ci_023                 1.547599e-02 3 1  ON 22
ci_024                 1.634431e-02 3 1  ON 23
ci_025                 1.653298e-02 3 1  ON 24
ci_026                 1.638372e-02 3 1  ON 25
ci_027                 1.648463e-02 3 1  ON 26
ci_028                -1.830213e-02 3 1  ON 27
ci_029                -1.856205e-02 3 1  ON 28
ci_030                -1.475514e-02 3 1  ON 29
ci_031                -1.466969e-02 3 1  ON 30
ci_032                -1.695794e-02 3 1  ON 31
ci_033                 1.270332e-02 3 1  ON 32
ci_034                 1.257345e-02 3 1  ON 33
ci_035                -1.122706e-02 3 1  ON 34
ci_036                -1.560334e-02 3 1  ON 35
ci_037                -1.542049e-02 3 1  ON 36
ci_038                 9.538573e-03 3 1  ON 37
ci_039                 9.797964e-03 3 1  ON 38
ci_040                -9.606765e-03 3 1  ON 39
ci_041                 1.257284e-02 3 1  ON 40
ci_042                 1.282277e-02 3 1  ON 41
ci_043                -9.769908e-03 3 1  ON 42
ci_044                -1.063545e-02 3 1  ON 43
ci_045                -8.977850e-03 3 1  ON 44
ci_046                 1.033560e-02 3 1  ON 45
ci_047                 1.034116e-02 3 1  ON 46
ci_048                -1.332837e-02 3 1  ON 47
ci_049                -1.341751e-02 3 1  ON 48
ci_050                 8.453066e-03 3 1  ON 49
ci_051                 8.633123e-03 3 1  ON 50
ci_052                -7.621334e-03 3 1  ON 51
ci_053                -7.779099e-03 3 1  ON 52
ci_054                -7.943913e-03 3 1  ON 53
ci_055                -8.177342e-03 3 1  ON 54
ci_056                 8.814348e-03 3 1  ON 55
ci_057                 8.998238e-03 3 1  ON 56
ci_058                -7.254697e-03 3 1  ON 57
ci_059                -7.408477e-03 3 1  ON 58
ci_060                 8.941301e-03 3 1  ON 59
ci_061                 9.188285e-03 3 1  ON 60
ci_062                -7.828561e-03 3 1  ON 61
ci_063                -7.828953e-03 3 1  ON 62
ci_064                -6.758950e-03 3 1  ON 63
ci_065                -7.266963e-03 3 1  ON 64
ci_066                 7.714472e-03 3 1  ON 65
ci_067                 7.657298e-03 3 1  ON 66
ci_068                -7.254777e-03 3 1  ON 67
ci_069                -7.618385e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.446259
====================================================
  Execution time = 1.3926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.5024e-01
  Total weights = 1.955759575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332554902809
                                         uncertainty =       0.002809921675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332554902809
                                         uncertainty =       0.002809921675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407727843
  error estimate for blocks of size 2^( 2) =       0.000417634247
  error estimate for blocks of size 2^( 3) =       0.000427000810
  error estimate for blocks of size 2^( 4) =       0.000433014668
  error estimate for blocks of size 2^( 5) =       0.000436486447
  error estimate for blocks of size 2^( 6) =       0.000440302423
  error estimate for blocks of size 2^( 7) =       0.000443344003

      target function =      -0.841727597970
              le_mean =     -17.211851529613
             les_mean =     296.598068093284
             stat err =       0.000438286885
             autocorr =       1.155516662533
   target nu stat err =       0.000438286885
   target dn stat err =       0.003474923447
      target stat err =       0.003859422977
              std dev =       0.576614244684
             le_variance =       0.332483987172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185152961e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.841744702322       residual = 8.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864858498281       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869389319981       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870939491982       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871131778949       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871180884741       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871190889673       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871192470657       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871193412636       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871193316644       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871193310928       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871193281271       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871193239908       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 8.164475e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.841744702322       residual = 8.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.851347861390       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.853094764547       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.853632207533       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.853692526267       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.853705582806       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.853708626146       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.853708853611       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.853709103326       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.853709057666       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.853709060082       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.853709053891       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.853709040764       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.222841e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.841744702322       residual = 8.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.844608832209       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.845107320758       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.845252250459       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.845267751664       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.845270808254       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.845271597267       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.845271641295       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.845271694228       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.845271682101       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.845271683780       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.845271681703       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.741295e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6448e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.129587e-02 3 1  ON 0
ci_002                -3.910861e-02 3 1  ON 1
ci_003                -3.033337e-02 3 1  ON 2
ci_004                 2.815373e-02 3 1  ON 3
ci_005                 2.835279e-02 3 1  ON 4
ci_006                -2.585812e-02 3 1  ON 5
ci_007                -2.587882e-02 3 1  ON 6
ci_008                -1.678239e-02 3 1  ON 7
ci_009                -2.050235e-02 3 1  ON 8
ci_010                -1.694483e-02 3 1  ON 9
ci_011                -1.719130e-02 3 1  ON 10
ci_012                -1.733738e-02 3 1  ON 11
ci_013                -2.297075e-02 3 1  ON 12
ci_014                 1.779156e-02 3 1  ON 13
ci_015                 1.758505e-02 3 1  ON 14
ci_016                 1.990350e-02 3 1  ON 15
ci_017                 1.983895e-02 3 1  ON 16
ci_018                 1.583959e-02 3 1  ON 17
ci_019                 1.557673e-02 3 1  ON 18
ci_020                 1.958698e-02 3 1  ON 19
ci_021                 1.941904e-02 3 1  ON 20
ci_022                 1.404753e-02 3 1  ON 21
ci_023                 1.401010e-02 3 1  ON 22
ci_024                 1.471295e-02 3 1  ON 23
ci_025                 1.500239e-02 3 1  ON 24
ci_026                 1.533579e-02 3 1  ON 25
ci_027                 1.533231e-02 3 1  ON 26
ci_028                -1.755683e-02 3 1  ON 27
ci_029                -1.764356e-02 3 1  ON 28
ci_030                -1.325890e-02 3 1  ON 29
ci_031                -1.308044e-02 3 1  ON 30
ci_032                -1.642981e-02 3 1  ON 31
ci_033                 1.092494e-02 3 1  ON 32
ci_034                 1.087221e-02 3 1  ON 33
ci_035                -9.328740e-03 3 1  ON 34
ci_036                -1.480869e-02 3 1  ON 35
ci_037                -1.462503e-02 3 1  ON 36
ci_038                 7.567120e-03 3 1  ON 37
ci_039                 7.839118e-03 3 1  ON 38
ci_040                -7.688556e-03 3 1  ON 39
ci_041                 1.179398e-02 3 1  ON 40
ci_042                 1.160337e-02 3 1  ON 41
ci_043                -8.013221e-03 3 1  ON 42
ci_044                -9.065714e-03 3 1  ON 43
ci_045                -7.391079e-03 3 1  ON 44
ci_046                 9.153728e-03 3 1  ON 45
ci_047                 9.184596e-03 3 1  ON 46
ci_048                -1.312798e-02 3 1  ON 47
ci_049                -1.343306e-02 3 1  ON 48
ci_050                 6.908574e-03 3 1  ON 49
ci_051                 7.336362e-03 3 1  ON 50
ci_052                -6.384316e-03 3 1  ON 51
ci_053                -6.323729e-03 3 1  ON 52
ci_054                -6.878494e-03 3 1  ON 53
ci_055                -6.928875e-03 3 1  ON 54
ci_056                 7.934173e-03 3 1  ON 55
ci_057                 8.212882e-03 3 1  ON 56
ci_058                -5.816732e-03 3 1  ON 57
ci_059                -5.949357e-03 3 1  ON 58
ci_060                 8.158806e-03 3 1  ON 59
ci_061                 8.193962e-03 3 1  ON 60
ci_062                -6.833377e-03 3 1  ON 61
ci_063                -6.699796e-03 3 1  ON 62
ci_064                -5.692553e-03 3 1  ON 63
ci_065                -6.230442e-03 3 1  ON 64
ci_066                 6.766305e-03 3 1  ON 65
ci_067                 6.800840e-03 3 1  ON 66
ci_068                -6.550350e-03 3 1  ON 67
ci_069                -6.730682e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.153615
====================================================
  Execution time = 1.5838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2505e-01
  Total weights = 1.9560e+06
  Execution time = 1.9524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331556817191
                                         uncertainty =       0.002342968668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331556817191
                                         uncertainty =       0.002342968668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407170081
  error estimate for blocks of size 2^( 2) =       0.000417318809
  error estimate for blocks of size 2^( 3) =       0.000426309238
  error estimate for blocks of size 2^( 4) =       0.000433733368
  error estimate for blocks of size 2^( 5) =       0.000438520177
  error estimate for blocks of size 2^( 6) =       0.000441288260
  error estimate for blocks of size 2^( 7) =       0.000441440302

      target function =      -0.453269256965
              le_mean =     -17.214045132799
             les_mean =     297.152776507251
             stat err =       0.000438745527
             autocorr =       1.161110856569
   target nu stat err =       0.000438745527
   target dn stat err =       0.467342520592
      target stat err =       0.170461809187
              std dev =       0.575825451093
             le_variance =       0.331574950126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295287421300
                                         uncertainty =       0.002012873083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295287421300
                                         uncertainty =       0.002012873083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384230504
  error estimate for blocks of size 2^( 2) =       0.000394258371
  error estimate for blocks of size 2^( 3) =       0.000403352330
  error estimate for blocks of size 2^( 4) =       0.000410725621
  error estimate for blocks of size 2^( 5) =       0.000415683064
  error estimate for blocks of size 2^( 6) =       0.000418365074
  error estimate for blocks of size 2^( 7) =       0.000418436441

      target function =      -0.792235256023
              le_mean =     -17.214335492049
             les_mean =     296.729374036927
             stat err =       0.000415802550
             autocorr =       1.171090928327
   target nu stat err =       0.000415802550
   target dn stat err =       0.041839599942
      target stat err =       0.040979597167
              std dev =       0.543383989331
             le_variance =       0.295266159861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301432252268
                                         uncertainty =       0.003366831939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301432252268
                                         uncertainty =       0.003366831939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388207401
  error estimate for blocks of size 2^( 2) =       0.000398024132
  error estimate for blocks of size 2^( 3) =       0.000407035610
  error estimate for blocks of size 2^( 4) =       0.000414441043
  error estimate for blocks of size 2^( 5) =       0.000419493193
  error estimate for blocks of size 2^( 6) =       0.000422401327
  error estimate for blocks of size 2^( 7) =       0.000422215070

      target function =      -0.040278982559
              le_mean =     -17.213961122726
             les_mean =     304.693656879220
             stat err =       0.000419637658
             autocorr =       1.168480013988
   target nu stat err =       0.000419637658
   target dn stat err =       7.944173981572
      target stat err =       0.036417288608
              std dev =       0.549008171326
             le_variance =       0.301409972183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323424787424
                                         uncertainty =       0.002068880302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323424787424
                                         uncertainty =       0.002068880302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402139265
  error estimate for blocks of size 2^( 2) =       0.000412229393
  error estimate for blocks of size 2^( 3) =       0.000421157468
  error estimate for blocks of size 2^( 4) =       0.000428550994
  error estimate for blocks of size 2^( 5) =       0.000433241562
  error estimate for blocks of size 2^( 6) =       0.000436037178
  error estimate for blocks of size 2^( 7) =       0.000436176584

      target function =      -0.828526144955
              le_mean =     -17.213812118942
             les_mean =     296.677799942144
             stat err =       0.000433501579
             autocorr =       1.162059616941
   target nu stat err =       0.000433501579
   target dn stat err =       0.010734292793
      target stat err =       0.011473858838
              std dev =       0.568710802222
             le_variance =       0.323431976564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.453269256965        initial
     6.2500e-02     6.2500e-01             8.1645e-03        -0.792235256023
     2.5000e-01     2.5000e+00             3.2228e-03        -0.040278982559
     1.0000e+00     1.0000e+01             9.7413e-04        -0.828526144955  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.5297e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.356775e-02 3 1  ON 0
ci_002                -4.093568e-02 3 1  ON 1
ci_003                -3.125983e-02 3 1  ON 2
ci_004                 2.954559e-02 3 1  ON 3
ci_005                 2.966442e-02 3 1  ON 4
ci_006                -2.738196e-02 3 1  ON 5
ci_007                -2.757111e-02 3 1  ON 6
ci_008                -1.903110e-02 3 1  ON 7
ci_009                -2.187393e-02 3 1  ON 8
ci_010                -1.885435e-02 3 1  ON 9
ci_011                -1.899814e-02 3 1  ON 10
ci_012                -1.900672e-02 3 1  ON 11
ci_013                -2.362628e-02 3 1  ON 12
ci_014                 1.917820e-02 3 1  ON 13
ci_015                 1.887386e-02 3 1  ON 14
ci_016                 2.073895e-02 3 1  ON 15
ci_017                 2.073609e-02 3 1  ON 16
ci_018                 1.728393e-02 3 1  ON 17
ci_019                 1.691038e-02 3 1  ON 18
ci_020                 2.039084e-02 3 1  ON 19
ci_021                 2.023904e-02 3 1  ON 20
ci_022                 1.525789e-02 3 1  ON 21
ci_023                 1.503914e-02 3 1  ON 22
ci_024                 1.587121e-02 3 1  ON 23
ci_025                 1.609054e-02 3 1  ON 24
ci_026                 1.607726e-02 3 1  ON 25
ci_027                 1.614567e-02 3 1  ON 26
ci_028                -1.807936e-02 3 1  ON 27
ci_029                -1.829035e-02 3 1  ON 28
ci_030                -1.430681e-02 3 1  ON 29
ci_031                -1.419102e-02 3 1  ON 30
ci_032                -1.680125e-02 3 1  ON 31
ci_033                 1.218066e-02 3 1  ON 32
ci_034                 1.207348e-02 3 1  ON 33
ci_035                -1.065912e-02 3 1  ON 34
ci_036                -1.537527e-02 3 1  ON 35
ci_037                -1.519221e-02 3 1  ON 36
ci_038                 8.947770e-03 3 1  ON 37
ci_039                 9.210197e-03 3 1  ON 38
ci_040                -9.029415e-03 3 1  ON 39
ci_041                 1.233847e-02 3 1  ON 40
ci_042                 1.245696e-02 3 1  ON 41
ci_043                -9.245237e-03 3 1  ON 42
ci_044                -1.016806e-02 3 1  ON 43
ci_045                -8.500574e-03 3 1  ON 44
ci_046                 9.987113e-03 3 1  ON 45
ci_047                 1.000007e-02 3 1  ON 46
ci_048                -1.326584e-02 3 1  ON 47
ci_049                -1.341947e-02 3 1  ON 48
ci_050                 7.983645e-03 3 1  ON 49
ci_051                 8.240410e-03 3 1  ON 50
ci_052                -7.246294e-03 3 1  ON 51
ci_053                -7.336683e-03 3 1  ON 52
ci_054                -7.630551e-03 3 1  ON 53
ci_055                -7.809311e-03 3 1  ON 54
ci_056                 8.552646e-03 3 1  ON 55
ci_057                 8.764564e-03 3 1  ON 56
ci_058                -6.817635e-03 3 1  ON 57
ci_059                -6.962007e-03 3 1  ON 58
ci_060                 8.711731e-03 3 1  ON 59
ci_061                 8.895658e-03 3 1  ON 60
ci_062                -7.536626e-03 3 1  ON 61
ci_063                -7.497420e-03 3 1  ON 62
ci_064                -6.436914e-03 3 1  ON 63
ci_065                -6.955678e-03 3 1  ON 64
ci_066                 7.429080e-03 3 1  ON 65
ci_067                 7.399040e-03 3 1  ON 66
ci_068                -7.043994e-03 3 1  ON 67
ci_069                -7.352750e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2227
    reference variance = 0.18605
====================================================
  Execution time = 1.4709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.6568e-01
  Total weights = 1.955473797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333651954863
                                         uncertainty =       0.006875331223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333651954863
                                         uncertainty =       0.006875331223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408807293
  error estimate for blocks of size 2^( 2) =       0.000418764633
  error estimate for blocks of size 2^( 3) =       0.000427377761
  error estimate for blocks of size 2^( 4) =       0.000434029598
  error estimate for blocks of size 2^( 5) =       0.000438675542
  error estimate for blocks of size 2^( 6) =       0.000441295169
  error estimate for blocks of size 2^( 7) =       0.000441671657

      target function =      -0.824672462741
              le_mean =     -17.212889814780
             les_mean =     296.649255314050
             stat err =       0.000438917991
             autocorr =       1.152735046597
   target nu stat err =       0.000438917991
   target dn stat err =       0.019780275706
      target stat err =       0.020908999900
              std dev =       0.578140817578
             le_variance =       0.334246804949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721288981478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825200080821       residual = 7.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.833811482134       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.835326538166       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.835812268557       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.835871142066       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.835887449028       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.835890546499       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.835890566204       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.835890909266       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.835891002565       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.835891016812       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.835891005986       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.835890995631       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.345720e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825200080821       residual = 7.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827762798522       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828193910418       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828324048816       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828339134463       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828343156365       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828343941199       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828343911032       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828343985424       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828344006507       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828344009987       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828344006876       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.633539e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.825200080821       residual = 7.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.825872410236       residual = 9.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.825983844632       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.826016843694       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.826020617921       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.826021612955       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.826021808730       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.826021798555       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.826021816201       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.826021821269       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.826021822132       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.826021821334       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.501728e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259212 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7230e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -5.260440e-02 3 1  ON 0
ci_002                -4.007467e-02 3 1  ON 1
ci_003                -3.089829e-02 3 1  ON 2
ci_004                 2.898954e-02 3 1  ON 3
ci_005                 2.925439e-02 3 1  ON 4
ci_006                -2.682524e-02 3 1  ON 5
ci_007                -2.687867e-02 3 1  ON 6
ci_008                -1.816504e-02 3 1  ON 7
ci_009                -2.134132e-02 3 1  ON 8
ci_010                -1.845894e-02 3 1  ON 9
ci_011                -1.830095e-02 3 1  ON 10
ci_012                -1.832085e-02 3 1  ON 11
ci_013                -2.336790e-02 3 1  ON 12
ci_014                 1.845033e-02 3 1  ON 13
ci_015                 1.840692e-02 3 1  ON 14
ci_016                 2.044224e-02 3 1  ON 15
ci_017                 2.070132e-02 3 1  ON 16
ci_018                 1.669570e-02 3 1  ON 17
ci_019                 1.663567e-02 3 1  ON 18
ci_020                 2.006490e-02 3 1  ON 19
ci_021                 1.989202e-02 3 1  ON 20
ci_022                 1.472962e-02 3 1  ON 21
ci_023                 1.453189e-02 3 1  ON 22
ci_024                 1.552231e-02 3 1  ON 23
ci_025                 1.596686e-02 3 1  ON 24
ci_026                 1.566811e-02 3 1  ON 25
ci_027                 1.583423e-02 3 1  ON 26
ci_028                -1.786576e-02 3 1  ON 27
ci_029                -1.807644e-02 3 1  ON 28
ci_030                -1.393749e-02 3 1  ON 29
ci_031                -1.379304e-02 3 1  ON 30
ci_032                -1.666094e-02 3 1  ON 31
ci_033                 1.167819e-02 3 1  ON 32
ci_034                 1.165919e-02 3 1  ON 33
ci_035                -1.040423e-02 3 1  ON 34
ci_036                -1.526957e-02 3 1  ON 35
ci_037                -1.492563e-02 3 1  ON 36
ci_038                 8.406102e-03 3 1  ON 37
ci_039                 8.630060e-03 3 1  ON 38
ci_040                -8.517266e-03 3 1  ON 39
ci_041                 1.183906e-02 3 1  ON 40
ci_042                 1.217832e-02 3 1  ON 41
ci_043                -8.858991e-03 3 1  ON 42
ci_044                -9.653975e-03 3 1  ON 43
ci_045                -8.132099e-03 3 1  ON 44
ci_046                 9.720562e-03 3 1  ON 45
ci_047                 9.919528e-03 3 1  ON 46
ci_048                -1.323509e-02 3 1  ON 47
ci_049                -1.335170e-02 3 1  ON 48
ci_050                 7.566909e-03 3 1  ON 49
ci_051                 7.821795e-03 3 1  ON 50
ci_052                -6.535856e-03 3 1  ON 51
ci_053                -6.973213e-03 3 1  ON 52
ci_054                -7.345258e-03 3 1  ON 53
ci_055                -7.467844e-03 3 1  ON 54
ci_056                 8.439037e-03 3 1  ON 55
ci_057                 8.397024e-03 3 1  ON 56
ci_058                -6.326984e-03 3 1  ON 57
ci_059                -6.561462e-03 3 1  ON 58
ci_060                 8.390172e-03 3 1  ON 59
ci_061                 8.634585e-03 3 1  ON 60
ci_062                -7.219153e-03 3 1  ON 61
ci_063                -7.076538e-03 3 1  ON 62
ci_064                -6.171676e-03 3 1  ON 63
ci_065                -6.669914e-03 3 1  ON 64
ci_066                 7.129376e-03 3 1  ON 65
ci_067                 7.191094e-03 3 1  ON 66
ci_068                -7.017917e-03 3 1  ON 67
ci_069                -7.197980e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2001
    reference variance = 0.302858
====================================================
  Execution time = 1.3774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3250e-01
  Total weights = 1.9558e+06
  Execution time = 1.8564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452818165
                                         uncertainty =       0.002463256398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324452818165
                                         uncertainty =       0.002463256398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402817993
  error estimate for blocks of size 2^( 2) =       0.000413213615
  error estimate for blocks of size 2^( 3) =       0.000421993162
  error estimate for blocks of size 2^( 4) =       0.000429492303
  error estimate for blocks of size 2^( 5) =       0.000433555551
  error estimate for blocks of size 2^( 6) =       0.000435430558
  error estimate for blocks of size 2^( 7) =       0.000436894582

      target function =      -0.851788711687
              le_mean =     -17.213606792162
             les_mean =     296.649642576338
             stat err =       0.000433843248
             autocorr =       1.159973224341
   target nu stat err =       0.000433843248
   target dn stat err =       0.003462839083
      target stat err =       0.003947657987
              std dev =       0.569670668514
             le_variance =       0.324524670565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308836410670
                                         uncertainty =       0.002342631952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308836410670
                                         uncertainty =       0.002342631952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393036676
  error estimate for blocks of size 2^( 2) =       0.000403268534
  error estimate for blocks of size 2^( 3) =       0.000412054357
  error estimate for blocks of size 2^( 4) =       0.000419534450
  error estimate for blocks of size 2^( 5) =       0.000423674985
  error estimate for blocks of size 2^( 6) =       0.000425519344
  error estimate for blocks of size 2^( 7) =       0.000427027198

      target function =      -0.821390739938
              le_mean =     -17.213804631134
             les_mean =     296.683274064353
             stat err =       0.000423938994
             autocorr =       1.163430846080
   target nu stat err =       0.000423938994
   target dn stat err =       0.030112461640
      target stat err =       0.031642668679
              std dev =       0.555837797608
             le_variance =       0.308955657250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314327791828
                                         uncertainty =       0.002373603294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314327791828
                                         uncertainty =       0.002373603294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396499162
  error estimate for blocks of size 2^( 2) =       0.000406779770
  error estimate for blocks of size 2^( 3) =       0.000415543925
  error estimate for blocks of size 2^( 4) =       0.000423025149
  error estimate for blocks of size 2^( 5) =       0.000427134114
  error estimate for blocks of size 2^( 6) =       0.000428990005
  error estimate for blocks of size 2^( 7) =       0.000430493569

      target function =      -0.860805371106
              le_mean =     -17.213637178348
             les_mean =     296.642763077624
             stat err =       0.000427410709
             autocorr =       1.162000332662
   target nu stat err =       0.000427410709
   target dn stat err =       0.005076590912
      target stat err =       0.005875930847
              std dev =       0.560734492184
             le_variance =       0.314423170725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322988645566
                                         uncertainty =       0.002448488632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322988645566
                                         uncertainty =       0.002448488632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401909852
  error estimate for blocks of size 2^( 2) =       0.000412286904
  error estimate for blocks of size 2^( 3) =       0.000421059665
  error estimate for blocks of size 2^( 4) =       0.000428554464
  error estimate for blocks of size 2^( 5) =       0.000432624458
  error estimate for blocks of size 2^( 6) =       0.000434494048
  error estimate for blocks of size 2^( 7) =       0.000435969140

      target function =      -0.856450974960
              le_mean =     -17.213595764556
             les_mean =     296.645154868526
             stat err =       0.000432910527
             autocorr =       1.160216369043
   target nu stat err =       0.000432910527
   target dn stat err =       0.002922551158
      target stat err =       0.003381841744
              std dev =       0.568386364238
             le_variance =       0.323063059051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.851788711687        initial
     2.5000e-01     2.5000e+00             3.3457e-03        -0.821390739938
     1.0000e+00     1.0000e+01             9.6335e-04        -0.860805371106  <--
     4.0000e+00     4.0000e+01             2.5017e-04        -0.856450974960

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.3114e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -5.260440e-02 3 1  ON 0
ci_002                -4.007467e-02 3 1  ON 1
ci_003                -3.089829e-02 3 1  ON 2
ci_004                 2.898954e-02 3 1  ON 3
ci_005                 2.925439e-02 3 1  ON 4
ci_006                -2.682524e-02 3 1  ON 5
ci_007                -2.687867e-02 3 1  ON 6
ci_008                -1.816504e-02 3 1  ON 7
ci_009                -2.134132e-02 3 1  ON 8
ci_010                -1.845894e-02 3 1  ON 9
ci_011                -1.830095e-02 3 1  ON 10
ci_012                -1.832085e-02 3 1  ON 11
ci_013                -2.336790e-02 3 1  ON 12
ci_014                 1.845033e-02 3 1  ON 13
ci_015                 1.840692e-02 3 1  ON 14
ci_016                 2.044224e-02 3 1  ON 15
ci_017                 2.070132e-02 3 1  ON 16
ci_018                 1.669570e-02 3 1  ON 17
ci_019                 1.663567e-02 3 1  ON 18
ci_020                 2.006490e-02 3 1  ON 19
ci_021                 1.989202e-02 3 1  ON 20
ci_022                 1.472962e-02 3 1  ON 21
ci_023                 1.453189e-02 3 1  ON 22
ci_024                 1.552231e-02 3 1  ON 23
ci_025                 1.596686e-02 3 1  ON 24
ci_026                 1.566811e-02 3 1  ON 25
ci_027                 1.583423e-02 3 1  ON 26
ci_028                -1.786576e-02 3 1  ON 27
ci_029                -1.807644e-02 3 1  ON 28
ci_030                -1.393749e-02 3 1  ON 29
ci_031                -1.379304e-02 3 1  ON 30
ci_032                -1.666094e-02 3 1  ON 31
ci_033                 1.167819e-02 3 1  ON 32
ci_034                 1.165919e-02 3 1  ON 33
ci_035                -1.040423e-02 3 1  ON 34
ci_036                -1.526957e-02 3 1  ON 35
ci_037                -1.492563e-02 3 1  ON 36
ci_038                 8.406102e-03 3 1  ON 37
ci_039                 8.630060e-03 3 1  ON 38
ci_040                -8.517266e-03 3 1  ON 39
ci_041                 1.183906e-02 3 1  ON 40
ci_042                 1.217832e-02 3 1  ON 41
ci_043                -8.858991e-03 3 1  ON 42
ci_044                -9.653975e-03 3 1  ON 43
ci_045                -8.132099e-03 3 1  ON 44
ci_046                 9.720562e-03 3 1  ON 45
ci_047                 9.919528e-03 3 1  ON 46
ci_048                -1.323509e-02 3 1  ON 47
ci_049                -1.335170e-02 3 1  ON 48
ci_050                 7.566909e-03 3 1  ON 49
ci_051                 7.821795e-03 3 1  ON 50
ci_052                -6.535856e-03 3 1  ON 51
ci_053                -6.973213e-03 3 1  ON 52
ci_054                -7.345258e-03 3 1  ON 53
ci_055                -7.467844e-03 3 1  ON 54
ci_056                 8.439037e-03 3 1  ON 55
ci_057                 8.397024e-03 3 1  ON 56
ci_058                -6.326984e-03 3 1  ON 57
ci_059                -6.561462e-03 3 1  ON 58
ci_060                 8.390172e-03 3 1  ON 59
ci_061                 8.634585e-03 3 1  ON 60
ci_062                -7.219153e-03 3 1  ON 61
ci_063                -7.076538e-03 3 1  ON 62
ci_064                -6.171676e-03 3 1  ON 63
ci_065                -6.669914e-03 3 1  ON 64
ci_066                 7.129376e-03 3 1  ON 65
ci_067                 7.191094e-03 3 1  ON 66
ci_068                -7.017917e-03 3 1  ON 67
ci_069                -7.197980e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1906
    reference variance = 0.243916
====================================================
  Execution time = 1.3769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3435e-01
  Total weights = 1.956013293e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317634619591
                                         uncertainty =       0.001849210267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317634619591
                                         uncertainty =       0.001849210267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398464338
  error estimate for blocks of size 2^( 2) =       0.000408654625
  error estimate for blocks of size 2^( 3) =       0.000417447188
  error estimate for blocks of size 2^( 4) =       0.000424504436
  error estimate for blocks of size 2^( 5) =       0.000428744430
  error estimate for blocks of size 2^( 6) =       0.000430573856
  error estimate for blocks of size 2^( 7) =       0.000434427126

      target function =      -0.859779012762
              le_mean =     -17.213473903650
             les_mean =     296.638035565801
             stat err =       0.000429562462
             autocorr =       1.162180886188
   target nu stat err =       0.000429562462
   target dn stat err =       0.003103572709
      target stat err =       0.003611567243
              std dev =       0.563513670790
             le_variance =       0.317547657167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721347390365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.859793428129       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.866948249256       residual = 8.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868249405388       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.868595840397       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.868634814521       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.868646793239       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.868648546756       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.868648685773       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.868648651646       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.868648723049       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.868648696145       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.868648678085       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.025091e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.859793428129       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.861935207704       residual = 7.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.862308063859       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.862401531018       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.862411602010       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.862414661320       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.862415074425       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.862415090803       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.862415078934       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.862415096645       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.862415089837       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.862415085837       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 8.791183e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.859793428129       residual = 5.84e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.860356412948       residual = 7.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.860453012201       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.860476764470       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.860479290792       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.860480055202       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.860480155657       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.860480158340       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.860480155180       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.860480159565       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.860480157874       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.860480156920       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.289722e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6308e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -5.172528e-02 3 1  ON 0
ci_002                -3.938869e-02 3 1  ON 1
ci_003                -3.043418e-02 3 1  ON 2
ci_004                 2.851676e-02 3 1  ON 3
ci_005                 2.888609e-02 3 1  ON 4
ci_006                -2.631173e-02 3 1  ON 5
ci_007                -2.636733e-02 3 1  ON 6
ci_008                -1.746125e-02 3 1  ON 7
ci_009                -2.082541e-02 3 1  ON 8
ci_010                -1.786492e-02 3 1  ON 9
ci_011                -1.768918e-02 3 1  ON 10
ci_012                -1.770730e-02 3 1  ON 11
ci_013                -2.315552e-02 3 1  ON 12
ci_014                 1.792895e-02 3 1  ON 13
ci_015                 1.787495e-02 3 1  ON 14
ci_016                 2.018606e-02 3 1  ON 15
ci_017                 2.035332e-02 3 1  ON 16
ci_018                 1.613832e-02 3 1  ON 17
ci_019                 1.610269e-02 3 1  ON 18
ci_020                 1.981007e-02 3 1  ON 19
ci_021                 1.956718e-02 3 1  ON 20
ci_022                 1.426630e-02 3 1  ON 21
ci_023                 1.411786e-02 3 1  ON 22
ci_024                 1.514720e-02 3 1  ON 23
ci_025                 1.546678e-02 3 1  ON 24
ci_026                 1.529574e-02 3 1  ON 25
ci_027                 1.541931e-02 3 1  ON 26
ci_028                -1.763196e-02 3 1  ON 27
ci_029                -1.790178e-02 3 1  ON 28
ci_030                -1.357842e-02 3 1  ON 29
ci_031                -1.346232e-02 3 1  ON 30
ci_032                -1.653944e-02 3 1  ON 31
ci_033                 1.130058e-02 3 1  ON 32
ci_034                 1.124005e-02 3 1  ON 33
ci_035                -9.876463e-03 3 1  ON 34
ci_036                -1.508834e-02 3 1  ON 35
ci_037                -1.469277e-02 3 1  ON 36
ci_038                 7.894938e-03 3 1  ON 37
ci_039                 8.115793e-03 3 1  ON 38
ci_040                -8.000017e-03 3 1  ON 39
ci_041                 1.161938e-02 3 1  ON 40
ci_042                 1.186340e-02 3 1  ON 41
ci_043                -8.403314e-03 3 1  ON 42
ci_044                -9.284704e-03 3 1  ON 43
ci_045                -7.677724e-03 3 1  ON 44
ci_046                 9.399319e-03 3 1  ON 45
ci_047                 9.556395e-03 3 1  ON 46
ci_048                -1.314126e-02 3 1  ON 47
ci_049                -1.324285e-02 3 1  ON 48
ci_050                 7.172522e-03 3 1  ON 49
ci_051                 7.458327e-03 3 1  ON 50
ci_052                -6.253895e-03 3 1  ON 51
ci_053                -6.649332e-03 3 1  ON 52
ci_054                -7.017787e-03 3 1  ON 53
ci_055                -7.141388e-03 3 1  ON 54
ci_056                 8.161816e-03 3 1  ON 55
ci_057                 8.152047e-03 3 1  ON 56
ci_058                -6.052536e-03 3 1  ON 57
ci_059                -6.209902e-03 3 1  ON 58
ci_060                 8.199469e-03 3 1  ON 59
ci_061                 8.429529e-03 3 1  ON 60
ci_062                -6.958795e-03 3 1  ON 61
ci_063                -6.811529e-03 3 1  ON 62
ci_064                -5.902805e-03 3 1  ON 63
ci_065                -6.407960e-03 3 1  ON 64
ci_066                 6.910681e-03 3 1  ON 65
ci_067                 6.946987e-03 3 1  ON 66
ci_068                -6.905704e-03 3 1  ON 67
ci_069                -6.945488e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1558
    reference variance = 0.310494
====================================================
  Execution time = 1.3572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.3329e-01
  Total weights = 1.9559e+06
  Execution time = 1.8546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319139164974
                                         uncertainty =       0.002374051133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319139164974
                                         uncertainty =       0.002374051133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399432662
  error estimate for blocks of size 2^( 2) =       0.000409755603
  error estimate for blocks of size 2^( 3) =       0.000418125008
  error estimate for blocks of size 2^( 4) =       0.000425356364
  error estimate for blocks of size 2^( 5) =       0.000428604224
  error estimate for blocks of size 2^( 6) =       0.000431551081
  error estimate for blocks of size 2^( 7) =       0.000432096554

      target function =      -0.849782733445
              le_mean =     -17.214659470147
             les_mean =     296.687753978108
             stat err =       0.000429402056
             autocorr =       1.155689289074
   target nu stat err =       0.000429402056
   target dn stat err =       0.005755466032
      target stat err =       0.006496608042
              std dev =       0.564883088374
             le_variance =       0.319092903531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305069919575
                                         uncertainty =       0.002166490406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305069919575
                                         uncertainty =       0.002166490406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390525014
  error estimate for blocks of size 2^( 2) =       0.000400755155
  error estimate for blocks of size 2^( 3) =       0.000409078032
  error estimate for blocks of size 2^( 4) =       0.000416365938
  error estimate for blocks of size 2^( 5) =       0.000419764229
  error estimate for blocks of size 2^( 6) =       0.000422748632
  error estimate for blocks of size 2^( 7) =       0.000423335548

      target function =      -0.741806210632
              le_mean =     -17.214778748570
             les_mean =     296.789169166960
             stat err =       0.000420553587
             autocorr =       1.159698163556
   target nu stat err =       0.000420553587
   target dn stat err =       0.104276066985
      target stat err =       0.090696117836
              std dev =       0.552285770995
             le_variance =       0.305019572843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310003884218
                                         uncertainty =       0.002239324879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310003884218
                                         uncertainty =       0.002239324879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393671837
  error estimate for blocks of size 2^( 2) =       0.000403918928
  error estimate for blocks of size 2^( 3) =       0.000412240486
  error estimate for blocks of size 2^( 4) =       0.000419491991
  error estimate for blocks of size 2^( 5) =       0.000422819544
  error estimate for blocks of size 2^( 6) =       0.000425805317
  error estimate for blocks of size 2^( 7) =       0.000426363537

      target function =      -0.864266148653
              le_mean =     -17.214656086555
             les_mean =     296.674996060901
             stat err =       0.000423620097
             autocorr =       1.157935633355
   target nu stat err =       0.000423620097
   target dn stat err =       0.003800066017
      target stat err =       0.004456316122
              std dev =       0.556736050346
             le_variance =       0.309955029755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317830099719
                                         uncertainty =       0.002355233050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317830099719
                                         uncertainty =       0.002355233050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398612274
  error estimate for blocks of size 2^( 2) =       0.000408920235
  error estimate for blocks of size 2^( 3) =       0.000417273913
  error estimate for blocks of size 2^( 4) =       0.000424501166
  error estimate for blocks of size 2^( 5) =       0.000427759686
  error estimate for blocks of size 2^( 6) =       0.000430736904
  error estimate for blocks of size 2^( 7) =       0.000431274849

      target function =      -0.829955027050
              le_mean =     -17.214649092426
             les_mean =     296.704866175537
             stat err =       0.000428568151
             autocorr =       1.155948411232
   target nu stat err =       0.000428568151
   target dn stat err =       0.022060959896
      target stat err =       0.023686257259
              std dev =       0.563722884114
             le_variance =       0.317783490073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.849782733445        initial
     2.5000e-01     2.5000e+00             3.0251e-03        -0.741806210632
     1.0000e+00     1.0000e+01             8.7912e-04        -0.864266148653  <--
     4.0000e+00     4.0000e+01             2.2897e-04        -0.829955027050

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2898e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -5.172528e-02 3 1  ON 0
ci_002                -3.938869e-02 3 1  ON 1
ci_003                -3.043418e-02 3 1  ON 2
ci_004                 2.851676e-02 3 1  ON 3
ci_005                 2.888609e-02 3 1  ON 4
ci_006                -2.631173e-02 3 1  ON 5
ci_007                -2.636733e-02 3 1  ON 6
ci_008                -1.746125e-02 3 1  ON 7
ci_009                -2.082541e-02 3 1  ON 8
ci_010                -1.786492e-02 3 1  ON 9
ci_011                -1.768918e-02 3 1  ON 10
ci_012                -1.770730e-02 3 1  ON 11
ci_013                -2.315552e-02 3 1  ON 12
ci_014                 1.792895e-02 3 1  ON 13
ci_015                 1.787495e-02 3 1  ON 14
ci_016                 2.018606e-02 3 1  ON 15
ci_017                 2.035332e-02 3 1  ON 16
ci_018                 1.613832e-02 3 1  ON 17
ci_019                 1.610269e-02 3 1  ON 18
ci_020                 1.981007e-02 3 1  ON 19
ci_021                 1.956718e-02 3 1  ON 20
ci_022                 1.426630e-02 3 1  ON 21
ci_023                 1.411786e-02 3 1  ON 22
ci_024                 1.514720e-02 3 1  ON 23
ci_025                 1.546678e-02 3 1  ON 24
ci_026                 1.529574e-02 3 1  ON 25
ci_027                 1.541931e-02 3 1  ON 26
ci_028                -1.763196e-02 3 1  ON 27
ci_029                -1.790178e-02 3 1  ON 28
ci_030                -1.357842e-02 3 1  ON 29
ci_031                -1.346232e-02 3 1  ON 30
ci_032                -1.653944e-02 3 1  ON 31
ci_033                 1.130058e-02 3 1  ON 32
ci_034                 1.124005e-02 3 1  ON 33
ci_035                -9.876463e-03 3 1  ON 34
ci_036                -1.508834e-02 3 1  ON 35
ci_037                -1.469277e-02 3 1  ON 36
ci_038                 7.894938e-03 3 1  ON 37
ci_039                 8.115793e-03 3 1  ON 38
ci_040                -8.000017e-03 3 1  ON 39
ci_041                 1.161938e-02 3 1  ON 40
ci_042                 1.186340e-02 3 1  ON 41
ci_043                -8.403314e-03 3 1  ON 42
ci_044                -9.284704e-03 3 1  ON 43
ci_045                -7.677724e-03 3 1  ON 44
ci_046                 9.399319e-03 3 1  ON 45
ci_047                 9.556395e-03 3 1  ON 46
ci_048                -1.314126e-02 3 1  ON 47
ci_049                -1.324285e-02 3 1  ON 48
ci_050                 7.172522e-03 3 1  ON 49
ci_051                 7.458327e-03 3 1  ON 50
ci_052                -6.253895e-03 3 1  ON 51
ci_053                -6.649332e-03 3 1  ON 52
ci_054                -7.017787e-03 3 1  ON 53
ci_055                -7.141388e-03 3 1  ON 54
ci_056                 8.161816e-03 3 1  ON 55
ci_057                 8.152047e-03 3 1  ON 56
ci_058                -6.052536e-03 3 1  ON 57
ci_059                -6.209902e-03 3 1  ON 58
ci_060                 8.199469e-03 3 1  ON 59
ci_061                 8.429529e-03 3 1  ON 60
ci_062                -6.958795e-03 3 1  ON 61
ci_063                -6.811529e-03 3 1  ON 62
ci_064                -5.902805e-03 3 1  ON 63
ci_065                -6.407960e-03 3 1  ON 64
ci_066                 6.910681e-03 3 1  ON 65
ci_067                 6.946987e-03 3 1  ON 66
ci_068                -6.905704e-03 3 1  ON 67
ci_069                -6.945488e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.268869
====================================================
  Execution time = 1.3924e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2715e-01
  Total weights = 1.955853240e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611977497
                                         uncertainty =       0.001970207462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311611977497
                                         uncertainty =       0.001970207462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394697708
  error estimate for blocks of size 2^( 2) =       0.000404912540
  error estimate for blocks of size 2^( 3) =       0.000413438401
  error estimate for blocks of size 2^( 4) =       0.000419334971
  error estimate for blocks of size 2^( 5) =       0.000423246719
  error estimate for blocks of size 2^( 6) =       0.000424897643
  error estimate for blocks of size 2^( 7) =       0.000425618354

      target function =      -0.868196024544
              le_mean =     -17.213859796405
             les_mean =     296.644117518656
             stat err =       0.000423274422
             autocorr =       1.150045020386
   target nu stat err =       0.000423274422
   target dn stat err =       0.003055979895
      target stat err =       0.003627509238
              std dev =       0.558186851036
             le_variance =       0.311572560669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721385979641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868210687162       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874507799470       residual = 8.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875658796634       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876007225495       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876053276843       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876061225442       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876062295470       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876062861728       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876062962248       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876062896239       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876062869375       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876062868975       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.930076e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868210687162       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870100867245       residual = 8.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870432325784       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870527101883       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870539084075       residual = 5.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870541079013       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870541325652       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870541464065       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870541486542       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870541470234       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870541463876       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870541463954       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 8.529252e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868210687162       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.868707992365       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868794007474       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.868818155390       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.868821166352       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.868821663167       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.868821722611       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.868821756763       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.868821762144       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.868821758126       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.868821756571       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.868821756607       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 2.222738e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6427e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -5.087235e-02 3 1  ON 0
ci_002                -3.876029e-02 3 1  ON 1
ci_003                -3.003798e-02 3 1  ON 2
ci_004                 2.803835e-02 3 1  ON 3
ci_005                 2.848447e-02 3 1  ON 4
ci_006                -2.584189e-02 3 1  ON 5
ci_007                -2.581547e-02 3 1  ON 6
ci_008                -1.677142e-02 3 1  ON 7
ci_009                -2.032263e-02 3 1  ON 8
ci_010                -1.736171e-02 3 1  ON 9
ci_011                -1.713768e-02 3 1  ON 10
ci_012                -1.703907e-02 3 1  ON 11
ci_013                -2.288883e-02 3 1  ON 12
ci_014                 1.744420e-02 3 1  ON 13
ci_015                 1.734263e-02 3 1  ON 14
ci_016                 1.990145e-02 3 1  ON 15
ci_017                 2.004947e-02 3 1  ON 16
ci_018                 1.570531e-02 3 1  ON 17
ci_019                 1.563524e-02 3 1  ON 18
ci_020                 1.952660e-02 3 1  ON 19
ci_021                 1.936443e-02 3 1  ON 20
ci_022                 1.382751e-02 3 1  ON 21
ci_023                 1.369561e-02 3 1  ON 22
ci_024                 1.475235e-02 3 1  ON 23
ci_025                 1.512794e-02 3 1  ON 24
ci_026                 1.494675e-02 3 1  ON 25
ci_027                 1.501067e-02 3 1  ON 26
ci_028                -1.743112e-02 3 1  ON 27
ci_029                -1.763759e-02 3 1  ON 28
ci_030                -1.318620e-02 3 1  ON 29
ci_031                -1.318415e-02 3 1  ON 30
ci_032                -1.643964e-02 3 1  ON 31
ci_033                 1.097638e-02 3 1  ON 32
ci_034                 1.089111e-02 3 1  ON 33
ci_035                -9.407477e-03 3 1  ON 34
ci_036                -1.484076e-02 3 1  ON 35
ci_037                -1.455113e-02 3 1  ON 36
ci_038                 7.392352e-03 3 1  ON 37
ci_039                 7.668505e-03 3 1  ON 38
ci_040                -7.557304e-03 3 1  ON 39
ci_041                 1.130226e-02 3 1  ON 40
ci_042                 1.159109e-02 3 1  ON 41
ci_043                -7.973919e-03 3 1  ON 42
ci_044                -8.971914e-03 3 1  ON 43
ci_045                -7.295643e-03 3 1  ON 44
ci_046                 9.041338e-03 3 1  ON 45
ci_047                 9.209985e-03 3 1  ON 46
ci_048                -1.303176e-02 3 1  ON 47
ci_049                -1.320634e-02 3 1  ON 48
ci_050                 6.848149e-03 3 1  ON 49
ci_051                 7.147896e-03 3 1  ON 50
ci_052                -6.002906e-03 3 1  ON 51
ci_053                -6.350317e-03 3 1  ON 52
ci_054                -6.717874e-03 3 1  ON 53
ci_055                -6.835738e-03 3 1  ON 54
ci_056                 7.946160e-03 3 1  ON 55
ci_057                 7.918947e-03 3 1  ON 56
ci_058                -5.735806e-03 3 1  ON 57
ci_059                -5.842749e-03 3 1  ON 58
ci_060                 8.031652e-03 3 1  ON 59
ci_061                 8.160782e-03 3 1  ON 60
ci_062                -6.678503e-03 3 1  ON 61
ci_063                -6.520374e-03 3 1  ON 62
ci_064                -5.631570e-03 3 1  ON 63
ci_065                -6.183860e-03 3 1  ON 64
ci_066                 6.729288e-03 3 1  ON 65
ci_067                 6.749510e-03 3 1  ON 66
ci_068                -6.673367e-03 3 1  ON 67
ci_069                -6.701988e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1906
    reference variance = 0.222999
====================================================
  Execution time = 1.3668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2178e-01
  Total weights = 1.9562e+06
  Execution time = 1.8529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312355536295
                                         uncertainty =       0.002258119340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312355536295
                                         uncertainty =       0.002258119340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395165267
  error estimate for blocks of size 2^( 2) =       0.000405205829
  error estimate for blocks of size 2^( 3) =       0.000414530990
  error estimate for blocks of size 2^( 4) =       0.000421127472
  error estimate for blocks of size 2^( 5) =       0.000424671199
  error estimate for blocks of size 2^( 6) =       0.000426484790
  error estimate for blocks of size 2^( 7) =       0.000427591696

      target function =      -0.867537136254
              le_mean =     -17.214111045643
             les_mean =     296.653366606300
             stat err =       0.000424968789
             autocorr =       1.156529033186
   target nu stat err =       0.000424968789
   target dn stat err =       0.002693701649
      target stat err =       0.003205704283
              std dev =       0.558848080539
             le_variance =       0.312311177123

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0117518
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301230149897
                                         uncertainty =       0.002224051341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301230149897
                                         uncertainty =       0.002224051341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388058958
  error estimate for blocks of size 2^( 2) =       0.000398056736
  error estimate for blocks of size 2^( 3) =       0.000407450604
  error estimate for blocks of size 2^( 4) =       0.000414076051
  error estimate for blocks of size 2^( 5) =       0.000417618045
  error estimate for blocks of size 2^( 6) =       0.000419367074
  error estimate for blocks of size 2^( 7) =       0.000420452713

      target function =      -0.822660333913
              le_mean =     -17.214205947592
             les_mean =     296.695953380906
             stat err =       0.000417878471
             autocorr =       1.159590282221
   target nu stat err =       0.000417878471
   target dn stat err =       0.029527116018
      target stat err =       0.031141424469
              std dev =       0.548798241118
             le_variance =       0.301179509454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304702766151
                                         uncertainty =       0.002138693655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304702766151
                                         uncertainty =       0.002138693655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390292500
  error estimate for blocks of size 2^( 2) =       0.000400305346
  error estimate for blocks of size 2^( 3) =       0.000409652492
  error estimate for blocks of size 2^( 4) =       0.000416283988
  error estimate for blocks of size 2^( 5) =       0.000419848766
  error estimate for blocks of size 2^( 6) =       0.000421622565
  error estimate for blocks of size 2^( 7) =       0.000422675321

      target function =      -0.671438435705
              le_mean =     -17.214097805183
             les_mean =     296.833169538158
             stat err =       0.000420107660
             autocorr =       1.158619380292
   target nu stat err =       0.000420107660
   target dn stat err =       0.182577671369
      target stat err =       0.133075525461
              std dev =       0.551956946856
             le_variance =       0.304656471182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313358812865
                                         uncertainty =       0.002951676960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313358812865
                                         uncertainty =       0.002951676960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395797971
  error estimate for blocks of size 2^( 2) =       0.000405763995
  error estimate for blocks of size 2^( 3) =       0.000415017987
  error estimate for blocks of size 2^( 4) =       0.000421675741
  error estimate for blocks of size 2^( 5) =       0.000425200838
  error estimate for blocks of size 2^( 6) =       0.000426927043
  error estimate for blocks of size 2^( 7) =       0.000427916214

      target function =      -0.354317679477
              le_mean =     -17.214130784972
             les_mean =     297.372700122209
             stat err =       0.000425429959
             autocorr =       1.155337877496
   target nu stat err =       0.000425429959
   target dn stat err =       0.719657793393
      target stat err =       0.174701591429
              std dev =       0.559742859149
             le_variance =       0.313312068368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.867537136254        initial  <--
     2.5000e-01     2.5000e+00             2.9301e-03        -0.822660333913
     1.0000e+00     1.0000e+01             8.5293e-04        -0.671438435705
     4.0000e+00     4.0000e+01             2.2227e-04        -0.354317679477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9815
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -5.172528e-02 3 1  ON 0
ci_002                -3.938869e-02 3 1  ON 1
ci_003                -3.043418e-02 3 1  ON 2
ci_004                 2.851676e-02 3 1  ON 3
ci_005                 2.888609e-02 3 1  ON 4
ci_006                -2.631173e-02 3 1  ON 5
ci_007                -2.636733e-02 3 1  ON 6
ci_008                -1.746125e-02 3 1  ON 7
ci_009                -2.082541e-02 3 1  ON 8
ci_010                -1.786492e-02 3 1  ON 9
ci_011                -1.768918e-02 3 1  ON 10
ci_012                -1.770730e-02 3 1  ON 11
ci_013                -2.315552e-02 3 1  ON 12
ci_014                 1.792895e-02 3 1  ON 13
ci_015                 1.787495e-02 3 1  ON 14
ci_016                 2.018606e-02 3 1  ON 15
ci_017                 2.035332e-02 3 1  ON 16
ci_018                 1.613832e-02 3 1  ON 17
ci_019                 1.610269e-02 3 1  ON 18
ci_020                 1.981007e-02 3 1  ON 19
ci_021                 1.956718e-02 3 1  ON 20
ci_022                 1.426630e-02 3 1  ON 21
ci_023                 1.411786e-02 3 1  ON 22
ci_024                 1.514720e-02 3 1  ON 23
ci_025                 1.546678e-02 3 1  ON 24
ci_026                 1.529574e-02 3 1  ON 25
ci_027                 1.541931e-02 3 1  ON 26
ci_028                -1.763196e-02 3 1  ON 27
ci_029                -1.790178e-02 3 1  ON 28
ci_030                -1.357842e-02 3 1  ON 29
ci_031                -1.346232e-02 3 1  ON 30
ci_032                -1.653944e-02 3 1  ON 31
ci_033                 1.130058e-02 3 1  ON 32
ci_034                 1.124005e-02 3 1  ON 33
ci_035                -9.876463e-03 3 1  ON 34
ci_036                -1.508834e-02 3 1  ON 35
ci_037                -1.469277e-02 3 1  ON 36
ci_038                 7.894938e-03 3 1  ON 37
ci_039                 8.115793e-03 3 1  ON 38
ci_040                -8.000017e-03 3 1  ON 39
ci_041                 1.161938e-02 3 1  ON 40
ci_042                 1.186340e-02 3 1  ON 41
ci_043                -8.403314e-03 3 1  ON 42
ci_044                -9.284704e-03 3 1  ON 43
ci_045                -7.677724e-03 3 1  ON 44
ci_046                 9.399319e-03 3 1  ON 45
ci_047                 9.556395e-03 3 1  ON 46
ci_048                -1.314126e-02 3 1  ON 47
ci_049                -1.324285e-02 3 1  ON 48
ci_050                 7.172522e-03 3 1  ON 49
ci_051                 7.458327e-03 3 1  ON 50
ci_052                -6.253895e-03 3 1  ON 51
ci_053                -6.649332e-03 3 1  ON 52
ci_054                -7.017787e-03 3 1  ON 53
ci_055                -7.141388e-03 3 1  ON 54
ci_056                 8.161816e-03 3 1  ON 55
ci_057                 8.152047e-03 3 1  ON 56
ci_058                -6.052536e-03 3 1  ON 57
ci_059                -6.209902e-03 3 1  ON 58
ci_060                 8.199469e-03 3 1  ON 59
ci_061                 8.429529e-03 3 1  ON 60
ci_062                -6.958795e-03 3 1  ON 61
ci_063                -6.811529e-03 3 1  ON 62
ci_064                -5.902805e-03 3 1  ON 63
ci_065                -6.407960e-03 3 1  ON 64
ci_066                 6.910681e-03 3 1  ON 65
ci_067                 6.946987e-03 3 1  ON 66
ci_068                -6.905704e-03 3 1  ON 67
ci_069                -6.945488e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9542e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.27
    reference variance = 0.745608
====================================================
  Execution time = 1.3871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.3067e-01
  Total weights = 1.955907974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314284246643
                                         uncertainty =       0.002356636223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314284246643
                                         uncertainty =       0.002356636223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396411701
  error estimate for blocks of size 2^( 2) =       0.000406459484
  error estimate for blocks of size 2^( 3) =       0.000415102530
  error estimate for blocks of size 2^( 4) =       0.000421686646
  error estimate for blocks of size 2^( 5) =       0.000424322984
  error estimate for blocks of size 2^( 6) =       0.000426581090
  error estimate for blocks of size 2^( 7) =       0.000427029371

      target function =      -0.864030062047
              le_mean =     -17.213482743148
             les_mean =     296.634660529758
             stat err =       0.000424905023
             autocorr =       1.148922670753
   target nu stat err =       0.000424905023
   target dn stat err =       0.002907449382
      target stat err =       0.003421405202
              std dev =       0.560610803768
             le_variance =       0.314284473301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721348274315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864042883491       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864876174540       residual = 8.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.865016550034       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.865054709107       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.865059400059       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.865060786941       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.865060872294       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.865060875345       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.865060907772       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.865060894275       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.865060898942       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.865060899673       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.510716e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864042883491       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864255572808       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.864291195769       residual = 2.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.864300800903       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.864301976078       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.864302320444       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.864302342684       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.864302342824       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.864302350976       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.864302347605       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.864302348760       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.864302348939       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 8.924560e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.864042883491       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.864096335610       residual = 8.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.864105274861       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.864107680142       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.864107974069       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.864108060003       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.864108065620       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.864108065617       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.864108067657       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.864108066815       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.864108067102       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.864108067147       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.240557e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6405e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -5.163603e-02 3 1  ON 0
ci_002                -3.931530e-02 3 1  ON 1
ci_003                -3.039877e-02 3 1  ON 2
ci_004                 2.846266e-02 3 1  ON 3
ci_005                 2.883423e-02 3 1  ON 4
ci_006                -2.625824e-02 3 1  ON 5
ci_007                -2.631635e-02 3 1  ON 6
ci_008                -1.738709e-02 3 1  ON 7
ci_009                -2.077676e-02 3 1  ON 8
ci_010                -1.779435e-02 3 1  ON 9
ci_011                -1.762557e-02 3 1  ON 10
ci_012                -1.762989e-02 3 1  ON 11
ci_013                -2.313073e-02 3 1  ON 12
ci_014                 1.787325e-02 3 1  ON 13
ci_015                 1.782813e-02 3 1  ON 14
ci_016                 2.016257e-02 3 1  ON 15
ci_017                 2.031811e-02 3 1  ON 16
ci_018                 1.608431e-02 3 1  ON 17
ci_019                 1.604891e-02 3 1  ON 18
ci_020                 1.978026e-02 3 1  ON 19
ci_021                 1.953771e-02 3 1  ON 20
ci_022                 1.422592e-02 3 1  ON 21
ci_023                 1.407552e-02 3 1  ON 22
ci_024                 1.510324e-02 3 1  ON 23
ci_025                 1.542884e-02 3 1  ON 24
ci_026                 1.525234e-02 3 1  ON 25
ci_027                 1.538563e-02 3 1  ON 26
ci_028                -1.760605e-02 3 1  ON 27
ci_029                -1.787615e-02 3 1  ON 28
ci_030                -1.353087e-02 3 1  ON 29
ci_031                -1.343297e-02 3 1  ON 30
ci_032                -1.653213e-02 3 1  ON 31
ci_033                 1.125778e-02 3 1  ON 32
ci_034                 1.119849e-02 3 1  ON 33
ci_035                -9.821782e-03 3 1  ON 34
ci_036                -1.505862e-02 3 1  ON 35
ci_037                -1.467055e-02 3 1  ON 36
ci_038                 7.843644e-03 3 1  ON 37
ci_039                 8.061884e-03 3 1  ON 38
ci_040                -7.956278e-03 3 1  ON 39
ci_041                 1.158982e-02 3 1  ON 40
ci_042                 1.183283e-02 3 1  ON 41
ci_043                -8.359039e-03 3 1  ON 42
ci_044                -9.255305e-03 3 1  ON 43
ci_045                -7.634451e-03 3 1  ON 44
ci_046                 9.369407e-03 3 1  ON 45
ci_047                 9.522148e-03 3 1  ON 46
ci_048                -1.313731e-02 3 1  ON 47
ci_049                -1.324102e-02 3 1  ON 48
ci_050                 7.138428e-03 3 1  ON 49
ci_051                 7.423912e-03 3 1  ON 50
ci_052                -6.217098e-03 3 1  ON 51
ci_053                -6.612382e-03 3 1  ON 52
ci_054                -6.980021e-03 3 1  ON 53
ci_055                -7.113883e-03 3 1  ON 54
ci_056                 8.138154e-03 3 1  ON 55
ci_057                 8.124391e-03 3 1  ON 56
ci_058                -6.019646e-03 3 1  ON 57
ci_059                -6.177966e-03 3 1  ON 58
ci_060                 8.180057e-03 3 1  ON 59
ci_061                 8.405372e-03 3 1  ON 60
ci_062                -6.933319e-03 3 1  ON 61
ci_063                -6.793808e-03 3 1  ON 62
ci_064                -5.875486e-03 3 1  ON 63
ci_065                -6.382933e-03 3 1  ON 64
ci_066                 6.890118e-03 3 1  ON 65
ci_067                 6.926484e-03 3 1  ON 66
ci_068                -6.874851e-03 3 1  ON 67
ci_069                -6.925252e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.32149
====================================================
  Execution time = 1.3295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.3092e-01
  Total weights = 1.9559e+06
  Execution time = 1.8397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315206452316
                                         uncertainty =       0.002940529474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315206452316
                                         uncertainty =       0.002940529474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396999187
  error estimate for blocks of size 2^( 2) =       0.000407068558
  error estimate for blocks of size 2^( 3) =       0.000416328545
  error estimate for blocks of size 2^( 4) =       0.000423265165
  error estimate for blocks of size 2^( 5) =       0.000428166487
  error estimate for blocks of size 2^( 6) =       0.000430877641
  error estimate for blocks of size 2^( 7) =       0.000431627208

      target function =      -0.863096885536
              le_mean =     -17.213941737235
             les_mean =     296.651311951149
             stat err =       0.000428484125
             autocorr =       1.164904270366
   target nu stat err =       0.000428484125
   target dn stat err =       0.004361366715
      target stat err =       0.005085866815
              std dev =       0.561441634750
             le_variance =       0.315216709231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313449951002
                                         uncertainty =       0.002922524294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313449951002
                                         uncertainty =       0.002922524294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395892320
  error estimate for blocks of size 2^( 2) =       0.000405947940
  error estimate for blocks of size 2^( 3) =       0.000415213997
  error estimate for blocks of size 2^( 4) =       0.000422155607
  error estimate for blocks of size 2^( 5) =       0.000427063085
  error estimate for blocks of size 2^( 6) =       0.000429770952
  error estimate for blocks of size 2^( 7) =       0.000430538418

      target function =      -0.865301349080
              le_mean =     -17.213948716015
             les_mean =     296.649655627760
             stat err =       0.000427382015
             autocorr =       1.165408903773
   target nu stat err =       0.000427382015
   target dn stat err =       0.004325533256
      target stat err =       0.005070136444
              std dev =       0.559876288234
             le_variance =       0.313461458127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314300640964
                                         uncertainty =       0.002931201689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314300640964
                                         uncertainty =       0.002931201689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396428764
  error estimate for blocks of size 2^( 2) =       0.000406490819
  error estimate for blocks of size 2^( 3) =       0.000415753698
  error estimate for blocks of size 2^( 4) =       0.000422692686
  error estimate for blocks of size 2^( 5) =       0.000427597135
  error estimate for blocks of size 2^( 6) =       0.000430306424
  error estimate for blocks of size 2^( 7) =       0.000431064960

      target function =      -0.864386436610
              le_mean =     -17.213944203168
             les_mean =     296.650286014391
             stat err =       0.000427915301
             autocorr =       1.165159324130
   target nu stat err =       0.000427915301
   target dn stat err =       0.004339801582
      target stat err =       0.005076010248
              std dev =       0.560634934987
             le_variance =       0.314311530328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315091551316
                                         uncertainty =       0.002939343105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315091551316
                                         uncertainty =       0.002939343105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396926874
  error estimate for blocks of size 2^( 2) =       0.000406995282
  error estimate for blocks of size 2^( 3) =       0.000416255608
  error estimate for blocks of size 2^( 4) =       0.000423192468
  error estimate for blocks of size 2^( 5) =       0.000428094114
  error estimate for blocks of size 2^( 6) =       0.000430805169
  error estimate for blocks of size 2^( 7) =       0.000431555820

      target function =      -0.863027522051
              le_mean =     -17.213941887952
             les_mean =     296.651376998329
             stat err =       0.000428411893
             autocorr =       1.164935898023
   target nu stat err =       0.000428411893
   target dn stat err =       0.004364367299
      target stat err =       0.005088498804
              std dev =       0.561339369014
             le_variance =       0.315101887205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.863096885536        initial
     2.5000e+00     2.5000e+01             3.5107e-04        -0.865301349080  <--
     1.0000e+01     1.0000e+02             8.9246e-05        -0.864386436610
     4.0000e+01     4.0000e+02             2.2406e-05        -0.863027522051

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.2585e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -5.137421e-02 3 1  ON 0
ci_002                -3.910040e-02 3 1  ON 1
ci_003                -3.029459e-02 3 1  ON 2
ci_004                 2.830381e-02 3 1  ON 3
ci_005                 2.868211e-02 3 1  ON 4
ci_006                -2.610159e-02 3 1  ON 5
ci_007                -2.616711e-02 3 1  ON 6
ci_008                -1.717112e-02 3 1  ON 7
ci_009                -2.063471e-02 3 1  ON 8
ci_010                -1.758809e-02 3 1  ON 9
ci_011                -1.743978e-02 3 1  ON 10
ci_012                -1.740380e-02 3 1  ON 11
ci_013                -2.305796e-02 3 1  ON 12
ci_014                 1.771045e-02 3 1  ON 13
ci_015                 1.769132e-02 3 1  ON 14
ci_016                 2.009415e-02 3 1  ON 15
ci_017                 2.021531e-02 3 1  ON 16
ci_018                 1.592669e-02 3 1  ON 17
ci_019                 1.589198e-02 3 1  ON 18
ci_020                 1.969275e-02 3 1  ON 19
ci_021                 1.945120e-02 3 1  ON 20
ci_022                 1.410806e-02 3 1  ON 21
ci_023                 1.395196e-02 3 1  ON 22
ci_024                 1.497427e-02 3 1  ON 23
ci_025                 1.531752e-02 3 1  ON 24
ci_026                 1.512547e-02 3 1  ON 25
ci_027                 1.528709e-02 3 1  ON 26
ci_028                -1.753024e-02 3 1  ON 27
ci_029                -1.780125e-02 3 1  ON 28
ci_030                -1.339222e-02 3 1  ON 29
ci_031                -1.334738e-02 3 1  ON 30
ci_032                -1.651078e-02 3 1  ON 31
ci_033                 1.113255e-02 3 1  ON 32
ci_034                 1.107688e-02 3 1  ON 33
ci_035                -9.662261e-03 3 1  ON 34
ci_036                -1.497154e-02 3 1  ON 35
ci_037                -1.460542e-02 3 1  ON 36
ci_038                 7.694079e-03 3 1  ON 37
ci_039                 7.904693e-03 3 1  ON 38
ci_040                -7.828790e-03 3 1  ON 39
ci_041                 1.150366e-02 3 1  ON 40
ci_042                 1.174369e-02 3 1  ON 41
ci_043                -8.229856e-03 3 1  ON 42
ci_044                -9.169463e-03 3 1  ON 43
ci_045                -7.508346e-03 3 1  ON 44
ci_046                 9.281947e-03 3 1  ON 45
ci_047                 9.421993e-03 3 1  ON 46
ci_048                -1.312583e-02 3 1  ON 47
ci_049                -1.323596e-02 3 1  ON 48
ci_050                 7.039239e-03 3 1  ON 49
ci_051                 7.323771e-03 3 1  ON 50
ci_052                -6.110058e-03 3 1  ON 51
ci_053                -6.504830e-03 3 1  ON 52
ci_054                -6.869611e-03 3 1  ON 53
ci_055                -7.033400e-03 3 1  ON 54
ci_056                 8.069049e-03 3 1  ON 55
ci_057                 8.043655e-03 3 1  ON 56
ci_058                -5.924006e-03 3 1  ON 57
ci_059                -6.085085e-03 3 1  ON 58
ci_060                 8.123236e-03 3 1  ON 59
ci_061                 8.334694e-03 3 1  ON 60
ci_062                -6.858728e-03 3 1  ON 61
ci_063                -6.741910e-03 3 1  ON 62
ci_064                -5.795913e-03 3 1  ON 63
ci_065                -6.309987e-03 3 1  ON 64
ci_066                 6.830218e-03 3 1  ON 65
ci_067                 6.866738e-03 3 1  ON 66
ci_068                -6.784878e-03 3 1  ON 67
ci_069                -6.866203e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.173
    reference variance = 0.297833
====================================================
  Execution time = 1.4090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2377e-01
  Total weights = 1.955837240e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310634543985
                                         uncertainty =       0.002010083551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310634543985
                                         uncertainty =       0.002010083551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394091525
  error estimate for blocks of size 2^( 2) =       0.000404386640
  error estimate for blocks of size 2^( 3) =       0.000413348374
  error estimate for blocks of size 2^( 4) =       0.000419704171
  error estimate for blocks of size 2^( 5) =       0.000424099194
  error estimate for blocks of size 2^( 6) =       0.000427116369
  error estimate for blocks of size 2^( 7) =       0.000429057384

      target function =      -0.872236197548
              le_mean =     -17.214242838514
             les_mean =     296.653930785042
             stat err =       0.000424994279
             autocorr =       1.162979279711
   target nu stat err =       0.000424994279
   target dn stat err =       0.002639835068
      target stat err =       0.003177908265
              std dev =       0.557329579818
             le_variance =       0.310616260541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721424283851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872247122511       residual = 5.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875053776889       residual = 7.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875552841481       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875690497672       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875708241469       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875711753887       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875712480267       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875712747380       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875712689764       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875712644183       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875712648461       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875712652141       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.117306e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872247122511       residual = 5.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873007472807       residual = 7.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873139899617       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873175424080       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873179918756       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873180799498       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873180978036       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873181043172       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873181028098       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873181017141       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873181018239       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873181019086       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.982114e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872247122511       residual = 5.14e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.872441255040       residual = 7.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.872474868638       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.872483816134       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872484942514       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872485162656       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872485207013       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872485223165       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872485219358       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872485216653       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872485216928       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872485217135       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 7.582860e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286719 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6623e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -5.107599e-02 3 1  ON 0
ci_002                -3.882558e-02 3 1  ON 1
ci_003                -3.012690e-02 3 1  ON 2
ci_004                 2.814276e-02 3 1  ON 3
ci_005                 2.848320e-02 3 1  ON 4
ci_006                -2.588601e-02 3 1  ON 5
ci_007                -2.596709e-02 3 1  ON 6
ci_008                -1.689850e-02 3 1  ON 7
ci_009                -2.041312e-02 3 1  ON 8
ci_010                -1.735110e-02 3 1  ON 9
ci_011                -1.721755e-02 3 1  ON 10
ci_012                -1.718757e-02 3 1  ON 11
ci_013                -2.297596e-02 3 1  ON 12
ci_014                 1.751376e-02 3 1  ON 13
ci_015                 1.750127e-02 3 1  ON 14
ci_016                 1.998450e-02 3 1  ON 15
ci_017                 2.011212e-02 3 1  ON 16
ci_018                 1.574495e-02 3 1  ON 17
ci_019                 1.569879e-02 3 1  ON 18
ci_020                 1.955575e-02 3 1  ON 19
ci_021                 1.932938e-02 3 1  ON 20
ci_022                 1.393588e-02 3 1  ON 21
ci_023                 1.379541e-02 3 1  ON 22
ci_024                 1.481706e-02 3 1  ON 23
ci_025                 1.512320e-02 3 1  ON 24
ci_026                 1.497197e-02 3 1  ON 25
ci_027                 1.512499e-02 3 1  ON 26
ci_028                -1.745613e-02 3 1  ON 27
ci_029                -1.771312e-02 3 1  ON 28
ci_030                -1.327146e-02 3 1  ON 29
ci_031                -1.322740e-02 3 1  ON 30
ci_032                -1.644735e-02 3 1  ON 31
ci_033                 1.096354e-02 3 1  ON 32
ci_034                 1.088395e-02 3 1  ON 33
ci_035                -9.476646e-03 3 1  ON 34
ci_036                -1.489612e-02 3 1  ON 35
ci_037                -1.452735e-02 3 1  ON 36
ci_038                 7.499398e-03 3 1  ON 37
ci_039                 7.696418e-03 3 1  ON 38
ci_040                -7.619660e-03 3 1  ON 39
ci_041                 1.142881e-02 3 1  ON 40
ci_042                 1.163675e-02 3 1  ON 41
ci_043                -8.052625e-03 3 1  ON 42
ci_044                -9.044623e-03 3 1  ON 43
ci_045                -7.345313e-03 3 1  ON 44
ci_046                 9.167022e-03 3 1  ON 45
ci_047                 9.279369e-03 3 1  ON 46
ci_048                -1.305596e-02 3 1  ON 47
ci_049                -1.320284e-02 3 1  ON 48
ci_050                 6.909264e-03 3 1  ON 49
ci_051                 7.196554e-03 3 1  ON 50
ci_052                -5.974379e-03 3 1  ON 51
ci_053                -6.364129e-03 3 1  ON 52
ci_054                -6.730773e-03 3 1  ON 53
ci_055                -6.911434e-03 3 1  ON 54
ci_056                 7.994243e-03 3 1  ON 55
ci_057                 7.952764e-03 3 1  ON 56
ci_058                -5.821119e-03 3 1  ON 57
ci_059                -5.941726e-03 3 1  ON 58
ci_060                 8.050192e-03 3 1  ON 59
ci_061                 8.226860e-03 3 1  ON 60
ci_062                -6.770272e-03 3 1  ON 61
ci_063                -6.640441e-03 3 1  ON 62
ci_064                -5.695124e-03 3 1  ON 63
ci_065                -6.220037e-03 3 1  ON 64
ci_066                 6.744680e-03 3 1  ON 65
ci_067                 6.767905e-03 3 1  ON 66
ci_068                -6.731243e-03 3 1  ON 67
ci_069                -6.793880e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.504837
====================================================
  Execution time = 1.3410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2501e-01
  Total weights = 1.9559e+06
  Execution time = 1.8381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312008819155
                                         uncertainty =       0.001777455841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312008819155
                                         uncertainty =       0.001777455841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394918429
  error estimate for blocks of size 2^( 2) =       0.000405182695
  error estimate for blocks of size 2^( 3) =       0.000414547930
  error estimate for blocks of size 2^( 4) =       0.000421145533
  error estimate for blocks of size 2^( 5) =       0.000424893119
  error estimate for blocks of size 2^( 6) =       0.000425627875
  error estimate for blocks of size 2^( 7) =       0.000426562858

      target function =      -0.864758686757
              le_mean =     -17.214112825098
             les_mean =     296.655789635662
             stat err =       0.000424557346
             autocorr =       1.155734074399
   target nu stat err =       0.000424557346
   target dn stat err =       0.004624005270
      target stat err =       0.005409879954
              std dev =       0.558498998943
             le_variance =       0.311921131820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310877564047
                                         uncertainty =       0.004974741952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310877564047
                                         uncertainty =       0.004974741952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394205606
  error estimate for blocks of size 2^( 2) =       0.000404429626
  error estimate for blocks of size 2^( 3) =       0.000413687516
  error estimate for blocks of size 2^( 4) =       0.000420285519
  error estimate for blocks of size 2^( 5) =       0.000424116370
  error estimate for blocks of size 2^( 6) =       0.000424826541
  error estimate for blocks of size 2^( 7) =       0.000426060484

      target function =      -0.774846071469
              le_mean =     -17.214220602260
             les_mean =     296.740433873174
             stat err =       0.000423822228
             autocorr =       1.155904273084
   target nu stat err =       0.000423822228
   target dn stat err =       0.066391814961
      target stat err =       0.062426818840
              std dev =       0.557490914180
             le_variance =       0.310796119393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308914611577
                                         uncertainty =       0.001769128285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308914611577
                                         uncertainty =       0.001769128285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392955604
  error estimate for blocks of size 2^( 2) =       0.000403177414
  error estimate for blocks of size 2^( 3) =       0.000412535445
  error estimate for blocks of size 2^( 4) =       0.000419141879
  error estimate for blocks of size 2^( 5) =       0.000422903061
  error estimate for blocks of size 2^( 6) =       0.000423628285
  error estimate for blocks of size 2^( 7) =       0.000424573963

      target function =      -0.849399848672
              le_mean =     -17.214122735766
             les_mean =     296.669223956703
             stat err =       0.000422561797
             autocorr =       1.156361137803
   target nu stat err =       0.000422561797
   target dn stat err =       0.016901459831
      target stat err =       0.018988400409
              std dev =       0.555723144583
             le_variance =       0.308828213425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311590789359
                                         uncertainty =       0.001775385833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311590789359
                                         uncertainty =       0.001775385833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394653817
  error estimate for blocks of size 2^( 2) =       0.000404912077
  error estimate for blocks of size 2^( 3) =       0.000414274633
  error estimate for blocks of size 2^( 4) =       0.000420873658
  error estimate for blocks of size 2^( 5) =       0.000424623385
  error estimate for blocks of size 2^( 6) =       0.000425355523
  error estimate for blocks of size 2^( 7) =       0.000426293879

      target function =      -0.868078539242
              le_mean =     -17.214111739065
             les_mean =     296.652925550732
             stat err =       0.000424286611
             autocorr =       1.155808916458
   target nu stat err =       0.000424286611
   target dn stat err =       0.003054764012
      target stat err =       0.003626768361
              std dev =       0.558124780093
             le_variance =       0.311503270154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.864758686757        initial
     6.2500e-01     6.2500e+00             1.1173e-03        -0.774846071469
     2.5000e+00     2.5000e+01             2.9821e-04        -0.849399848672
     1.0000e+01     1.0000e+02             7.5829e-05        -0.868078539242  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2673e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -5.129838e-02 3 1  ON 0
ci_002                -3.903043e-02 3 1  ON 1
ci_003                -3.025198e-02 3 1  ON 2
ci_004                 2.826288e-02 3 1  ON 3
ci_005                 2.863156e-02 3 1  ON 4
ci_006                -2.604671e-02 3 1  ON 5
ci_007                -2.611618e-02 3 1  ON 6
ci_008                -1.710143e-02 3 1  ON 7
ci_009                -2.057816e-02 3 1  ON 8
ci_010                -1.752766e-02 3 1  ON 9
ci_011                -1.738310e-02 3 1  ON 10
ci_012                -1.734865e-02 3 1  ON 11
ci_013                -2.303710e-02 3 1  ON 12
ci_014                 1.766028e-02 3 1  ON 13
ci_015                 1.764287e-02 3 1  ON 14
ci_016                 2.006615e-02 3 1  ON 15
ci_017                 2.018895e-02 3 1  ON 16
ci_018                 1.588030e-02 3 1  ON 17
ci_019                 1.584268e-02 3 1  ON 18
ci_020                 1.965792e-02 3 1  ON 19
ci_021                 1.942025e-02 3 1  ON 20
ci_022                 1.406411e-02 3 1  ON 21
ci_023                 1.391199e-02 3 1  ON 22
ci_024                 1.493431e-02 3 1  ON 23
ci_025                 1.526810e-02 3 1  ON 24
ci_026                 1.508631e-02 3 1  ON 25
ci_027                 1.524576e-02 3 1  ON 26
ci_028                -1.751131e-02 3 1  ON 27
ci_029                -1.777878e-02 3 1  ON 28
ci_030                -1.336141e-02 3 1  ON 29
ci_031                -1.331675e-02 3 1  ON 30
ci_032                -1.649462e-02 3 1  ON 31
ci_033                 1.108949e-02 3 1  ON 32
ci_034                 1.102772e-02 3 1  ON 33
ci_035                -9.614869e-03 3 1  ON 34
ci_036                -1.495239e-02 3 1  ON 35
ci_037                -1.458560e-02 3 1  ON 36
ci_038                 7.644353e-03 3 1  ON 37
ci_039                 7.851493e-03 3 1  ON 38
ci_040                -7.775342e-03 3 1  ON 39
ci_041                 1.148453e-02 3 1  ON 40
ci_042                 1.171637e-02 3 1  ON 41
ci_043                -8.184613e-03 3 1  ON 42
ci_044                -9.137615e-03 3 1  ON 43
ci_045                -7.466691e-03 3 1  ON 44
ci_046                 9.252659e-03 3 1  ON 45
ci_047                 9.385640e-03 3 1  ON 46
ci_048                -1.310799e-02 3 1  ON 47
ci_049                -1.322747e-02 3 1  ON 48
ci_050                 7.005998e-03 3 1  ON 49
ci_051                 7.291237e-03 3 1  ON 50
ci_052                -6.075347e-03 3 1  ON 51
ci_053                -6.468831e-03 3 1  ON 52
ci_054                -6.834212e-03 3 1  ON 53
ci_055                -7.002302e-03 3 1  ON 54
ci_056                 8.049956e-03 3 1  ON 55
ci_057                 8.020466e-03 3 1  ON 56
ci_058                -5.897660e-03 3 1  ON 57
ci_059                -6.048402e-03 3 1  ON 58
ci_060                 8.104635e-03 3 1  ON 59
ci_061                 8.307215e-03 3 1  ON 60
ci_062                -6.836196e-03 3 1  ON 61
ci_063                -6.716076e-03 3 1  ON 62
ci_064                -5.770144e-03 3 1  ON 63
ci_065                -6.287007e-03 3 1  ON 64
ci_066                 6.808355e-03 3 1  ON 65
ci_067                 6.841477e-03 3 1  ON 66
ci_068                -6.771183e-03 3 1  ON 67
ci_069                -6.847728e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1795
    reference variance = 0.230552
====================================================
  Execution time = 1.3626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2722e-01
  Total weights = 1.956175065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313904459186
                                         uncertainty =       0.002146114776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313904459186
                                         uncertainty =       0.002146114776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396158297
  error estimate for blocks of size 2^( 2) =       0.000406300043
  error estimate for blocks of size 2^( 3) =       0.000415877047
  error estimate for blocks of size 2^( 4) =       0.000421964285
  error estimate for blocks of size 2^( 5) =       0.000424836147
  error estimate for blocks of size 2^( 6) =       0.000427510169
  error estimate for blocks of size 2^( 7) =       0.000428793601

      target function =      -0.868086733001
              le_mean =     -17.213667678829
             les_mean =     296.637575372305
             stat err =       0.000425776051
             autocorr =       1.155114265283
   target nu stat err =       0.000425776051
   target dn stat err =       0.002484334882
      target stat err =       0.002966689212
              std dev =       0.560252436181
             le_variance =       0.313882792247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721366767883e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868096066012       residual = 4.96e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.868852536433       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868972178084       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869004171062       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869008090038       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869009124180       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869009431897       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869009473051       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869009469639       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869009470758       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869009471544       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869009473791       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.155494e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868096066012       residual = 4.96e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.868289166292       residual = 6.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868319530645       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.868327586299       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.868328569384       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.868328827898       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.868328904676       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.868328914743       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.868328913871       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.868328914166       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.868328914358       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.868328914909       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 8.024551e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.868096066012       residual = 4.96e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.868144596332       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.868152216187       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.868154233626       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.868154479594       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.868154544216       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.868154563399       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.868154565901       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.868154565682       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.868154565757       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.868154565805       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.868154565942       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.014799e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6128e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -5.121813e-02 3 1  ON 0
ci_002                -3.896372e-02 3 1  ON 1
ci_003                -3.021493e-02 3 1  ON 2
ci_004                 2.822735e-02 3 1  ON 3
ci_005                 2.858825e-02 3 1  ON 4
ci_006                -2.599162e-02 3 1  ON 5
ci_007                -2.606723e-02 3 1  ON 6
ci_008                -1.702842e-02 3 1  ON 7
ci_009                -2.052405e-02 3 1  ON 8
ci_010                -1.746638e-02 3 1  ON 9
ci_011                -1.732704e-02 3 1  ON 10
ci_012                -1.727703e-02 3 1  ON 11
ci_013                -2.301158e-02 3 1  ON 12
ci_014                 1.761359e-02 3 1  ON 13
ci_015                 1.759123e-02 3 1  ON 14
ci_016                 2.003652e-02 3 1  ON 15
ci_017                 2.015534e-02 3 1  ON 16
ci_018                 1.583333e-02 3 1  ON 17
ci_019                 1.579453e-02 3 1  ON 18
ci_020                 1.963042e-02 3 1  ON 19
ci_021                 1.938728e-02 3 1  ON 20
ci_022                 1.402100e-02 3 1  ON 21
ci_023                 1.387479e-02 3 1  ON 22
ci_024                 1.488995e-02 3 1  ON 23
ci_025                 1.522923e-02 3 1  ON 24
ci_026                 1.503918e-02 3 1  ON 25
ci_027                 1.520024e-02 3 1  ON 26
ci_028                -1.749770e-02 3 1  ON 27
ci_029                -1.775814e-02 3 1  ON 28
ci_030                -1.332881e-02 3 1  ON 29
ci_031                -1.327895e-02 3 1  ON 30
ci_032                -1.648072e-02 3 1  ON 31
ci_033                 1.104235e-02 3 1  ON 32
ci_034                 1.099745e-02 3 1  ON 33
ci_035                -9.569546e-03 3 1  ON 34
ci_036                -1.493080e-02 3 1  ON 35
ci_037                -1.455977e-02 3 1  ON 36
ci_038                 7.594780e-03 3 1  ON 37
ci_039                 7.798587e-03 3 1  ON 38
ci_040                -7.725942e-03 3 1  ON 39
ci_041                 1.145821e-02 3 1  ON 40
ci_042                 1.169199e-02 3 1  ON 41
ci_043                -8.138408e-03 3 1  ON 42
ci_044                -9.103806e-03 3 1  ON 43
ci_045                -7.421511e-03 3 1  ON 44
ci_046                 9.223128e-03 3 1  ON 45
ci_047                 9.355656e-03 3 1  ON 46
ci_048                -1.310063e-02 3 1  ON 47
ci_049                -1.321241e-02 3 1  ON 48
ci_050                 6.978572e-03 3 1  ON 49
ci_051                 7.264056e-03 3 1  ON 50
ci_052                -6.046985e-03 3 1  ON 51
ci_053                -6.436817e-03 3 1  ON 52
ci_054                -6.805541e-03 3 1  ON 53
ci_055                -6.974823e-03 3 1  ON 54
ci_056                 8.020366e-03 3 1  ON 55
ci_057                 7.996034e-03 3 1  ON 56
ci_058                -5.869495e-03 3 1  ON 57
ci_059                -6.012594e-03 3 1  ON 58
ci_060                 8.073719e-03 3 1  ON 59
ci_061                 8.283085e-03 3 1  ON 60
ci_062                -6.808171e-03 3 1  ON 61
ci_063                -6.687733e-03 3 1  ON 62
ci_064                -5.742874e-03 3 1  ON 63
ci_065                -6.268883e-03 3 1  ON 64
ci_066                 6.789344e-03 3 1  ON 65
ci_067                 6.826555e-03 3 1  ON 66
ci_068                -6.758019e-03 3 1  ON 67
ci_069                -6.829130e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1322
    reference variance = 0.174539
====================================================
  Execution time = 1.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2190e-01
  Total weights = 1.9561e+06
  Execution time = 1.8446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308051468345
                                         uncertainty =       0.001837788771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308051468345
                                         uncertainty =       0.001837788771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392427747
  error estimate for blocks of size 2^( 2) =       0.000402690818
  error estimate for blocks of size 2^( 3) =       0.000411715468
  error estimate for blocks of size 2^( 4) =       0.000417753383
  error estimate for blocks of size 2^( 5) =       0.000422210457
  error estimate for blocks of size 2^( 6) =       0.000424504813
  error estimate for blocks of size 2^( 7) =       0.000426000287

      target function =      -0.873777829977
              le_mean =     -17.213263797395
             les_mean =     296.618783584513
             stat err =       0.000422617235
             autocorr =       1.159778342455
   target nu stat err =       0.000422617235
   target dn stat err =       0.002963762260
      target stat err =       0.003562172872
              std dev =       0.554976641894
             le_variance =       0.307999073048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306572790840
                                         uncertainty =       0.001836177237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306572790840
                                         uncertainty =       0.001836177237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391484442
  error estimate for blocks of size 2^( 2) =       0.000401735614
  error estimate for blocks of size 2^( 3) =       0.000410765775
  error estimate for blocks of size 2^( 4) =       0.000416810299
  error estimate for blocks of size 2^( 5) =       0.000421275114
  error estimate for blocks of size 2^( 6) =       0.000423598157
  error estimate for blocks of size 2^( 7) =       0.000425095655

      target function =      -0.872848859427
              le_mean =     -17.213273477777
             les_mean =     296.619896684947
             stat err =       0.000421694806
             autocorr =       1.160292511347
   target nu stat err =       0.000421694806
   target dn stat err =       0.003585766522
      target stat err =       0.004282906718
              std dev =       0.553642607671
             le_variance =       0.306520137029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307287857035
                                         uncertainty =       0.001836509224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307287857035
                                         uncertainty =       0.001836509224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391940898
  error estimate for blocks of size 2^( 2) =       0.000402197341
  error estimate for blocks of size 2^( 3) =       0.000411224306
  error estimate for blocks of size 2^( 4) =       0.000417265522
  error estimate for blocks of size 2^( 5) =       0.000421726493
  error estimate for blocks of size 2^( 6) =       0.000424034966
  error estimate for blocks of size 2^( 7) =       0.000425533044

      target function =      -0.874226476396
              le_mean =     -17.213267264626
             les_mean =     296.618524669094
             stat err =       0.000422140006
             autocorr =       1.160037041145
   target nu stat err =       0.000422140006
   target dn stat err =       0.003055129808
      target stat err =       0.003672826255
              std dev =       0.554288133979
             le_variance =       0.307235335470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307954517647
                                         uncertainty =       0.001837579911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307954517647
                                         uncertainty =       0.001837579911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392365969
  error estimate for blocks of size 2^( 2) =       0.000402628158
  error estimate for blocks of size 2^( 3) =       0.000411653067
  error estimate for blocks of size 2^( 4) =       0.000417691332
  error estimate for blocks of size 2^( 5) =       0.000422148954
  error estimate for blocks of size 2^( 6) =       0.000424445273
  error estimate for blocks of size 2^( 7) =       0.000425940497

      target function =      -0.864377729712
              le_mean =     -17.213264056411
             les_mean =     296.626714416896
             stat err =       0.000422556514
             autocorr =       1.159810234503
   target nu stat err =       0.000422556514
   target dn stat err =       0.008664373117
      target stat err =       0.010075080645
              std dev =       0.554889274604
             le_variance =       0.307902107071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.873777829977        initial
     2.5000e+00     2.5000e+01             3.1555e-04        -0.872848859427
     1.0000e+01     1.0000e+02             8.0246e-05        -0.874226476396  <--
     4.0000e+01     4.0000e+02             2.0148e-05        -0.864377729712

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2680e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -5.121813e-02 3 1  ON 0
ci_002                -3.896372e-02 3 1  ON 1
ci_003                -3.021493e-02 3 1  ON 2
ci_004                 2.822735e-02 3 1  ON 3
ci_005                 2.858825e-02 3 1  ON 4
ci_006                -2.599162e-02 3 1  ON 5
ci_007                -2.606723e-02 3 1  ON 6
ci_008                -1.702842e-02 3 1  ON 7
ci_009                -2.052405e-02 3 1  ON 8
ci_010                -1.746638e-02 3 1  ON 9
ci_011                -1.732704e-02 3 1  ON 10
ci_012                -1.727703e-02 3 1  ON 11
ci_013                -2.301158e-02 3 1  ON 12
ci_014                 1.761359e-02 3 1  ON 13
ci_015                 1.759123e-02 3 1  ON 14
ci_016                 2.003652e-02 3 1  ON 15
ci_017                 2.015534e-02 3 1  ON 16
ci_018                 1.583333e-02 3 1  ON 17
ci_019                 1.579453e-02 3 1  ON 18
ci_020                 1.963042e-02 3 1  ON 19
ci_021                 1.938728e-02 3 1  ON 20
ci_022                 1.402100e-02 3 1  ON 21
ci_023                 1.387479e-02 3 1  ON 22
ci_024                 1.488995e-02 3 1  ON 23
ci_025                 1.522923e-02 3 1  ON 24
ci_026                 1.503918e-02 3 1  ON 25
ci_027                 1.520024e-02 3 1  ON 26
ci_028                -1.749770e-02 3 1  ON 27
ci_029                -1.775814e-02 3 1  ON 28
ci_030                -1.332881e-02 3 1  ON 29
ci_031                -1.327895e-02 3 1  ON 30
ci_032                -1.648072e-02 3 1  ON 31
ci_033                 1.104235e-02 3 1  ON 32
ci_034                 1.099745e-02 3 1  ON 33
ci_035                -9.569546e-03 3 1  ON 34
ci_036                -1.493080e-02 3 1  ON 35
ci_037                -1.455977e-02 3 1  ON 36
ci_038                 7.594780e-03 3 1  ON 37
ci_039                 7.798587e-03 3 1  ON 38
ci_040                -7.725942e-03 3 1  ON 39
ci_041                 1.145821e-02 3 1  ON 40
ci_042                 1.169199e-02 3 1  ON 41
ci_043                -8.138408e-03 3 1  ON 42
ci_044                -9.103806e-03 3 1  ON 43
ci_045                -7.421511e-03 3 1  ON 44
ci_046                 9.223128e-03 3 1  ON 45
ci_047                 9.355656e-03 3 1  ON 46
ci_048                -1.310063e-02 3 1  ON 47
ci_049                -1.321241e-02 3 1  ON 48
ci_050                 6.978572e-03 3 1  ON 49
ci_051                 7.264056e-03 3 1  ON 50
ci_052                -6.046985e-03 3 1  ON 51
ci_053                -6.436817e-03 3 1  ON 52
ci_054                -6.805541e-03 3 1  ON 53
ci_055                -6.974823e-03 3 1  ON 54
ci_056                 8.020366e-03 3 1  ON 55
ci_057                 7.996034e-03 3 1  ON 56
ci_058                -5.869495e-03 3 1  ON 57
ci_059                -6.012594e-03 3 1  ON 58
ci_060                 8.073719e-03 3 1  ON 59
ci_061                 8.283085e-03 3 1  ON 60
ci_062                -6.808171e-03 3 1  ON 61
ci_063                -6.687733e-03 3 1  ON 62
ci_064                -5.742874e-03 3 1  ON 63
ci_065                -6.268883e-03 3 1  ON 64
ci_066                 6.789344e-03 3 1  ON 65
ci_067                 6.826555e-03 3 1  ON 66
ci_068                -6.758019e-03 3 1  ON 67
ci_069                -6.829130e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.158661
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2546e-01
  Total weights = 1.956196380e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309248544172
                                         uncertainty =       0.001764355187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309248544172
                                         uncertainty =       0.001764355187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393199821
  error estimate for blocks of size 2^( 2) =       0.000403720550
  error estimate for blocks of size 2^( 3) =       0.000413671111
  error estimate for blocks of size 2^( 4) =       0.000421065713
  error estimate for blocks of size 2^( 5) =       0.000424441793
  error estimate for blocks of size 2^( 6) =       0.000427004651
  error estimate for blocks of size 2^( 7) =       0.000430257962

      target function =      -0.870248228212
              le_mean =     -17.214265993999
             les_mean =     296.656412168686
             stat err =       0.000425692530
             autocorr =       1.172102074727
   target nu stat err =       0.000425692530
   target dn stat err =       0.002922145145
      target stat err =       0.003491628538
              std dev =       0.556068519786
             le_variance =       0.309212198697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426599400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870261579310       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.871032365720       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.871176316279       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871219491933       residual = 5.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871227307121       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871228861463       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871229061020       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871229139178       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871229163402       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871229169010       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871229163930       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871229166278       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871229166657       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.242289e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870261579310       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870458442356       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870494995243       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870505883191       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870507839545       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870508226526       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870508275201       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870508294652       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870508300590       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870508301971       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870508300712       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870508301290       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870508301382       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 8.243286e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.870261579310       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870311062286       residual = 8.98e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870320236355       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870322964162       residual = 5.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870323453370       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870323550003       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870323562094       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870323566950       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870323568427       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870323568771       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870323568457       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870323568601       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.870323568624       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 2.069590e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6485e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -5.113570e-02 3 1  ON 0
ci_002                -3.889926e-02 3 1  ON 1
ci_003                -3.017941e-02 3 1  ON 2
ci_004                 2.817906e-02 3 1  ON 3
ci_005                 2.853874e-02 3 1  ON 4
ci_006                -2.594449e-02 3 1  ON 5
ci_007                -2.601137e-02 3 1  ON 6
ci_008                -1.694890e-02 3 1  ON 7
ci_009                -2.047495e-02 3 1  ON 8
ci_010                -1.740475e-02 3 1  ON 9
ci_011                -1.726832e-02 3 1  ON 10
ci_012                -1.722481e-02 3 1  ON 11
ci_013                -2.299155e-02 3 1  ON 12
ci_014                 1.757044e-02 3 1  ON 13
ci_015                 1.755076e-02 3 1  ON 14
ci_016                 2.000115e-02 3 1  ON 15
ci_017                 2.012547e-02 3 1  ON 16
ci_018                 1.578142e-02 3 1  ON 17
ci_019                 1.574229e-02 3 1  ON 18
ci_020                 1.960132e-02 3 1  ON 19
ci_021                 1.936250e-02 3 1  ON 20
ci_022                 1.397436e-02 3 1  ON 21
ci_023                 1.382918e-02 3 1  ON 22
ci_024                 1.485818e-02 3 1  ON 23
ci_025                 1.518672e-02 3 1  ON 24
ci_026                 1.500244e-02 3 1  ON 25
ci_027                 1.516320e-02 3 1  ON 26
ci_028                -1.746716e-02 3 1  ON 27
ci_029                -1.773714e-02 3 1  ON 28
ci_030                -1.329615e-02 3 1  ON 29
ci_031                -1.324650e-02 3 1  ON 30
ci_032                -1.646750e-02 3 1  ON 31
ci_033                 1.100472e-02 3 1  ON 32
ci_034                 1.095847e-02 3 1  ON 33
ci_035                -9.521225e-03 3 1  ON 34
ci_036                -1.490612e-02 3 1  ON 35
ci_037                -1.454229e-02 3 1  ON 36
ci_038                 7.541448e-03 3 1  ON 37
ci_039                 7.749601e-03 3 1  ON 38
ci_040                -7.674290e-03 3 1  ON 39
ci_041                 1.143351e-02 3 1  ON 40
ci_042                 1.167232e-02 3 1  ON 41
ci_043                -8.096279e-03 3 1  ON 42
ci_044                -9.071248e-03 3 1  ON 43
ci_045                -7.376063e-03 3 1  ON 44
ci_046                 9.190958e-03 3 1  ON 45
ci_047                 9.324100e-03 3 1  ON 46
ci_048                -1.309477e-02 3 1  ON 47
ci_049                -1.320707e-02 3 1  ON 48
ci_050                 6.949824e-03 3 1  ON 49
ci_051                 7.229593e-03 3 1  ON 50
ci_052                -6.011427e-03 3 1  ON 51
ci_053                -6.401934e-03 3 1  ON 52
ci_054                -6.775092e-03 3 1  ON 53
ci_055                -6.941433e-03 3 1  ON 54
ci_056                 7.996038e-03 3 1  ON 55
ci_057                 7.973720e-03 3 1  ON 56
ci_058                -5.840956e-03 3 1  ON 57
ci_059                -5.976846e-03 3 1  ON 58
ci_060                 8.051815e-03 3 1  ON 59
ci_061                 8.262213e-03 3 1  ON 60
ci_062                -6.784561e-03 3 1  ON 61
ci_063                -6.665218e-03 3 1  ON 62
ci_064                -5.715704e-03 3 1  ON 63
ci_065                -6.248872e-03 3 1  ON 64
ci_066                 6.768492e-03 3 1  ON 65
ci_067                 6.803652e-03 3 1  ON 66
ci_068                -6.736779e-03 3 1  ON 67
ci_069                -6.813201e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1332
    reference variance = 0.157366
====================================================
  Execution time = 1.3746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2563e-01
  Total weights = 1.9558e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311222188332
                                         uncertainty =       0.001857285538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311222188332
                                         uncertainty =       0.001857285538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394483834
  error estimate for blocks of size 2^( 2) =       0.000404913818
  error estimate for blocks of size 2^( 3) =       0.000413656213
  error estimate for blocks of size 2^( 4) =       0.000419483013
  error estimate for blocks of size 2^( 5) =       0.000424203451
  error estimate for blocks of size 2^( 6) =       0.000425578829
  error estimate for blocks of size 2^( 7) =       0.000428027081

      target function =      -0.869408032370
              le_mean =     -17.213791383713
             les_mean =     296.640723086492
             stat err =       0.000424323093
             autocorr =       1.157004146474
   target nu stat err =       0.000424323093
   target dn stat err =       0.002724362299
      target stat err =       0.003253035897
              std dev =       0.557884388547
             le_variance =       0.311234990984

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.115503
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309603366723
                                         uncertainty =       0.001823585718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309603366723
                                         uncertainty =       0.001823585718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393456737
  error estimate for blocks of size 2^( 2) =       0.000403876048
  error estimate for blocks of size 2^( 3) =       0.000412619546
  error estimate for blocks of size 2^( 4) =       0.000418452397
  error estimate for blocks of size 2^( 5) =       0.000423181435
  error estimate for blocks of size 2^( 6) =       0.000424565846
  error estimate for blocks of size 2^( 7) =       0.000427012906

      target function =      -0.871436773953
              le_mean =     -17.213790920063
             les_mean =     296.638985066339
             stat err =       0.000423303146
             autocorr =       1.157468072115
   target nu stat err =       0.000423303146
   target dn stat err =       0.002708634264
      target stat err =       0.003249471289
              std dev =       0.556431853830
             le_variance =       0.309616407956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310386249205
                                         uncertainty =       0.001839291354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310386249205
                                         uncertainty =       0.001839291354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393953792
  error estimate for blocks of size 2^( 2) =       0.000404378102
  error estimate for blocks of size 2^( 3) =       0.000413120839
  error estimate for blocks of size 2^( 4) =       0.000418950688
  error estimate for blocks of size 2^( 5) =       0.000423675444
  error estimate for blocks of size 2^( 6) =       0.000425055312
  error estimate for blocks of size 2^( 7) =       0.000427502747

      target function =      -0.870509161556
              le_mean =     -17.213790081137
             les_mean =     296.639742443639
             stat err =       0.000423796048
             autocorr =       1.157239460595
   target nu stat err =       0.000423796048
   target dn stat err =       0.002713952614
      target stat err =       0.003248946685
              std dev =       0.557134795454
             le_variance =       0.310399180305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311116028287
                                         uncertainty =       0.001854925925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311116028287
                                         uncertainty =       0.001854925925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394416561
  error estimate for blocks of size 2^( 2) =       0.000404845804
  error estimate for blocks of size 2^( 3) =       0.000413588213
  error estimate for blocks of size 2^( 4) =       0.000419415390
  error estimate for blocks of size 2^( 5) =       0.000424136363
  error estimate for blocks of size 2^( 6) =       0.000425512289
  error estimate for blocks of size 2^( 7) =       0.000427960410

      target function =      -0.869557192061
              le_mean =     -17.213791095614
             les_mean =     296.640586251761
             stat err =       0.000424256113
             autocorr =       1.157033496722
   target nu stat err =       0.000424256113
   target dn stat err =       0.002722766036
      target stat err =       0.003252269996
              std dev =       0.557789250377
             le_variance =       0.311128847836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.869408032370        initial
     2.5000e+00     2.5000e+01             3.2423e-04        -0.871436773953  <--
     1.0000e+01     1.0000e+02             8.2433e-05        -0.870509161556
     4.0000e+01     4.0000e+02             2.0696e-05        -0.869557192061

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3135e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -5.089390e-02 3 1  ON 0
ci_002                -3.871057e-02 3 1  ON 1
ci_003                -3.007504e-02 3 1  ON 2
ci_004                 2.803733e-02 3 1  ON 3
ci_005                 2.839344e-02 3 1  ON 4
ci_006                -2.580654e-02 3 1  ON 5
ci_007                -2.584780e-02 3 1  ON 6
ci_008                -1.671746e-02 3 1  ON 7
ci_009                -2.033162e-02 3 1  ON 8
ci_010                -1.722472e-02 3 1  ON 9
ci_011                -1.709683e-02 3 1  ON 10
ci_012                -1.707223e-02 3 1  ON 11
ci_013                -2.293273e-02 3 1  ON 12
ci_014                 1.744446e-02 3 1  ON 13
ci_015                 1.743252e-02 3 1  ON 14
ci_016                 1.989785e-02 3 1  ON 15
ci_017                 2.003826e-02 3 1  ON 16
ci_018                 1.563000e-02 3 1  ON 17
ci_019                 1.558997e-02 3 1  ON 18
ci_020                 1.951583e-02 3 1  ON 19
ci_021                 1.928969e-02 3 1  ON 20
ci_022                 1.383823e-02 3 1  ON 21
ci_023                 1.369606e-02 3 1  ON 22
ci_024                 1.476490e-02 3 1  ON 23
ci_025                 1.506202e-02 3 1  ON 24
ci_026                 1.489501e-02 3 1  ON 25
ci_027                 1.505499e-02 3 1  ON 26
ci_028                -1.737785e-02 3 1  ON 27
ci_029                -1.767585e-02 3 1  ON 28
ci_030                -1.320087e-02 3 1  ON 29
ci_031                -1.315189e-02 3 1  ON 30
ci_032                -1.642890e-02 3 1  ON 31
ci_033                 1.089456e-02 3 1  ON 32
ci_034                 1.084442e-02 3 1  ON 33
ci_035                -9.380285e-03 3 1  ON 34
ci_036                -1.483374e-02 3 1  ON 35
ci_037                -1.449086e-02 3 1  ON 36
ci_038                 7.385964e-03 3 1  ON 37
ci_039                 7.606768e-03 3 1  ON 38
ci_040                -7.523832e-03 3 1  ON 39
ci_041                 1.136147e-02 3 1  ON 40
ci_042                 1.161502e-02 3 1  ON 41
ci_043                -7.973376e-03 3 1  ON 42
ci_044                -8.976160e-03 3 1  ON 43
ci_045                -7.243649e-03 3 1  ON 44
ci_046                 9.096912e-03 3 1  ON 45
ci_047                 9.231849e-03 3 1  ON 46
ci_048                -1.307782e-02 3 1  ON 47
ci_049                -1.319156e-02 3 1  ON 48
ci_050                 6.866137e-03 3 1  ON 49
ci_051                 7.129360e-03 3 1  ON 50
ci_052                -5.908049e-03 3 1  ON 51
ci_053                -6.300516e-03 3 1  ON 52
ci_054                -6.686068e-03 3 1  ON 53
ci_055                -6.843838e-03 3 1  ON 54
ci_056                 7.925007e-03 3 1  ON 55
ci_057                 7.908594e-03 3 1  ON 56
ci_058                -5.757949e-03 3 1  ON 57
ci_059                -5.872857e-03 3 1  ON 58
ci_060                 7.987700e-03 3 1  ON 59
ci_061                 8.201173e-03 3 1  ON 60
ci_062                -6.715500e-03 3 1  ON 61
ci_063                -6.599332e-03 3 1  ON 62
ci_064                -5.636591e-03 3 1  ON 63
ci_065                -6.190544e-03 3 1  ON 64
ci_066                 6.707701e-03 3 1  ON 65
ci_067                 6.736890e-03 3 1  ON 66
ci_068                -6.674839e-03 3 1  ON 67
ci_069                -6.766742e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1152
    reference variance = 0.664374
====================================================
  Execution time = 1.6343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2600e-01
  Total weights = 1.956220337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311699898038
                                         uncertainty =       0.002387806889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311699898038
                                         uncertainty =       0.002387806889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394828133
  error estimate for blocks of size 2^( 2) =       0.000404939894
  error estimate for blocks of size 2^( 3) =       0.000413896545
  error estimate for blocks of size 2^( 4) =       0.000420318879
  error estimate for blocks of size 2^( 5) =       0.000424271445
  error estimate for blocks of size 2^( 6) =       0.000425294833
  error estimate for blocks of size 2^( 7) =       0.000427549310

      target function =      -0.869499920126
              le_mean =     -17.213563843817
             les_mean =     296.632778513547
             stat err =       0.000424358617
             autocorr =       1.155180551835
   target nu stat err =       0.000424358617
   target dn stat err =       0.002954616395
      target stat err =       0.003519251272
              std dev =       0.558371301053
             le_variance =       0.311778509839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721356384382e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869513538212       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.872111790003       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.872597032013       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.872715230588       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872730272732       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872734517717       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872734963443       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872735060574       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872735091925       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872735084737       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872735102561       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872735100885       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.124217e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869513538212       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.870217606617       residual = 6.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870346280360       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.870376738907       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.870380572618       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.870381644727       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.870381748606       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.870381770964       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.870381777740       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.870381776095       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.870381780285       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.870381779798       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.999936e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.869513538212       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.869693314331       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869725969620       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.869733638147       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.869734600566       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.869734869028       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.869734894441       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.869734899898       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.869734901519       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.869734901119       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.869734902147       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.869734902021       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 7.627804e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8828e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -5.059391e-02 3 1  ON 0
ci_002                -3.842860e-02 3 1  ON 1
ci_003                -2.991131e-02 3 1  ON 2
ci_004                 2.788777e-02 3 1  ON 3
ci_005                 2.823057e-02 3 1  ON 4
ci_006                -2.562396e-02 3 1  ON 5
ci_007                -2.568232e-02 3 1  ON 6
ci_008                -1.643991e-02 3 1  ON 7
ci_009                -2.015034e-02 3 1  ON 8
ci_010                -1.697817e-02 3 1  ON 9
ci_011                -1.686928e-02 3 1  ON 10
ci_012                -1.685671e-02 3 1  ON 11
ci_013                -2.286744e-02 3 1  ON 12
ci_014                 1.727831e-02 3 1  ON 13
ci_015                 1.724137e-02 3 1  ON 14
ci_016                 1.977210e-02 3 1  ON 15
ci_017                 1.987648e-02 3 1  ON 16
ci_018                 1.542782e-02 3 1  ON 17
ci_019                 1.538870e-02 3 1  ON 18
ci_020                 1.939186e-02 3 1  ON 19
ci_021                 1.920689e-02 3 1  ON 20
ci_022                 1.368353e-02 3 1  ON 21
ci_023                 1.356976e-02 3 1  ON 22
ci_024                 1.463762e-02 3 1  ON 23
ci_025                 1.493320e-02 3 1  ON 24
ci_026                 1.474129e-02 3 1  ON 25
ci_027                 1.492788e-02 3 1  ON 26
ci_028                -1.728113e-02 3 1  ON 27
ci_029                -1.758419e-02 3 1  ON 28
ci_030                -1.306770e-02 3 1  ON 29
ci_031                -1.308282e-02 3 1  ON 30
ci_032                -1.638662e-02 3 1  ON 31
ci_033                 1.072206e-02 3 1  ON 32
ci_034                 1.063011e-02 3 1  ON 33
ci_035                -9.206807e-03 3 1  ON 34
ci_036                -1.476811e-02 3 1  ON 35
ci_037                -1.441701e-02 3 1  ON 36
ci_038                 7.202948e-03 3 1  ON 37
ci_039                 7.420890e-03 3 1  ON 38
ci_040                -7.340099e-03 3 1  ON 39
ci_041                 1.126855e-02 3 1  ON 40
ci_042                 1.152333e-02 3 1  ON 41
ci_043                -7.819388e-03 3 1  ON 42
ci_044                -8.872706e-03 3 1  ON 43
ci_045                -7.088717e-03 3 1  ON 44
ci_046                 8.995738e-03 3 1  ON 45
ci_047                 9.125279e-03 3 1  ON 46
ci_048                -1.302760e-02 3 1  ON 47
ci_049                -1.315664e-02 3 1  ON 48
ci_050                 6.737829e-03 3 1  ON 49
ci_051                 6.973543e-03 3 1  ON 50
ci_052                -5.807800e-03 3 1  ON 51
ci_053                -6.183612e-03 3 1  ON 52
ci_054                -6.532440e-03 3 1  ON 53
ci_055                -6.729037e-03 3 1  ON 54
ci_056                 7.844696e-03 3 1  ON 55
ci_057                 7.826529e-03 3 1  ON 56
ci_058                -5.676656e-03 3 1  ON 57
ci_059                -5.752442e-03 3 1  ON 58
ci_060                 7.908766e-03 3 1  ON 59
ci_061                 8.101373e-03 3 1  ON 60
ci_062                -6.597090e-03 3 1  ON 61
ci_063                -6.487821e-03 3 1  ON 62
ci_064                -5.530180e-03 3 1  ON 63
ci_065                -6.114627e-03 3 1  ON 64
ci_066                 6.628619e-03 3 1  ON 65
ci_067                 6.645796e-03 3 1  ON 66
ci_068                -6.635438e-03 3 1  ON 67
ci_069                -6.679953e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.17348
====================================================
  Execution time = 1.3689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2216e-01
  Total weights = 1.9562e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309950822954
                                         uncertainty =       0.002273867507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309950822954
                                         uncertainty =       0.002273867507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393728525
  error estimate for blocks of size 2^( 2) =       0.000403804152
  error estimate for blocks of size 2^( 3) =       0.000412609304
  error estimate for blocks of size 2^( 4) =       0.000419257204
  error estimate for blocks of size 2^( 5) =       0.000422942764
  error estimate for blocks of size 2^( 6) =       0.000425697841
  error estimate for blocks of size 2^( 7) =       0.000426155690

      target function =      -0.861484628365
              le_mean =     -17.214209303174
             les_mean =     296.661919140282
             stat err =       0.000423513375
             autocorr =       1.157019023689
   target nu stat err =       0.000423513375
   target dn stat err =       0.006569028303
      target stat err =       0.007607399500
              std dev =       0.556816220269
             le_variance =       0.310044303155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304736648396
                                         uncertainty =       0.002189871308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304736648396
                                         uncertainty =       0.002189871308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390403898
  error estimate for blocks of size 2^( 2) =       0.000400456358
  error estimate for blocks of size 2^( 3) =       0.000409309395
  error estimate for blocks of size 2^( 4) =       0.000415989497
  error estimate for blocks of size 2^( 5) =       0.000419699070
  error estimate for blocks of size 2^( 6) =       0.000422502017
  error estimate for blocks of size 2^( 7) =       0.000423041919

      target function =      -0.849055679713
              le_mean =     -17.214230699727
             les_mean =     296.673064911778
             stat err =       0.000420308126
             autocorr =       1.159063639193
   target nu stat err =       0.000420308126
   target dn stat err =       0.020807665276
      target stat err =       0.023364412080
              std dev =       0.552114487585
             le_variance =       0.304830407402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307076097260
                                         uncertainty =       0.002221142396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307076097260
                                         uncertainty =       0.002221142396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391899062
  error estimate for blocks of size 2^( 2) =       0.000401963732
  error estimate for blocks of size 2^( 3) =       0.000410800670
  error estimate for blocks of size 2^( 4) =       0.000417471092
  error estimate for blocks of size 2^( 5) =       0.000421177854
  error estimate for blocks of size 2^( 6) =       0.000423964244
  error estimate for blocks of size 2^( 7) =       0.000424434870

      target function =      -0.530289465635
              le_mean =     -17.214217597871
             les_mean =     297.010092977181
             stat err =       0.000421762015
             autocorr =       1.158207785535
   target nu stat err =       0.000421762015
   target dn stat err =       0.359578780565
      target stat err =       0.174320556801
              std dev =       0.554228968106
             le_variance =       0.307169749088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309559830873
                                         uncertainty =       0.002267023091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309559830873
                                         uncertainty =       0.002267023091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393480209
  error estimate for blocks of size 2^( 2) =       0.000403554582
  error estimate for blocks of size 2^( 3) =       0.000412362337
  error estimate for blocks of size 2^( 4) =       0.000419013296
  error estimate for blocks of size 2^( 5) =       0.000422700318
  error estimate for blocks of size 2^( 6) =       0.000425457529
  error estimate for blocks of size 2^( 7) =       0.000425913645

      target function =      -0.870900081031
              le_mean =     -17.214208103948
             les_mean =     296.653860337458
             stat err =       0.000423271197
             autocorr =       1.157155292785
   target nu stat err =       0.000423271197
   target dn stat err =       0.002669624450
      target stat err =       0.003202326968
              std dev =       0.556465047830
             le_variance =       0.309653349457


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.861484628365        initial
     6.2500e-01     6.2500e+00             1.1242e-03        -0.849055679713
     2.5000e+00     2.5000e+01             2.9999e-04        -0.530289465635
     1.0000e+01     1.0000e+02             7.6278e-05        -0.870900081031  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 2.2968e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -5.081762e-02 3 1  ON 0
ci_002                -3.863879e-02 3 1  ON 1
ci_003                -3.003343e-02 3 1  ON 2
ci_004                 2.799933e-02 3 1  ON 3
ci_005                 2.835203e-02 3 1  ON 4
ci_006                -2.576005e-02 3 1  ON 5
ci_007                -2.580566e-02 3 1  ON 6
ci_008                -1.664651e-02 3 1  ON 7
ci_009                -2.028538e-02 3 1  ON 8
ci_010                -1.716187e-02 3 1  ON 9
ci_011                -1.703880e-02 3 1  ON 10
ci_012                -1.701727e-02 3 1  ON 11
ci_013                -2.291613e-02 3 1  ON 12
ci_014                 1.740208e-02 3 1  ON 13
ci_015                 1.738381e-02 3 1  ON 14
ci_016                 1.986577e-02 3 1  ON 15
ci_017                 1.999702e-02 3 1  ON 16
ci_018                 1.557837e-02 3 1  ON 17
ci_019                 1.553859e-02 3 1  ON 18
ci_020                 1.948433e-02 3 1  ON 19
ci_021                 1.926866e-02 3 1  ON 20
ci_022                 1.379876e-02 3 1  ON 21
ci_023                 1.366382e-02 3 1  ON 22
ci_024                 1.473258e-02 3 1  ON 23
ci_025                 1.502929e-02 3 1  ON 24
ci_026                 1.485580e-02 3 1  ON 25
ci_027                 1.502259e-02 3 1  ON 26
ci_028                -1.735320e-02 3 1  ON 27
ci_029                -1.765248e-02 3 1  ON 28
ci_030                -1.316688e-02 3 1  ON 29
ci_031                -1.313428e-02 3 1  ON 30
ci_032                -1.641812e-02 3 1  ON 31
ci_033                 1.085061e-02 3 1  ON 32
ci_034                 1.078982e-02 3 1  ON 33
ci_035                -9.335991e-03 3 1  ON 34
ci_036                -1.481710e-02 3 1  ON 35
ci_037                -1.447210e-02 3 1  ON 36
ci_038                 7.339216e-03 3 1  ON 37
ci_039                 7.559293e-03 3 1  ON 38
ci_040                -7.476880e-03 3 1  ON 39
ci_041                 1.133774e-02 3 1  ON 40
ci_042                 1.159160e-02 3 1  ON 41
ci_043                -7.934068e-03 3 1  ON 42
ci_044                -8.949767e-03 3 1  ON 43
ci_045                -7.204067e-03 3 1  ON 44
ci_046                 9.071131e-03 3 1  ON 45
ci_047                 9.204687e-03 3 1  ON 46
ci_048                -1.306501e-02 3 1  ON 47
ci_049                -1.318259e-02 3 1  ON 48
ci_050                 6.833321e-03 3 1  ON 49
ci_051                 7.089501e-03 3 1  ON 50
ci_052                -5.882403e-03 3 1  ON 51
ci_053                -6.270617e-03 3 1  ON 52
ci_054                -6.646890e-03 3 1  ON 53
ci_055                -6.814576e-03 3 1  ON 54
ci_056                 7.904510e-03 3 1  ON 55
ci_057                 7.887651e-03 3 1  ON 56
ci_058                -5.737136e-03 3 1  ON 57
ci_059                -5.842043e-03 3 1  ON 58
ci_060                 7.967590e-03 3 1  ON 59
ci_061                 8.175748e-03 3 1  ON 60
ci_062                -6.685329e-03 3 1  ON 61
ci_063                -6.570925e-03 3 1  ON 62
ci_064                -5.609390e-03 3 1  ON 63
ci_065                -6.171147e-03 3 1  ON 64
ci_066                 6.687489e-03 3 1  ON 65
ci_067                 6.713602e-03 3 1  ON 66
ci_068                -6.664760e-03 3 1  ON 67
ci_069                -6.744587e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1925
    reference variance = 0.196449
====================================================
  Execution time = 1.4795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2060e-01
  Total weights = 1.955961315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307621509647
                                         uncertainty =       0.002185526835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307621509647
                                         uncertainty =       0.002185526835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392192159
  error estimate for blocks of size 2^( 2) =       0.000402702858
  error estimate for blocks of size 2^( 3) =       0.000412018740
  error estimate for blocks of size 2^( 4) =       0.000418456880
  error estimate for blocks of size 2^( 5) =       0.000422484423
  error estimate for blocks of size 2^( 6) =       0.000424978546
  error estimate for blocks of size 2^( 7) =       0.000426634570

      target function =      -0.875929312272
              le_mean =     -17.213755809661
             les_mean =     296.633988494426
             stat err =       0.000423138605
             autocorr =       1.164038879072
   target nu stat err =       0.000423138605
   target dn stat err =       0.002366053540
      target stat err =       0.002880863102
              std dev =       0.554643470347
             le_variance =       0.307629379198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721375580966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875938097288       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.876630036313       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876751598079       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876783361018       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876786627742       residual = 5.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876787504760       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876787574367       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876787579684       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876787586961       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876787588074       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876787588460       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876787589463       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.111842e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875938097288       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.876114813049       residual = 6.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876145674139       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876153677490       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876154494920       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876154714164       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876154731356       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876154732462       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876154734285       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876154734550       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876154734651       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876154734898       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 7.914438e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875938097288       residual = 4.83e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875982515524       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.875990260641       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.875992265342       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.875992469731       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.875992524537       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.875992528821       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.875992529083       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.875992529539       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.875992529605       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.875992529630       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.875992529692       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 1.987210e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7282e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -5.073848e-02 3 1  ON 0
ci_002                -3.857568e-02 3 1  ON 1
ci_003                -2.998741e-02 3 1  ON 2
ci_004                 2.795669e-02 3 1  ON 3
ci_005                 2.830904e-02 3 1  ON 4
ci_006                -2.571333e-02 3 1  ON 5
ci_007                -2.575884e-02 3 1  ON 6
ci_008                -1.658130e-02 3 1  ON 7
ci_009                -2.024317e-02 3 1  ON 8
ci_010                -1.710657e-02 3 1  ON 9
ci_011                -1.698427e-02 3 1  ON 10
ci_012                -1.696435e-02 3 1  ON 11
ci_013                -2.288757e-02 3 1  ON 12
ci_014                 1.736304e-02 3 1  ON 13
ci_015                 1.733354e-02 3 1  ON 14
ci_016                 1.983813e-02 3 1  ON 15
ci_017                 1.996190e-02 3 1  ON 16
ci_018                 1.553632e-02 3 1  ON 17
ci_019                 1.549248e-02 3 1  ON 18
ci_020                 1.945881e-02 3 1  ON 19
ci_021                 1.924177e-02 3 1  ON 20
ci_022                 1.375494e-02 3 1  ON 21
ci_023                 1.362433e-02 3 1  ON 22
ci_024                 1.469322e-02 3 1  ON 23
ci_025                 1.499510e-02 3 1  ON 24
ci_026                 1.480911e-02 3 1  ON 25
ci_027                 1.498669e-02 3 1  ON 26
ci_028                -1.732822e-02 3 1  ON 27
ci_029                -1.762505e-02 3 1  ON 28
ci_030                -1.313199e-02 3 1  ON 29
ci_031                -1.310087e-02 3 1  ON 30
ci_032                -1.641140e-02 3 1  ON 31
ci_033                 1.081101e-02 3 1  ON 32
ci_034                 1.074877e-02 3 1  ON 33
ci_035                -9.288724e-03 3 1  ON 34
ci_036                -1.479678e-02 3 1  ON 35
ci_037                -1.445568e-02 3 1  ON 36
ci_038                 7.289288e-03 3 1  ON 37
ci_039                 7.508682e-03 3 1  ON 38
ci_040                -7.433111e-03 3 1  ON 39
ci_041                 1.131214e-02 3 1  ON 40
ci_042                 1.156691e-02 3 1  ON 41
ci_043                -7.892107e-03 3 1  ON 42
ci_044                -8.922711e-03 3 1  ON 43
ci_045                -7.162725e-03 3 1  ON 44
ci_046                 9.037228e-03 3 1  ON 45
ci_047                 9.177983e-03 3 1  ON 46
ci_048                -1.305852e-02 3 1  ON 47
ci_049                -1.317758e-02 3 1  ON 48
ci_050                 6.802274e-03 3 1  ON 49
ci_051                 7.053919e-03 3 1  ON 50
ci_052                -5.856712e-03 3 1  ON 51
ci_053                -6.235492e-03 3 1  ON 52
ci_054                -6.615529e-03 3 1  ON 53
ci_055                -6.782041e-03 3 1  ON 54
ci_056                 7.879796e-03 3 1  ON 55
ci_057                 7.864090e-03 3 1  ON 56
ci_058                -5.711607e-03 3 1  ON 57
ci_059                -5.809310e-03 3 1  ON 58
ci_060                 7.949517e-03 3 1  ON 59
ci_061                 8.157627e-03 3 1  ON 60
ci_062                -6.663226e-03 3 1  ON 61
ci_063                -6.548598e-03 3 1  ON 62
ci_064                -5.580339e-03 3 1  ON 63
ci_065                -6.147511e-03 3 1  ON 64
ci_066                 6.666027e-03 3 1  ON 65
ci_067                 6.695291e-03 3 1  ON 66
ci_068                -6.649758e-03 3 1  ON 67
ci_069                -6.719522e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.181608
====================================================
  Execution time = 1.4369e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.2406e-01
  Total weights = 1.9563e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310621614543
                                         uncertainty =       0.002846251847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310621614543
                                         uncertainty =       0.002846251847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394069939
  error estimate for blocks of size 2^( 2) =       0.000404437841
  error estimate for blocks of size 2^( 3) =       0.000413149837
  error estimate for blocks of size 2^( 4) =       0.000419125939
  error estimate for blocks of size 2^( 5) =       0.000423538411
  error estimate for blocks of size 2^( 6) =       0.000425078412
  error estimate for blocks of size 2^( 7) =       0.000424828022

      target function =      -0.869174182931
              le_mean =     -17.213487100279
             les_mean =     296.630391257614
             stat err =       0.000423142696
             autocorr =       1.152994096841
   target nu stat err =       0.000423142696
   target dn stat err =       0.004198675112
      target stat err =       0.004963016039
              std dev =       0.557299052613
             le_variance =       0.310582234043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309079925162
                                         uncertainty =       0.002772438707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309079925162
                                         uncertainty =       0.002772438707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393091540
  error estimate for blocks of size 2^( 2) =       0.000403450096
  error estimate for blocks of size 2^( 3) =       0.000412166027
  error estimate for blocks of size 2^( 4) =       0.000418154326
  error estimate for blocks of size 2^( 5) =       0.000422573579
  error estimate for blocks of size 2^( 6) =       0.000424125400
  error estimate for blocks of size 2^( 7) =       0.000423857936

      target function =      -0.872941431994
              le_mean =     -17.213489073850
             les_mean =     296.627269445149
             stat err =       0.000422177810
             autocorr =       1.153462316117
   target nu stat err =       0.000422177810
   target dn stat err =       0.003761761375
      target stat err =       0.004492000372
              std dev =       0.555915387624
             le_variance =       0.309041918197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309826829918
                                         uncertainty =       0.002807905243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309826829918
                                         uncertainty =       0.002807905243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393565850
  error estimate for blocks of size 2^( 2) =       0.000403928720
  error estimate for blocks of size 2^( 3) =       0.000412642547
  error estimate for blocks of size 2^( 4) =       0.000418624772
  error estimate for blocks of size 2^( 5) =       0.000423040696
  error estimate for blocks of size 2^( 6) =       0.000424586722
  error estimate for blocks of size 2^( 7) =       0.000424327428

      target function =      -0.872222016666
              le_mean =     -17.213487152779
             les_mean =     296.627810658426
             stat err =       0.000422644904
             autocorr =       1.153231406117
   target nu stat err =       0.000422644904
   target dn stat err =       0.003794016702
      target stat err =       0.004522558343
              std dev =       0.556586162070
             le_variance =       0.309788155807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310520867408
                                         uncertainty =       0.002841359868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310520867408
                                         uncertainty =       0.002841359868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394006076
  error estimate for blocks of size 2^( 2) =       0.000404373230
  error estimate for blocks of size 2^( 3) =       0.000413085432
  error estimate for blocks of size 2^( 4) =       0.000419062499
  error estimate for blocks of size 2^( 5) =       0.000423475220
  error estimate for blocks of size 2^( 6) =       0.000425015931
  error estimate for blocks of size 2^( 7) =       0.000424764033

      target function =      -0.870000883841
              le_mean =     -17.213487055803
             les_mean =     296.629688357994
             stat err =       0.000423079421
             autocorr =       1.153022981227
   target nu stat err =       0.000423079421
   target dn stat err =       0.004011928467
      target stat err =       0.004754210780
              std dev =       0.557208736606
             le_variance =       0.310481576150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.869174182931        initial
     2.5000e+00     2.5000e+01             3.1118e-04        -0.872941431994  <--
     1.0000e+01     1.0000e+02             7.9144e-05        -0.872222016666
     4.0000e+01     4.0000e+02             1.9872e-05        -0.870000883841

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3625e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -5.050644e-02 3 1  ON 0
ci_002                -3.839100e-02 3 1  ON 1
ci_003                -2.985246e-02 3 1  ON 2
ci_004                 2.783148e-02 3 1  ON 3
ci_005                 2.818288e-02 3 1  ON 4
ci_006                -2.557661e-02 3 1  ON 5
ci_007                -2.562184e-02 3 1  ON 6
ci_008                -1.639142e-02 3 1  ON 7
ci_009                -2.011996e-02 3 1  ON 8
ci_010                -1.694502e-02 3 1  ON 9
ci_011                -1.682507e-02 3 1  ON 10
ci_012                -1.680979e-02 3 1  ON 11
ci_013                -2.280373e-02 3 1  ON 12
ci_014                 1.724908e-02 3 1  ON 13
ci_015                 1.718667e-02 3 1  ON 14
ci_016                 1.975754e-02 3 1  ON 15
ci_017                 1.985931e-02 3 1  ON 16
ci_018                 1.541369e-02 3 1  ON 17
ci_019                 1.535797e-02 3 1  ON 18
ci_020                 1.938394e-02 3 1  ON 19
ci_021                 1.916286e-02 3 1  ON 20
ci_022                 1.362707e-02 3 1  ON 21
ci_023                 1.350907e-02 3 1  ON 22
ci_024                 1.457779e-02 3 1  ON 23
ci_025                 1.489475e-02 3 1  ON 24
ci_026                 1.467284e-02 3 1  ON 25
ci_027                 1.488180e-02 3 1  ON 26
ci_028                -1.725519e-02 3 1  ON 27
ci_029                -1.754482e-02 3 1  ON 28
ci_030                -1.303028e-02 3 1  ON 29
ci_031                -1.300349e-02 3 1  ON 30
ci_032                -1.639176e-02 3 1  ON 31
ci_033                 1.069519e-02 3 1  ON 32
ci_034                 1.062869e-02 3 1  ON 33
ci_035                -9.150892e-03 3 1  ON 34
ci_036                -1.473707e-02 3 1  ON 35
ci_037                -1.440733e-02 3 1  ON 36
ci_038                 7.143779e-03 3 1  ON 37
ci_039                 7.361168e-03 3 1  ON 38
ci_040                -7.305625e-03 3 1  ON 39
ci_041                 1.123751e-02 3 1  ON 40
ci_042                 1.149492e-02 3 1  ON 41
ci_043                -7.769716e-03 3 1  ON 42
ci_044                -8.843681e-03 3 1  ON 43
ci_045                -7.042291e-03 3 1  ON 44
ci_046                 8.938110e-03 3 1  ON 45
ci_047                 9.099934e-03 3 1  ON 46
ci_048                -1.303971e-02 3 1  ON 47
ci_049                -1.316311e-02 3 1  ON 48
ci_050                 6.711977e-03 3 1  ON 49
ci_051                 6.950417e-03 3 1  ON 50
ci_052                -5.782030e-03 3 1  ON 51
ci_053                -6.133344e-03 3 1  ON 52
ci_054                -6.523875e-03 3 1  ON 53
ci_055                -6.686944e-03 3 1  ON 54
ci_056                 7.807665e-03 3 1  ON 55
ci_057                 7.795318e-03 3 1  ON 56
ci_058                -5.637447e-03 3 1  ON 57
ci_059                -5.714135e-03 3 1  ON 58
ci_060                 7.896661e-03 3 1  ON 59
ci_061                 8.104623e-03 3 1  ON 60
ci_062                -6.598556e-03 3 1  ON 61
ci_063                -6.483326e-03 3 1  ON 62
ci_064                -5.495772e-03 3 1  ON 63
ci_065                -6.078646e-03 3 1  ON 64
ci_066                 6.603506e-03 3 1  ON 65
ci_067                 6.641964e-03 3 1  ON 66
ci_068                -6.606069e-03 3 1  ON 67
ci_069                -6.646451e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1993
    reference variance = 0.183157
====================================================
  Execution time = 1.3801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2267e-01
  Total weights = 1.956232905e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308872605315
                                         uncertainty =       0.002119414764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308872605315
                                         uncertainty =       0.002119414764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392971948
  error estimate for blocks of size 2^( 2) =       0.000403254211
  error estimate for blocks of size 2^( 3) =       0.000412840898
  error estimate for blocks of size 2^( 4) =       0.000419958049
  error estimate for blocks of size 2^( 5) =       0.000423138961
  error estimate for blocks of size 2^( 6) =       0.000425268979
  error estimate for blocks of size 2^( 7) =       0.000425313935

      target function =      -0.873579698672
              le_mean =     -17.214429042750
             les_mean =     296.659236359424
             stat err =       0.000423419981
             autocorr =       1.160966260006
   target nu stat err =       0.000423419981
   target dn stat err =       0.002387932849
      target stat err =       0.002894281833
              std dev =       0.555746258040
             le_variance =       0.308853903326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721442904275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873588515639       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.876136750559       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876587589331       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876711467669       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876728055457       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876730832149       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876731350315       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876731451524       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876731508104       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876731518463       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876731522801       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876731521985       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.107093e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873588515639       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874279213797       residual = 6.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874398992470       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874430970200       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874435174863       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874435849244       residual = 6.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874435976965       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874436005677       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874436019203       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874436021785       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874436022908       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874436022722       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.955198e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.873588515639       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873764891005       residual = 6.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873795305018       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873803359770       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873804413594       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873804580680       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873804612459       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873804619872       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873804623203       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873804623844       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873804624128       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873804624082       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 7.514712e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6309e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -5.021092e-02 3 1  ON 0
ci_002                -3.812410e-02 3 1  ON 1
ci_003                -2.970458e-02 3 1  ON 2
ci_004                 2.765466e-02 3 1  ON 3
ci_005                 2.800914e-02 3 1  ON 4
ci_006                -2.539955e-02 3 1  ON 5
ci_007                -2.542430e-02 3 1  ON 6
ci_008                -1.612623e-02 3 1  ON 7
ci_009                -1.993401e-02 3 1  ON 8
ci_010                -1.672246e-02 3 1  ON 9
ci_011                -1.661060e-02 3 1  ON 10
ci_012                -1.657778e-02 3 1  ON 11
ci_013                -2.272246e-02 3 1  ON 12
ci_014                 1.710023e-02 3 1  ON 13
ci_015                 1.701922e-02 3 1  ON 14
ci_016                 1.965616e-02 3 1  ON 15
ci_017                 1.975233e-02 3 1  ON 16
ci_018                 1.523684e-02 3 1  ON 17
ci_019                 1.516880e-02 3 1  ON 18
ci_020                 1.926613e-02 3 1  ON 19
ci_021                 1.905464e-02 3 1  ON 20
ci_022                 1.345656e-02 3 1  ON 21
ci_023                 1.336082e-02 3 1  ON 22
ci_024                 1.442356e-02 3 1  ON 23
ci_025                 1.471270e-02 3 1  ON 24
ci_026                 1.454782e-02 3 1  ON 25
ci_027                 1.475461e-02 3 1  ON 26
ci_028                -1.717183e-02 3 1  ON 27
ci_029                -1.749951e-02 3 1  ON 28
ci_030                -1.288639e-02 3 1  ON 29
ci_031                -1.285914e-02 3 1  ON 30
ci_032                -1.634593e-02 3 1  ON 31
ci_033                 1.056123e-02 3 1  ON 32
ci_034                 1.050698e-02 3 1  ON 33
ci_035                -8.977193e-03 3 1  ON 34
ci_036                -1.466315e-02 3 1  ON 35
ci_037                -1.432507e-02 3 1  ON 36
ci_038                 6.959601e-03 3 1  ON 37
ci_039                 7.164669e-03 3 1  ON 38
ci_040                -7.127554e-03 3 1  ON 39
ci_041                 1.110553e-02 3 1  ON 40
ci_042                 1.139610e-02 3 1  ON 41
ci_043                -7.606279e-03 3 1  ON 42
ci_044                -8.676141e-03 3 1  ON 43
ci_045                -6.895640e-03 3 1  ON 44
ci_046                 8.817328e-03 3 1  ON 45
ci_047                 8.976881e-03 3 1  ON 46
ci_048                -1.300801e-02 3 1  ON 47
ci_049                -1.314974e-02 3 1  ON 48
ci_050                 6.600062e-03 3 1  ON 49
ci_051                 6.827391e-03 3 1  ON 50
ci_052                -5.675342e-03 3 1  ON 51
ci_053                -6.012142e-03 3 1  ON 52
ci_054                -6.410276e-03 3 1  ON 53
ci_055                -6.558282e-03 3 1  ON 54
ci_056                 7.720146e-03 3 1  ON 55
ci_057                 7.734459e-03 3 1  ON 56
ci_058                -5.490411e-03 3 1  ON 57
ci_059                -5.584203e-03 3 1  ON 58
ci_060                 7.775273e-03 3 1  ON 59
ci_061                 8.010976e-03 3 1  ON 60
ci_062                -6.499000e-03 3 1  ON 61
ci_063                -6.399011e-03 3 1  ON 62
ci_064                -5.387896e-03 3 1  ON 63
ci_065                -5.995282e-03 3 1  ON 64
ci_066                 6.528766e-03 3 1  ON 65
ci_067                 6.561094e-03 3 1  ON 66
ci_068                -6.544307e-03 3 1  ON 67
ci_069                -6.583712e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1719
    reference variance = 0.336017
====================================================
  Execution time = 1.3657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2575e-01
  Total weights = 1.9562e+06
  Execution time = 1.8280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311099584258
                                         uncertainty =       0.002321595850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311099584258
                                         uncertainty =       0.002321595850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394516560
  error estimate for blocks of size 2^( 2) =       0.000404574335
  error estimate for blocks of size 2^( 3) =       0.000413388683
  error estimate for blocks of size 2^( 4) =       0.000420479846
  error estimate for blocks of size 2^( 5) =       0.000424112701
  error estimate for blocks of size 2^( 6) =       0.000425585016
  error estimate for blocks of size 2^( 7) =       0.000427618653

      target function =      -0.866398275242
              le_mean =     -17.213946873335
             les_mean =     296.648659277487
             stat err =       0.000424449054
             autocorr =       1.157499105378
   target nu stat err =       0.000424449054
   target dn stat err =       0.003586501700
      target stat err =       0.004226168844
              std dev =       0.557930670152
             le_variance =       0.311286632696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305925643677
                                         uncertainty =       0.002271408537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305925643677
                                         uncertainty =       0.002271408537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391213794
  error estimate for blocks of size 2^( 2) =       0.000401261041
  error estimate for blocks of size 2^( 3) =       0.000410122348
  error estimate for blocks of size 2^( 4) =       0.000417241912
  error estimate for blocks of size 2^( 5) =       0.000420907081
  error estimate for blocks of size 2^( 6) =       0.000422372425
  error estimate for blocks of size 2^( 7) =       0.000424401160

      target function =      -0.871132268576
              le_mean =     -17.213981139967
             les_mean =     296.645810121926
             stat err =       0.000421230644
             autocorr =       1.159342077683
   target nu stat err =       0.000421230644
   target dn stat err =       0.003659960028
      target stat err =       0.004357648279
              std dev =       0.553259852911
             le_variance =       0.306096464844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308196315438
                                         uncertainty =       0.002291716831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308196315438
                                         uncertainty =       0.002291716831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392666685
  error estimate for blocks of size 2^( 2) =       0.000402715450
  error estimate for blocks of size 2^( 3) =       0.000411552011
  error estimate for blocks of size 2^( 4) =       0.000418657237
  error estimate for blocks of size 2^( 5) =       0.000422306767
  error estimate for blocks of size 2^( 6) =       0.000423771805
  error estimate for blocks of size 2^( 7) =       0.000425800376

      target function =      -0.870791233879
              le_mean =     -17.213953563775
             les_mean =     296.645148664997
             stat err =       0.000422634046
             autocorr =       1.158459478746
   target nu stat err =       0.000422634046
   target dn stat err =       0.003376151066
      target stat err =       0.004022736804
              std dev =       0.555314551459
             le_variance =       0.308374251063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310715669829
                                         uncertainty =       0.002317479507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310715669829
                                         uncertainty =       0.002317479507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394272435
  error estimate for blocks of size 2^( 2) =       0.000404328587
  error estimate for blocks of size 2^( 3) =       0.000413145269
  error estimate for blocks of size 2^( 4) =       0.000420237965
  error estimate for blocks of size 2^( 5) =       0.000423872757
  error estimate for blocks of size 2^( 6) =       0.000425344093
  error estimate for blocks of size 2^( 7) =       0.000427376853

      target function =      -0.868584503326
              le_mean =     -17.213946162627
             les_mean =     296.646769443293
             stat err =       0.000424207917
             autocorr =       1.157616502264
   target nu stat err =       0.000424207917
   target dn stat err =       0.003300950321
      target stat err =       0.003915522270
              std dev =       0.557585424610
             le_variance =       0.310901505737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.866398275242        initial
     6.2500e-01     6.2500e+00             1.1071e-03        -0.871132268576  <--
     2.5000e+00     2.5000e+01             2.9552e-04        -0.870791233879
     1.0000e+01     1.0000e+02             7.5147e-05        -0.868584503326

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.2920e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.939935e-02 3 1  ON 0
ci_002                -3.739592e-02 3 1  ON 1
ci_003                -2.929681e-02 3 1  ON 2
ci_004                 2.716938e-02 3 1  ON 3
ci_005                 2.753233e-02 3 1  ON 4
ci_006                -2.491668e-02 3 1  ON 5
ci_007                -2.488560e-02 3 1  ON 6
ci_008                -1.541687e-02 3 1  ON 7
ci_009                -1.943210e-02 3 1  ON 8
ci_010                -1.611972e-02 3 1  ON 9
ci_011                -1.603107e-02 3 1  ON 10
ci_012                -1.594990e-02 3 1  ON 11
ci_013                -2.249906e-02 3 1  ON 12
ci_014                 1.669857e-02 3 1  ON 13
ci_015                 1.656679e-02 3 1  ON 14
ci_016                 1.938362e-02 3 1  ON 15
ci_017                 1.946434e-02 3 1  ON 16
ci_018                 1.476035e-02 3 1  ON 17
ci_019                 1.465889e-02 3 1  ON 18
ci_020                 1.894129e-02 3 1  ON 19
ci_021                 1.875705e-02 3 1  ON 20
ci_022                 1.299662e-02 3 1  ON 21
ci_023                 1.296105e-02 3 1  ON 22
ci_024                 1.399914e-02 3 1  ON 23
ci_025                 1.421309e-02 3 1  ON 24
ci_026                 1.420849e-02 3 1  ON 25
ci_027                 1.440932e-02 3 1  ON 26
ci_028                -1.694474e-02 3 1  ON 27
ci_029                -1.737779e-02 3 1  ON 28
ci_030                -1.249868e-02 3 1  ON 29
ci_031                -1.247167e-02 3 1  ON 30
ci_032                -1.622189e-02 3 1  ON 31
ci_033                 1.019623e-02 3 1  ON 32
ci_034                 1.017545e-02 3 1  ON 33
ci_035                -8.510101e-03 3 1  ON 34
ci_036                -1.445859e-02 3 1  ON 35
ci_037                -1.409902e-02 3 1  ON 36
ci_038                 6.465100e-03 3 1  ON 37
ci_039                 6.637024e-03 3 1  ON 38
ci_040                -6.650581e-03 3 1  ON 39
ci_041                 1.075119e-02 3 1  ON 40
ci_042                 1.113227e-02 3 1  ON 41
ci_043                -7.166274e-03 3 1  ON 42
ci_044                -8.223609e-03 3 1  ON 43
ci_045                -6.502542e-03 3 1  ON 44
ci_046                 8.489423e-03 3 1  ON 45
ci_047                 8.642797e-03 3 1  ON 46
ci_048                -1.292312e-02 3 1  ON 47
ci_049                -1.311525e-02 3 1  ON 48
ci_050                 6.301816e-03 3 1  ON 49
ci_051                 6.499218e-03 3 1  ON 50
ci_052                -5.391412e-03 3 1  ON 51
ci_053                -5.689936e-03 3 1  ON 52
ci_054                -6.101815e-03 3 1  ON 53
ci_055                -6.209309e-03 3 1  ON 54
ci_056                 7.483627e-03 3 1  ON 55
ci_057                 7.570152e-03 3 1  ON 56
ci_058                -5.098788e-03 3 1  ON 57
ci_059                -5.238567e-03 3 1  ON 58
ci_060                 7.445923e-03 3 1  ON 59
ci_061                 7.756272e-03 3 1  ON 60
ci_062                -6.228070e-03 3 1  ON 61
ci_063                -6.169006e-03 3 1  ON 62
ci_064                -5.099509e-03 3 1  ON 63
ci_065                -5.771758e-03 3 1  ON 64
ci_066                 6.328266e-03 3 1  ON 65
ci_067                 6.344182e-03 3 1  ON 66
ci_068                -6.378499e-03 3 1  ON 67
ci_069                -6.415377e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.146284
====================================================
  Execution time = 1.3848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.2104e-01
  Total weights = 1.956450742e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304498750517
                                         uncertainty =       0.001661037944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304498750517
                                         uncertainty =       0.001661037944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390218176
  error estimate for blocks of size 2^( 2) =       0.000400172095
  error estimate for blocks of size 2^( 3) =       0.000408527019
  error estimate for blocks of size 2^( 4) =       0.000415346021
  error estimate for blocks of size 2^( 5) =       0.000419390161
  error estimate for blocks of size 2^( 6) =       0.000421790629
  error estimate for blocks of size 2^( 7) =       0.000423969643

      target function =      -0.875490125304
              le_mean =     -17.214291701151
             les_mean =     296.652878140756
             stat err =       0.000420124113
             autocorr =       1.159151573504
   target nu stat err =       0.000420124113
   target dn stat err =       0.003081330970
      target stat err =       0.003719645249
              std dev =       0.551851836698
             le_variance =       0.304540449667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429170115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505241527       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880559042013       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881751045502       residual = 5.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882611407374       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882889549813       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882935595349       residual = 4.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882944700106       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882944924571       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882944895073       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882945071394       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882945211094       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882945226389       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.882945246574       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.882945250702       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 3.676117e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505241527       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877169673801       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877553308024       residual = 5.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877824869609       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877905822006       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877918429293       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877920802492       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877920760142       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877920743081       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877920782247       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877920821418       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877920825367       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.877920828824       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.155997e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.875505241527       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.875956993801       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.876060262073       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.876132758489       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.876153748156       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.876156946708       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.876157540486       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.876157521911       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.876157516398       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.876157526154       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.876157535953       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.876157536913       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.876157537656       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 3.087477e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6408e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.824335e-02 3 1  ON 0
ci_002                -3.658976e-02 3 1  ON 1
ci_003                -2.881050e-02 3 1  ON 2
ci_004                 2.675372e-02 3 1  ON 3
ci_005                 2.693365e-02 3 1  ON 4
ci_006                -2.410047e-02 3 1  ON 5
ci_007                -2.433688e-02 3 1  ON 6
ci_008                -1.458990e-02 3 1  ON 7
ci_009                -1.884921e-02 3 1  ON 8
ci_010                -1.534479e-02 3 1  ON 9
ci_011                -1.527562e-02 3 1  ON 10
ci_012                -1.524087e-02 3 1  ON 11
ci_013                -2.241847e-02 3 1  ON 12
ci_014                 1.619289e-02 3 1  ON 13
ci_015                 1.606106e-02 3 1  ON 14
ci_016                 1.908275e-02 3 1  ON 15
ci_017                 1.896066e-02 3 1  ON 16
ci_018                 1.411144e-02 3 1  ON 17
ci_019                 1.409550e-02 3 1  ON 18
ci_020                 1.866481e-02 3 1  ON 19
ci_021                 1.855141e-02 3 1  ON 20
ci_022                 1.260606e-02 3 1  ON 21
ci_023                 1.247401e-02 3 1  ON 22
ci_024                 1.351143e-02 3 1  ON 23
ci_025                 1.372639e-02 3 1  ON 24
ci_026                 1.373387e-02 3 1  ON 25
ci_027                 1.392716e-02 3 1  ON 26
ci_028                -1.676127e-02 3 1  ON 27
ci_029                -1.706800e-02 3 1  ON 28
ci_030                -1.202637e-02 3 1  ON 29
ci_031                -1.217518e-02 3 1  ON 30
ci_032                -1.590618e-02 3 1  ON 31
ci_033                 9.822056e-03 3 1  ON 32
ci_034                 9.688955e-03 3 1  ON 33
ci_035                -7.925552e-03 3 1  ON 34
ci_036                -1.413442e-02 3 1  ON 35
ci_037                -1.377569e-02 3 1  ON 36
ci_038                 5.966716e-03 3 1  ON 37
ci_039                 6.005353e-03 3 1  ON 38
ci_040                -6.070480e-03 3 1  ON 39
ci_041                 1.020697e-02 3 1  ON 40
ci_042                 1.072051e-02 3 1  ON 41
ci_043                -6.629899e-03 3 1  ON 42
ci_044                -7.822477e-03 3 1  ON 43
ci_045                -6.053518e-03 3 1  ON 44
ci_046                 8.166220e-03 3 1  ON 45
ci_047                 8.256816e-03 3 1  ON 46
ci_048                -1.289420e-02 3 1  ON 47
ci_049                -1.310540e-02 3 1  ON 48
ci_050                 5.798723e-03 3 1  ON 49
ci_051                 6.039609e-03 3 1  ON 50
ci_052                -5.110714e-03 3 1  ON 51
ci_053                -5.284792e-03 3 1  ON 52
ci_054                -5.911008e-03 3 1  ON 53
ci_055                -5.831743e-03 3 1  ON 54
ci_056                 7.128610e-03 3 1  ON 55
ci_057                 7.285742e-03 3 1  ON 56
ci_058                -4.867479e-03 3 1  ON 57
ci_059                -4.919468e-03 3 1  ON 58
ci_060                 7.057673e-03 3 1  ON 59
ci_061                 7.398590e-03 3 1  ON 60
ci_062                -6.082035e-03 3 1  ON 61
ci_063                -5.889111e-03 3 1  ON 62
ci_064                -4.759610e-03 3 1  ON 63
ci_065                -5.518479e-03 3 1  ON 64
ci_066                 6.077582e-03 3 1  ON 65
ci_067                 6.180621e-03 3 1  ON 66
ci_068                -6.236439e-03 3 1  ON 67
ci_069                -6.099546e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1978
    reference variance = 0.280812
====================================================
  Execution time = 1.3665e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1860e-01
  Total weights = 1.9563e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309136899404
                                         uncertainty =       0.003325557846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309136899404
                                         uncertainty =       0.003325557846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393174102
  error estimate for blocks of size 2^( 2) =       0.000403457650
  error estimate for blocks of size 2^( 3) =       0.000412266564
  error estimate for blocks of size 2^( 4) =       0.000418889124
  error estimate for blocks of size 2^( 5) =       0.000424384829
  error estimate for blocks of size 2^( 6) =       0.000427307482
  error estimate for blocks of size 2^( 7) =       0.000428735832

      target function =      -0.788820844738
              le_mean =     -17.214650387970
             les_mean =     296.742208477720
             stat err =       0.000424829317
             autocorr =       1.167506080528
   target nu stat err =       0.000424829317
   target dn stat err =       0.054671949938
      target stat err =       0.053211308755
              std dev =       0.556032147144
             le_variance =       0.309171748657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298416264201
                                         uncertainty =       0.002886698314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298416264201
                                         uncertainty =       0.002886698314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386298847
  error estimate for blocks of size 2^( 2) =       0.000396694731
  error estimate for blocks of size 2^( 3) =       0.000405720005
  error estimate for blocks of size 2^( 4) =       0.000412586064
  error estimate for blocks of size 2^( 5) =       0.000418132882
  error estimate for blocks of size 2^( 6) =       0.000420840180
  error estimate for blocks of size 2^( 7) =       0.000422460044

      target function =      -0.871558988404
              le_mean =     -17.214833483537
             les_mean =     296.674838568672
             stat err =       0.000418504793
             autocorr =       1.173691740331
   target nu stat err =       0.000418504793
   target dn stat err =       0.008169180044
      target stat err =       0.009682556413
              std dev =       0.546309068087
             le_variance =       0.298453597874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301409796611
                                         uncertainty =       0.003016870676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301409796611
                                         uncertainty =       0.003016870676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388231053
  error estimate for blocks of size 2^( 2) =       0.000398568637
  error estimate for blocks of size 2^( 3) =       0.000407500299
  error estimate for blocks of size 2^( 4) =       0.000414273314
  error estimate for blocks of size 2^( 5) =       0.000419797692
  error estimate for blocks of size 2^( 6) =       0.000422586163
  error estimate for blocks of size 2^( 7) =       0.000424121744

      target function =      -0.878315466608
              le_mean =     -17.214685789905
             les_mean =     296.664133053139
             stat err =       0.000420194728
             autocorr =       1.171441648019
   target nu stat err =       0.000420194728
   target dn stat err =       0.004054836148
      target stat err =       0.004904620715
              std dev =       0.549041619832
             le_variance =       0.301446700308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307853724086
                                         uncertainty =       0.003282228943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307853724086
                                         uncertainty =       0.003282228943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392357650
  error estimate for blocks of size 2^( 2) =       0.000402642805
  error estimate for blocks of size 2^( 3) =       0.000411463354
  error estimate for blocks of size 2^( 4) =       0.000418111684
  error estimate for blocks of size 2^( 5) =       0.000423608419
  error estimate for blocks of size 2^( 6) =       0.000426504386
  error estimate for blocks of size 2^( 7) =       0.000427932710

      target function =      -0.868327913544
              le_mean =     -17.214643792455
             les_mean =     296.671076922664
             stat err =       0.000424039300
             autocorr =       1.168013781638
   target nu stat err =       0.000424039300
   target dn stat err =       0.005252708904
      target stat err =       0.006193397244
              std dev =       0.554877510444
             le_variance =       0.307889051596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.788820844738        initial
     1.5625e-01     1.5625e+00             3.6761e-03        -0.871558988404
     6.2500e-01     6.2500e+00             1.1560e-03        -0.878315466608  <--
     2.5000e+00     2.5000e+01             3.0875e-04        -0.868327913544

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.3014e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.824335e-02 3 1  ON 0
ci_002                -3.658976e-02 3 1  ON 1
ci_003                -2.881050e-02 3 1  ON 2
ci_004                 2.675372e-02 3 1  ON 3
ci_005                 2.693365e-02 3 1  ON 4
ci_006                -2.410047e-02 3 1  ON 5
ci_007                -2.433688e-02 3 1  ON 6
ci_008                -1.458990e-02 3 1  ON 7
ci_009                -1.884921e-02 3 1  ON 8
ci_010                -1.534479e-02 3 1  ON 9
ci_011                -1.527562e-02 3 1  ON 10
ci_012                -1.524087e-02 3 1  ON 11
ci_013                -2.241847e-02 3 1  ON 12
ci_014                 1.619289e-02 3 1  ON 13
ci_015                 1.606106e-02 3 1  ON 14
ci_016                 1.908275e-02 3 1  ON 15
ci_017                 1.896066e-02 3 1  ON 16
ci_018                 1.411144e-02 3 1  ON 17
ci_019                 1.409550e-02 3 1  ON 18
ci_020                 1.866481e-02 3 1  ON 19
ci_021                 1.855141e-02 3 1  ON 20
ci_022                 1.260606e-02 3 1  ON 21
ci_023                 1.247401e-02 3 1  ON 22
ci_024                 1.351143e-02 3 1  ON 23
ci_025                 1.372639e-02 3 1  ON 24
ci_026                 1.373387e-02 3 1  ON 25
ci_027                 1.392716e-02 3 1  ON 26
ci_028                -1.676127e-02 3 1  ON 27
ci_029                -1.706800e-02 3 1  ON 28
ci_030                -1.202637e-02 3 1  ON 29
ci_031                -1.217518e-02 3 1  ON 30
ci_032                -1.590618e-02 3 1  ON 31
ci_033                 9.822056e-03 3 1  ON 32
ci_034                 9.688955e-03 3 1  ON 33
ci_035                -7.925552e-03 3 1  ON 34
ci_036                -1.413442e-02 3 1  ON 35
ci_037                -1.377569e-02 3 1  ON 36
ci_038                 5.966716e-03 3 1  ON 37
ci_039                 6.005353e-03 3 1  ON 38
ci_040                -6.070480e-03 3 1  ON 39
ci_041                 1.020697e-02 3 1  ON 40
ci_042                 1.072051e-02 3 1  ON 41
ci_043                -6.629899e-03 3 1  ON 42
ci_044                -7.822477e-03 3 1  ON 43
ci_045                -6.053518e-03 3 1  ON 44
ci_046                 8.166220e-03 3 1  ON 45
ci_047                 8.256816e-03 3 1  ON 46
ci_048                -1.289420e-02 3 1  ON 47
ci_049                -1.310540e-02 3 1  ON 48
ci_050                 5.798723e-03 3 1  ON 49
ci_051                 6.039609e-03 3 1  ON 50
ci_052                -5.110714e-03 3 1  ON 51
ci_053                -5.284792e-03 3 1  ON 52
ci_054                -5.911008e-03 3 1  ON 53
ci_055                -5.831743e-03 3 1  ON 54
ci_056                 7.128610e-03 3 1  ON 55
ci_057                 7.285742e-03 3 1  ON 56
ci_058                -4.867479e-03 3 1  ON 57
ci_059                -4.919468e-03 3 1  ON 58
ci_060                 7.057673e-03 3 1  ON 59
ci_061                 7.398590e-03 3 1  ON 60
ci_062                -6.082035e-03 3 1  ON 61
ci_063                -5.889111e-03 3 1  ON 62
ci_064                -4.759610e-03 3 1  ON 63
ci_065                -5.518479e-03 3 1  ON 64
ci_066                 6.077582e-03 3 1  ON 65
ci_067                 6.180621e-03 3 1  ON 66
ci_068                -6.236439e-03 3 1  ON 67
ci_069                -6.099546e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9446e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.247961
====================================================
  Execution time = 1.4147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2355e-01
  Total weights = 1.956602394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306554484270
                                         uncertainty =       0.002292699022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306554484270
                                         uncertainty =       0.002292699022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391447543
  error estimate for blocks of size 2^( 2) =       0.000401297924
  error estimate for blocks of size 2^( 3) =       0.000410024611
  error estimate for blocks of size 2^( 4) =       0.000416572802
  error estimate for blocks of size 2^( 5) =       0.000422282470
  error estimate for blocks of size 2^( 6) =       0.000424528625
  error estimate for blocks of size 2^( 7) =       0.000427338112

      target function =      -0.872579280494
              le_mean =     -17.214789448580
             les_mean =     296.672530695676
             stat err =       0.000422680502
             autocorr =       1.165942910159
   target nu stat err =       0.000422680502
   target dn stat err =       0.003324970419
      target stat err =       0.003984307374
              std dev =       0.553590424484
             le_variance =       0.306462358081


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721478944858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872596732993       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877480449365       residual = 7.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.878426197181       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.878831171046       residual = 5.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.878919358416       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.878938585710       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.878943037828       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.878943356438       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.878943689123       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.878943570182       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.878943515884       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.878943479849       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.878943467722       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 3.570325e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872596732993       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.874204885012       residual = 6.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.874502060359       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.874621822331       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.874645948624       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.874650952273       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.874652054042       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.874652100177       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.874652174453       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.874652142089       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.874652128725       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.874652120140       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 1.118149e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872596732993       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873033191423       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873112440105       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873143672267       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873149790626       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873151037659       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873151307622       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873151316102       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873151333699       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873151325536       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873151322287       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873151320209       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.982434e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6635e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.712520e-02 3 1  ON 0
ci_002                -3.579596e-02 3 1  ON 1
ci_003                -2.839198e-02 3 1  ON 2
ci_004                 2.622686e-02 3 1  ON 3
ci_005                 2.640570e-02 3 1  ON 4
ci_006                -2.361327e-02 3 1  ON 5
ci_007                -2.374038e-02 3 1  ON 6
ci_008                -1.382072e-02 3 1  ON 7
ci_009                -1.831403e-02 3 1  ON 8
ci_010                -1.479839e-02 3 1  ON 9
ci_011                -1.456538e-02 3 1  ON 10
ci_012                -1.447400e-02 3 1  ON 11
ci_013                -2.214745e-02 3 1  ON 12
ci_014                 1.573965e-02 3 1  ON 13
ci_015                 1.546865e-02 3 1  ON 14
ci_016                 1.862299e-02 3 1  ON 15
ci_017                 1.860803e-02 3 1  ON 16
ci_018                 1.355822e-02 3 1  ON 17
ci_019                 1.348572e-02 3 1  ON 18
ci_020                 1.830763e-02 3 1  ON 19
ci_021                 1.824851e-02 3 1  ON 20
ci_022                 1.213657e-02 3 1  ON 21
ci_023                 1.211378e-02 3 1  ON 22
ci_024                 1.311597e-02 3 1  ON 23
ci_025                 1.336624e-02 3 1  ON 24
ci_026                 1.326875e-02 3 1  ON 25
ci_027                 1.344869e-02 3 1  ON 26
ci_028                -1.652363e-02 3 1  ON 27
ci_029                -1.670474e-02 3 1  ON 28
ci_030                -1.176741e-02 3 1  ON 29
ci_031                -1.182032e-02 3 1  ON 30
ci_032                -1.577205e-02 3 1  ON 31
ci_033                 9.391203e-03 3 1  ON 32
ci_034                 9.104170e-03 3 1  ON 33
ci_035                -7.414021e-03 3 1  ON 34
ci_036                -1.384726e-02 3 1  ON 35
ci_037                -1.358614e-02 3 1  ON 36
ci_038                 5.393237e-03 3 1  ON 37
ci_039                 5.433564e-03 3 1  ON 38
ci_040                -5.577015e-03 3 1  ON 39
ci_041                 1.008336e-02 3 1  ON 40
ci_042                 1.046765e-02 3 1  ON 41
ci_043                -6.141660e-03 3 1  ON 42
ci_044                -7.609514e-03 3 1  ON 43
ci_045                -5.609374e-03 3 1  ON 44
ci_046                 7.805285e-03 3 1  ON 45
ci_047                 7.905278e-03 3 1  ON 46
ci_048                -1.282733e-02 3 1  ON 47
ci_049                -1.305727e-02 3 1  ON 48
ci_050                 5.532837e-03 3 1  ON 49
ci_051                 5.725183e-03 3 1  ON 50
ci_052                -4.855767e-03 3 1  ON 51
ci_053                -4.993844e-03 3 1  ON 52
ci_054                -5.510429e-03 3 1  ON 53
ci_055                -5.445468e-03 3 1  ON 54
ci_056                 6.843897e-03 3 1  ON 55
ci_057                 6.935921e-03 3 1  ON 56
ci_058                -4.493282e-03 3 1  ON 57
ci_059                -4.552061e-03 3 1  ON 58
ci_060                 7.003970e-03 3 1  ON 59
ci_061                 7.243498e-03 3 1  ON 60
ci_062                -5.762790e-03 3 1  ON 61
ci_063                -5.597896e-03 3 1  ON 62
ci_064                -4.493758e-03 3 1  ON 63
ci_065                -5.332010e-03 3 1  ON 64
ci_066                 5.897073e-03 3 1  ON 65
ci_067                 5.888978e-03 3 1  ON 66
ci_068                -6.150888e-03 3 1  ON 67
ci_069                -5.926122e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.186118
====================================================
  Execution time = 1.3296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1646e-01
  Total weights = 1.9565e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302724661263
                                         uncertainty =       0.002578243285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302724661263
                                         uncertainty =       0.002578243285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389054107
  error estimate for blocks of size 2^( 2) =       0.000399266708
  error estimate for blocks of size 2^( 3) =       0.000408355932
  error estimate for blocks of size 2^( 4) =       0.000414513311
  error estimate for blocks of size 2^( 5) =       0.000418820801
  error estimate for blocks of size 2^( 6) =       0.000420503787
  error estimate for blocks of size 2^( 7) =       0.000420490266

      target function =      -0.872801065810
              le_mean =     -17.214924101443
             les_mean =     296.676984339289
             stat err =       0.000418582041
             autocorr =       1.157553772595
   target nu stat err =       0.000418582041
   target dn stat err =       0.004623193294
      target stat err =       0.005515575118
              std dev =       0.550205594405
             le_variance =       0.302726196115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294550522691
                                         uncertainty =       0.002329774660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294550522691
                                         uncertainty =       0.002329774660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383767544
  error estimate for blocks of size 2^( 2) =       0.000394107383
  error estimate for blocks of size 2^( 3) =       0.000403352717
  error estimate for blocks of size 2^( 4) =       0.000409699296
  error estimate for blocks of size 2^( 5) =       0.000414175497
  error estimate for blocks of size 2^( 6) =       0.000415825074
  error estimate for blocks of size 2^( 7) =       0.000415786055

      target function =      -0.797600470128
              le_mean =     -17.215030781570
             les_mean =     296.745893761138
             stat err =       0.000413871480
             autocorr =       1.163039637545
   target nu stat err =       0.000413871480
   target dn stat err =       0.057640117620
      target stat err =       0.057425548886
              std dev =       0.542729264877
             le_variance =       0.294555054954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296484790217
                                         uncertainty =       0.002419475316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296484790217
                                         uncertainty =       0.002419475316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385025004
  error estimate for blocks of size 2^( 2) =       0.000395315003
  error estimate for blocks of size 2^( 3) =       0.000404497486
  error estimate for blocks of size 2^( 4) =       0.000410775464
  error estimate for blocks of size 2^( 5) =       0.000415186471
  error estimate for blocks of size 2^( 6) =       0.000416873531
  error estimate for blocks of size 2^( 7) =       0.000416837926

      target function =      -0.871354456853
              le_mean =     -17.214933504782
             les_mean =     296.678486452403
             stat err =       0.000414918348
             autocorr =       1.161307983170
   target nu stat err =       0.000414918348
   target dn stat err =       0.007343262676
      target stat err =       0.008703947605
              std dev =       0.544507582553
             le_variance =       0.296488507457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301759106389
                                         uncertainty =       0.002555102572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301759106389
                                         uncertainty =       0.002555102572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388433382
  error estimate for blocks of size 2^( 2) =       0.000398650836
  error estimate for blocks of size 2^( 3) =       0.000407750913
  error estimate for blocks of size 2^( 4) =       0.000413929423
  error estimate for blocks of size 2^( 5) =       0.000418250496
  error estimate for blocks of size 2^( 6) =       0.000419937911
  error estimate for blocks of size 2^( 7) =       0.000419918219

      target function =      -0.826773314398
              le_mean =     -17.214911787902
             les_mean =     296.715199818339
             stat err =       0.000418009012
             autocorr =       1.158079028636
   target nu stat err =       0.000418009012
   target dn stat err =       0.042552810948
      target stat err =       0.045447462782
              std dev =       0.549327757587
             le_variance =       0.301760985256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.872801065810        initial  <--
     1.5625e-01     1.5625e+00             3.5703e-03        -0.797600470128
     6.2500e-01     6.2500e+00             1.1181e-03        -0.871354456853
     2.5000e+00     2.5000e+01             2.9824e-04        -0.826773314398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5645
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.824335e-02 3 1  ON 0
ci_002                -3.658976e-02 3 1  ON 1
ci_003                -2.881050e-02 3 1  ON 2
ci_004                 2.675372e-02 3 1  ON 3
ci_005                 2.693365e-02 3 1  ON 4
ci_006                -2.410047e-02 3 1  ON 5
ci_007                -2.433688e-02 3 1  ON 6
ci_008                -1.458990e-02 3 1  ON 7
ci_009                -1.884921e-02 3 1  ON 8
ci_010                -1.534479e-02 3 1  ON 9
ci_011                -1.527562e-02 3 1  ON 10
ci_012                -1.524087e-02 3 1  ON 11
ci_013                -2.241847e-02 3 1  ON 12
ci_014                 1.619289e-02 3 1  ON 13
ci_015                 1.606106e-02 3 1  ON 14
ci_016                 1.908275e-02 3 1  ON 15
ci_017                 1.896066e-02 3 1  ON 16
ci_018                 1.411144e-02 3 1  ON 17
ci_019                 1.409550e-02 3 1  ON 18
ci_020                 1.866481e-02 3 1  ON 19
ci_021                 1.855141e-02 3 1  ON 20
ci_022                 1.260606e-02 3 1  ON 21
ci_023                 1.247401e-02 3 1  ON 22
ci_024                 1.351143e-02 3 1  ON 23
ci_025                 1.372639e-02 3 1  ON 24
ci_026                 1.373387e-02 3 1  ON 25
ci_027                 1.392716e-02 3 1  ON 26
ci_028                -1.676127e-02 3 1  ON 27
ci_029                -1.706800e-02 3 1  ON 28
ci_030                -1.202637e-02 3 1  ON 29
ci_031                -1.217518e-02 3 1  ON 30
ci_032                -1.590618e-02 3 1  ON 31
ci_033                 9.822056e-03 3 1  ON 32
ci_034                 9.688955e-03 3 1  ON 33
ci_035                -7.925552e-03 3 1  ON 34
ci_036                -1.413442e-02 3 1  ON 35
ci_037                -1.377569e-02 3 1  ON 36
ci_038                 5.966716e-03 3 1  ON 37
ci_039                 6.005353e-03 3 1  ON 38
ci_040                -6.070480e-03 3 1  ON 39
ci_041                 1.020697e-02 3 1  ON 40
ci_042                 1.072051e-02 3 1  ON 41
ci_043                -6.629899e-03 3 1  ON 42
ci_044                -7.822477e-03 3 1  ON 43
ci_045                -6.053518e-03 3 1  ON 44
ci_046                 8.166220e-03 3 1  ON 45
ci_047                 8.256816e-03 3 1  ON 46
ci_048                -1.289420e-02 3 1  ON 47
ci_049                -1.310540e-02 3 1  ON 48
ci_050                 5.798723e-03 3 1  ON 49
ci_051                 6.039609e-03 3 1  ON 50
ci_052                -5.110714e-03 3 1  ON 51
ci_053                -5.284792e-03 3 1  ON 52
ci_054                -5.911008e-03 3 1  ON 53
ci_055                -5.831743e-03 3 1  ON 54
ci_056                 7.128610e-03 3 1  ON 55
ci_057                 7.285742e-03 3 1  ON 56
ci_058                -4.867479e-03 3 1  ON 57
ci_059                -4.919468e-03 3 1  ON 58
ci_060                 7.057673e-03 3 1  ON 59
ci_061                 7.398590e-03 3 1  ON 60
ci_062                -6.082035e-03 3 1  ON 61
ci_063                -5.889111e-03 3 1  ON 62
ci_064                -4.759610e-03 3 1  ON 63
ci_065                -5.518479e-03 3 1  ON 64
ci_066                 6.077582e-03 3 1  ON 65
ci_067                 6.180621e-03 3 1  ON 66
ci_068                -6.236439e-03 3 1  ON 67
ci_069                -6.099546e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9207e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1928
    reference variance = 0.248326
====================================================
  Execution time = 1.3795e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2351e-01
  Total weights = 1.956402321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308159057760
                                         uncertainty =       0.002209347305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308159057760
                                         uncertainty =       0.002209347305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392502776
  error estimate for blocks of size 2^( 2) =       0.000402989155
  error estimate for blocks of size 2^( 3) =       0.000412233859
  error estimate for blocks of size 2^( 4) =       0.000418631688
  error estimate for blocks of size 2^( 5) =       0.000422065360
  error estimate for blocks of size 2^( 6) =       0.000424010009
  error estimate for blocks of size 2^( 7) =       0.000425731937

      target function =      -0.872601825038
              le_mean =     -17.214622881829
             les_mean =     296.666751768806
             stat err =       0.000422609749
             autocorr =       1.159293916317
   target nu stat err =       0.000422609749
   target dn stat err =       0.003543075336
      target stat err =       0.004239510467
              std dev =       0.555082749096
             le_variance =       0.308116858344


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462288183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872621724392       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.873414654296       residual = 5.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.873557265423       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.873597717521       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.873605182032       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.873607122701       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.873607738822       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.873607751026       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.873607719959       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.873607711904       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.873607712577       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.873607711774       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 4.377252e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872621724392       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.872826912483       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.872863489265       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.872873749246       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872875627334       residual = 6.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872876110003       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872876262655       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872876265270       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872876257401       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872876255416       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872876255561       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872876255367       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.123683e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.872621724392       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.872673474925       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.872682678416       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.872685252517       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.872685722720       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.872685843199       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.872685881266       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.872685881892       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.872685879919       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.872685879424       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.872685879459       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.872685879411       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 2.828158e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6333e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.813098e-02 3 1  ON 0
ci_002                -3.650684e-02 3 1  ON 1
ci_003                -2.876934e-02 3 1  ON 2
ci_004                 2.669156e-02 3 1  ON 3
ci_005                 2.687559e-02 3 1  ON 4
ci_006                -2.403383e-02 3 1  ON 5
ci_007                -2.427884e-02 3 1  ON 6
ci_008                -1.448516e-02 3 1  ON 7
ci_009                -1.878694e-02 3 1  ON 8
ci_010                -1.527042e-02 3 1  ON 9
ci_011                -1.518518e-02 3 1  ON 10
ci_012                -1.515937e-02 3 1  ON 11
ci_013                -2.239783e-02 3 1  ON 12
ci_014                 1.614531e-02 3 1  ON 13
ci_015                 1.599225e-02 3 1  ON 14
ci_016                 1.904880e-02 3 1  ON 15
ci_017                 1.892179e-02 3 1  ON 16
ci_018                 1.405450e-02 3 1  ON 17
ci_019                 1.402556e-02 3 1  ON 18
ci_020                 1.863064e-02 3 1  ON 19
ci_021                 1.851836e-02 3 1  ON 20
ci_022                 1.254248e-02 3 1  ON 21
ci_023                 1.242811e-02 3 1  ON 22
ci_024                 1.345070e-02 3 1  ON 23
ci_025                 1.366976e-02 3 1  ON 24
ci_026                 1.368185e-02 3 1  ON 25
ci_027                 1.388049e-02 3 1  ON 26
ci_028                -1.675845e-02 3 1  ON 27
ci_029                -1.705256e-02 3 1  ON 28
ci_030                -1.200684e-02 3 1  ON 29
ci_031                -1.214568e-02 3 1  ON 30
ci_032                -1.588716e-02 3 1  ON 31
ci_033                 9.779827e-03 3 1  ON 32
ci_034                 9.646506e-03 3 1  ON 33
ci_035                -7.870967e-03 3 1  ON 34
ci_036                -1.411502e-02 3 1  ON 35
ci_037                -1.374406e-02 3 1  ON 36
ci_038                 5.909101e-03 3 1  ON 37
ci_039                 5.943794e-03 3 1  ON 38
ci_040                -6.002850e-03 3 1  ON 39
ci_041                 1.017680e-02 3 1  ON 40
ci_042                 1.068063e-02 3 1  ON 41
ci_043                -6.581468e-03 3 1  ON 42
ci_044                -7.778820e-03 3 1  ON 43
ci_045                -5.999248e-03 3 1  ON 44
ci_046                 8.131143e-03 3 1  ON 45
ci_047                 8.215932e-03 3 1  ON 46
ci_048                -1.289168e-02 3 1  ON 47
ci_049                -1.310684e-02 3 1  ON 48
ci_050                 5.761197e-03 3 1  ON 49
ci_051                 5.997542e-03 3 1  ON 50
ci_052                -5.077430e-03 3 1  ON 51
ci_053                -5.238810e-03 3 1  ON 52
ci_054                -5.867410e-03 3 1  ON 53
ci_055                -5.791194e-03 3 1  ON 54
ci_056                 7.092626e-03 3 1  ON 55
ci_057                 7.248236e-03 3 1  ON 56
ci_058                -4.817738e-03 3 1  ON 57
ci_059                -4.891649e-03 3 1  ON 58
ci_060                 7.028813e-03 3 1  ON 59
ci_061                 7.376448e-03 3 1  ON 60
ci_062                -6.054651e-03 3 1  ON 61
ci_063                -5.852399e-03 3 1  ON 62
ci_064                -4.731979e-03 3 1  ON 63
ci_065                -5.490427e-03 3 1  ON 64
ci_066                 6.054035e-03 3 1  ON 65
ci_067                 6.153600e-03 3 1  ON 66
ci_068                -6.225431e-03 3 1  ON 67
ci_069                -6.070343e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.226089
====================================================
  Execution time = 1.3270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.9562e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298781754482
                                         uncertainty =       0.001698111903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298781754482
                                         uncertainty =       0.001698111903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386556208
  error estimate for blocks of size 2^( 2) =       0.000397207610
  error estimate for blocks of size 2^( 3) =       0.000406333926
  error estimate for blocks of size 2^( 4) =       0.000412801529
  error estimate for blocks of size 2^( 5) =       0.000416818153
  error estimate for blocks of size 2^( 6) =       0.000419133687
  error estimate for blocks of size 2^( 7) =       0.000419675266

      target function =      -0.883382628961
              le_mean =     -17.214602131327
             les_mean =     296.657057760895
             stat err =       0.000417107159
             autocorr =       1.164313633732
   target nu stat err =       0.000417107159
   target dn stat err =       0.002780689730
      target stat err =       0.003426795588
              std dev =       0.546673031687
             le_variance =       0.298851403574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297325961622
                                         uncertainty =       0.001686797326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297325961622
                                         uncertainty =       0.001686797326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385613141
  error estimate for blocks of size 2^( 2) =       0.000396276946
  error estimate for blocks of size 2^( 3) =       0.000405420812
  error estimate for blocks of size 2^( 4) =       0.000411918189
  error estimate for blocks of size 2^( 5) =       0.000415957570
  error estimate for blocks of size 2^( 6) =       0.000418281826
  error estimate for blocks of size 2^( 7) =       0.000418844604

      target function =      -0.887420933121
              le_mean =     -17.214608001390
             les_mean =     296.653955334808
             stat err =       0.000416250547
             autocorr =       1.165214780148
   target nu stat err =       0.000416250547
   target dn stat err =       0.002306591565
      target stat err =       0.002886001642
              std dev =       0.545339333373
             le_variance =       0.297394988523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298017412123
                                         uncertainty =       0.001692149034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298017412123
                                         uncertainty =       0.001692149034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386061356
  error estimate for blocks of size 2^( 2) =       0.000396718866
  error estimate for blocks of size 2^( 3) =       0.000405853850
  error estimate for blocks of size 2^( 4) =       0.000412336806
  error estimate for blocks of size 2^( 5) =       0.000416365078
  error estimate for blocks of size 2^( 6) =       0.000418684773
  error estimate for blocks of size 2^( 7) =       0.000419237959

      target function =      -0.886148681171
              le_mean =     -17.214603395196
             les_mean =     296.654835071225
             stat err =       0.000416656154
             autocorr =       1.164777405497
   target nu stat err =       0.000416656154
   target dn stat err =       0.002322667269
      target stat err =       0.002897248607
              std dev =       0.545973205731
             le_variance =       0.298086741376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298683928482
                                         uncertainty =       0.001697342941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298683928482
                                         uncertainty =       0.001697342941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386492909
  error estimate for blocks of size 2^( 2) =       0.000397145106
  error estimate for blocks of size 2^( 3) =       0.000406272471
  error estimate for blocks of size 2^( 4) =       0.000412741816
  error estimate for blocks of size 2^( 5) =       0.000416759685
  error estimate for blocks of size 2^( 6) =       0.000419075440
  error estimate for blocks of size 2^( 7) =       0.000419618003

      target function =      -0.881893450928
              le_mean =     -17.214602156348
             les_mean =     296.658282237750
             stat err =       0.000417048736
             autocorr =       1.164368792967
   target nu stat err =       0.000417048736
   target dn stat err =       0.003286567960
      target stat err =       0.004020617403
              std dev =       0.546583514204
             le_variance =       0.298753537999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883382628961        initial
     1.5625e+00     1.5625e+01             4.3773e-04        -0.887420933121  <--
     6.2500e+00     6.2500e+01             1.1237e-04        -0.886148681171
     2.5000e+01     2.5000e+02             2.8282e-05        -0.881893450928

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2534e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.780563e-02 3 1  ON 0
ci_002                -3.626749e-02 3 1  ON 1
ci_003                -2.864968e-02 3 1  ON 2
ci_004                 2.651142e-02 3 1  ON 3
ci_005                 2.670717e-02 3 1  ON 4
ci_006                -2.384147e-02 3 1  ON 5
ci_007                -2.411138e-02 3 1  ON 6
ci_008                -1.418573e-02 3 1  ON 7
ci_009                -1.860814e-02 3 1  ON 8
ci_010                -1.505693e-02 3 1  ON 9
ci_011                -1.492520e-02 3 1  ON 10
ci_012                -1.492506e-02 3 1  ON 11
ci_013                -2.233822e-02 3 1  ON 12
ci_014                 1.600853e-02 3 1  ON 13
ci_015                 1.579450e-02 3 1  ON 14
ci_016                 1.895143e-02 3 1  ON 15
ci_017                 1.881010e-02 3 1  ON 16
ci_018                 1.389117e-02 3 1  ON 17
ci_019                 1.382485e-02 3 1  ON 18
ci_020                 1.853128e-02 3 1  ON 19
ci_021                 1.842248e-02 3 1  ON 20
ci_022                 1.235993e-02 3 1  ON 21
ci_023                 1.229638e-02 3 1  ON 22
ci_024                 1.327497e-02 3 1  ON 23
ci_025                 1.350585e-02 3 1  ON 24
ci_026                 1.353216e-02 3 1  ON 25
ci_027                 1.374625e-02 3 1  ON 26
ci_028                -1.675058e-02 3 1  ON 27
ci_029                -1.700809e-02 3 1  ON 28
ci_030                -1.195091e-02 3 1  ON 29
ci_031                -1.206120e-02 3 1  ON 30
ci_032                -1.583245e-02 3 1  ON 31
ci_033                 9.658126e-03 3 1  ON 32
ci_034                 9.524036e-03 3 1  ON 33
ci_035                -7.714403e-03 3 1  ON 34
ci_036                -1.405847e-02 3 1  ON 35
ci_037                -1.365264e-02 3 1  ON 36
ci_038                 5.743920e-03 3 1  ON 37
ci_039                 5.767338e-03 3 1  ON 38
ci_040                -5.809307e-03 3 1  ON 39
ci_041                 1.009073e-02 3 1  ON 40
ci_042                 1.056655e-02 3 1  ON 41
ci_043                -6.442492e-03 3 1  ON 42
ci_044                -7.653252e-03 3 1  ON 43
ci_045                -5.843755e-03 3 1  ON 44
ci_046                 8.030173e-03 3 1  ON 45
ci_047                 8.098198e-03 3 1  ON 46
ci_048                -1.288522e-02 3 1  ON 47
ci_049                -1.311169e-02 3 1  ON 48
ci_050                 5.653908e-03 3 1  ON 49
ci_051                 5.877430e-03 3 1  ON 50
ci_052                -4.982472e-03 3 1  ON 51
ci_053                -5.107653e-03 3 1  ON 52
ci_054                -5.741932e-03 3 1  ON 53
ci_055                -5.674615e-03 3 1  ON 54
ci_056                 6.989259e-03 3 1  ON 55
ci_057                 7.140505e-03 3 1  ON 56
ci_058                -4.675801e-03 3 1  ON 57
ci_059                -4.812191e-03 3 1  ON 58
ci_060                 6.945587e-03 3 1  ON 59
ci_061                 7.312601e-03 3 1  ON 60
ci_062                -5.975521e-03 3 1  ON 61
ci_063                -5.746555e-03 3 1  ON 62
ci_064                -4.652941e-03 3 1  ON 63
ci_065                -5.410060e-03 3 1  ON 64
ci_066                 5.986558e-03 3 1  ON 65
ci_067                 6.076145e-03 3 1  ON 66
ci_068                -6.194010e-03 3 1  ON 67
ci_069                -5.986617e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9023e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2889
    reference variance = 0.68199
====================================================
  Execution time = 1.3592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1416e-01
  Total weights = 1.956662323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298820322957
                                         uncertainty =       0.001823169165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298820322957
                                         uncertainty =       0.001823169165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386558517
  error estimate for blocks of size 2^( 2) =       0.000396911110
  error estimate for blocks of size 2^( 3) =       0.000406385326
  error estimate for blocks of size 2^( 4) =       0.000413783156
  error estimate for blocks of size 2^( 5) =       0.000418237722
  error estimate for blocks of size 2^( 6) =       0.000420992295
  error estimate for blocks of size 2^( 7) =       0.000424262371

      target function =      -0.883996343545
              le_mean =     -17.215442330532
             les_mean =     296.685610463889
             stat err =       0.000419318886
             autocorr =       1.176679949238
   target nu stat err =       0.000419318886
   target dn stat err =       0.002615057483
      target stat err =       0.003237762673
              std dev =       0.546676297646
             le_variance =       0.298854974408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721544233053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884007496411       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886088308038       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886437313937       residual = 9.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886533574848       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886544058095       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886546997494       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886547506622       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886547403180       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886547389579       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886547398268       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886547415399       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886547425167       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.464012e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884007496411       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884598020436       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884694117228       residual = 8.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884719609758       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884722301773       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884723030124       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884723154881       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884723123820       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884723120775       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884723123479       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884723127596       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884723129853       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 4.058317e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.884007496411       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884160277826       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884184916348       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884191377779       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884192054181       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884192235149       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884192266067       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884192257950       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884192257225       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884192257938       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884192258951       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884192259501       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.042874e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6091e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.739979e-02 3 1  ON 0
ci_002                -3.592834e-02 3 1  ON 1
ci_003                -2.844671e-02 3 1  ON 2
ci_004                 2.632832e-02 3 1  ON 3
ci_005                 2.647716e-02 3 1  ON 4
ci_006                -2.364851e-02 3 1  ON 5
ci_007                -2.390979e-02 3 1  ON 6
ci_008                -1.388415e-02 3 1  ON 7
ci_009                -1.840108e-02 3 1  ON 8
ci_010                -1.481824e-02 3 1  ON 9
ci_011                -1.467254e-02 3 1  ON 10
ci_012                -1.468696e-02 3 1  ON 11
ci_013                -2.223061e-02 3 1  ON 12
ci_014                 1.583478e-02 3 1  ON 13
ci_015                 1.560059e-02 3 1  ON 14
ci_016                 1.873348e-02 3 1  ON 15
ci_017                 1.866931e-02 3 1  ON 16
ci_018                 1.372853e-02 3 1  ON 17
ci_019                 1.360740e-02 3 1  ON 18
ci_020                 1.842307e-02 3 1  ON 19
ci_021                 1.827983e-02 3 1  ON 20
ci_022                 1.217873e-02 3 1  ON 21
ci_023                 1.212681e-02 3 1  ON 22
ci_024                 1.310722e-02 3 1  ON 23
ci_025                 1.332471e-02 3 1  ON 24
ci_026                 1.335962e-02 3 1  ON 25
ci_027                 1.359879e-02 3 1  ON 26
ci_028                -1.663704e-02 3 1  ON 27
ci_029                -1.695312e-02 3 1  ON 28
ci_030                -1.180620e-02 3 1  ON 29
ci_031                -1.189599e-02 3 1  ON 30
ci_032                -1.577199e-02 3 1  ON 31
ci_033                 9.472185e-03 3 1  ON 32
ci_034                 9.373518e-03 3 1  ON 33
ci_035                -7.517429e-03 3 1  ON 34
ci_036                -1.392411e-02 3 1  ON 35
ci_037                -1.358946e-02 3 1  ON 36
ci_038                 5.506728e-03 3 1  ON 37
ci_039                 5.536650e-03 3 1  ON 38
ci_040                -5.610865e-03 3 1  ON 39
ci_041                 9.964723e-03 3 1  ON 40
ci_042                 1.044706e-02 3 1  ON 41
ci_043                -6.256869e-03 3 1  ON 42
ci_044                -7.529894e-03 3 1  ON 43
ci_045                -5.670145e-03 3 1  ON 44
ci_046                 7.877210e-03 3 1  ON 45
ci_047                 7.959680e-03 3 1  ON 46
ci_048                -1.285744e-02 3 1  ON 47
ci_049                -1.308589e-02 3 1  ON 48
ci_050                 5.571236e-03 3 1  ON 49
ci_051                 5.736583e-03 3 1  ON 50
ci_052                -4.812771e-03 3 1  ON 51
ci_053                -4.966176e-03 3 1  ON 52
ci_054                -5.594756e-03 3 1  ON 53
ci_055                -5.529134e-03 3 1  ON 54
ci_056                 6.867561e-03 3 1  ON 55
ci_057                 7.039770e-03 3 1  ON 56
ci_058                -4.560873e-03 3 1  ON 57
ci_059                -4.767010e-03 3 1  ON 58
ci_060                 6.871982e-03 3 1  ON 59
ci_061                 7.187382e-03 3 1  ON 60
ci_062                -5.810050e-03 3 1  ON 61
ci_063                -5.620720e-03 3 1  ON 62
ci_064                -4.546949e-03 3 1  ON 63
ci_065                -5.309279e-03 3 1  ON 64
ci_066                 5.910454e-03 3 1  ON 65
ci_067                 6.006170e-03 3 1  ON 66
ci_068                -6.133803e-03 3 1  ON 67
ci_069                -5.934653e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2526
    reference variance = 0.513035
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0981e-01
  Total weights = 1.9563e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297609245941
                                         uncertainty =       0.001686308647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297609245941
                                         uncertainty =       0.001686308647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385817588
  error estimate for blocks of size 2^( 2) =       0.000396202296
  error estimate for blocks of size 2^( 3) =       0.000405492002
  error estimate for blocks of size 2^( 4) =       0.000412521030
  error estimate for blocks of size 2^( 5) =       0.000416722662
  error estimate for blocks of size 2^( 6) =       0.000420385300
  error estimate for blocks of size 2^( 7) =       0.000423403745

      target function =      -0.886995017400
              le_mean =     -17.214848133822
             les_mean =     296.662606242225
             stat err =       0.000418258184
             autocorr =       1.175235368621
   target nu stat err =       0.000418258184
   target dn stat err =       0.002606610543
      target stat err =       0.003245952533
              std dev =       0.545628464891
             le_variance =       0.297710421700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293513609872
                                         uncertainty =       0.001640428104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293513609872
                                         uncertainty =       0.001640428104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383159498
  error estimate for blocks of size 2^( 2) =       0.000393567818
  error estimate for blocks of size 2^( 3) =       0.000402926160
  error estimate for blocks of size 2^( 4) =       0.000410018615
  error estimate for blocks of size 2^( 5) =       0.000414238354
  error estimate for blocks of size 2^( 6) =       0.000417955826
  error estimate for blocks of size 2^( 7) =       0.000421043983

      target function =      -0.873344319396
              le_mean =     -17.214905034064
             les_mean =     296.675660726565
             stat err =       0.000415814194
             autocorr =       1.177712894547
   target nu stat err =       0.000415814194
   target dn stat err =       0.013178551085
      target stat err =       0.015672032082
              std dev =       0.541869358567
             le_variance =       0.293622401754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295160084191
                                         uncertainty =       0.001660659176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295160084191
                                         uncertainty =       0.001660659176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384229868
  error estimate for blocks of size 2^( 2) =       0.000394624836
  error estimate for blocks of size 2^( 3) =       0.000403953477
  error estimate for blocks of size 2^( 4) =       0.000411018553
  error estimate for blocks of size 2^( 5) =       0.000415230091
  error estimate for blocks of size 2^( 6) =       0.000418901423
  error estimate for blocks of size 2^( 7) =       0.000421954419

      target function =      -0.863125794174
              le_mean =     -17.214864969958
             les_mean =     296.682557579386
             stat err =       0.000416776121
             autocorr =       1.176585291277
   target nu stat err =       0.000416776121
   target dn stat err =       0.022117371750
      target stat err =       0.025692487821
              std dev =       0.543383090079
             le_variance =       0.295265182584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297275058857
                                         uncertainty =       0.001682725824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297275058857
                                         uncertainty =       0.001682725824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385601277
  error estimate for blocks of size 2^( 2) =       0.000395986878
  error estimate for blocks of size 2^( 3) =       0.000405281036
  error estimate for blocks of size 2^( 4) =       0.000412313792
  error estimate for blocks of size 2^( 5) =       0.000416515912
  error estimate for blocks of size 2^( 6) =       0.000420180936
  error estimate for blocks of size 2^( 7) =       0.000423204281

      target function =      -0.887704274071
              le_mean =     -17.214847632415
             les_mean =     296.662010656030
             stat err =       0.000418053731
             autocorr =       1.175404309908
   target nu stat err =       0.000418053731
   target dn stat err =       0.002589980336
      target stat err =       0.003230926322
              std dev =       0.545322556041
             le_variance =       0.297376690127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.886995017400        initial
     3.9062e-01     3.9062e+00             1.4640e-03        -0.873344319396
     1.5625e+00     1.5625e+01             4.0583e-04        -0.863125794174
     6.2500e+00     6.2500e+01             1.0429e-04        -0.887704274071  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2974e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.770134e-02 3 1  ON 0
ci_002                -3.618019e-02 3 1  ON 1
ci_003                -2.859760e-02 3 1  ON 2
ci_004                 2.646441e-02 3 1  ON 3
ci_005                 2.664805e-02 3 1  ON 4
ci_006                -2.379175e-02 3 1  ON 5
ci_007                -2.405946e-02 3 1  ON 6
ci_008                -1.410760e-02 3 1  ON 7
ci_009                -1.855466e-02 3 1  ON 8
ci_010                -1.499532e-02 3 1  ON 9
ci_011                -1.485997e-02 3 1  ON 10
ci_012                -1.486361e-02 3 1  ON 11
ci_013                -2.231059e-02 3 1  ON 12
ci_014                 1.596371e-02 3 1  ON 13
ci_015                 1.574445e-02 3 1  ON 14
ci_016                 1.889523e-02 3 1  ON 15
ci_017                 1.877373e-02 3 1  ON 16
ci_018                 1.384915e-02 3 1  ON 17
ci_019                 1.376861e-02 3 1  ON 18
ci_020                 1.850351e-02 3 1  ON 19
ci_021                 1.838582e-02 3 1  ON 20
ci_022                 1.231310e-02 3 1  ON 21
ci_023                 1.225254e-02 3 1  ON 22
ci_024                 1.323190e-02 3 1  ON 23
ci_025                 1.345936e-02 3 1  ON 24
ci_026                 1.348763e-02 3 1  ON 25
ci_027                 1.370823e-02 3 1  ON 26
ci_028                -1.672132e-02 3 1  ON 27
ci_029                -1.699388e-02 3 1  ON 28
ci_030                -1.191347e-02 3 1  ON 29
ci_031                -1.201846e-02 3 1  ON 30
ci_032                -1.581684e-02 3 1  ON 31
ci_033                 9.610234e-03 3 1  ON 32
ci_034                 9.485269e-03 3 1  ON 33
ci_035                -7.663464e-03 3 1  ON 34
ci_036                -1.402389e-02 3 1  ON 35
ci_037                -1.363652e-02 3 1  ON 36
ci_038                 5.682541e-03 3 1  ON 37
ci_039                 5.707640e-03 3 1  ON 38
ci_040                -5.757930e-03 3 1  ON 39
ci_041                 1.005812e-02 3 1  ON 40
ci_042                 1.053559e-02 3 1  ON 41
ci_043                -6.394501e-03 3 1  ON 42
ci_044                -7.621404e-03 3 1  ON 43
ci_045                -5.798804e-03 3 1  ON 44
ci_046                 7.990725e-03 3 1  ON 45
ci_047                 8.062465e-03 3 1  ON 46
ci_048                -1.287798e-02 3 1  ON 47
ci_049                -1.310497e-02 3 1  ON 48
ci_050                 5.632463e-03 3 1  ON 49
ci_051                 5.840892e-03 3 1  ON 50
ci_052                -4.938471e-03 3 1  ON 51
ci_053                -5.070949e-03 3 1  ON 52
ci_054                -5.703978e-03 3 1  ON 53
ci_055                -5.637093e-03 3 1  ON 54
ci_056                 6.957816e-03 3 1  ON 55
ci_057                 7.114476e-03 3 1  ON 56
ci_058                -4.645930e-03 3 1  ON 57
ci_059                -4.800419e-03 3 1  ON 58
ci_060                 6.926630e-03 3 1  ON 59
ci_061                 7.280334e-03 3 1  ON 60
ci_062                -5.932851e-03 3 1  ON 61
ci_063                -5.714132e-03 3 1  ON 62
ci_064                -4.625473e-03 3 1  ON 63
ci_065                -5.383968e-03 3 1  ON 64
ci_066                 5.966845e-03 3 1  ON 65
ci_067                 6.058018e-03 3 1  ON 66
ci_068                -6.178415e-03 3 1  ON 67
ci_069                -5.973144e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.222627
====================================================
  Execution time = 1.4006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1647e-01
  Total weights = 1.956536907e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299885550073
                                         uncertainty =       0.001725869840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299885550073
                                         uncertainty =       0.001725869840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387243280
  error estimate for blocks of size 2^( 2) =       0.000397346413
  error estimate for blocks of size 2^( 3) =       0.000406352811
  error estimate for blocks of size 2^( 4) =       0.000413311770
  error estimate for blocks of size 2^( 5) =       0.000416531694
  error estimate for blocks of size 2^( 6) =       0.000418534858
  error estimate for blocks of size 2^( 7) =       0.000419688651

      target function =      -0.881087220266
              le_mean =     -17.214885364596
             les_mean =     296.668744877697
             stat err =       0.000417016743
             autocorr =       1.159682772583
   target nu stat err =       0.000417016743
   target dn stat err =       0.002912277448
      target stat err =       0.003567705911
              std dev =       0.547644697919
             le_variance =       0.299914715159


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721488536460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881100977573       residual = 3.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881780119689       residual = 4.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881896281078       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881930557737       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881934843572       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881935684821       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881935838939       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881935867743       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881935846726       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881935860077       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881935864907       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881935863616       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 4.147997e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881100977573       residual = 3.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881276775594       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881306565343       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881315255729       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881316332120       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881316541653       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881316579177       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881316586179       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881316580920       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881316584173       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881316585388       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881316585054       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 1.065540e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.881100977573       residual = 3.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881145319310       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.881152814842       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.881154994940       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.881155264302       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.881155316624       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.881155325938       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.881155327676       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.881155326362       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.881155327169       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.881155327473       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.881155327389       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 2.682285e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6517e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.759478e-02 3 1  ON 0
ci_002                -3.609861e-02 3 1  ON 1
ci_003                -2.853510e-02 3 1  ON 2
ci_004                 2.640894e-02 3 1  ON 3
ci_005                 2.659795e-02 3 1  ON 4
ci_006                -2.373036e-02 3 1  ON 5
ci_007                -2.400819e-02 3 1  ON 6
ci_008                -1.403585e-02 3 1  ON 7
ci_009                -1.850348e-02 3 1  ON 8
ci_010                -1.494840e-02 3 1  ON 9
ci_011                -1.478142e-02 3 1  ON 10
ci_012                -1.478607e-02 3 1  ON 11
ci_013                -2.228649e-02 3 1  ON 12
ci_014                 1.591987e-02 3 1  ON 13
ci_015                 1.568877e-02 3 1  ON 14
ci_016                 1.884845e-02 3 1  ON 15
ci_017                 1.873972e-02 3 1  ON 16
ci_018                 1.378336e-02 3 1  ON 17
ci_019                 1.371408e-02 3 1  ON 18
ci_020                 1.846348e-02 3 1  ON 19
ci_021                 1.836397e-02 3 1  ON 20
ci_022                 1.226593e-02 3 1  ON 21
ci_023                 1.220492e-02 3 1  ON 22
ci_024                 1.318056e-02 3 1  ON 23
ci_025                 1.341780e-02 3 1  ON 24
ci_026                 1.344278e-02 3 1  ON 25
ci_027                 1.364711e-02 3 1  ON 26
ci_028                -1.670038e-02 3 1  ON 27
ci_029                -1.697670e-02 3 1  ON 28
ci_030                -1.187393e-02 3 1  ON 29
ci_031                -1.199060e-02 3 1  ON 30
ci_032                -1.579955e-02 3 1  ON 31
ci_033                 9.548597e-03 3 1  ON 32
ci_034                 9.435781e-03 3 1  ON 33
ci_035                -7.609737e-03 3 1  ON 34
ci_036                -1.400694e-02 3 1  ON 35
ci_037                -1.361624e-02 3 1  ON 36
ci_038                 5.619848e-03 3 1  ON 37
ci_039                 5.648925e-03 3 1  ON 38
ci_040                -5.708416e-03 3 1  ON 39
ci_041                 1.003114e-02 3 1  ON 40
ci_042                 1.049454e-02 3 1  ON 41
ci_043                -6.346148e-03 3 1  ON 42
ci_044                -7.584986e-03 3 1  ON 43
ci_045                -5.748813e-03 3 1  ON 44
ci_046                 7.951970e-03 3 1  ON 45
ci_047                 8.029311e-03 3 1  ON 46
ci_048                -1.286479e-02 3 1  ON 47
ci_049                -1.309402e-02 3 1  ON 48
ci_050                 5.578400e-03 3 1  ON 49
ci_051                 5.805752e-03 3 1  ON 50
ci_052                -4.900480e-03 3 1  ON 51
ci_053                -5.020802e-03 3 1  ON 52
ci_054                -5.662408e-03 3 1  ON 53
ci_055                -5.605829e-03 3 1  ON 54
ci_056                 6.936917e-03 3 1  ON 55
ci_057                 7.078855e-03 3 1  ON 56
ci_058                -4.609091e-03 3 1  ON 57
ci_059                -4.774097e-03 3 1  ON 58
ci_060                 6.912842e-03 3 1  ON 59
ci_061                 7.248541e-03 3 1  ON 60
ci_062                -5.904728e-03 3 1  ON 61
ci_063                -5.682602e-03 3 1  ON 62
ci_064                -4.602082e-03 3 1  ON 63
ci_065                -5.358661e-03 3 1  ON 64
ci_066                 5.939215e-03 3 1  ON 65
ci_067                 6.034390e-03 3 1  ON 66
ci_068                -6.159521e-03 3 1  ON 67
ci_069                -5.973459e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.211225
====================================================
  Execution time = 1.6104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1313e-01
  Total weights = 1.9564e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300708347006
                                         uncertainty =       0.002155672606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300708347006
                                         uncertainty =       0.002155672606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387739281
  error estimate for blocks of size 2^( 2) =       0.000397907839
  error estimate for blocks of size 2^( 3) =       0.000407120634
  error estimate for blocks of size 2^( 4) =       0.000414243056
  error estimate for blocks of size 2^( 5) =       0.000417486258
  error estimate for blocks of size 2^( 6) =       0.000419580105
  error estimate for blocks of size 2^( 7) =       0.000419390718

      target function =      -0.884386286820
              le_mean =     -17.214653518974
             les_mean =     296.658010686665
             stat err =       0.000417675034
             autocorr =       1.160372513242
   target nu stat err =       0.000417675034
   target dn stat err =       0.002661729710
      target stat err =       0.003292141498
              std dev =       0.548346149449
             le_variance =       0.300683499615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299411696977
                                         uncertainty =       0.002145161758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299411696977
                                         uncertainty =       0.002145161758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386902018
  error estimate for blocks of size 2^( 2) =       0.000397084072
  error estimate for blocks of size 2^( 3) =       0.000406316902
  error estimate for blocks of size 2^( 4) =       0.000413453565
  error estimate for blocks of size 2^( 5) =       0.000416715083
  error estimate for blocks of size 2^( 6) =       0.000418824286
  error estimate for blocks of size 2^( 7) =       0.000418620458

      target function =      -0.885483101570
              le_mean =     -17.214661505776
             les_mean =     296.657386863635
             stat err =       0.000416903348
             autocorr =       1.161097731737
   target nu stat err =       0.000416903348
   target dn stat err =       0.002729471726
      target stat err =       0.003381515592
              std dev =       0.547162080525
             le_variance =       0.299386342364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028142105
                                         uncertainty =       0.002150143018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028142105
                                         uncertainty =       0.002150143018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387300292
  error estimate for blocks of size 2^( 2) =       0.000397475496
  error estimate for blocks of size 2^( 3) =       0.000406698378
  error estimate for blocks of size 2^( 4) =       0.000413827915
  error estimate for blocks of size 2^( 5) =       0.000417080680
  error estimate for blocks of size 2^( 6) =       0.000419182388
  error estimate for blocks of size 2^( 7) =       0.000418985377

      target function =      -0.885453470817
              le_mean =     -17.214656273887
             les_mean =     296.657230944014
             stat err =       0.000417269090
             autocorr =       1.160744888629
   target nu stat err =       0.000417269090
   target dn stat err =       0.002627604109
      target stat err =       0.003258872315
              std dev =       0.547725326286
             le_variance =       0.300003033055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300621390241
                                         uncertainty =       0.002154964629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300621390241
                                         uncertainty =       0.002154964629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387683189
  error estimate for blocks of size 2^( 2) =       0.000397852537
  error estimate for blocks of size 2^( 3) =       0.000407066564
  error estimate for blocks of size 2^( 4) =       0.000414189858
  error estimate for blocks of size 2^( 5) =       0.000417434281
  error estimate for blocks of size 2^( 6) =       0.000419529128
  error estimate for blocks of size 2^( 7) =       0.000419338781

      target function =      -0.884625061068
              le_mean =     -17.214653700098
             les_mean =     296.657821021959
             stat err =       0.000417623012
             autocorr =       1.160419195486
   target nu stat err =       0.000417623012
   target dn stat err =       0.002649515802
      target stat err =       0.003279227649
              std dev =       0.548266823892
             le_variance =       0.300596510180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884386286820        initial
     1.5625e+00     1.5625e+01             4.1480e-04        -0.885483101570  <--
     6.2500e+00     6.2500e+01             1.0655e-04        -0.885453470817
     2.5000e+01     2.5000e+02             2.6823e-05        -0.884625061068

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.5369e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.728654e-02 3 1  ON 0
ci_002                -3.586323e-02 3 1  ON 1
ci_003                -2.835438e-02 3 1  ON 2
ci_004                 2.624823e-02 3 1  ON 3
ci_005                 2.645256e-02 3 1  ON 4
ci_006                -2.355323e-02 3 1  ON 5
ci_007                -2.386037e-02 3 1  ON 6
ci_008                -1.383057e-02 3 1  ON 7
ci_009                -1.835654e-02 3 1  ON 8
ci_010                -1.481327e-02 3 1  ON 9
ci_011                -1.455595e-02 3 1  ON 10
ci_012                -1.456321e-02 3 1  ON 11
ci_013                -2.221679e-02 3 1  ON 12
ci_014                 1.579388e-02 3 1  ON 13
ci_015                 1.552877e-02 3 1  ON 14
ci_016                 1.871397e-02 3 1  ON 15
ci_017                 1.864227e-02 3 1  ON 16
ci_018                 1.359492e-02 3 1  ON 17
ci_019                 1.355764e-02 3 1  ON 18
ci_020                 1.834751e-02 3 1  ON 19
ci_021                 1.830043e-02 3 1  ON 20
ci_022                 1.213067e-02 3 1  ON 21
ci_023                 1.206830e-02 3 1  ON 22
ci_024                 1.303203e-02 3 1  ON 23
ci_025                 1.329757e-02 3 1  ON 24
ci_026                 1.331380e-02 3 1  ON 25
ci_027                 1.347191e-02 3 1  ON 26
ci_028                -1.664030e-02 3 1  ON 27
ci_029                -1.692727e-02 3 1  ON 28
ci_030                -1.176056e-02 3 1  ON 29
ci_031                -1.191074e-02 3 1  ON 30
ci_032                -1.574975e-02 3 1  ON 31
ci_033                 9.371168e-03 3 1  ON 32
ci_034                 9.293317e-03 3 1  ON 33
ci_035                -7.455693e-03 3 1  ON 34
ci_036                -1.395721e-02 3 1  ON 35
ci_037                -1.355723e-02 3 1  ON 36
ci_038                 5.440266e-03 3 1  ON 37
ci_039                 5.480700e-03 3 1  ON 38
ci_040                -5.566690e-03 3 1  ON 39
ci_041                 9.953907e-03 3 1  ON 40
ci_042                 1.037709e-02 3 1  ON 41
ci_043                -6.207484e-03 3 1  ON 42
ci_044                -7.480393e-03 3 1  ON 43
ci_045                -5.605760e-03 3 1  ON 44
ci_046                 7.840448e-03 3 1  ON 45
ci_047                 7.933845e-03 3 1  ON 46
ci_048                -1.282693e-02 3 1  ON 47
ci_049                -1.306303e-02 3 1  ON 48
ci_050                 5.424180e-03 3 1  ON 49
ci_051                 5.705422e-03 3 1  ON 50
ci_052                -4.792058e-03 3 1  ON 51
ci_053                -4.877578e-03 3 1  ON 52
ci_054                -5.542858e-03 3 1  ON 53
ci_055                -5.515858e-03 3 1  ON 54
ci_056                 6.876964e-03 3 1  ON 55
ci_057                 6.976640e-03 3 1  ON 56
ci_058                -4.504034e-03 3 1  ON 57
ci_059                -4.698996e-03 3 1  ON 58
ci_060                 6.873123e-03 3 1  ON 59
ci_061                 7.156931e-03 3 1  ON 60
ci_062                -5.823550e-03 3 1  ON 61
ci_063                -5.591696e-03 3 1  ON 62
ci_064                -4.535159e-03 3 1  ON 63
ci_065                -5.286211e-03 3 1  ON 64
ci_066                 5.860251e-03 3 1  ON 65
ci_067                 5.966770e-03 3 1  ON 66
ci_068                -6.105370e-03 3 1  ON 67
ci_069                -5.974557e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.173193
====================================================
  Execution time = 1.4241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2007e-01
  Total weights = 1.956539805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300548983572
                                         uncertainty =       0.002182488027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300548983572
                                         uncertainty =       0.002182488027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387641460
  error estimate for blocks of size 2^( 2) =       0.000398290000
  error estimate for blocks of size 2^( 3) =       0.000407244081
  error estimate for blocks of size 2^( 4) =       0.000414120286
  error estimate for blocks of size 2^( 5) =       0.000418438161
  error estimate for blocks of size 2^( 6) =       0.000421688980
  error estimate for blocks of size 2^( 7) =       0.000420937844

      target function =      -0.876822550315
              le_mean =     -17.215386068108
             les_mean =     296.689587442954
             stat err =       0.000418796318
             autocorr =       1.167199970130
   target nu stat err =       0.000418796318
   target dn stat err =       0.004202752512
      target stat err =       0.005069296519
              std dev =       0.548207809969
             le_variance =       0.300531802911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721538606811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876851170903       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.878888727665       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.879265596607       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.879366286500       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.879382316252       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.879384263999       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.879384751592       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.879384530682       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.879384473082       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.879384442067       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.879384453602       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.879384454839       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.289252e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876851170903       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877429830692       residual = 3.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877533784357       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877560339728       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877564498367       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877564954114       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877565065903       residual = 9.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877565007689       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877564992568       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877564985152       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877564987905       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877564988218       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 3.569180e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.876851170903       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.877000914338       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.877027581086       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.877034303215       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.877035351091       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.877035462299       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.877035489446       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.877035474729       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.877035470913       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.877035469089       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.877035469766       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.877035469844       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 9.168351e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6730e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.692962e-02 3 1  ON 0
ci_002                -3.555767e-02 3 1  ON 1
ci_003                -2.817984e-02 3 1  ON 2
ci_004                 2.601512e-02 3 1  ON 3
ci_005                 2.625653e-02 3 1  ON 4
ci_006                -2.337449e-02 3 1  ON 5
ci_007                -2.362721e-02 3 1  ON 6
ci_008                -1.352471e-02 3 1  ON 7
ci_009                -1.822178e-02 3 1  ON 8
ci_010                -1.454100e-02 3 1  ON 9
ci_011                -1.440230e-02 3 1  ON 10
ci_012                -1.426745e-02 3 1  ON 11
ci_013                -2.210287e-02 3 1  ON 12
ci_014                 1.550953e-02 3 1  ON 13
ci_015                 1.532184e-02 3 1  ON 14
ci_016                 1.860504e-02 3 1  ON 15
ci_017                 1.855260e-02 3 1  ON 16
ci_018                 1.338928e-02 3 1  ON 17
ci_019                 1.337913e-02 3 1  ON 18
ci_020                 1.819633e-02 3 1  ON 19
ci_021                 1.817414e-02 3 1  ON 20
ci_022                 1.189162e-02 3 1  ON 21
ci_023                 1.192737e-02 3 1  ON 22
ci_024                 1.288005e-02 3 1  ON 23
ci_025                 1.309588e-02 3 1  ON 24
ci_026                 1.320392e-02 3 1  ON 25
ci_027                 1.328022e-02 3 1  ON 26
ci_028                -1.654395e-02 3 1  ON 27
ci_029                -1.691366e-02 3 1  ON 28
ci_030                -1.162161e-02 3 1  ON 29
ci_031                -1.176166e-02 3 1  ON 30
ci_032                -1.568320e-02 3 1  ON 31
ci_033                 9.167859e-03 3 1  ON 32
ci_034                 9.192890e-03 3 1  ON 33
ci_035                -7.270752e-03 3 1  ON 34
ci_036                -1.385173e-02 3 1  ON 35
ci_037                -1.351895e-02 3 1  ON 36
ci_038                 5.268249e-03 3 1  ON 37
ci_039                 5.271001e-03 3 1  ON 38
ci_040                -5.380084e-03 3 1  ON 39
ci_041                 9.868778e-03 3 1  ON 40
ci_042                 1.019550e-02 3 1  ON 41
ci_043                -6.033716e-03 3 1  ON 42
ci_044                -7.251169e-03 3 1  ON 43
ci_045                -5.413753e-03 3 1  ON 44
ci_046                 7.722500e-03 3 1  ON 45
ci_047                 7.804176e-03 3 1  ON 46
ci_048                -1.277904e-02 3 1  ON 47
ci_049                -1.306434e-02 3 1  ON 48
ci_050                 5.326414e-03 3 1  ON 49
ci_051                 5.575205e-03 3 1  ON 50
ci_052                -4.717702e-03 3 1  ON 51
ci_053                -4.736243e-03 3 1  ON 52
ci_054                -5.410055e-03 3 1  ON 53
ci_055                -5.382895e-03 3 1  ON 54
ci_056                 6.846983e-03 3 1  ON 55
ci_057                 6.884984e-03 3 1  ON 56
ci_058                -4.365457e-03 3 1  ON 57
ci_059                -4.505173e-03 3 1  ON 58
ci_060                 6.783186e-03 3 1  ON 59
ci_061                 7.187246e-03 3 1  ON 60
ci_062                -5.676893e-03 3 1  ON 61
ci_063                -5.526664e-03 3 1  ON 62
ci_064                -4.463445e-03 3 1  ON 63
ci_065                -5.196843e-03 3 1  ON 64
ci_066                 5.771160e-03 3 1  ON 65
ci_067                 5.924966e-03 3 1  ON 66
ci_068                -5.995184e-03 3 1  ON 67
ci_069                -5.895080e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.3611
    reference variance = 0.465997
====================================================
  Execution time = 1.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0879e-01
  Total weights = 1.9562e+06
  Execution time = 1.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298143928010
                                         uncertainty =       0.002028574364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298143928010
                                         uncertainty =       0.002028574364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386065555
  error estimate for blocks of size 2^( 2) =       0.000396379570
  error estimate for blocks of size 2^( 3) =       0.000405441242
  error estimate for blocks of size 2^( 4) =       0.000413021325
  error estimate for blocks of size 2^( 5) =       0.000417969454
  error estimate for blocks of size 2^( 6) =       0.000419266734
  error estimate for blocks of size 2^( 7) =       0.000418560136

      target function =      -0.083786310032
              le_mean =     -17.215519219596
             les_mean =     300.456368541300
             stat err =       0.000417204412
             autocorr =       1.167819371791
   target nu stat err =       0.000417204412
   target dn stat err =       3.770857847063
      target stat err =       0.070309617095
              std dev =       0.545979143823
             le_variance =       0.298093225490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293553982683
                                         uncertainty =       0.001806437396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293553982683
                                         uncertainty =       0.001806437396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383082185
  error estimate for blocks of size 2^( 2) =       0.000393481905
  error estimate for blocks of size 2^( 3) =       0.000402654621
  error estimate for blocks of size 2^( 4) =       0.000410357069
  error estimate for blocks of size 2^( 5) =       0.000415286650
  error estimate for blocks of size 2^( 6) =       0.000416495471
  error estimate for blocks of size 2^( 7) =       0.000415929221

      target function =      -0.892629329983
              le_mean =     -17.215574541526
             les_mean =     296.683166047339
             stat err =       0.000414517103
             autocorr =       1.170849286603
   target nu stat err =       0.000414517103
   target dn stat err =       0.002622897087
      target stat err =       0.003309394804
              std dev =       0.541760021642
             le_variance =       0.293503921050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295136705562
                                         uncertainty =       0.001829507717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295136705562
                                         uncertainty =       0.001829507717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384113366
  error estimate for blocks of size 2^( 2) =       0.000394482306
  error estimate for blocks of size 2^( 3) =       0.000403612508
  error estimate for blocks of size 2^( 4) =       0.000411268127
  error estimate for blocks of size 2^( 5) =       0.000416181505
  error estimate for blocks of size 2^( 6) =       0.000417390391
  error estimate for blocks of size 2^( 7) =       0.000416835105

      target function =      -0.880602347346
              le_mean =     -17.215543746637
             les_mean =     296.691807036821
             stat err =       0.000415418782
             autocorr =       1.169643245485
   target nu stat err =       0.000415418782
   target dn stat err =       0.009208785963
      target stat err =       0.011150563515
              std dev =       0.543218331370
             le_variance =       0.295086155536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297110843760
                                         uncertainty =       0.001857513870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297110843760
                                         uncertainty =       0.001857513870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385395701
  error estimate for blocks of size 2^( 2) =       0.000395736017
  error estimate for blocks of size 2^( 3) =       0.000404825336
  error estimate for blocks of size 2^( 4) =       0.000412433497
  error estimate for blocks of size 2^( 5) =       0.000417331221
  error estimate for blocks of size 2^( 6) =       0.000418545530
  error estimate for blocks of size 2^( 7) =       0.000418019939

      target function =      -0.888657565424
              le_mean =     -17.215538004258
             les_mean =     296.685114823067
             stat err =       0.000416582547
             autocorr =       1.168391556514
   target nu stat err =       0.000416582547
   target dn stat err =       0.002428968368
      target stat err =       0.003045994117
              std dev =       0.545031827055
             le_variance =       0.297059692503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.083786310032        initial
     3.9062e-01     3.9062e+00             1.2893e-03        -0.892629329983  <--
     1.5625e+00     1.5625e+01             3.5692e-04        -0.880602347346
     6.2500e+00     6.2500e+01             9.1684e-05        -0.888657565424

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2657e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.599729e-02 3 1  ON 0
ci_002                -3.476699e-02 3 1  ON 1
ci_003                -2.772095e-02 3 1  ON 2
ci_004                 2.540752e-02 3 1  ON 3
ci_005                 2.574130e-02 3 1  ON 4
ci_006                -2.291283e-02 3 1  ON 5
ci_007                -2.302529e-02 3 1  ON 6
ci_008                -1.275756e-02 3 1  ON 7
ci_009                -1.788091e-02 3 1  ON 8
ci_010                -1.384475e-02 3 1  ON 9
ci_011                -1.401025e-02 3 1  ON 10
ci_012                -1.351263e-02 3 1  ON 11
ci_013                -2.180505e-02 3 1  ON 12
ci_014                 1.478329e-02 3 1  ON 13
ci_015                 1.479292e-02 3 1  ON 14
ci_016                 1.832874e-02 3 1  ON 15
ci_017                 1.832846e-02 3 1  ON 16
ci_018                 1.286714e-02 3 1  ON 17
ci_019                 1.292465e-02 3 1  ON 18
ci_020                 1.780067e-02 3 1  ON 19
ci_021                 1.784256e-02 3 1  ON 20
ci_022                 1.128164e-02 3 1  ON 21
ci_023                 1.156725e-02 3 1  ON 22
ci_024                 1.248131e-02 3 1  ON 23
ci_025                 1.257105e-02 3 1  ON 24
ci_026                 1.291735e-02 3 1  ON 25
ci_027                 1.279088e-02 3 1  ON 26
ci_028                -1.629729e-02 3 1  ON 27
ci_029                -1.687885e-02 3 1  ON 28
ci_030                -1.126940e-02 3 1  ON 29
ci_031                -1.138567e-02 3 1  ON 30
ci_032                -1.551032e-02 3 1  ON 31
ci_033                 8.644363e-03 3 1  ON 32
ci_034                 8.934235e-03 3 1  ON 33
ci_035                -6.802049e-03 3 1  ON 34
ci_036                -1.357553e-02 3 1  ON 35
ci_037                -1.341204e-02 3 1  ON 36
ci_038                 4.833924e-03 3 1  ON 37
ci_039                 4.741292e-03 3 1  ON 38
ci_040                -4.910296e-03 3 1  ON 39
ci_041                 9.654352e-03 3 1  ON 40
ci_042                 9.741756e-03 3 1  ON 41
ci_043                -5.593252e-03 3 1  ON 42
ci_044                -6.663967e-03 3 1  ON 43
ci_045                -4.930133e-03 3 1  ON 44
ci_046                 7.419728e-03 3 1  ON 45
ci_047                 7.471881e-03 3 1  ON 46
ci_048                -1.265938e-02 3 1  ON 47
ci_049                -1.307263e-02 3 1  ON 48
ci_050                 5.082419e-03 3 1  ON 49
ci_051                 5.249282e-03 3 1  ON 50
ci_052                -4.534311e-03 3 1  ON 51
ci_053                -4.387206e-03 3 1  ON 52
ci_054                -5.068360e-03 3 1  ON 53
ci_055                -5.042442e-03 3 1  ON 54
ci_056                 6.769969e-03 3 1  ON 55
ci_057                 6.652483e-03 3 1  ON 56
ci_058                -4.021573e-03 3 1  ON 57
ci_059                -4.025124e-03 3 1  ON 58
ci_060                 6.552738e-03 3 1  ON 59
ci_061                 7.264696e-03 3 1  ON 60
ci_062                -5.300067e-03 3 1  ON 61
ci_063                -5.356991e-03 3 1  ON 62
ci_064                -4.283153e-03 3 1  ON 63
ci_065                -4.971395e-03 3 1  ON 64
ci_066                 5.547840e-03 3 1  ON 65
ci_067                 5.819798e-03 3 1  ON 66
ci_068                -5.715122e-03 3 1  ON 67
ci_069                -5.694207e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2745
    reference variance = 0.818626
====================================================
  Execution time = 1.3954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0731e-01
  Total weights = 1.956381830e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295294577727
                                         uncertainty =       0.001975979878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295294577727
                                         uncertainty =       0.001975979878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384253944
  error estimate for blocks of size 2^( 2) =       0.000394798961
  error estimate for blocks of size 2^( 3) =       0.000404652951
  error estimate for blocks of size 2^( 4) =       0.000411478076
  error estimate for blocks of size 2^( 5) =       0.000416344598
  error estimate for blocks of size 2^( 6) =       0.000417657305
  error estimate for blocks of size 2^( 7) =       0.000416604964

      target function =      -0.892406641014
              le_mean =     -17.215386957689
             les_mean =     296.676858367170
             stat err =       0.000415521236
             autocorr =       1.169364161080
   target nu stat err =       0.000415521236
   target dn stat err =       0.002284625513
      target stat err =       0.002894492401
              std dev =       0.543417139366
             le_variance =       0.295302187356


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721538695769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892415430229       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896502316063       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897228535043       residual = 7.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897445609098       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897476791995       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897481850093       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897482261156       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897482789965       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897482558933       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897482561106       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897482601114       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897482614850       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 3.060160e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892415430229       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.893931529262       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894183798194       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894253031501       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894262269267       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894263691778       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894263740524       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894263864048       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894263797367       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894263799204       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894263810733       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 1.067524e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892415430229       residual = 1.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.892846372579       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.892916034958       residual = 5.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.892934471051       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.892936860751       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.892937220910       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.892937226612       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.892937255104       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.892937238221       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.892937238828       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.892937241779       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.960297e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6507e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.492976e-02 3 1  ON 0
ci_002                -3.391333e-02 3 1  ON 1
ci_003                -2.726356e-02 3 1  ON 2
ci_004                 2.488631e-02 3 1  ON 3
ci_005                 2.517151e-02 3 1  ON 4
ci_006                -2.228308e-02 3 1  ON 5
ci_007                -2.228248e-02 3 1  ON 6
ci_008                -1.198983e-02 3 1  ON 7
ci_009                -1.721864e-02 3 1  ON 8
ci_010                -1.304276e-02 3 1  ON 9
ci_011                -1.319206e-02 3 1  ON 10
ci_012                -1.284889e-02 3 1  ON 11
ci_013                -2.155457e-02 3 1  ON 12
ci_014                 1.418537e-02 3 1  ON 13
ci_015                 1.435860e-02 3 1  ON 14
ci_016                 1.784088e-02 3 1  ON 15
ci_017                 1.787398e-02 3 1  ON 16
ci_018                 1.205062e-02 3 1  ON 17
ci_019                 1.237227e-02 3 1  ON 18
ci_020                 1.730666e-02 3 1  ON 19
ci_021                 1.750570e-02 3 1  ON 20
ci_022                 1.083167e-02 3 1  ON 21
ci_023                 1.101624e-02 3 1  ON 22
ci_024                 1.190579e-02 3 1  ON 23
ci_025                 1.195285e-02 3 1  ON 24
ci_026                 1.238030e-02 3 1  ON 25
ci_027                 1.245579e-02 3 1  ON 26
ci_028                -1.603414e-02 3 1  ON 27
ci_029                -1.679212e-02 3 1  ON 28
ci_030                -1.069293e-02 3 1  ON 29
ci_031                -1.100094e-02 3 1  ON 30
ci_032                -1.530647e-02 3 1  ON 31
ci_033                 8.204143e-03 3 1  ON 32
ci_034                 8.107241e-03 3 1  ON 33
ci_035                -6.234157e-03 3 1  ON 34
ci_036                -1.317252e-02 3 1  ON 35
ci_037                -1.328048e-02 3 1  ON 36
ci_038                 4.167504e-03 3 1  ON 37
ci_039                 4.156836e-03 3 1  ON 38
ci_040                -4.302234e-03 3 1  ON 39
ci_041                 9.426899e-03 3 1  ON 40
ci_042                 9.408819e-03 3 1  ON 41
ci_043                -5.005643e-03 3 1  ON 42
ci_044                -6.218371e-03 3 1  ON 43
ci_045                -4.435059e-03 3 1  ON 44
ci_046                 6.912779e-03 3 1  ON 45
ci_047                 7.008543e-03 3 1  ON 46
ci_048                -1.262754e-02 3 1  ON 47
ci_049                -1.295984e-02 3 1  ON 48
ci_050                 4.763233e-03 3 1  ON 49
ci_051                 4.813225e-03 3 1  ON 50
ci_052                -4.170757e-03 3 1  ON 51
ci_053                -4.083984e-03 3 1  ON 52
ci_054                -4.624695e-03 3 1  ON 53
ci_055                -4.664710e-03 3 1  ON 54
ci_056                 6.370856e-03 3 1  ON 55
ci_057                 6.287541e-03 3 1  ON 56
ci_058                -3.730553e-03 3 1  ON 57
ci_059                -3.747842e-03 3 1  ON 58
ci_060                 6.305420e-03 3 1  ON 59
ci_061                 7.026073e-03 3 1  ON 60
ci_062                -4.903266e-03 3 1  ON 61
ci_063                -5.000508e-03 3 1  ON 62
ci_064                -3.910642e-03 3 1  ON 63
ci_065                -4.721325e-03 3 1  ON 64
ci_066                 5.254163e-03 3 1  ON 65
ci_067                 5.340573e-03 3 1  ON 66
ci_068                -5.466894e-03 3 1  ON 67
ci_069                -5.320213e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2413
    reference variance = 0.287186
====================================================
  Execution time = 1.3394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0516e-01
  Total weights = 1.9570e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295964172112
                                         uncertainty =       0.002072075328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295964172112
                                         uncertainty =       0.002072075328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384673949
  error estimate for blocks of size 2^( 2) =       0.000395369541
  error estimate for blocks of size 2^( 3) =       0.000404775590
  error estimate for blocks of size 2^( 4) =       0.000411469033
  error estimate for blocks of size 2^( 5) =       0.000415873728
  error estimate for blocks of size 2^( 6) =       0.000418192354
  error estimate for blocks of size 2^( 7) =       0.000418442811

      target function =      -0.861079684245
              le_mean =     -17.214930378578
             les_mean =     296.686523809570
             stat err =       0.000415994482
             autocorr =       1.169471350035
   target nu stat err =       0.000415994482
   target dn stat err =       0.023143297037
      target stat err =       0.026761265261
              std dev =       0.544011115949
             le_variance =       0.295948094276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922979918
                                         uncertainty =       0.002004411420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922979918
                                         uncertainty =       0.002004411420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380069627
  error estimate for blocks of size 2^( 2) =       0.000390991388
  error estimate for blocks of size 2^( 3) =       0.000400683803
  error estimate for blocks of size 2^( 4) =       0.000407615027
  error estimate for blocks of size 2^( 5) =       0.000412202523
  error estimate for blocks of size 2^( 6) =       0.000414612106
  error estimate for blocks of size 2^( 7) =       0.000414975440

      target function =      -0.897201498260
              le_mean =     -17.215014193532
             les_mean =     296.660117211451
             stat err =       0.000412351274
             autocorr =       1.177086426382
   target nu stat err =       0.000412351274
   target dn stat err =       0.002588688516
      target stat err =       0.003297176897
              std dev =       0.537499621719
             le_variance =       0.288905843349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290367170180
                                         uncertainty =       0.002015955793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290367170180
                                         uncertainty =       0.002015955793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381018760
  error estimate for blocks of size 2^( 2) =       0.000391863020
  error estimate for blocks of size 2^( 3) =       0.000401469006
  error estimate for blocks of size 2^( 4) =       0.000408332715
  error estimate for blocks of size 2^( 5) =       0.000412886420
  error estimate for blocks of size 2^( 6) =       0.000415303972
  error estimate for blocks of size 2^( 7) =       0.000415655892

      target function =      -0.834792906866
              le_mean =     -17.214921046096
             les_mean =     296.708591469213
             stat err =       0.000413044750
             autocorr =       1.175172159817
   target nu stat err =       0.000413044750
   target dn stat err =       0.037233231061
      target stat err =       0.040515603209
              std dev =       0.538841897351
             le_variance =       0.290350590341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294844973786
                                         uncertainty =       0.002047579720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294844973786
                                         uncertainty =       0.002047579720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383946447
  error estimate for blocks of size 2^( 2) =       0.000394656410
  error estimate for blocks of size 2^( 3) =       0.000404086024
  error estimate for blocks of size 2^( 4) =       0.000410785247
  error estimate for blocks of size 2^( 5) =       0.000415221139
  error estimate for blocks of size 2^( 6) =       0.000417573153
  error estimate for blocks of size 2^( 7) =       0.000417834026

      target function =      -0.891168685457
              le_mean =     -17.214899233926
             les_mean =     296.660985124046
             stat err =       0.000415353391
             autocorr =       1.170291941190
   target nu stat err =       0.000415353391
   target dn stat err =       0.002398912096
      target stat err =       0.003023046785
              std dev =       0.542982272902
             le_variance =       0.294829748686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.861079684245        initial
     9.7656e-02     9.7656e-01             3.0602e-03        -0.897201498260  <--
     3.9062e-01     3.9062e+00             1.0675e-03        -0.834792906866
     1.5625e+00     1.5625e+01             2.9603e-04        -0.891168685457

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.2648e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.293713e-02 3 1  ON 0
ci_002                -3.237159e-02 3 1  ON 1
ci_003                -2.638733e-02 3 1  ON 2
ci_004                 2.390424e-02 3 1  ON 3
ci_005                 2.412245e-02 3 1  ON 4
ci_006                -2.114512e-02 3 1  ON 5
ci_007                -2.092897e-02 3 1  ON 6
ci_008                -1.070588e-02 3 1  ON 7
ci_009                -1.607114e-02 3 1  ON 8
ci_010                -1.163629e-02 3 1  ON 9
ci_011                -1.176802e-02 3 1  ON 10
ci_012                -1.168628e-02 3 1  ON 11
ci_013                -2.108898e-02 3 1  ON 12
ci_014                 1.313355e-02 3 1  ON 13
ci_015                 1.360183e-02 3 1  ON 14
ci_016                 1.698580e-02 3 1  ON 15
ci_017                 1.708357e-02 3 1  ON 16
ci_018                 1.065591e-02 3 1  ON 17
ci_019                 1.141447e-02 3 1  ON 18
ci_020                 1.638718e-02 3 1  ON 19
ci_021                 1.685419e-02 3 1  ON 20
ci_022                 1.005439e-02 3 1  ON 21
ci_023                 1.006429e-02 3 1  ON 22
ci_024                 1.083682e-02 3 1  ON 23
ci_025                 1.080661e-02 3 1  ON 24
ci_026                 1.144165e-02 3 1  ON 25
ci_027                 1.185528e-02 3 1  ON 26
ci_028                -1.558473e-02 3 1  ON 27
ci_029                -1.665595e-02 3 1  ON 28
ci_030                -9.714876e-03 3 1  ON 29
ci_031                -1.034187e-02 3 1  ON 30
ci_032                -1.494795e-02 3 1  ON 31
ci_033                 7.418982e-03 3 1  ON 32
ci_034                 6.635714e-03 3 1  ON 33
ci_035                -5.267400e-03 3 1  ON 34
ci_036                -1.244892e-02 3 1  ON 35
ci_037                -1.300657e-02 3 1  ON 36
ci_038                 3.039925e-03 3 1  ON 37
ci_039                 3.165899e-03 3 1  ON 38
ci_040                -3.286124e-03 3 1  ON 39
ci_041                 9.046464e-03 3 1  ON 40
ci_042                 8.861239e-03 3 1  ON 41
ci_043                -3.998581e-03 3 1  ON 42
ci_044                -5.446243e-03 3 1  ON 43
ci_045                -3.599833e-03 3 1  ON 44
ci_046                 6.015763e-03 3 1  ON 45
ci_047                 6.187392e-03 3 1  ON 46
ci_048                -1.258904e-02 3 1  ON 47
ci_049                -1.278835e-02 3 1  ON 48
ci_050                 4.238176e-03 3 1  ON 49
ci_051                 4.097890e-03 3 1  ON 50
ci_052                -3.579894e-03 3 1  ON 51
ci_053                -3.585722e-03 3 1  ON 52
ci_054                -3.846618e-03 3 1  ON 53
ci_055                -3.991139e-03 3 1  ON 54
ci_056                 5.684073e-03 3 1  ON 55
ci_057                 5.657625e-03 3 1  ON 56
ci_058                -3.262731e-03 3 1  ON 57
ci_059                -3.302500e-03 3 1  ON 58
ci_060                 5.864262e-03 3 1  ON 59
ci_061                 6.598412e-03 3 1  ON 60
ci_062                -4.191677e-03 3 1  ON 61
ci_063                -4.355430e-03 3 1  ON 62
ci_064                -3.288165e-03 3 1  ON 63
ci_065                -4.299939e-03 3 1  ON 64
ci_066                 4.761995e-03 3 1  ON 65
ci_067                 4.537696e-03 3 1  ON 66
ci_068                -5.049476e-03 3 1  ON 67
ci_069                -4.678711e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.21519
====================================================
  Execution time = 1.3818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0707e-01
  Total weights = 1.957000587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291923732523
                                         uncertainty =       0.002267479614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291923732523
                                         uncertainty =       0.002267479614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382062457
  error estimate for blocks of size 2^( 2) =       0.000392779007
  error estimate for blocks of size 2^( 3) =       0.000402326379
  error estimate for blocks of size 2^( 4) =       0.000409257846
  error estimate for blocks of size 2^( 5) =       0.000413687621
  error estimate for blocks of size 2^( 6) =       0.000416291615
  error estimate for blocks of size 2^( 7) =       0.000417948815

      target function =      -0.892655401514
              le_mean =     -17.215190897626
             les_mean =     296.669867449978
             stat err =       0.000414296474
             autocorr =       1.175854934085
   target nu stat err =       0.000414296474
   target dn stat err =       0.003337008256
      target stat err =       0.004183618239
              std dev =       0.540317908649
             le_variance =       0.291943442407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721519089763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892674339519       residual = 8.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895895750121       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896525980721       residual = 4.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896711947518       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896745796569       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896752209466       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896752278961       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896753067623       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896753127261       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896753331356       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896753307914       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.896753304119       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.896753309027       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 4.139586e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892674339519       residual = 8.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894536771521       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894873753815       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894963182389       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894977912948       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894980003938       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894979841388       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894980164900       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894980193619       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894980271584       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894980260938       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.894980261162       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 2.249243e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.892674339519       residual = 8.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.893366722958       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.893483534500       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.893511826712       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.893516097759       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.893516545330       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.893516464894       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.893516556865       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.893516568217       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.893516588212       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.893516584997       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.972047e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.354595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6324e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.073764e-02 3 1  ON 0
ci_002                -3.012234e-02 3 1  ON 1
ci_003                -2.483215e-02 3 1  ON 2
ci_004                 2.245256e-02 3 1  ON 3
ci_005                 2.316318e-02 3 1  ON 4
ci_006                -1.997821e-02 3 1  ON 5
ci_007                -1.998581e-02 3 1  ON 6
ci_008                -9.621977e-03 3 1  ON 7
ci_009                -1.478900e-02 3 1  ON 8
ci_010                -9.778201e-03 3 1  ON 9
ci_011                -1.057870e-02 3 1  ON 10
ci_012                -1.101671e-02 3 1  ON 11
ci_013                -1.996014e-02 3 1  ON 12
ci_014                 1.187411e-02 3 1  ON 13
ci_015                 1.257340e-02 3 1  ON 14
ci_016                 1.706971e-02 3 1  ON 15
ci_017                 1.686975e-02 3 1  ON 16
ci_018                 1.030953e-02 3 1  ON 17
ci_019                 1.017257e-02 3 1  ON 18
ci_020                 1.617214e-02 3 1  ON 19
ci_021                 1.572993e-02 3 1  ON 20
ci_022                 8.730756e-03 3 1  ON 21
ci_023                 8.949068e-03 3 1  ON 22
ci_024                 9.995813e-03 3 1  ON 23
ci_025                 9.774788e-03 3 1  ON 24
ci_026                 1.105378e-02 3 1  ON 25
ci_027                 1.147870e-02 3 1  ON 26
ci_028                -1.520682e-02 3 1  ON 27
ci_029                -1.582327e-02 3 1  ON 28
ci_030                -8.966684e-03 3 1  ON 29
ci_031                -9.688115e-03 3 1  ON 30
ci_032                -1.523117e-02 3 1  ON 31
ci_033                 5.792461e-03 3 1  ON 32
ci_034                 5.624663e-03 3 1  ON 33
ci_035                -4.460713e-03 3 1  ON 34
ci_036                -1.208399e-02 3 1  ON 35
ci_037                -1.250055e-02 3 1  ON 36
ci_038                 2.126650e-03 3 1  ON 37
ci_039                 2.379636e-03 3 1  ON 38
ci_040                -2.698265e-03 3 1  ON 39
ci_041                 8.378368e-03 3 1  ON 40
ci_042                 8.309993e-03 3 1  ON 41
ci_043                -3.481180e-03 3 1  ON 42
ci_044                -6.365090e-03 3 1  ON 43
ci_045                -2.839806e-03 3 1  ON 44
ci_046                 5.487955e-03 3 1  ON 45
ci_047                 5.378138e-03 3 1  ON 46
ci_048                -1.254438e-02 3 1  ON 47
ci_049                -1.245270e-02 3 1  ON 48
ci_050                 3.436323e-03 3 1  ON 49
ci_051                 3.658114e-03 3 1  ON 50
ci_052                -2.670359e-03 3 1  ON 51
ci_053                -2.731634e-03 3 1  ON 52
ci_054                -2.825564e-03 3 1  ON 53
ci_055                -3.523387e-03 3 1  ON 54
ci_056                 5.419588e-03 3 1  ON 55
ci_057                 5.597931e-03 3 1  ON 56
ci_058                -2.148564e-03 3 1  ON 57
ci_059                -2.019478e-03 3 1  ON 58
ci_060                 4.522713e-03 3 1  ON 59
ci_061                 6.000734e-03 3 1  ON 60
ci_062                -3.723887e-03 3 1  ON 61
ci_063                -3.739009e-03 3 1  ON 62
ci_064                -2.926130e-03 3 1  ON 63
ci_065                -3.853348e-03 3 1  ON 64
ci_066                 4.207937e-03 3 1  ON 65
ci_067                 4.401121e-03 3 1  ON 66
ci_068                -5.658644e-03 3 1  ON 67
ci_069                -4.465686e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1472
    reference variance = 0.425231
====================================================
  Execution time = 1.3403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0053e-01
  Total weights = 1.9575e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290619599917
                                         uncertainty =       0.001667926397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290619599917
                                         uncertainty =       0.001667926397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381165736
  error estimate for blocks of size 2^( 2) =       0.000392021806
  error estimate for blocks of size 2^( 3) =       0.000401766818
  error estimate for blocks of size 2^( 4) =       0.000409071138
  error estimate for blocks of size 2^( 5) =       0.000413062855
  error estimate for blocks of size 2^( 6) =       0.000415016181
  error estimate for blocks of size 2^( 7) =       0.000416184345

      target function =      -0.866212246927
              le_mean =     -17.215933611774
             les_mean =     296.717158280293
             stat err =       0.000413333630
             autocorr =       1.175909170005
   target nu stat err =       0.000413333630
   target dn stat err =       0.015817945849
      target stat err =       0.018533395601
              std dev =       0.539049752770
             le_variance =       0.290574635962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =    3753.303247649678
                                         uncertainty =    3734.178392038782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =    3753.303247649678
                                         uncertainty =    3734.178392038782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.043254744733
  error estimate for blocks of size 2^( 2) =       0.043257736375
  error estimate for blocks of size 2^( 3) =       0.043257597784
  error estimate for blocks of size 2^( 4) =       0.043257911251
  error estimate for blocks of size 2^( 5) =       0.043279624522
  error estimate for blocks of size 2^( 6) =       0.043281202441
  error estimate for blocks of size 2^( 7) =       0.043281767906

      target function =      -0.000000227601
              le_mean =     -17.172528207830
             les_mean = 1552818.269706569146
             stat err =       0.043275126530
             autocorr =       1.000942629484
   target nu stat err =       0.043275126530
   target dn stat err = 1553215.436560628004
      target stat err =       0.000000228157
              std dev =      61.171446638902
             le_variance =    3741.945883896046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287218866653
                                         uncertainty =       0.001619351201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287218866653
                                         uncertainty =       0.001619351201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378933204
  error estimate for blocks of size 2^( 2) =       0.000390401808
  error estimate for blocks of size 2^( 3) =       0.000400815198
  error estimate for blocks of size 2^( 4) =       0.000408652043
  error estimate for blocks of size 2^( 5) =       0.000412932067
  error estimate for blocks of size 2^( 6) =       0.000415174138
  error estimate for blocks of size 2^( 7) =       0.000416474329

      target function =      -0.869783895189
              le_mean =     -17.215950323893
             les_mean =     296.714704010411
             stat err =       0.000413308144
             autocorr =       1.189659297275
   target nu stat err =       0.000413308144
   target dn stat err =       0.015633574071
      target stat err =       0.018469216891
              std dev =       0.535892475750
             le_variance =       0.287180745565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289302753472
                                         uncertainty =       0.001642966141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289302753472
                                         uncertainty =       0.001642966141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380302076
  error estimate for blocks of size 2^( 2) =       0.000391251570
  error estimate for blocks of size 2^( 3) =       0.000401101973
  error estimate for blocks of size 2^( 4) =       0.000408482306
  error estimate for blocks of size 2^( 5) =       0.000412499821
  error estimate for blocks of size 2^( 6) =       0.000414505638
  error estimate for blocks of size 2^( 7) =       0.000415685691

      target function =      -0.882716455942
              le_mean =     -17.215845623606
             les_mean =     296.700520412009
             stat err =       0.000412793364
             autocorr =       1.178170166337
   target nu stat err =       0.000412793364
   target dn stat err =       0.008433876124
      target stat err =       0.010268227712
              std dev =       0.537828353987
             le_variance =       0.289259338353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.866212246927        initial
     2.4414e-02     2.4414e-01             4.1396e-03        -0.000000227601
     9.7656e-02     9.7656e-01             2.2492e-03        -0.869783895189
     3.9062e-01     3.9062e+00             7.9720e-04        -0.882716455942  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2668e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.217193e-02 3 1  ON 0
ci_002                -3.157438e-02 3 1  ON 1
ci_003                -2.584087e-02 3 1  ON 2
ci_004                 2.339592e-02 3 1  ON 3
ci_005                 2.378212e-02 3 1  ON 4
ci_006                -2.072808e-02 3 1  ON 5
ci_007                -2.059127e-02 3 1  ON 6
ci_008                -1.030362e-02 3 1  ON 7
ci_009                -1.560326e-02 3 1  ON 8
ci_010                -1.096016e-02 3 1  ON 9
ci_011                -1.133747e-02 3 1  ON 10
ci_012                -1.144500e-02 3 1  ON 11
ci_013                -2.070411e-02 3 1  ON 12
ci_014                 1.267162e-02 3 1  ON 13
ci_015                 1.322331e-02 3 1  ON 14
ci_016                 1.700428e-02 3 1  ON 15
ci_017                 1.699683e-02 3 1  ON 16
ci_018                 1.053391e-02 3 1  ON 17
ci_019                 1.095515e-02 3 1  ON 18
ci_020                 1.631604e-02 3 1  ON 19
ci_021                 1.645380e-02 3 1  ON 20
ci_022                 9.571945e-03 3 1  ON 21
ci_023                 9.656075e-03 3 1  ON 22
ci_024                 1.054590e-02 3 1  ON 23
ci_025                 1.044894e-02 3 1  ON 24
ci_026                 1.131051e-02 3 1  ON 25
ci_027                 1.172393e-02 3 1  ON 26
ci_028                -1.544955e-02 3 1  ON 27
ci_029                -1.635372e-02 3 1  ON 28
ci_030                -9.435555e-03 3 1  ON 29
ci_031                -1.010575e-02 3 1  ON 30
ci_032                -1.504473e-02 3 1  ON 31
ci_033                 6.837601e-03 3 1  ON 32
ci_034                 6.274477e-03 3 1  ON 33
ci_035                -4.969498e-03 3 1  ON 34
ci_036                -1.232797e-02 3 1  ON 35
ci_037                -1.283395e-02 3 1  ON 36
ci_038                 2.702157e-03 3 1  ON 37
ci_039                 2.874665e-03 3 1  ON 38
ci_040                -3.066706e-03 3 1  ON 39
ci_041                 8.798013e-03 3 1  ON 40
ci_042                 8.660504e-03 3 1  ON 41
ci_043                -3.807479e-03 3 1  ON 42
ci_044                -5.785993e-03 3 1  ON 43
ci_045                -3.316015e-03 3 1  ON 44
ci_046                 5.826992e-03 3 1  ON 45
ci_047                 5.895226e-03 3 1  ON 46
ci_048                -1.256869e-02 3 1  ON 47
ci_049                -1.266222e-02 3 1  ON 48
ci_050                 3.935476e-03 3 1  ON 49
ci_051                 3.933547e-03 3 1  ON 50
ci_052                -3.233485e-03 3 1  ON 51
ci_053                -3.260216e-03 3 1  ON 52
ci_054                -3.476778e-03 3 1  ON 53
ci_055                -3.823793e-03 3 1  ON 54
ci_056                 5.586099e-03 3 1  ON 55
ci_057                 5.635604e-03 3 1  ON 56
ci_058                -2.840616e-03 3 1  ON 57
ci_059                -2.817040e-03 3 1  ON 58
ci_060                 5.376113e-03 3 1  ON 59
ci_061                 6.384411e-03 3 1  ON 60
ci_062                -4.025226e-03 3 1  ON 61
ci_063                -4.134669e-03 3 1  ON 62
ci_064                -3.152624e-03 3 1  ON 63
ci_065                -4.134227e-03 3 1  ON 64
ci_066                 4.553251e-03 3 1  ON 65
ci_067                 4.483542e-03 3 1  ON 66
ci_068                -5.267177e-03 3 1  ON 67
ci_069                -4.597402e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1519
    reference variance = 0.19268
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0059e-01
  Total weights = 1.957124877e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287568801793
                                         uncertainty =       0.001769229063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287568801793
                                         uncertainty =       0.001769229063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379187213
  error estimate for blocks of size 2^( 2) =       0.000389885078
  error estimate for blocks of size 2^( 3) =       0.000399433519
  error estimate for blocks of size 2^( 4) =       0.000406870039
  error estimate for blocks of size 2^( 5) =       0.000410582587
  error estimate for blocks of size 2^( 6) =       0.000413585329
  error estimate for blocks of size 2^( 7) =       0.000413288765

      target function =      -0.900881150105
              le_mean =     -17.215625916440
             les_mean =     296.678364084091
             stat err =       0.000411081680
             autocorr =       1.175300384090
   target nu stat err =       0.000411081680
   target dn stat err =       0.002426530256
      target stat err =       0.003124812482
              std dev =       0.536251699295
             le_variance =       0.287565884996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721562591644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900891211473       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902006752671       residual = 9.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902236353224       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902314598131       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902321559868       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902324583324       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902323912996       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902324009787       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902323819237       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902323862277       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902323905692       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.787576e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900891211473       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901308190755       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901388612817       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901413750785       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901415785928       residual = 8.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901416642829       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901416399891       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901416414079       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901416359385       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901416372879       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901416384550       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.248880e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900891211473       residual = 5.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901010165981       residual = 8.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901032469002       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901039189477       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901039713369       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901039930586       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901039863532       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901039865825       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901039851931       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901039855523       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901039858389       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.735196e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6230e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.154704e-02 3 1  ON 0
ci_002                -3.124756e-02 3 1  ON 1
ci_003                -2.583262e-02 3 1  ON 2
ci_004                 2.303117e-02 3 1  ON 3
ci_005                 2.348192e-02 3 1  ON 4
ci_006                -2.041174e-02 3 1  ON 5
ci_007                -2.011236e-02 3 1  ON 6
ci_008                -9.748109e-03 3 1  ON 7
ci_009                -1.535283e-02 3 1  ON 8
ci_010                -1.055309e-02 3 1  ON 9
ci_011                -1.100006e-02 3 1  ON 10
ci_012                -1.120834e-02 3 1  ON 11
ci_013                -2.044862e-02 3 1  ON 12
ci_014                 1.227394e-02 3 1  ON 13
ci_015                 1.283914e-02 3 1  ON 14
ci_016                 1.681385e-02 3 1  ON 15
ci_017                 1.687879e-02 3 1  ON 16
ci_018                 1.034626e-02 3 1  ON 17
ci_019                 1.095402e-02 3 1  ON 18
ci_020                 1.605699e-02 3 1  ON 19
ci_021                 1.612451e-02 3 1  ON 20
ci_022                 9.330771e-03 3 1  ON 21
ci_023                 9.480101e-03 3 1  ON 22
ci_024                 1.030218e-02 3 1  ON 23
ci_025                 1.029744e-02 3 1  ON 24
ci_026                 1.104526e-02 3 1  ON 25
ci_027                 1.119796e-02 3 1  ON 26
ci_028                -1.529593e-02 3 1  ON 27
ci_029                -1.603527e-02 3 1  ON 28
ci_030                -9.212089e-03 3 1  ON 29
ci_031                -9.900207e-03 3 1  ON 30
ci_032                -1.487170e-02 3 1  ON 31
ci_033                 6.400761e-03 3 1  ON 32
ci_034                 6.045687e-03 3 1  ON 33
ci_035                -4.691285e-03 3 1  ON 34
ci_036                -1.212794e-02 3 1  ON 35
ci_037                -1.268006e-02 3 1  ON 36
ci_038                 2.440268e-03 3 1  ON 37
ci_039                 2.637512e-03 3 1  ON 38
ci_040                -2.920769e-03 3 1  ON 39
ci_041                 8.754573e-03 3 1  ON 40
ci_042                 8.607781e-03 3 1  ON 41
ci_043                -3.610719e-03 3 1  ON 42
ci_044                -5.199449e-03 3 1  ON 43
ci_045                -3.005212e-03 3 1  ON 44
ci_046                 5.591948e-03 3 1  ON 45
ci_047                 5.667565e-03 3 1  ON 46
ci_048                -1.272756e-02 3 1  ON 47
ci_049                -1.267031e-02 3 1  ON 48
ci_050                 3.806978e-03 3 1  ON 49
ci_051                 3.831945e-03 3 1  ON 50
ci_052                -3.098430e-03 3 1  ON 51
ci_053                -3.111991e-03 3 1  ON 52
ci_054                -3.291582e-03 3 1  ON 53
ci_055                -3.512133e-03 3 1  ON 54
ci_056                 5.484055e-03 3 1  ON 55
ci_057                 5.468818e-03 3 1  ON 56
ci_058                -2.508286e-03 3 1  ON 57
ci_059                -2.816643e-03 3 1  ON 58
ci_060                 5.332481e-03 3 1  ON 59
ci_061                 6.178107e-03 3 1  ON 60
ci_062                -3.885785e-03 3 1  ON 61
ci_063                -3.859643e-03 3 1  ON 62
ci_064                -2.986346e-03 3 1  ON 63
ci_065                -4.030985e-03 3 1  ON 64
ci_066                 4.349579e-03 3 1  ON 65
ci_067                 4.404853e-03 3 1  ON 66
ci_068                -5.123938e-03 3 1  ON 67
ci_069                -4.577989e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 0.213578
====================================================
  Execution time = 1.3336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9905e-01
  Total weights = 1.9572e+06
  Execution time = 1.8260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288020310117
                                         uncertainty =       0.001710856986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288020310117
                                         uncertainty =       0.001710856986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379472839
  error estimate for blocks of size 2^( 2) =       0.000390340805
  error estimate for blocks of size 2^( 3) =       0.000400190036
  error estimate for blocks of size 2^( 4) =       0.000407757074
  error estimate for blocks of size 2^( 5) =       0.000412127645
  error estimate for blocks of size 2^( 6) =       0.000415800865
  error estimate for blocks of size 2^( 7) =       0.000417114546

      target function =      -0.899441334416
              le_mean =     -17.215901902450
             les_mean =     296.689052687062
             stat err =       0.000413200032
             autocorr =       1.185657631221
   target nu stat err =       0.000413200032
   target dn stat err =       0.002500304238
      target stat err =       0.003208428670
              std dev =       0.536655635595
             le_variance =       0.287999271216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286215976337
                                         uncertainty =       0.001675418881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286215976337
                                         uncertainty =       0.001675418881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378281010
  error estimate for blocks of size 2^( 2) =       0.000389365437
  error estimate for blocks of size 2^( 3) =       0.000399440214
  error estimate for blocks of size 2^( 4) =       0.000407198233
  error estimate for blocks of size 2^( 5) =       0.000411683096
  error estimate for blocks of size 2^( 6) =       0.000415398445
  error estimate for blocks of size 2^( 7) =       0.000416720186

      target function =      -0.899504901325
              le_mean =     -17.215947271742
             les_mean =     296.690570815519
             stat err =       0.000412749990
             autocorr =       1.190542938186
   target nu stat err =       0.000412749990
   target dn stat err =       0.002691278535
      target stat err =       0.003446386838
              std dev =       0.534970134539
             le_variance =       0.286193044849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286593530762
                                         uncertainty =       0.001683966904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286593530762
                                         uncertainty =       0.001683966904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378530793
  error estimate for blocks of size 2^( 2) =       0.000389547531
  error estimate for blocks of size 2^( 3) =       0.000399557623
  error estimate for blocks of size 2^( 4) =       0.000407261327
  error estimate for blocks of size 2^( 5) =       0.000411709659
  error estimate for blocks of size 2^( 6) =       0.000415405989
  error estimate for blocks of size 2^( 7) =       0.000416746526

      target function =      -0.897969153110
              le_mean =     -17.215914926640
             les_mean =     296.690646710348
             stat err =       0.000412780875
             autocorr =       1.189150177642
   target nu stat err =       0.000412780875
   target dn stat err =       0.004912626299
      target stat err =       0.006207229177
              std dev =       0.535323381488
             le_variance =       0.286571122768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287779642028
                                         uncertainty =       0.001706514139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287779642028
                                         uncertainty =       0.001706514139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379314129
  error estimate for blocks of size 2^( 2) =       0.000390201309
  error estimate for blocks of size 2^( 3) =       0.000400071554
  error estimate for blocks of size 2^( 4) =       0.000407656075
  error estimate for blocks of size 2^( 5) =       0.000412038789
  error estimate for blocks of size 2^( 6) =       0.000415716123
  error estimate for blocks of size 2^( 7) =       0.000417030796

      target function =      -0.901917371132
              le_mean =     -17.215898540135
             les_mean =     296.686981684600
             stat err =       0.000413110445
             autocorr =       1.186135522627
   target nu stat err =       0.000413110445
   target dn stat err =       0.002217951851
      target stat err =       0.002874055855
              std dev =       0.536431185695
             le_variance =       0.287758416986


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899441334416        initial
     9.7656e-02     9.7656e-01             1.7876e-03        -0.899504901325
     3.9062e-01     3.9062e+00             6.2489e-04        -0.897969153110
     1.5625e+00     1.5625e+01             1.7352e-04        -0.901917371132  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2581e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.199841e-02 3 1  ON 0
ci_002                -3.148285e-02 3 1  ON 1
ci_003                -2.583997e-02 3 1  ON 2
ci_004                 2.329495e-02 3 1  ON 3
ci_005                 2.370058e-02 3 1  ON 4
ci_006                -2.063957e-02 3 1  ON 5
ci_007                -2.045786e-02 3 1  ON 6
ci_008                -1.014466e-02 3 1  ON 7
ci_009                -1.553248e-02 3 1  ON 8
ci_010                -1.084536e-02 3 1  ON 9
ci_011                -1.124208e-02 3 1  ON 10
ci_012                -1.137809e-02 3 1  ON 11
ci_013                -2.063341e-02 3 1  ON 12
ci_014                 1.256020e-02 3 1  ON 13
ci_015                 1.311456e-02 3 1  ON 14
ci_016                 1.695015e-02 3 1  ON 15
ci_017                 1.696284e-02 3 1  ON 16
ci_018                 1.048121e-02 3 1  ON 17
ci_019                 1.095538e-02 3 1  ON 18
ci_020                 1.624328e-02 3 1  ON 19
ci_021                 1.636215e-02 3 1  ON 20
ci_022                 9.503776e-03 3 1  ON 21
ci_023                 9.606383e-03 3 1  ON 22
ci_024                 1.047809e-02 3 1  ON 23
ci_025                 1.040749e-02 3 1  ON 24
ci_026                 1.123589e-02 3 1  ON 25
ci_027                 1.157489e-02 3 1  ON 26
ci_028                -1.540603e-02 3 1  ON 27
ci_029                -1.626418e-02 3 1  ON 28
ci_030                -9.371559e-03 3 1  ON 29
ci_031                -1.004710e-02 3 1  ON 30
ci_032                -1.499621e-02 3 1  ON 31
ci_033                 6.714980e-03 3 1  ON 32
ci_034                 6.210294e-03 3 1  ON 33
ci_035                -4.890513e-03 3 1  ON 34
ci_036                -1.227132e-02 3 1  ON 35
ci_037                -1.279087e-02 3 1  ON 36
ci_038                 2.627645e-03 3 1  ON 37
ci_039                 2.807162e-03 3 1  ON 38
ci_040                -3.025042e-03 3 1  ON 39
ci_041                 8.785682e-03 3 1  ON 40
ci_042                 8.645966e-03 3 1  ON 41
ci_043                -3.751639e-03 3 1  ON 42
ci_044                -5.620146e-03 3 1  ON 43
ci_045                -3.227421e-03 3 1  ON 44
ci_046                 5.760919e-03 3 1  ON 45
ci_047                 5.831160e-03 3 1  ON 46
ci_048                -1.261222e-02 3 1  ON 47
ci_049                -1.266377e-02 3 1  ON 48
ci_050                 3.898606e-03 3 1  ON 49
ci_051                 3.904442e-03 3 1  ON 50
ci_052                -3.194793e-03 3 1  ON 51
ci_053                -3.217614e-03 3 1  ON 52
ci_054                -3.424661e-03 3 1  ON 53
ci_055                -3.736211e-03 3 1  ON 54
ci_056                 5.557158e-03 3 1  ON 55
ci_057                 5.588294e-03 3 1  ON 56
ci_058                -2.745108e-03 3 1  ON 57
ci_059                -2.816132e-03 3 1  ON 58
ci_060                 5.363616e-03 3 1  ON 59
ci_061                 6.326449e-03 3 1  ON 60
ci_062                -3.986181e-03 3 1  ON 61
ci_063                -4.057126e-03 3 1  ON 62
ci_064                -3.105020e-03 3 1  ON 63
ci_065                -4.104811e-03 3 1  ON 64
ci_066                 4.495099e-03 3 1  ON 65
ci_067                 4.461042e-03 3 1  ON 66
ci_068                -5.226529e-03 3 1  ON 67
ci_069                -4.591540e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1558
    reference variance = 0.207292
====================================================
  Execution time = 1.3838e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9908e-01
  Total weights = 1.957074994e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287390520564
                                         uncertainty =       0.001625751567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287390520564
                                         uncertainty =       0.001625751567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379030467
  error estimate for blocks of size 2^( 2) =       0.000390067259
  error estimate for blocks of size 2^( 3) =       0.000399996433
  error estimate for blocks of size 2^( 4) =       0.000407348249
  error estimate for blocks of size 2^( 5) =       0.000412384322
  error estimate for blocks of size 2^( 6) =       0.000414166925
  error estimate for blocks of size 2^( 7) =       0.000415525523

      target function =      -0.902835895328
              le_mean =     -17.215808196250
             les_mean =     296.683133545183
             stat err =       0.000412356255
             autocorr =       1.183578131098
   target nu stat err =       0.000412356255
   target dn stat err =       0.001986716343
      target stat err =       0.002591885369
              std dev =       0.536030026979
             le_variance =       0.287328189823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721580819625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902842621472       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903168845198       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903231686266       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903253891428       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903256214248       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903256888854       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903256867060       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903256844084       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903256832288       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903256821418       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903256818114       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.210976e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902842621472       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902935595111       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902953031650       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902958964496       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902959557773       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902959731559       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902959726648       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902959719163       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902959716391       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902959713752       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902959713019       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.448248e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902842621472       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902866707570       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902871188885       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902872696695       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902872845490       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902872889201       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902872888030       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902872886039       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902872885360       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902872884709       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902872884532       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.724661e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6344e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.185359e-02 3 1  ON 0
ci_002                -3.137105e-02 3 1  ON 1
ci_003                -2.577178e-02 3 1  ON 2
ci_004                 2.321689e-02 3 1  ON 3
ci_005                 2.359625e-02 3 1  ON 4
ci_006                -2.052963e-02 3 1  ON 5
ci_007                -2.035313e-02 3 1  ON 6
ci_008                -1.003542e-02 3 1  ON 7
ci_009                -1.542275e-02 3 1  ON 8
ci_010                -1.079057e-02 3 1  ON 9
ci_011                -1.116651e-02 3 1  ON 10
ci_012                -1.132573e-02 3 1  ON 11
ci_013                -2.057352e-02 3 1  ON 12
ci_014                 1.250237e-02 3 1  ON 13
ci_015                 1.303792e-02 3 1  ON 14
ci_016                 1.688275e-02 3 1  ON 15
ci_017                 1.690986e-02 3 1  ON 16
ci_018                 1.044915e-02 3 1  ON 17
ci_019                 1.086643e-02 3 1  ON 18
ci_020                 1.619788e-02 3 1  ON 19
ci_021                 1.628562e-02 3 1  ON 20
ci_022                 9.444532e-03 3 1  ON 21
ci_023                 9.554100e-03 3 1  ON 22
ci_024                 1.040037e-02 3 1  ON 23
ci_025                 1.027441e-02 3 1  ON 24
ci_026                 1.117791e-02 3 1  ON 25
ci_027                 1.149583e-02 3 1  ON 26
ci_028                -1.538382e-02 3 1  ON 27
ci_029                -1.620029e-02 3 1  ON 28
ci_030                -9.325933e-03 3 1  ON 29
ci_031                -9.963152e-03 3 1  ON 30
ci_032                -1.495205e-02 3 1  ON 31
ci_033                 6.633351e-03 3 1  ON 32
ci_034                 6.165255e-03 3 1  ON 33
ci_035                -4.816610e-03 3 1  ON 34
ci_036                -1.223563e-02 3 1  ON 35
ci_037                -1.273143e-02 3 1  ON 36
ci_038                 2.537884e-03 3 1  ON 37
ci_039                 2.721984e-03 3 1  ON 38
ci_040                -2.962085e-03 3 1  ON 39
ci_041                 8.766271e-03 3 1  ON 40
ci_042                 8.594872e-03 3 1  ON 41
ci_043                -3.676618e-03 3 1  ON 42
ci_044                -5.594551e-03 3 1  ON 43
ci_045                -3.141403e-03 3 1  ON 44
ci_046                 5.704258e-03 3 1  ON 45
ci_047                 5.794512e-03 3 1  ON 46
ci_048                -1.259874e-02 3 1  ON 47
ci_049                -1.266185e-02 3 1  ON 48
ci_050                 3.840606e-03 3 1  ON 49
ci_051                 3.896948e-03 3 1  ON 50
ci_052                -3.157327e-03 3 1  ON 51
ci_053                -3.182193e-03 3 1  ON 52
ci_054                -3.373118e-03 3 1  ON 53
ci_055                -3.676876e-03 3 1  ON 54
ci_056                 5.524238e-03 3 1  ON 55
ci_057                 5.538113e-03 3 1  ON 56
ci_058                -2.716403e-03 3 1  ON 57
ci_059                -2.766164e-03 3 1  ON 58
ci_060                 5.340750e-03 3 1  ON 59
ci_061                 6.247571e-03 3 1  ON 60
ci_062                -3.931292e-03 3 1  ON 61
ci_063                -4.037945e-03 3 1  ON 62
ci_064                -3.063273e-03 3 1  ON 63
ci_065                -4.056713e-03 3 1  ON 64
ci_066                 4.466884e-03 3 1  ON 65
ci_067                 4.469919e-03 3 1  ON 66
ci_068                -5.170463e-03 3 1  ON 67
ci_069                -4.583936e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2945
    reference variance = 0.554343
====================================================
  Execution time = 1.3522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9952e-01
  Total weights = 1.9574e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287666384482
                                         uncertainty =       0.002131588091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287666384482
                                         uncertainty =       0.002131588091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379187060
  error estimate for blocks of size 2^( 2) =       0.000389975591
  error estimate for blocks of size 2^( 3) =       0.000399848300
  error estimate for blocks of size 2^( 4) =       0.000407256283
  error estimate for blocks of size 2^( 5) =       0.000411805801
  error estimate for blocks of size 2^( 6) =       0.000413930017
  error estimate for blocks of size 2^( 7) =       0.000415948164

      target function =      -0.901919315879
              le_mean =     -17.215376735675
             les_mean =     296.668922212333
             stat err =       0.000412235066
             autocorr =       1.181905753854
   target nu stat err =       0.000412235066
   target dn stat err =       0.002362001605
      target stat err =       0.003050605568
              std dev =       0.536251482949
             le_variance =       0.287565652965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287122361189
                                         uncertainty =       0.002126809272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287122361189
                                         uncertainty =       0.002126809272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378828381
  error estimate for blocks of size 2^( 2) =       0.000389687311
  error estimate for blocks of size 2^( 3) =       0.000399629548
  error estimate for blocks of size 2^( 4) =       0.000407089119
  error estimate for blocks of size 2^( 5) =       0.000411680988
  error estimate for blocks of size 2^( 6) =       0.000413843687
  error estimate for blocks of size 2^( 7) =       0.000415841088

      target function =      -0.841311302583
              le_mean =     -17.215391872777
             les_mean =     296.718045581620
             stat err =       0.000412113720
             autocorr =       1.183447866894
   target nu stat err =       0.000412113720
   target dn stat err =       0.044883225737
      target stat err =       0.049696743910
              std dev =       0.535744234419
             le_variance =       0.287021884713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287340005067
                                         uncertainty =       0.002129002751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287340005067
                                         uncertainty =       0.002129002751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378971914
  error estimate for blocks of size 2^( 2) =       0.000389798579
  error estimate for blocks of size 2^( 3) =       0.000399710633
  error estimate for blocks of size 2^( 4) =       0.000407146414
  error estimate for blocks of size 2^( 5) =       0.000411722769
  error estimate for blocks of size 2^( 6) =       0.000413870025
  error estimate for blocks of size 2^( 7) =       0.000415878477

      target function =      -0.901419256387
              le_mean =     -17.215383928755
             les_mean =     296.669565166178
             stat err =       0.000412154421
             autocorr =       1.182785178792
   target nu stat err =       0.000412154421
   target dn stat err =       0.002445614346
      target stat err =       0.003151339529
              std dev =       0.535947221215
             le_variance =       0.287239423928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287621973762
                                         uncertainty =       0.002131213210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287621973762
                                         uncertainty =       0.002131213210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379157792
  error estimate for blocks of size 2^( 2) =       0.000389951224
  error estimate for blocks of size 2^( 3) =       0.000399828942
  error estimate for blocks of size 2^( 4) =       0.000407240441
  error estimate for blocks of size 2^( 5) =       0.000411793324
  error estimate for blocks of size 2^( 6) =       0.000413920532
  error estimate for blocks of size 2^( 7) =       0.000415937312

      target function =      -0.902041237094
              le_mean =     -17.215377312738
             les_mean =     296.668846041157
             stat err =       0.000412222902
             autocorr =       1.182018464527
   target nu stat err =       0.000412222902
   target dn stat err =       0.002362118437
      target stat err =       0.003051560490
              std dev =       0.536210092411
             le_variance =       0.287521263203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901919315879        initial
     3.9062e-01     3.9062e+00             5.2110e-04        -0.841311302583
     1.5625e+00     1.5625e+01             1.4482e-04        -0.901419256387
     6.2500e+00     6.2500e+01             3.7247e-05        -0.902041237094  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2794e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.196116e-02 3 1  ON 0
ci_002                -3.145404e-02 3 1  ON 1
ci_003                -2.582248e-02 3 1  ON 2
ci_004                 2.327487e-02 3 1  ON 3
ci_005                 2.367378e-02 3 1  ON 4
ci_006                -2.061125e-02 3 1  ON 5
ci_007                -2.043089e-02 3 1  ON 6
ci_008                -1.011633e-02 3 1  ON 7
ci_009                -1.550410e-02 3 1  ON 8
ci_010                -1.083121e-02 3 1  ON 9
ci_011                -1.122256e-02 3 1  ON 10
ci_012                -1.136457e-02 3 1  ON 11
ci_013                -2.061803e-02 3 1  ON 12
ci_014                 1.254525e-02 3 1  ON 13
ci_015                 1.309477e-02 3 1  ON 14
ci_016                 1.693273e-02 3 1  ON 15
ci_017                 1.694914e-02 3 1  ON 16
ci_018                 1.047295e-02 3 1  ON 17
ci_019                 1.093236e-02 3 1  ON 18
ci_020                 1.623163e-02 3 1  ON 19
ci_021                 1.634243e-02 3 1  ON 20
ci_022                 9.488466e-03 3 1  ON 21
ci_023                 9.592857e-03 3 1  ON 22
ci_024                 1.045812e-02 3 1  ON 23
ci_025                 1.037322e-02 3 1  ON 24
ci_026                 1.122092e-02 3 1  ON 25
ci_027                 1.155449e-02 3 1  ON 26
ci_028                -1.540026e-02 3 1  ON 27
ci_029                -1.624772e-02 3 1  ON 28
ci_030                -9.359750e-03 3 1  ON 29
ci_031                -1.002536e-02 3 1  ON 30
ci_032                -1.498481e-02 3 1  ON 31
ci_033                 6.693924e-03 3 1  ON 32
ci_034                 6.198695e-03 3 1  ON 33
ci_035                -4.871385e-03 3 1  ON 34
ci_036                -1.226216e-02 3 1  ON 35
ci_037                -1.277554e-02 3 1  ON 36
ci_038                 2.604399e-03 3 1  ON 37
ci_039                 2.785106e-03 3 1  ON 38
ci_040                -3.008727e-03 3 1  ON 39
ci_041                 8.780634e-03 3 1  ON 40
ci_042                 8.632746e-03 3 1  ON 41
ci_043                -3.732228e-03 3 1  ON 42
ci_044                -5.613534e-03 3 1  ON 43
ci_045                -3.205135e-03 3 1  ON 44
ci_046                 5.746295e-03 3 1  ON 45
ci_047                 5.821703e-03 3 1  ON 46
ci_048                -1.260870e-02 3 1  ON 47
ci_049                -1.266326e-02 3 1  ON 48
ci_050                 3.883555e-03 3 1  ON 49
ci_051                 3.902501e-03 3 1  ON 50
ci_052                -3.185070e-03 3 1  ON 51
ci_053                -3.208411e-03 3 1  ON 52
ci_054                -3.411370e-03 3 1  ON 53
ci_055                -3.720892e-03 3 1  ON 54
ci_056                 5.548643e-03 3 1  ON 55
ci_057                 5.575314e-03 3 1  ON 56
ci_058                -2.737633e-03 3 1  ON 57
ci_059                -2.803167e-03 3 1  ON 58
ci_060                 5.357720e-03 3 1  ON 59
ci_061                 6.306105e-03 3 1  ON 60
ci_062                -3.972026e-03 3 1  ON 61
ci_063                -4.052232e-03 3 1  ON 62
ci_064                -3.094195e-03 3 1  ON 63
ci_065                -4.092351e-03 3 1  ON 64
ci_066                 4.487770e-03 3 1  ON 65
ci_067                 4.463323e-03 3 1  ON 66
ci_068                -5.212035e-03 3 1  ON 67
ci_069                -4.589544e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.3102
    reference variance = 1.33691
====================================================
  Execution time = 1.3638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0049e-01
  Total weights = 1.956978633e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286852464310
                                         uncertainty =       0.001684764164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286852464310
                                         uncertainty =       0.001684764164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378705111
  error estimate for blocks of size 2^( 2) =       0.000389351385
  error estimate for blocks of size 2^( 3) =       0.000399436612
  error estimate for blocks of size 2^( 4) =       0.000406850269
  error estimate for blocks of size 2^( 5) =       0.000412321328
  error estimate for blocks of size 2^( 6) =       0.000414500115
  error estimate for blocks of size 2^( 7) =       0.000417672966

      target function =      -0.900947224015
              le_mean =     -17.215373649702
             les_mean =     296.669582307468
             stat err =       0.000412836170
             autocorr =       1.188374018232
   target nu stat err =       0.000412836170
   target dn stat err =       0.002451764313
      target stat err =       0.003155870182
              std dev =       0.535569903431
             le_variance =       0.286835121461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721537364970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900957493235       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901042690644       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901058308076       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901062145411       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901062780519       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901062924722       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901062937993       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901062930200       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901062922050       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901062917393       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901062916883       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.427912e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900957493235       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900979559621       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900983570533       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900984542066       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900984702531       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900984738626       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900984741893       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900984739865       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900984737854       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900984736712       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.676699e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900957493235       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900963059943       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900964069541       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900964313174       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900964353394       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900964362419       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900964363232       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900964362720       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900964362219       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900964361935       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 9.259703e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6121e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.192564e-02 3 1  ON 0
ci_002                -3.142569e-02 3 1  ON 1
ci_003                -2.580442e-02 3 1  ON 2
ci_004                 2.325429e-02 3 1  ON 3
ci_005                 2.365290e-02 3 1  ON 4
ci_006                -2.059504e-02 3 1  ON 5
ci_007                -2.040742e-02 3 1  ON 6
ci_008                -1.008919e-02 3 1  ON 7
ci_009                -1.547816e-02 3 1  ON 8
ci_010                -1.080239e-02 3 1  ON 9
ci_011                -1.119810e-02 3 1  ON 10
ci_012                -1.136165e-02 3 1  ON 11
ci_013                -2.061013e-02 3 1  ON 12
ci_014                 1.252973e-02 3 1  ON 13
ci_015                 1.306994e-02 3 1  ON 14
ci_016                 1.692221e-02 3 1  ON 15
ci_017                 1.693626e-02 3 1  ON 16
ci_018                 1.046219e-02 3 1  ON 17
ci_019                 1.091277e-02 3 1  ON 18
ci_020                 1.621772e-02 3 1  ON 19
ci_021                 1.632792e-02 3 1  ON 20
ci_022                 9.472778e-03 3 1  ON 21
ci_023                 9.575476e-03 3 1  ON 22
ci_024                 1.043746e-02 3 1  ON 23
ci_025                 1.033645e-02 3 1  ON 24
ci_026                 1.120101e-02 3 1  ON 25
ci_027                 1.152723e-02 3 1  ON 26
ci_028                -1.539365e-02 3 1  ON 27
ci_029                -1.622318e-02 3 1  ON 28
ci_030                -9.358906e-03 3 1  ON 29
ci_031                -1.000134e-02 3 1  ON 30
ci_032                -1.497424e-02 3 1  ON 31
ci_033                 6.681272e-03 3 1  ON 32
ci_034                 6.190548e-03 3 1  ON 33
ci_035                -4.853056e-03 3 1  ON 34
ci_036                -1.225778e-02 3 1  ON 35
ci_037                -1.276221e-02 3 1  ON 36
ci_038                 2.587945e-03 3 1  ON 37
ci_039                 2.764478e-03 3 1  ON 38
ci_040                -2.996188e-03 3 1  ON 39
ci_041                 8.765601e-03 3 1  ON 40
ci_042                 8.622897e-03 3 1  ON 41
ci_043                -3.707134e-03 3 1  ON 42
ci_044                -5.609996e-03 3 1  ON 43
ci_045                -3.188542e-03 3 1  ON 44
ci_046                 5.733017e-03 3 1  ON 45
ci_047                 5.816362e-03 3 1  ON 46
ci_048                -1.261050e-02 3 1  ON 47
ci_049                -1.266271e-02 3 1  ON 48
ci_050                 3.884137e-03 3 1  ON 49
ci_051                 3.893122e-03 3 1  ON 50
ci_052                -3.172628e-03 3 1  ON 51
ci_053                -3.205897e-03 3 1  ON 52
ci_054                -3.391374e-03 3 1  ON 53
ci_055                -3.700226e-03 3 1  ON 54
ci_056                 5.536105e-03 3 1  ON 55
ci_057                 5.562945e-03 3 1  ON 56
ci_058                -2.727823e-03 3 1  ON 57
ci_059                -2.797482e-03 3 1  ON 58
ci_060                 5.358942e-03 3 1  ON 59
ci_061                 6.283369e-03 3 1  ON 60
ci_062                -3.958299e-03 3 1  ON 61
ci_063                -4.040961e-03 3 1  ON 62
ci_064                -3.089414e-03 3 1  ON 63
ci_065                -4.081967e-03 3 1  ON 64
ci_066                 4.477694e-03 3 1  ON 65
ci_067                 4.460927e-03 3 1  ON 66
ci_068                -5.197458e-03 3 1  ON 67
ci_069                -4.591189e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1303
    reference variance = 0.294931
====================================================
  Execution time = 1.3526e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0022e-01
  Total weights = 1.9571e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288570063254
                                         uncertainty =       0.001795161158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288570063254
                                         uncertainty =       0.001795161158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379828841
  error estimate for blocks of size 2^( 2) =       0.000390921859
  error estimate for blocks of size 2^( 3) =       0.000400657841
  error estimate for blocks of size 2^( 4) =       0.000407756042
  error estimate for blocks of size 2^( 5) =       0.000412045286
  error estimate for blocks of size 2^( 6) =       0.000415461728
  error estimate for blocks of size 2^( 7) =       0.000417877931

      target function =      -0.901052281528
              le_mean =     -17.214623254877
             les_mean =     296.643533567435
             stat err =       0.000413285247
             autocorr =       1.183924282401
   target nu stat err =       0.000413285247
   target dn stat err =       0.002318654236
      target stat err =       0.002987783932
              std dev =       0.537159098390
             le_variance =       0.288539896983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288378589791
                                         uncertainty =       0.001789914753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288378589791
                                         uncertainty =       0.001789914753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379702796
  error estimate for blocks of size 2^( 2) =       0.000390813955
  error estimate for blocks of size 2^( 3) =       0.000400569475
  error estimate for blocks of size 2^( 4) =       0.000407683739
  error estimate for blocks of size 2^( 5) =       0.000411985019
  error estimate for blocks of size 2^( 6) =       0.000415408179
  error estimate for blocks of size 2^( 7) =       0.000417820751

      target function =      -0.901202279747
              le_mean =     -17.214623794623
             les_mean =     296.643433590636
             stat err =       0.000413224422
             autocorr =       1.184361745724
   target nu stat err =       0.000413224422
   target dn stat err =       0.002320157081
      target stat err =       0.002990610329
              std dev =       0.536980843857
             le_variance =       0.288348426669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288469974959
                                         uncertainty =       0.001792432447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288469974959
                                         uncertainty =       0.001792432447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379762959
  error estimate for blocks of size 2^( 2) =       0.000390865312
  error estimate for blocks of size 2^( 3) =       0.000400611351
  error estimate for blocks of size 2^( 4) =       0.000407717837
  error estimate for blocks of size 2^( 5) =       0.000412013276
  error estimate for blocks of size 2^( 6) =       0.000415433151
  error estimate for blocks of size 2^( 7) =       0.000417847471

      target function =      -0.901182566344
              le_mean =     -17.214623350454
             les_mean =     296.643433825428
             stat err =       0.000413252934
             autocorr =       1.184149906977
   target nu stat err =       0.000413252934
   target dn stat err =       0.002318033098
      target stat err =       0.002987852911
              std dev =       0.537065927338
             le_variance =       0.288439810308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288557309260
                                         uncertainty =       0.001794814987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288557309260
                                         uncertainty =       0.001794814987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379820447
  error estimate for blocks of size 2^( 2) =       0.000390914634
  error estimate for blocks of size 2^( 3) =       0.000400651880
  error estimate for blocks of size 2^( 4) =       0.000407751123
  error estimate for blocks of size 2^( 5) =       0.000412041146
  error estimate for blocks of size 2^( 6) =       0.000415458017
  error estimate for blocks of size 2^( 7) =       0.000417873978

      target function =      -0.901061998403
              le_mean =     -17.214623243945
             les_mean =     296.643525502872
             stat err =       0.000413281066
             autocorr =       1.183952661749
   target nu stat err =       0.000413281066
   target dn stat err =       0.002318543610
      target stat err =       0.002987708783
              std dev =       0.537147226770
             le_variance =       0.288527143227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901052281528        initial
     1.5625e+00     1.5625e+01             1.4279e-04        -0.901202279747  <--
     6.2500e+00     6.2500e+01             3.6767e-05        -0.901182566344
     2.5000e+01     2.5000e+02             9.2597e-06        -0.901061998403

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2803e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.182298e-02 3 1  ON 0
ci_002                -3.134397e-02 3 1  ON 1
ci_003                -2.575216e-02 3 1  ON 2
ci_004                 2.319475e-02 3 1  ON 3
ci_005                 2.359231e-02 3 1  ON 4
ci_006                -2.054840e-02 3 1  ON 5
ci_007                -2.033979e-02 3 1  ON 6
ci_008                -1.001161e-02 3 1  ON 7
ci_009                -1.540384e-02 3 1  ON 8
ci_010                -1.071953e-02 3 1  ON 9
ci_011                -1.112785e-02 3 1  ON 10
ci_012                -1.135328e-02 3 1  ON 11
ci_013                -2.058729e-02 3 1  ON 12
ci_014                 1.248505e-02 3 1  ON 13
ci_015                 1.299851e-02 3 1  ON 14
ci_016                 1.689209e-02 3 1  ON 15
ci_017                 1.689932e-02 3 1  ON 16
ci_018                 1.043132e-02 3 1  ON 17
ci_019                 1.085662e-02 3 1  ON 18
ci_020                 1.617752e-02 3 1  ON 19
ci_021                 1.628609e-02 3 1  ON 20
ci_022                 9.427712e-03 3 1  ON 21
ci_023                 9.525619e-03 3 1  ON 22
ci_024                 1.037778e-02 3 1  ON 23
ci_025                 1.023043e-02 3 1  ON 24
ci_026                 1.114380e-02 3 1  ON 25
ci_027                 1.144895e-02 3 1  ON 26
ci_028                -1.537463e-02 3 1  ON 27
ci_029                -1.615252e-02 3 1  ON 28
ci_030                -9.356531e-03 3 1  ON 29
ci_031                -9.932600e-03 3 1  ON 30
ci_032                -1.494381e-02 3 1  ON 31
ci_033                 6.644823e-03 3 1  ON 32
ci_034                 6.167020e-03 3 1  ON 33
ci_035                -4.800565e-03 3 1  ON 34
ci_036                -1.224492e-02 3 1  ON 35
ci_037                -1.272379e-02 3 1  ON 36
ci_038                 2.540884e-03 3 1  ON 37
ci_039                 2.705481e-03 3 1  ON 38
ci_040                -2.960321e-03 3 1  ON 39
ci_041                 8.722637e-03 3 1  ON 40
ci_042                 8.594544e-03 3 1  ON 41
ci_043                -3.635207e-03 3 1  ON 42
ci_044                -5.599824e-03 3 1  ON 43
ci_045                -3.141044e-03 3 1  ON 44
ci_046                 5.694826e-03 3 1  ON 45
ci_047                 5.801012e-03 3 1  ON 46
ci_048                -1.261618e-02 3 1  ON 47
ci_049                -1.266129e-02 3 1  ON 48
ci_050                 3.885732e-03 3 1  ON 49
ci_051                 3.866383e-03 3 1  ON 50
ci_052                -3.137197e-03 3 1  ON 51
ci_053                -3.198827e-03 3 1  ON 52
ci_054                -3.333866e-03 3 1  ON 53
ci_055                -3.640911e-03 3 1  ON 54
ci_056                 5.500138e-03 3 1  ON 55
ci_057                 5.527451e-03 3 1  ON 56
ci_058                -2.699984e-03 3 1  ON 57
ci_059                -2.781345e-03 3 1  ON 58
ci_060                 5.362442e-03 3 1  ON 59
ci_061                 6.218026e-03 3 1  ON 60
ci_062                -3.918809e-03 3 1  ON 61
ci_063                -4.008409e-03 3 1  ON 62
ci_064                -3.075842e-03 3 1  ON 63
ci_065                -4.052272e-03 3 1  ON 64
ci_066                 4.448837e-03 3 1  ON 65
ci_067                 4.454079e-03 3 1  ON 66
ci_068                -5.155645e-03 3 1  ON 67
ci_069                -4.596029e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.161491
====================================================
  Execution time = 1.3786e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0298e-01
  Total weights = 1.957189534e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288265744931
                                         uncertainty =       0.002197212935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288265744931
                                         uncertainty =       0.002197212935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379646608
  error estimate for blocks of size 2^( 2) =       0.000390383198
  error estimate for blocks of size 2^( 3) =       0.000400311375
  error estimate for blocks of size 2^( 4) =       0.000407343327
  error estimate for blocks of size 2^( 5) =       0.000412452463
  error estimate for blocks of size 2^( 6) =       0.000416243927
  error estimate for blocks of size 2^( 7) =       0.000418685366

      target function =      -0.897716431135
              le_mean =     -17.215024727159
             les_mean =     296.660058301009
             stat err =       0.000413681271
             autocorr =       1.187333358124
   target nu stat err =       0.000413681271
   target dn stat err =       0.004011489564
      target stat err =       0.005069781857
              std dev =       0.536901382269
             le_variance =       0.288263094282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721502472716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897744172946       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898089043453       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898178516541       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898203027084       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898205242782       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898206232779       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898206439613       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898206402872       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898206346775       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898206368618       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898206359090       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.504038e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897744172946       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897842626963       residual = 8.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897867402172       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897873920559       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897874467221       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897874722824       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897874769675       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897874761898       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897874747228       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897874752380       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897874750063       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.803780e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897744172946       residual = 4.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897769691524       residual = 8.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897776054992       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897777709324       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897777844909       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897777909236       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897777920613       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897777918734       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897777915054       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897777916311       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897777915739       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 4.636209e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6332e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.164260e-02 3 1  ON 0
ci_002                -3.119766e-02 3 1  ON 1
ci_003                -2.568064e-02 3 1  ON 2
ci_004                 2.305554e-02 3 1  ON 3
ci_005                 2.352203e-02 3 1  ON 4
ci_006                -2.041062e-02 3 1  ON 5
ci_007                -2.029441e-02 3 1  ON 6
ci_008                -9.861137e-03 3 1  ON 7
ci_009                -1.538396e-02 3 1  ON 8
ci_010                -1.064242e-02 3 1  ON 9
ci_011                -1.109224e-02 3 1  ON 10
ci_012                -1.124397e-02 3 1  ON 11
ci_013                -2.050424e-02 3 1  ON 12
ci_014                 1.240150e-02 3 1  ON 13
ci_015                 1.288592e-02 3 1  ON 14
ci_016                 1.680799e-02 3 1  ON 15
ci_017                 1.683921e-02 3 1  ON 16
ci_018                 1.030678e-02 3 1  ON 17
ci_019                 1.078346e-02 3 1  ON 18
ci_020                 1.612056e-02 3 1  ON 19
ci_021                 1.620349e-02 3 1  ON 20
ci_022                 9.385135e-03 3 1  ON 21
ci_023                 9.489563e-03 3 1  ON 22
ci_024                 1.029782e-02 3 1  ON 23
ci_025                 1.013107e-02 3 1  ON 24
ci_026                 1.108498e-02 3 1  ON 25
ci_027                 1.140881e-02 3 1  ON 26
ci_028                -1.529788e-02 3 1  ON 27
ci_029                -1.605579e-02 3 1  ON 28
ci_030                -9.323888e-03 3 1  ON 29
ci_031                -9.875293e-03 3 1  ON 30
ci_032                -1.493848e-02 3 1  ON 31
ci_033                 6.589464e-03 3 1  ON 32
ci_034                 6.142497e-03 3 1  ON 33
ci_035                -4.722449e-03 3 1  ON 34
ci_036                -1.223314e-02 3 1  ON 35
ci_037                -1.269997e-02 3 1  ON 36
ci_038                 2.474426e-03 3 1  ON 37
ci_039                 2.632577e-03 3 1  ON 38
ci_040                -2.889777e-03 3 1  ON 39
ci_041                 8.760396e-03 3 1  ON 40
ci_042                 8.605933e-03 3 1  ON 41
ci_043                -3.603809e-03 3 1  ON 42
ci_044                -5.531168e-03 3 1  ON 43
ci_045                -3.091508e-03 3 1  ON 44
ci_046                 5.651477e-03 3 1  ON 45
ci_047                 5.727195e-03 3 1  ON 46
ci_048                -1.259103e-02 3 1  ON 47
ci_049                -1.269884e-02 3 1  ON 48
ci_050                 3.863854e-03 3 1  ON 49
ci_051                 3.787860e-03 3 1  ON 50
ci_052                -3.082517e-03 3 1  ON 51
ci_053                -3.163608e-03 3 1  ON 52
ci_054                -3.260571e-03 3 1  ON 53
ci_055                -3.602522e-03 3 1  ON 54
ci_056                 5.446558e-03 3 1  ON 55
ci_057                 5.477150e-03 3 1  ON 56
ci_058                -2.662851e-03 3 1  ON 57
ci_059                -2.801260e-03 3 1  ON 58
ci_060                 5.279592e-03 3 1  ON 59
ci_061                 6.177673e-03 3 1  ON 60
ci_062                -3.888585e-03 3 1  ON 61
ci_063                -3.942821e-03 3 1  ON 62
ci_064                -3.051129e-03 3 1  ON 63
ci_065                -3.998288e-03 3 1  ON 64
ci_066                 4.453210e-03 3 1  ON 65
ci_067                 4.432221e-03 3 1  ON 66
ci_068                -5.069314e-03 3 1  ON 67
ci_069                -4.554380e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.3028
    reference variance = 0.244132
====================================================
  Execution time = 1.3458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0502e-01
  Total weights = 1.9574e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289290087668
                                         uncertainty =       0.001707504083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289290087668
                                         uncertainty =       0.001707504083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380351554
  error estimate for blocks of size 2^( 2) =       0.000391210933
  error estimate for blocks of size 2^( 3) =       0.000400702230
  error estimate for blocks of size 2^( 4) =       0.000407446079
  error estimate for blocks of size 2^( 5) =       0.000411916279
  error estimate for blocks of size 2^( 6) =       0.000414438292
  error estimate for blocks of size 2^( 7) =       0.000417614206

      target function =      -0.894307450858
              le_mean =     -17.215952488922
             les_mean =     296.694888183519
             stat err =       0.000412853714
             autocorr =       1.178208094766
   target nu stat err =       0.000412853714
   target dn stat err =       0.003220535086
      target stat err =       0.004059759450
              std dev =       0.537898325925
             le_variance =       0.289334609033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288699220688
                                         uncertainty =       0.001708528755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288699220688
                                         uncertainty =       0.001708528755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379960346
  error estimate for blocks of size 2^( 2) =       0.000390892057
  error estimate for blocks of size 2^( 3) =       0.000400460310
  error estimate for blocks of size 2^( 4) =       0.000407273599
  error estimate for blocks of size 2^( 5) =       0.000411795184
  error estimate for blocks of size 2^( 6) =       0.000414320275
  error estimate for blocks of size 2^( 7) =       0.000417537386

      target function =      -0.895341359074
              le_mean =     -17.215964664374
             les_mean =     296.694479712603
             stat err =       0.000412731611
             autocorr =       1.179937265633
   target nu stat err =       0.000412731611
   target dn stat err =       0.003441166834
      target stat err =       0.004342468218
              std dev =       0.537345073810
             le_variance =       0.288739728348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288937085783
                                         uncertainty =       0.001707487093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288937085783
                                         uncertainty =       0.001707487093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380117962
  error estimate for blocks of size 2^( 2) =       0.000391017528
  error estimate for blocks of size 2^( 3) =       0.000400551646
  error estimate for blocks of size 2^( 4) =       0.000407334268
  error estimate for blocks of size 2^( 5) =       0.000411832232
  error estimate for blocks of size 2^( 6) =       0.000414355930
  error estimate for blocks of size 2^( 7) =       0.000417553994

      target function =      -0.895457304817
              le_mean =     -17.215956477492
             les_mean =     296.694105146715
             stat err =       0.000412769106
             autocorr =       1.179173160053
   target nu stat err =       0.000412769106
   target dn stat err =       0.003296064964
      target stat err =       0.004163673317
              std dev =       0.537567976804
             le_variance =       0.288979329685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289241617015
                                         uncertainty =       0.001707407120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289241617015
                                         uncertainty =       0.001707407120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380319499
  error estimate for blocks of size 2^( 2) =       0.000391183944
  error estimate for blocks of size 2^( 3) =       0.000400680709
  error estimate for blocks of size 2^( 4) =       0.000407429529
  error estimate for blocks of size 2^( 5) =       0.000411903252
  error estimate for blocks of size 2^( 6) =       0.000414425308
  error estimate for blocks of size 2^( 7) =       0.000417604301

      target function =      -0.895013681402
              le_mean =     -17.215952645445
             les_mean =     296.694328318121
             stat err =       0.000412840598
             autocorr =       1.178331835047
   target nu stat err =       0.000412840598
   target dn stat err =       0.003191138028
      target stat err =       0.004029740403
              std dev =       0.537852993626
             le_variance =       0.289285842752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894307450858        initial
     3.9062e-01     3.9062e+00             6.5040e-04        -0.895341359074
     1.5625e+00     1.5625e+01             1.8038e-04        -0.895457304817  <--
     6.2500e+00     6.2500e+01             4.6362e-05        -0.895013681402

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2682e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.164260e-02 3 1  ON 0
ci_002                -3.119766e-02 3 1  ON 1
ci_003                -2.568064e-02 3 1  ON 2
ci_004                 2.305554e-02 3 1  ON 3
ci_005                 2.352203e-02 3 1  ON 4
ci_006                -2.041062e-02 3 1  ON 5
ci_007                -2.029441e-02 3 1  ON 6
ci_008                -9.861137e-03 3 1  ON 7
ci_009                -1.538396e-02 3 1  ON 8
ci_010                -1.064242e-02 3 1  ON 9
ci_011                -1.109224e-02 3 1  ON 10
ci_012                -1.124397e-02 3 1  ON 11
ci_013                -2.050424e-02 3 1  ON 12
ci_014                 1.240150e-02 3 1  ON 13
ci_015                 1.288592e-02 3 1  ON 14
ci_016                 1.680799e-02 3 1  ON 15
ci_017                 1.683921e-02 3 1  ON 16
ci_018                 1.030678e-02 3 1  ON 17
ci_019                 1.078346e-02 3 1  ON 18
ci_020                 1.612056e-02 3 1  ON 19
ci_021                 1.620349e-02 3 1  ON 20
ci_022                 9.385135e-03 3 1  ON 21
ci_023                 9.489563e-03 3 1  ON 22
ci_024                 1.029782e-02 3 1  ON 23
ci_025                 1.013107e-02 3 1  ON 24
ci_026                 1.108498e-02 3 1  ON 25
ci_027                 1.140881e-02 3 1  ON 26
ci_028                -1.529788e-02 3 1  ON 27
ci_029                -1.605579e-02 3 1  ON 28
ci_030                -9.323888e-03 3 1  ON 29
ci_031                -9.875293e-03 3 1  ON 30
ci_032                -1.493848e-02 3 1  ON 31
ci_033                 6.589464e-03 3 1  ON 32
ci_034                 6.142497e-03 3 1  ON 33
ci_035                -4.722449e-03 3 1  ON 34
ci_036                -1.223314e-02 3 1  ON 35
ci_037                -1.269997e-02 3 1  ON 36
ci_038                 2.474426e-03 3 1  ON 37
ci_039                 2.632577e-03 3 1  ON 38
ci_040                -2.889777e-03 3 1  ON 39
ci_041                 8.760396e-03 3 1  ON 40
ci_042                 8.605933e-03 3 1  ON 41
ci_043                -3.603809e-03 3 1  ON 42
ci_044                -5.531168e-03 3 1  ON 43
ci_045                -3.091508e-03 3 1  ON 44
ci_046                 5.651477e-03 3 1  ON 45
ci_047                 5.727195e-03 3 1  ON 46
ci_048                -1.259103e-02 3 1  ON 47
ci_049                -1.269884e-02 3 1  ON 48
ci_050                 3.863854e-03 3 1  ON 49
ci_051                 3.787860e-03 3 1  ON 50
ci_052                -3.082517e-03 3 1  ON 51
ci_053                -3.163608e-03 3 1  ON 52
ci_054                -3.260571e-03 3 1  ON 53
ci_055                -3.602522e-03 3 1  ON 54
ci_056                 5.446558e-03 3 1  ON 55
ci_057                 5.477150e-03 3 1  ON 56
ci_058                -2.662851e-03 3 1  ON 57
ci_059                -2.801260e-03 3 1  ON 58
ci_060                 5.279592e-03 3 1  ON 59
ci_061                 6.177673e-03 3 1  ON 60
ci_062                -3.888585e-03 3 1  ON 61
ci_063                -3.942821e-03 3 1  ON 62
ci_064                -3.051129e-03 3 1  ON 63
ci_065                -3.998288e-03 3 1  ON 64
ci_066                 4.453210e-03 3 1  ON 65
ci_067                 4.432221e-03 3 1  ON 66
ci_068                -5.069314e-03 3 1  ON 67
ci_069                -4.554380e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.247
    reference variance = 0.228632
====================================================
  Execution time = 1.6356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0342e-01
  Total weights = 1.957156654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289147327149
                                         uncertainty =       0.002001867064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289147327149
                                         uncertainty =       0.002001867064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380234969
  error estimate for blocks of size 2^( 2) =       0.000391456926
  error estimate for blocks of size 2^( 3) =       0.000401268812
  error estimate for blocks of size 2^( 4) =       0.000408691597
  error estimate for blocks of size 2^( 5) =       0.000412627198
  error estimate for blocks of size 2^( 6) =       0.000415033222
  error estimate for blocks of size 2^( 7) =       0.000418074920

      target function =      -0.897279934288
              le_mean =     -17.215478773089
             les_mean =     296.676128493630
             stat err =       0.000413606734
             autocorr =       1.183235231960
   target nu stat err =       0.000413606734
   target dn stat err =       0.002635880567
      target stat err =       0.003358776400
              std dev =       0.537733449825
             le_variance =       0.289157263061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721547877309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897291758699       residual = 6.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897777783784       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897855764250       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897873859594       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897875856712       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897876438889       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897876623235       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897876598878       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897876535257       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897876514698       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897876523663       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 6.155025e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897291758699       residual = 6.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897430435730       residual = 7.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897452036101       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897456845381       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897457354396       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897457500612       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897457548045       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897457541095       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897457524938       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897457520189       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897457522299       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.738827e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897291758699       residual = 6.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897327696914       residual = 7.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897333245487       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897334465781       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897334593348       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897334629851       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897334641789       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897334639991       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897334635945       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897334634793       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897334635309       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 4.493009e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8893e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.149655e-02 3 1  ON 0
ci_002                -3.111485e-02 3 1  ON 1
ci_003                -2.559837e-02 3 1  ON 2
ci_004                 2.296986e-02 3 1  ON 3
ci_005                 2.347663e-02 3 1  ON 4
ci_006                -2.032715e-02 3 1  ON 5
ci_007                -2.015263e-02 3 1  ON 6
ci_008                -9.760028e-03 3 1  ON 7
ci_009                -1.528402e-02 3 1  ON 8
ci_010                -1.046854e-02 3 1  ON 9
ci_011                -1.100150e-02 3 1  ON 10
ci_012                -1.111266e-02 3 1  ON 11
ci_013                -2.046555e-02 3 1  ON 12
ci_014                 1.233276e-02 3 1  ON 13
ci_015                 1.279612e-02 3 1  ON 14
ci_016                 1.674723e-02 3 1  ON 15
ci_017                 1.676425e-02 3 1  ON 16
ci_018                 1.022842e-02 3 1  ON 17
ci_019                 1.069267e-02 3 1  ON 18
ci_020                 1.605022e-02 3 1  ON 19
ci_021                 1.615816e-02 3 1  ON 20
ci_022                 9.319186e-03 3 1  ON 21
ci_023                 9.365176e-03 3 1  ON 22
ci_024                 1.022611e-02 3 1  ON 23
ci_025                 1.006871e-02 3 1  ON 24
ci_026                 1.102122e-02 3 1  ON 25
ci_027                 1.130572e-02 3 1  ON 26
ci_028                -1.527556e-02 3 1  ON 27
ci_029                -1.595403e-02 3 1  ON 28
ci_030                -9.204424e-03 3 1  ON 29
ci_031                -9.844798e-03 3 1  ON 30
ci_032                -1.492810e-02 3 1  ON 31
ci_033                 6.526763e-03 3 1  ON 32
ci_034                 6.027398e-03 3 1  ON 33
ci_035                -4.654643e-03 3 1  ON 34
ci_036                -1.216513e-02 3 1  ON 35
ci_037                -1.268225e-02 3 1  ON 36
ci_038                 2.403433e-03 3 1  ON 37
ci_039                 2.532024e-03 3 1  ON 38
ci_040                -2.831017e-03 3 1  ON 39
ci_041                 8.730193e-03 3 1  ON 40
ci_042                 8.668400e-03 3 1  ON 41
ci_043                -3.543866e-03 3 1  ON 42
ci_044                -5.421977e-03 3 1  ON 43
ci_045                -3.028632e-03 3 1  ON 44
ci_046                 5.608476e-03 3 1  ON 45
ci_047                 5.688334e-03 3 1  ON 46
ci_048                -1.261063e-02 3 1  ON 47
ci_049                -1.269916e-02 3 1  ON 48
ci_050                 3.758607e-03 3 1  ON 49
ci_051                 3.745160e-03 3 1  ON 50
ci_052                -2.962540e-03 3 1  ON 51
ci_053                -3.136570e-03 3 1  ON 52
ci_054                -3.206961e-03 3 1  ON 53
ci_055                -3.573575e-03 3 1  ON 54
ci_056                 5.371735e-03 3 1  ON 55
ci_057                 5.462942e-03 3 1  ON 56
ci_058                -2.582533e-03 3 1  ON 57
ci_059                -2.808640e-03 3 1  ON 58
ci_060                 5.251247e-03 3 1  ON 59
ci_061                 6.118786e-03 3 1  ON 60
ci_062                -3.836425e-03 3 1  ON 61
ci_063                -3.895011e-03 3 1  ON 62
ci_064                -3.016324e-03 3 1  ON 63
ci_065                -3.963959e-03 3 1  ON 64
ci_066                 4.449302e-03 3 1  ON 65
ci_067                 4.427421e-03 3 1  ON 66
ci_068                -5.036845e-03 3 1  ON 67
ci_069                -4.534360e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1105
    reference variance = 0.238043
====================================================
  Execution time = 1.3297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9952e-01
  Total weights = 1.9574e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239969042
                                         uncertainty =       0.001729655869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286239969042
                                         uncertainty =       0.001729655869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378272352
  error estimate for blocks of size 2^( 2) =       0.000388785868
  error estimate for blocks of size 2^( 3) =       0.000398636810
  error estimate for blocks of size 2^( 4) =       0.000406185409
  error estimate for blocks of size 2^( 5) =       0.000410354366
  error estimate for blocks of size 2^( 6) =       0.000412725607
  error estimate for blocks of size 2^( 7) =       0.000412673703

      target function =      -0.899110014244
              le_mean =     -17.214576802977
             les_mean =     296.643458836232
             stat err =       0.000410484771
             autocorr =       1.177565031832
   target nu stat err =       0.000410484771
   target dn stat err =       0.003231161785
      target stat err =       0.004107028785
              std dev =       0.534957890083
             le_variance =       0.286179944162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285584817410
                                         uncertainty =       0.001711118204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285584817410
                                         uncertainty =       0.001711118204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377838877
  error estimate for blocks of size 2^( 2) =       0.000388439397
  error estimate for blocks of size 2^( 3) =       0.000398385697
  error estimate for blocks of size 2^( 4) =       0.000406003500
  error estimate for blocks of size 2^( 5) =       0.000410225481
  error estimate for blocks of size 2^( 6) =       0.000412586966
  error estimate for blocks of size 2^( 7) =       0.000412591318

      target function =      -0.901496668892
              le_mean =     -17.214590248608
             les_mean =     296.642038596267
             stat err =       0.000410351816
             autocorr =       1.179504051971
   target nu stat err =       0.000410351816
   target dn stat err =       0.002498581506
      target stat err =       0.003213425226
              std dev =       0.534344864000
             le_variance =       0.285524433683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285849082230
                                         uncertainty =       0.001718857282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285849082230
                                         uncertainty =       0.001718857282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378013795
  error estimate for blocks of size 2^( 2) =       0.000388575866
  error estimate for blocks of size 2^( 3) =       0.000398479859
  error estimate for blocks of size 2^( 4) =       0.000406067203
  error estimate for blocks of size 2^( 5) =       0.000410265761
  error estimate for blocks of size 2^( 6) =       0.000412631640
  error estimate for blocks of size 2^( 7) =       0.000412612334

      target function =      -0.901505205728
              le_mean =     -17.214581389299
             les_mean =     296.641725805713
             stat err =       0.000410394235
             autocorr =       1.178656362515
   target nu stat err =       0.000410394235
   target dn stat err =       0.002420675136
      target stat err =       0.003116522244
              std dev =       0.534592235005
             le_variance =       0.285788857727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286186258581
                                         uncertainty =       0.001728223730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286186258581
                                         uncertainty =       0.001728223730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378236837
  error estimate for blocks of size 2^( 2) =       0.000388756616
  error estimate for blocks of size 2^( 3) =       0.000398614389
  error estimate for blocks of size 2^( 4) =       0.000406168308
  error estimate for blocks of size 2^( 5) =       0.000410341292
  error estimate for blocks of size 2^( 6) =       0.000412711512
  error estimate for blocks of size 2^( 7) =       0.000412663742

      target function =      -0.901116587516
              le_mean =     -17.214576859490
             les_mean =     296.641876106876
             stat err =       0.000410471213
             autocorr =       1.177708378710
   target nu stat err =       0.000410471213
   target dn stat err =       0.002455636968
      target stat err =       0.003157327068
              std dev =       0.534907664220
             le_variance =       0.286126209241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899110014244        initial
     3.9062e-01     3.9062e+00             6.1550e-04        -0.901496668892
     1.5625e+00     1.5625e+01             1.7388e-04        -0.901505205728  <--
     6.2500e+00     6.2500e+01             4.4930e-05        -0.901116587516

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2566e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.149655e-02 3 1  ON 0
ci_002                -3.111485e-02 3 1  ON 1
ci_003                -2.559837e-02 3 1  ON 2
ci_004                 2.296986e-02 3 1  ON 3
ci_005                 2.347663e-02 3 1  ON 4
ci_006                -2.032715e-02 3 1  ON 5
ci_007                -2.015263e-02 3 1  ON 6
ci_008                -9.760028e-03 3 1  ON 7
ci_009                -1.528402e-02 3 1  ON 8
ci_010                -1.046854e-02 3 1  ON 9
ci_011                -1.100150e-02 3 1  ON 10
ci_012                -1.111266e-02 3 1  ON 11
ci_013                -2.046555e-02 3 1  ON 12
ci_014                 1.233276e-02 3 1  ON 13
ci_015                 1.279612e-02 3 1  ON 14
ci_016                 1.674723e-02 3 1  ON 15
ci_017                 1.676425e-02 3 1  ON 16
ci_018                 1.022842e-02 3 1  ON 17
ci_019                 1.069267e-02 3 1  ON 18
ci_020                 1.605022e-02 3 1  ON 19
ci_021                 1.615816e-02 3 1  ON 20
ci_022                 9.319186e-03 3 1  ON 21
ci_023                 9.365176e-03 3 1  ON 22
ci_024                 1.022611e-02 3 1  ON 23
ci_025                 1.006871e-02 3 1  ON 24
ci_026                 1.102122e-02 3 1  ON 25
ci_027                 1.130572e-02 3 1  ON 26
ci_028                -1.527556e-02 3 1  ON 27
ci_029                -1.595403e-02 3 1  ON 28
ci_030                -9.204424e-03 3 1  ON 29
ci_031                -9.844798e-03 3 1  ON 30
ci_032                -1.492810e-02 3 1  ON 31
ci_033                 6.526763e-03 3 1  ON 32
ci_034                 6.027398e-03 3 1  ON 33
ci_035                -4.654643e-03 3 1  ON 34
ci_036                -1.216513e-02 3 1  ON 35
ci_037                -1.268225e-02 3 1  ON 36
ci_038                 2.403433e-03 3 1  ON 37
ci_039                 2.532024e-03 3 1  ON 38
ci_040                -2.831017e-03 3 1  ON 39
ci_041                 8.730193e-03 3 1  ON 40
ci_042                 8.668400e-03 3 1  ON 41
ci_043                -3.543866e-03 3 1  ON 42
ci_044                -5.421977e-03 3 1  ON 43
ci_045                -3.028632e-03 3 1  ON 44
ci_046                 5.608476e-03 3 1  ON 45
ci_047                 5.688334e-03 3 1  ON 46
ci_048                -1.261063e-02 3 1  ON 47
ci_049                -1.269916e-02 3 1  ON 48
ci_050                 3.758607e-03 3 1  ON 49
ci_051                 3.745160e-03 3 1  ON 50
ci_052                -2.962540e-03 3 1  ON 51
ci_053                -3.136570e-03 3 1  ON 52
ci_054                -3.206961e-03 3 1  ON 53
ci_055                -3.573575e-03 3 1  ON 54
ci_056                 5.371735e-03 3 1  ON 55
ci_057                 5.462942e-03 3 1  ON 56
ci_058                -2.582533e-03 3 1  ON 57
ci_059                -2.808640e-03 3 1  ON 58
ci_060                 5.251247e-03 3 1  ON 59
ci_061                 6.118786e-03 3 1  ON 60
ci_062                -3.836425e-03 3 1  ON 61
ci_063                -3.895011e-03 3 1  ON 62
ci_064                -3.016324e-03 3 1  ON 63
ci_065                -3.963959e-03 3 1  ON 64
ci_066                 4.449302e-03 3 1  ON 65
ci_067                 4.427421e-03 3 1  ON 66
ci_068                -5.036845e-03 3 1  ON 67
ci_069                -4.534360e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1524e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.261667
====================================================
  Execution time = 1.4575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9900e-01
  Total weights = 1.957279834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286251399272
                                         uncertainty =       0.001696660133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286251399272
                                         uncertainty =       0.001696660133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378349468
  error estimate for blocks of size 2^( 2) =       0.000389235076
  error estimate for blocks of size 2^( 3) =       0.000399341089
  error estimate for blocks of size 2^( 4) =       0.000407293542
  error estimate for blocks of size 2^( 5) =       0.000411578281
  error estimate for blocks of size 2^( 6) =       0.000414639390
  error estimate for blocks of size 2^( 7) =       0.000416583525

      target function =      -0.902744731918
              le_mean =     -17.214944778735
             les_mean =     296.653324551196
             stat err =       0.000412523685
             autocorr =       1.188807456203
   target nu stat err =       0.000412523685
   target dn stat err =       0.002196176639
      target stat err =       0.002847709327
              std dev =       0.535066949409
             le_variance =       0.286296640350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721494477874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902752980162       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903013562139       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903075169727       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903092046677       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903094398188       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903094842400       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903094882799       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903094885313       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903094856317       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903094855302       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.570637e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902752980162       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902827334819       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902844449861       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902848925953       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902849544534       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902849653862       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902849665440       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902849664139       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902849657166       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902849656735       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.546225e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902752980162       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902772249621       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902776649879       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902777784914       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902777941441       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902777968609       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902777971610       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902777971147       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902777969431       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902777969308       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.975155e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7068e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.134193e-02 3 1  ON 0
ci_002                -3.101871e-02 3 1  ON 1
ci_003                -2.550394e-02 3 1  ON 2
ci_004                 2.290204e-02 3 1  ON 3
ci_005                 2.339836e-02 3 1  ON 4
ci_006                -2.023937e-02 3 1  ON 5
ci_007                -2.007433e-02 3 1  ON 6
ci_008                -9.653150e-03 3 1  ON 7
ci_009                -1.522014e-02 3 1  ON 8
ci_010                -1.041091e-02 3 1  ON 9
ci_011                -1.088679e-02 3 1  ON 10
ci_012                -1.102319e-02 3 1  ON 11
ci_013                -2.041481e-02 3 1  ON 12
ci_014                 1.229997e-02 3 1  ON 13
ci_015                 1.271179e-02 3 1  ON 14
ci_016                 1.672827e-02 3 1  ON 15
ci_017                 1.668202e-02 3 1  ON 16
ci_018                 1.014563e-02 3 1  ON 17
ci_019                 1.062720e-02 3 1  ON 18
ci_020                 1.602006e-02 3 1  ON 19
ci_021                 1.612635e-02 3 1  ON 20
ci_022                 9.292243e-03 3 1  ON 21
ci_023                 9.320117e-03 3 1  ON 22
ci_024                 1.009682e-02 3 1  ON 23
ci_025                 9.954213e-03 3 1  ON 24
ci_026                 1.095821e-02 3 1  ON 25
ci_027                 1.126899e-02 3 1  ON 26
ci_028                -1.524966e-02 3 1  ON 27
ci_029                -1.592192e-02 3 1  ON 28
ci_030                -9.160983e-03 3 1  ON 29
ci_031                -9.748328e-03 3 1  ON 30
ci_032                -1.489361e-02 3 1  ON 31
ci_033                 6.500470e-03 3 1  ON 32
ci_034                 5.982243e-03 3 1  ON 33
ci_035                -4.598394e-03 3 1  ON 34
ci_036                -1.214853e-02 3 1  ON 35
ci_037                -1.261384e-02 3 1  ON 36
ci_038                 2.303754e-03 3 1  ON 37
ci_039                 2.452289e-03 3 1  ON 38
ci_040                -2.791449e-03 3 1  ON 39
ci_041                 8.690158e-03 3 1  ON 40
ci_042                 8.644162e-03 3 1  ON 41
ci_043                -3.488033e-03 3 1  ON 42
ci_044                -5.310924e-03 3 1  ON 43
ci_045                -2.992349e-03 3 1  ON 44
ci_046                 5.588862e-03 3 1  ON 45
ci_047                 5.646127e-03 3 1  ON 46
ci_048                -1.258668e-02 3 1  ON 47
ci_049                -1.270629e-02 3 1  ON 48
ci_050                 3.723655e-03 3 1  ON 49
ci_051                 3.679136e-03 3 1  ON 50
ci_052                -2.941137e-03 3 1  ON 51
ci_053                -3.080543e-03 3 1  ON 52
ci_054                -3.166613e-03 3 1  ON 53
ci_055                -3.506346e-03 3 1  ON 54
ci_056                 5.328245e-03 3 1  ON 55
ci_057                 5.442444e-03 3 1  ON 56
ci_058                -2.576307e-03 3 1  ON 57
ci_059                -2.741354e-03 3 1  ON 58
ci_060                 5.245996e-03 3 1  ON 59
ci_061                 6.102625e-03 3 1  ON 60
ci_062                -3.800715e-03 3 1  ON 61
ci_063                -3.882915e-03 3 1  ON 62
ci_064                -2.970285e-03 3 1  ON 63
ci_065                -3.942098e-03 3 1  ON 64
ci_066                 4.411808e-03 3 1  ON 65
ci_067                 4.429239e-03 3 1  ON 66
ci_068                -5.067634e-03 3 1  ON 67
ci_069                -4.535475e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1898
    reference variance = 0.193682
====================================================
  Execution time = 1.3627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9626e-01
  Total weights = 1.9576e+06
  Execution time = 1.8349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283103661514
                                         uncertainty =       0.001468955463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283103661514
                                         uncertainty =       0.001468955463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376237591
  error estimate for blocks of size 2^( 2) =       0.000386940959
  error estimate for blocks of size 2^( 3) =       0.000396396853
  error estimate for blocks of size 2^( 4) =       0.000402998547
  error estimate for blocks of size 2^( 5) =       0.000407528575
  error estimate for blocks of size 2^( 6) =       0.000409538468
  error estimate for blocks of size 2^( 7) =       0.000409245559

      target function =      -0.905388786249
              le_mean =     -17.215912048087
             les_mean =     296.684722464586
             stat err =       0.000407327787
             autocorr =       1.172097409490
   target nu stat err =       0.000407327787
   target dn stat err =       0.002475053926
      target stat err =       0.003217100485
              std dev =       0.532080303704
             le_variance =       0.283109449590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282593736556
                                         uncertainty =       0.001463091892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282593736556
                                         uncertainty =       0.001463091892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375899020
  error estimate for blocks of size 2^( 2) =       0.000386662960
  error estimate for blocks of size 2^( 3) =       0.000396207194
  error estimate for blocks of size 2^( 4) =       0.000402866733
  error estimate for blocks of size 2^( 5) =       0.000407429180
  error estimate for blocks of size 2^( 6) =       0.000409445626
  error estimate for blocks of size 2^( 7) =       0.000409144632

      target function =      -0.907083810651
              le_mean =     -17.215916898465
             les_mean =     296.683569061129
             stat err =       0.000407221542
             autocorr =       1.173597301959
   target nu stat err =       0.000407221542
   target dn stat err =       0.002226124206
      target stat err =       0.002915103093
              std dev =       0.531601492017
             le_variance =       0.282600146315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282798825313
                                         uncertainty =       0.001465431614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282798825313
                                         uncertainty =       0.001465431614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376035219
  error estimate for blocks of size 2^( 2) =       0.000386772749
  error estimate for blocks of size 2^( 3) =       0.000396277190
  error estimate for blocks of size 2^( 4) =       0.000402911187
  error estimate for blocks of size 2^( 5) =       0.000407458611
  error estimate for blocks of size 2^( 6) =       0.000409472317
  error estimate for blocks of size 2^( 7) =       0.000409174092

      target function =      -0.906577812516
              le_mean =     -17.215912601894
             les_mean =     296.683814488348
             stat err =       0.000407254052
             autocorr =       1.172934562901
   target nu stat err =       0.000407254052
   target dn stat err =       0.002265282646
      target stat err =       0.002961140034
              std dev =       0.531794105940
             le_variance =       0.282804971113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283061420976
                                         uncertainty =       0.001468498849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283061420976
                                         uncertainty =       0.001468498849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376209554
  error estimate for blocks of size 2^( 2) =       0.000386917333
  error estimate for blocks of size 2^( 3) =       0.000396379416
  error estimate for blocks of size 2^( 4) =       0.000402985293
  error estimate for blocks of size 2^( 5) =       0.000407517070
  error estimate for blocks of size 2^( 6) =       0.000409527486
  error estimate for blocks of size 2^( 7) =       0.000409233675

      target function =      -0.905192693160
              le_mean =     -17.215911695598
             les_mean =     296.684863654192
             stat err =       0.000407315881
             autocorr =       1.172203587573
   target nu stat err =       0.000407315881
   target dn stat err =       0.002472694484
      target stat err =       0.003212757114
              std dev =       0.532040653197
             le_variance =       0.283067256654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905388786249        initial
     3.9062e-01     3.9062e+00             5.5706e-04        -0.907083810651  <--
     1.5625e+00     1.5625e+01             1.5462e-04        -0.906577812516
     6.2500e+00     6.2500e+01             3.9752e-05        -0.905192693160

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.2923e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.093949e-02 3 1  ON 0
ci_002                -3.077113e-02 3 1  ON 1
ci_003                -2.525660e-02 3 1  ON 2
ci_004                 2.272591e-02 3 1  ON 3
ci_005                 2.319611e-02 3 1  ON 4
ci_006                -2.001280e-02 3 1  ON 5
ci_007                -1.987236e-02 3 1  ON 6
ci_008                -9.385577e-03 3 1  ON 7
ci_009                -1.505858e-02 3 1  ON 8
ci_010                -1.026425e-02 3 1  ON 9
ci_011                -1.059509e-02 3 1  ON 10
ci_012                -1.079572e-02 3 1  ON 11
ci_013                -2.028258e-02 3 1  ON 12
ci_014                 1.221841e-02 3 1  ON 13
ci_015                 1.249537e-02 3 1  ON 14
ci_016                 1.668260e-02 3 1  ON 15
ci_017                 1.647139e-02 3 1  ON 16
ci_018                 9.937068e-03 3 1  ON 17
ci_019                 1.046229e-02 3 1  ON 18
ci_020                 1.594117e-02 3 1  ON 19
ci_021                 1.604291e-02 3 1  ON 20
ci_022                 9.225040e-03 3 1  ON 21
ci_023                 9.205419e-03 3 1  ON 22
ci_024                 9.761735e-03 3 1  ON 23
ci_025                 9.657693e-03 3 1  ON 24
ci_026                 1.079781e-02 3 1  ON 25
ci_027                 1.117450e-02 3 1  ON 26
ci_028                -1.518403e-02 3 1  ON 27
ci_029                -1.584070e-02 3 1  ON 28
ci_030                -9.050869e-03 3 1  ON 29
ci_031                -9.506080e-03 3 1  ON 30
ci_032                -1.480578e-02 3 1  ON 31
ci_033                 6.433307e-03 3 1  ON 32
ci_034                 5.865690e-03 3 1  ON 33
ci_035                -4.456730e-03 3 1  ON 34
ci_036                -1.210158e-02 3 1  ON 35
ci_037                -1.243757e-02 3 1  ON 36
ci_038                 2.052827e-03 3 1  ON 37
ci_039                 2.251787e-03 3 1  ON 38
ci_040                -2.692415e-03 3 1  ON 39
ci_041                 8.589947e-03 3 1  ON 40
ci_042                 8.583125e-03 3 1  ON 41
ci_043                -3.347112e-03 3 1  ON 42
ci_044                -5.028832e-03 3 1  ON 43
ci_045                -2.901569e-03 3 1  ON 44
ci_046                 5.539091e-03 3 1  ON 45
ci_047                 5.538296e-03 3 1  ON 46
ci_048                -1.252667e-02 3 1  ON 47
ci_049                -1.272431e-02 3 1  ON 48
ci_050                 3.636643e-03 3 1  ON 49
ci_051                 3.515061e-03 3 1  ON 50
ci_052                -2.888363e-03 3 1  ON 51
ci_053                -2.940556e-03 3 1  ON 52
ci_054                -3.062623e-03 3 1  ON 53
ci_055                -3.335208e-03 3 1  ON 54
ci_056                 5.218209e-03 3 1  ON 55
ci_057                 5.390619e-03 3 1  ON 56
ci_058                -2.563353e-03 3 1  ON 57
ci_059                -2.573199e-03 3 1  ON 58
ci_060                 5.232514e-03 3 1  ON 59
ci_061                 6.061149e-03 3 1  ON 60
ci_062                -3.707548e-03 3 1  ON 61
ci_063                -3.850041e-03 3 1  ON 62
ci_064                -2.855217e-03 3 1  ON 63
ci_065                -3.887211e-03 3 1  ON 64
ci_066                 4.317366e-03 3 1  ON 65
ci_067                 4.434380e-03 3 1  ON 66
ci_068                -5.147462e-03 3 1  ON 67
ci_069                -4.539241e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.156696
====================================================
  Execution time = 1.4053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9867e-01
  Total weights = 1.957488978e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287447352879
                                         uncertainty =       0.002080474418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287447352879
                                         uncertainty =       0.002080474418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379068240
  error estimate for blocks of size 2^( 2) =       0.000389724316
  error estimate for blocks of size 2^( 3) =       0.000399336349
  error estimate for blocks of size 2^( 4) =       0.000406807992
  error estimate for blocks of size 2^( 5) =       0.000411737692
  error estimate for blocks of size 2^( 6) =       0.000414767772
  error estimate for blocks of size 2^( 7) =       0.000415459579

      target function =      -0.903045410859
              le_mean =     -17.214410446840
             les_mean =     296.634594847291
             stat err =       0.000412193258
             autocorr =       1.182406945746
   target nu stat err =       0.000412193258
   target dn stat err =       0.002450188611
      target stat err =       0.003163453559
              std dev =       0.536083445473
             le_variance =       0.287385460510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721441044684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903055688438       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903576468313       residual = 4.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903699771509       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903730039264       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903735882275       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903739043057       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903739472413       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903739702777       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903739671445       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903739621742       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903739628387       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.161095e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903055688438       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903249886610       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903292766630       residual = 8.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903302372006       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903304089545       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903305007566       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903305131941       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903305181367       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903305176141       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903305161265       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.903305163833       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.185562e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903055688438       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903111036779       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903122894634       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903125449580       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903125891794       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903126127452       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903126160012       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903126171027       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903126169901       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903126166157       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.181099e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6538e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.053441e-02 3 1  ON 0
ci_002                -3.041964e-02 3 1  ON 1
ci_003                -2.498221e-02 3 1  ON 2
ci_004                 2.237320e-02 3 1  ON 3
ci_005                 2.307230e-02 3 1  ON 4
ci_006                -1.977100e-02 3 1  ON 5
ci_007                -1.965603e-02 3 1  ON 6
ci_008                -9.047468e-03 3 1  ON 7
ci_009                -1.476535e-02 3 1  ON 8
ci_010                -1.032341e-02 3 1  ON 9
ci_011                -1.062433e-02 3 1  ON 10
ci_012                -1.037717e-02 3 1  ON 11
ci_013                -1.998845e-02 3 1  ON 12
ci_014                 1.196830e-02 3 1  ON 13
ci_015                 1.222138e-02 3 1  ON 14
ci_016                 1.635476e-02 3 1  ON 15
ci_017                 1.627681e-02 3 1  ON 16
ci_018                 9.858671e-03 3 1  ON 17
ci_019                 1.022169e-02 3 1  ON 18
ci_020                 1.579137e-02 3 1  ON 19
ci_021                 1.595836e-02 3 1  ON 20
ci_022                 9.092932e-03 3 1  ON 21
ci_023                 9.123179e-03 3 1  ON 22
ci_024                 9.624919e-03 3 1  ON 23
ci_025                 9.750515e-03 3 1  ON 24
ci_026                 1.074294e-02 3 1  ON 25
ci_027                 1.092480e-02 3 1  ON 26
ci_028                -1.493383e-02 3 1  ON 27
ci_029                -1.570609e-02 3 1  ON 28
ci_030                -8.928719e-03 3 1  ON 29
ci_031                -9.312699e-03 3 1  ON 30
ci_032                -1.463125e-02 3 1  ON 31
ci_033                 6.068865e-03 3 1  ON 32
ci_034                 5.705409e-03 3 1  ON 33
ci_035                -4.257683e-03 3 1  ON 34
ci_036                -1.205510e-02 3 1  ON 35
ci_037                -1.225776e-02 3 1  ON 36
ci_038                 1.839046e-03 3 1  ON 37
ci_039                 2.153460e-03 3 1  ON 38
ci_040                -2.488628e-03 3 1  ON 39
ci_041                 8.571429e-03 3 1  ON 40
ci_042                 8.514909e-03 3 1  ON 41
ci_043                -3.197315e-03 3 1  ON 42
ci_044                -4.855567e-03 3 1  ON 43
ci_045                -2.807745e-03 3 1  ON 44
ci_046                 5.459399e-03 3 1  ON 45
ci_047                 5.396968e-03 3 1  ON 46
ci_048                -1.265710e-02 3 1  ON 47
ci_049                -1.281174e-02 3 1  ON 48
ci_050                 3.516054e-03 3 1  ON 49
ci_051                 3.618415e-03 3 1  ON 50
ci_052                -2.773678e-03 3 1  ON 51
ci_053                -2.762189e-03 3 1  ON 52
ci_054                -2.933304e-03 3 1  ON 53
ci_055                -3.163271e-03 3 1  ON 54
ci_056                 5.133596e-03 3 1  ON 55
ci_057                 5.319383e-03 3 1  ON 56
ci_058                -2.531743e-03 3 1  ON 57
ci_059                -2.626333e-03 3 1  ON 58
ci_060                 5.241934e-03 3 1  ON 59
ci_061                 5.995811e-03 3 1  ON 60
ci_062                -3.639216e-03 3 1  ON 61
ci_063                -3.595345e-03 3 1  ON 62
ci_064                -2.752566e-03 3 1  ON 63
ci_065                -3.785374e-03 3 1  ON 64
ci_066                 4.297333e-03 3 1  ON 65
ci_067                 4.310058e-03 3 1  ON 66
ci_068                -5.202062e-03 3 1  ON 67
ci_069                -4.412389e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.139124
====================================================
  Execution time = 1.3405e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0298e-01
  Total weights = 1.9575e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618102390
                                         uncertainty =       0.003047281335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289618102390
                                         uncertainty =       0.003047281335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380547917
  error estimate for blocks of size 2^( 2) =       0.000391692222
  error estimate for blocks of size 2^( 3) =       0.000401914526
  error estimate for blocks of size 2^( 4) =       0.000410006222
  error estimate for blocks of size 2^( 5) =       0.000414737350
  error estimate for blocks of size 2^( 6) =       0.000416675562
  error estimate for blocks of size 2^( 7) =       0.000417897825

      target function =      -0.890138939411
              le_mean =     -17.215609274722
             les_mean =     296.686333401106
             stat err =       0.000414829240
             autocorr =       1.188283380977
   target nu stat err =       0.000414829240
   target dn stat err =       0.006227755770
      target stat err =       0.007716719741
              std dev =       0.538176025050
             le_variance =       0.289633433938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813214688
                                         uncertainty =       0.003112280970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288813214688
                                         uncertainty =       0.003112280970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380016819
  error estimate for blocks of size 2^( 2) =       0.000391315802
  error estimate for blocks of size 2^( 3) =       0.000401710731
  error estimate for blocks of size 2^( 4) =       0.000409913402
  error estimate for blocks of size 2^( 5) =       0.000414711922
  error estimate for blocks of size 2^( 6) =       0.000416655375
  error estimate for blocks of size 2^( 7) =       0.000417977995

      target function =      -0.889230068410
              le_mean =     -17.215633383367
             les_mean =     296.687894840280
             stat err =       0.000414814674
             autocorr =       1.191523422261
   target nu stat err =       0.000414814674
   target dn stat err =       0.006724952325
      target stat err =       0.008312936162
              std dev =       0.537424939830
             le_variance =       0.288825565952

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288963966591
                                         uncertainty =       0.003087716612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288963966591
                                         uncertainty =       0.003087716612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380116499
  error estimate for blocks of size 2^( 2) =       0.000391372659
  error estimate for blocks of size 2^( 3) =       0.000401718174
  error estimate for blocks of size 2^( 4) =       0.000409889776
  error estimate for blocks of size 2^( 5) =       0.000414667770
  error estimate for blocks of size 2^( 6) =       0.000416615518
  error estimate for blocks of size 2^( 7) =       0.000417904274

      target function =      -0.895973885876
              le_mean =     -17.215619295041
             les_mean =     296.682020699837
             stat err =       0.000414769334
             autocorr =       1.190638269510
   target nu stat err =       0.000414769334
   target dn stat err =       0.003911533018
      target stat err =       0.004930811219
              std dev =       0.537565908528
             le_variance =       0.288977106012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289504292683
                                         uncertainty =       0.003051364068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289504292683
                                         uncertainty =       0.003051364068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380472940
  error estimate for blocks of size 2^( 2) =       0.000391632827
  error estimate for blocks of size 2^( 3) =       0.000401872622
  error estimate for blocks of size 2^( 4) =       0.000409976837
  error estimate for blocks of size 2^( 5) =       0.000414713773
  error estimate for blocks of size 2^( 6) =       0.000416652431
  error estimate for blocks of size 2^( 7) =       0.000417885087

      target function =      -0.896977521330
              le_mean =     -17.215608024652
             les_mean =     296.680831915938
             stat err =       0.000414807032
             autocorr =       1.188624483188
   target nu stat err =       0.000414807032
   target dn stat err =       0.003720449101
      target stat err =       0.004703696629
              std dev =       0.538069991898
             le_variance =       0.289519316181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.890138939411        initial
     9.7656e-02     9.7656e-01             1.1611e-03        -0.889230068410
     3.9062e-01     3.9062e+00             4.1856e-04        -0.895973885876
     1.5625e+00     1.5625e+01             1.1811e-04        -0.896977521330  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2780e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.082703e-02 3 1  ON 0
ci_002                -3.067280e-02 3 1  ON 1
ci_003                -2.518054e-02 3 1  ON 2
ci_004                 2.262787e-02 3 1  ON 3
ci_005                 2.316210e-02 3 1  ON 4
ci_006                -1.994511e-02 3 1  ON 5
ci_007                -1.981160e-02 3 1  ON 6
ci_008                -9.289046e-03 3 1  ON 7
ci_009                -1.497550e-02 3 1  ON 8
ci_010                -1.028093e-02 3 1  ON 9
ci_011                -1.060340e-02 3 1  ON 10
ci_012                -1.067761e-02 3 1  ON 11
ci_013                -2.020132e-02 3 1  ON 12
ci_014                 1.214844e-02 3 1  ON 13
ci_015                 1.241845e-02 3 1  ON 14
ci_016                 1.659086e-02 3 1  ON 15
ci_017                 1.641662e-02 3 1  ON 16
ci_018                 9.914794e-03 3 1  ON 17
ci_019                 1.039403e-02 3 1  ON 18
ci_020                 1.589971e-02 3 1  ON 19
ci_021                 1.601907e-02 3 1  ON 20
ci_022                 9.187421e-03 3 1  ON 21
ci_023                 9.181934e-03 3 1  ON 22
ci_024                 9.723688e-03 3 1  ON 23
ci_025                 9.684125e-03 3 1  ON 24
ci_026                 1.078302e-02 3 1  ON 25
ci_027                 1.110365e-02 3 1  ON 26
ci_028                -1.511377e-02 3 1  ON 27
ci_029                -1.580263e-02 3 1  ON 28
ci_030                -9.015624e-03 3 1  ON 29
ci_031                -9.450585e-03 3 1  ON 30
ci_032                -1.475675e-02 3 1  ON 31
ci_033                 6.331173e-03 3 1  ON 32
ci_034                 5.820565e-03 3 1  ON 33
ci_035                -4.400211e-03 3 1  ON 34
ci_036                -1.208945e-02 3 1  ON 35
ci_037                -1.238735e-02 3 1  ON 36
ci_038                 1.991964e-03 3 1  ON 37
ci_039                 2.223788e-03 3 1  ON 38
ci_040                -2.634363e-03 3 1  ON 39
ci_041                 8.585090e-03 3 1  ON 40
ci_042                 8.563750e-03 3 1  ON 41
ci_043                -3.304620e-03 3 1  ON 42
ci_044                -4.979776e-03 3 1  ON 43
ci_045                -2.874784e-03 3 1  ON 44
ci_046                 5.516691e-03 3 1  ON 45
ci_047                 5.498554e-03 3 1  ON 46
ci_048                -1.256225e-02 3 1  ON 47
ci_049                -1.274812e-02 3 1  ON 48
ci_050                 3.602010e-03 3 1  ON 49
ci_051                 3.544804e-03 3 1  ON 50
ci_052                -2.855560e-03 3 1  ON 51
ci_053                -2.889372e-03 3 1  ON 52
ci_054                -3.026442e-03 3 1  ON 53
ci_055                -3.286921e-03 3 1  ON 54
ci_056                 5.194236e-03 3 1  ON 55
ci_057                 5.370428e-03 3 1  ON 56
ci_058                -2.553791e-03 3 1  ON 57
ci_059                -2.587917e-03 3 1  ON 58
ci_060                 5.235263e-03 3 1  ON 59
ci_061                 6.042874e-03 3 1  ON 60
ci_062                -3.688342e-03 3 1  ON 61
ci_063                -3.777905e-03 3 1  ON 62
ci_064                -2.825885e-03 3 1  ON 63
ci_065                -3.858217e-03 3 1  ON 64
ci_066                 4.311341e-03 3 1  ON 65
ci_067                 4.398961e-03 3 1  ON 66
ci_068                -5.162491e-03 3 1  ON 67
ci_069                -4.503291e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2704
    reference variance = 0.179973
====================================================
  Execution time = 1.3608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0125e-01
  Total weights = 1.957352890e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288213898172
                                         uncertainty =       0.001659468846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288213898172
                                         uncertainty =       0.001659468846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379580851
  error estimate for blocks of size 2^( 2) =       0.000390439687
  error estimate for blocks of size 2^( 3) =       0.000400829376
  error estimate for blocks of size 2^( 4) =       0.000409283102
  error estimate for blocks of size 2^( 5) =       0.000414011674
  error estimate for blocks of size 2^( 6) =       0.000415226075
  error estimate for blocks of size 2^( 7) =       0.000416685982

      target function =      -0.900090010061
              le_mean =     -17.215817641665
             les_mean =     296.685625097436
             stat err =       0.000413801708
             autocorr =       1.188436462141
   target nu stat err =       0.000413801708
   target dn stat err =       0.002251513776
      target stat err =       0.002904039171
              std dev =       0.536808387426
             le_variance =       0.288163244811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721581764166e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900098656482       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900302630204       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900344033402       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900355296893       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900356893046       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900357118623       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900357155278       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900357198305       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900357189556       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900357191193       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.459734e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900098656482       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900156670613       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900168111526       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900171114212       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900171516860       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900171571630       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900171578522       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900171588959       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900171586795       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900171587300       residual = 7.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.069025e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900098656482       residual = 2.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900113676888       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900116613806       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900117376540       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900117477130       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900117490677       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900117492231       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900117494803       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900117494266       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900117494399       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.318095e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6112e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.062012e-02 3 1  ON 0
ci_002                -3.058741e-02 3 1  ON 1
ci_003                -2.512198e-02 3 1  ON 2
ci_004                 2.257093e-02 3 1  ON 3
ci_005                 2.304205e-02 3 1  ON 4
ci_006                -1.983758e-02 3 1  ON 5
ci_007                -1.979378e-02 3 1  ON 6
ci_008                -9.251185e-03 3 1  ON 7
ci_009                -1.495802e-02 3 1  ON 8
ci_010                -1.022589e-02 3 1  ON 9
ci_011                -1.052300e-02 3 1  ON 10
ci_012                -1.055722e-02 3 1  ON 11
ci_013                -2.015802e-02 3 1  ON 12
ci_014                 1.209966e-02 3 1  ON 13
ci_015                 1.237422e-02 3 1  ON 14
ci_016                 1.654898e-02 3 1  ON 15
ci_017                 1.637246e-02 3 1  ON 16
ci_018                 9.902404e-03 3 1  ON 17
ci_019                 1.033026e-02 3 1  ON 18
ci_020                 1.580974e-02 3 1  ON 19
ci_021                 1.596938e-02 3 1  ON 20
ci_022                 9.142965e-03 3 1  ON 21
ci_023                 9.139581e-03 3 1  ON 22
ci_024                 9.681257e-03 3 1  ON 23
ci_025                 9.628714e-03 3 1  ON 24
ci_026                 1.077281e-02 3 1  ON 25
ci_027                 1.107544e-02 3 1  ON 26
ci_028                -1.512609e-02 3 1  ON 27
ci_029                -1.572274e-02 3 1  ON 28
ci_030                -8.974881e-03 3 1  ON 29
ci_031                -9.380681e-03 3 1  ON 30
ci_032                -1.472666e-02 3 1  ON 31
ci_033                 6.316064e-03 3 1  ON 32
ci_034                 5.770415e-03 3 1  ON 33
ci_035                -4.333219e-03 3 1  ON 34
ci_036                -1.209995e-02 3 1  ON 35
ci_037                -1.234937e-02 3 1  ON 36
ci_038                 1.919587e-03 3 1  ON 37
ci_039                 2.159178e-03 3 1  ON 38
ci_040                -2.585534e-03 3 1  ON 39
ci_041                 8.548360e-03 3 1  ON 40
ci_042                 8.548588e-03 3 1  ON 41
ci_043                -3.252155e-03 3 1  ON 42
ci_044                -4.957377e-03 3 1  ON 43
ci_045                -2.792842e-03 3 1  ON 44
ci_046                 5.479186e-03 3 1  ON 45
ci_047                 5.486489e-03 3 1  ON 46
ci_048                -1.254189e-02 3 1  ON 47
ci_049                -1.275809e-02 3 1  ON 48
ci_050                 3.572420e-03 3 1  ON 49
ci_051                 3.539746e-03 3 1  ON 50
ci_052                -2.801603e-03 3 1  ON 51
ci_053                -2.857897e-03 3 1  ON 52
ci_054                -2.992438e-03 3 1  ON 53
ci_055                -3.260431e-03 3 1  ON 54
ci_056                 5.171128e-03 3 1  ON 55
ci_057                 5.336990e-03 3 1  ON 56
ci_058                -2.565367e-03 3 1  ON 57
ci_059                -2.532009e-03 3 1  ON 58
ci_060                 5.257123e-03 3 1  ON 59
ci_061                 5.993154e-03 3 1  ON 60
ci_062                -3.668357e-03 3 1  ON 61
ci_063                -3.739639e-03 3 1  ON 62
ci_064                -2.802353e-03 3 1  ON 63
ci_065                -3.816824e-03 3 1  ON 64
ci_066                 4.285455e-03 3 1  ON 65
ci_067                 4.389299e-03 3 1  ON 66
ci_068                -5.148687e-03 3 1  ON 67
ci_069                -4.509407e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2554
    reference variance = 0.374292
====================================================
  Execution time = 1.3736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0538e-01
  Total weights = 1.9574e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289223743205
                                         uncertainty =       0.003775232852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289223743205
                                         uncertainty =       0.003775232852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380212355
  error estimate for blocks of size 2^( 2) =       0.000391404127
  error estimate for blocks of size 2^( 3) =       0.000401275901
  error estimate for blocks of size 2^( 4) =       0.000408275923
  error estimate for blocks of size 2^( 5) =       0.000412742027
  error estimate for blocks of size 2^( 6) =       0.000415549198
  error estimate for blocks of size 2^( 7) =       0.000417908013

      target function =      -0.894310327505
              le_mean =     -17.215287459609
             les_mean =     296.671851697104
             stat err =       0.000413618790
             autocorr =       1.183444976025
   target nu stat err =       0.000413618790
   target dn stat err =       0.005489414698
      target stat err =       0.006867306788
              std dev =       0.537701468565
             le_variance =       0.289122869297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288931250834
                                         uncertainty =       0.003807642832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288931250834
                                         uncertainty =       0.003807642832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380019978
  error estimate for blocks of size 2^( 2) =       0.000391266394
  error estimate for blocks of size 2^( 3) =       0.000401191239
  error estimate for blocks of size 2^( 4) =       0.000408239061
  error estimate for blocks of size 2^( 5) =       0.000412729056
  error estimate for blocks of size 2^( 6) =       0.000415564375
  error estimate for blocks of size 2^( 7) =       0.000417922054

      target function =      -0.894758077285
              le_mean =     -17.215304673670
             les_mean =     296.672088641777
             stat err =       0.000413613637
             autocorr =       1.184613947007
   target nu stat err =       0.000413613637
   target dn stat err =       0.005458578244
      target stat err =       0.006835997165
              std dev =       0.537429406380
             le_variance =       0.288830366842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289048970598
                                         uncertainty =       0.003793500650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289048970598
                                         uncertainty =       0.003793500650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380097420
  error estimate for blocks of size 2^( 2) =       0.000391319705
  error estimate for blocks of size 2^( 3) =       0.000401221148
  error estimate for blocks of size 2^( 4) =       0.000408248158
  error estimate for blocks of size 2^( 5) =       0.000412727316
  error estimate for blocks of size 2^( 6) =       0.000415550031
  error estimate for blocks of size 2^( 7) =       0.000417908216

      target function =      -0.894869126304
              le_mean =     -17.215295668157
             les_mean =     296.671688007801
             stat err =       0.000413608430
             autocorr =       1.184101472440
   target nu stat err =       0.000413608430
   target dn stat err =       0.005464592841
      target stat err =       0.006845072878
              std dev =       0.537538925892
             le_variance =       0.288948096849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199760460
                                         uncertainty =       0.003777578187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289199760460
                                         uncertainty =       0.003777578187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380196585
  error estimate for blocks of size 2^( 2) =       0.000391392254
  error estimate for blocks of size 2^( 3) =       0.000401267826
  error estimate for blocks of size 2^( 4) =       0.000408271337
  error estimate for blocks of size 2^( 5) =       0.000412739093
  error estimate for blocks of size 2^( 6) =       0.000415548441
  error estimate for blocks of size 2^( 7) =       0.000417906469

      target function =      -0.894407233872
              le_mean =     -17.215288284649
             les_mean =     296.671802593093
             stat err =       0.000413616335
             autocorr =       1.183529098707
   target nu stat err =       0.000413616335
   target dn stat err =       0.005483094361
      target stat err =       0.006860944899
              std dev =       0.537679167570
             le_variance =       0.289098887239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894310327505        initial
     3.9062e-01     3.9062e+00             7.4597e-04        -0.894758077285
     1.5625e+00     1.5625e+01             2.0690e-04        -0.894869126304  <--
     6.2500e+00     6.2500e+01             5.3181e-05        -0.894407233872

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2978e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.062012e-02 3 1  ON 0
ci_002                -3.058741e-02 3 1  ON 1
ci_003                -2.512198e-02 3 1  ON 2
ci_004                 2.257093e-02 3 1  ON 3
ci_005                 2.304205e-02 3 1  ON 4
ci_006                -1.983758e-02 3 1  ON 5
ci_007                -1.979378e-02 3 1  ON 6
ci_008                -9.251185e-03 3 1  ON 7
ci_009                -1.495802e-02 3 1  ON 8
ci_010                -1.022589e-02 3 1  ON 9
ci_011                -1.052300e-02 3 1  ON 10
ci_012                -1.055722e-02 3 1  ON 11
ci_013                -2.015802e-02 3 1  ON 12
ci_014                 1.209966e-02 3 1  ON 13
ci_015                 1.237422e-02 3 1  ON 14
ci_016                 1.654898e-02 3 1  ON 15
ci_017                 1.637246e-02 3 1  ON 16
ci_018                 9.902404e-03 3 1  ON 17
ci_019                 1.033026e-02 3 1  ON 18
ci_020                 1.580974e-02 3 1  ON 19
ci_021                 1.596938e-02 3 1  ON 20
ci_022                 9.142965e-03 3 1  ON 21
ci_023                 9.139581e-03 3 1  ON 22
ci_024                 9.681257e-03 3 1  ON 23
ci_025                 9.628714e-03 3 1  ON 24
ci_026                 1.077281e-02 3 1  ON 25
ci_027                 1.107544e-02 3 1  ON 26
ci_028                -1.512609e-02 3 1  ON 27
ci_029                -1.572274e-02 3 1  ON 28
ci_030                -8.974881e-03 3 1  ON 29
ci_031                -9.380681e-03 3 1  ON 30
ci_032                -1.472666e-02 3 1  ON 31
ci_033                 6.316064e-03 3 1  ON 32
ci_034                 5.770415e-03 3 1  ON 33
ci_035                -4.333219e-03 3 1  ON 34
ci_036                -1.209995e-02 3 1  ON 35
ci_037                -1.234937e-02 3 1  ON 36
ci_038                 1.919587e-03 3 1  ON 37
ci_039                 2.159178e-03 3 1  ON 38
ci_040                -2.585534e-03 3 1  ON 39
ci_041                 8.548360e-03 3 1  ON 40
ci_042                 8.548588e-03 3 1  ON 41
ci_043                -3.252155e-03 3 1  ON 42
ci_044                -4.957377e-03 3 1  ON 43
ci_045                -2.792842e-03 3 1  ON 44
ci_046                 5.479186e-03 3 1  ON 45
ci_047                 5.486489e-03 3 1  ON 46
ci_048                -1.254189e-02 3 1  ON 47
ci_049                -1.275809e-02 3 1  ON 48
ci_050                 3.572420e-03 3 1  ON 49
ci_051                 3.539746e-03 3 1  ON 50
ci_052                -2.801603e-03 3 1  ON 51
ci_053                -2.857897e-03 3 1  ON 52
ci_054                -2.992438e-03 3 1  ON 53
ci_055                -3.260431e-03 3 1  ON 54
ci_056                 5.171128e-03 3 1  ON 55
ci_057                 5.336990e-03 3 1  ON 56
ci_058                -2.565367e-03 3 1  ON 57
ci_059                -2.532009e-03 3 1  ON 58
ci_060                 5.257123e-03 3 1  ON 59
ci_061                 5.993154e-03 3 1  ON 60
ci_062                -3.668357e-03 3 1  ON 61
ci_063                -3.739639e-03 3 1  ON 62
ci_064                -2.802353e-03 3 1  ON 63
ci_065                -3.816824e-03 3 1  ON 64
ci_066                 4.285455e-03 3 1  ON 65
ci_067                 4.389299e-03 3 1  ON 66
ci_068                -5.148687e-03 3 1  ON 67
ci_069                -4.509407e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1329
    reference variance = 0.271592
====================================================
  Execution time = 1.3885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0097e-01
  Total weights = 1.957338062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287938725573
                                         uncertainty =       0.001730809695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287938725573
                                         uncertainty =       0.001730809695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392560
  error estimate for blocks of size 2^( 2) =       0.000390179469
  error estimate for blocks of size 2^( 3) =       0.000399807189
  error estimate for blocks of size 2^( 4) =       0.000407404385
  error estimate for blocks of size 2^( 5) =       0.000412739158
  error estimate for blocks of size 2^( 6) =       0.000415482420
  error estimate for blocks of size 2^( 7) =       0.000417832658

      target function =      -0.900477895563
              le_mean =     -17.215970072156
             les_mean =     296.690592525060
             stat err =       0.000413364655
             autocorr =       1.187104792484
   target nu stat err =       0.000413364655
   target dn stat err =       0.002310504139
      target stat err =       0.002980226003
              std dev =       0.536542104132
             le_variance =       0.287877429506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597007216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900487011921       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900715507564       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900741313473       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900750360167       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900752124060       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900752379130       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900752513295       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900752476517       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900752471522       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900752461653       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900752467114       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.628664e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900487011921       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900552176560       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900559341072       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900561748281       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900562212447       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900562272807       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900562308717       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900562299069       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900562297562       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900562295343       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900562296717       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.283464e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900487011921       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900503897113       residual = 2.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900505738821       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900506349852       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900506467345       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900506482145       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900506491270       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900506488838       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900506488443       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900506487908       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900506488251       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.298726e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6382e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.049178e-02 3 1  ON 0
ci_002                -3.052988e-02 3 1  ON 1
ci_003                -2.509703e-02 3 1  ON 2
ci_004                 2.252984e-02 3 1  ON 3
ci_005                 2.300555e-02 3 1  ON 4
ci_006                -1.974149e-02 3 1  ON 5
ci_007                -1.973351e-02 3 1  ON 6
ci_008                -9.144414e-03 3 1  ON 7
ci_009                -1.484143e-02 3 1  ON 8
ci_010                -1.018137e-02 3 1  ON 9
ci_011                -1.046694e-02 3 1  ON 10
ci_012                -1.053602e-02 3 1  ON 11
ci_013                -2.008821e-02 3 1  ON 12
ci_014                 1.206890e-02 3 1  ON 13
ci_015                 1.232936e-02 3 1  ON 14
ci_016                 1.649609e-02 3 1  ON 15
ci_017                 1.635281e-02 3 1  ON 16
ci_018                 9.848671e-03 3 1  ON 17
ci_019                 1.025566e-02 3 1  ON 18
ci_020                 1.578321e-02 3 1  ON 19
ci_021                 1.591607e-02 3 1  ON 20
ci_022                 9.089812e-03 3 1  ON 21
ci_023                 9.091781e-03 3 1  ON 22
ci_024                 9.639836e-03 3 1  ON 23
ci_025                 9.585156e-03 3 1  ON 24
ci_026                 1.068695e-02 3 1  ON 25
ci_027                 1.101246e-02 3 1  ON 26
ci_028                -1.508467e-02 3 1  ON 27
ci_029                -1.570428e-02 3 1  ON 28
ci_030                -8.986144e-03 3 1  ON 29
ci_031                -9.317078e-03 3 1  ON 30
ci_032                -1.474452e-02 3 1  ON 31
ci_033                 6.290940e-03 3 1  ON 32
ci_034                 5.750756e-03 3 1  ON 33
ci_035                -4.271019e-03 3 1  ON 34
ci_036                -1.200129e-02 3 1  ON 35
ci_037                -1.232428e-02 3 1  ON 36
ci_038                 1.822444e-03 3 1  ON 37
ci_039                 2.123387e-03 3 1  ON 38
ci_040                -2.515290e-03 3 1  ON 39
ci_041                 8.517853e-03 3 1  ON 40
ci_042                 8.535041e-03 3 1  ON 41
ci_043                -3.220817e-03 3 1  ON 42
ci_044                -4.907063e-03 3 1  ON 43
ci_045                -2.771573e-03 3 1  ON 44
ci_046                 5.422431e-03 3 1  ON 45
ci_047                 5.447848e-03 3 1  ON 46
ci_048                -1.258312e-02 3 1  ON 47
ci_049                -1.275782e-02 3 1  ON 48
ci_050                 3.534183e-03 3 1  ON 49
ci_051                 3.505475e-03 3 1  ON 50
ci_052                -2.819257e-03 3 1  ON 51
ci_053                -2.788572e-03 3 1  ON 52
ci_054                -2.971255e-03 3 1  ON 53
ci_055                -3.206624e-03 3 1  ON 54
ci_056                 5.129727e-03 3 1  ON 55
ci_057                 5.323755e-03 3 1  ON 56
ci_058                -2.538818e-03 3 1  ON 57
ci_059                -2.482331e-03 3 1  ON 58
ci_060                 5.284458e-03 3 1  ON 59
ci_061                 5.943063e-03 3 1  ON 60
ci_062                -3.656974e-03 3 1  ON 61
ci_063                -3.690223e-03 3 1  ON 62
ci_064                -2.756473e-03 3 1  ON 63
ci_065                -3.775505e-03 3 1  ON 64
ci_066                 4.288946e-03 3 1  ON 65
ci_067                 4.376760e-03 3 1  ON 66
ci_068                -5.121877e-03 3 1  ON 67
ci_069                -4.490967e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2805
    reference variance = 0.409801
====================================================
  Execution time = 1.3723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0464e-01
  Total weights = 1.9575e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289992223472
                                         uncertainty =       0.003422225594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289992223472
                                         uncertainty =       0.003422225594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380791203
  error estimate for blocks of size 2^( 2) =       0.000391677167
  error estimate for blocks of size 2^( 3) =       0.000401394111
  error estimate for blocks of size 2^( 4) =       0.000409483358
  error estimate for blocks of size 2^( 5) =       0.000413807706
  error estimate for blocks of size 2^( 6) =       0.000416269431
  error estimate for blocks of size 2^( 7) =       0.000419378924

      target function =      -0.895431842040
              le_mean =     -17.215193628102
             les_mean =     296.667715642513
             stat err =       0.000414734855
             autocorr =       1.186225502188
   target nu stat err =       0.000414734855
   target dn stat err =       0.004869541066
      target stat err =       0.006112063701
              std dev =       0.538520084192
             le_variance =       0.290003881078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289611727523
                                         uncertainty =       0.003386286614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289611727523
                                         uncertainty =       0.003386286614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380541260
  error estimate for blocks of size 2^( 2) =       0.000391480439
  error estimate for blocks of size 2^( 3) =       0.000401254880
  error estimate for blocks of size 2^( 4) =       0.000409385659
  error estimate for blocks of size 2^( 5) =       0.000413736591
  error estimate for blocks of size 2^( 6) =       0.000416210183
  error estimate for blocks of size 2^( 7) =       0.000419321580

      target function =      -0.894507411575
              le_mean =     -17.215203528298
             les_mean =     296.668798525988
             stat err =       0.000414663503
             autocorr =       1.187375604465
   target nu stat err =       0.000414663503
   target dn stat err =       0.004890390232
      target stat err =       0.006125474890
              std dev =       0.538166610831
             le_variance =       0.289623301013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289766908453
                                         uncertainty =       0.003401663288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289766908453
                                         uncertainty =       0.003401663288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380643214
  error estimate for blocks of size 2^( 2) =       0.000391558067
  error estimate for blocks of size 2^( 3) =       0.000401306488
  error estimate for blocks of size 2^( 4) =       0.000409418573
  error estimate for blocks of size 2^( 5) =       0.000413756538
  error estimate for blocks of size 2^( 6) =       0.000416224002
  error estimate for blocks of size 2^( 7) =       0.000419333408

      target function =      -0.862590491387
              le_mean =     -17.215197242562
             les_mean =     296.694184013859
             stat err =       0.000414683130
             autocorr =       1.186851962105
   target nu stat err =       0.000414683130
   target dn stat err =       0.026917610948
      target stat err =       0.031256902533
              std dev =       0.538310795994
             le_variance =       0.289778513084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289961453962
                                         uncertainty =       0.003419533540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289961453962
                                         uncertainty =       0.003419533540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380770997
  error estimate for blocks of size 2^( 2) =       0.000391660772
  error estimate for blocks of size 2^( 3) =       0.000401381838
  error estimate for blocks of size 2^( 4) =       0.000409474076
  error estimate for blocks of size 2^( 5) =       0.000413800269
  error estimate for blocks of size 2^( 6) =       0.000416262809
  error estimate for blocks of size 2^( 7) =       0.000419372309

      target function =      -0.895514048833
              le_mean =     -17.215193958281
             les_mean =     296.667661330240
             stat err =       0.000414727366
             autocorr =       1.186308558511
   target nu stat err =       0.000414727366
   target dn stat err =       0.004865515550
      target stat err =       0.006108174437
              std dev =       0.538491508579
             le_variance =       0.289973104812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.895431842040        initial
     3.9062e-01     3.9062e+00             4.6287e-04        -0.894507411575
     1.5625e+00     1.5625e+01             1.2835e-04        -0.862590491387
     6.2500e+00     6.2500e+01             3.2987e-05        -0.895514048833  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3109e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.058714e-02 3 1  ON 0
ci_002                -3.057257e-02 3 1  ON 1
ci_003                -2.511568e-02 3 1  ON 2
ci_004                 2.256043e-02 3 1  ON 3
ci_005                 2.303269e-02 3 1  ON 4
ci_006                -1.981285e-02 3 1  ON 5
ci_007                -1.977826e-02 3 1  ON 6
ci_008                -9.223512e-03 3 1  ON 7
ci_009                -1.492786e-02 3 1  ON 8
ci_010                -1.021439e-02 3 1  ON 9
ci_011                -1.050850e-02 3 1  ON 10
ci_012                -1.055176e-02 3 1  ON 11
ci_013                -2.014011e-02 3 1  ON 12
ci_014                 1.209170e-02 3 1  ON 13
ci_015                 1.236263e-02 3 1  ON 14
ci_016                 1.653532e-02 3 1  ON 15
ci_017                 1.636735e-02 3 1  ON 16
ci_018                 9.888510e-03 3 1  ON 17
ci_019                 1.031094e-02 3 1  ON 18
ci_020                 1.580296e-02 3 1  ON 19
ci_021                 1.595568e-02 3 1  ON 20
ci_022                 9.129200e-03 3 1  ON 21
ci_023                 9.127265e-03 3 1  ON 22
ci_024                 9.670600e-03 3 1  ON 23
ci_025                 9.617528e-03 3 1  ON 24
ci_026                 1.075061e-02 3 1  ON 25
ci_027                 1.105916e-02 3 1  ON 26
ci_028                -1.511542e-02 3 1  ON 27
ci_029                -1.571795e-02 3 1  ON 28
ci_030                -8.977759e-03 3 1  ON 29
ci_031                -9.364198e-03 3 1  ON 30
ci_032                -1.473124e-02 3 1  ON 31
ci_033                 6.309603e-03 3 1  ON 32
ci_034                 5.765353e-03 3 1  ON 33
ci_035                -4.317122e-03 3 1  ON 34
ci_036                -1.207442e-02 3 1  ON 35
ci_037                -1.234293e-02 3 1  ON 36
ci_038                 1.894435e-03 3 1  ON 37
ci_039                 2.149909e-03 3 1  ON 38
ci_040                -2.567331e-03 3 1  ON 39
ci_041                 8.540470e-03 3 1  ON 40
ci_042                 8.545069e-03 3 1  ON 41
ci_043                -3.244043e-03 3 1  ON 42
ci_044                -4.944373e-03 3 1  ON 43
ci_045                -2.787325e-03 3 1  ON 44
ci_046                 5.464541e-03 3 1  ON 45
ci_047                 5.476518e-03 3 1  ON 46
ci_048                -1.255240e-02 3 1  ON 47
ci_049                -1.275801e-02 3 1  ON 48
ci_050                 3.562501e-03 3 1  ON 49
ci_051                 3.530846e-03 3 1  ON 50
ci_052                -2.806158e-03 3 1  ON 51
ci_053                -2.839907e-03 3 1  ON 52
ci_054                -2.986983e-03 3 1  ON 53
ci_055                -3.246528e-03 3 1  ON 54
ci_056                 5.160424e-03 3 1  ON 55
ci_057                 5.333566e-03 3 1  ON 56
ci_058                -2.558462e-03 3 1  ON 57
ci_059                -2.519125e-03 3 1  ON 58
ci_060                 5.264173e-03 3 1  ON 59
ci_061                 5.980239e-03 3 1  ON 60
ci_062                -3.665429e-03 3 1  ON 61
ci_063                -3.726889e-03 3 1  ON 62
ci_064                -2.790460e-03 3 1  ON 63
ci_065                -3.806123e-03 3 1  ON 64
ci_066                 4.286355e-03 3 1  ON 65
ci_067                 4.386050e-03 3 1  ON 66
ci_068                -5.141747e-03 3 1  ON 67
ci_069                -4.504629e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2829
    reference variance = 0.259006
====================================================
  Execution time = 1.3887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9993e-01
  Total weights = 1.957640043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286635758988
                                         uncertainty =       0.001684785930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286635758988
                                         uncertainty =       0.001684785930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378573959
  error estimate for blocks of size 2^( 2) =       0.000389222181
  error estimate for blocks of size 2^( 3) =       0.000398721613
  error estimate for blocks of size 2^( 4) =       0.000406238485
  error estimate for blocks of size 2^( 5) =       0.000411140576
  error estimate for blocks of size 2^( 6) =       0.000413529271
  error estimate for blocks of size 2^( 7) =       0.000415710944

      target function =      -0.901446243582
              le_mean =     -17.214400443282
             les_mean =     296.635509335708
             stat err =       0.000411654819
             autocorr =       1.182401399139
   target nu stat err =       0.000411654819
   target dn stat err =       0.002661242271
      target stat err =       0.003415030009
              std dev =       0.535384426619
             le_variance =       0.286636484266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721440044328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901458385876       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901506784613       residual = 5.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901520696877       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901525210790       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901525717083       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901525852752       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901525866728       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901525869943       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901525863181       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901525858494       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901525858788       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.123362e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901458385876       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901470934918       residual = 5.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901474511854       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901475660433       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901475787818       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901475821562       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901475824951       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901475825731       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901475824050       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901475822869       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901475822946       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.893487e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901458385876       residual = 2.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901461552535       residual = 5.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901462453156       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901462741567       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901462773460       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901462781882       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901462782722       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901462782916       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901462782496       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901462782201       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901462782220       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 7.288945e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393494 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6384e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.055936e-02 3 1  ON 0
ci_002                -3.055009e-02 3 1  ON 1
ci_003                -2.509523e-02 3 1  ON 2
ci_004                 2.254461e-02 3 1  ON 3
ci_005                 2.300375e-02 3 1  ON 4
ci_006                -1.980177e-02 3 1  ON 5
ci_007                -1.976794e-02 3 1  ON 6
ci_008                -9.219010e-03 3 1  ON 7
ci_009                -1.491401e-02 3 1  ON 8
ci_010                -1.020855e-02 3 1  ON 9
ci_011                -1.048233e-02 3 1  ON 10
ci_012                -1.053676e-02 3 1  ON 11
ci_013                -2.012734e-02 3 1  ON 12
ci_014                 1.207408e-02 3 1  ON 13
ci_015                 1.234953e-02 3 1  ON 14
ci_016                 1.652125e-02 3 1  ON 15
ci_017                 1.635651e-02 3 1  ON 16
ci_018                 9.887061e-03 3 1  ON 17
ci_019                 1.029319e-02 3 1  ON 18
ci_020                 1.580316e-02 3 1  ON 19
ci_021                 1.594905e-02 3 1  ON 20
ci_022                 9.124719e-03 3 1  ON 21
ci_023                 9.125454e-03 3 1  ON 22
ci_024                 9.645226e-03 3 1  ON 23
ci_025                 9.609488e-03 3 1  ON 24
ci_026                 1.073715e-02 3 1  ON 25
ci_027                 1.105660e-02 3 1  ON 26
ci_028                -1.508662e-02 3 1  ON 27
ci_029                -1.570315e-02 3 1  ON 28
ci_030                -8.960530e-03 3 1  ON 29
ci_031                -9.354434e-03 3 1  ON 30
ci_032                -1.473012e-02 3 1  ON 31
ci_033                 6.289416e-03 3 1  ON 32
ci_034                 5.764539e-03 3 1  ON 33
ci_035                -4.301821e-03 3 1  ON 34
ci_036                -1.207341e-02 3 1  ON 35
ci_037                -1.231782e-02 3 1  ON 36
ci_038                 1.878538e-03 3 1  ON 37
ci_039                 2.136102e-03 3 1  ON 38
ci_040                -2.560277e-03 3 1  ON 39
ci_041                 8.539108e-03 3 1  ON 40
ci_042                 8.537682e-03 3 1  ON 41
ci_043                -3.231949e-03 3 1  ON 42
ci_044                -4.945244e-03 3 1  ON 43
ci_045                -2.777654e-03 3 1  ON 44
ci_046                 5.452389e-03 3 1  ON 45
ci_047                 5.466574e-03 3 1  ON 46
ci_048                -1.255281e-02 3 1  ON 47
ci_049                -1.275293e-02 3 1  ON 48
ci_050                 3.545217e-03 3 1  ON 49
ci_051                 3.520153e-03 3 1  ON 50
ci_052                -2.796694e-03 3 1  ON 51
ci_053                -2.838186e-03 3 1  ON 52
ci_054                -2.971914e-03 3 1  ON 53
ci_055                -3.241950e-03 3 1  ON 54
ci_056                 5.160342e-03 3 1  ON 55
ci_057                 5.323016e-03 3 1  ON 56
ci_058                -2.556477e-03 3 1  ON 57
ci_059                -2.515848e-03 3 1  ON 58
ci_060                 5.257407e-03 3 1  ON 59
ci_061                 5.953178e-03 3 1  ON 60
ci_062                -3.657838e-03 3 1  ON 61
ci_063                -3.712529e-03 3 1  ON 62
ci_064                -2.785437e-03 3 1  ON 63
ci_065                -3.798036e-03 3 1  ON 64
ci_066                 4.286228e-03 3 1  ON 65
ci_067                 4.384469e-03 3 1  ON 66
ci_068                -5.146296e-03 3 1  ON 67
ci_069                -4.500390e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.160789
====================================================
  Execution time = 1.3736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0469e-01
  Total weights = 1.9574e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289793469807
                                         uncertainty =       0.001909832042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289793469807
                                         uncertainty =       0.001909832042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380632119
  error estimate for blocks of size 2^( 2) =       0.000391293229
  error estimate for blocks of size 2^( 3) =       0.000400983602
  error estimate for blocks of size 2^( 4) =       0.000408287759
  error estimate for blocks of size 2^( 5) =       0.000412276317
  error estimate for blocks of size 2^( 6) =       0.000414917768
  error estimate for blocks of size 2^( 7) =       0.000415664382

      target function =      -0.895493599279
              le_mean =     -17.214945871605
             les_mean =     296.659116365957
             stat err =       0.000412786556
             autocorr =       1.176089095951
   target nu stat err =       0.000412786556
   target dn stat err =       0.002802334344
      target stat err =       0.003547647996
              std dev =       0.538295105227
             le_variance =       0.289761620311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289706664289
                                         uncertainty =       0.001907633236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289706664289
                                         uncertainty =       0.001907633236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380574877
  error estimate for blocks of size 2^( 2) =       0.000391250938
  error estimate for blocks of size 2^( 3) =       0.000400955732
  error estimate for blocks of size 2^( 4) =       0.000408270136
  error estimate for blocks of size 2^( 5) =       0.000412264422
  error estimate for blocks of size 2^( 6) =       0.000414910761
  error estimate for blocks of size 2^( 7) =       0.000415664402

      target function =      -0.882113557765
              le_mean =     -17.214947864374
             les_mean =     296.669897423007
             stat err =       0.000412777430
             autocorr =       1.176390896343
   target nu stat err =       0.000412777430
   target dn stat err =       0.011209461746
      target stat err =       0.013602156309
              std dev =       0.538214152465
             le_variance =       0.289674473914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289747803175
                                         uncertainty =       0.001908675688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289747803175
                                         uncertainty =       0.001908675688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380602009
  error estimate for blocks of size 2^( 2) =       0.000391270849
  error estimate for blocks of size 2^( 3) =       0.000400968672
  error estimate for blocks of size 2^( 4) =       0.000408278105
  error estimate for blocks of size 2^( 5) =       0.000412269721
  error estimate for blocks of size 2^( 6) =       0.000414913723
  error estimate for blocks of size 2^( 7) =       0.000415664099

      target function =      -0.895626613902
              le_mean =     -17.214946750381
             les_mean =     296.659040367874
             stat err =       0.000412781412
             autocorr =       1.176245872354
   target nu stat err =       0.000412781412
   target dn stat err =       0.002793628110
      target stat err =       0.003537957279
              std dev =       0.538252522530
             le_variance =       0.289715778010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289787619586
                                         uncertainty =       0.001909684492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289787619586
                                         uncertainty =       0.001909684492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380628262
  error estimate for blocks of size 2^( 2) =       0.000391290349
  error estimate for blocks of size 2^( 3) =       0.000400981659
  error estimate for blocks of size 2^( 4) =       0.000408286480
  error estimate for blocks of size 2^( 5) =       0.000412275381
  error estimate for blocks of size 2^( 6) =       0.000414917176
  error estimate for blocks of size 2^( 7) =       0.000415664299

      target function =      -0.895146830661
              le_mean =     -17.214945976965
             les_mean =     296.659397584142
             stat err =       0.000412785834
             autocorr =       1.176108815266
   target nu stat err =       0.000412785834
   target dn stat err =       0.002820263580
      target stat err =       0.003567022505
              std dev =       0.538289650632
             le_variance =       0.289755747977


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.895493599279        initial
     1.5625e+00     1.5625e+01             1.1234e-04        -0.882113557765
     6.2500e+00     6.2500e+01             2.8935e-05        -0.895626613902  <--
     2.5000e+01     2.5000e+02             7.2889e-06        -0.895146830661

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2991e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.055936e-02 3 1  ON 0
ci_002                -3.055009e-02 3 1  ON 1
ci_003                -2.509523e-02 3 1  ON 2
ci_004                 2.254461e-02 3 1  ON 3
ci_005                 2.300375e-02 3 1  ON 4
ci_006                -1.980177e-02 3 1  ON 5
ci_007                -1.976794e-02 3 1  ON 6
ci_008                -9.219010e-03 3 1  ON 7
ci_009                -1.491401e-02 3 1  ON 8
ci_010                -1.020855e-02 3 1  ON 9
ci_011                -1.048233e-02 3 1  ON 10
ci_012                -1.053676e-02 3 1  ON 11
ci_013                -2.012734e-02 3 1  ON 12
ci_014                 1.207408e-02 3 1  ON 13
ci_015                 1.234953e-02 3 1  ON 14
ci_016                 1.652125e-02 3 1  ON 15
ci_017                 1.635651e-02 3 1  ON 16
ci_018                 9.887061e-03 3 1  ON 17
ci_019                 1.029319e-02 3 1  ON 18
ci_020                 1.580316e-02 3 1  ON 19
ci_021                 1.594905e-02 3 1  ON 20
ci_022                 9.124719e-03 3 1  ON 21
ci_023                 9.125454e-03 3 1  ON 22
ci_024                 9.645226e-03 3 1  ON 23
ci_025                 9.609488e-03 3 1  ON 24
ci_026                 1.073715e-02 3 1  ON 25
ci_027                 1.105660e-02 3 1  ON 26
ci_028                -1.508662e-02 3 1  ON 27
ci_029                -1.570315e-02 3 1  ON 28
ci_030                -8.960530e-03 3 1  ON 29
ci_031                -9.354434e-03 3 1  ON 30
ci_032                -1.473012e-02 3 1  ON 31
ci_033                 6.289416e-03 3 1  ON 32
ci_034                 5.764539e-03 3 1  ON 33
ci_035                -4.301821e-03 3 1  ON 34
ci_036                -1.207341e-02 3 1  ON 35
ci_037                -1.231782e-02 3 1  ON 36
ci_038                 1.878538e-03 3 1  ON 37
ci_039                 2.136102e-03 3 1  ON 38
ci_040                -2.560277e-03 3 1  ON 39
ci_041                 8.539108e-03 3 1  ON 40
ci_042                 8.537682e-03 3 1  ON 41
ci_043                -3.231949e-03 3 1  ON 42
ci_044                -4.945244e-03 3 1  ON 43
ci_045                -2.777654e-03 3 1  ON 44
ci_046                 5.452389e-03 3 1  ON 45
ci_047                 5.466574e-03 3 1  ON 46
ci_048                -1.255281e-02 3 1  ON 47
ci_049                -1.275293e-02 3 1  ON 48
ci_050                 3.545217e-03 3 1  ON 49
ci_051                 3.520153e-03 3 1  ON 50
ci_052                -2.796694e-03 3 1  ON 51
ci_053                -2.838186e-03 3 1  ON 52
ci_054                -2.971914e-03 3 1  ON 53
ci_055                -3.241950e-03 3 1  ON 54
ci_056                 5.160342e-03 3 1  ON 55
ci_057                 5.323016e-03 3 1  ON 56
ci_058                -2.556477e-03 3 1  ON 57
ci_059                -2.515848e-03 3 1  ON 58
ci_060                 5.257407e-03 3 1  ON 59
ci_061                 5.953178e-03 3 1  ON 60
ci_062                -3.657838e-03 3 1  ON 61
ci_063                -3.712529e-03 3 1  ON 62
ci_064                -2.785437e-03 3 1  ON 63
ci_065                -3.798036e-03 3 1  ON 64
ci_066                 4.286228e-03 3 1  ON 65
ci_067                 4.384469e-03 3 1  ON 66
ci_068                -5.146296e-03 3 1  ON 67
ci_069                -4.500390e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.225
    reference variance = 0.248904
====================================================
  Execution time = 1.3817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0678e-01
  Total weights = 1.956747510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292193844929
                                         uncertainty =       0.001963856059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292193844929
                                         uncertainty =       0.001963856059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382188944
  error estimate for blocks of size 2^( 2) =       0.000393208180
  error estimate for blocks of size 2^( 3) =       0.000402991720
  error estimate for blocks of size 2^( 4) =       0.000410623752
  error estimate for blocks of size 2^( 5) =       0.000415440814
  error estimate for blocks of size 2^( 6) =       0.000417296268
  error estimate for blocks of size 2^( 7) =       0.000418661072

      target function =      -0.893033750966
              le_mean =     -17.215271999373
             les_mean =     296.672374812685
             stat err =       0.000415505476
             autocorr =       1.181944994962
   target nu stat err =       0.000415505476
   target dn stat err =       0.002587524266
      target stat err =       0.003267743716
              std dev =       0.540496787293
             le_variance =       0.292136777074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721527199937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.893044884722       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.893098129392       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.893110863824       residual = 9.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.893114023658       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.893114325949       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.893114403326       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.893114408069       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.893114384128       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.893114372682       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.893114366898       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.893114364790       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.267500e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.893044884722       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.893058680250       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.893061953120       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.893062756625       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.893062832680       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.893062851987       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.893062853187       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.893062847179       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.893062844315       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.893062842849       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.893062842325       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.276289e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.893044884722       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.893048365264       residual = 4.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.893049189245       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.893049390974       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.893049410016       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.893049414840       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.893049415141       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.893049413638       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.893049412921       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.893049412554       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.893049412423       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 8.260806e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6331e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.053465e-02 3 1  ON 0
ci_002                -3.053442e-02 3 1  ON 1
ci_003                -2.508075e-02 3 1  ON 2
ci_004                 2.252992e-02 3 1  ON 3
ci_005                 2.297942e-02 3 1  ON 4
ci_006                -1.977925e-02 3 1  ON 5
ci_007                -1.974476e-02 3 1  ON 6
ci_008                -9.206786e-03 3 1  ON 7
ci_009                -1.488124e-02 3 1  ON 8
ci_010                -1.018524e-02 3 1  ON 9
ci_011                -1.047498e-02 3 1  ON 10
ci_012                -1.052086e-02 3 1  ON 11
ci_013                -2.011873e-02 3 1  ON 12
ci_014                 1.204958e-02 3 1  ON 13
ci_015                 1.233135e-02 3 1  ON 14
ci_016                 1.650061e-02 3 1  ON 15
ci_017                 1.634969e-02 3 1  ON 16
ci_018                 9.881227e-03 3 1  ON 17
ci_019                 1.027673e-02 3 1  ON 18
ci_020                 1.580258e-02 3 1  ON 19
ci_021                 1.593516e-02 3 1  ON 20
ci_022                 9.118821e-03 3 1  ON 21
ci_023                 9.119528e-03 3 1  ON 22
ci_024                 9.637852e-03 3 1  ON 23
ci_025                 9.601630e-03 3 1  ON 24
ci_026                 1.071730e-02 3 1  ON 25
ci_027                 1.104164e-02 3 1  ON 26
ci_028                -1.507687e-02 3 1  ON 27
ci_029                -1.568935e-02 3 1  ON 28
ci_030                -8.962086e-03 3 1  ON 29
ci_031                -9.348716e-03 3 1  ON 30
ci_032                -1.472986e-02 3 1  ON 31
ci_033                 6.278221e-03 3 1  ON 32
ci_034                 5.757470e-03 3 1  ON 33
ci_035                -4.288723e-03 3 1  ON 34
ci_036                -1.206636e-02 3 1  ON 35
ci_037                -1.231165e-02 3 1  ON 36
ci_038                 1.861543e-03 3 1  ON 37
ci_039                 2.125347e-03 3 1  ON 38
ci_040                -2.548839e-03 3 1  ON 39
ci_041                 8.533600e-03 3 1  ON 40
ci_042                 8.532058e-03 3 1  ON 41
ci_043                -3.224231e-03 3 1  ON 42
ci_044                -4.930925e-03 3 1  ON 43
ci_045                -2.767648e-03 3 1  ON 44
ci_046                 5.446929e-03 3 1  ON 45
ci_047                 5.458038e-03 3 1  ON 46
ci_048                -1.255919e-02 3 1  ON 47
ci_049                -1.274236e-02 3 1  ON 48
ci_050                 3.550542e-03 3 1  ON 49
ci_051                 3.502337e-03 3 1  ON 50
ci_052                -2.793446e-03 3 1  ON 51
ci_053                -2.832328e-03 3 1  ON 52
ci_054                -2.967902e-03 3 1  ON 53
ci_055                -3.231902e-03 3 1  ON 54
ci_056                 5.146535e-03 3 1  ON 55
ci_057                 5.323742e-03 3 1  ON 56
ci_058                -2.543029e-03 3 1  ON 57
ci_059                -2.501048e-03 3 1  ON 58
ci_060                 5.250602e-03 3 1  ON 59
ci_061                 5.946124e-03 3 1  ON 60
ci_062                -3.649060e-03 3 1  ON 61
ci_063                -3.710491e-03 3 1  ON 62
ci_064                -2.771105e-03 3 1  ON 63
ci_065                -3.795352e-03 3 1  ON 64
ci_066                 4.287836e-03 3 1  ON 65
ci_067                 4.386400e-03 3 1  ON 66
ci_068                -5.160531e-03 3 1  ON 67
ci_069                -4.487900e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1505
    reference variance = 0.496399
====================================================
  Execution time = 1.3676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0001e-01
  Total weights = 1.9575e+06
  Execution time = 1.8348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286806037822
                                         uncertainty =       0.001449571607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286806037822
                                         uncertainty =       0.001449571607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378673704
  error estimate for blocks of size 2^( 2) =       0.000389620126
  error estimate for blocks of size 2^( 3) =       0.000399179188
  error estimate for blocks of size 2^( 4) =       0.000406338310
  error estimate for blocks of size 2^( 5) =       0.000410725265
  error estimate for blocks of size 2^( 6) =       0.000413776194
  error estimate for blocks of size 2^( 7) =       0.000416184649

      target function =      -0.899826989464
              le_mean =     -17.215094194730
             les_mean =     296.660794972270
             stat err =       0.000411756104
             autocorr =       1.182360186867
   target nu stat err =       0.000411756104
   target dn stat err =       0.002964440855
      target stat err =       0.003784196411
              std dev =       0.535525487943
             le_variance =       0.286787548236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286719826737
                                         uncertainty =       0.001449694726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286719826737
                                         uncertainty =       0.001449694726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378616855
  error estimate for blocks of size 2^( 2) =       0.000389578210
  error estimate for blocks of size 2^( 3) =       0.000399155161
  error estimate for blocks of size 2^( 4) =       0.000406329750
  error estimate for blocks of size 2^( 5) =       0.000410722940
  error estimate for blocks of size 2^( 6) =       0.000413776199
  error estimate for blocks of size 2^( 7) =       0.000416183501

      target function =      -0.901593761145
              le_mean =     -17.215095786145
             les_mean =     296.659454694915
             stat err =       0.000411753098
             autocorr =       1.182697998297
   target nu stat err =       0.000411753098
   target dn stat err =       0.002661540288
      target stat err =       0.003420228908
              std dev =       0.535445091807
             le_variance =       0.286701446340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286760785637
                                         uncertainty =       0.001449624670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286760785637
                                         uncertainty =       0.001449624670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378643865
  error estimate for blocks of size 2^( 2) =       0.000389597972
  error estimate for blocks of size 2^( 3) =       0.000399166254
  error estimate for blocks of size 2^( 4) =       0.000406333356
  error estimate for blocks of size 2^( 5) =       0.000410723518
  error estimate for blocks of size 2^( 6) =       0.000413775684
  error estimate for blocks of size 2^( 7) =       0.000416183527

      target function =      -0.901607421106
              le_mean =     -17.215094917424
             les_mean =     296.659413993189
             stat err =       0.000411754021
             autocorr =       1.182534580940
   target nu stat err =       0.000411754021
   target dn stat err =       0.002642021279
      target stat err =       0.003395962203
              std dev =       0.535483288870
             le_variance =       0.286742352659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286800250612
                                         uncertainty =       0.001449577295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286800250612
                                         uncertainty =       0.001449577295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378669888
  error estimate for blocks of size 2^( 2) =       0.000389617279
  error estimate for blocks of size 2^( 3) =       0.000399177494
  error estimate for blocks of size 2^( 4) =       0.000406337581
  error estimate for blocks of size 2^( 5) =       0.000410724927
  error estimate for blocks of size 2^( 6) =       0.000413776036
  error estimate for blocks of size 2^( 7) =       0.000416184383

      target function =      -0.901155968194
              le_mean =     -17.215094288717
             les_mean =     296.659748816188
             stat err =       0.000411755732
             autocorr =       1.182381876807
   target nu stat err =       0.000411755732
   target dn stat err =       0.002647910345
      target stat err =       0.003399951521
              std dev =       0.535520091309
             le_variance =       0.286781768196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899826989464        initial
     1.5625e+00     1.5625e+01             1.2675e-04        -0.901593761145
     6.2500e+00     6.2500e+01             3.2763e-05        -0.901607421106  <--
     2.5000e+01     2.5000e+02             8.2608e-06        -0.901155968194

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3050e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.053465e-02 3 1  ON 0
ci_002                -3.053442e-02 3 1  ON 1
ci_003                -2.508075e-02 3 1  ON 2
ci_004                 2.252992e-02 3 1  ON 3
ci_005                 2.297942e-02 3 1  ON 4
ci_006                -1.977925e-02 3 1  ON 5
ci_007                -1.974476e-02 3 1  ON 6
ci_008                -9.206786e-03 3 1  ON 7
ci_009                -1.488124e-02 3 1  ON 8
ci_010                -1.018524e-02 3 1  ON 9
ci_011                -1.047498e-02 3 1  ON 10
ci_012                -1.052086e-02 3 1  ON 11
ci_013                -2.011873e-02 3 1  ON 12
ci_014                 1.204958e-02 3 1  ON 13
ci_015                 1.233135e-02 3 1  ON 14
ci_016                 1.650061e-02 3 1  ON 15
ci_017                 1.634969e-02 3 1  ON 16
ci_018                 9.881227e-03 3 1  ON 17
ci_019                 1.027673e-02 3 1  ON 18
ci_020                 1.580258e-02 3 1  ON 19
ci_021                 1.593516e-02 3 1  ON 20
ci_022                 9.118821e-03 3 1  ON 21
ci_023                 9.119528e-03 3 1  ON 22
ci_024                 9.637852e-03 3 1  ON 23
ci_025                 9.601630e-03 3 1  ON 24
ci_026                 1.071730e-02 3 1  ON 25
ci_027                 1.104164e-02 3 1  ON 26
ci_028                -1.507687e-02 3 1  ON 27
ci_029                -1.568935e-02 3 1  ON 28
ci_030                -8.962086e-03 3 1  ON 29
ci_031                -9.348716e-03 3 1  ON 30
ci_032                -1.472986e-02 3 1  ON 31
ci_033                 6.278221e-03 3 1  ON 32
ci_034                 5.757470e-03 3 1  ON 33
ci_035                -4.288723e-03 3 1  ON 34
ci_036                -1.206636e-02 3 1  ON 35
ci_037                -1.231165e-02 3 1  ON 36
ci_038                 1.861543e-03 3 1  ON 37
ci_039                 2.125347e-03 3 1  ON 38
ci_040                -2.548839e-03 3 1  ON 39
ci_041                 8.533600e-03 3 1  ON 40
ci_042                 8.532058e-03 3 1  ON 41
ci_043                -3.224231e-03 3 1  ON 42
ci_044                -4.930925e-03 3 1  ON 43
ci_045                -2.767648e-03 3 1  ON 44
ci_046                 5.446929e-03 3 1  ON 45
ci_047                 5.458038e-03 3 1  ON 46
ci_048                -1.255919e-02 3 1  ON 47
ci_049                -1.274236e-02 3 1  ON 48
ci_050                 3.550542e-03 3 1  ON 49
ci_051                 3.502337e-03 3 1  ON 50
ci_052                -2.793446e-03 3 1  ON 51
ci_053                -2.832328e-03 3 1  ON 52
ci_054                -2.967902e-03 3 1  ON 53
ci_055                -3.231902e-03 3 1  ON 54
ci_056                 5.146535e-03 3 1  ON 55
ci_057                 5.323742e-03 3 1  ON 56
ci_058                -2.543029e-03 3 1  ON 57
ci_059                -2.501048e-03 3 1  ON 58
ci_060                 5.250602e-03 3 1  ON 59
ci_061                 5.946124e-03 3 1  ON 60
ci_062                -3.649060e-03 3 1  ON 61
ci_063                -3.710491e-03 3 1  ON 62
ci_064                -2.771105e-03 3 1  ON 63
ci_065                -3.795352e-03 3 1  ON 64
ci_066                 4.287836e-03 3 1  ON 65
ci_067                 4.386400e-03 3 1  ON 66
ci_068                -5.160531e-03 3 1  ON 67
ci_069                -4.487900e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.171
    reference variance = 0.184837
====================================================
  Execution time = 1.3750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0460e-01
  Total weights = 1.957516378e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286811660841
                                         uncertainty =       0.001568151755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286811660841
                                         uncertainty =       0.001568151755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378699075
  error estimate for blocks of size 2^( 2) =       0.000389706930
  error estimate for blocks of size 2^( 3) =       0.000399876887
  error estimate for blocks of size 2^( 4) =       0.000407631481
  error estimate for blocks of size 2^( 5) =       0.000411851343
  error estimate for blocks of size 2^( 6) =       0.000414979903
  error estimate for blocks of size 2^( 7) =       0.000417087841

      target function =      -0.895747201946
              le_mean =     -17.215398545974
             les_mean =     296.674548733214
             stat err =       0.000412887642
             autocorr =       1.188708258333
   target nu stat err =       0.000412887642
   target dn stat err =       0.005157020403
      target stat err =       0.006476167268
              std dev =       0.535561368116
             le_variance =       0.286825979019


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721539854597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895793150887       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895867953676       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895877520967       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895880367489       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895880858893       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895880953713       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895881005170       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895881030794       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895881023531       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895881022525       residual = 9.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.285399e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895793150887       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895812530725       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895814986866       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895815710104       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895815833433       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895815856634       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895815869654       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895815875984       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895815874241       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895815873919       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.320074e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895793150887       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895798040233       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895798658413       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895798839951       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895798870808       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895798876574       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895798879839       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895798881416       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895798880985       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895798880900       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 8.369637e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6227e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.050654e-02 3 1  ON 0
ci_002                -3.051344e-02 3 1  ON 1
ci_003                -2.505506e-02 3 1  ON 2
ci_004                 2.252142e-02 3 1  ON 3
ci_005                 2.296422e-02 3 1  ON 4
ci_006                -1.976700e-02 3 1  ON 5
ci_007                -1.972224e-02 3 1  ON 6
ci_008                -9.190499e-03 3 1  ON 7
ci_009                -1.487850e-02 3 1  ON 8
ci_010                -1.018714e-02 3 1  ON 9
ci_011                -1.044451e-02 3 1  ON 10
ci_012                -1.051598e-02 3 1  ON 11
ci_013                -2.010355e-02 3 1  ON 12
ci_014                 1.204171e-02 3 1  ON 13
ci_015                 1.231433e-02 3 1  ON 14
ci_016                 1.649062e-02 3 1  ON 15
ci_017                 1.634096e-02 3 1  ON 16
ci_018                 9.863898e-03 3 1  ON 17
ci_019                 1.024750e-02 3 1  ON 18
ci_020                 1.581416e-02 3 1  ON 19
ci_021                 1.591946e-02 3 1  ON 20
ci_022                 9.089297e-03 3 1  ON 21
ci_023                 9.095910e-03 3 1  ON 22
ci_024                 9.627667e-03 3 1  ON 23
ci_025                 9.595488e-03 3 1  ON 24
ci_026                 1.071957e-02 3 1  ON 25
ci_027                 1.101992e-02 3 1  ON 26
ci_028                -1.507200e-02 3 1  ON 27
ci_029                -1.568799e-02 3 1  ON 28
ci_030                -8.951659e-03 3 1  ON 29
ci_031                -9.339359e-03 3 1  ON 30
ci_032                -1.472852e-02 3 1  ON 31
ci_033                 6.273334e-03 3 1  ON 32
ci_034                 5.753488e-03 3 1  ON 33
ci_035                -4.280146e-03 3 1  ON 34
ci_036                -1.205654e-02 3 1  ON 35
ci_037                -1.227845e-02 3 1  ON 36
ci_038                 1.849432e-03 3 1  ON 37
ci_039                 2.118065e-03 3 1  ON 38
ci_040                -2.526530e-03 3 1  ON 39
ci_041                 8.527762e-03 3 1  ON 40
ci_042                 8.524313e-03 3 1  ON 41
ci_043                -3.210475e-03 3 1  ON 42
ci_044                -4.935172e-03 3 1  ON 43
ci_045                -2.755111e-03 3 1  ON 44
ci_046                 5.436431e-03 3 1  ON 45
ci_047                 5.449380e-03 3 1  ON 46
ci_048                -1.255595e-02 3 1  ON 47
ci_049                -1.274705e-02 3 1  ON 48
ci_050                 3.532547e-03 3 1  ON 49
ci_051                 3.489536e-03 3 1  ON 50
ci_052                -2.776656e-03 3 1  ON 51
ci_053                -2.816581e-03 3 1  ON 52
ci_054                -2.957434e-03 3 1  ON 53
ci_055                -3.225056e-03 3 1  ON 54
ci_056                 5.126854e-03 3 1  ON 55
ci_057                 5.319716e-03 3 1  ON 56
ci_058                -2.550176e-03 3 1  ON 57
ci_059                -2.505159e-03 3 1  ON 58
ci_060                 5.240080e-03 3 1  ON 59
ci_061                 5.933726e-03 3 1  ON 60
ci_062                -3.640048e-03 3 1  ON 61
ci_063                -3.694380e-03 3 1  ON 62
ci_064                -2.762080e-03 3 1  ON 63
ci_065                -3.788101e-03 3 1  ON 64
ci_066                 4.280355e-03 3 1  ON 65
ci_067                 4.372582e-03 3 1  ON 66
ci_068                -5.148676e-03 3 1  ON 67
ci_069                -4.503871e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2458
    reference variance = 0.167632
====================================================
  Execution time = 1.4843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1088e-01
  Total weights = 1.9570e+06
  Execution time = 2.3137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292063583593
                                         uncertainty =       0.002575344092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292063583593
                                         uncertainty =       0.002575344092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382265525
  error estimate for blocks of size 2^( 2) =       0.000393555161
  error estimate for blocks of size 2^( 3) =       0.000403149454
  error estimate for blocks of size 2^( 4) =       0.000409739255
  error estimate for blocks of size 2^( 5) =       0.000413491565
  error estimate for blocks of size 2^( 6) =       0.000416954267
  error estimate for blocks of size 2^( 7) =       0.000420374638

      target function =      -0.888140055868
              le_mean =     -17.215512158009
             les_mean =     296.684608508873
             stat err =       0.000415139931
             autocorr =       1.179393565103
   target nu stat err =       0.000415139931
   target dn stat err =       0.005474391459
      target stat err =       0.006757338038
              std dev =       0.540605089364
             le_variance =       0.292253862647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292191043319
                                         uncertainty =       0.002757859417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292191043319
                                         uncertainty =       0.002757859417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382348989
  error estimate for blocks of size 2^( 2) =       0.000393650334
  error estimate for blocks of size 2^( 3) =       0.000403257440
  error estimate for blocks of size 2^( 4) =       0.000409860720
  error estimate for blocks of size 2^( 5) =       0.000413615964
  error estimate for blocks of size 2^( 6) =       0.000417082279
  error estimate for blocks of size 2^( 7) =       0.000420494801

      target function =      -0.886510855204
              le_mean =     -17.215511507947
             les_mean =     296.685904963206
             stat err =       0.000415263441
             autocorr =       1.179580282813
   target nu stat err =       0.000415263441
   target dn stat err =       0.006006036947
      target stat err =       0.007382049767
              std dev =       0.540723125377
             le_variance =       0.292381498317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292122360842
                                         uncertainty =       0.002663903879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292122360842
                                         uncertainty =       0.002663903879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382304022
  error estimate for blocks of size 2^( 2) =       0.000393599790
  error estimate for blocks of size 2^( 3) =       0.000403200784
  error estimate for blocks of size 2^( 4) =       0.000409797521
  error estimate for blocks of size 2^( 5) =       0.000413551599
  error estimate for blocks of size 2^( 6) =       0.000417016055
  error estimate for blocks of size 2^( 7) =       0.000420431812

      target function =      -0.887772599862
              le_mean =     -17.215511644641
             les_mean =     296.684886021345
             stat err =       0.000415199247
             autocorr =       1.179493029643
   target nu stat err =       0.000415199247
   target dn stat err =       0.005714049535
      target stat err =       0.007045286979
              std dev =       0.540659533307
             le_variance =       0.292312730955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292070291025
                                         uncertainty =       0.002585945596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292070291025
                                         uncertainty =       0.002585945596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382269919
  error estimate for blocks of size 2^( 2) =       0.000393560334
  error estimate for blocks of size 2^( 3) =       0.000403155474
  error estimate for blocks of size 2^( 4) =       0.000409746151
  error estimate for blocks of size 2^( 5) =       0.000413498694
  error estimate for blocks of size 2^( 6) =       0.000416961620
  error estimate for blocks of size 2^( 7) =       0.000420381418

      target function =      -0.888102167120
              le_mean =     -17.215512079450
             les_mean =     296.684636171098
             stat err =       0.000415146971
             autocorr =       1.179406447040
   target nu stat err =       0.000415146971
   target dn stat err =       0.005503203762
      target stat err =       0.006792072443
              std dev =       0.540611303690
             le_variance =       0.292260581677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.888140055868        initial  <--
     1.5625e+00     1.5625e+01             1.2854e-04        -0.886510855204
     6.2500e+00     6.2500e+01             3.3201e-05        -0.887772599862
     2.5000e+01     2.5000e+02             8.3696e-06        -0.888102167120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.5877
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.053465e-02 3 1  ON 0
ci_002                -3.053442e-02 3 1  ON 1
ci_003                -2.508075e-02 3 1  ON 2
ci_004                 2.252992e-02 3 1  ON 3
ci_005                 2.297942e-02 3 1  ON 4
ci_006                -1.977925e-02 3 1  ON 5
ci_007                -1.974476e-02 3 1  ON 6
ci_008                -9.206786e-03 3 1  ON 7
ci_009                -1.488124e-02 3 1  ON 8
ci_010                -1.018524e-02 3 1  ON 9
ci_011                -1.047498e-02 3 1  ON 10
ci_012                -1.052086e-02 3 1  ON 11
ci_013                -2.011873e-02 3 1  ON 12
ci_014                 1.204958e-02 3 1  ON 13
ci_015                 1.233135e-02 3 1  ON 14
ci_016                 1.650061e-02 3 1  ON 15
ci_017                 1.634969e-02 3 1  ON 16
ci_018                 9.881227e-03 3 1  ON 17
ci_019                 1.027673e-02 3 1  ON 18
ci_020                 1.580258e-02 3 1  ON 19
ci_021                 1.593516e-02 3 1  ON 20
ci_022                 9.118821e-03 3 1  ON 21
ci_023                 9.119528e-03 3 1  ON 22
ci_024                 9.637852e-03 3 1  ON 23
ci_025                 9.601630e-03 3 1  ON 24
ci_026                 1.071730e-02 3 1  ON 25
ci_027                 1.104164e-02 3 1  ON 26
ci_028                -1.507687e-02 3 1  ON 27
ci_029                -1.568935e-02 3 1  ON 28
ci_030                -8.962086e-03 3 1  ON 29
ci_031                -9.348716e-03 3 1  ON 30
ci_032                -1.472986e-02 3 1  ON 31
ci_033                 6.278221e-03 3 1  ON 32
ci_034                 5.757470e-03 3 1  ON 33
ci_035                -4.288723e-03 3 1  ON 34
ci_036                -1.206636e-02 3 1  ON 35
ci_037                -1.231165e-02 3 1  ON 36
ci_038                 1.861543e-03 3 1  ON 37
ci_039                 2.125347e-03 3 1  ON 38
ci_040                -2.548839e-03 3 1  ON 39
ci_041                 8.533600e-03 3 1  ON 40
ci_042                 8.532058e-03 3 1  ON 41
ci_043                -3.224231e-03 3 1  ON 42
ci_044                -4.930925e-03 3 1  ON 43
ci_045                -2.767648e-03 3 1  ON 44
ci_046                 5.446929e-03 3 1  ON 45
ci_047                 5.458038e-03 3 1  ON 46
ci_048                -1.255919e-02 3 1  ON 47
ci_049                -1.274236e-02 3 1  ON 48
ci_050                 3.550542e-03 3 1  ON 49
ci_051                 3.502337e-03 3 1  ON 50
ci_052                -2.793446e-03 3 1  ON 51
ci_053                -2.832328e-03 3 1  ON 52
ci_054                -2.967902e-03 3 1  ON 53
ci_055                -3.231902e-03 3 1  ON 54
ci_056                 5.146535e-03 3 1  ON 55
ci_057                 5.323742e-03 3 1  ON 56
ci_058                -2.543029e-03 3 1  ON 57
ci_059                -2.501048e-03 3 1  ON 58
ci_060                 5.250602e-03 3 1  ON 59
ci_061                 5.946124e-03 3 1  ON 60
ci_062                -3.649060e-03 3 1  ON 61
ci_063                -3.710491e-03 3 1  ON 62
ci_064                -2.771105e-03 3 1  ON 63
ci_065                -3.795352e-03 3 1  ON 64
ci_066                 4.287836e-03 3 1  ON 65
ci_067                 4.386400e-03 3 1  ON 66
ci_068                -5.160531e-03 3 1  ON 67
ci_069                -4.487900e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.235635
====================================================
  Execution time = 1.4117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0232e-01
  Total weights = 1.957678812e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288912161244
                                         uncertainty =       0.001784723866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288912161244
                                         uncertainty =       0.001784723866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380117741
  error estimate for blocks of size 2^( 2) =       0.000390865560
  error estimate for blocks of size 2^( 3) =       0.000400956527
  error estimate for blocks of size 2^( 4) =       0.000408412287
  error estimate for blocks of size 2^( 5) =       0.000412953184
  error estimate for blocks of size 2^( 6) =       0.000414638682
  error estimate for blocks of size 2^( 7) =       0.000415382917

      target function =      -0.898710705450
              le_mean =     -17.215703036326
             les_mean =     296.682750441087
             stat err =       0.000412846768
             autocorr =       1.179618287795
   target nu stat err =       0.000412846768
   target dn stat err =       0.002595944904
      target stat err =       0.003320784971
              std dev =       0.537567665191
             le_variance =       0.288978994659


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570303633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898722240893       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898728149982       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898729194754       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898729507085       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898729561180       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898729576095       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898729575859       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898729576449       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898729577077       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898729577101       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+01 is 1.619079e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898722240893       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898723723566       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898723985480       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898724063688       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898724077227       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898724080959       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898724080899       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898724081046       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898724081203       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898724081209       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+01 is 4.058778e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898722240893       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898722611900       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898722677424       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898722696983       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898722700369       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898722701302       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898722701288       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898722701324       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898722701364       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898722701365       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 1.015389e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6616e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.053059e-02 3 1  ON 0
ci_002                -3.053201e-02 3 1  ON 1
ci_003                -2.507833e-02 3 1  ON 2
ci_004                 2.252803e-02 3 1  ON 3
ci_005                 2.297729e-02 3 1  ON 4
ci_006                -1.977770e-02 3 1  ON 5
ci_007                -1.974311e-02 3 1  ON 6
ci_008                -9.204693e-03 3 1  ON 7
ci_009                -1.488013e-02 3 1  ON 8
ci_010                -1.018620e-02 3 1  ON 9
ci_011                -1.047364e-02 3 1  ON 10
ci_012                -1.051928e-02 3 1  ON 11
ci_013                -2.011791e-02 3 1  ON 12
ci_014                 1.204877e-02 3 1  ON 13
ci_015                 1.232989e-02 3 1  ON 14
ci_016                 1.650036e-02 3 1  ON 15
ci_017                 1.634783e-02 3 1  ON 16
ci_018                 9.881405e-03 3 1  ON 17
ci_019                 1.027546e-02 3 1  ON 18
ci_020                 1.580263e-02 3 1  ON 19
ci_021                 1.593339e-02 3 1  ON 20
ci_022                 9.117779e-03 3 1  ON 21
ci_023                 9.117676e-03 3 1  ON 22
ci_024                 9.637082e-03 3 1  ON 23
ci_025                 9.601061e-03 3 1  ON 24
ci_026                 1.071623e-02 3 1  ON 25
ci_027                 1.104113e-02 3 1  ON 26
ci_028                -1.507565e-02 3 1  ON 27
ci_029                -1.568792e-02 3 1  ON 28
ci_030                -8.961030e-03 3 1  ON 29
ci_031                -9.347879e-03 3 1  ON 30
ci_032                -1.472961e-02 3 1  ON 31
ci_033                 6.276013e-03 3 1  ON 32
ci_034                 5.755084e-03 3 1  ON 33
ci_035                -4.287916e-03 3 1  ON 34
ci_036                -1.206770e-02 3 1  ON 35
ci_037                -1.230977e-02 3 1  ON 36
ci_038                 1.859963e-03 3 1  ON 37
ci_039                 2.123834e-03 3 1  ON 38
ci_040                -2.547104e-03 3 1  ON 39
ci_041                 8.533852e-03 3 1  ON 40
ci_042                 8.531251e-03 3 1  ON 41
ci_043                -3.222879e-03 3 1  ON 42
ci_044                -4.931089e-03 3 1  ON 43
ci_045                -2.766799e-03 3 1  ON 44
ci_046                 5.445907e-03 3 1  ON 45
ci_047                 5.457056e-03 3 1  ON 46
ci_048                -1.255822e-02 3 1  ON 47
ci_049                -1.274250e-02 3 1  ON 48
ci_050                 3.549963e-03 3 1  ON 49
ci_051                 3.502284e-03 3 1  ON 50
ci_052                -2.792666e-03 3 1  ON 51
ci_053                -2.830671e-03 3 1  ON 52
ci_054                -2.966871e-03 3 1  ON 53
ci_055                -3.231534e-03 3 1  ON 54
ci_056                 5.145558e-03 3 1  ON 55
ci_057                 5.323150e-03 3 1  ON 56
ci_058                -2.543500e-03 3 1  ON 57
ci_059                -2.500016e-03 3 1  ON 58
ci_060                 5.249243e-03 3 1  ON 59
ci_061                 5.944221e-03 3 1  ON 60
ci_062                -3.648196e-03 3 1  ON 61
ci_063                -3.709384e-03 3 1  ON 62
ci_064                -2.769831e-03 3 1  ON 63
ci_065                -3.794355e-03 3 1  ON 64
ci_066                 4.287274e-03 3 1  ON 65
ci_067                 4.384764e-03 3 1  ON 66
ci_068                -5.160410e-03 3 1  ON 67
ci_069                -4.488678e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1899
    reference variance = 0.133075
====================================================
  Execution time = 1.3808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0010e-01
  Total weights = 1.9575e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285006512986
                                         uncertainty =       0.001712571739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285006512986
                                         uncertainty =       0.001712571739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377479939
  error estimate for blocks of size 2^( 2) =       0.000388328263
  error estimate for blocks of size 2^( 3) =       0.000398059432
  error estimate for blocks of size 2^( 4) =       0.000405510156
  error estimate for blocks of size 2^( 5) =       0.000409371822
  error estimate for blocks of size 2^( 6) =       0.000412967231
  error estimate for blocks of size 2^( 7) =       0.000414406222

      target function =      -0.901273870025
              le_mean =     -17.214635685627
             les_mean =     296.643775376053
             stat err =       0.000410563858
             autocorr =       1.182969857030
   target nu stat err =       0.000410563858
   target dn stat err =       0.003837098637
      target stat err =       0.004887086196
              std dev =       0.533837249162
             le_variance =       0.284982208593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284998449230
                                         uncertainty =       0.001712576298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284998449230
                                         uncertainty =       0.001712576298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377474595
  error estimate for blocks of size 2^( 2) =       0.000388324358
  error estimate for blocks of size 2^( 3) =       0.000398057155
  error estimate for blocks of size 2^( 4) =       0.000405509407
  error estimate for blocks of size 2^( 5) =       0.000409371630
  error estimate for blocks of size 2^( 6) =       0.000412966642
  error estimate for blocks of size 2^( 7) =       0.000414405875

      target function =      -0.901254306931
              le_mean =     -17.214635719109
             les_mean =     296.643791938652
             stat err =       0.000410563388
             autocorr =       1.183000649763
   target nu stat err =       0.000410563388
   target dn stat err =       0.003843162286
      target stat err =       0.004894491458
              std dev =       0.533829691166
             le_variance =       0.284974139171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285002458289
                                         uncertainty =       0.001712573749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285002458289
                                         uncertainty =       0.001712573749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377477252
  error estimate for blocks of size 2^( 2) =       0.000388326297
  error estimate for blocks of size 2^( 3) =       0.000398058283
  error estimate for blocks of size 2^( 4) =       0.000405509773
  error estimate for blocks of size 2^( 5) =       0.000409371718
  error estimate for blocks of size 2^( 6) =       0.000412966927
  error estimate for blocks of size 2^( 7) =       0.000414406040

      target function =      -0.901264720913
              le_mean =     -17.214635701319
             les_mean =     296.643783120950
             stat err =       0.000410563615
             autocorr =       1.182985299674
   target nu stat err =       0.000410563615
   target dn stat err =       0.003840126772
      target stat err =       0.004890791062
              std dev =       0.533833448804
             le_variance =       0.284978151062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285006004717
                                         uncertainty =       0.001712571961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285006004717
                                         uncertainty =       0.001712571961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377479602
  error estimate for blocks of size 2^( 2) =       0.000388328017
  error estimate for blocks of size 2^( 3) =       0.000398059288
  error estimate for blocks of size 2^( 4) =       0.000405510108
  error estimate for blocks of size 2^( 5) =       0.000409371808
  error estimate for blocks of size 2^( 6) =       0.000412967192
  error estimate for blocks of size 2^( 7) =       0.000414406198

      target function =      -0.901272790906
              le_mean =     -17.214635687469
             les_mean =     296.643776289013
             stat err =       0.000410563827
             autocorr =       1.182971788517
   target nu stat err =       0.000410563827
   target dn stat err =       0.003837475920
      target stat err =       0.004887548455
              std dev =       0.533836772777
             le_variance =       0.284981699969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901273870025        initial  <--
     1.5625e+01     1.5625e+02             1.6191e-05        -0.901254306931
     6.2500e+01     6.2500e+02             4.0588e-06        -0.901264720913
     2.5000e+02     2.5000e+03             1.0154e-06        -0.901272790906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0608
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.053465e-02 3 1  ON 0
ci_002                -3.053442e-02 3 1  ON 1
ci_003                -2.508075e-02 3 1  ON 2
ci_004                 2.252992e-02 3 1  ON 3
ci_005                 2.297942e-02 3 1  ON 4
ci_006                -1.977925e-02 3 1  ON 5
ci_007                -1.974476e-02 3 1  ON 6
ci_008                -9.206786e-03 3 1  ON 7
ci_009                -1.488124e-02 3 1  ON 8
ci_010                -1.018524e-02 3 1  ON 9
ci_011                -1.047498e-02 3 1  ON 10
ci_012                -1.052086e-02 3 1  ON 11
ci_013                -2.011873e-02 3 1  ON 12
ci_014                 1.204958e-02 3 1  ON 13
ci_015                 1.233135e-02 3 1  ON 14
ci_016                 1.650061e-02 3 1  ON 15
ci_017                 1.634969e-02 3 1  ON 16
ci_018                 9.881227e-03 3 1  ON 17
ci_019                 1.027673e-02 3 1  ON 18
ci_020                 1.580258e-02 3 1  ON 19
ci_021                 1.593516e-02 3 1  ON 20
ci_022                 9.118821e-03 3 1  ON 21
ci_023                 9.119528e-03 3 1  ON 22
ci_024                 9.637852e-03 3 1  ON 23
ci_025                 9.601630e-03 3 1  ON 24
ci_026                 1.071730e-02 3 1  ON 25
ci_027                 1.104164e-02 3 1  ON 26
ci_028                -1.507687e-02 3 1  ON 27
ci_029                -1.568935e-02 3 1  ON 28
ci_030                -8.962086e-03 3 1  ON 29
ci_031                -9.348716e-03 3 1  ON 30
ci_032                -1.472986e-02 3 1  ON 31
ci_033                 6.278221e-03 3 1  ON 32
ci_034                 5.757470e-03 3 1  ON 33
ci_035                -4.288723e-03 3 1  ON 34
ci_036                -1.206636e-02 3 1  ON 35
ci_037                -1.231165e-02 3 1  ON 36
ci_038                 1.861543e-03 3 1  ON 37
ci_039                 2.125347e-03 3 1  ON 38
ci_040                -2.548839e-03 3 1  ON 39
ci_041                 8.533600e-03 3 1  ON 40
ci_042                 8.532058e-03 3 1  ON 41
ci_043                -3.224231e-03 3 1  ON 42
ci_044                -4.930925e-03 3 1  ON 43
ci_045                -2.767648e-03 3 1  ON 44
ci_046                 5.446929e-03 3 1  ON 45
ci_047                 5.458038e-03 3 1  ON 46
ci_048                -1.255919e-02 3 1  ON 47
ci_049                -1.274236e-02 3 1  ON 48
ci_050                 3.550542e-03 3 1  ON 49
ci_051                 3.502337e-03 3 1  ON 50
ci_052                -2.793446e-03 3 1  ON 51
ci_053                -2.832328e-03 3 1  ON 52
ci_054                -2.967902e-03 3 1  ON 53
ci_055                -3.231902e-03 3 1  ON 54
ci_056                 5.146535e-03 3 1  ON 55
ci_057                 5.323742e-03 3 1  ON 56
ci_058                -2.543029e-03 3 1  ON 57
ci_059                -2.501048e-03 3 1  ON 58
ci_060                 5.250602e-03 3 1  ON 59
ci_061                 5.946124e-03 3 1  ON 60
ci_062                -3.649060e-03 3 1  ON 61
ci_063                -3.710491e-03 3 1  ON 62
ci_064                -2.771105e-03 3 1  ON 63
ci_065                -3.795352e-03 3 1  ON 64
ci_066                 4.287836e-03 3 1  ON 65
ci_067                 4.386400e-03 3 1  ON 66
ci_068                -5.160531e-03 3 1  ON 67
ci_069                -4.487900e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2332
    reference variance = 0.152125
====================================================
  Execution time = 1.3608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9879e-01
  Total weights = 1.957345977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286837405478
                                         uncertainty =       0.001722406473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286837405478
                                         uncertainty =       0.001722406473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378670213
  error estimate for blocks of size 2^( 2) =       0.000389649661
  error estimate for blocks of size 2^( 3) =       0.000399511080
  error estimate for blocks of size 2^( 4) =       0.000406455334
  error estimate for blocks of size 2^( 5) =       0.000410539781
  error estimate for blocks of size 2^( 6) =       0.000413773246
  error estimate for blocks of size 2^( 7) =       0.000415275207

      target function =      -0.903030441991
              le_mean =     -17.215045153060
             les_mean =     296.656571614996
             stat err =       0.000411510892
             autocorr =       1.180974123869
   target nu stat err =       0.000411510892
   target dn stat err =       0.002413377865
      target stat err =       0.003120335380
              std dev =       0.535520550716
             le_variance =       0.286782260239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721504515306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903040655364       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903041148444       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903041243860       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903041276924       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903041280678       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903041280766       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903041280760       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903041280938       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903041280941       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903041280982       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.233612e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903040655364       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903040778680       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903040802540       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903040810808       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903040811746       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903040811769       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903040811768       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903040811812       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903040811812       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903040811822       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.084935e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903040655364       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903040686196       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903040692161       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903040694228       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903040694463       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903040694469       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903040694468       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903040694477       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903040694477       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903040694476       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 7.712904e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6101e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.053437e-02 3 1  ON 0
ci_002                -3.053428e-02 3 1  ON 1
ci_003                -2.508059e-02 3 1  ON 2
ci_004                 2.252970e-02 3 1  ON 3
ci_005                 2.297911e-02 3 1  ON 4
ci_006                -1.977915e-02 3 1  ON 5
ci_007                -1.974462e-02 3 1  ON 6
ci_008                -9.206563e-03 3 1  ON 7
ci_009                -1.488111e-02 3 1  ON 8
ci_010                -1.018510e-02 3 1  ON 9
ci_011                -1.047491e-02 3 1  ON 10
ci_012                -1.052080e-02 3 1  ON 11
ci_013                -2.011867e-02 3 1  ON 12
ci_014                 1.204942e-02 3 1  ON 13
ci_015                 1.233115e-02 3 1  ON 14
ci_016                 1.650052e-02 3 1  ON 15
ci_017                 1.634959e-02 3 1  ON 16
ci_018                 9.881049e-03 3 1  ON 17
ci_019                 1.027659e-02 3 1  ON 18
ci_020                 1.580245e-02 3 1  ON 19
ci_021                 1.593507e-02 3 1  ON 20
ci_022                 9.118776e-03 3 1  ON 21
ci_023                 9.119363e-03 3 1  ON 22
ci_024                 9.637624e-03 3 1  ON 23
ci_025                 9.601432e-03 3 1  ON 24
ci_026                 1.071717e-02 3 1  ON 25
ci_027                 1.104158e-02 3 1  ON 26
ci_028                -1.507682e-02 3 1  ON 27
ci_029                -1.568929e-02 3 1  ON 28
ci_030                -8.962127e-03 3 1  ON 29
ci_031                -9.348560e-03 3 1  ON 30
ci_032                -1.472982e-02 3 1  ON 31
ci_033                 6.278072e-03 3 1  ON 32
ci_034                 5.757471e-03 3 1  ON 33
ci_035                -4.288561e-03 3 1  ON 34
ci_036                -1.206630e-02 3 1  ON 35
ci_037                -1.231164e-02 3 1  ON 36
ci_038                 1.861456e-03 3 1  ON 37
ci_039                 2.125206e-03 3 1  ON 38
ci_040                -2.548742e-03 3 1  ON 39
ci_041                 8.533596e-03 3 1  ON 40
ci_042                 8.531993e-03 3 1  ON 41
ci_043                -3.224121e-03 3 1  ON 42
ci_044                -4.930819e-03 3 1  ON 43
ci_045                -2.767565e-03 3 1  ON 44
ci_046                 5.446823e-03 3 1  ON 45
ci_047                 5.457971e-03 3 1  ON 46
ci_048                -1.255906e-02 3 1  ON 47
ci_049                -1.274227e-02 3 1  ON 48
ci_050                 3.550475e-03 3 1  ON 49
ci_051                 3.502418e-03 3 1  ON 50
ci_052                -2.793349e-03 3 1  ON 51
ci_053                -2.832310e-03 3 1  ON 52
ci_054                -2.967808e-03 3 1  ON 53
ci_055                -3.231780e-03 3 1  ON 54
ci_056                 5.146420e-03 3 1  ON 55
ci_057                 5.323659e-03 3 1  ON 56
ci_058                -2.542847e-03 3 1  ON 57
ci_059                -2.500936e-03 3 1  ON 58
ci_060                 5.250649e-03 3 1  ON 59
ci_061                 5.945992e-03 3 1  ON 60
ci_062                -3.649056e-03 3 1  ON 61
ci_063                -3.710484e-03 3 1  ON 62
ci_064                -2.770984e-03 3 1  ON 63
ci_065                -3.795234e-03 3 1  ON 64
ci_066                 4.287854e-03 3 1  ON 65
ci_067                 4.386356e-03 3 1  ON 66
ci_068                -5.160453e-03 3 1  ON 67
ci_069                -4.487930e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1773
    reference variance = 0.246177
====================================================
  Execution time = 1.3733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9853e-01
  Total weights = 1.9576e+06
  Execution time = 1.8244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416214502
                                         uncertainty =       0.001524867259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416214502
                                         uncertainty =       0.001524867259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377728986
  error estimate for blocks of size 2^( 2) =       0.000388483455
  error estimate for blocks of size 2^( 3) =       0.000398586856
  error estimate for blocks of size 2^( 4) =       0.000406330951
  error estimate for blocks of size 2^( 5) =       0.000410348259
  error estimate for blocks of size 2^( 6) =       0.000412318235
  error estimate for blocks of size 2^( 7) =       0.000415246626

      target function =      -0.903366611018
              le_mean =     -17.215063857998
             les_mean =     296.656953848601
             stat err =       0.000411061018
             autocorr =       1.184273360686
   target nu stat err =       0.000411061018
   target dn stat err =       0.002520675501
      target stat err =       0.003256756539
              std dev =       0.534189455100
             le_variance =       0.285358373940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285415246743
                                         uncertainty =       0.001524841033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285415246743
                                         uncertainty =       0.001524841033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377728345
  error estimate for blocks of size 2^( 2) =       0.000388482973
  error estimate for blocks of size 2^( 3) =       0.000398586533
  error estimate for blocks of size 2^( 4) =       0.000406330754
  error estimate for blocks of size 2^( 5) =       0.000410348147
  error estimate for blocks of size 2^( 6) =       0.000412318134
  error estimate for blocks of size 2^( 7) =       0.000415246587

      target function =      -0.903367424417
              le_mean =     -17.215063867541
             les_mean =     296.656953538819
             stat err =       0.000411060906
             autocorr =       1.184276732955
   target nu stat err =       0.000411060906
   target dn stat err =       0.002520719419
      target stat err =       0.003256817286
              std dev =       0.534188548766
             le_variance =       0.285357405632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285415730388
                                         uncertainty =       0.001524854140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285415730388
                                         uncertainty =       0.001524854140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377728666
  error estimate for blocks of size 2^( 2) =       0.000388483214
  error estimate for blocks of size 2^( 3) =       0.000398586695
  error estimate for blocks of size 2^( 4) =       0.000406330852
  error estimate for blocks of size 2^( 5) =       0.000410348204
  error estimate for blocks of size 2^( 6) =       0.000412318185
  error estimate for blocks of size 2^( 7) =       0.000415246606

      target function =      -0.903342557587
              le_mean =     -17.215063862827
             les_mean =     296.656972933859
             stat err =       0.000411060962
             autocorr =       1.184275048172
   target nu stat err =       0.000411060962
   target dn stat err =       0.002520805268
      target stat err =       0.003256748220
              std dev =       0.534189001714
             le_variance =       0.285357889552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416153975
                                         uncertainty =       0.001524865618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285416153975
                                         uncertainty =       0.001524865618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377728946
  error estimate for blocks of size 2^( 2) =       0.000388483425
  error estimate for blocks of size 2^( 3) =       0.000398586836
  error estimate for blocks of size 2^( 4) =       0.000406330939
  error estimate for blocks of size 2^( 5) =       0.000410348252
  error estimate for blocks of size 2^( 6) =       0.000412318228
  error estimate for blocks of size 2^( 7) =       0.000415246623

      target function =      -0.903366619236
              le_mean =     -17.215063858594
             les_mean =     296.656953862728
             stat err =       0.000411061011
             autocorr =       1.184273571546
   target nu stat err =       0.000411061011
   target dn stat err =       0.002520678293
      target stat err =       0.003256760094
              std dev =       0.534189398415
             le_variance =       0.285358313379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903366611018        initial
     1.5625e+02     1.5625e+03             1.2336e-06        -0.903367424417  <--
     6.2500e+02     6.2500e+03             3.0849e-07        -0.903342557587
     2.5000e+03     2.5000e+04             7.7129e-08        -0.903366619236

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 2.2970e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.053352e-02 3 1  ON 0
ci_002                -3.053383e-02 3 1  ON 1
ci_003                -2.508009e-02 3 1  ON 2
ci_004                 2.252905e-02 3 1  ON 3
ci_005                 2.297819e-02 3 1  ON 4
ci_006                -1.977886e-02 3 1  ON 5
ci_007                -1.974420e-02 3 1  ON 6
ci_008                -9.205895e-03 3 1  ON 7
ci_009                -1.488070e-02 3 1  ON 8
ci_010                -1.018469e-02 3 1  ON 9
ci_011                -1.047471e-02 3 1  ON 10
ci_012                -1.052063e-02 3 1  ON 11
ci_013                -2.011847e-02 3 1  ON 12
ci_014                 1.204894e-02 3 1  ON 13
ci_015                 1.233053e-02 3 1  ON 14
ci_016                 1.650024e-02 3 1  ON 15
ci_017                 1.634930e-02 3 1  ON 16
ci_018                 9.880514e-03 3 1  ON 17
ci_019                 1.027618e-02 3 1  ON 18
ci_020                 1.580204e-02 3 1  ON 19
ci_021                 1.593479e-02 3 1  ON 20
ci_022                 9.118639e-03 3 1  ON 21
ci_023                 9.118868e-03 3 1  ON 22
ci_024                 9.636941e-03 3 1  ON 23
ci_025                 9.600836e-03 3 1  ON 24
ci_026                 1.071676e-02 3 1  ON 25
ci_027                 1.104138e-02 3 1  ON 26
ci_028                -1.507664e-02 3 1  ON 27
ci_029                -1.568912e-02 3 1  ON 28
ci_030                -8.962251e-03 3 1  ON 29
ci_031                -9.348094e-03 3 1  ON 30
ci_032                -1.472972e-02 3 1  ON 31
ci_033                 6.277628e-03 3 1  ON 32
ci_034                 5.757473e-03 3 1  ON 33
ci_035                -4.288078e-03 3 1  ON 34
ci_036                -1.206609e-02 3 1  ON 35
ci_037                -1.231162e-02 3 1  ON 36
ci_038                 1.861193e-03 3 1  ON 37
ci_039                 2.124783e-03 3 1  ON 38
ci_040                -2.548452e-03 3 1  ON 39
ci_041                 8.533583e-03 3 1  ON 40
ci_042                 8.531797e-03 3 1  ON 41
ci_043                -3.223790e-03 3 1  ON 42
ci_044                -4.930502e-03 3 1  ON 43
ci_045                -2.767316e-03 3 1  ON 44
ci_046                 5.446507e-03 3 1  ON 45
ci_047                 5.457772e-03 3 1  ON 46
ci_048                -1.255867e-02 3 1  ON 47
ci_049                -1.274198e-02 3 1  ON 48
ci_050                 3.550273e-03 3 1  ON 49
ci_051                 3.502659e-03 3 1  ON 50
ci_052                -2.793059e-03 3 1  ON 51
ci_053                -2.832256e-03 3 1  ON 52
ci_054                -2.967525e-03 3 1  ON 53
ci_055                -3.231414e-03 3 1  ON 54
ci_056                 5.146075e-03 3 1  ON 55
ci_057                 5.323409e-03 3 1  ON 56
ci_058                -2.542303e-03 3 1  ON 57
ci_059                -2.500599e-03 3 1  ON 58
ci_060                 5.250789e-03 3 1  ON 59
ci_061                 5.945593e-03 3 1  ON 60
ci_062                -3.649045e-03 3 1  ON 61
ci_063                -3.710463e-03 3 1  ON 62
ci_064                -2.770623e-03 3 1  ON 63
ci_065                -3.794879e-03 3 1  ON 64
ci_066                 4.287911e-03 3 1  ON 65
ci_067                 4.386222e-03 3 1  ON 66
ci_068                -5.160219e-03 3 1  ON 67
ci_069                -4.488020e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.170667
====================================================
  Execution time = 1.3758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0032e-01
  Total weights = 1.957420870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286679913547
                                         uncertainty =       0.001569209691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286679913547
                                         uncertainty =       0.001569209691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378613332
  error estimate for blocks of size 2^( 2) =       0.000389519045
  error estimate for blocks of size 2^( 3) =       0.000399244893
  error estimate for blocks of size 2^( 4) =       0.000407206137
  error estimate for blocks of size 2^( 5) =       0.000411501998
  error estimate for blocks of size 2^( 6) =       0.000414465606
  error estimate for blocks of size 2^( 7) =       0.000416902133

      target function =      -0.901248861944
              le_mean =     -17.215732396772
             les_mean =     296.681757933814
             stat err =       0.000412518968
             autocorr =       1.187123877327
   target nu stat err =       0.000412518968
   target dn stat err =       0.002466769745
      target stat err =       0.003178322530
              std dev =       0.535440109398
             le_variance =       0.286696110752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573239677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901259427124       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901261061799       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901261390836       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901261505562       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901261516917       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901261520323       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901261520313       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901261519792       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901261519565       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901261519496       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 4.114578e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901259427124       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901259836387       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901259918734       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901259947435       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901259950274       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901259951125       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901259951123       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901259950992       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901259950936       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901259950919       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.029757e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901259427124       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901259529477       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901259550069       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901259557246       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901259557956       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901259558169       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901259558168       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901259558136       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901259558121       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901259558116       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 2.575089e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6264e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.053259e-02 3 1  ON 0
ci_002                -3.053287e-02 3 1  ON 1
ci_003                -2.507923e-02 3 1  ON 2
ci_004                 2.252830e-02 3 1  ON 3
ci_005                 2.297716e-02 3 1  ON 4
ci_006                -1.977839e-02 3 1  ON 5
ci_007                -1.974356e-02 3 1  ON 6
ci_008                -9.205412e-03 3 1  ON 7
ci_009                -1.488028e-02 3 1  ON 8
ci_010                -1.018407e-02 3 1  ON 9
ci_011                -1.047446e-02 3 1  ON 10
ci_012                -1.052005e-02 3 1  ON 11
ci_013                -2.011866e-02 3 1  ON 12
ci_014                 1.204846e-02 3 1  ON 13
ci_015                 1.232983e-02 3 1  ON 14
ci_016                 1.650012e-02 3 1  ON 15
ci_017                 1.634876e-02 3 1  ON 16
ci_018                 9.880380e-03 3 1  ON 17
ci_019                 1.027529e-02 3 1  ON 18
ci_020                 1.580199e-02 3 1  ON 19
ci_021                 1.593446e-02 3 1  ON 20
ci_022                 9.118577e-03 3 1  ON 21
ci_023                 9.118706e-03 3 1  ON 22
ci_024                 9.636242e-03 3 1  ON 23
ci_025                 9.600677e-03 3 1  ON 24
ci_026                 1.071644e-02 3 1  ON 25
ci_027                 1.104073e-02 3 1  ON 26
ci_028                -1.507639e-02 3 1  ON 27
ci_029                -1.568859e-02 3 1  ON 28
ci_030                -8.962301e-03 3 1  ON 29
ci_031                -9.347613e-03 3 1  ON 30
ci_032                -1.472959e-02 3 1  ON 31
ci_033                 6.277046e-03 3 1  ON 32
ci_034                 5.756634e-03 3 1  ON 33
ci_035                -4.287476e-03 3 1  ON 34
ci_036                -1.206603e-02 3 1  ON 35
ci_037                -1.231128e-02 3 1  ON 36
ci_038                 1.860728e-03 3 1  ON 37
ci_039                 2.124364e-03 3 1  ON 38
ci_040                -2.548196e-03 3 1  ON 39
ci_041                 8.533139e-03 3 1  ON 40
ci_042                 8.531661e-03 3 1  ON 41
ci_043                -3.223447e-03 3 1  ON 42
ci_044                -4.930429e-03 3 1  ON 43
ci_045                -2.766748e-03 3 1  ON 44
ci_046                 5.446041e-03 3 1  ON 45
ci_047                 5.457417e-03 3 1  ON 46
ci_048                -1.255905e-02 3 1  ON 47
ci_049                -1.274213e-02 3 1  ON 48
ci_050                 3.550263e-03 3 1  ON 49
ci_051                 3.502224e-03 3 1  ON 50
ci_052                -2.793056e-03 3 1  ON 51
ci_053                -2.832301e-03 3 1  ON 52
ci_054                -2.967158e-03 3 1  ON 53
ci_055                -3.231015e-03 3 1  ON 54
ci_056                 5.145795e-03 3 1  ON 55
ci_057                 5.323510e-03 3 1  ON 56
ci_058                -2.541760e-03 3 1  ON 57
ci_059                -2.500531e-03 3 1  ON 58
ci_060                 5.250577e-03 3 1  ON 59
ci_061                 5.944793e-03 3 1  ON 60
ci_062                -3.648745e-03 3 1  ON 61
ci_063                -3.710048e-03 3 1  ON 62
ci_064                -2.770195e-03 3 1  ON 63
ci_065                -3.794773e-03 3 1  ON 64
ci_066                 4.287589e-03 3 1  ON 65
ci_067                 4.386198e-03 3 1  ON 66
ci_068                -5.160113e-03 3 1  ON 67
ci_069                -4.488237e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.211814
====================================================
  Execution time = 1.3818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0221e-01
  Total weights = 1.9570e+06
  Execution time = 1.8237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285607285558
                                         uncertainty =       0.001739613700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285607285558
                                         uncertainty =       0.001739613700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377937015
  error estimate for blocks of size 2^( 2) =       0.000388829920
  error estimate for blocks of size 2^( 3) =       0.000398775997
  error estimate for blocks of size 2^( 4) =       0.000405728051
  error estimate for blocks of size 2^( 5) =       0.000409872582
  error estimate for blocks of size 2^( 6) =       0.000413152766
  error estimate for blocks of size 2^( 7) =       0.000414385093

      target function =      -0.898620574222
              le_mean =     -17.214715657929
             les_mean =     296.648647249185
             stat err =       0.000410784623
             autocorr =       1.181379686396
   target nu stat err =       0.000410784623
   target dn stat err =       0.003777390093
      target stat err =       0.004784643740
              std dev =       0.534483652096
             le_variance =       0.285672774357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285603135694
                                         uncertainty =       0.001739377837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285603135694
                                         uncertainty =       0.001739377837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377934260
  error estimate for blocks of size 2^( 2) =       0.000388827706
  error estimate for blocks of size 2^( 3) =       0.000398774401
  error estimate for blocks of size 2^( 4) =       0.000405726952
  error estimate for blocks of size 2^( 5) =       0.000409871693
  error estimate for blocks of size 2^( 6) =       0.000413151899
  error estimate for blocks of size 2^( 7) =       0.000414384517

      target function =      -0.898625154828
              le_mean =     -17.214715668952
             les_mean =     296.648643999280
             stat err =       0.000410783765
             autocorr =       1.181391978723
   target nu stat err =       0.000410783765
   target dn stat err =       0.003776290111
      target stat err =       0.004783318832
              std dev =       0.534479755594
             le_variance =       0.285668609140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285605206810
                                         uncertainty =       0.001739495575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285605206810
                                         uncertainty =       0.001739495575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377935635
  error estimate for blocks of size 2^( 2) =       0.000388828811
  error estimate for blocks of size 2^( 3) =       0.000398775198
  error estimate for blocks of size 2^( 4) =       0.000405727500
  error estimate for blocks of size 2^( 5) =       0.000409872136
  error estimate for blocks of size 2^( 6) =       0.000413152331
  error estimate for blocks of size 2^( 7) =       0.000414384804

      target function =      -0.898623108424
              le_mean =     -17.214715663297
             les_mean =     296.648645425340
             stat err =       0.000410784193
             autocorr =       1.181385840496
   target nu stat err =       0.000410784193
   target dn stat err =       0.003776835223
      target stat err =       0.004783977774
              std dev =       0.534481700269
             le_variance =       0.285670687922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285607025515
                                         uncertainty =       0.001739598926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285607025515
                                         uncertainty =       0.001739598926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377936842
  error estimate for blocks of size 2^( 2) =       0.000388829781
  error estimate for blocks of size 2^( 3) =       0.000398775897
  error estimate for blocks of size 2^( 4) =       0.000405727982
  error estimate for blocks of size 2^( 5) =       0.000409872526
  error estimate for blocks of size 2^( 6) =       0.000413152711
  error estimate for blocks of size 2^( 7) =       0.000414385057

      target function =      -0.898620917985
              le_mean =     -17.214715658584
             les_mean =     296.648646999177
             stat err =       0.000410784569
             autocorr =       1.181380455889
   target nu stat err =       0.000410784569
   target dn stat err =       0.003777320299
      target stat err =       0.004784560237
              std dev =       0.534483407931
             le_variance =       0.285672513354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898620574222        initial
     3.9062e+01     3.9062e+02             4.1146e-06        -0.898625154828  <--
     1.5625e+02     1.5625e+03             1.0298e-06        -0.898623108424
     6.2500e+02     6.2500e+03             2.5751e-07        -0.898620917985

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3035e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.052980e-02 3 1  ON 0
ci_002                -3.053001e-02 3 1  ON 1
ci_003                -2.507666e-02 3 1  ON 2
ci_004                 2.252603e-02 3 1  ON 3
ci_005                 2.297407e-02 3 1  ON 4
ci_006                -1.977697e-02 3 1  ON 5
ci_007                -1.974163e-02 3 1  ON 6
ci_008                -9.203966e-03 3 1  ON 7
ci_009                -1.487905e-02 3 1  ON 8
ci_010                -1.018224e-02 3 1  ON 9
ci_011                -1.047372e-02 3 1  ON 10
ci_012                -1.051834e-02 3 1  ON 11
ci_013                -2.011921e-02 3 1  ON 12
ci_014                 1.204702e-02 3 1  ON 13
ci_015                 1.232774e-02 3 1  ON 14
ci_016                 1.649976e-02 3 1  ON 15
ci_017                 1.634716e-02 3 1  ON 16
ci_018                 9.879977e-03 3 1  ON 17
ci_019                 1.027263e-02 3 1  ON 18
ci_020                 1.580182e-02 3 1  ON 19
ci_021                 1.593347e-02 3 1  ON 20
ci_022                 9.118391e-03 3 1  ON 21
ci_023                 9.118223e-03 3 1  ON 22
ci_024                 9.634149e-03 3 1  ON 23
ci_025                 9.600197e-03 3 1  ON 24
ci_026                 1.071545e-02 3 1  ON 25
ci_027                 1.103876e-02 3 1  ON 26
ci_028                -1.507563e-02 3 1  ON 27
ci_029                -1.568701e-02 3 1  ON 28
ci_030                -8.962449e-03 3 1  ON 29
ci_031                -9.346173e-03 3 1  ON 30
ci_032                -1.472921e-02 3 1  ON 31
ci_033                 6.275305e-03 3 1  ON 32
ci_034                 5.754120e-03 3 1  ON 33
ci_035                -4.285675e-03 3 1  ON 34
ci_036                -1.206586e-02 3 1  ON 35
ci_037                -1.231025e-02 3 1  ON 36
ci_038                 1.859335e-03 3 1  ON 37
ci_039                 2.123110e-03 3 1  ON 38
ci_040                -2.547430e-03 3 1  ON 39
ci_041                 8.531807e-03 3 1  ON 40
ci_042                 8.531253e-03 3 1  ON 41
ci_043                -3.222419e-03 3 1  ON 42
ci_044                -4.930209e-03 3 1  ON 43
ci_045                -2.765048e-03 3 1  ON 44
ci_046                 5.444646e-03 3 1  ON 45
ci_047                 5.456354e-03 3 1  ON 46
ci_048                -1.256020e-02 3 1  ON 47
ci_049                -1.274259e-02 3 1  ON 48
ci_050                 3.550233e-03 3 1  ON 49
ci_051                 3.500921e-03 3 1  ON 50
ci_052                -2.793046e-03 3 1  ON 51
ci_053                -2.832437e-03 3 1  ON 52
ci_054                -2.966060e-03 3 1  ON 53
ci_055                -3.229819e-03 3 1  ON 54
ci_056                 5.144957e-03 3 1  ON 55
ci_057                 5.323814e-03 3 1  ON 56
ci_058                -2.540137e-03 3 1  ON 57
ci_059                -2.500327e-03 3 1  ON 58
ci_060                 5.249944e-03 3 1  ON 59
ci_061                 5.942395e-03 3 1  ON 60
ci_062                -3.647848e-03 3 1  ON 61
ci_063                -3.708806e-03 3 1  ON 62
ci_064                -2.768916e-03 3 1  ON 63
ci_065                -3.794458e-03 3 1  ON 64
ci_066                 4.286624e-03 3 1  ON 65
ci_067                 4.386124e-03 3 1  ON 66
ci_068                -5.159796e-03 3 1  ON 67
ci_069                -4.488885e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.16425
====================================================
  Execution time = 1.3896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0873e-01
  Total weights = 1.957579001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289847110988
                                         uncertainty =       0.001955717270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289847110988
                                         uncertainty =       0.001955717270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380666021
  error estimate for blocks of size 2^( 2) =       0.000391676346
  error estimate for blocks of size 2^( 3) =       0.000401755199
  error estimate for blocks of size 2^( 4) =       0.000409255656
  error estimate for blocks of size 2^( 5) =       0.000413811866
  error estimate for blocks of size 2^( 6) =       0.000417789411
  error estimate for blocks of size 2^( 7) =       0.000421100127

      target function =      -0.890512201806
              le_mean =     -17.215004222496
             les_mean =     296.665102241468
             stat err =       0.000415489265
             autocorr =       1.191328114869
   target nu stat err =       0.000415489265
   target dn stat err =       0.006236219905
      target stat err =       0.007726390267
              std dev =       0.538343048972
             le_variance =       0.289813238376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721500422250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890578108082       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890619936940       residual = 7.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890623641504       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890624537535       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890624727059       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890624757412       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890624758858       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890624758291       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890624758641       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890624758504       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 3.107443e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890578108082       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890588630396       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890589560984       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890589785735       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890589833170       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890589840737       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890589841089       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890589840944       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890589841029       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890589840996       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 7.817757e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890578108082       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890580742761       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890580975687       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890581031921       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890581043784       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890581045674       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890581045761       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890581045725       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890581045746       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890581045737       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.957535e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6392e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.052507e-02 3 1  ON 0
ci_002                -3.052646e-02 3 1  ON 1
ci_003                -2.507237e-02 3 1  ON 2
ci_004                 2.252136e-02 3 1  ON 3
ci_005                 2.297161e-02 3 1  ON 4
ci_006                -1.977261e-02 3 1  ON 5
ci_007                -1.974070e-02 3 1  ON 6
ci_008                -9.201407e-03 3 1  ON 7
ci_009                -1.487723e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047071e-02 3 1  ON 10
ci_012                -1.051521e-02 3 1  ON 11
ci_013                -2.011767e-02 3 1  ON 12
ci_014                 1.204514e-02 3 1  ON 13
ci_015                 1.232689e-02 3 1  ON 14
ci_016                 1.650007e-02 3 1  ON 15
ci_017                 1.634667e-02 3 1  ON 16
ci_018                 9.880340e-03 3 1  ON 17
ci_019                 1.026930e-02 3 1  ON 18
ci_020                 1.580102e-02 3 1  ON 19
ci_021                 1.592864e-02 3 1  ON 20
ci_022                 9.116424e-03 3 1  ON 21
ci_023                 9.116471e-03 3 1  ON 22
ci_024                 9.630298e-03 3 1  ON 23
ci_025                 9.595631e-03 3 1  ON 24
ci_026                 1.071654e-02 3 1  ON 25
ci_027                 1.103798e-02 3 1  ON 26
ci_028                -1.507584e-02 3 1  ON 27
ci_029                -1.569004e-02 3 1  ON 28
ci_030                -8.962383e-03 3 1  ON 29
ci_031                -9.353991e-03 3 1  ON 30
ci_032                -1.472885e-02 3 1  ON 31
ci_033                 6.274081e-03 3 1  ON 32
ci_034                 5.752368e-03 3 1  ON 33
ci_035                -4.283472e-03 3 1  ON 34
ci_036                -1.206343e-02 3 1  ON 35
ci_037                -1.231381e-02 3 1  ON 36
ci_038                 1.860692e-03 3 1  ON 37
ci_039                 2.121397e-03 3 1  ON 38
ci_040                -2.546693e-03 3 1  ON 39
ci_041                 8.528269e-03 3 1  ON 40
ci_042                 8.523452e-03 3 1  ON 41
ci_043                -3.220407e-03 3 1  ON 42
ci_044                -4.927494e-03 3 1  ON 43
ci_045                -2.763237e-03 3 1  ON 44
ci_046                 5.442322e-03 3 1  ON 45
ci_047                 5.455164e-03 3 1  ON 46
ci_048                -1.256030e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547233e-03 3 1  ON 49
ci_051                 3.500113e-03 3 1  ON 50
ci_052                -2.791495e-03 3 1  ON 51
ci_053                -2.829371e-03 3 1  ON 52
ci_054                -2.961036e-03 3 1  ON 53
ci_055                -3.227718e-03 3 1  ON 54
ci_056                 5.143246e-03 3 1  ON 55
ci_057                 5.323741e-03 3 1  ON 56
ci_058                -2.540448e-03 3 1  ON 57
ci_059                -2.495843e-03 3 1  ON 58
ci_060                 5.249218e-03 3 1  ON 59
ci_061                 5.938362e-03 3 1  ON 60
ci_062                -3.646874e-03 3 1  ON 61
ci_063                -3.707010e-03 3 1  ON 62
ci_064                -2.767268e-03 3 1  ON 63
ci_065                -3.793539e-03 3 1  ON 64
ci_066                 4.285568e-03 3 1  ON 65
ci_067                 4.385763e-03 3 1  ON 66
ci_068                -5.158232e-03 3 1  ON 67
ci_069                -4.482205e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.178073
====================================================
  Execution time = 1.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9760e-01
  Total weights = 1.9573e+06
  Execution time = 1.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284914788174
                                         uncertainty =       0.001734224126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284914788174
                                         uncertainty =       0.001734224126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377404970
  error estimate for blocks of size 2^( 2) =       0.000388558680
  error estimate for blocks of size 2^( 3) =       0.000398288451
  error estimate for blocks of size 2^( 4) =       0.000406075558
  error estimate for blocks of size 2^( 5) =       0.000410780414
  error estimate for blocks of size 2^( 6) =       0.000413119053
  error estimate for blocks of size 2^( 7) =       0.000414530024

      target function =      -0.904662585506
              le_mean =     -17.215595170114
             les_mean =     296.674322570824
             stat err =       0.000411126262
             autocorr =       1.186684334081
   target nu stat err =       0.000411126262
   target dn stat err =       0.002692328717
      target stat err =       0.003484489103
              std dev =       0.533731227317
             le_variance =       0.284869023014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284901829540
                                         uncertainty =       0.001734234768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284901829540
                                         uncertainty =       0.001734234768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377396383
  error estimate for blocks of size 2^( 2) =       0.000388553176
  error estimate for blocks of size 2^( 3) =       0.000398285781
  error estimate for blocks of size 2^( 4) =       0.000406074802
  error estimate for blocks of size 2^( 5) =       0.000410780708
  error estimate for blocks of size 2^( 6) =       0.000413119690
  error estimate for blocks of size 2^( 7) =       0.000414530641

      target function =      -0.904654740433
              le_mean =     -17.215595386303
             les_mean =     296.674336159025
             stat err =       0.000411126460
             autocorr =       1.186739479808
   target nu stat err =       0.000411126460
   target dn stat err =       0.002697802019
      target stat err =       0.003491318472
              std dev =       0.533719083306
             le_variance =       0.284856059885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284908225152
                                         uncertainty =       0.001734228543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284908225152
                                         uncertainty =       0.001734228543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377400621
  error estimate for blocks of size 2^( 2) =       0.000388555880
  error estimate for blocks of size 2^( 3) =       0.000398287075
  error estimate for blocks of size 2^( 4) =       0.000406075143
  error estimate for blocks of size 2^( 5) =       0.000410780527
  error estimate for blocks of size 2^( 6) =       0.000413119338
  error estimate for blocks of size 2^( 7) =       0.000414530301

      target function =      -0.904665714000
              le_mean =     -17.215595273336
             les_mean =     296.674323671123
             stat err =       0.000411126327
             autocorr =       1.186712059799
   target nu stat err =       0.000411126327
   target dn stat err =       0.002695053567
      target stat err =       0.003487942503
              std dev =       0.533725076917
             le_variance =       0.284862457730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284913961167
                                         uncertainty =       0.001734224573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284913961167
                                         uncertainty =       0.001734224573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377404422
  error estimate for blocks of size 2^( 2) =       0.000388558326
  error estimate for blocks of size 2^( 3) =       0.000398288275
  error estimate for blocks of size 2^( 4) =       0.000406075502
  error estimate for blocks of size 2^( 5) =       0.000410780424
  error estimate for blocks of size 2^( 6) =       0.000413119085
  error estimate for blocks of size 2^( 7) =       0.000414530055

      target function =      -0.904663130183
              le_mean =     -17.215595182393
             les_mean =     296.674322566409
             stat err =       0.000411126266
             autocorr =       1.186687805287
   target nu stat err =       0.000411126266
   target dn stat err =       0.002692667851
      target stat err =       0.003484920081
              std dev =       0.533730452312
             le_variance =       0.284868195725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904662585506        initial
     9.7656e+00     9.7656e+01             3.1074e-05        -0.904654740433
     3.9062e+01     3.9062e+02             7.8178e-06        -0.904665714000  <--
     1.5625e+02     1.5625e+03             1.9575e-06        -0.904663130183

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.2815e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.052507e-02 3 1  ON 0
ci_002                -3.052646e-02 3 1  ON 1
ci_003                -2.507237e-02 3 1  ON 2
ci_004                 2.252136e-02 3 1  ON 3
ci_005                 2.297161e-02 3 1  ON 4
ci_006                -1.977261e-02 3 1  ON 5
ci_007                -1.974070e-02 3 1  ON 6
ci_008                -9.201407e-03 3 1  ON 7
ci_009                -1.487723e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047071e-02 3 1  ON 10
ci_012                -1.051521e-02 3 1  ON 11
ci_013                -2.011767e-02 3 1  ON 12
ci_014                 1.204514e-02 3 1  ON 13
ci_015                 1.232689e-02 3 1  ON 14
ci_016                 1.650007e-02 3 1  ON 15
ci_017                 1.634667e-02 3 1  ON 16
ci_018                 9.880340e-03 3 1  ON 17
ci_019                 1.026930e-02 3 1  ON 18
ci_020                 1.580102e-02 3 1  ON 19
ci_021                 1.592864e-02 3 1  ON 20
ci_022                 9.116424e-03 3 1  ON 21
ci_023                 9.116471e-03 3 1  ON 22
ci_024                 9.630298e-03 3 1  ON 23
ci_025                 9.595631e-03 3 1  ON 24
ci_026                 1.071654e-02 3 1  ON 25
ci_027                 1.103798e-02 3 1  ON 26
ci_028                -1.507584e-02 3 1  ON 27
ci_029                -1.569004e-02 3 1  ON 28
ci_030                -8.962383e-03 3 1  ON 29
ci_031                -9.353991e-03 3 1  ON 30
ci_032                -1.472885e-02 3 1  ON 31
ci_033                 6.274081e-03 3 1  ON 32
ci_034                 5.752368e-03 3 1  ON 33
ci_035                -4.283472e-03 3 1  ON 34
ci_036                -1.206343e-02 3 1  ON 35
ci_037                -1.231381e-02 3 1  ON 36
ci_038                 1.860692e-03 3 1  ON 37
ci_039                 2.121397e-03 3 1  ON 38
ci_040                -2.546693e-03 3 1  ON 39
ci_041                 8.528269e-03 3 1  ON 40
ci_042                 8.523452e-03 3 1  ON 41
ci_043                -3.220407e-03 3 1  ON 42
ci_044                -4.927494e-03 3 1  ON 43
ci_045                -2.763237e-03 3 1  ON 44
ci_046                 5.442322e-03 3 1  ON 45
ci_047                 5.455164e-03 3 1  ON 46
ci_048                -1.256030e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547233e-03 3 1  ON 49
ci_051                 3.500113e-03 3 1  ON 50
ci_052                -2.791495e-03 3 1  ON 51
ci_053                -2.829371e-03 3 1  ON 52
ci_054                -2.961036e-03 3 1  ON 53
ci_055                -3.227718e-03 3 1  ON 54
ci_056                 5.143246e-03 3 1  ON 55
ci_057                 5.323741e-03 3 1  ON 56
ci_058                -2.540448e-03 3 1  ON 57
ci_059                -2.495843e-03 3 1  ON 58
ci_060                 5.249218e-03 3 1  ON 59
ci_061                 5.938362e-03 3 1  ON 60
ci_062                -3.646874e-03 3 1  ON 61
ci_063                -3.707010e-03 3 1  ON 62
ci_064                -2.767268e-03 3 1  ON 63
ci_065                -3.793539e-03 3 1  ON 64
ci_066                 4.285568e-03 3 1  ON 65
ci_067                 4.385763e-03 3 1  ON 66
ci_068                -5.158232e-03 3 1  ON 67
ci_069                -4.482205e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9302e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.177651
====================================================
  Execution time = 1.3921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0184e-01
  Total weights = 1.957254242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288819879491
                                         uncertainty =       0.002025710191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288819879491
                                         uncertainty =       0.002025710191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379977975
  error estimate for blocks of size 2^( 2) =       0.000390886135
  error estimate for blocks of size 2^( 3) =       0.000400674120
  error estimate for blocks of size 2^( 4) =       0.000408277051
  error estimate for blocks of size 2^( 5) =       0.000412387960
  error estimate for blocks of size 2^( 6) =       0.000414353422
  error estimate for blocks of size 2^( 7) =       0.000415371662

      target function =      -0.899184430189
              le_mean =     -17.215070591956
             les_mean =     296.660491138568
             stat err =       0.000412597524
             autocorr =       1.179061306633
   target nu stat err =       0.000412597524
   target dn stat err =       0.002556478071
      target stat err =       0.003271948787
              std dev =       0.537370005175
             le_variance =       0.288766522462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721507059196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899195680966       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899204136064       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899205394486       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899205833874       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899205882453       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899205885054       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899205889638       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899205890848       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899205890635       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899205890606       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.914776e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899195680966       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899197807093       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899198123046       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899198233198       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899198245329       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899198245972       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899198247118       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899198247420       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899198247367       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899198247359       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 4.808233e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899195680966       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899196213275       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899196292348       residual = 7.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899196319905       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899196322937       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899196323097       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899196323384       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899196323459       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899196323446       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899196323444       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.203397e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6424e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.052026e-02 3 1  ON 0
ci_002                -3.052324e-02 3 1  ON 1
ci_003                -2.506914e-02 3 1  ON 2
ci_004                 2.252040e-02 3 1  ON 3
ci_005                 2.296920e-02 3 1  ON 4
ci_006                -1.977243e-02 3 1  ON 5
ci_007                -1.973926e-02 3 1  ON 6
ci_008                -9.198811e-03 3 1  ON 7
ci_009                -1.487638e-02 3 1  ON 8
ci_010                -1.017640e-02 3 1  ON 9
ci_011                -1.046882e-02 3 1  ON 10
ci_012                -1.051199e-02 3 1  ON 11
ci_013                -2.011755e-02 3 1  ON 12
ci_014                 1.204248e-02 3 1  ON 13
ci_015                 1.232560e-02 3 1  ON 14
ci_016                 1.649891e-02 3 1  ON 15
ci_017                 1.634526e-02 3 1  ON 16
ci_018                 9.879655e-03 3 1  ON 17
ci_019                 1.026669e-02 3 1  ON 18
ci_020                 1.580019e-02 3 1  ON 19
ci_021                 1.592548e-02 3 1  ON 20
ci_022                 9.116510e-03 3 1  ON 21
ci_023                 9.115635e-03 3 1  ON 22
ci_024                 9.628080e-03 3 1  ON 23
ci_025                 9.591492e-03 3 1  ON 24
ci_026                 1.071599e-02 3 1  ON 25
ci_027                 1.103492e-02 3 1  ON 26
ci_028                -1.507259e-02 3 1  ON 27
ci_029                -1.569049e-02 3 1  ON 28
ci_030                -8.961187e-03 3 1  ON 29
ci_031                -9.351375e-03 3 1  ON 30
ci_032                -1.472813e-02 3 1  ON 31
ci_033                 6.273310e-03 3 1  ON 32
ci_034                 5.751406e-03 3 1  ON 33
ci_035                -4.282008e-03 3 1  ON 34
ci_036                -1.205933e-02 3 1  ON 35
ci_037                -1.231234e-02 3 1  ON 36
ci_038                 1.858255e-03 3 1  ON 37
ci_039                 2.119422e-03 3 1  ON 38
ci_040                -2.543713e-03 3 1  ON 39
ci_041                 8.527324e-03 3 1  ON 40
ci_042                 8.520085e-03 3 1  ON 41
ci_043                -3.218664e-03 3 1  ON 42
ci_044                -4.926895e-03 3 1  ON 43
ci_045                -2.761780e-03 3 1  ON 44
ci_046                 5.439520e-03 3 1  ON 45
ci_047                 5.454063e-03 3 1  ON 46
ci_048                -1.256119e-02 3 1  ON 47
ci_049                -1.273759e-02 3 1  ON 48
ci_050                 3.545144e-03 3 1  ON 49
ci_051                 3.499048e-03 3 1  ON 50
ci_052                -2.790026e-03 3 1  ON 51
ci_053                -2.830599e-03 3 1  ON 52
ci_054                -2.960127e-03 3 1  ON 53
ci_055                -3.226255e-03 3 1  ON 54
ci_056                 5.143087e-03 3 1  ON 55
ci_057                 5.322930e-03 3 1  ON 56
ci_058                -2.538146e-03 3 1  ON 57
ci_059                -2.494675e-03 3 1  ON 58
ci_060                 5.248309e-03 3 1  ON 59
ci_061                 5.936346e-03 3 1  ON 60
ci_062                -3.645759e-03 3 1  ON 61
ci_063                -3.704264e-03 3 1  ON 62
ci_064                -2.766568e-03 3 1  ON 63
ci_065                -3.791532e-03 3 1  ON 64
ci_066                 4.285628e-03 3 1  ON 65
ci_067                 4.386418e-03 3 1  ON 66
ci_068                -5.154810e-03 3 1  ON 67
ci_069                -4.480368e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.204418
====================================================
  Execution time = 1.4038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0477e-01
  Total weights = 1.9572e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287441470301
                                         uncertainty =       0.001809843199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287441470301
                                         uncertainty =       0.001809843199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379051853
  error estimate for blocks of size 2^( 2) =       0.000390411386
  error estimate for blocks of size 2^( 3) =       0.000400797580
  error estimate for blocks of size 2^( 4) =       0.000408614677
  error estimate for blocks of size 2^( 5) =       0.000413258308
  error estimate for blocks of size 2^( 6) =       0.000414228952
  error estimate for blocks of size 2^( 7) =       0.000415243096

      target function =      -0.895422189212
              le_mean =     -17.214880785164
             les_mean =     296.656887781479
             stat err =       0.000412836258
             autocorr =       1.186201363890
   target nu stat err =       0.000412836258
   target dn stat err =       0.005692791150
      target stat err =       0.007133051941
              std dev =       0.536060271000
             le_variance =       0.287360614144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287431581520
                                         uncertainty =       0.001810442879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287431581520
                                         uncertainty =       0.001810442879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379045315
  error estimate for blocks of size 2^( 2) =       0.000390407015
  error estimate for blocks of size 2^( 3) =       0.000400795292
  error estimate for blocks of size 2^( 4) =       0.000408613838
  error estimate for blocks of size 2^( 5) =       0.000413258479
  error estimate for blocks of size 2^( 6) =       0.000414229873
  error estimate for blocks of size 2^( 7) =       0.000415244413

      target function =      -0.895408543930
              le_mean =     -17.214881268245
             les_mean =     296.656915052882
             stat err =       0.000412836651
             autocorr =       1.186244536223
   target nu stat err =       0.000412836651
   target dn stat err =       0.005716074489
      target stat err =       0.007161827705
              std dev =       0.536051025619
             le_variance =       0.287350702067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287436474562
                                         uncertainty =       0.001810142263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287436474562
                                         uncertainty =       0.001810142263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379048550
  error estimate for blocks of size 2^( 2) =       0.000390409172
  error estimate for blocks of size 2^( 3) =       0.000400796413
  error estimate for blocks of size 2^( 4) =       0.000408614238
  error estimate for blocks of size 2^( 5) =       0.000413258377
  error estimate for blocks of size 2^( 6) =       0.000414229399
  error estimate for blocks of size 2^( 7) =       0.000415243742

      target function =      -0.895415829398
              le_mean =     -17.214881025364
             les_mean =     296.656901000035
             stat err =       0.000412836439
             autocorr =       1.186223072705
   target nu stat err =       0.000412836439
   target dn stat err =       0.005704449476
      target stat err =       0.007147468023
              std dev =       0.536055600400
             le_variance =       0.287355606720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287440842503
                                         uncertainty =       0.001809880426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287440842503
                                         uncertainty =       0.001809880426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379051438
  error estimate for blocks of size 2^( 2) =       0.000390411107
  error estimate for blocks of size 2^( 3) =       0.000400797432
  error estimate for blocks of size 2^( 4) =       0.000408614621
  error estimate for blocks of size 2^( 5) =       0.000413258315
  error estimate for blocks of size 2^( 6) =       0.000414229007
  error estimate for blocks of size 2^( 7) =       0.000415243175

      target function =      -0.895421448166
              le_mean =     -17.214880814931
             les_mean =     296.656889381722
             stat err =       0.000412836279
             autocorr =       1.186204081644
   target nu stat err =       0.000412836279
   target dn stat err =       0.005694246715
      target stat err =       0.007134852667
              std dev =       0.536059684070
             le_variance =       0.287359984885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.895422189212        initial  <--
     9.7656e+00     9.7656e+01             1.9148e-05        -0.895408543930
     3.9062e+01     3.9062e+02             4.8082e-06        -0.895415829398
     1.5625e+02     1.5625e+03             1.2034e-06        -0.895421448166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2641
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.052507e-02 3 1  ON 0
ci_002                -3.052646e-02 3 1  ON 1
ci_003                -2.507237e-02 3 1  ON 2
ci_004                 2.252136e-02 3 1  ON 3
ci_005                 2.297161e-02 3 1  ON 4
ci_006                -1.977261e-02 3 1  ON 5
ci_007                -1.974070e-02 3 1  ON 6
ci_008                -9.201407e-03 3 1  ON 7
ci_009                -1.487723e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047071e-02 3 1  ON 10
ci_012                -1.051521e-02 3 1  ON 11
ci_013                -2.011767e-02 3 1  ON 12
ci_014                 1.204514e-02 3 1  ON 13
ci_015                 1.232689e-02 3 1  ON 14
ci_016                 1.650007e-02 3 1  ON 15
ci_017                 1.634667e-02 3 1  ON 16
ci_018                 9.880340e-03 3 1  ON 17
ci_019                 1.026930e-02 3 1  ON 18
ci_020                 1.580102e-02 3 1  ON 19
ci_021                 1.592864e-02 3 1  ON 20
ci_022                 9.116424e-03 3 1  ON 21
ci_023                 9.116471e-03 3 1  ON 22
ci_024                 9.630298e-03 3 1  ON 23
ci_025                 9.595631e-03 3 1  ON 24
ci_026                 1.071654e-02 3 1  ON 25
ci_027                 1.103798e-02 3 1  ON 26
ci_028                -1.507584e-02 3 1  ON 27
ci_029                -1.569004e-02 3 1  ON 28
ci_030                -8.962383e-03 3 1  ON 29
ci_031                -9.353991e-03 3 1  ON 30
ci_032                -1.472885e-02 3 1  ON 31
ci_033                 6.274081e-03 3 1  ON 32
ci_034                 5.752368e-03 3 1  ON 33
ci_035                -4.283472e-03 3 1  ON 34
ci_036                -1.206343e-02 3 1  ON 35
ci_037                -1.231381e-02 3 1  ON 36
ci_038                 1.860692e-03 3 1  ON 37
ci_039                 2.121397e-03 3 1  ON 38
ci_040                -2.546693e-03 3 1  ON 39
ci_041                 8.528269e-03 3 1  ON 40
ci_042                 8.523452e-03 3 1  ON 41
ci_043                -3.220407e-03 3 1  ON 42
ci_044                -4.927494e-03 3 1  ON 43
ci_045                -2.763237e-03 3 1  ON 44
ci_046                 5.442322e-03 3 1  ON 45
ci_047                 5.455164e-03 3 1  ON 46
ci_048                -1.256030e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547233e-03 3 1  ON 49
ci_051                 3.500113e-03 3 1  ON 50
ci_052                -2.791495e-03 3 1  ON 51
ci_053                -2.829371e-03 3 1  ON 52
ci_054                -2.961036e-03 3 1  ON 53
ci_055                -3.227718e-03 3 1  ON 54
ci_056                 5.143246e-03 3 1  ON 55
ci_057                 5.323741e-03 3 1  ON 56
ci_058                -2.540448e-03 3 1  ON 57
ci_059                -2.495843e-03 3 1  ON 58
ci_060                 5.249218e-03 3 1  ON 59
ci_061                 5.938362e-03 3 1  ON 60
ci_062                -3.646874e-03 3 1  ON 61
ci_063                -3.707010e-03 3 1  ON 62
ci_064                -2.767268e-03 3 1  ON 63
ci_065                -3.793539e-03 3 1  ON 64
ci_066                 4.285568e-03 3 1  ON 65
ci_067                 4.385763e-03 3 1  ON 66
ci_068                -5.158232e-03 3 1  ON 67
ci_069                -4.482205e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.239
    reference variance = 0.301738
====================================================
  Execution time = 1.3894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0382e-01
  Total weights = 1.957073666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289549173498
                                         uncertainty =       0.001760761243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289549173498
                                         uncertainty =       0.001760761243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380478215
  error estimate for blocks of size 2^( 2) =       0.000391294752
  error estimate for blocks of size 2^( 3) =       0.000401207635
  error estimate for blocks of size 2^( 4) =       0.000408351239
  error estimate for blocks of size 2^( 5) =       0.000412586278
  error estimate for blocks of size 2^( 6) =       0.000415420966
  error estimate for blocks of size 2^( 7) =       0.000417228547

      target function =      -0.896730912537
              le_mean =     -17.215288027075
             les_mean =     296.669964695323
             stat err =       0.000413396758
             autocorr =       1.180523242466
   target nu stat err =       0.000413396758
   target dn stat err =       0.002890934209
      target stat err =       0.003668981425
              std dev =       0.538077451150
             le_variance =       0.289527343436


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528802708e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896745117458       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896745793701       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896745937377       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896745973188       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896745977236       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896745978215       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896745978785       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896745979020       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896745978931       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896745978922       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 2.368239e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896745117458       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896745286619       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896745322553       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896745331508       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896745332520       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896745332765       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896745332907       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896745332966       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896745332944       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896745332941       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 5.923246e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896745117458       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896745159754       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896745168739       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896745170978       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896745171231       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896745171292       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896745171327       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896745171342       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896745171336       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896745171336       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.480977e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.421475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6389e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.052448e-02 3 1  ON 0
ci_002                -3.052613e-02 3 1  ON 1
ci_003                -2.507195e-02 3 1  ON 2
ci_004                 2.252105e-02 3 1  ON 3
ci_005                 2.297160e-02 3 1  ON 4
ci_006                -1.977233e-02 3 1  ON 5
ci_007                -1.974048e-02 3 1  ON 6
ci_008                -9.201158e-03 3 1  ON 7
ci_009                -1.487711e-02 3 1  ON 8
ci_010                -1.017627e-02 3 1  ON 9
ci_011                -1.047055e-02 3 1  ON 10
ci_012                -1.051501e-02 3 1  ON 11
ci_013                -2.011752e-02 3 1  ON 12
ci_014                 1.204490e-02 3 1  ON 13
ci_015                 1.232665e-02 3 1  ON 14
ci_016                 1.649979e-02 3 1  ON 15
ci_017                 1.634653e-02 3 1  ON 16
ci_018                 9.880141e-03 3 1  ON 17
ci_019                 1.026911e-02 3 1  ON 18
ci_020                 1.580089e-02 3 1  ON 19
ci_021                 1.592867e-02 3 1  ON 20
ci_022                 9.116359e-03 3 1  ON 21
ci_023                 9.116373e-03 3 1  ON 22
ci_024                 9.629924e-03 3 1  ON 23
ci_025                 9.595553e-03 3 1  ON 24
ci_026                 1.071639e-02 3 1  ON 25
ci_027                 1.103777e-02 3 1  ON 26
ci_028                -1.507575e-02 3 1  ON 27
ci_029                -1.568992e-02 3 1  ON 28
ci_030                -8.962320e-03 3 1  ON 29
ci_031                -9.353674e-03 3 1  ON 30
ci_032                -1.472889e-02 3 1  ON 31
ci_033                 6.273930e-03 3 1  ON 32
ci_034                 5.752264e-03 3 1  ON 33
ci_035                -4.283255e-03 3 1  ON 34
ci_036                -1.206331e-02 3 1  ON 35
ci_037                -1.231373e-02 3 1  ON 36
ci_038                 1.860438e-03 3 1  ON 37
ci_039                 2.121226e-03 3 1  ON 38
ci_040                -2.546608e-03 3 1  ON 39
ci_041                 8.527985e-03 3 1  ON 40
ci_042                 8.523125e-03 3 1  ON 41
ci_043                -3.220251e-03 3 1  ON 42
ci_044                -4.927422e-03 3 1  ON 43
ci_045                -2.763077e-03 3 1  ON 44
ci_046                 5.442228e-03 3 1  ON 45
ci_047                 5.455106e-03 3 1  ON 46
ci_048                -1.256036e-02 3 1  ON 47
ci_049                -1.273782e-02 3 1  ON 48
ci_050                 3.547061e-03 3 1  ON 49
ci_051                 3.499836e-03 3 1  ON 50
ci_052                -2.791354e-03 3 1  ON 51
ci_053                -2.829313e-03 3 1  ON 52
ci_054                -2.960919e-03 3 1  ON 53
ci_055                -3.227516e-03 3 1  ON 54
ci_056                 5.143177e-03 3 1  ON 55
ci_057                 5.323668e-03 3 1  ON 56
ci_058                -2.540467e-03 3 1  ON 57
ci_059                -2.495722e-03 3 1  ON 58
ci_060                 5.249225e-03 3 1  ON 59
ci_061                 5.938312e-03 3 1  ON 60
ci_062                -3.646712e-03 3 1  ON 61
ci_063                -3.706882e-03 3 1  ON 62
ci_064                -2.767242e-03 3 1  ON 63
ci_065                -3.793510e-03 3 1  ON 64
ci_066                 4.285617e-03 3 1  ON 65
ci_067                 4.385722e-03 3 1  ON 66
ci_068                -5.158209e-03 3 1  ON 67
ci_069                -4.482209e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.214571
====================================================
  Execution time = 1.3407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0087e-01
  Total weights = 1.9574e+06
  Execution time = 1.8431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564635710
                                         uncertainty =       0.001759999904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564635710
                                         uncertainty =       0.001759999904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379205336
  error estimate for blocks of size 2^( 2) =       0.000390696822
  error estimate for blocks of size 2^( 3) =       0.000400579836
  error estimate for blocks of size 2^( 4) =       0.000407687012
  error estimate for blocks of size 2^( 5) =       0.000411965334
  error estimate for blocks of size 2^( 6) =       0.000412128932
  error estimate for blocks of size 2^( 7) =       0.000414746373

      target function =      -0.900492446781
              le_mean =     -17.215403230666
             les_mean =     296.670966276592
             stat err =       0.000411631913
             autocorr =       1.178336133914
   target nu stat err =       0.000411631913
   target dn stat err =       0.002321516862
      target stat err =       0.002990871843
              std dev =       0.536277328667
             le_variance =       0.287593373242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563024397
                                         uncertainty =       0.001759951357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563024397
                                         uncertainty =       0.001759951357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379204278
  error estimate for blocks of size 2^( 2) =       0.000390696009
  error estimate for blocks of size 2^( 3) =       0.000400579327
  error estimate for blocks of size 2^( 4) =       0.000407686712
  error estimate for blocks of size 2^( 5) =       0.000411965128
  error estimate for blocks of size 2^( 6) =       0.000412128756
  error estimate for blocks of size 2^( 7) =       0.000414746162

      target function =      -0.900447190327
              le_mean =     -17.215403248021
             les_mean =     296.671002607109
             stat err =       0.000411631689
             autocorr =       1.178341430177
   target nu stat err =       0.000411631689
   target dn stat err =       0.002333026244
      target stat err =       0.003004851421
              std dev =       0.536275832296
             le_variance =       0.287591768304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563829450
                                         uncertainty =       0.001759975613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287563829450
                                         uncertainty =       0.001759975613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379204806
  error estimate for blocks of size 2^( 2) =       0.000390696415
  error estimate for blocks of size 2^( 3) =       0.000400579581
  error estimate for blocks of size 2^( 4) =       0.000407686862
  error estimate for blocks of size 2^( 5) =       0.000411965231
  error estimate for blocks of size 2^( 6) =       0.000412128844
  error estimate for blocks of size 2^( 7) =       0.000414746267

      target function =      -0.900470313416
              le_mean =     -17.215403239330
             les_mean =     296.670984050660
             stat err =       0.000411631801
             autocorr =       1.178338783351
   target nu stat err =       0.000411631801
   target dn stat err =       0.002327089032
      target stat err =       0.002997638516
              std dev =       0.536276579921
             le_variance =       0.287592570172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564534895
                                         uncertainty =       0.001759996867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287564534895
                                         uncertainty =       0.001759996867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379205269
  error estimate for blocks of size 2^( 2) =       0.000390696771
  error estimate for blocks of size 2^( 3) =       0.000400579804
  error estimate for blocks of size 2^( 4) =       0.000407686993
  error estimate for blocks of size 2^( 5) =       0.000411965321
  error estimate for blocks of size 2^( 6) =       0.000412128921
  error estimate for blocks of size 2^( 7) =       0.000414746360

      target function =      -0.900489732991
              le_mean =     -17.215403231747
             les_mean =     296.670968456537
             stat err =       0.000411631899
             autocorr =       1.178336465126
   target nu stat err =       0.000411631899
   target dn stat err =       0.002322194233
      target stat err =       0.002991694274
              std dev =       0.536277235044
             le_variance =       0.287593272826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900492446781        initial  <--
     9.7656e+01     9.7656e+02             2.3682e-06        -0.900447190327
     3.9062e+02     3.9062e+03             5.9232e-07        -0.900470313416
     1.5625e+03     1.5625e+04             1.4810e-07        -0.900489732991

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7430
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.052507e-02 3 1  ON 0
ci_002                -3.052646e-02 3 1  ON 1
ci_003                -2.507237e-02 3 1  ON 2
ci_004                 2.252136e-02 3 1  ON 3
ci_005                 2.297161e-02 3 1  ON 4
ci_006                -1.977261e-02 3 1  ON 5
ci_007                -1.974070e-02 3 1  ON 6
ci_008                -9.201407e-03 3 1  ON 7
ci_009                -1.487723e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047071e-02 3 1  ON 10
ci_012                -1.051521e-02 3 1  ON 11
ci_013                -2.011767e-02 3 1  ON 12
ci_014                 1.204514e-02 3 1  ON 13
ci_015                 1.232689e-02 3 1  ON 14
ci_016                 1.650007e-02 3 1  ON 15
ci_017                 1.634667e-02 3 1  ON 16
ci_018                 9.880340e-03 3 1  ON 17
ci_019                 1.026930e-02 3 1  ON 18
ci_020                 1.580102e-02 3 1  ON 19
ci_021                 1.592864e-02 3 1  ON 20
ci_022                 9.116424e-03 3 1  ON 21
ci_023                 9.116471e-03 3 1  ON 22
ci_024                 9.630298e-03 3 1  ON 23
ci_025                 9.595631e-03 3 1  ON 24
ci_026                 1.071654e-02 3 1  ON 25
ci_027                 1.103798e-02 3 1  ON 26
ci_028                -1.507584e-02 3 1  ON 27
ci_029                -1.569004e-02 3 1  ON 28
ci_030                -8.962383e-03 3 1  ON 29
ci_031                -9.353991e-03 3 1  ON 30
ci_032                -1.472885e-02 3 1  ON 31
ci_033                 6.274081e-03 3 1  ON 32
ci_034                 5.752368e-03 3 1  ON 33
ci_035                -4.283472e-03 3 1  ON 34
ci_036                -1.206343e-02 3 1  ON 35
ci_037                -1.231381e-02 3 1  ON 36
ci_038                 1.860692e-03 3 1  ON 37
ci_039                 2.121397e-03 3 1  ON 38
ci_040                -2.546693e-03 3 1  ON 39
ci_041                 8.528269e-03 3 1  ON 40
ci_042                 8.523452e-03 3 1  ON 41
ci_043                -3.220407e-03 3 1  ON 42
ci_044                -4.927494e-03 3 1  ON 43
ci_045                -2.763237e-03 3 1  ON 44
ci_046                 5.442322e-03 3 1  ON 45
ci_047                 5.455164e-03 3 1  ON 46
ci_048                -1.256030e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547233e-03 3 1  ON 49
ci_051                 3.500113e-03 3 1  ON 50
ci_052                -2.791495e-03 3 1  ON 51
ci_053                -2.829371e-03 3 1  ON 52
ci_054                -2.961036e-03 3 1  ON 53
ci_055                -3.227718e-03 3 1  ON 54
ci_056                 5.143246e-03 3 1  ON 55
ci_057                 5.323741e-03 3 1  ON 56
ci_058                -2.540448e-03 3 1  ON 57
ci_059                -2.495843e-03 3 1  ON 58
ci_060                 5.249218e-03 3 1  ON 59
ci_061                 5.938362e-03 3 1  ON 60
ci_062                -3.646874e-03 3 1  ON 61
ci_063                -3.707010e-03 3 1  ON 62
ci_064                -2.767268e-03 3 1  ON 63
ci_065                -3.793539e-03 3 1  ON 64
ci_066                 4.285568e-03 3 1  ON 65
ci_067                 4.385763e-03 3 1  ON 66
ci_068                -5.158232e-03 3 1  ON 67
ci_069                -4.482205e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.171386
====================================================
  Execution time = 1.3886e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0313e-01
  Total weights = 1.957045023e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287836831273
                                         uncertainty =       0.001900338330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287836831273
                                         uncertainty =       0.001900338330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379392825
  error estimate for blocks of size 2^( 2) =       0.000390333681
  error estimate for blocks of size 2^( 3) =       0.000400294370
  error estimate for blocks of size 2^( 4) =       0.000407729998
  error estimate for blocks of size 2^( 5) =       0.000412135652
  error estimate for blocks of size 2^( 6) =       0.000414160003
  error estimate for blocks of size 2^( 7) =       0.000417247284

      target function =      -0.897616108963
              le_mean =     -17.215394126896
             les_mean =     296.672926070567
             stat err =       0.000412818234
             autocorr =       1.183966782427
   target nu stat err =       0.000412818234
   target dn stat err =       0.003346704849
      target stat err =       0.004242927289
              std dev =       0.536542477896
             le_variance =       0.287877830586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721539412690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897635423228       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897635515825       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897635527615       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897635531790       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897635532397       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897635532676       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897635532714       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897635532734       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897635532728       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897635532732       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 1.749583e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897635423228       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897635446379       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897635449326       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897635450370       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897635450522       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897635450596       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897635450601       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897635450611       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897635450603       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897635450602       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 4.374193e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897635423228       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897635429016       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897635429753       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897635430013       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897635430026       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897635430077       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897635430059       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897635430075       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897635430074       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897635430078       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.093563e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.424821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6385e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.052503e-02 3 1  ON 0
ci_002                -3.052643e-02 3 1  ON 1
ci_003                -2.507234e-02 3 1  ON 2
ci_004                 2.252134e-02 3 1  ON 3
ci_005                 2.297157e-02 3 1  ON 4
ci_006                -1.977259e-02 3 1  ON 5
ci_007                -1.974067e-02 3 1  ON 6
ci_008                -9.201383e-03 3 1  ON 7
ci_009                -1.487719e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047068e-02 3 1  ON 10
ci_012                -1.051519e-02 3 1  ON 11
ci_013                -2.011764e-02 3 1  ON 12
ci_014                 1.204512e-02 3 1  ON 13
ci_015                 1.232688e-02 3 1  ON 14
ci_016                 1.650006e-02 3 1  ON 15
ci_017                 1.634665e-02 3 1  ON 16
ci_018                 9.880342e-03 3 1  ON 17
ci_019                 1.026929e-02 3 1  ON 18
ci_020                 1.580103e-02 3 1  ON 19
ci_021                 1.592861e-02 3 1  ON 20
ci_022                 9.116404e-03 3 1  ON 21
ci_023                 9.116452e-03 3 1  ON 22
ci_024                 9.630280e-03 3 1  ON 23
ci_025                 9.595619e-03 3 1  ON 24
ci_026                 1.071652e-02 3 1  ON 25
ci_027                 1.103796e-02 3 1  ON 26
ci_028                -1.507584e-02 3 1  ON 27
ci_029                -1.569003e-02 3 1  ON 28
ci_030                -8.962366e-03 3 1  ON 29
ci_031                -9.353976e-03 3 1  ON 30
ci_032                -1.472884e-02 3 1  ON 31
ci_033                 6.274041e-03 3 1  ON 32
ci_034                 5.752348e-03 3 1  ON 33
ci_035                -4.283444e-03 3 1  ON 34
ci_036                -1.206341e-02 3 1  ON 35
ci_037                -1.231378e-02 3 1  ON 36
ci_038                 1.860666e-03 3 1  ON 37
ci_039                 2.121372e-03 3 1  ON 38
ci_040                -2.546675e-03 3 1  ON 39
ci_041                 8.528260e-03 3 1  ON 40
ci_042                 8.523431e-03 3 1  ON 41
ci_043                -3.220389e-03 3 1  ON 42
ci_044                -4.927450e-03 3 1  ON 43
ci_045                -2.763224e-03 3 1  ON 44
ci_046                 5.442299e-03 3 1  ON 45
ci_047                 5.455139e-03 3 1  ON 46
ci_048                -1.256027e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547222e-03 3 1  ON 49
ci_051                 3.500092e-03 3 1  ON 50
ci_052                -2.791473e-03 3 1  ON 51
ci_053                -2.829354e-03 3 1  ON 52
ci_054                -2.961030e-03 3 1  ON 53
ci_055                -3.227726e-03 3 1  ON 54
ci_056                 5.143253e-03 3 1  ON 55
ci_057                 5.323727e-03 3 1  ON 56
ci_058                -2.540423e-03 3 1  ON 57
ci_059                -2.495834e-03 3 1  ON 58
ci_060                 5.249211e-03 3 1  ON 59
ci_061                 5.938365e-03 3 1  ON 60
ci_062                -3.646849e-03 3 1  ON 61
ci_063                -3.706990e-03 3 1  ON 62
ci_064                -2.767269e-03 3 1  ON 63
ci_065                -3.793556e-03 3 1  ON 64
ci_066                 4.285562e-03 3 1  ON 65
ci_067                 4.385742e-03 3 1  ON 66
ci_068                -5.158231e-03 3 1  ON 67
ci_069                -4.482211e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.264297
====================================================
  Execution time = 1.3849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0188e-01
  Total weights = 1.9573e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766124813
                                         uncertainty =       0.001695183174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766124813
                                         uncertainty =       0.001695183174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379968795
  error estimate for blocks of size 2^( 2) =       0.000390957964
  error estimate for blocks of size 2^( 3) =       0.000400685905
  error estimate for blocks of size 2^( 4) =       0.000408571123
  error estimate for blocks of size 2^( 5) =       0.000413452395
  error estimate for blocks of size 2^( 6) =       0.000415927402
  error estimate for blocks of size 2^( 7) =       0.000415851358

      target function =      -0.899314173342
              le_mean =     -17.215900215603
             les_mean =     296.689095942420
             stat err =       0.000413450570
             autocorr =       1.183998972314
   target nu stat err =       0.000413450570
   target dn stat err =       0.002383465642
      target stat err =       0.003062715841
              std dev =       0.537357023420
             le_variance =       0.288752570619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288765954722
                                         uncertainty =       0.001695174118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288765954722
                                         uncertainty =       0.001695174118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379968683
  error estimate for blocks of size 2^( 2) =       0.000390957877
  error estimate for blocks of size 2^( 3) =       0.000400685844
  error estimate for blocks of size 2^( 4) =       0.000408571081
  error estimate for blocks of size 2^( 5) =       0.000413452366
  error estimate for blocks of size 2^( 6) =       0.000415927378
  error estimate for blocks of size 2^( 7) =       0.000415851350

      target function =      -0.899314433490
              le_mean =     -17.215900216995
             les_mean =     296.689095784430
             stat err =       0.000413450544
             autocorr =       1.183999521591
   target nu stat err =       0.000413450544
   target dn stat err =       0.002383461857
      target stat err =       0.003062712892
              std dev =       0.537356865412
             le_variance =       0.288752400805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766039761
                                         uncertainty =       0.001695178645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766039761
                                         uncertainty =       0.001695178645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379968739
  error estimate for blocks of size 2^( 2) =       0.000390957920
  error estimate for blocks of size 2^( 3) =       0.000400685874
  error estimate for blocks of size 2^( 4) =       0.000408571102
  error estimate for blocks of size 2^( 5) =       0.000413452381
  error estimate for blocks of size 2^( 6) =       0.000415927390
  error estimate for blocks of size 2^( 7) =       0.000415851354

      target function =      -0.899314303471
              le_mean =     -17.215900216299
             les_mean =     296.689095863372
             stat err =       0.000413450557
             autocorr =       1.183999246954
   target nu stat err =       0.000413450557
   target dn stat err =       0.002383463748
      target stat err =       0.003062714365
              std dev =       0.537356944409
             le_variance =       0.288752485705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766114181
                                         uncertainty =       0.001695182608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766114181
                                         uncertainty =       0.001695182608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379968788
  error estimate for blocks of size 2^( 2) =       0.000390957959
  error estimate for blocks of size 2^( 3) =       0.000400685901
  error estimate for blocks of size 2^( 4) =       0.000408571120
  error estimate for blocks of size 2^( 5) =       0.000413452394
  error estimate for blocks of size 2^( 6) =       0.000415927401
  error estimate for blocks of size 2^( 7) =       0.000415851357

      target function =      -0.899314189614
              le_mean =     -17.215900215690
             les_mean =     296.689095932534
             stat err =       0.000413450568
             autocorr =       1.183999006644
   target nu stat err =       0.000413450568
   target dn stat err =       0.002383465405
      target stat err =       0.003062715657
              std dev =       0.537357013543
             le_variance =       0.288752560004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899314173342        initial
     9.7656e+02     9.7656e+03             1.7496e-07        -0.899314433490  <--
     3.9062e+03     3.9062e+04             4.3742e-08        -0.899314303471
     1.5625e+04     1.5625e+05             1.0936e-08        -0.899314189614

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 2.3101e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.052492e-02 3 1  ON 0
ci_002                -3.052634e-02 3 1  ON 1
ci_003                -2.507225e-02 3 1  ON 2
ci_004                 2.252128e-02 3 1  ON 3
ci_005                 2.297147e-02 3 1  ON 4
ci_006                -1.977251e-02 3 1  ON 5
ci_007                -1.974061e-02 3 1  ON 6
ci_008                -9.201312e-03 3 1  ON 7
ci_009                -1.487706e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047060e-02 3 1  ON 10
ci_012                -1.051513e-02 3 1  ON 11
ci_013                -2.011757e-02 3 1  ON 12
ci_014                 1.204507e-02 3 1  ON 13
ci_015                 1.232686e-02 3 1  ON 14
ci_016                 1.650004e-02 3 1  ON 15
ci_017                 1.634656e-02 3 1  ON 16
ci_018                 9.880348e-03 3 1  ON 17
ci_019                 1.026925e-02 3 1  ON 18
ci_020                 1.580103e-02 3 1  ON 19
ci_021                 1.592853e-02 3 1  ON 20
ci_022                 9.116344e-03 3 1  ON 21
ci_023                 9.116393e-03 3 1  ON 22
ci_024                 9.630228e-03 3 1  ON 23
ci_025                 9.595581e-03 3 1  ON 24
ci_026                 1.071647e-02 3 1  ON 25
ci_027                 1.103792e-02 3 1  ON 26
ci_028                -1.507582e-02 3 1  ON 27
ci_029                -1.569002e-02 3 1  ON 28
ci_030                -8.962316e-03 3 1  ON 29
ci_031                -9.353933e-03 3 1  ON 30
ci_032                -1.472880e-02 3 1  ON 31
ci_033                 6.273922e-03 3 1  ON 32
ci_034                 5.752288e-03 3 1  ON 33
ci_035                -4.283362e-03 3 1  ON 34
ci_036                -1.206338e-02 3 1  ON 35
ci_037                -1.231367e-02 3 1  ON 36
ci_038                 1.860587e-03 3 1  ON 37
ci_039                 2.121299e-03 3 1  ON 38
ci_040                -2.546621e-03 3 1  ON 39
ci_041                 8.528235e-03 3 1  ON 40
ci_042                 8.523366e-03 3 1  ON 41
ci_043                -3.220336e-03 3 1  ON 42
ci_044                -4.927319e-03 3 1  ON 43
ci_045                -2.763184e-03 3 1  ON 44
ci_046                 5.442231e-03 3 1  ON 45
ci_047                 5.455065e-03 3 1  ON 46
ci_048                -1.256019e-02 3 1  ON 47
ci_049                -1.273774e-02 3 1  ON 48
ci_050                 3.547187e-03 3 1  ON 49
ci_051                 3.500030e-03 3 1  ON 50
ci_052                -2.791408e-03 3 1  ON 51
ci_053                -2.829304e-03 3 1  ON 52
ci_054                -2.961013e-03 3 1  ON 53
ci_055                -3.227750e-03 3 1  ON 54
ci_056                 5.143274e-03 3 1  ON 55
ci_057                 5.323685e-03 3 1  ON 56
ci_058                -2.540349e-03 3 1  ON 57
ci_059                -2.495805e-03 3 1  ON 58
ci_060                 5.249189e-03 3 1  ON 59
ci_061                 5.938373e-03 3 1  ON 60
ci_062                -3.646773e-03 3 1  ON 61
ci_063                -3.706931e-03 3 1  ON 62
ci_064                -2.767272e-03 3 1  ON 63
ci_065                -3.793607e-03 3 1  ON 64
ci_066                 4.285543e-03 3 1  ON 65
ci_067                 4.385681e-03 3 1  ON 66
ci_068                -5.158226e-03 3 1  ON 67
ci_069                -4.482227e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.114
    reference variance = 0.202207
====================================================
  Execution time = 1.6888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0055e-01
  Total weights = 1.957245580e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286605000546
                                         uncertainty =       0.002004534255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286605000546
                                         uncertainty =       0.002004534255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378534022
  error estimate for blocks of size 2^( 2) =       0.000389059407
  error estimate for blocks of size 2^( 3) =       0.000399247082
  error estimate for blocks of size 2^( 4) =       0.000406752092
  error estimate for blocks of size 2^( 5) =       0.000411666595
  error estimate for blocks of size 2^( 6) =       0.000413202705
  error estimate for blocks of size 2^( 7) =       0.000414428094

      target function =      -0.900647363995
              le_mean =     -17.214344013019
             les_mean =     296.634187447425
             stat err =       0.000411512372
             autocorr =       1.181832572543
   target nu stat err =       0.000411512372
   target dn stat err =       0.002843324296
      target stat err =       0.003635495644
              std dev =       0.535327947138
             le_variance =       0.286576010988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721434401302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900661272076       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900661651369       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900661738869       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900661767619       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900661773048       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900661773645       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900661773673       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900661773773       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900661773803       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900661773802       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900661773788       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+02 is 8.819545e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900661272076       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900661366922       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900661388802       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900661395990       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900661397346       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900661397497       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900661397503       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900661397528       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900661397537       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900661397535       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900661397532       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+02 is 2.205333e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900661272076       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900661295789       residual = 6.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900661301259       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900661303056       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900661303403       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900661303432       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900661303435       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900661303446       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900661303443       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900661303435       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900661303442       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 5.513611e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9379e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.052478e-02 3 1  ON 0
ci_002                -3.052615e-02 3 1  ON 1
ci_003                -2.507203e-02 3 1  ON 2
ci_004                 2.252116e-02 3 1  ON 3
ci_005                 2.297136e-02 3 1  ON 4
ci_006                -1.977240e-02 3 1  ON 5
ci_007                -1.974054e-02 3 1  ON 6
ci_008                -9.201268e-03 3 1  ON 7
ci_009                -1.487702e-02 3 1  ON 8
ci_010                -1.017663e-02 3 1  ON 9
ci_011                -1.047057e-02 3 1  ON 10
ci_012                -1.051492e-02 3 1  ON 11
ci_013                -2.011751e-02 3 1  ON 12
ci_014                 1.204500e-02 3 1  ON 13
ci_015                 1.232670e-02 3 1  ON 14
ci_016                 1.650004e-02 3 1  ON 15
ci_017                 1.634649e-02 3 1  ON 16
ci_018                 9.880301e-03 3 1  ON 17
ci_019                 1.026911e-02 3 1  ON 18
ci_020                 1.580097e-02 3 1  ON 19
ci_021                 1.592846e-02 3 1  ON 20
ci_022                 9.116223e-03 3 1  ON 21
ci_023                 9.116297e-03 3 1  ON 22
ci_024                 9.630216e-03 3 1  ON 23
ci_025                 9.595449e-03 3 1  ON 24
ci_026                 1.071639e-02 3 1  ON 25
ci_027                 1.103781e-02 3 1  ON 26
ci_028                -1.507579e-02 3 1  ON 27
ci_029                -1.569002e-02 3 1  ON 28
ci_030                -8.962210e-03 3 1  ON 29
ci_031                -9.353797e-03 3 1  ON 30
ci_032                -1.472876e-02 3 1  ON 31
ci_033                 6.273851e-03 3 1  ON 32
ci_034                 5.752132e-03 3 1  ON 33
ci_035                -4.283274e-03 3 1  ON 34
ci_036                -1.206338e-02 3 1  ON 35
ci_037                -1.231369e-02 3 1  ON 36
ci_038                 1.860478e-03 3 1  ON 37
ci_039                 2.121250e-03 3 1  ON 38
ci_040                -2.546544e-03 3 1  ON 39
ci_041                 8.528194e-03 3 1  ON 40
ci_042                 8.523320e-03 3 1  ON 41
ci_043                -3.220236e-03 3 1  ON 42
ci_044                -4.927279e-03 3 1  ON 43
ci_045                -2.763205e-03 3 1  ON 44
ci_046                 5.442174e-03 3 1  ON 45
ci_047                 5.455004e-03 3 1  ON 46
ci_048                -1.256008e-02 3 1  ON 47
ci_049                -1.273785e-02 3 1  ON 48
ci_050                 3.547242e-03 3 1  ON 49
ci_051                 3.499913e-03 3 1  ON 50
ci_052                -2.791408e-03 3 1  ON 51
ci_053                -2.829291e-03 3 1  ON 52
ci_054                -2.960966e-03 3 1  ON 53
ci_055                -3.227638e-03 3 1  ON 54
ci_056                 5.143272e-03 3 1  ON 55
ci_057                 5.323657e-03 3 1  ON 56
ci_058                -2.540260e-03 3 1  ON 57
ci_059                -2.495718e-03 3 1  ON 58
ci_060                 5.249251e-03 3 1  ON 59
ci_061                 5.938363e-03 3 1  ON 60
ci_062                -3.646762e-03 3 1  ON 61
ci_063                -3.706905e-03 3 1  ON 62
ci_064                -2.767197e-03 3 1  ON 63
ci_065                -3.793558e-03 3 1  ON 64
ci_066                 4.285549e-03 3 1  ON 65
ci_067                 4.385643e-03 3 1  ON 66
ci_068                -5.158203e-03 3 1  ON 67
ci_069                -4.482198e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.3058
    reference variance = 0.338467
====================================================
  Execution time = 1.3241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9893e-01
  Total weights = 1.9576e+06
  Execution time = 1.8265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194827842
                                         uncertainty =       0.001512404031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194827842
                                         uncertainty =       0.001512404031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378289891
  error estimate for blocks of size 2^( 2) =       0.000389153749
  error estimate for blocks of size 2^( 3) =       0.000399032444
  error estimate for blocks of size 2^( 4) =       0.000406345982
  error estimate for blocks of size 2^( 5) =       0.000410672994
  error estimate for blocks of size 2^( 6) =       0.000412986673
  error estimate for blocks of size 2^( 7) =       0.000415153022

      target function =      -0.903057661556
              le_mean =     -17.215957883980
             les_mean =     296.688138148866
             stat err =       0.000411289668
             autocorr =       1.182077981218
   target nu stat err =       0.000411289668
   target dn stat err =       0.002182348421
      target stat err =       0.002836567850
              std dev =       0.534982694156
             le_variance =       0.286206483047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194293897
                                         uncertainty =       0.001512392629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194293897
                                         uncertainty =       0.001512392629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378289538
  error estimate for blocks of size 2^( 2) =       0.000389153507
  error estimate for blocks of size 2^( 3) =       0.000399032302
  error estimate for blocks of size 2^( 4) =       0.000406345923
  error estimate for blocks of size 2^( 5) =       0.000410672971
  error estimate for blocks of size 2^( 6) =       0.000412986632
  error estimate for blocks of size 2^( 7) =       0.000415152992

      target function =      -0.903057017008
              le_mean =     -17.215957899190
             les_mean =     296.688139181656
             stat err =       0.000411289630
             autocorr =       1.182079966735
   target nu stat err =       0.000411289630
   target dn stat err =       0.002182374394
      target stat err =       0.002836596292
              std dev =       0.534982195314
             le_variance =       0.286205949303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194560778
                                         uncertainty =       0.001512398328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194560778
                                         uncertainty =       0.001512398328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378289714
  error estimate for blocks of size 2^( 2) =       0.000389153627
  error estimate for blocks of size 2^( 3) =       0.000399032373
  error estimate for blocks of size 2^( 4) =       0.000406345953
  error estimate for blocks of size 2^( 5) =       0.000410672983
  error estimate for blocks of size 2^( 6) =       0.000412986652
  error estimate for blocks of size 2^( 7) =       0.000415153007

      target function =      -0.903057345523
              le_mean =     -17.215957891582
             les_mean =     296.688138660243
             stat err =       0.000411289649
             autocorr =       1.182078974193
   target nu stat err =       0.000411289649
   target dn stat err =       0.002182361341
      target stat err =       0.002836582027
              std dev =       0.534982444649
             le_variance =       0.286206216083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194794454
                                         uncertainty =       0.001512403318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286194794454
                                         uncertainty =       0.001512403318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378289869
  error estimate for blocks of size 2^( 2) =       0.000389153733
  error estimate for blocks of size 2^( 3) =       0.000399032435
  error estimate for blocks of size 2^( 4) =       0.000406345978
  error estimate for blocks of size 2^( 5) =       0.000410672993
  error estimate for blocks of size 2^( 6) =       0.000412986670
  error estimate for blocks of size 2^( 7) =       0.000415153020

      target function =      -0.903057622726
              le_mean =     -17.215957884930
             les_mean =     296.688138212241
             stat err =       0.000411289665
             autocorr =       1.182078105339
   target nu stat err =       0.000411289665
   target dn stat err =       0.002182350029
      target stat err =       0.002836569617
              std dev =       0.534982662963
             le_variance =       0.286206449671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903057661556        initial  <--
     2.4414e+02     2.4414e+03             8.8195e-07        -0.903057017008
     9.7656e+02     9.7656e+03             2.2053e-07        -0.903057345523
     3.9062e+03     3.9062e+04             5.5136e-08        -0.903057622726

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.4951
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.052492e-02 3 1  ON 0
ci_002                -3.052634e-02 3 1  ON 1
ci_003                -2.507225e-02 3 1  ON 2
ci_004                 2.252128e-02 3 1  ON 3
ci_005                 2.297147e-02 3 1  ON 4
ci_006                -1.977251e-02 3 1  ON 5
ci_007                -1.974061e-02 3 1  ON 6
ci_008                -9.201312e-03 3 1  ON 7
ci_009                -1.487706e-02 3 1  ON 8
ci_010                -1.017667e-02 3 1  ON 9
ci_011                -1.047060e-02 3 1  ON 10
ci_012                -1.051513e-02 3 1  ON 11
ci_013                -2.011757e-02 3 1  ON 12
ci_014                 1.204507e-02 3 1  ON 13
ci_015                 1.232686e-02 3 1  ON 14
ci_016                 1.650004e-02 3 1  ON 15
ci_017                 1.634656e-02 3 1  ON 16
ci_018                 9.880348e-03 3 1  ON 17
ci_019                 1.026925e-02 3 1  ON 18
ci_020                 1.580103e-02 3 1  ON 19
ci_021                 1.592853e-02 3 1  ON 20
ci_022                 9.116344e-03 3 1  ON 21
ci_023                 9.116393e-03 3 1  ON 22
ci_024                 9.630228e-03 3 1  ON 23
ci_025                 9.595581e-03 3 1  ON 24
ci_026                 1.071647e-02 3 1  ON 25
ci_027                 1.103792e-02 3 1  ON 26
ci_028                -1.507582e-02 3 1  ON 27
ci_029                -1.569002e-02 3 1  ON 28
ci_030                -8.962316e-03 3 1  ON 29
ci_031                -9.353933e-03 3 1  ON 30
ci_032                -1.472880e-02 3 1  ON 31
ci_033                 6.273922e-03 3 1  ON 32
ci_034                 5.752288e-03 3 1  ON 33
ci_035                -4.283362e-03 3 1  ON 34
ci_036                -1.206338e-02 3 1  ON 35
ci_037                -1.231367e-02 3 1  ON 36
ci_038                 1.860587e-03 3 1  ON 37
ci_039                 2.121299e-03 3 1  ON 38
ci_040                -2.546621e-03 3 1  ON 39
ci_041                 8.528235e-03 3 1  ON 40
ci_042                 8.523366e-03 3 1  ON 41
ci_043                -3.220336e-03 3 1  ON 42
ci_044                -4.927319e-03 3 1  ON 43
ci_045                -2.763184e-03 3 1  ON 44
ci_046                 5.442231e-03 3 1  ON 45
ci_047                 5.455065e-03 3 1  ON 46
ci_048                -1.256019e-02 3 1  ON 47
ci_049                -1.273774e-02 3 1  ON 48
ci_050                 3.547187e-03 3 1  ON 49
ci_051                 3.500030e-03 3 1  ON 50
ci_052                -2.791408e-03 3 1  ON 51
ci_053                -2.829304e-03 3 1  ON 52
ci_054                -2.961013e-03 3 1  ON 53
ci_055                -3.227750e-03 3 1  ON 54
ci_056                 5.143274e-03 3 1  ON 55
ci_057                 5.323685e-03 3 1  ON 56
ci_058                -2.540349e-03 3 1  ON 57
ci_059                -2.495805e-03 3 1  ON 58
ci_060                 5.249189e-03 3 1  ON 59
ci_061                 5.938373e-03 3 1  ON 60
ci_062                -3.646773e-03 3 1  ON 61
ci_063                -3.706931e-03 3 1  ON 62
ci_064                -2.767272e-03 3 1  ON 63
ci_065                -3.793607e-03 3 1  ON 64
ci_066                 4.285543e-03 3 1  ON 65
ci_067                 4.385681e-03 3 1  ON 66
ci_068                -5.158226e-03 3 1  ON 67
ci_069                -4.482227e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1911e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1592
    reference variance = 0.194016
====================================================
  Execution time = 1.4132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0498e-01
  Total weights = 1.957375592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288000676355
                                         uncertainty =       0.001600944454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288000676355
                                         uncertainty =       0.001600944454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379572808
  error estimate for blocks of size 2^( 2) =       0.000390345580
  error estimate for blocks of size 2^( 3) =       0.000399819580
  error estimate for blocks of size 2^( 4) =       0.000406685111
  error estimate for blocks of size 2^( 5) =       0.000411196739
  error estimate for blocks of size 2^( 6) =       0.000413633546
  error estimate for blocks of size 2^( 7) =       0.000415444133

      target function =      -0.895354605075
              le_mean =     -17.215641924591
             les_mean =     296.683305551818
             stat err =       0.000411739882
             autocorr =       1.176672727450
   target nu stat err =       0.000411739882
   target dn stat err =       0.003202434547
      target stat err =       0.004044584944
              std dev =       0.536797012412
             le_variance =       0.288151032534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721564192459e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895372231446       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895372266812       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895372273401       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895372274887       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895372275015       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895372275026       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895372275027       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895372275013       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895372275012       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895372275010       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 8.504038e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895372231446       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895372240288       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895372241935       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895372242306       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895372242339       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895372242342       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895372242334       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895372242338       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895372242338       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895372242356       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.126050e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895372231446       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895372233657       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895372234069       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895372234161       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895372234037       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895372234121       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895372234202       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895372234191       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895372234078       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895372234124       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 5.315150e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.432314 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6629e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.052491e-02 3 1  ON 0
ci_002                -3.052633e-02 3 1  ON 1
ci_003                -2.507224e-02 3 1  ON 2
ci_004                 2.252127e-02 3 1  ON 3
ci_005                 2.297146e-02 3 1  ON 4
ci_006                -1.977249e-02 3 1  ON 5
ci_007                -1.974060e-02 3 1  ON 6
ci_008                -9.201299e-03 3 1  ON 7
ci_009                -1.487705e-02 3 1  ON 8
ci_010                -1.017665e-02 3 1  ON 9
ci_011                -1.047059e-02 3 1  ON 10
ci_012                -1.051513e-02 3 1  ON 11
ci_013                -2.011756e-02 3 1  ON 12
ci_014                 1.204506e-02 3 1  ON 13
ci_015                 1.232684e-02 3 1  ON 14
ci_016                 1.650004e-02 3 1  ON 15
ci_017                 1.634655e-02 3 1  ON 16
ci_018                 9.880342e-03 3 1  ON 17
ci_019                 1.026924e-02 3 1  ON 18
ci_020                 1.580102e-02 3 1  ON 19
ci_021                 1.592852e-02 3 1  ON 20
ci_022                 9.116339e-03 3 1  ON 21
ci_023                 9.116386e-03 3 1  ON 22
ci_024                 9.630207e-03 3 1  ON 23
ci_025                 9.595572e-03 3 1  ON 24
ci_026                 1.071646e-02 3 1  ON 25
ci_027                 1.103791e-02 3 1  ON 26
ci_028                -1.507582e-02 3 1  ON 27
ci_029                -1.569001e-02 3 1  ON 28
ci_030                -8.962317e-03 3 1  ON 29
ci_031                -9.353923e-03 3 1  ON 30
ci_032                -1.472879e-02 3 1  ON 31
ci_033                 6.273909e-03 3 1  ON 32
ci_034                 5.752279e-03 3 1  ON 33
ci_035                -4.283357e-03 3 1  ON 34
ci_036                -1.206338e-02 3 1  ON 35
ci_037                -1.231367e-02 3 1  ON 36
ci_038                 1.860574e-03 3 1  ON 37
ci_039                 2.121289e-03 3 1  ON 38
ci_040                -2.546611e-03 3 1  ON 39
ci_041                 8.528238e-03 3 1  ON 40
ci_042                 8.523361e-03 3 1  ON 41
ci_043                -3.220328e-03 3 1  ON 42
ci_044                -4.927313e-03 3 1  ON 43
ci_045                -2.763176e-03 3 1  ON 44
ci_046                 5.442225e-03 3 1  ON 45
ci_047                 5.455056e-03 3 1  ON 46
ci_048                -1.256019e-02 3 1  ON 47
ci_049                -1.273774e-02 3 1  ON 48
ci_050                 3.547185e-03 3 1  ON 49
ci_051                 3.500027e-03 3 1  ON 50
ci_052                -2.791406e-03 3 1  ON 51
ci_053                -2.829299e-03 3 1  ON 52
ci_054                -2.961012e-03 3 1  ON 53
ci_055                -3.227744e-03 3 1  ON 54
ci_056                 5.143262e-03 3 1  ON 55
ci_057                 5.323679e-03 3 1  ON 56
ci_058                -2.540341e-03 3 1  ON 57
ci_059                -2.495804e-03 3 1  ON 58
ci_060                 5.249191e-03 3 1  ON 59
ci_061                 5.938369e-03 3 1  ON 60
ci_062                -3.646771e-03 3 1  ON 61
ci_063                -3.706927e-03 3 1  ON 62
ci_064                -2.767268e-03 3 1  ON 63
ci_065                -3.793606e-03 3 1  ON 64
ci_066                 4.285539e-03 3 1  ON 65
ci_067                 4.385673e-03 3 1  ON 66
ci_068                -5.158224e-03 3 1  ON 67
ci_069                -4.482233e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.353863
====================================================
  Execution time = 1.3352e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9882e-01
  Total weights = 1.9572e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330454485
                                         uncertainty =       0.001490455362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330454485
                                         uncertainty =       0.001490455362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378984777
  error estimate for blocks of size 2^( 2) =       0.000389801698
  error estimate for blocks of size 2^( 3) =       0.000400364352
  error estimate for blocks of size 2^( 4) =       0.000408046662
  error estimate for blocks of size 2^( 5) =       0.000412747744
  error estimate for blocks of size 2^( 6) =       0.000415949330
  error estimate for blocks of size 2^( 7) =       0.000417280141

      target function =      -0.902935431268
              le_mean =     -17.214748729333
             les_mean =     296.646391296532
             stat err =       0.000413505969
             autocorr =       1.190474333327
   target nu stat err =       0.000413505969
   target dn stat err =       0.001946947792
      target stat err =       0.002539351501
              std dev =       0.535965410944
             le_variance =       0.287258921729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330380915
                                         uncertainty =       0.001490453319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330380915
                                         uncertainty =       0.001490453319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378984728
  error estimate for blocks of size 2^( 2) =       0.000389801660
  error estimate for blocks of size 2^( 3) =       0.000400364325
  error estimate for blocks of size 2^( 4) =       0.000408046645
  error estimate for blocks of size 2^( 5) =       0.000412747732
  error estimate for blocks of size 2^( 6) =       0.000415949323
  error estimate for blocks of size 2^( 7) =       0.000417280143

      target function =      -0.902935567477
              le_mean =     -17.214748729346
             les_mean =     296.646391189716
             stat err =       0.000413505961
             autocorr =       1.190474588096
   target nu stat err =       0.000413505961
   target dn stat err =       0.001946944641
      target stat err =       0.002539348349
              std dev =       0.535965342249
             le_variance =       0.287258848093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330417699
                                         uncertainty =       0.001490454340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330417699
                                         uncertainty =       0.001490454340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378984752
  error estimate for blocks of size 2^( 2) =       0.000389801679
  error estimate for blocks of size 2^( 3) =       0.000400364339
  error estimate for blocks of size 2^( 4) =       0.000408046653
  error estimate for blocks of size 2^( 5) =       0.000412747738
  error estimate for blocks of size 2^( 6) =       0.000415949326
  error estimate for blocks of size 2^( 7) =       0.000417280142

      target function =      -0.902935499379
              le_mean =     -17.214748729339
             les_mean =     296.646391243116
             stat err =       0.000413505965
             autocorr =       1.190474460721
   target nu stat err =       0.000413505965
   target dn stat err =       0.001946946216
      target stat err =       0.002539349925
              std dev =       0.535965376596
             le_variance =       0.287258884910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330449887
                                         uncertainty =       0.001490455235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287330449887
                                         uncertainty =       0.001490455235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378984774
  error estimate for blocks of size 2^( 2) =       0.000389801696
  error estimate for blocks of size 2^( 3) =       0.000400364350
  error estimate for blocks of size 2^( 4) =       0.000408046661
  error estimate for blocks of size 2^( 5) =       0.000412747744
  error estimate for blocks of size 2^( 6) =       0.000415949329
  error estimate for blocks of size 2^( 7) =       0.000417280141

      target function =      -0.902935439782
              le_mean =     -17.214748729334
             les_mean =     296.646391289854
             stat err =       0.000413505969
             autocorr =       1.190474349257
   target nu stat err =       0.000413505969
   target dn stat err =       0.001946947595
      target stat err =       0.002539351304
              std dev =       0.535965406651
             le_variance =       0.287258917126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902935431268        initial
     2.4414e+03     2.4414e+04             8.5040e-08        -0.902935567477  <--
     9.7656e+03     9.7656e+04             2.1261e-08        -0.902935499379
     3.9062e+04     3.9062e+05             5.3152e-09        -0.902935439782

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.2624e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.052485e-02 3 1  ON 0
ci_002                -3.052629e-02 3 1  ON 1
ci_003                -2.507220e-02 3 1  ON 2
ci_004                 2.252125e-02 3 1  ON 3
ci_005                 2.297144e-02 3 1  ON 4
ci_006                -1.977244e-02 3 1  ON 5
ci_007                -1.974056e-02 3 1  ON 6
ci_008                -9.201261e-03 3 1  ON 7
ci_009                -1.487703e-02 3 1  ON 8
ci_010                -1.017660e-02 3 1  ON 9
ci_011                -1.047055e-02 3 1  ON 10
ci_012                -1.051510e-02 3 1  ON 11
ci_013                -2.011755e-02 3 1  ON 12
ci_014                 1.204502e-02 3 1  ON 13
ci_015                 1.232679e-02 3 1  ON 14
ci_016                 1.650004e-02 3 1  ON 15
ci_017                 1.634652e-02 3 1  ON 16
ci_018                 9.880324e-03 3 1  ON 17
ci_019                 1.026921e-02 3 1  ON 18
ci_020                 1.580099e-02 3 1  ON 19
ci_021                 1.592848e-02 3 1  ON 20
ci_022                 9.116325e-03 3 1  ON 21
ci_023                 9.116364e-03 3 1  ON 22
ci_024                 9.630143e-03 3 1  ON 23
ci_025                 9.595547e-03 3 1  ON 24
ci_026                 1.071645e-02 3 1  ON 25
ci_027                 1.103788e-02 3 1  ON 26
ci_028                -1.507581e-02 3 1  ON 27
ci_029                -1.569000e-02 3 1  ON 28
ci_030                -8.962319e-03 3 1  ON 29
ci_031                -9.353895e-03 3 1  ON 30
ci_032                -1.472878e-02 3 1  ON 31
ci_033                 6.273868e-03 3 1  ON 32
ci_034                 5.752254e-03 3 1  ON 33
ci_035                -4.283342e-03 3 1  ON 34
ci_036                -1.206338e-02 3 1  ON 35
ci_037                -1.231364e-02 3 1  ON 36
ci_038                 1.860536e-03 3 1  ON 37
ci_039                 2.121260e-03 3 1  ON 38
ci_040                -2.546581e-03 3 1  ON 39
ci_041                 8.528247e-03 3 1  ON 40
ci_042                 8.523345e-03 3 1  ON 41
ci_043                -3.220303e-03 3 1  ON 42
ci_044                -4.927296e-03 3 1  ON 43
ci_045                -2.763150e-03 3 1  ON 44
ci_046                 5.442207e-03 3 1  ON 45
ci_047                 5.455031e-03 3 1  ON 46
ci_048                -1.256019e-02 3 1  ON 47
ci_049                -1.273776e-02 3 1  ON 48
ci_050                 3.547178e-03 3 1  ON 49
ci_051                 3.500018e-03 3 1  ON 50
ci_052                -2.791401e-03 3 1  ON 51
ci_053                -2.829287e-03 3 1  ON 52
ci_054                -2.961010e-03 3 1  ON 53
ci_055                -3.227725e-03 3 1  ON 54
ci_056                 5.143225e-03 3 1  ON 55
ci_057                 5.323662e-03 3 1  ON 56
ci_058                -2.540320e-03 3 1  ON 57
ci_059                -2.495801e-03 3 1  ON 58
ci_060                 5.249197e-03 3 1  ON 59
ci_061                 5.938357e-03 3 1  ON 60
ci_062                -3.646763e-03 3 1  ON 61
ci_063                -3.706917e-03 3 1  ON 62
ci_064                -2.767256e-03 3 1  ON 63
ci_065                -3.793602e-03 3 1  ON 64
ci_066                 4.285526e-03 3 1  ON 65
ci_067                 4.385649e-03 3 1  ON 66
ci_068                -5.158216e-03 3 1  ON 67
ci_069                -4.482250e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1762
    reference variance = 0.195757
====================================================
  Execution time = 1.3929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0365e-01
  Total weights = 1.957314678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288147664611
                                         uncertainty =       0.001917303471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288147664611
                                         uncertainty =       0.001917303471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379522832
  error estimate for blocks of size 2^( 2) =       0.000390139448
  error estimate for blocks of size 2^( 3) =       0.000399956372
  error estimate for blocks of size 2^( 4) =       0.000407285811
  error estimate for blocks of size 2^( 5) =       0.000410667063
  error estimate for blocks of size 2^( 6) =       0.000412716111
  error estimate for blocks of size 2^( 7) =       0.000414321844

      target function =      -0.896861555228
              le_mean =     -17.214874157575
             les_mean =     296.655539872456
             stat err =       0.000411247707
             autocorr =       1.174170493863
   target nu stat err =       0.000411247707
   target dn stat err =       0.003026001823
      target stat err =       0.003834428956
              std dev =       0.536726336532
             le_variance =       0.288075160327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721487415758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896877262818       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896877407618       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896877433781       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896877441922       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896877442309       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896877442511       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896877442550       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896877442524       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896877442522       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896877442522       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 3.248207e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896877262818       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896877299021       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896877305563       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896877307597       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896877307696       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896877307746       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896877307754       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896877307747       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896877307746       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896877307743       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 8.121134e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896877262818       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896877271869       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896877273504       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896877274017       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896877274005       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896877274050       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896877274052       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896877274061       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896877274039       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896877274063       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.030322e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6429e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.052479e-02 3 1  ON 0
ci_002                -3.052626e-02 3 1  ON 1
ci_003                -2.507213e-02 3 1  ON 2
ci_004                 2.252122e-02 3 1  ON 3
ci_005                 2.297144e-02 3 1  ON 4
ci_006                -1.977239e-02 3 1  ON 5
ci_007                -1.974050e-02 3 1  ON 6
ci_008                -9.201217e-03 3 1  ON 7
ci_009                -1.487703e-02 3 1  ON 8
ci_010                -1.017659e-02 3 1  ON 9
ci_011                -1.047051e-02 3 1  ON 10
ci_012                -1.051505e-02 3 1  ON 11
ci_013                -2.011754e-02 3 1  ON 12
ci_014                 1.204498e-02 3 1  ON 13
ci_015                 1.232671e-02 3 1  ON 14
ci_016                 1.650000e-02 3 1  ON 15
ci_017                 1.634650e-02 3 1  ON 16
ci_018                 9.880311e-03 3 1  ON 17
ci_019                 1.026915e-02 3 1  ON 18
ci_020                 1.580098e-02 3 1  ON 19
ci_021                 1.592842e-02 3 1  ON 20
ci_022                 9.116296e-03 3 1  ON 21
ci_023                 9.116344e-03 3 1  ON 22
ci_024                 9.630129e-03 3 1  ON 23
ci_025                 9.595465e-03 3 1  ON 24
ci_026                 1.071642e-02 3 1  ON 25
ci_027                 1.103782e-02 3 1  ON 26
ci_028                -1.507581e-02 3 1  ON 27
ci_029                -1.568998e-02 3 1  ON 28
ci_030                -8.962333e-03 3 1  ON 29
ci_031                -9.353840e-03 3 1  ON 30
ci_032                -1.472874e-02 3 1  ON 31
ci_033                 6.273816e-03 3 1  ON 32
ci_034                 5.752268e-03 3 1  ON 33
ci_035                -4.283319e-03 3 1  ON 34
ci_036                -1.206337e-02 3 1  ON 35
ci_037                -1.231361e-02 3 1  ON 36
ci_038                 1.860506e-03 3 1  ON 37
ci_039                 2.121232e-03 3 1  ON 38
ci_040                -2.546541e-03 3 1  ON 39
ci_041                 8.528225e-03 3 1  ON 40
ci_042                 8.523360e-03 3 1  ON 41
ci_043                -3.220267e-03 3 1  ON 42
ci_044                -4.927298e-03 3 1  ON 43
ci_045                -2.763128e-03 3 1  ON 44
ci_046                 5.442196e-03 3 1  ON 45
ci_047                 5.454999e-03 3 1  ON 46
ci_048                -1.256018e-02 3 1  ON 47
ci_049                -1.273775e-02 3 1  ON 48
ci_050                 3.547138e-03 3 1  ON 49
ci_051                 3.499999e-03 3 1  ON 50
ci_052                -2.791386e-03 3 1  ON 51
ci_053                -2.829285e-03 3 1  ON 52
ci_054                -2.960988e-03 3 1  ON 53
ci_055                -3.227706e-03 3 1  ON 54
ci_056                 5.143207e-03 3 1  ON 55
ci_057                 5.323657e-03 3 1  ON 56
ci_058                -2.540289e-03 3 1  ON 57
ci_059                -2.495793e-03 3 1  ON 58
ci_060                 5.249152e-03 3 1  ON 59
ci_061                 5.938361e-03 3 1  ON 60
ci_062                -3.646742e-03 3 1  ON 61
ci_063                -3.706906e-03 3 1  ON 62
ci_064                -2.767231e-03 3 1  ON 63
ci_065                -3.793581e-03 3 1  ON 64
ci_066                 4.285507e-03 3 1  ON 65
ci_067                 4.385655e-03 3 1  ON 66
ci_068                -5.158178e-03 3 1  ON 67
ci_069                -4.482232e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.3055
    reference variance = 0.316078
====================================================
  Execution time = 1.3410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0005e-01
  Total weights = 1.9572e+06
  Execution time = 1.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418831715
                                         uncertainty =       0.001864588061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418831715
                                         uncertainty =       0.001864588061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378500784
  error estimate for blocks of size 2^( 2) =       0.000389423973
  error estimate for blocks of size 2^( 3) =       0.000398577600
  error estimate for blocks of size 2^( 4) =       0.000405637548
  error estimate for blocks of size 2^( 5) =       0.000410398569
  error estimate for blocks of size 2^( 6) =       0.000412796869
  error estimate for blocks of size 2^( 7) =       0.000414440902

      target function =      -0.901465570677
              le_mean =     -17.215202257957
             les_mean =     296.663236079126
             stat err =       0.000410818472
             autocorr =       1.178057150905
   target nu stat err =       0.000410818472
   target dn stat err =       0.003179655530
      target stat err =       0.004067874634
              std dev =       0.535280941427
             le_variance =       0.286525686255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418481365
                                         uncertainty =       0.001864536340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418481365
                                         uncertainty =       0.001864536340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378500551
  error estimate for blocks of size 2^( 2) =       0.000389423780
  error estimate for blocks of size 2^( 3) =       0.000398577450
  error estimate for blocks of size 2^( 4) =       0.000405637428
  error estimate for blocks of size 2^( 5) =       0.000410398477
  error estimate for blocks of size 2^( 6) =       0.000412796773
  error estimate for blocks of size 2^( 7) =       0.000414440780

      target function =      -0.901466054654
              le_mean =     -17.215202258350
             les_mean =     296.663235710529
             stat err =       0.000410818365
             autocorr =       1.178057983331
   target nu stat err =       0.000410818365
   target dn stat err =       0.003179658785
      target stat err =       0.004067883020
              std dev =       0.535280612691
             le_variance =       0.286525334323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418656519
                                         uncertainty =       0.001864562198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418656519
                                         uncertainty =       0.001864562198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378500667
  error estimate for blocks of size 2^( 2) =       0.000389423876
  error estimate for blocks of size 2^( 3) =       0.000398577525
  error estimate for blocks of size 2^( 4) =       0.000405637488
  error estimate for blocks of size 2^( 5) =       0.000410398523
  error estimate for blocks of size 2^( 6) =       0.000412796821
  error estimate for blocks of size 2^( 7) =       0.000414440841

      target function =      -0.901465812772
              le_mean =     -17.215202258152
             les_mean =     296.663235894717
             stat err =       0.000410818418
             autocorr =       1.178057567155
   target nu stat err =       0.000410818418
   target dn stat err =       0.003179657155
      target stat err =       0.004067878825
              std dev =       0.535280777039
             le_variance =       0.286525510268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418809815
                                         uncertainty =       0.001864584828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286418809815
                                         uncertainty =       0.001864584828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378500769
  error estimate for blocks of size 2^( 2) =       0.000389423961
  error estimate for blocks of size 2^( 3) =       0.000398577590
  error estimate for blocks of size 2^( 4) =       0.000405637540
  error estimate for blocks of size 2^( 5) =       0.000410398563
  error estimate for blocks of size 2^( 6) =       0.000412796863
  error estimate for blocks of size 2^( 7) =       0.000414440895

      target function =      -0.901465600949
              le_mean =     -17.215202257981
             les_mean =     296.663236056064
             stat err =       0.000410818465
             autocorr =       1.178057202943
   target nu stat err =       0.000410818465
   target dn stat err =       0.003179655732
      target stat err =       0.004067875158
              std dev =       0.535280920877
             le_variance =       0.286525664255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901465570677        initial
     6.1035e+02     6.1035e+03             3.2482e-07        -0.901466054654  <--
     2.4414e+03     2.4414e+04             8.1211e-08        -0.901465812772
     9.7656e+03     9.7656e+04             2.0303e-08        -0.901465600949

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.2662e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.052460e-02 3 1  ON 0
ci_002                -3.052616e-02 3 1  ON 1
ci_003                -2.507192e-02 3 1  ON 2
ci_004                 2.252113e-02 3 1  ON 3
ci_005                 2.297143e-02 3 1  ON 4
ci_006                -1.977222e-02 3 1  ON 5
ci_007                -1.974034e-02 3 1  ON 6
ci_008                -9.201086e-03 3 1  ON 7
ci_009                -1.487702e-02 3 1  ON 8
ci_010                -1.017655e-02 3 1  ON 9
ci_011                -1.047039e-02 3 1  ON 10
ci_012                -1.051489e-02 3 1  ON 11
ci_013                -2.011749e-02 3 1  ON 12
ci_014                 1.204487e-02 3 1  ON 13
ci_015                 1.232647e-02 3 1  ON 14
ci_016                 1.649988e-02 3 1  ON 15
ci_017                 1.634642e-02 3 1  ON 16
ci_018                 9.880271e-03 3 1  ON 17
ci_019                 1.026899e-02 3 1  ON 18
ci_020                 1.580094e-02 3 1  ON 19
ci_021                 1.592824e-02 3 1  ON 20
ci_022                 9.116208e-03 3 1  ON 21
ci_023                 9.116283e-03 3 1  ON 22
ci_024                 9.630086e-03 3 1  ON 23
ci_025                 9.595222e-03 3 1  ON 24
ci_026                 1.071635e-02 3 1  ON 25
ci_027                 1.103763e-02 3 1  ON 26
ci_028                -1.507580e-02 3 1  ON 27
ci_029                -1.568994e-02 3 1  ON 28
ci_030                -8.962374e-03 3 1  ON 29
ci_031                -9.353677e-03 3 1  ON 30
ci_032                -1.472861e-02 3 1  ON 31
ci_033                 6.273659e-03 3 1  ON 32
ci_034                 5.752309e-03 3 1  ON 33
ci_035                -4.283249e-03 3 1  ON 34
ci_036                -1.206334e-02 3 1  ON 35
ci_037                -1.231351e-02 3 1  ON 36
ci_038                 1.860415e-03 3 1  ON 37
ci_039                 2.121149e-03 3 1  ON 38
ci_040                -2.546424e-03 3 1  ON 39
ci_041                 8.528158e-03 3 1  ON 40
ci_042                 8.523405e-03 3 1  ON 41
ci_043                -3.220158e-03 3 1  ON 42
ci_044                -4.927302e-03 3 1  ON 43
ci_045                -2.763059e-03 3 1  ON 44
ci_046                 5.442165e-03 3 1  ON 45
ci_047                 5.454902e-03 3 1  ON 46
ci_048                -1.256015e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547017e-03 3 1  ON 49
ci_051                 3.499941e-03 3 1  ON 50
ci_052                -2.791341e-03 3 1  ON 51
ci_053                -2.829279e-03 3 1  ON 52
ci_054                -2.960922e-03 3 1  ON 53
ci_055                -3.227648e-03 3 1  ON 54
ci_056                 5.143156e-03 3 1  ON 55
ci_057                 5.323643e-03 3 1  ON 56
ci_058                -2.540194e-03 3 1  ON 57
ci_059                -2.495771e-03 3 1  ON 58
ci_060                 5.249014e-03 3 1  ON 59
ci_061                 5.938374e-03 3 1  ON 60
ci_062                -3.646679e-03 3 1  ON 61
ci_063                -3.706875e-03 3 1  ON 62
ci_064                -2.767155e-03 3 1  ON 63
ci_065                -3.793521e-03 3 1  ON 64
ci_066                 4.285452e-03 3 1  ON 65
ci_067                 4.385673e-03 3 1  ON 66
ci_068                -5.158063e-03 3 1  ON 67
ci_069                -4.482178e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9103e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.145762
====================================================
  Execution time = 1.4189e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5333e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.957414188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286134512301
                                         uncertainty =       0.001633536528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286134512301
                                         uncertainty =       0.001633536528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378205683
  error estimate for blocks of size 2^( 2) =       0.000389205126
  error estimate for blocks of size 2^( 3) =       0.000399505526
  error estimate for blocks of size 2^( 4) =       0.000406654031
  error estimate for blocks of size 2^( 5) =       0.000411420007
  error estimate for blocks of size 2^( 6) =       0.000412975868
  error estimate for blocks of size 2^( 7) =       0.000414710350

      target function =      -0.900614150186
              le_mean =     -17.214827208131
             les_mean =     296.650936094626
             stat err =       0.000411440064
             autocorr =       1.183469463869
   target nu stat err =       0.000411440064
   target dn stat err =       0.002569624710
      target stat err =       0.003297019289
              std dev =       0.534863606121
             le_variance =       0.286079077153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721482720813e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900625396801       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900626153397       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900626272154       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900626301296       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900626307544       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900626306988       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900626307304       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900626307362       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900626307323       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900626307278       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+02 is 1.681616e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900625396801       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900625586022       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900625615719       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900625623007       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900625624568       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900625624429       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900625624508       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900625624523       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900625624511       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900625624501       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+02 is 4.205271e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900625396801       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900625444110       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900625451535       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900625453357       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900625453747       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900625453713       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900625453732       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900625453733       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900625453733       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900625453732       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+03 is 1.051395e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6679e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.052418e-02 3 1  ON 0
ci_002                -3.052602e-02 3 1  ON 1
ci_003                -2.507173e-02 3 1  ON 2
ci_004                 2.252098e-02 3 1  ON 3
ci_005                 2.297127e-02 3 1  ON 4
ci_006                -1.977203e-02 3 1  ON 5
ci_007                -1.974021e-02 3 1  ON 6
ci_008                -9.200982e-03 3 1  ON 7
ci_009                -1.487684e-02 3 1  ON 8
ci_010                -1.017639e-02 3 1  ON 9
ci_011                -1.047023e-02 3 1  ON 10
ci_012                -1.051466e-02 3 1  ON 11
ci_013                -2.011725e-02 3 1  ON 12
ci_014                 1.204466e-02 3 1  ON 13
ci_015                 1.232629e-02 3 1  ON 14
ci_016                 1.649971e-02 3 1  ON 15
ci_017                 1.634627e-02 3 1  ON 16
ci_018                 9.880170e-03 3 1  ON 17
ci_019                 1.026888e-02 3 1  ON 18
ci_020                 1.580076e-02 3 1  ON 19
ci_021                 1.592810e-02 3 1  ON 20
ci_022                 9.116140e-03 3 1  ON 21
ci_023                 9.116286e-03 3 1  ON 22
ci_024                 9.630261e-03 3 1  ON 23
ci_025                 9.595164e-03 3 1  ON 24
ci_026                 1.071630e-02 3 1  ON 25
ci_027                 1.103746e-02 3 1  ON 26
ci_028                -1.507572e-02 3 1  ON 27
ci_029                -1.568975e-02 3 1  ON 28
ci_030                -8.962294e-03 3 1  ON 29
ci_031                -9.353410e-03 3 1  ON 30
ci_032                -1.472846e-02 3 1  ON 31
ci_033                 6.273603e-03 3 1  ON 32
ci_034                 5.752181e-03 3 1  ON 33
ci_035                -4.283158e-03 3 1  ON 34
ci_036                -1.206327e-02 3 1  ON 35
ci_037                -1.231330e-02 3 1  ON 36
ci_038                 1.860307e-03 3 1  ON 37
ci_039                 2.121006e-03 3 1  ON 38
ci_040                -2.546305e-03 3 1  ON 39
ci_041                 8.528149e-03 3 1  ON 40
ci_042                 8.523276e-03 3 1  ON 41
ci_043                -3.220029e-03 3 1  ON 42
ci_044                -4.927189e-03 3 1  ON 43
ci_045                -2.762910e-03 3 1  ON 44
ci_046                 5.442017e-03 3 1  ON 45
ci_047                 5.454797e-03 3 1  ON 46
ci_048                -1.256014e-02 3 1  ON 47
ci_049                -1.273773e-02 3 1  ON 48
ci_050                 3.546926e-03 3 1  ON 49
ci_051                 3.499924e-03 3 1  ON 50
ci_052                -2.791356e-03 3 1  ON 51
ci_053                -2.829180e-03 3 1  ON 52
ci_054                -2.960905e-03 3 1  ON 53
ci_055                -3.227500e-03 3 1  ON 54
ci_056                 5.143060e-03 3 1  ON 55
ci_057                 5.323488e-03 3 1  ON 56
ci_058                -2.540161e-03 3 1  ON 57
ci_059                -2.495471e-03 3 1  ON 58
ci_060                 5.249043e-03 3 1  ON 59
ci_061                 5.938213e-03 3 1  ON 60
ci_062                -3.646364e-03 3 1  ON 61
ci_063                -3.706739e-03 3 1  ON 62
ci_064                -2.767058e-03 3 1  ON 63
ci_065                -3.793423e-03 3 1  ON 64
ci_066                 4.285501e-03 3 1  ON 65
ci_067                 4.385583e-03 3 1  ON 66
ci_068                -5.157934e-03 3 1  ON 67
ci_069                -4.482192e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2007
    reference variance = 1.18959
====================================================
  Execution time = 1.3506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9531e-01
  Total weights = 1.9577e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778085431
                                         uncertainty =       0.001680766301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778085431
                                         uncertainty =       0.001680766301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377324046
  error estimate for blocks of size 2^( 2) =       0.000388567190
  error estimate for blocks of size 2^( 3) =       0.000398649430
  error estimate for blocks of size 2^( 4) =       0.000406102462
  error estimate for blocks of size 2^( 5) =       0.000410835532
  error estimate for blocks of size 2^( 6) =       0.000414097691
  error estimate for blocks of size 2^( 7) =       0.000414752128

      target function =      -0.907561985722
              le_mean =     -17.215407948782
             les_mean =     296.665582211564
             stat err =       0.000411446953
             autocorr =       1.189046221015
   target nu stat err =       0.000411446953
   target dn stat err =       0.002021865351
      target stat err =       0.002660508423
              std dev =       0.533616782978
             le_variance =       0.284746871076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777035614
                                         uncertainty =       0.001680736501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777035614
                                         uncertainty =       0.001680736501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377323351
  error estimate for blocks of size 2^( 2) =       0.000388566631
  error estimate for blocks of size 2^( 3) =       0.000398649061
  error estimate for blocks of size 2^( 4) =       0.000406102220
  error estimate for blocks of size 2^( 5) =       0.000410835332
  error estimate for blocks of size 2^( 6) =       0.000414097530
  error estimate for blocks of size 2^( 7) =       0.000414751988

      target function =      -0.907558939723
              le_mean =     -17.215407987222
             les_mean =     296.665585913848
             stat err =       0.000411446767
             autocorr =       1.189049524157
   target nu stat err =       0.000411446767
   target dn stat err =       0.002021958491
      target stat err =       0.002660607788
              std dev =       0.533615800334
             le_variance =       0.284745822366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777560240
                                         uncertainty =       0.001680751395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284777560240
                                         uncertainty =       0.001680751395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377323698
  error estimate for blocks of size 2^( 2) =       0.000388566910
  error estimate for blocks of size 2^( 3) =       0.000398649246
  error estimate for blocks of size 2^( 4) =       0.000406102341
  error estimate for blocks of size 2^( 5) =       0.000410835432
  error estimate for blocks of size 2^( 6) =       0.000414097610
  error estimate for blocks of size 2^( 7) =       0.000414752058

      target function =      -0.907560514732
              le_mean =     -17.215407967991
             les_mean =     296.665584021851
             stat err =       0.000411446860
             autocorr =       1.189047873123
   target nu stat err =       0.000411446860
   target dn stat err =       0.002021910402
      target stat err =       0.002660556500
              std dev =       0.533616291391
             le_variance =       0.284746346438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778019765
                                         uncertainty =       0.001680764437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284778019765
                                         uncertainty =       0.001680764437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377324002
  error estimate for blocks of size 2^( 2) =       0.000388567155
  error estimate for blocks of size 2^( 3) =       0.000398649407
  error estimate for blocks of size 2^( 4) =       0.000406102447
  error estimate for blocks of size 2^( 5) =       0.000410835520
  error estimate for blocks of size 2^( 6) =       0.000414097681
  error estimate for blocks of size 2^( 7) =       0.000414752119

      target function =      -0.907561807368
              le_mean =     -17.215407951181
             les_mean =     296.665582433496
             stat err =       0.000411446942
             autocorr =       1.189046427541
   target nu stat err =       0.000411446942
   target dn stat err =       0.002021870824
      target stat err =       0.002660514267
              std dev =       0.533616721514
             le_variance =       0.284746805480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907561985722        initial  <--
     1.5259e+02     1.5259e+03             1.6816e-06        -0.907558939723
     6.1035e+02     6.1035e+03             4.2053e-07        -0.907560514732
     2.4414e+03     2.4414e+04             1.0514e-07        -0.907561807368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7826
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.052460e-02 3 1  ON 0
ci_002                -3.052616e-02 3 1  ON 1
ci_003                -2.507192e-02 3 1  ON 2
ci_004                 2.252113e-02 3 1  ON 3
ci_005                 2.297143e-02 3 1  ON 4
ci_006                -1.977222e-02 3 1  ON 5
ci_007                -1.974034e-02 3 1  ON 6
ci_008                -9.201086e-03 3 1  ON 7
ci_009                -1.487702e-02 3 1  ON 8
ci_010                -1.017655e-02 3 1  ON 9
ci_011                -1.047039e-02 3 1  ON 10
ci_012                -1.051489e-02 3 1  ON 11
ci_013                -2.011749e-02 3 1  ON 12
ci_014                 1.204487e-02 3 1  ON 13
ci_015                 1.232647e-02 3 1  ON 14
ci_016                 1.649988e-02 3 1  ON 15
ci_017                 1.634642e-02 3 1  ON 16
ci_018                 9.880271e-03 3 1  ON 17
ci_019                 1.026899e-02 3 1  ON 18
ci_020                 1.580094e-02 3 1  ON 19
ci_021                 1.592824e-02 3 1  ON 20
ci_022                 9.116208e-03 3 1  ON 21
ci_023                 9.116283e-03 3 1  ON 22
ci_024                 9.630086e-03 3 1  ON 23
ci_025                 9.595222e-03 3 1  ON 24
ci_026                 1.071635e-02 3 1  ON 25
ci_027                 1.103763e-02 3 1  ON 26
ci_028                -1.507580e-02 3 1  ON 27
ci_029                -1.568994e-02 3 1  ON 28
ci_030                -8.962374e-03 3 1  ON 29
ci_031                -9.353677e-03 3 1  ON 30
ci_032                -1.472861e-02 3 1  ON 31
ci_033                 6.273659e-03 3 1  ON 32
ci_034                 5.752309e-03 3 1  ON 33
ci_035                -4.283249e-03 3 1  ON 34
ci_036                -1.206334e-02 3 1  ON 35
ci_037                -1.231351e-02 3 1  ON 36
ci_038                 1.860415e-03 3 1  ON 37
ci_039                 2.121149e-03 3 1  ON 38
ci_040                -2.546424e-03 3 1  ON 39
ci_041                 8.528158e-03 3 1  ON 40
ci_042                 8.523405e-03 3 1  ON 41
ci_043                -3.220158e-03 3 1  ON 42
ci_044                -4.927302e-03 3 1  ON 43
ci_045                -2.763059e-03 3 1  ON 44
ci_046                 5.442165e-03 3 1  ON 45
ci_047                 5.454902e-03 3 1  ON 46
ci_048                -1.256015e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547017e-03 3 1  ON 49
ci_051                 3.499941e-03 3 1  ON 50
ci_052                -2.791341e-03 3 1  ON 51
ci_053                -2.829279e-03 3 1  ON 52
ci_054                -2.960922e-03 3 1  ON 53
ci_055                -3.227648e-03 3 1  ON 54
ci_056                 5.143156e-03 3 1  ON 55
ci_057                 5.323643e-03 3 1  ON 56
ci_058                -2.540194e-03 3 1  ON 57
ci_059                -2.495771e-03 3 1  ON 58
ci_060                 5.249014e-03 3 1  ON 59
ci_061                 5.938374e-03 3 1  ON 60
ci_062                -3.646679e-03 3 1  ON 61
ci_063                -3.706875e-03 3 1  ON 62
ci_064                -2.767155e-03 3 1  ON 63
ci_065                -3.793521e-03 3 1  ON 64
ci_066                 4.285452e-03 3 1  ON 65
ci_067                 4.385673e-03 3 1  ON 66
ci_068                -5.158063e-03 3 1  ON 67
ci_069                -4.482178e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1573
    reference variance = 0.259001
====================================================
  Execution time = 1.3770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0316e-01
  Total weights = 1.957190450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287375074393
                                         uncertainty =       0.001644269375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287375074393
                                         uncertainty =       0.001644269375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379027733
  error estimate for blocks of size 2^( 2) =       0.000390102548
  error estimate for blocks of size 2^( 3) =       0.000399837238
  error estimate for blocks of size 2^( 4) =       0.000407272742
  error estimate for blocks of size 2^( 5) =       0.000412955806
  error estimate for blocks of size 2^( 6) =       0.000414864761
  error estimate for blocks of size 2^( 7) =       0.000414975949

      target function =      -0.897480243127
              le_mean =     -17.214909090760
             les_mean =     296.656258431244
             stat err =       0.000412517314
             autocorr =       1.184519969654
   target nu stat err =       0.000412517314
   target dn stat err =       0.002596271917
      target stat err =       0.003308063808
              std dev =       0.536026160976
             le_variance =       0.287324045251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721490909076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897491738957       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897491792711       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897491803247       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897491806380       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897491806446       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897491806511       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897491806482       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897491806493       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897491806491       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897491806487       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.469436e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897491738957       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897491752396       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897491755030       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897491755813       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897491755829       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897491755837       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897491755830       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897491755840       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897491755831       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897491755840       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 3.673694e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897491738957       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897491742317       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897491742975       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897491743171       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897491743168       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897491743184       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897491743176       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897491743131       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897491743185       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897491743258       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 9.184300e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6264e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.052456e-02 3 1  ON 0
ci_002                -3.052613e-02 3 1  ON 1
ci_003                -2.507190e-02 3 1  ON 2
ci_004                 2.252112e-02 3 1  ON 3
ci_005                 2.297140e-02 3 1  ON 4
ci_006                -1.977220e-02 3 1  ON 5
ci_007                -1.974032e-02 3 1  ON 6
ci_008                -9.201069e-03 3 1  ON 7
ci_009                -1.487700e-02 3 1  ON 8
ci_010                -1.017652e-02 3 1  ON 9
ci_011                -1.047037e-02 3 1  ON 10
ci_012                -1.051487e-02 3 1  ON 11
ci_013                -2.011748e-02 3 1  ON 12
ci_014                 1.204487e-02 3 1  ON 13
ci_015                 1.232646e-02 3 1  ON 14
ci_016                 1.649989e-02 3 1  ON 15
ci_017                 1.634641e-02 3 1  ON 16
ci_018                 9.880264e-03 3 1  ON 17
ci_019                 1.026897e-02 3 1  ON 18
ci_020                 1.580092e-02 3 1  ON 19
ci_021                 1.592823e-02 3 1  ON 20
ci_022                 9.116206e-03 3 1  ON 21
ci_023                 9.116264e-03 3 1  ON 22
ci_024                 9.630084e-03 3 1  ON 23
ci_025                 9.595210e-03 3 1  ON 24
ci_026                 1.071633e-02 3 1  ON 25
ci_027                 1.103762e-02 3 1  ON 26
ci_028                -1.507580e-02 3 1  ON 27
ci_029                -1.568993e-02 3 1  ON 28
ci_030                -8.962374e-03 3 1  ON 29
ci_031                -9.353662e-03 3 1  ON 30
ci_032                -1.472861e-02 3 1  ON 31
ci_033                 6.273644e-03 3 1  ON 32
ci_034                 5.752298e-03 3 1  ON 33
ci_035                -4.283239e-03 3 1  ON 34
ci_036                -1.206334e-02 3 1  ON 35
ci_037                -1.231349e-02 3 1  ON 36
ci_038                 1.860403e-03 3 1  ON 37
ci_039                 2.121138e-03 3 1  ON 38
ci_040                -2.546416e-03 3 1  ON 39
ci_041                 8.528147e-03 3 1  ON 40
ci_042                 8.523403e-03 3 1  ON 41
ci_043                -3.220144e-03 3 1  ON 42
ci_044                -4.927297e-03 3 1  ON 43
ci_045                -2.763050e-03 3 1  ON 44
ci_046                 5.442155e-03 3 1  ON 45
ci_047                 5.454899e-03 3 1  ON 46
ci_048                -1.256017e-02 3 1  ON 47
ci_049                -1.273772e-02 3 1  ON 48
ci_050                 3.547006e-03 3 1  ON 49
ci_051                 3.499940e-03 3 1  ON 50
ci_052                -2.791329e-03 3 1  ON 51
ci_053                -2.829273e-03 3 1  ON 52
ci_054                -2.960913e-03 3 1  ON 53
ci_055                -3.227640e-03 3 1  ON 54
ci_056                 5.143157e-03 3 1  ON 55
ci_057                 5.323629e-03 3 1  ON 56
ci_058                -2.540194e-03 3 1  ON 57
ci_059                -2.495756e-03 3 1  ON 58
ci_060                 5.249007e-03 3 1  ON 59
ci_061                 5.938364e-03 3 1  ON 60
ci_062                -3.646656e-03 3 1  ON 61
ci_063                -3.706868e-03 3 1  ON 62
ci_064                -2.767150e-03 3 1  ON 63
ci_065                -3.793517e-03 3 1  ON 64
ci_066                 4.285447e-03 3 1  ON 65
ci_067                 4.385663e-03 3 1  ON 66
ci_068                -5.158051e-03 3 1  ON 67
ci_069                -4.482186e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2566
    reference variance = 0.272947
====================================================
  Execution time = 1.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0047e-01
  Total weights = 1.9574e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051613407
                                         uncertainty =       0.001987059216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051613407
                                         uncertainty =       0.001987059216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379502035
  error estimate for blocks of size 2^( 2) =       0.000390369934
  error estimate for blocks of size 2^( 3) =       0.000400258753
  error estimate for blocks of size 2^( 4) =       0.000408036703
  error estimate for blocks of size 2^( 5) =       0.000411797208
  error estimate for blocks of size 2^( 6) =       0.000414283658
  error estimate for blocks of size 2^( 7) =       0.000415424376

      target function =      -0.900845188219
              le_mean =     -17.214812258537
             les_mean =     296.650235879462
             stat err =       0.000412385486
             autocorr =       1.180805932047
   target nu stat err =       0.000412385486
   target dn stat err =       0.002575369226
      target stat err =       0.003305989138
              std dev =       0.536696924627
             le_variance =       0.288043588904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051506313
                                         uncertainty =       0.001987054653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051506313
                                         uncertainty =       0.001987054653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379501964
  error estimate for blocks of size 2^( 2) =       0.000390369879
  error estimate for blocks of size 2^( 3) =       0.000400258718
  error estimate for blocks of size 2^( 4) =       0.000408036682
  error estimate for blocks of size 2^( 5) =       0.000411797195
  error estimate for blocks of size 2^( 6) =       0.000414283648
  error estimate for blocks of size 2^( 7) =       0.000415424370

      target function =      -0.900845305687
              le_mean =     -17.214812261401
             les_mean =     296.650235885657
             stat err =       0.000412385474
             autocorr =       1.180806297833
   target nu stat err =       0.000412385474
   target dn stat err =       0.002575364092
      target stat err =       0.003305983610
              std dev =       0.536696825031
             le_variance =       0.288043481998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051559857
                                         uncertainty =       0.001987056935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051559857
                                         uncertainty =       0.001987056935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379502000
  error estimate for blocks of size 2^( 2) =       0.000390369907
  error estimate for blocks of size 2^( 3) =       0.000400258736
  error estimate for blocks of size 2^( 4) =       0.000408036692
  error estimate for blocks of size 2^( 5) =       0.000411797201
  error estimate for blocks of size 2^( 6) =       0.000414283653
  error estimate for blocks of size 2^( 7) =       0.000415424373

      target function =      -0.900845246965
              le_mean =     -17.214812259969
             les_mean =     296.650235882548
             stat err =       0.000412385480
             autocorr =       1.180806114949
   target nu stat err =       0.000412385480
   target dn stat err =       0.002575366659
      target stat err =       0.003305986374
              std dev =       0.536696874826
             le_variance =       0.288043535449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051606713
                                         uncertainty =       0.001987058931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051606713
                                         uncertainty =       0.001987058931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379502030
  error estimate for blocks of size 2^( 2) =       0.000390369931
  error estimate for blocks of size 2^( 3) =       0.000400258751
  error estimate for blocks of size 2^( 4) =       0.000408036701
  error estimate for blocks of size 2^( 5) =       0.000411797207
  error estimate for blocks of size 2^( 6) =       0.000414283658
  error estimate for blocks of size 2^( 7) =       0.000415424376

      target function =      -0.900845195564
              le_mean =     -17.214812258716
             les_mean =     296.650235879846
             stat err =       0.000412385485
             autocorr =       1.180805954919
   target nu stat err =       0.000412385485
   target dn stat err =       0.002575368905
      target stat err =       0.003305988792
              std dev =       0.536696918402
             le_variance =       0.288043582222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900845188219        initial
     1.5259e+03     1.5259e+04             1.4694e-07        -0.900845305687  <--
     6.1035e+03     6.1035e+04             3.6737e-08        -0.900845246965
     2.4414e+04     2.4414e+05             9.1843e-09        -0.900845195564

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.2820e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.052445e-02 3 1  ON 0
ci_002                -3.052605e-02 3 1  ON 1
ci_003                -2.507183e-02 3 1  ON 2
ci_004                 2.252107e-02 3 1  ON 3
ci_005                 2.297130e-02 3 1  ON 4
ci_006                -1.977214e-02 3 1  ON 5
ci_007                -1.974026e-02 3 1  ON 6
ci_008                -9.201018e-03 3 1  ON 7
ci_009                -1.487696e-02 3 1  ON 8
ci_010                -1.017645e-02 3 1  ON 9
ci_011                -1.047030e-02 3 1  ON 10
ci_012                -1.051482e-02 3 1  ON 11
ci_013                -2.011743e-02 3 1  ON 12
ci_014                 1.204486e-02 3 1  ON 13
ci_015                 1.232641e-02 3 1  ON 14
ci_016                 1.649991e-02 3 1  ON 15
ci_017                 1.634637e-02 3 1  ON 16
ci_018                 9.880242e-03 3 1  ON 17
ci_019                 1.026892e-02 3 1  ON 18
ci_020                 1.580088e-02 3 1  ON 19
ci_021                 1.592821e-02 3 1  ON 20
ci_022                 9.116198e-03 3 1  ON 21
ci_023                 9.116207e-03 3 1  ON 22
ci_024                 9.630077e-03 3 1  ON 23
ci_025                 9.595175e-03 3 1  ON 24
ci_026                 1.071625e-02 3 1  ON 25
ci_027                 1.103758e-02 3 1  ON 26
ci_028                -1.507580e-02 3 1  ON 27
ci_029                -1.568991e-02 3 1  ON 28
ci_030                -8.962376e-03 3 1  ON 29
ci_031                -9.353617e-03 3 1  ON 30
ci_032                -1.472860e-02 3 1  ON 31
ci_033                 6.273598e-03 3 1  ON 32
ci_034                 5.752264e-03 3 1  ON 33
ci_035                -4.283211e-03 3 1  ON 34
ci_036                -1.206332e-02 3 1  ON 35
ci_037                -1.231342e-02 3 1  ON 36
ci_038                 1.860367e-03 3 1  ON 37
ci_039                 2.121104e-03 3 1  ON 38
ci_040                -2.546393e-03 3 1  ON 39
ci_041                 8.528112e-03 3 1  ON 40
ci_042                 8.523400e-03 3 1  ON 41
ci_043                -3.220100e-03 3 1  ON 42
ci_044                -4.927280e-03 3 1  ON 43
ci_045                -2.763023e-03 3 1  ON 44
ci_046                 5.442127e-03 3 1  ON 45
ci_047                 5.454893e-03 3 1  ON 46
ci_048                -1.256023e-02 3 1  ON 47
ci_049                -1.273774e-02 3 1  ON 48
ci_050                 3.546972e-03 3 1  ON 49
ci_051                 3.499936e-03 3 1  ON 50
ci_052                -2.791291e-03 3 1  ON 51
ci_053                -2.829257e-03 3 1  ON 52
ci_054                -2.960885e-03 3 1  ON 53
ci_055                -3.227616e-03 3 1  ON 54
ci_056                 5.143159e-03 3 1  ON 55
ci_057                 5.323589e-03 3 1  ON 56
ci_058                -2.540191e-03 3 1  ON 57
ci_059                -2.495712e-03 3 1  ON 58
ci_060                 5.248984e-03 3 1  ON 59
ci_061                 5.938335e-03 3 1  ON 60
ci_062                -3.646588e-03 3 1  ON 61
ci_063                -3.706844e-03 3 1  ON 62
ci_064                -2.767137e-03 3 1  ON 63
ci_065                -3.793505e-03 3 1  ON 64
ci_066                 4.285432e-03 3 1  ON 65
ci_067                 4.385634e-03 3 1  ON 66
ci_068                -5.158014e-03 3 1  ON 67
ci_069                -4.482212e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9092e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.247
    reference variance = 0.277335
====================================================
  Execution time = 1.3696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9858e-01
  Total weights = 1.957341087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285876982498
                                         uncertainty =       0.001704218627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285876982498
                                         uncertainty =       0.001704218627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378032550
  error estimate for blocks of size 2^( 2) =       0.000388936082
  error estimate for blocks of size 2^( 3) =       0.000398586053
  error estimate for blocks of size 2^( 4) =       0.000405744656
  error estimate for blocks of size 2^( 5) =       0.000411048140
  error estimate for blocks of size 2^( 6) =       0.000413484974
  error estimate for blocks of size 2^( 7) =       0.000415276415

      target function =      -0.903306829614
              le_mean =     -17.215106381339
             les_mean =     296.658472079235
             stat err =       0.000411388546
             autocorr =       1.184257105911
   target nu stat err =       0.000411388546
   target dn stat err =       0.002566905131
      target stat err =       0.003314487342
              std dev =       0.534618759874
             le_variance =       0.285817218410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721510638134e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903318279677       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903318568691       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903318610895       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903318626934       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903318628798       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903318629151       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903318629203       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903318629167       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903318629125       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903318629133       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 6.580382e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903318279677       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903318351941       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903318362494       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903318366504       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903318366970       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903318367057       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903318367072       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903318367062       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903318367051       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903318367053       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.645285e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903318279677       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903318297743       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903318300382       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903318301385       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903318301501       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903318301526       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903318301526       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903318301523       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903318301521       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903318301523       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 4.113330e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.446002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6188e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.052429e-02 3 1  ON 0
ci_002                -3.052594e-02 3 1  ON 1
ci_003                -2.507181e-02 3 1  ON 2
ci_004                 2.252100e-02 3 1  ON 3
ci_005                 2.297128e-02 3 1  ON 4
ci_006                -1.977207e-02 3 1  ON 5
ci_007                -1.974020e-02 3 1  ON 6
ci_008                -9.200909e-03 3 1  ON 7
ci_009                -1.487691e-02 3 1  ON 8
ci_010                -1.017642e-02 3 1  ON 9
ci_011                -1.047024e-02 3 1  ON 10
ci_012                -1.051471e-02 3 1  ON 11
ci_013                -2.011742e-02 3 1  ON 12
ci_014                 1.204484e-02 3 1  ON 13
ci_015                 1.232630e-02 3 1  ON 14
ci_016                 1.649991e-02 3 1  ON 15
ci_017                 1.634636e-02 3 1  ON 16
ci_018                 9.880187e-03 3 1  ON 17
ci_019                 1.026885e-02 3 1  ON 18
ci_020                 1.580084e-02 3 1  ON 19
ci_021                 1.592816e-02 3 1  ON 20
ci_022                 9.116137e-03 3 1  ON 21
ci_023                 9.116168e-03 3 1  ON 22
ci_024                 9.630109e-03 3 1  ON 23
ci_025                 9.595130e-03 3 1  ON 24
ci_026                 1.071622e-02 3 1  ON 25
ci_027                 1.103744e-02 3 1  ON 26
ci_028                -1.507574e-02 3 1  ON 27
ci_029                -1.568987e-02 3 1  ON 28
ci_030                -8.962404e-03 3 1  ON 29
ci_031                -9.353542e-03 3 1  ON 30
ci_032                -1.472862e-02 3 1  ON 31
ci_033                 6.273633e-03 3 1  ON 32
ci_034                 5.752236e-03 3 1  ON 33
ci_035                -4.283185e-03 3 1  ON 34
ci_036                -1.206324e-02 3 1  ON 35
ci_037                -1.231341e-02 3 1  ON 36
ci_038                 1.860313e-03 3 1  ON 37
ci_039                 2.121057e-03 3 1  ON 38
ci_040                -2.546373e-03 3 1  ON 39
ci_041                 8.528068e-03 3 1  ON 40
ci_042                 8.523426e-03 3 1  ON 41
ci_043                -3.220048e-03 3 1  ON 42
ci_044                -4.927142e-03 3 1  ON 43
ci_045                -2.762959e-03 3 1  ON 44
ci_046                 5.442058e-03 3 1  ON 45
ci_047                 5.454876e-03 3 1  ON 46
ci_048                -1.256025e-02 3 1  ON 47
ci_049                -1.273777e-02 3 1  ON 48
ci_050                 3.546954e-03 3 1  ON 49
ci_051                 3.499873e-03 3 1  ON 50
ci_052                -2.791269e-03 3 1  ON 51
ci_053                -2.829237e-03 3 1  ON 52
ci_054                -2.960891e-03 3 1  ON 53
ci_055                -3.227575e-03 3 1  ON 54
ci_056                 5.143141e-03 3 1  ON 55
ci_057                 5.323591e-03 3 1  ON 56
ci_058                -2.540098e-03 3 1  ON 57
ci_059                -2.495680e-03 3 1  ON 58
ci_060                 5.248927e-03 3 1  ON 59
ci_061                 5.938349e-03 3 1  ON 60
ci_062                -3.646559e-03 3 1  ON 61
ci_063                -3.706760e-03 3 1  ON 62
ci_064                -2.767132e-03 3 1  ON 63
ci_065                -3.793477e-03 3 1  ON 64
ci_066                 4.285433e-03 3 1  ON 65
ci_067                 4.385637e-03 3 1  ON 66
ci_068                -5.157952e-03 3 1  ON 67
ci_069                -4.482194e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.178274
====================================================
  Execution time = 1.3433e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9881e-01
  Total weights = 1.9576e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286559020787
                                         uncertainty =       0.001824702640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286559020787
                                         uncertainty =       0.001824702640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378461988
  error estimate for blocks of size 2^( 2) =       0.000389156447
  error estimate for blocks of size 2^( 3) =       0.000398748742
  error estimate for blocks of size 2^( 4) =       0.000406530681
  error estimate for blocks of size 2^( 5) =       0.000411475715
  error estimate for blocks of size 2^( 6) =       0.000413072204
  error estimate for blocks of size 2^( 7) =       0.000414327764

      target function =      -0.902961224741
              le_mean =     -17.214863149729
             les_mean =     296.650327978458
             stat err =       0.000411351591
             autocorr =       1.181358827374
   target nu stat err =       0.000411351591
   target dn stat err =       0.002389376338
      target stat err =       0.003088991737
              std dev =       0.535226075762
             le_variance =       0.286466952176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558581504
                                         uncertainty =       0.001824690037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558581504
                                         uncertainty =       0.001824690037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378461698
  error estimate for blocks of size 2^( 2) =       0.000389156228
  error estimate for blocks of size 2^( 3) =       0.000398748596
  error estimate for blocks of size 2^( 4) =       0.000406530594
  error estimate for blocks of size 2^( 5) =       0.000411475648
  error estimate for blocks of size 2^( 6) =       0.000413072173
  error estimate for blocks of size 2^( 7) =       0.000414327725

      target function =      -0.902961685698
              le_mean =     -17.214863148223
             les_mean =     296.650327563357
             stat err =       0.000411351535
             autocorr =       1.181360314802
   target nu stat err =       0.000411351535
   target dn stat err =       0.002389378566
      target stat err =       0.003088997592
              std dev =       0.535225666059
             le_variance =       0.286466513608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558801098
                                         uncertainty =       0.001824696337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558801098
                                         uncertainty =       0.001824696337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378461843
  error estimate for blocks of size 2^( 2) =       0.000389156338
  error estimate for blocks of size 2^( 3) =       0.000398748669
  error estimate for blocks of size 2^( 4) =       0.000406530637
  error estimate for blocks of size 2^( 5) =       0.000411475682
  error estimate for blocks of size 2^( 6) =       0.000413072189
  error estimate for blocks of size 2^( 7) =       0.000414327744

      target function =      -0.902960856977
              le_mean =     -17.214863148966
             les_mean =     296.650328241651
             stat err =       0.000411351563
             autocorr =       1.181359570993
   target nu stat err =       0.000411351563
   target dn stat err =       0.002389377048
      target stat err =       0.003088990139
              std dev =       0.535225870867
             le_variance =       0.286466732845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558993324
                                         uncertainty =       0.001824701852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286558993324
                                         uncertainty =       0.001824701852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378461970
  error estimate for blocks of size 2^( 2) =       0.000389156433
  error estimate for blocks of size 2^( 3) =       0.000398748733
  error estimate for blocks of size 2^( 4) =       0.000406530675
  error estimate for blocks of size 2^( 5) =       0.000411475711
  error estimate for blocks of size 2^( 6) =       0.000413072202
  error estimate for blocks of size 2^( 7) =       0.000414327761

      target function =      -0.902961253003
              le_mean =     -17.214863149634
             les_mean =     296.650327952921
             stat err =       0.000411351587
             autocorr =       1.181358920360
   target nu stat err =       0.000411351587
   target dn stat err =       0.002389376476
      target stat err =       0.003088992098
              std dev =       0.535226050148
             le_variance =       0.286466924757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902961224741        initial
     3.8147e+02     3.8147e+03             6.5804e-07        -0.902961685698  <--
     1.5259e+03     1.5259e+04             1.6453e-07        -0.902960856977
     6.1035e+03     6.1035e+04             4.1133e-08        -0.902961253003

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.2724e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.052379e-02 3 1  ON 0
ci_002                -3.052559e-02 3 1  ON 1
ci_003                -2.507172e-02 3 1  ON 2
ci_004                 2.252076e-02 3 1  ON 3
ci_005                 2.297120e-02 3 1  ON 4
ci_006                -1.977187e-02 3 1  ON 5
ci_007                -1.974004e-02 3 1  ON 6
ci_008                -9.200582e-03 3 1  ON 7
ci_009                -1.487673e-02 3 1  ON 8
ci_010                -1.017631e-02 3 1  ON 9
ci_011                -1.047008e-02 3 1  ON 10
ci_012                -1.051439e-02 3 1  ON 11
ci_013                -2.011738e-02 3 1  ON 12
ci_014                 1.204477e-02 3 1  ON 13
ci_015                 1.232599e-02 3 1  ON 14
ci_016                 1.649989e-02 3 1  ON 15
ci_017                 1.634631e-02 3 1  ON 16
ci_018                 9.880023e-03 3 1  ON 17
ci_019                 1.026864e-02 3 1  ON 18
ci_020                 1.580075e-02 3 1  ON 19
ci_021                 1.592800e-02 3 1  ON 20
ci_022                 9.115955e-03 3 1  ON 21
ci_023                 9.116050e-03 3 1  ON 22
ci_024                 9.630204e-03 3 1  ON 23
ci_025                 9.594996e-03 3 1  ON 24
ci_026                 1.071614e-02 3 1  ON 25
ci_027                 1.103702e-02 3 1  ON 26
ci_028                -1.507556e-02 3 1  ON 27
ci_029                -1.568973e-02 3 1  ON 28
ci_030                -8.962486e-03 3 1  ON 29
ci_031                -9.353317e-03 3 1  ON 30
ci_032                -1.472866e-02 3 1  ON 31
ci_033                 6.273738e-03 3 1  ON 32
ci_034                 5.752153e-03 3 1  ON 33
ci_035                -4.283108e-03 3 1  ON 34
ci_036                -1.206299e-02 3 1  ON 35
ci_037                -1.231338e-02 3 1  ON 36
ci_038                 1.860149e-03 3 1  ON 37
ci_039                 2.120918e-03 3 1  ON 38
ci_040                -2.546314e-03 3 1  ON 39
ci_041                 8.527935e-03 3 1  ON 40
ci_042                 8.523504e-03 3 1  ON 41
ci_043                -3.219893e-03 3 1  ON 42
ci_044                -4.926725e-03 3 1  ON 43
ci_045                -2.762766e-03 3 1  ON 44
ci_046                 5.441849e-03 3 1  ON 45
ci_047                 5.454824e-03 3 1  ON 46
ci_048                -1.256032e-02 3 1  ON 47
ci_049                -1.273787e-02 3 1  ON 48
ci_050                 3.546901e-03 3 1  ON 49
ci_051                 3.499684e-03 3 1  ON 50
ci_052                -2.791201e-03 3 1  ON 51
ci_053                -2.829178e-03 3 1  ON 52
ci_054                -2.960909e-03 3 1  ON 53
ci_055                -3.227449e-03 3 1  ON 54
ci_056                 5.143088e-03 3 1  ON 55
ci_057                 5.323597e-03 3 1  ON 56
ci_058                -2.539818e-03 3 1  ON 57
ci_059                -2.495582e-03 3 1  ON 58
ci_060                 5.248754e-03 3 1  ON 59
ci_061                 5.938390e-03 3 1  ON 60
ci_062                -3.646471e-03 3 1  ON 61
ci_063                -3.706507e-03 3 1  ON 62
ci_064                -2.767118e-03 3 1  ON 63
ci_065                -3.793393e-03 3 1  ON 64
ci_066                 4.285434e-03 3 1  ON 65
ci_067                 4.385649e-03 3 1  ON 66
ci_068                -5.157764e-03 3 1  ON 67
ci_069                -4.482139e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2487
    reference variance = 0.295692
====================================================
  Execution time = 1.4148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0535e-01
  Total weights = 1.957241405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288827402001
                                         uncertainty =       0.001887885102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288827402001
                                         uncertainty =       0.001887885102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380093743
  error estimate for blocks of size 2^( 2) =       0.000391054314
  error estimate for blocks of size 2^( 3) =       0.000401239380
  error estimate for blocks of size 2^( 4) =       0.000409272387
  error estimate for blocks of size 2^( 5) =       0.000413705362
  error estimate for blocks of size 2^( 6) =       0.000415473490
  error estimate for blocks of size 2^( 7) =       0.000418290039

      target function =      -0.894936245939
              le_mean =     -17.215840246973
             les_mean =     296.690503749298
             stat err =       0.000414185319
             autocorr =       1.187429850984
   target nu stat err =       0.000414185319
   target dn stat err =       0.002966170401
      target stat err =       0.003750662121
              std dev =       0.537533726022
             le_variance =       0.288942506611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584024697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894951183126       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894952095361       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894952270903       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894952314150       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894952320487       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894952321899       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894952322756       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894952322895       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894952322904       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894952322938       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 1.721857e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894951183126       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894951411321       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894951455226       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894951466040       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894951467625       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894951467979       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894951468193       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894951468228       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894951468230       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894951468237       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 4.306669e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894951183126       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894951240184       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894951251161       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894951253865       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894951254262       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894951254350       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894951254404       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894951254414       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894951254411       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894951254415       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+03 is 1.076794e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.449453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6637e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.052339e-02 3 1  ON 0
ci_002                -3.052518e-02 3 1  ON 1
ci_003                -2.507152e-02 3 1  ON 2
ci_004                 2.252044e-02 3 1  ON 3
ci_005                 2.297096e-02 3 1  ON 4
ci_006                -1.977161e-02 3 1  ON 5
ci_007                -1.973980e-02 3 1  ON 6
ci_008                -9.200360e-03 3 1  ON 7
ci_009                -1.487639e-02 3 1  ON 8
ci_010                -1.017618e-02 3 1  ON 9
ci_011                -1.046967e-02 3 1  ON 10
ci_012                -1.051409e-02 3 1  ON 11
ci_013                -2.011748e-02 3 1  ON 12
ci_014                 1.204439e-02 3 1  ON 13
ci_015                 1.232569e-02 3 1  ON 14
ci_016                 1.649979e-02 3 1  ON 15
ci_017                 1.634626e-02 3 1  ON 16
ci_018                 9.879926e-03 3 1  ON 17
ci_019                 1.026827e-02 3 1  ON 18
ci_020                 1.580063e-02 3 1  ON 19
ci_021                 1.592779e-02 3 1  ON 20
ci_022                 9.115750e-03 3 1  ON 21
ci_023                 9.116049e-03 3 1  ON 22
ci_024                 9.629774e-03 3 1  ON 23
ci_025                 9.594659e-03 3 1  ON 24
ci_026                 1.071579e-02 3 1  ON 25
ci_027                 1.103676e-02 3 1  ON 26
ci_028                -1.507555e-02 3 1  ON 27
ci_029                -1.568949e-02 3 1  ON 28
ci_030                -8.962347e-03 3 1  ON 29
ci_031                -9.353132e-03 3 1  ON 30
ci_032                -1.472868e-02 3 1  ON 31
ci_033                 6.273668e-03 3 1  ON 32
ci_034                 5.751972e-03 3 1  ON 33
ci_035                -4.282959e-03 3 1  ON 34
ci_036                -1.206284e-02 3 1  ON 35
ci_037                -1.231329e-02 3 1  ON 36
ci_038                 1.859903e-03 3 1  ON 37
ci_039                 2.120683e-03 3 1  ON 38
ci_040                -2.546189e-03 3 1  ON 39
ci_041                 8.527731e-03 3 1  ON 40
ci_042                 8.523609e-03 3 1  ON 41
ci_043                -3.219718e-03 3 1  ON 42
ci_044                -4.926562e-03 3 1  ON 43
ci_045                -2.762568e-03 3 1  ON 44
ci_046                 5.441674e-03 3 1  ON 45
ci_047                 5.454625e-03 3 1  ON 46
ci_048                -1.256051e-02 3 1  ON 47
ci_049                -1.273758e-02 3 1  ON 48
ci_050                 3.546690e-03 3 1  ON 49
ci_051                 3.499703e-03 3 1  ON 50
ci_052                -2.791116e-03 3 1  ON 51
ci_053                -2.829030e-03 3 1  ON 52
ci_054                -2.960804e-03 3 1  ON 53
ci_055                -3.227273e-03 3 1  ON 54
ci_056                 5.142887e-03 3 1  ON 55
ci_057                 5.323389e-03 3 1  ON 56
ci_058                -2.539603e-03 3 1  ON 57
ci_059                -2.495401e-03 3 1  ON 58
ci_060                 5.248836e-03 3 1  ON 59
ci_061                 5.938293e-03 3 1  ON 60
ci_062                -3.646320e-03 3 1  ON 61
ci_063                -3.706505e-03 3 1  ON 62
ci_064                -2.766928e-03 3 1  ON 63
ci_065                -3.793271e-03 3 1  ON 64
ci_066                 4.285402e-03 3 1  ON 65
ci_067                 4.385685e-03 3 1  ON 66
ci_068                -5.157568e-03 3 1  ON 67
ci_069                -4.482045e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.130675
====================================================
  Execution time = 1.3464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9758e-01
  Total weights = 1.9575e+06
  Execution time = 1.8291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284248279918
                                         uncertainty =       0.001592089021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284248279918
                                         uncertainty =       0.001592089021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376978514
  error estimate for blocks of size 2^( 2) =       0.000387900732
  error estimate for blocks of size 2^( 3) =       0.000397671765
  error estimate for blocks of size 2^( 4) =       0.000404753348
  error estimate for blocks of size 2^( 5) =       0.000408684433
  error estimate for blocks of size 2^( 6) =       0.000411217811
  error estimate for blocks of size 2^( 7) =       0.000412598422

      target function =      -0.904708173511
              le_mean =     -17.215667019754
             les_mean =     296.676776364938
             stat err =       0.000409313504
             autocorr =       1.178905378987
   target nu stat err =       0.000409313504
   target dn stat err =       0.002273048534
      target stat err =       0.002958329659
              std dev =       0.533128127022
             le_variance =       0.284225599822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284246288070
                                         uncertainty =       0.001592024686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284246288070
                                         uncertainty =       0.001592024686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977206
  error estimate for blocks of size 2^( 2) =       0.000387899712
  error estimate for blocks of size 2^( 3) =       0.000397671076
  error estimate for blocks of size 2^( 4) =       0.000404752864
  error estimate for blocks of size 2^( 5) =       0.000408684027
  error estimate for blocks of size 2^( 6) =       0.000411217487
  error estimate for blocks of size 2^( 7) =       0.000412598181

      target function =      -0.904711817833
              le_mean =     -17.215667030186
             les_mean =     296.676773872944
             stat err =       0.000409313140
             autocorr =       1.178911462073
   target nu stat err =       0.000409313140
   target dn stat err =       0.002272725545
      target stat err =       0.002957948631
              std dev =       0.533126277912
             le_variance =       0.284223628201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284247283236
                                         uncertainty =       0.001592056829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284247283236
                                         uncertainty =       0.001592056829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376977860
  error estimate for blocks of size 2^( 2) =       0.000387900222
  error estimate for blocks of size 2^( 3) =       0.000397671420
  error estimate for blocks of size 2^( 4) =       0.000404753106
  error estimate for blocks of size 2^( 5) =       0.000408684230
  error estimate for blocks of size 2^( 6) =       0.000411217649
  error estimate for blocks of size 2^( 7) =       0.000412598301

      target function =      -0.904710016803
              le_mean =     -17.215667024943
             les_mean =     296.676775101461
             stat err =       0.000409313322
             autocorr =       1.178908422177
   target nu stat err =       0.000409313322
   target dn stat err =       0.002272886837
      target stat err =       0.002958139028
              std dev =       0.533127201762
             le_variance =       0.284224613258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284248155292
                                         uncertainty =       0.001592084996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284248155292
                                         uncertainty =       0.001592084996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376978432
  error estimate for blocks of size 2^( 2) =       0.000387900668
  error estimate for blocks of size 2^( 3) =       0.000397671722
  error estimate for blocks of size 2^( 4) =       0.000404753318
  error estimate for blocks of size 2^( 5) =       0.000408684408
  error estimate for blocks of size 2^( 6) =       0.000411217791
  error estimate for blocks of size 2^( 7) =       0.000412598407

      target function =      -0.904708406055
              le_mean =     -17.215667020400
             les_mean =     296.676776205222
             stat err =       0.000409313481
             autocorr =       1.178905759456
   target nu stat err =       0.000409313481
   target dn stat err =       0.002273028306
      target stat err =       0.002958305825
              std dev =       0.533128011326
             le_variance =       0.284225476461


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904708173511        initial
     9.5367e+01     9.5367e+02             1.7219e-06        -0.904711817833  <--
     3.8147e+02     3.8147e+03             4.3067e-07        -0.904710016803
     1.5259e+03     1.5259e+04             1.0768e-07        -0.904708406055

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.2738e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.052216e-02 3 1  ON 0
ci_002                -3.052395e-02 3 1  ON 1
ci_003                -2.507093e-02 3 1  ON 2
ci_004                 2.251949e-02 3 1  ON 3
ci_005                 2.297021e-02 3 1  ON 4
ci_006                -1.977080e-02 3 1  ON 5
ci_007                -1.973911e-02 3 1  ON 6
ci_008                -9.199696e-03 3 1  ON 7
ci_009                -1.487536e-02 3 1  ON 8
ci_010                -1.017579e-02 3 1  ON 9
ci_011                -1.046845e-02 3 1  ON 10
ci_012                -1.051320e-02 3 1  ON 11
ci_013                -2.011777e-02 3 1  ON 12
ci_014                 1.204322e-02 3 1  ON 13
ci_015                 1.232478e-02 3 1  ON 14
ci_016                 1.649949e-02 3 1  ON 15
ci_017                 1.634609e-02 3 1  ON 16
ci_018                 9.879633e-03 3 1  ON 17
ci_019                 1.026714e-02 3 1  ON 18
ci_020                 1.580028e-02 3 1  ON 19
ci_021                 1.592716e-02 3 1  ON 20
ci_022                 9.115138e-03 3 1  ON 21
ci_023                 9.116047e-03 3 1  ON 22
ci_024                 9.628482e-03 3 1  ON 23
ci_025                 9.593647e-03 3 1  ON 24
ci_026                 1.071474e-02 3 1  ON 25
ci_027                 1.103600e-02 3 1  ON 26
ci_028                -1.507552e-02 3 1  ON 27
ci_029                -1.568878e-02 3 1  ON 28
ci_030                -8.961928e-03 3 1  ON 29
ci_031                -9.352577e-03 3 1  ON 30
ci_032                -1.472876e-02 3 1  ON 31
ci_033                 6.273458e-03 3 1  ON 32
ci_034                 5.751432e-03 3 1  ON 33
ci_035                -4.282512e-03 3 1  ON 34
ci_036                -1.206236e-02 3 1  ON 35
ci_037                -1.231301e-02 3 1  ON 36
ci_038                 1.859167e-03 3 1  ON 37
ci_039                 2.119980e-03 3 1  ON 38
ci_040                -2.545812e-03 3 1  ON 39
ci_041                 8.527120e-03 3 1  ON 40
ci_042                 8.523926e-03 3 1  ON 41
ci_043                -3.219194e-03 3 1  ON 42
ci_044                -4.926074e-03 3 1  ON 43
ci_045                -2.761973e-03 3 1  ON 44
ci_046                 5.441148e-03 3 1  ON 45
ci_047                 5.454025e-03 3 1  ON 46
ci_048                -1.256108e-02 3 1  ON 47
ci_049                -1.273669e-02 3 1  ON 48
ci_050                 3.546060e-03 3 1  ON 49
ci_051                 3.499761e-03 3 1  ON 50
ci_052                -2.790863e-03 3 1  ON 51
ci_053                -2.828589e-03 3 1  ON 52
ci_054                -2.960491e-03 3 1  ON 53
ci_055                -3.226744e-03 3 1  ON 54
ci_056                 5.142286e-03 3 1  ON 55
ci_057                 5.322766e-03 3 1  ON 56
ci_058                -2.538960e-03 3 1  ON 57
ci_059                -2.494858e-03 3 1  ON 58
ci_060                 5.249082e-03 3 1  ON 59
ci_061                 5.938003e-03 3 1  ON 60
ci_062                -3.645868e-03 3 1  ON 61
ci_063                -3.706499e-03 3 1  ON 62
ci_064                -2.766357e-03 3 1  ON 63
ci_065                -3.792905e-03 3 1  ON 64
ci_066                 4.285305e-03 3 1  ON 65
ci_067                 4.385792e-03 3 1  ON 66
ci_068                -5.156978e-03 3 1  ON 67
ci_069                -4.481763e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2513
    reference variance = 0.158874
====================================================
  Execution time = 1.4222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9672e-01
  Total weights = 1.957252837e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283689246592
                                         uncertainty =       0.001943739131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283689246592
                                         uncertainty =       0.001943739131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376611295
  error estimate for blocks of size 2^( 2) =       0.000387415706
  error estimate for blocks of size 2^( 3) =       0.000397230645
  error estimate for blocks of size 2^( 4) =       0.000404452903
  error estimate for blocks of size 2^( 5) =       0.000409183354
  error estimate for blocks of size 2^( 6) =       0.000412494358
  error estimate for blocks of size 2^( 7) =       0.000414091072

      target function =      -0.905645861510
              le_mean =     -17.214947675075
             les_mean =     296.651143968498
             stat err =       0.000410055422
             autocorr =       1.185491473362
   target nu stat err =       0.000410055422
   target dn stat err =       0.002614793350
      target stat err =       0.003390534601
              std dev =       0.532608801483
             le_variance =       0.283672135417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721494767507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905657778427       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905661096736       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905661824562       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905662007318       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905662021955       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905662022814       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905662023667       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905662023148       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905662023080       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905662022923       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 9.807102e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905657778427       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905658610026       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905658792310       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905658838042       residual = 8.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905658841702       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905658841916       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905658842130       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905658842000       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905658841983       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905658841944       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.456353e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905657778427       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905657986454       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905658032045       residual = 8.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905658043481       residual = 8.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905658044396       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905658044449       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905658044503       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905658044471       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905658044466       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905658044456       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 6.143749e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6715e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.052006e-02 3 1  ON 0
ci_002                -3.052276e-02 3 1  ON 1
ci_003                -2.507002e-02 3 1  ON 2
ci_004                 2.251867e-02 3 1  ON 3
ci_005                 2.296776e-02 3 1  ON 4
ci_006                -1.976924e-02 3 1  ON 5
ci_007                -1.973791e-02 3 1  ON 6
ci_008                -9.199055e-03 3 1  ON 7
ci_009                -1.487507e-02 3 1  ON 8
ci_010                -1.017490e-02 3 1  ON 9
ci_011                -1.046823e-02 3 1  ON 10
ci_012                -1.051237e-02 3 1  ON 11
ci_013                -2.011812e-02 3 1  ON 12
ci_014                 1.204268e-02 3 1  ON 13
ci_015                 1.232377e-02 3 1  ON 14
ci_016                 1.649893e-02 3 1  ON 15
ci_017                 1.634559e-02 3 1  ON 16
ci_018                 9.878440e-03 3 1  ON 17
ci_019                 1.026588e-02 3 1  ON 18
ci_020                 1.579971e-02 3 1  ON 19
ci_021                 1.592686e-02 3 1  ON 20
ci_022                 9.114940e-03 3 1  ON 21
ci_023                 9.114896e-03 3 1  ON 22
ci_024                 9.627291e-03 3 1  ON 23
ci_025                 9.592611e-03 3 1  ON 24
ci_026                 1.071386e-02 3 1  ON 25
ci_027                 1.103490e-02 3 1  ON 26
ci_028                -1.507498e-02 3 1  ON 27
ci_029                -1.568864e-02 3 1  ON 28
ci_030                -8.961663e-03 3 1  ON 29
ci_031                -9.351690e-03 3 1  ON 30
ci_032                -1.472832e-02 3 1  ON 31
ci_033                 6.273079e-03 3 1  ON 32
ci_034                 5.750665e-03 3 1  ON 33
ci_035                -4.281773e-03 3 1  ON 34
ci_036                -1.206139e-02 3 1  ON 35
ci_037                -1.231277e-02 3 1  ON 36
ci_038                 1.858235e-03 3 1  ON 37
ci_039                 2.119041e-03 3 1  ON 38
ci_040                -2.544988e-03 3 1  ON 39
ci_041                 8.526308e-03 3 1  ON 40
ci_042                 8.524220e-03 3 1  ON 41
ci_043                -3.218528e-03 3 1  ON 42
ci_044                -4.924653e-03 3 1  ON 43
ci_045                -2.760906e-03 3 1  ON 44
ci_046                 5.440539e-03 3 1  ON 45
ci_047                 5.453341e-03 3 1  ON 46
ci_048                -1.256059e-02 3 1  ON 47
ci_049                -1.273603e-02 3 1  ON 48
ci_050                 3.544456e-03 3 1  ON 49
ci_051                 3.499320e-03 3 1  ON 50
ci_052                -2.790483e-03 3 1  ON 51
ci_053                -2.829274e-03 3 1  ON 52
ci_054                -2.960119e-03 3 1  ON 53
ci_055                -3.226029e-03 3 1  ON 54
ci_056                 5.142020e-03 3 1  ON 55
ci_057                 5.322431e-03 3 1  ON 56
ci_058                -2.538406e-03 3 1  ON 57
ci_059                -2.494829e-03 3 1  ON 58
ci_060                 5.249176e-03 3 1  ON 59
ci_061                 5.936909e-03 3 1  ON 60
ci_062                -3.645221e-03 3 1  ON 61
ci_063                -3.705737e-03 3 1  ON 62
ci_064                -2.766061e-03 3 1  ON 63
ci_065                -3.792581e-03 3 1  ON 64
ci_066                 4.285062e-03 3 1  ON 65
ci_067                 4.386009e-03 3 1  ON 66
ci_068                -5.156390e-03 3 1  ON 67
ci_069                -4.481297e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2214
    reference variance = 0.202273
====================================================
  Execution time = 1.3413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0878e-01
  Total weights = 1.9572e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295027749460
                                         uncertainty =       0.008086627031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295027749460
                                         uncertainty =       0.008086627031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384045739
  error estimate for blocks of size 2^( 2) =       0.000394396805
  error estimate for blocks of size 2^( 3) =       0.000404194712
  error estimate for blocks of size 2^( 4) =       0.000411594954
  error estimate for blocks of size 2^( 5) =       0.000416427245
  error estimate for blocks of size 2^( 6) =       0.000417667214
  error estimate for blocks of size 2^( 7) =       0.000419469581

      target function =      -0.890358973972
              le_mean =     -17.214830430380
             les_mean =     296.659165291075
             stat err =       0.000416289749
             autocorr =       1.174966624348
   target nu stat err =       0.000416289749
   target dn stat err =       0.008598699610
      target stat err =       0.010633584362
              std dev =       0.543122692803
             le_variance =       0.294982259437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295020495989
                                         uncertainty =       0.008084705113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295020495989
                                         uncertainty =       0.008084705113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384041025
  error estimate for blocks of size 2^( 2) =       0.000394393050
  error estimate for blocks of size 2^( 3) =       0.000404192081
  error estimate for blocks of size 2^( 4) =       0.000411593140
  error estimate for blocks of size 2^( 5) =       0.000416426081
  error estimate for blocks of size 2^( 6) =       0.000417666268
  error estimate for blocks of size 2^( 7) =       0.000419468673

      target function =      -0.890370291854
              le_mean =     -17.214830592124
             les_mean =     296.659161761927
             stat err =       0.000416288540
             autocorr =       1.174988647423
   target nu stat err =       0.000416288540
   target dn stat err =       0.008596856522
      target stat err =       0.010631583688
              std dev =       0.543116026491
             le_variance =       0.294975018232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295024111138
                                         uncertainty =       0.008085663687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295024111138
                                         uncertainty =       0.008085663687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384043375
  error estimate for blocks of size 2^( 2) =       0.000394394921
  error estimate for blocks of size 2^( 3) =       0.000404193391
  error estimate for blocks of size 2^( 4) =       0.000411594042
  error estimate for blocks of size 2^( 5) =       0.000416426659
  error estimate for blocks of size 2^( 6) =       0.000417666737
  error estimate for blocks of size 2^( 7) =       0.000419469124

      target function =      -0.890364827557
              le_mean =     -17.214830510976
             les_mean =     296.659163359383
             stat err =       0.000416289141
             autocorr =       1.174977660232
   target nu stat err =       0.000416289141
   target dn stat err =       0.008597772773
      target stat err =       0.010632582148
              std dev =       0.543119349006
             le_variance =       0.294978627265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295027294038
                                         uncertainty =       0.008086506529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295027294038
                                         uncertainty =       0.008086506529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384045443
  error estimate for blocks of size 2^( 2) =       0.000394396569
  error estimate for blocks of size 2^( 3) =       0.000404194546
  error estimate for blocks of size 2^( 4) =       0.000411594839
  error estimate for blocks of size 2^( 5) =       0.000416427172
  error estimate for blocks of size 2^( 6) =       0.000417667154
  error estimate for blocks of size 2^( 7) =       0.000419469524

      target function =      -0.890359725535
              le_mean =     -17.214830440410
             les_mean =     296.659165031997
             stat err =       0.000416289672
             autocorr =       1.174968004586
   target nu stat err =       0.000416289672
   target dn stat err =       0.008598583350
      target stat err =       0.010633459060
              std dev =       0.543122274248
             le_variance =       0.294981804784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.890358973972        initial
     2.3842e+01     2.3842e+02             9.8071e-06        -0.890370291854  <--
     9.5367e+01     9.5367e+02             2.4564e-06        -0.890364827557
     3.8147e+02     3.8147e+03             6.1437e-07        -0.890359725535

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.6638e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.051376e-02 3 1  ON 0
ci_002                -3.051921e-02 3 1  ON 1
ci_003                -2.506732e-02 3 1  ON 2
ci_004                 2.251622e-02 3 1  ON 3
ci_005                 2.296041e-02 3 1  ON 4
ci_006                -1.976457e-02 3 1  ON 5
ci_007                -1.973433e-02 3 1  ON 6
ci_008                -9.197142e-03 3 1  ON 7
ci_009                -1.487421e-02 3 1  ON 8
ci_010                -1.017223e-02 3 1  ON 9
ci_011                -1.046757e-02 3 1  ON 10
ci_012                -1.050990e-02 3 1  ON 11
ci_013                -2.011919e-02 3 1  ON 12
ci_014                 1.204108e-02 3 1  ON 13
ci_015                 1.232073e-02 3 1  ON 14
ci_016                 1.649727e-02 3 1  ON 15
ci_017                 1.634410e-02 3 1  ON 16
ci_018                 9.874872e-03 3 1  ON 17
ci_019                 1.026211e-02 3 1  ON 18
ci_020                 1.579798e-02 3 1  ON 19
ci_021                 1.592595e-02 3 1  ON 20
ci_022                 9.114345e-03 3 1  ON 21
ci_023                 9.111452e-03 3 1  ON 22
ci_024                 9.623726e-03 3 1  ON 23
ci_025                 9.589512e-03 3 1  ON 24
ci_026                 1.071125e-02 3 1  ON 25
ci_027                 1.103161e-02 3 1  ON 26
ci_028                -1.507335e-02 3 1  ON 27
ci_029                -1.568824e-02 3 1  ON 28
ci_030                -8.960869e-03 3 1  ON 29
ci_031                -9.349035e-03 3 1  ON 30
ci_032                -1.472700e-02 3 1  ON 31
ci_033                 6.271947e-03 3 1  ON 32
ci_034                 5.748370e-03 3 1  ON 33
ci_035                -4.279564e-03 3 1  ON 34
ci_036                -1.205849e-02 3 1  ON 35
ci_037                -1.231206e-02 3 1  ON 36
ci_038                 1.855449e-03 3 1  ON 37
ci_039                 2.116232e-03 3 1  ON 38
ci_040                -2.542523e-03 3 1  ON 39
ci_041                 8.523879e-03 3 1  ON 40
ci_042                 8.525100e-03 3 1  ON 41
ci_043                -3.216537e-03 3 1  ON 42
ci_044                -4.920400e-03 3 1  ON 43
ci_045                -2.757712e-03 3 1  ON 44
ci_046                 5.438717e-03 3 1  ON 45
ci_047                 5.451293e-03 3 1  ON 46
ci_048                -1.255910e-02 3 1  ON 47
ci_049                -1.273404e-02 3 1  ON 48
ci_050                 3.539662e-03 3 1  ON 49
ci_051                 3.498004e-03 3 1  ON 50
ci_052                -2.789349e-03 3 1  ON 51
ci_053                -2.831323e-03 3 1  ON 52
ci_054                -2.959006e-03 3 1  ON 53
ci_055                -3.223888e-03 3 1  ON 54
ci_056                 5.141224e-03 3 1  ON 55
ci_057                 5.321432e-03 3 1  ON 56
ci_058                -2.536753e-03 3 1  ON 57
ci_059                -2.494743e-03 3 1  ON 58
ci_060                 5.249458e-03 3 1  ON 59
ci_061                 5.933637e-03 3 1  ON 60
ci_062                -3.643287e-03 3 1  ON 61
ci_063                -3.703456e-03 3 1  ON 62
ci_064                -2.765175e-03 3 1  ON 63
ci_065                -3.791613e-03 3 1  ON 64
ci_066                 4.284334e-03 3 1  ON 65
ci_067                 4.386659e-03 3 1  ON 66
ci_068                -5.154630e-03 3 1  ON 67
ci_069                -4.479902e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.535775
====================================================
  Execution time = 1.4076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0573e-01
  Total weights = 1.957637525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290887503344
                                         uncertainty =       0.002290956969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290887503344
                                         uncertainty =       0.002290956969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381357297
  error estimate for blocks of size 2^( 2) =       0.000392543024
  error estimate for blocks of size 2^( 3) =       0.000402695960
  error estimate for blocks of size 2^( 4) =       0.000409886053
  error estimate for blocks of size 2^( 5) =       0.000414457862
  error estimate for blocks of size 2^( 6) =       0.000417654798
  error estimate for blocks of size 2^( 7) =       0.000417429847

      target function =      -0.894430386335
              le_mean =     -17.215682218713
             les_mean =     296.685441039644
             stat err =       0.000414857140
             autocorr =       1.183403957079
   target nu stat err =       0.000414857140
   target dn stat err =       0.003047743858
      target stat err =       0.003846283600
              std dev =       0.539320661540
             le_variance =       0.290866775964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721568221871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894446212246       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894463082753       residual = 4.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894466598817       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894467473821       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894467611418       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894467642836       residual = 7.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894467645997       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894467645407       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894467646613       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894467646386       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894467646262       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 4.071682e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894446212246       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894450470419       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894451355968       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894451575461       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894451609915       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894451617767       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894451618564       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894451618414       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894451618715       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894451618658       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 1.025614e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894446212246       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894447279354       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894447501153       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894447556073       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894447564689       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894447566652       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894447566852       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894447566814       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894447566889       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894447566875       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.568708e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.456567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6571e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.050351e-02 3 1  ON 0
ci_002                -3.051144e-02 3 1  ON 1
ci_003                -2.506476e-02 3 1  ON 2
ci_004                 2.251112e-02 3 1  ON 3
ci_005                 2.295080e-02 3 1  ON 4
ci_006                -1.975990e-02 3 1  ON 5
ci_007                -1.972984e-02 3 1  ON 6
ci_008                -9.189910e-03 3 1  ON 7
ci_009                -1.486990e-02 3 1  ON 8
ci_010                -1.017091e-02 3 1  ON 9
ci_011                -1.046402e-02 3 1  ON 10
ci_012                -1.050692e-02 3 1  ON 11
ci_013                -2.011529e-02 3 1  ON 12
ci_014                 1.203633e-02 3 1  ON 13
ci_015                 1.231557e-02 3 1  ON 14
ci_016                 1.649557e-02 3 1  ON 15
ci_017                 1.634263e-02 3 1  ON 16
ci_018                 9.872912e-03 3 1  ON 17
ci_019                 1.025805e-02 3 1  ON 18
ci_020                 1.579535e-02 3 1  ON 19
ci_021                 1.592191e-02 3 1  ON 20
ci_022                 9.108288e-03 3 1  ON 21
ci_023                 9.110510e-03 3 1  ON 22
ci_024                 9.623851e-03 3 1  ON 23
ci_025                 9.581907e-03 3 1  ON 24
ci_026                 1.070765e-02 3 1  ON 25
ci_027                 1.103334e-02 3 1  ON 26
ci_028                -1.507207e-02 3 1  ON 27
ci_029                -1.568512e-02 3 1  ON 28
ci_030                -8.961242e-03 3 1  ON 29
ci_031                -9.345535e-03 3 1  ON 30
ci_032                -1.472569e-02 3 1  ON 31
ci_033                 6.266733e-03 3 1  ON 32
ci_034                 5.746992e-03 3 1  ON 33
ci_035                -4.276704e-03 3 1  ON 34
ci_036                -1.205811e-02 3 1  ON 35
ci_037                -1.230927e-02 3 1  ON 36
ci_038                 1.851815e-03 3 1  ON 37
ci_039                 2.112072e-03 3 1  ON 38
ci_040                -2.538898e-03 3 1  ON 39
ci_041                 8.521669e-03 3 1  ON 40
ci_042                 8.523871e-03 3 1  ON 41
ci_043                -3.213094e-03 3 1  ON 42
ci_044                -4.917487e-03 3 1  ON 43
ci_045                -2.752049e-03 3 1  ON 44
ci_046                 5.436074e-03 3 1  ON 45
ci_047                 5.450703e-03 3 1  ON 46
ci_048                -1.256058e-02 3 1  ON 47
ci_049                -1.273163e-02 3 1  ON 48
ci_050                 3.539184e-03 3 1  ON 49
ci_051                 3.495482e-03 3 1  ON 50
ci_052                -2.787676e-03 3 1  ON 51
ci_053                -2.828448e-03 3 1  ON 52
ci_054                -2.955304e-03 3 1  ON 53
ci_055                -3.221612e-03 3 1  ON 54
ci_056                 5.140607e-03 3 1  ON 55
ci_057                 5.318358e-03 3 1  ON 56
ci_058                -2.534086e-03 3 1  ON 57
ci_059                -2.491775e-03 3 1  ON 58
ci_060                 5.246817e-03 3 1  ON 59
ci_061                 5.929259e-03 3 1  ON 60
ci_062                -3.641350e-03 3 1  ON 61
ci_063                -3.701095e-03 3 1  ON 62
ci_064                -2.761829e-03 3 1  ON 63
ci_065                -3.789313e-03 3 1  ON 64
ci_066                 4.281267e-03 3 1  ON 65
ci_067                 4.386228e-03 3 1  ON 66
ci_068                -5.151477e-03 3 1  ON 67
ci_069                -4.480797e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.502772
====================================================
  Execution time = 1.3476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9932e-01
  Total weights = 1.9577e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285605195714
                                         uncertainty =       0.001636863876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285605195714
                                         uncertainty =       0.001636863876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378039589
  error estimate for blocks of size 2^( 2) =       0.000389181042
  error estimate for blocks of size 2^( 3) =       0.000399279976
  error estimate for blocks of size 2^( 4) =       0.000406127181
  error estimate for blocks of size 2^( 5) =       0.000411071824
  error estimate for blocks of size 2^( 6) =       0.000413078417
  error estimate for blocks of size 2^( 7) =       0.000414159795

      target function =      -0.902421699410
              le_mean =     -17.215341841447
             les_mean =     296.667318021643
             stat err =       0.000411109304
             autocorr =       1.182605913731
   target nu stat err =       0.000411109304
   target dn stat err =       0.002457679182
      target stat err =       0.003172814739
              std dev =       0.534628714365
             le_variance =       0.285827862223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285578184187
                                         uncertainty =       0.001636832172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285578184187
                                         uncertainty =       0.001636832172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378021779
  error estimate for blocks of size 2^( 2) =       0.000389167702
  error estimate for blocks of size 2^( 3) =       0.000399271358
  error estimate for blocks of size 2^( 4) =       0.000406122036
  error estimate for blocks of size 2^( 5) =       0.000411068253
  error estimate for blocks of size 2^( 6) =       0.000413075888
  error estimate for blocks of size 2^( 7) =       0.000414157139

      target function =      -0.901553432734
              le_mean =     -17.215342252500
             les_mean =     296.668016233762
             stat err =       0.000411105829
             autocorr =       1.182697359973
   target nu stat err =       0.000411105829
   target dn stat err =       0.002557602282
      target stat err =       0.003291368829
              std dev =       0.534603526094
             le_variance =       0.285800930112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285591506087
                                         uncertainty =       0.001636846898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285591506087
                                         uncertainty =       0.001636846898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378030563
  error estimate for blocks of size 2^( 2) =       0.000389174266
  error estimate for blocks of size 2^( 3) =       0.000399275576
  error estimate for blocks of size 2^( 4) =       0.000406124515
  error estimate for blocks of size 2^( 5) =       0.000411069975
  error estimate for blocks of size 2^( 6) =       0.000413077027
  error estimate for blocks of size 2^( 7) =       0.000414158419

      target function =      -0.902421040075
              le_mean =     -17.215342028873
             les_mean =     296.667325018648
             stat err =       0.000411107484
             autocorr =       1.182651917010
   target nu stat err =       0.000411107484
   target dn stat err =       0.002458854820
      target stat err =       0.003174277997
              std dev =       0.534615948864
             le_variance =       0.285814212779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285603473517
                                         uncertainty =       0.001636861615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285603473517
                                         uncertainty =       0.001636861615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378038454
  error estimate for blocks of size 2^( 2) =       0.000389180188
  error estimate for blocks of size 2^( 3) =       0.000399279420
  error estimate for blocks of size 2^( 4) =       0.000406126842
  error estimate for blocks of size 2^( 5) =       0.000411071587
  error estimate for blocks of size 2^( 6) =       0.000413078237
  error estimate for blocks of size 2^( 7) =       0.000414159616

      target function =      -0.902423199686
              le_mean =     -17.215341863746
             les_mean =     296.667317610427
             stat err =       0.000411109070
             autocorr =       1.182611673270
   target nu stat err =       0.000411109070
   target dn stat err =       0.002457813557
      target stat err =       0.003172992883
              std dev =       0.534627108429
             le_variance =       0.285826145067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902421699410        initial
     5.9605e+00     5.9605e+01             4.0717e-05        -0.901553432734
     2.3842e+01     2.3842e+02             1.0256e-05        -0.902421040075
     9.5367e+01     9.5367e+02             2.5687e-06        -0.902423199686  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.2784e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.051120e-02 3 1  ON 0
ci_002                -3.051726e-02 3 1  ON 1
ci_003                -2.506668e-02 3 1  ON 2
ci_004                 2.251494e-02 3 1  ON 3
ci_005                 2.295800e-02 3 1  ON 4
ci_006                -1.976340e-02 3 1  ON 5
ci_007                -1.973321e-02 3 1  ON 6
ci_008                -9.195329e-03 3 1  ON 7
ci_009                -1.487313e-02 3 1  ON 8
ci_010                -1.017190e-02 3 1  ON 9
ci_011                -1.046668e-02 3 1  ON 10
ci_012                -1.050916e-02 3 1  ON 11
ci_013                -2.011821e-02 3 1  ON 12
ci_014                 1.203989e-02 3 1  ON 13
ci_015                 1.231944e-02 3 1  ON 14
ci_016                 1.649684e-02 3 1  ON 15
ci_017                 1.634373e-02 3 1  ON 16
ci_018                 9.874381e-03 3 1  ON 17
ci_019                 1.026109e-02 3 1  ON 18
ci_020                 1.579732e-02 3 1  ON 19
ci_021                 1.592493e-02 3 1  ON 20
ci_022                 9.112828e-03 3 1  ON 21
ci_023                 9.111216e-03 3 1  ON 22
ci_024                 9.623757e-03 3 1  ON 23
ci_025                 9.587607e-03 3 1  ON 24
ci_026                 1.071034e-02 3 1  ON 25
ci_027                 1.103204e-02 3 1  ON 26
ci_028                -1.507303e-02 3 1  ON 27
ci_029                -1.568746e-02 3 1  ON 28
ci_030                -8.960962e-03 3 1  ON 29
ci_031                -9.348158e-03 3 1  ON 30
ci_032                -1.472667e-02 3 1  ON 31
ci_033                 6.270640e-03 3 1  ON 32
ci_034                 5.748024e-03 3 1  ON 33
ci_035                -4.278848e-03 3 1  ON 34
ci_036                -1.205839e-02 3 1  ON 35
ci_037                -1.231136e-02 3 1  ON 36
ci_038                 1.854538e-03 3 1  ON 37
ci_039                 2.115189e-03 3 1  ON 38
ci_040                -2.541615e-03 3 1  ON 39
ci_041                 8.523325e-03 3 1  ON 40
ci_042                 8.524792e-03 3 1  ON 41
ci_043                -3.215674e-03 3 1  ON 42
ci_044                -4.919671e-03 3 1  ON 43
ci_045                -2.756293e-03 3 1  ON 44
ci_046                 5.438055e-03 3 1  ON 45
ci_047                 5.451145e-03 3 1  ON 46
ci_048                -1.255947e-02 3 1  ON 47
ci_049                -1.273343e-02 3 1  ON 48
ci_050                 3.539543e-03 3 1  ON 49
ci_051                 3.497372e-03 3 1  ON 50
ci_052                -2.788930e-03 3 1  ON 51
ci_053                -2.830602e-03 3 1  ON 52
ci_054                -2.958078e-03 3 1  ON 53
ci_055                -3.223318e-03 3 1  ON 54
ci_056                 5.141069e-03 3 1  ON 55
ci_057                 5.320662e-03 3 1  ON 56
ci_058                -2.536084e-03 3 1  ON 57
ci_059                -2.493999e-03 3 1  ON 58
ci_060                 5.248797e-03 3 1  ON 59
ci_061                 5.932540e-03 3 1  ON 60
ci_062                -3.642802e-03 3 1  ON 61
ci_063                -3.702865e-03 3 1  ON 62
ci_064                -2.764336e-03 3 1  ON 63
ci_065                -3.791036e-03 3 1  ON 64
ci_066                 4.283566e-03 3 1  ON 65
ci_067                 4.386551e-03 3 1  ON 66
ci_068                -5.153840e-03 3 1  ON 67
ci_069                -4.480126e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1508
    reference variance = 0.165219
====================================================
  Execution time = 1.3777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0175e-01
  Total weights = 1.957661525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289001387367
                                         uncertainty =       0.001982177139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289001387367
                                         uncertainty =       0.001982177139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380165903
  error estimate for blocks of size 2^( 2) =       0.000391368453
  error estimate for blocks of size 2^( 3) =       0.000401587907
  error estimate for blocks of size 2^( 4) =       0.000409929110
  error estimate for blocks of size 2^( 5) =       0.000413692206
  error estimate for blocks of size 2^( 6) =       0.000415412764
  error estimate for blocks of size 2^( 7) =       0.000417165396

      target function =      -0.899255558655
              le_mean =     -17.214921466636
             les_mean =     296.655275874685
             stat err =       0.000414049869
             autocorr =       1.186202887450
   target nu stat err =       0.000414049869
   target dn stat err =       0.002380194557
      target stat err =       0.003053768910
              std dev =       0.537635776539
             le_variance =       0.289052228214


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721492146664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899265300964       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899268655517       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899269175326       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899269355229       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899269379746       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899269383193       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899269384373       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899269385270       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899269384659       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899269384548       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 8.319286e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899265300964       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899266141629       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899266271817       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899266316836       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899266322964       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899266323824       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899266324120       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899266324344       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899266324191       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899266324163       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.083624e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899265300964       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899265511257       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899265543819       residual = 8.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899265555076       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899265556608       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899265556823       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899265556897       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899265556954       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899265556915       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899265556908       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+02 is 5.211443e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6264e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.050911e-02 3 1  ON 0
ci_002                -3.051603e-02 3 1  ON 1
ci_003                -2.506475e-02 3 1  ON 2
ci_004                 2.251352e-02 3 1  ON 3
ci_005                 2.295688e-02 3 1  ON 4
ci_006                -1.976254e-02 3 1  ON 5
ci_007                -1.973268e-02 3 1  ON 6
ci_008                -9.194201e-03 3 1  ON 7
ci_009                -1.487224e-02 3 1  ON 8
ci_010                -1.017149e-02 3 1  ON 9
ci_011                -1.046532e-02 3 1  ON 10
ci_012                -1.050875e-02 3 1  ON 11
ci_013                -2.011755e-02 3 1  ON 12
ci_014                 1.203886e-02 3 1  ON 13
ci_015                 1.231856e-02 3 1  ON 14
ci_016                 1.649655e-02 3 1  ON 15
ci_017                 1.634300e-02 3 1  ON 16
ci_018                 9.873859e-03 3 1  ON 17
ci_019                 1.025967e-02 3 1  ON 18
ci_020                 1.579683e-02 3 1  ON 19
ci_021                 1.592395e-02 3 1  ON 20
ci_022                 9.112413e-03 3 1  ON 21
ci_023                 9.110659e-03 3 1  ON 22
ci_024                 9.622924e-03 3 1  ON 23
ci_025                 9.586882e-03 3 1  ON 24
ci_026                 1.070967e-02 3 1  ON 25
ci_027                 1.103043e-02 3 1  ON 26
ci_028                -1.507241e-02 3 1  ON 27
ci_029                -1.568701e-02 3 1  ON 28
ci_030                -8.961078e-03 3 1  ON 29
ci_031                -9.348120e-03 3 1  ON 30
ci_032                -1.472625e-02 3 1  ON 31
ci_033                 6.271118e-03 3 1  ON 32
ci_034                 5.746923e-03 3 1  ON 33
ci_035                -4.277702e-03 3 1  ON 34
ci_036                -1.205810e-02 3 1  ON 35
ci_037                -1.231052e-02 3 1  ON 36
ci_038                 1.853924e-03 3 1  ON 37
ci_039                 2.113697e-03 3 1  ON 38
ci_040                -2.540521e-03 3 1  ON 39
ci_041                 8.523078e-03 3 1  ON 40
ci_042                 8.524575e-03 3 1  ON 41
ci_043                -3.214654e-03 3 1  ON 42
ci_044                -4.918836e-03 3 1  ON 43
ci_045                -2.755342e-03 3 1  ON 44
ci_046                 5.437690e-03 3 1  ON 45
ci_047                 5.450674e-03 3 1  ON 46
ci_048                -1.255983e-02 3 1  ON 47
ci_049                -1.273381e-02 3 1  ON 48
ci_050                 3.539725e-03 3 1  ON 49
ci_051                 3.496553e-03 3 1  ON 50
ci_052                -2.788138e-03 3 1  ON 51
ci_053                -2.830233e-03 3 1  ON 52
ci_054                -2.957626e-03 3 1  ON 53
ci_055                -3.222841e-03 3 1  ON 54
ci_056                 5.140469e-03 3 1  ON 55
ci_057                 5.319850e-03 3 1  ON 56
ci_058                -2.535528e-03 3 1  ON 57
ci_059                -2.493491e-03 3 1  ON 58
ci_060                 5.247889e-03 3 1  ON 59
ci_061                 5.932457e-03 3 1  ON 60
ci_062                -3.641947e-03 3 1  ON 61
ci_063                -3.701982e-03 3 1  ON 62
ci_064                -2.764094e-03 3 1  ON 63
ci_065                -3.790696e-03 3 1  ON 64
ci_066                 4.283496e-03 3 1  ON 65
ci_067                 4.386169e-03 3 1  ON 66
ci_068                -5.153990e-03 3 1  ON 67
ci_069                -4.479848e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1814
    reference variance = 0.155558
====================================================
  Execution time = 1.3331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9960e-01
  Total weights = 1.9574e+06
  Execution time = 1.8316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288148478401
                                         uncertainty =       0.002353517006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288148478401
                                         uncertainty =       0.002353517006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379571897
  error estimate for blocks of size 2^( 2) =       0.000390594276
  error estimate for blocks of size 2^( 3) =       0.000400160625
  error estimate for blocks of size 2^( 4) =       0.000407129571
  error estimate for blocks of size 2^( 5) =       0.000412061276
  error estimate for blocks of size 2^( 6) =       0.000413921423
  error estimate for blocks of size 2^( 7) =       0.000415875847

      target function =      -0.902109903166
              le_mean =     -17.215544618730
             les_mean =     296.674579538214
             stat err =       0.000412247029
             autocorr =       1.179578826962
   target nu stat err =       0.000412247029
   target dn stat err =       0.002660424750
      target stat err =       0.003425208031
              std dev =       0.536795724768
             le_variance =       0.288149650129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288140955468
                                         uncertainty =       0.002353156142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288140955468
                                         uncertainty =       0.002353156142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379566933
  error estimate for blocks of size 2^( 2) =       0.000390590141
  error estimate for blocks of size 2^( 3) =       0.000400157570
  error estimate for blocks of size 2^( 4) =       0.000407127371
  error estimate for blocks of size 2^( 5) =       0.000412059576
  error estimate for blocks of size 2^( 6) =       0.000413919784
  error estimate for blocks of size 2^( 7) =       0.000415873953

      target function =      -0.902139443437
              le_mean =     -17.215544605992
             les_mean =     296.674555831540
             stat err =       0.000412245171
             autocorr =       1.179599046320
   target nu stat err =       0.000412245171
   target dn stat err =       0.002658445940
      target stat err =       0.003422953788
              std dev =       0.536788704049
             le_variance =       0.288142112795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288144705430
                                         uncertainty =       0.002353336056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288144705430
                                         uncertainty =       0.002353336056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379569407
  error estimate for blocks of size 2^( 2) =       0.000390592202
  error estimate for blocks of size 2^( 3) =       0.000400159092
  error estimate for blocks of size 2^( 4) =       0.000407128466
  error estimate for blocks of size 2^( 5) =       0.000412060421
  error estimate for blocks of size 2^( 6) =       0.000413920599
  error estimate for blocks of size 2^( 7) =       0.000415874895

      target function =      -0.902125270115
              le_mean =     -17.215544611984
             les_mean =     296.674567201380
             stat err =       0.000412246095
             autocorr =       1.179588957056
   target nu stat err =       0.000412246095
   target dn stat err =       0.002659422557
      target stat err =       0.003424069413
              std dev =       0.536792203688
             le_variance =       0.288145869940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288148006178
                                         uncertainty =       0.002353494367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288148006178
                                         uncertainty =       0.002353494367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379571585
  error estimate for blocks of size 2^( 2) =       0.000390594016
  error estimate for blocks of size 2^( 3) =       0.000400160433
  error estimate for blocks of size 2^( 4) =       0.000407129432
  error estimate for blocks of size 2^( 5) =       0.000412061169
  error estimate for blocks of size 2^( 6) =       0.000413921320
  error estimate for blocks of size 2^( 7) =       0.000415875727

      target function =      -0.902111886243
              le_mean =     -17.215544617848
             les_mean =     296.674577945719
             stat err =       0.000412246912
             autocorr =       1.179580093700
   target nu stat err =       0.000412246912
   target dn stat err =       0.002660298180
      target stat err =       0.003425064552
              std dev =       0.536795284073
             le_variance =       0.288149177004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902109903166        initial
     2.3842e+01     2.3842e+02             8.3193e-06        -0.902139443437  <--
     9.5367e+01     9.5367e+02             2.0836e-06        -0.902125270115
     3.8147e+02     3.8147e+03             5.2114e-07        -0.902111886243

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.2639e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.050288e-02 3 1  ON 0
ci_002                -3.051234e-02 3 1  ON 1
ci_003                -2.505900e-02 3 1  ON 2
ci_004                 2.250925e-02 3 1  ON 3
ci_005                 2.295353e-02 3 1  ON 4
ci_006                -1.975999e-02 3 1  ON 5
ci_007                -1.973111e-02 3 1  ON 6
ci_008                -9.190826e-03 3 1  ON 7
ci_009                -1.486956e-02 3 1  ON 8
ci_010                -1.017025e-02 3 1  ON 9
ci_011                -1.046126e-02 3 1  ON 10
ci_012                -1.050755e-02 3 1  ON 11
ci_013                -2.011557e-02 3 1  ON 12
ci_014                 1.203579e-02 3 1  ON 13
ci_015                 1.231591e-02 3 1  ON 14
ci_016                 1.649567e-02 3 1  ON 15
ci_017                 1.634082e-02 3 1  ON 16
ci_018                 9.872297e-03 3 1  ON 17
ci_019                 1.025540e-02 3 1  ON 18
ci_020                 1.579535e-02 3 1  ON 19
ci_021                 1.592102e-02 3 1  ON 20
ci_022                 9.111175e-03 3 1  ON 21
ci_023                 9.108992e-03 3 1  ON 22
ci_024                 9.620431e-03 3 1  ON 23
ci_025                 9.584712e-03 3 1  ON 24
ci_026                 1.070766e-02 3 1  ON 25
ci_027                 1.102560e-02 3 1  ON 26
ci_028                -1.507056e-02 3 1  ON 27
ci_029                -1.568568e-02 3 1  ON 28
ci_030                -8.961426e-03 3 1  ON 29
ci_031                -9.348006e-03 3 1  ON 30
ci_032                -1.472500e-02 3 1  ON 31
ci_033                 6.272546e-03 3 1  ON 32
ci_034                 5.743629e-03 3 1  ON 33
ci_035                -4.274276e-03 3 1  ON 34
ci_036                -1.205724e-02 3 1  ON 35
ci_037                -1.230802e-02 3 1  ON 36
ci_038                 1.852087e-03 3 1  ON 37
ci_039                 2.109236e-03 3 1  ON 38
ci_040                -2.537248e-03 3 1  ON 39
ci_041                 8.522340e-03 3 1  ON 40
ci_042                 8.523928e-03 3 1  ON 41
ci_043                -3.211603e-03 3 1  ON 42
ci_044                -4.916339e-03 3 1  ON 43
ci_045                -2.752497e-03 3 1  ON 44
ci_046                 5.436600e-03 3 1  ON 45
ci_047                 5.449262e-03 3 1  ON 46
ci_048                -1.256092e-02 3 1  ON 47
ci_049                -1.273492e-02 3 1  ON 48
ci_050                 3.540269e-03 3 1  ON 49
ci_051                 3.494104e-03 3 1  ON 50
ci_052                -2.785772e-03 3 1  ON 51
ci_053                -2.829129e-03 3 1  ON 52
ci_054                -2.956274e-03 3 1  ON 53
ci_055                -3.221415e-03 3 1  ON 54
ci_056                 5.138674e-03 3 1  ON 55
ci_057                 5.317423e-03 3 1  ON 56
ci_058                -2.533866e-03 3 1  ON 57
ci_059                -2.491972e-03 3 1  ON 58
ci_060                 5.245173e-03 3 1  ON 59
ci_061                 5.932208e-03 3 1  ON 60
ci_062                -3.639388e-03 3 1  ON 61
ci_063                -3.699341e-03 3 1  ON 62
ci_064                -2.763369e-03 3 1  ON 63
ci_065                -3.789679e-03 3 1  ON 64
ci_066                 4.283288e-03 3 1  ON 65
ci_067                 4.385027e-03 3 1  ON 66
ci_068                -5.154438e-03 3 1  ON 67
ci_069                -4.479017e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8969e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2172
    reference variance = 0.153554
====================================================
  Execution time = 1.3866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0247e-01
  Total weights = 1.957467923e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287624387246
                                         uncertainty =       0.001762075871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287624387246
                                         uncertainty =       0.001762075871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379209772
  error estimate for blocks of size 2^( 2) =       0.000390404187
  error estimate for blocks of size 2^( 3) =       0.000400357055
  error estimate for blocks of size 2^( 4) =       0.000407324236
  error estimate for blocks of size 2^( 5) =       0.000412309116
  error estimate for blocks of size 2^( 6) =       0.000415132692
  error estimate for blocks of size 2^( 7) =       0.000416738555

      target function =      -0.898461097488
              le_mean =     -17.215425255993
             les_mean =     296.673332653382
             stat err =       0.000412876150
             autocorr =       1.185442656854
   target nu stat err =       0.000412876150
   target dn stat err =       0.003161872806
      target stat err =       0.004020744618
              std dev =       0.536283602885
             le_variance =       0.287600102723


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721542525599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898478385140       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898491814741       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898493993945       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898494553845       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898494679272       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898494667922       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898494669398       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898494667387       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898494665375       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898494665435       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.242099e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898478385140       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898481774634       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898482323192       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898482463775       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898482495186       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898482492322       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898482492679       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898482492188       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898482491678       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898482491693       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 8.165608e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898478385140       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898479234543       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898479371919       residual = 7.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898479407103       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898479414959       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898479414241       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898479414330       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898479414208       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898479414080       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898479414084       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+01 is 2.045210e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.463445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6345e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.049471e-02 3 1  ON 0
ci_002                -3.050741e-02 3 1  ON 1
ci_003                -2.505743e-02 3 1  ON 2
ci_004                 2.250503e-02 3 1  ON 3
ci_005                 2.295174e-02 3 1  ON 4
ci_006                -1.975502e-02 3 1  ON 5
ci_007                -1.972490e-02 3 1  ON 6
ci_008                -9.186210e-03 3 1  ON 7
ci_009                -1.486569e-02 3 1  ON 8
ci_010                -1.016715e-02 3 1  ON 9
ci_011                -1.045835e-02 3 1  ON 10
ci_012                -1.050371e-02 3 1  ON 11
ci_013                -2.011179e-02 3 1  ON 12
ci_014                 1.203319e-02 3 1  ON 13
ci_015                 1.231181e-02 3 1  ON 14
ci_016                 1.649308e-02 3 1  ON 15
ci_017                 1.634025e-02 3 1  ON 16
ci_018                 9.866595e-03 3 1  ON 17
ci_019                 1.025273e-02 3 1  ON 18
ci_020                 1.579462e-02 3 1  ON 19
ci_021                 1.591779e-02 3 1  ON 20
ci_022                 9.108005e-03 3 1  ON 21
ci_023                 9.105185e-03 3 1  ON 22
ci_024                 9.620133e-03 3 1  ON 23
ci_025                 9.580991e-03 3 1  ON 24
ci_026                 1.070368e-02 3 1  ON 25
ci_027                 1.102187e-02 3 1  ON 26
ci_028                -1.506694e-02 3 1  ON 27
ci_029                -1.568153e-02 3 1  ON 28
ci_030                -8.956743e-03 3 1  ON 29
ci_031                -9.342054e-03 3 1  ON 30
ci_032                -1.472400e-02 3 1  ON 31
ci_033                 6.268176e-03 3 1  ON 32
ci_034                 5.739641e-03 3 1  ON 33
ci_035                -4.270662e-03 3 1  ON 34
ci_036                -1.205482e-02 3 1  ON 35
ci_037                -1.230553e-02 3 1  ON 36
ci_038                 1.849335e-03 3 1  ON 37
ci_039                 2.105600e-03 3 1  ON 38
ci_040                -2.534564e-03 3 1  ON 39
ci_041                 8.518948e-03 3 1  ON 40
ci_042                 8.522447e-03 3 1  ON 41
ci_043                -3.208444e-03 3 1  ON 42
ci_044                -4.915537e-03 3 1  ON 43
ci_045                -2.750072e-03 3 1  ON 44
ci_046                 5.433636e-03 3 1  ON 45
ci_047                 5.445716e-03 3 1  ON 46
ci_048                -1.255942e-02 3 1  ON 47
ci_049                -1.273274e-02 3 1  ON 48
ci_050                 3.538511e-03 3 1  ON 49
ci_051                 3.494042e-03 3 1  ON 50
ci_052                -2.784748e-03 3 1  ON 51
ci_053                -2.825161e-03 3 1  ON 52
ci_054                -2.953937e-03 3 1  ON 53
ci_055                -3.218264e-03 3 1  ON 54
ci_056                 5.135865e-03 3 1  ON 55
ci_057                 5.315683e-03 3 1  ON 56
ci_058                -2.532197e-03 3 1  ON 57
ci_059                -2.489130e-03 3 1  ON 58
ci_060                 5.246135e-03 3 1  ON 59
ci_061                 5.930012e-03 3 1  ON 60
ci_062                -3.637119e-03 3 1  ON 61
ci_063                -3.700251e-03 3 1  ON 62
ci_064                -2.762109e-03 3 1  ON 63
ci_065                -3.787327e-03 3 1  ON 64
ci_066                 4.284872e-03 3 1  ON 65
ci_067                 4.383115e-03 3 1  ON 66
ci_068                -5.151495e-03 3 1  ON 67
ci_069                -4.479647e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.0738
    reference variance = 0.194
====================================================
  Execution time = 1.3801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0052e-01
  Total weights = 1.9571e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287672119262
                                         uncertainty =       0.001672679106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287672119262
                                         uncertainty =       0.001672679106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379237964
  error estimate for blocks of size 2^( 2) =       0.000390213374
  error estimate for blocks of size 2^( 3) =       0.000399609142
  error estimate for blocks of size 2^( 4) =       0.000407033942
  error estimate for blocks of size 2^( 5) =       0.000411931410
  error estimate for blocks of size 2^( 6) =       0.000415034643
  error estimate for blocks of size 2^( 7) =       0.000415666934

      target function =      -0.900882581236
              le_mean =     -17.215317543215
             les_mean =     296.667692495374
             stat err =       0.000412416732
             autocorr =       1.182630137253
   target nu stat err =       0.000412416732
   target dn stat err =       0.002351529464
      target stat err =       0.003030486503
              std dev =       0.536323471655
             le_variance =       0.287642866248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287645543269
                                         uncertainty =       0.001672437389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287645543269
                                         uncertainty =       0.001672437389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379220477
  error estimate for blocks of size 2^( 2) =       0.000390200247
  error estimate for blocks of size 2^( 3) =       0.000399601062
  error estimate for blocks of size 2^( 4) =       0.000407029733
  error estimate for blocks of size 2^( 5) =       0.000411929186
  error estimate for blocks of size 2^( 6) =       0.000415035001
  error estimate for blocks of size 2^( 7) =       0.000415667004

      target function =      -0.900931351861
              le_mean =     -17.215317851579
             les_mean =     296.667664652780
             stat err =       0.000412415231
             autocorr =       1.182730597501
   target nu stat err =       0.000412415231
   target dn stat err =       0.002345524675
      target stat err =       0.003023353079
              std dev =       0.536298741152
             le_variance =       0.287616339761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287658661684
                                         uncertainty =       0.001672556207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287658661684
                                         uncertainty =       0.001672556207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379229109
  error estimate for blocks of size 2^( 2) =       0.000390206717
  error estimate for blocks of size 2^( 3) =       0.000399605029
  error estimate for blocks of size 2^( 4) =       0.000407031780
  error estimate for blocks of size 2^( 5) =       0.000411930249
  error estimate for blocks of size 2^( 6) =       0.000415034785
  error estimate for blocks of size 2^( 7) =       0.000415666932

      target function =      -0.900908322004
              le_mean =     -17.215317691875
             les_mean =     296.667677311371
             stat err =       0.000412415937
             autocorr =       1.182680802908
   target nu stat err =       0.000412415937
   target dn stat err =       0.002348465378
      target stat err =       0.003026852209
              std dev =       0.536310948691
             le_variance =       0.287629433686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287670427614
                                         uncertainty =       0.001672663595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287670427614
                                         uncertainty =       0.001672663595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379236851
  error estimate for blocks of size 2^( 2) =       0.000390212536
  error estimate for blocks of size 2^( 3) =       0.000399608623
  error estimate for blocks of size 2^( 4) =       0.000407033667
  error estimate for blocks of size 2^( 5) =       0.000411931261
  error estimate for blocks of size 2^( 6) =       0.000415034657
  error estimate for blocks of size 2^( 7) =       0.000415666930

      target function =      -0.900886055269
              le_mean =     -17.215317561085
             les_mean =     296.667690369942
             stat err =       0.000412416629
             autocorr =       1.182636483659
   target nu stat err =       0.000412416629
   target dn stat err =       0.002351141887
      target stat err =       0.003030028250
              std dev =       0.536321897500
             le_variance =       0.287641177738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900882581236        initial
     5.9605e+00     5.9605e+01             3.2421e-05        -0.900931351861  <--
     2.3842e+01     2.3842e+02             8.1656e-06        -0.900908322004
     9.5367e+01     9.5367e+02             2.0452e-06        -0.900886055269

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.3070e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.047046e-02 3 1  ON 0
ci_002                -3.049278e-02 3 1  ON 1
ci_003                -2.505277e-02 3 1  ON 2
ci_004                 2.249249e-02 3 1  ON 3
ci_005                 2.294642e-02 3 1  ON 4
ci_006                -1.974028e-02 3 1  ON 5
ci_007                -1.970647e-02 3 1  ON 6
ci_008                -9.172539e-03 3 1  ON 7
ci_009                -1.485419e-02 3 1  ON 8
ci_010                -1.015793e-02 3 1  ON 9
ci_011                -1.044972e-02 3 1  ON 10
ci_012                -1.049233e-02 3 1  ON 11
ci_013                -2.010058e-02 3 1  ON 12
ci_014                 1.202548e-02 3 1  ON 13
ci_015                 1.229963e-02 3 1  ON 14
ci_016                 1.648539e-02 3 1  ON 15
ci_017                 1.633858e-02 3 1  ON 16
ci_018                 9.849700e-03 3 1  ON 17
ci_019                 1.024483e-02 3 1  ON 18
ci_020                 1.579246e-02 3 1  ON 19
ci_021                 1.590817e-02 3 1  ON 20
ci_022                 9.098618e-03 3 1  ON 21
ci_023                 9.093895e-03 3 1  ON 22
ci_024                 9.619244e-03 3 1  ON 23
ci_025                 9.569944e-03 3 1  ON 24
ci_026                 1.069188e-02 3 1  ON 25
ci_027                 1.101080e-02 3 1  ON 26
ci_028                -1.505617e-02 3 1  ON 27
ci_029                -1.566922e-02 3 1  ON 28
ci_030                -8.942860e-03 3 1  ON 29
ci_031                -9.324414e-03 3 1  ON 30
ci_032                -1.472106e-02 3 1  ON 31
ci_033                 6.255201e-03 3 1  ON 32
ci_034                 5.727810e-03 3 1  ON 33
ci_035                -4.259952e-03 3 1  ON 34
ci_036                -1.204764e-02 3 1  ON 35
ci_037                -1.229814e-02 3 1  ON 36
ci_038                 1.841180e-03 3 1  ON 37
ci_039                 2.094826e-03 3 1  ON 38
ci_040                -2.526614e-03 3 1  ON 39
ci_041                 8.508893e-03 3 1  ON 40
ci_042                 8.518055e-03 3 1  ON 41
ci_043                -3.199079e-03 3 1  ON 42
ci_044                -4.913160e-03 3 1  ON 43
ci_045                -2.742888e-03 3 1  ON 44
ci_046                 5.424841e-03 3 1  ON 45
ci_047                 5.435196e-03 3 1  ON 46
ci_048                -1.255497e-02 3 1  ON 47
ci_049                -1.272627e-02 3 1  ON 48
ci_050                 3.533309e-03 3 1  ON 49
ci_051                 3.493862e-03 3 1  ON 50
ci_052                -2.781724e-03 3 1  ON 51
ci_053                -2.813413e-03 3 1  ON 52
ci_054                -2.947002e-03 3 1  ON 53
ci_055                -3.208916e-03 3 1  ON 54
ci_056                 5.127540e-03 3 1  ON 55
ci_057                 5.310524e-03 3 1  ON 56
ci_058                -2.527262e-03 3 1  ON 57
ci_059                -2.480714e-03 3 1  ON 58
ci_060                 5.248990e-03 3 1  ON 59
ci_061                 5.923492e-03 3 1  ON 60
ci_062                -3.630392e-03 3 1  ON 61
ci_063                -3.702940e-03 3 1  ON 62
ci_064                -2.758378e-03 3 1  ON 63
ci_065                -3.780360e-03 3 1  ON 64
ci_066                 4.289573e-03 3 1  ON 65
ci_067                 4.377453e-03 3 1  ON 66
ci_068                -5.142772e-03 3 1  ON 67
ci_069                -4.481518e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.42168
====================================================
  Execution time = 1.3582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0231e-01
  Total weights = 1.957118375e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288347592445
                                         uncertainty =       0.002173967454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288347592445
                                         uncertainty =       0.002173967454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379745447
  error estimate for blocks of size 2^( 2) =       0.000391165633
  error estimate for blocks of size 2^( 3) =       0.000401077076
  error estimate for blocks of size 2^( 4) =       0.000408341376
  error estimate for blocks of size 2^( 5) =       0.000413261539
  error estimate for blocks of size 2^( 6) =       0.000414710734
  error estimate for blocks of size 2^( 7) =       0.000416738835

      target function =      -0.898603634154
              le_mean =     -17.215152860733
             les_mean =     296.663795328842
             stat err =       0.000413263121
             autocorr =       1.184317514666
   target nu stat err =       0.000413263121
   target dn stat err =       0.003036461722
      target stat err =       0.003864280226
              std dev =       0.537041161088
             le_variance =       0.288413208703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721515286073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898619576577       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898663382876       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898671927430       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898673717990       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898674088638       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898674052546       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898674058212       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898674052696       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898674050983       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898674050110       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.169511e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898619576577       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898630943966       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898633140995       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898633595134       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898633689071       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898633679644       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898633680996       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898633679633       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898633679202       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898633678985       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.023799e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898619576577       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898622445656       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898622998845       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898623112783       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898623136346       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898623133963       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898623134297       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898623133957       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898623133849       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898623133795       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 7.624704e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.466880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6078e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.044811e-02 3 1  ON 0
ci_002                -3.047315e-02 3 1  ON 1
ci_003                -2.503361e-02 3 1  ON 2
ci_004                 2.248144e-02 3 1  ON 3
ci_005                 2.292516e-02 3 1  ON 4
ci_006                -1.972446e-02 3 1  ON 5
ci_007                -1.969270e-02 3 1  ON 6
ci_008                -9.152924e-03 3 1  ON 7
ci_009                -1.484188e-02 3 1  ON 8
ci_010                -1.014476e-02 3 1  ON 9
ci_011                -1.044209e-02 3 1  ON 10
ci_012                -1.047594e-02 3 1  ON 11
ci_013                -2.008987e-02 3 1  ON 12
ci_014                 1.202145e-02 3 1  ON 13
ci_015                 1.227540e-02 3 1  ON 14
ci_016                 1.646964e-02 3 1  ON 15
ci_017                 1.633705e-02 3 1  ON 16
ci_018                 9.855733e-03 3 1  ON 17
ci_019                 1.022385e-02 3 1  ON 18
ci_020                 1.578410e-02 3 1  ON 19
ci_021                 1.589459e-02 3 1  ON 20
ci_022                 9.089332e-03 3 1  ON 21
ci_023                 9.083349e-03 3 1  ON 22
ci_024                 9.604900e-03 3 1  ON 23
ci_025                 9.553112e-03 3 1  ON 24
ci_026                 1.069107e-02 3 1  ON 25
ci_027                 1.099860e-02 3 1  ON 26
ci_028                -1.505197e-02 3 1  ON 27
ci_029                -1.565905e-02 3 1  ON 28
ci_030                -8.938348e-03 3 1  ON 29
ci_031                -9.310036e-03 3 1  ON 30
ci_032                -1.471365e-02 3 1  ON 31
ci_033                 6.228775e-03 3 1  ON 32
ci_034                 5.718370e-03 3 1  ON 33
ci_035                -4.250732e-03 3 1  ON 34
ci_036                -1.204068e-02 3 1  ON 35
ci_037                -1.230073e-02 3 1  ON 36
ci_038                 1.832609e-03 3 1  ON 37
ci_039                 2.076998e-03 3 1  ON 38
ci_040                -2.506764e-03 3 1  ON 39
ci_041                 8.496556e-03 3 1  ON 40
ci_042                 8.513704e-03 3 1  ON 41
ci_043                -3.190140e-03 3 1  ON 42
ci_044                -4.909351e-03 3 1  ON 43
ci_045                -2.724603e-03 3 1  ON 44
ci_046                 5.418964e-03 3 1  ON 45
ci_047                 5.432211e-03 3 1  ON 46
ci_048                -1.253617e-02 3 1  ON 47
ci_049                -1.271920e-02 3 1  ON 48
ci_050                 3.533110e-03 3 1  ON 49
ci_051                 3.487410e-03 3 1  ON 50
ci_052                -2.780633e-03 3 1  ON 51
ci_053                -2.807344e-03 3 1  ON 52
ci_054                -2.940046e-03 3 1  ON 53
ci_055                -3.202519e-03 3 1  ON 54
ci_056                 5.132471e-03 3 1  ON 55
ci_057                 5.306377e-03 3 1  ON 56
ci_058                -2.517978e-03 3 1  ON 57
ci_059                -2.485763e-03 3 1  ON 58
ci_060                 5.257236e-03 3 1  ON 59
ci_061                 5.915841e-03 3 1  ON 60
ci_062                -3.625000e-03 3 1  ON 61
ci_063                -3.694918e-03 3 1  ON 62
ci_064                -2.754256e-03 3 1  ON 63
ci_065                -3.775558e-03 3 1  ON 64
ci_066                 4.284599e-03 3 1  ON 65
ci_067                 4.379646e-03 3 1  ON 66
ci_068                -5.112534e-03 3 1  ON 67
ci_069                -4.476584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.208617
====================================================
  Execution time = 1.3693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0248e-01
  Total weights = 1.9575e+06
  Execution time = 1.8213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289482626111
                                         uncertainty =       0.001873548944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289482626111
                                         uncertainty =       0.001873548944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380408006
  error estimate for blocks of size 2^( 2) =       0.000391285106
  error estimate for blocks of size 2^( 3) =       0.000401256230
  error estimate for blocks of size 2^( 4) =       0.000407980591
  error estimate for blocks of size 2^( 5) =       0.000412267230
  error estimate for blocks of size 2^( 6) =       0.000414640613
  error estimate for blocks of size 2^( 7) =       0.000417025683

      target function =      -0.898251686167
              le_mean =     -17.214900771495
             les_mean =     296.655357403382
             stat err =       0.000412978529
             autocorr =       1.178570724519
   target nu stat err =       0.000412978529
   target dn stat err =       0.002456943757
      target stat err =       0.003141455947
              std dev =       0.537978161622
             le_variance =       0.289420502382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289391330451
                                         uncertainty =       0.001870196220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289391330451
                                         uncertainty =       0.001870196220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380348081
  error estimate for blocks of size 2^( 2) =       0.000391240539
  error estimate for blocks of size 2^( 3) =       0.000401228314
  error estimate for blocks of size 2^( 4) =       0.000407964513
  error estimate for blocks of size 2^( 5) =       0.000412259454
  error estimate for blocks of size 2^( 6) =       0.000414638481
  error estimate for blocks of size 2^( 7) =       0.000417014010

      target function =      -0.898571484233
              le_mean =     -17.214902367440
             les_mean =     296.655158318010
             stat err =       0.000412969115
             autocorr =       1.178888375929
   target nu stat err =       0.000412969115
   target dn stat err =       0.002447224259
      target stat err =       0.003131645620
              std dev =       0.537893415126
             le_variance =       0.289329326036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289434647632
                                         uncertainty =       0.001871803587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289434647632
                                         uncertainty =       0.001871803587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380376514
  error estimate for blocks of size 2^( 2) =       0.000391261543
  error estimate for blocks of size 2^( 3) =       0.000401241251
  error estimate for blocks of size 2^( 4) =       0.000407971727
  error estimate for blocks of size 2^( 5) =       0.000412262653
  error estimate for blocks of size 2^( 6) =       0.000414638972
  error estimate for blocks of size 2^( 7) =       0.000417019095

      target function =      -0.898493833412
              le_mean =     -17.214901506691
             les_mean =     296.655190271765
             stat err =       0.000412973112
             autocorr =       1.178734958210
   target nu stat err =       0.000412973112
   target dn stat err =       0.002449013850
      target stat err =       0.003133322203
              std dev =       0.537933625416
             le_variance =       0.289372585353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289476490735
                                         uncertainty =       0.001873328099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289476490735
                                         uncertainty =       0.001873328099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380403979
  error estimate for blocks of size 2^( 2) =       0.000391282077
  error estimate for blocks of size 2^( 3) =       0.000401254284
  error estimate for blocks of size 2^( 4) =       0.000407979412
  error estimate for blocks of size 2^( 5) =       0.000412266592
  error estimate for blocks of size 2^( 6) =       0.000414640344
  error estimate for blocks of size 2^( 7) =       0.000417024793

      target function =      -0.898206226959
              le_mean =     -17.214900846229
             les_mean =     296.655396166443
             stat err =       0.000412977785
             autocorr =       1.178591431478
   target nu stat err =       0.000412977785
   target dn stat err =       0.002456311114
      target stat err =       0.003140362069
              std dev =       0.537972466530
             le_variance =       0.289414374745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898251686167        initial
     1.4901e+00     1.4901e+01             1.1695e-04        -0.898571484233  <--
     5.9605e+00     5.9605e+01             3.0238e-05        -0.898493833412
     2.3842e+01     2.3842e+02             7.6247e-06        -0.898206226959

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.2904e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.038368e-02 3 1  ON 0
ci_002                -3.041676e-02 3 1  ON 1
ci_003                -2.497846e-02 3 1  ON 2
ci_004                 2.244974e-02 3 1  ON 3
ci_005                 2.286385e-02 3 1  ON 4
ci_006                -1.967897e-02 3 1  ON 5
ci_007                -1.965310e-02 3 1  ON 6
ci_008                -9.097032e-03 3 1  ON 7
ci_009                -1.480665e-02 3 1  ON 8
ci_010                -1.010697e-02 3 1  ON 9
ci_011                -1.042021e-02 3 1  ON 10
ci_012                -1.042899e-02 3 1  ON 11
ci_013                -2.005894e-02 3 1  ON 12
ci_014                 1.200986e-02 3 1  ON 13
ci_015                 1.220591e-02 3 1  ON 14
ci_016                 1.642443e-02 3 1  ON 15
ci_017                 1.633281e-02 3 1  ON 16
ci_018                 9.872896e-03 3 1  ON 17
ci_019                 1.016389e-02 3 1  ON 18
ci_020                 1.575990e-02 3 1  ON 19
ci_021                 1.585571e-02 3 1  ON 20
ci_022                 9.062767e-03 3 1  ON 21
ci_023                 9.053150e-03 3 1  ON 22
ci_024                 9.563522e-03 3 1  ON 23
ci_025                 9.504517e-03 3 1  ON 24
ci_026                 1.068870e-02 3 1  ON 25
ci_027                 1.096353e-02 3 1  ON 26
ci_028                -1.503987e-02 3 1  ON 27
ci_029                -1.562989e-02 3 1  ON 28
ci_030                -8.925250e-03 3 1  ON 29
ci_031                -9.268891e-03 3 1  ON 30
ci_032                -1.469238e-02 3 1  ON 31
ci_033                 6.152863e-03 3 1  ON 32
ci_034                 5.691203e-03 3 1  ON 33
ci_035                -4.224383e-03 3 1  ON 34
ci_036                -1.202060e-02 3 1  ON 35
ci_037                -1.230785e-02 3 1  ON 36
ci_038                 1.808128e-03 3 1  ON 37
ci_039                 2.026076e-03 3 1  ON 38
ci_040                -2.450142e-03 3 1  ON 39
ci_041                 8.461372e-03 3 1  ON 40
ci_042                 8.501245e-03 3 1  ON 41
ci_043                -3.164587e-03 3 1  ON 42
ci_044                -4.898446e-03 3 1  ON 43
ci_045                -2.672421e-03 3 1  ON 44
ci_046                 5.402094e-03 3 1  ON 45
ci_047                 5.423651e-03 3 1  ON 46
ci_048                -1.248210e-02 3 1  ON 47
ci_049                -1.269881e-02 3 1  ON 48
ci_050                 3.532534e-03 3 1  ON 49
ci_051                 3.469041e-03 3 1  ON 50
ci_052                -2.777570e-03 3 1  ON 51
ci_053                -2.790093e-03 3 1  ON 52
ci_054                -2.920052e-03 3 1  ON 53
ci_055                -3.184254e-03 3 1  ON 54
ci_056                 5.146582e-03 3 1  ON 55
ci_057                 5.294504e-03 3 1  ON 56
ci_058                -2.491663e-03 3 1  ON 57
ci_059                -2.500200e-03 3 1  ON 58
ci_060                 5.280897e-03 3 1  ON 59
ci_061                 5.893848e-03 3 1  ON 60
ci_062                -3.609445e-03 3 1  ON 61
ci_063                -3.671813e-03 3 1  ON 62
ci_064                -2.742516e-03 3 1  ON 63
ci_065                -3.761857e-03 3 1  ON 64
ci_066                 4.270490e-03 3 1  ON 65
ci_067                 4.385967e-03 3 1  ON 66
ci_068                -5.025821e-03 3 1  ON 67
ci_069                -4.462491e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.502598
====================================================
  Execution time = 1.3633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0020e-01
  Total weights = 1.957361115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287326998632
                                         uncertainty =       0.001667782488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287326998632
                                         uncertainty =       0.001667782488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379038304
  error estimate for blocks of size 2^( 2) =       0.000390009444
  error estimate for blocks of size 2^( 3) =       0.000400470605
  error estimate for blocks of size 2^( 4) =       0.000407715126
  error estimate for blocks of size 2^( 5) =       0.000413057773
  error estimate for blocks of size 2^( 6) =       0.000414254334
  error estimate for blocks of size 2^( 7) =       0.000415234223

      target function =      -0.901379327548
              le_mean =     -17.215652486619
             les_mean =     296.678890751368
             stat err =       0.000412565364
             autocorr =       1.184729845397
   target nu stat err =       0.000412565364
   target dn stat err =       0.002345798722
      target stat err =       0.003028265068
              std dev =       0.536041110127
             le_variance =       0.287340071746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721565248662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901388586586       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901519589764       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901555420191       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901563128605       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901563867191       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901563746797       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901563846739       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901563857431       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901563826536       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901563826896       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 4.587845e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901388586586       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901426156279       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901436130668       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901438147632       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901438333698       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901438300471       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901438322372       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901438327265       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901438318585       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901438318776       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.278202e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901388586586       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901398337645       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901400903477       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901401412746       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901401459204       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901401450733       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901401455950       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901401457313       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901401455092       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901401455147       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.289704e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6135e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.025585e-02 3 1  ON 0
ci_002                -3.034368e-02 3 1  ON 1
ci_003                -2.492702e-02 3 1  ON 2
ci_004                 2.235432e-02 3 1  ON 3
ci_005                 2.279086e-02 3 1  ON 4
ci_006                -1.958514e-02 3 1  ON 5
ci_007                -1.959432e-02 3 1  ON 6
ci_008                -9.031082e-03 3 1  ON 7
ci_009                -1.478692e-02 3 1  ON 8
ci_010                -1.003912e-02 3 1  ON 9
ci_011                -1.040994e-02 3 1  ON 10
ci_012                -1.037366e-02 3 1  ON 11
ci_013                -2.004286e-02 3 1  ON 12
ci_014                 1.196758e-02 3 1  ON 13
ci_015                 1.215500e-02 3 1  ON 14
ci_016                 1.639851e-02 3 1  ON 15
ci_017                 1.631211e-02 3 1  ON 16
ci_018                 9.867899e-03 3 1  ON 17
ci_019                 1.011161e-02 3 1  ON 18
ci_020                 1.571659e-02 3 1  ON 19
ci_021                 1.575747e-02 3 1  ON 20
ci_022                 9.028514e-03 3 1  ON 21
ci_023                 9.008675e-03 3 1  ON 22
ci_024                 9.544036e-03 3 1  ON 23
ci_025                 9.467238e-03 3 1  ON 24
ci_026                 1.064369e-02 3 1  ON 25
ci_027                 1.087771e-02 3 1  ON 26
ci_028                -1.498841e-02 3 1  ON 27
ci_029                -1.558073e-02 3 1  ON 28
ci_030                -8.929707e-03 3 1  ON 29
ci_031                -9.264958e-03 3 1  ON 30
ci_032                -1.472391e-02 3 1  ON 31
ci_033                 6.155810e-03 3 1  ON 32
ci_034                 5.717415e-03 3 1  ON 33
ci_035                -4.165162e-03 3 1  ON 34
ci_036                -1.202885e-02 3 1  ON 35
ci_037                -1.226138e-02 3 1  ON 36
ci_038                 1.759933e-03 3 1  ON 37
ci_039                 1.973536e-03 3 1  ON 38
ci_040                -2.436367e-03 3 1  ON 39
ci_041                 8.417809e-03 3 1  ON 40
ci_042                 8.450814e-03 3 1  ON 41
ci_043                -3.106750e-03 3 1  ON 42
ci_044                -4.859158e-03 3 1  ON 43
ci_045                -2.631787e-03 3 1  ON 44
ci_046                 5.348505e-03 3 1  ON 45
ci_047                 5.377755e-03 3 1  ON 46
ci_048                -1.252199e-02 3 1  ON 47
ci_049                -1.269726e-02 3 1  ON 48
ci_050                 3.502386e-03 3 1  ON 49
ci_051                 3.434314e-03 3 1  ON 50
ci_052                -2.743560e-03 3 1  ON 51
ci_053                -2.760071e-03 3 1  ON 52
ci_054                -2.882759e-03 3 1  ON 53
ci_055                -3.178350e-03 3 1  ON 54
ci_056                 5.142236e-03 3 1  ON 55
ci_057                 5.275401e-03 3 1  ON 56
ci_058                -2.474252e-03 3 1  ON 57
ci_059                -2.476909e-03 3 1  ON 58
ci_060                 5.255040e-03 3 1  ON 59
ci_061                 5.861065e-03 3 1  ON 60
ci_062                -3.584508e-03 3 1  ON 61
ci_063                -3.633082e-03 3 1  ON 62
ci_064                -2.718262e-03 3 1  ON 63
ci_065                -3.729600e-03 3 1  ON 64
ci_066                 4.257572e-03 3 1  ON 65
ci_067                 4.391853e-03 3 1  ON 66
ci_068                -5.004339e-03 3 1  ON 67
ci_069                -4.493679e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1916
    reference variance = 0.251194
====================================================
  Execution time = 1.3546e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9899e-01
  Total weights = 1.9575e+06
  Execution time = 1.8266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286863096566
                                         uncertainty =       0.001543937721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286863096566
                                         uncertainty =       0.001543937721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378836688
  error estimate for blocks of size 2^( 2) =       0.000389850706
  error estimate for blocks of size 2^( 3) =       0.000400112335
  error estimate for blocks of size 2^( 4) =       0.000407578602
  error estimate for blocks of size 2^( 5) =       0.000412483369
  error estimate for blocks of size 2^( 6) =       0.000414744299
  error estimate for blocks of size 2^( 7) =       0.000414423511

      target function =      -0.902749518704
              le_mean =     -17.215935946823
             les_mean =     296.687621018537
             stat err =       0.000412307445
             autocorr =       1.184508803810
   target nu stat err =       0.000412307445
   target dn stat err =       0.002222028146
      target stat err =       0.002884269617
              std dev =       0.535755981440
             le_variance =       0.287034471649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286546997607
                                         uncertainty =       0.001531620070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286546997607
                                         uncertainty =       0.001531620070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378631784
  error estimate for blocks of size 2^( 2) =       0.000389693141
  error estimate for blocks of size 2^( 3) =       0.000400005747
  error estimate for blocks of size 2^( 4) =       0.000407512791
  error estimate for blocks of size 2^( 5) =       0.000412439689
  error estimate for blocks of size 2^( 6) =       0.000414698886
  error estimate for blocks of size 2^( 7) =       0.000414384113

      target function =      -0.884648404109
              le_mean =     -17.215939627631
             les_mean =     296.701981209149
             stat err =       0.000412258870
             autocorr =       1.185511803092
   target nu stat err =       0.000412258870
   target dn stat err =       0.014793397957
      target stat err =       0.018078825186
              std dev =       0.535466203415
             le_variance =       0.286724054999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286674999847
                                         uncertainty =       0.001536864336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286674999847
                                         uncertainty =       0.001536864336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378714649
  error estimate for blocks of size 2^( 2) =       0.000389755620
  error estimate for blocks of size 2^( 3) =       0.000400046828
  error estimate for blocks of size 2^( 4) =       0.000407535401
  error estimate for blocks of size 2^( 5) =       0.000412452333
  error estimate for blocks of size 2^( 6) =       0.000414712058
  error estimate for blocks of size 2^( 7) =       0.000414389951

      target function =      -0.903148955418
              le_mean =     -17.215936196409
             les_mean =     296.687315871107
             stat err =       0.000412272436
             autocorr =       1.185071050823
   target nu stat err =       0.000412272436
   target dn stat err =       0.002183581951
      target stat err =       0.002838853159
              std dev =       0.535583393085
             le_variance =       0.286849570949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286837714686
                                         uncertainty =       0.001542997905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286837714686
                                         uncertainty =       0.001542997905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378820208
  error estimate for blocks of size 2^( 2) =       0.000389837675
  error estimate for blocks of size 2^( 3) =       0.000400103105
  error estimate for blocks of size 2^( 4) =       0.000407572250
  error estimate for blocks of size 2^( 5) =       0.000412478607
  error estimate for blocks of size 2^( 6) =       0.000414739369
  error estimate for blocks of size 2^( 7) =       0.000414418391

      target function =      -0.902799180114
              le_mean =     -17.215935827413
             les_mean =     296.687577862065
             stat err =       0.000412302154
             autocorr =       1.184581461293
   target nu stat err =       0.000412302154
   target dn stat err =       0.002216756805
      target stat err =       0.002878012915
              std dev =       0.535732675742
             le_variance =       0.287009499857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902749518704        initial
     3.7253e-01     3.7253e+00             4.5878e-04        -0.884648404109
     1.4901e+00     1.4901e+01             1.2782e-04        -0.903148955418  <--
     5.9605e+00     5.9605e+01             3.2897e-05        -0.902799180114

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.2785e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.025585e-02 3 1  ON 0
ci_002                -3.034368e-02 3 1  ON 1
ci_003                -2.492702e-02 3 1  ON 2
ci_004                 2.235432e-02 3 1  ON 3
ci_005                 2.279086e-02 3 1  ON 4
ci_006                -1.958514e-02 3 1  ON 5
ci_007                -1.959432e-02 3 1  ON 6
ci_008                -9.031082e-03 3 1  ON 7
ci_009                -1.478692e-02 3 1  ON 8
ci_010                -1.003912e-02 3 1  ON 9
ci_011                -1.040994e-02 3 1  ON 10
ci_012                -1.037366e-02 3 1  ON 11
ci_013                -2.004286e-02 3 1  ON 12
ci_014                 1.196758e-02 3 1  ON 13
ci_015                 1.215500e-02 3 1  ON 14
ci_016                 1.639851e-02 3 1  ON 15
ci_017                 1.631211e-02 3 1  ON 16
ci_018                 9.867899e-03 3 1  ON 17
ci_019                 1.011161e-02 3 1  ON 18
ci_020                 1.571659e-02 3 1  ON 19
ci_021                 1.575747e-02 3 1  ON 20
ci_022                 9.028514e-03 3 1  ON 21
ci_023                 9.008675e-03 3 1  ON 22
ci_024                 9.544036e-03 3 1  ON 23
ci_025                 9.467238e-03 3 1  ON 24
ci_026                 1.064369e-02 3 1  ON 25
ci_027                 1.087771e-02 3 1  ON 26
ci_028                -1.498841e-02 3 1  ON 27
ci_029                -1.558073e-02 3 1  ON 28
ci_030                -8.929707e-03 3 1  ON 29
ci_031                -9.264958e-03 3 1  ON 30
ci_032                -1.472391e-02 3 1  ON 31
ci_033                 6.155810e-03 3 1  ON 32
ci_034                 5.717415e-03 3 1  ON 33
ci_035                -4.165162e-03 3 1  ON 34
ci_036                -1.202885e-02 3 1  ON 35
ci_037                -1.226138e-02 3 1  ON 36
ci_038                 1.759933e-03 3 1  ON 37
ci_039                 1.973536e-03 3 1  ON 38
ci_040                -2.436367e-03 3 1  ON 39
ci_041                 8.417809e-03 3 1  ON 40
ci_042                 8.450814e-03 3 1  ON 41
ci_043                -3.106750e-03 3 1  ON 42
ci_044                -4.859158e-03 3 1  ON 43
ci_045                -2.631787e-03 3 1  ON 44
ci_046                 5.348505e-03 3 1  ON 45
ci_047                 5.377755e-03 3 1  ON 46
ci_048                -1.252199e-02 3 1  ON 47
ci_049                -1.269726e-02 3 1  ON 48
ci_050                 3.502386e-03 3 1  ON 49
ci_051                 3.434314e-03 3 1  ON 50
ci_052                -2.743560e-03 3 1  ON 51
ci_053                -2.760071e-03 3 1  ON 52
ci_054                -2.882759e-03 3 1  ON 53
ci_055                -3.178350e-03 3 1  ON 54
ci_056                 5.142236e-03 3 1  ON 55
ci_057                 5.275401e-03 3 1  ON 56
ci_058                -2.474252e-03 3 1  ON 57
ci_059                -2.476909e-03 3 1  ON 58
ci_060                 5.255040e-03 3 1  ON 59
ci_061                 5.861065e-03 3 1  ON 60
ci_062                -3.584508e-03 3 1  ON 61
ci_063                -3.633082e-03 3 1  ON 62
ci_064                -2.718262e-03 3 1  ON 63
ci_065                -3.729600e-03 3 1  ON 64
ci_066                 4.257572e-03 3 1  ON 65
ci_067                 4.391853e-03 3 1  ON 66
ci_068                -5.004339e-03 3 1  ON 67
ci_069                -4.493679e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.274746
====================================================
  Execution time = 1.4034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9922e-01
  Total weights = 1.957482785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287177175109
                                         uncertainty =       0.001919082116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287177175109
                                         uncertainty =       0.001919082116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378914921
  error estimate for blocks of size 2^( 2) =       0.000389939443
  error estimate for blocks of size 2^( 3) =       0.000400000196
  error estimate for blocks of size 2^( 4) =       0.000407212493
  error estimate for blocks of size 2^( 5) =       0.000411911665
  error estimate for blocks of size 2^( 6) =       0.000413135480
  error estimate for blocks of size 2^( 7) =       0.000413568081

      target function =      -0.902620763418
              le_mean =     -17.215672466200
             les_mean =     296.678600126590
             stat err =       0.000411456930
             autocorr =       1.179139935606
   target nu stat err =       0.000411456930
   target dn stat err =       0.002796782495
      target stat err =       0.003600418153
              std dev =       0.535866619790
             le_variance =       0.287153034205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721567246620e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902634598843       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902750519251       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902775650763       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902780250522       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902781733078       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902782106033       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902781959421       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902781957655       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902781936412       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902781937462       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 3.387048e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902634598843       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902667747232       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902674698299       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902675911756       residual = 8.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902676292301       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902676386757       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902676348358       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902676348830       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902676343237       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902676343926       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 9.626093e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902634598843       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902643195000       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902644979714       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902645286935       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902645382498       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902645406136       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902645396445       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902645396631       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902645395217       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902645395416       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.492015e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6532e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.017634e-02 3 1  ON 0
ci_002                -3.029630e-02 3 1  ON 1
ci_003                -2.485405e-02 3 1  ON 2
ci_004                 2.228561e-02 3 1  ON 3
ci_005                 2.272435e-02 3 1  ON 4
ci_006                -1.950229e-02 3 1  ON 5
ci_007                -1.953897e-02 3 1  ON 6
ci_008                -9.016679e-03 3 1  ON 7
ci_009                -1.475762e-02 3 1  ON 8
ci_010                -9.974340e-03 3 1  ON 9
ci_011                -1.035375e-02 3 1  ON 10
ci_012                -1.028416e-02 3 1  ON 11
ci_013                -1.998046e-02 3 1  ON 12
ci_014                 1.189430e-02 3 1  ON 13
ci_015                 1.214928e-02 3 1  ON 14
ci_016                 1.640979e-02 3 1  ON 15
ci_017                 1.630265e-02 3 1  ON 16
ci_018                 9.847457e-03 3 1  ON 17
ci_019                 1.010010e-02 3 1  ON 18
ci_020                 1.567445e-02 3 1  ON 19
ci_021                 1.571220e-02 3 1  ON 20
ci_022                 9.030576e-03 3 1  ON 21
ci_023                 9.001650e-03 3 1  ON 22
ci_024                 9.464085e-03 3 1  ON 23
ci_025                 9.423318e-03 3 1  ON 24
ci_026                 1.057538e-02 3 1  ON 25
ci_027                 1.086388e-02 3 1  ON 26
ci_028                -1.495209e-02 3 1  ON 27
ci_029                -1.556921e-02 3 1  ON 28
ci_030                -8.913984e-03 3 1  ON 29
ci_031                -9.254915e-03 3 1  ON 30
ci_032                -1.471968e-02 3 1  ON 31
ci_033                 6.090523e-03 3 1  ON 32
ci_034                 5.662878e-03 3 1  ON 33
ci_035                -4.131885e-03 3 1  ON 34
ci_036                -1.200507e-02 3 1  ON 35
ci_037                -1.216512e-02 3 1  ON 36
ci_038                 1.704865e-03 3 1  ON 37
ci_039                 1.911576e-03 3 1  ON 38
ci_040                -2.383945e-03 3 1  ON 39
ci_041                 8.435437e-03 3 1  ON 40
ci_042                 8.426912e-03 3 1  ON 41
ci_043                -3.067787e-03 3 1  ON 42
ci_044                -4.837367e-03 3 1  ON 43
ci_045                -2.597801e-03 3 1  ON 44
ci_046                 5.344800e-03 3 1  ON 45
ci_047                 5.361666e-03 3 1  ON 46
ci_048                -1.255208e-02 3 1  ON 47
ci_049                -1.272236e-02 3 1  ON 48
ci_050                 3.516626e-03 3 1  ON 49
ci_051                 3.408636e-03 3 1  ON 50
ci_052                -2.761280e-03 3 1  ON 51
ci_053                -2.784229e-03 3 1  ON 52
ci_054                -2.817721e-03 3 1  ON 53
ci_055                -3.133720e-03 3 1  ON 54
ci_056                 5.095735e-03 3 1  ON 55
ci_057                 5.248510e-03 3 1  ON 56
ci_058                -2.480671e-03 3 1  ON 57
ci_059                -2.527502e-03 3 1  ON 58
ci_060                 5.207331e-03 3 1  ON 59
ci_061                 5.856279e-03 3 1  ON 60
ci_062                -3.562198e-03 3 1  ON 61
ci_063                -3.622928e-03 3 1  ON 62
ci_064                -2.700813e-03 3 1  ON 63
ci_065                -3.713462e-03 3 1  ON 64
ci_066                 4.262982e-03 3 1  ON 65
ci_067                 4.371830e-03 3 1  ON 66
ci_068                -4.939613e-03 3 1  ON 67
ci_069                -4.483730e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.199613
====================================================
  Execution time = 1.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9773e-01
  Total weights = 1.9571e+06
  Execution time = 1.8297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285459326152
                                         uncertainty =       0.001692246069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285459326152
                                         uncertainty =       0.001692246069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377806956
  error estimate for blocks of size 2^( 2) =       0.000389098901
  error estimate for blocks of size 2^( 3) =       0.000398583219
  error estimate for blocks of size 2^( 4) =       0.000405275726
  error estimate for blocks of size 2^( 5) =       0.000410207886
  error estimate for blocks of size 2^( 6) =       0.000413984415
  error estimate for blocks of size 2^( 7) =       0.000412265108

      target function =      -0.904374946943
              le_mean =     -17.215495811476
             les_mean =     296.671112157307
             stat err =       0.000410433284
             autocorr =       1.180171830890
   target nu stat err =       0.000410433284
   target dn stat err =       0.002313365688
      target stat err =       0.003006145406
              std dev =       0.534299721435
             le_variance =       0.285476192325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228422161
                                         uncertainty =       0.001688218847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285228422161
                                         uncertainty =       0.001688218847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377654430
  error estimate for blocks of size 2^( 2) =       0.000388978033
  error estimate for blocks of size 2^( 3) =       0.000398505130
  error estimate for blocks of size 2^( 4) =       0.000405228833
  error estimate for blocks of size 2^( 5) =       0.000410170577
  error estimate for blocks of size 2^( 6) =       0.000413961720
  error estimate for blocks of size 2^( 7) =       0.000412247242

      target function =      -0.792996229637
              le_mean =     -17.215499314987
             les_mean =     296.760840951003
             stat err =       0.000410402093
             autocorr =       1.180945804033
   target nu stat err =       0.000410402093
   target dn stat err =       0.089477074904
      target stat err =       0.088825431630
              std dev =       0.534084016337
             le_variance =       0.285245736507

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285321500700
                                         uncertainty =       0.001689934817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285321500700
                                         uncertainty =       0.001689934817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377715924
  error estimate for blocks of size 2^( 2) =       0.000389025664
  error estimate for blocks of size 2^( 3) =       0.000398533886
  error estimate for blocks of size 2^( 4) =       0.000405244249
  error estimate for blocks of size 2^( 5) =       0.000410183638
  error estimate for blocks of size 2^( 6) =       0.000413967611
  error estimate for blocks of size 2^( 7) =       0.000412251911

      target function =      -0.904078562282
              le_mean =     -17.215496118214
             les_mean =     296.671355353229
             stat err =       0.000410411852
             autocorr =       1.180617451667
   target nu stat err =       0.000410411852
   target dn stat err =       0.002302755087
      target stat err =       0.002990939975
              std dev =       0.534170982866
             le_variance =       0.285338638936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285440623398
                                         uncertainty =       0.001691937091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285440623398
                                         uncertainty =       0.001691937091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377794604
  error estimate for blocks of size 2^( 2) =       0.000389088823
  error estimate for blocks of size 2^( 3) =       0.000398576203
  error estimate for blocks of size 2^( 4) =       0.000405271003
  error estimate for blocks of size 2^( 5) =       0.000410204073
  error estimate for blocks of size 2^( 6) =       0.000413981580
  error estimate for blocks of size 2^( 7) =       0.000412262761

      target function =      -0.904418673454
              le_mean =     -17.215495720019
             les_mean =     296.671074754410
             stat err =       0.000410429854
             autocorr =       1.180229280194
   target nu stat err =       0.000410429854
   target dn stat err =       0.002305352700
      target stat err =       0.002996402063
              std dev =       0.534282252874
             le_variance =       0.285457525736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904374946943        initial
     3.7253e-01     3.7253e+00             3.3870e-04        -0.792996229637
     1.4901e+00     1.4901e+01             9.6261e-05        -0.904078562282
     5.9605e+00     5.9605e+01             2.4920e-05        -0.904418673454  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.2977e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.023540e-02 3 1  ON 0
ci_002                -3.033145e-02 3 1  ON 1
ci_003                -2.490830e-02 3 1  ON 2
ci_004                 2.233668e-02 3 1  ON 3
ci_005                 2.277373e-02 3 1  ON 4
ci_006                -1.956379e-02 3 1  ON 5
ci_007                -1.958006e-02 3 1  ON 6
ci_008                -9.027383e-03 3 1  ON 7
ci_009                -1.477933e-02 3 1  ON 8
ci_010                -1.002237e-02 3 1  ON 9
ci_011                -1.039540e-02 3 1  ON 10
ci_012                -1.035048e-02 3 1  ON 11
ci_013                -2.002682e-02 3 1  ON 12
ci_014                 1.194869e-02 3 1  ON 13
ci_015                 1.215352e-02 3 1  ON 14
ci_016                 1.640137e-02 3 1  ON 15
ci_017                 1.630963e-02 3 1  ON 16
ci_018                 9.862609e-03 3 1  ON 17
ci_019                 1.010865e-02 3 1  ON 18
ci_020                 1.570573e-02 3 1  ON 19
ci_021                 1.574579e-02 3 1  ON 20
ci_022                 9.029050e-03 3 1  ON 21
ci_023                 9.006857e-03 3 1  ON 22
ci_024                 9.523433e-03 3 1  ON 23
ci_025                 9.455920e-03 3 1  ON 24
ci_026                 1.062602e-02 3 1  ON 25
ci_027                 1.087418e-02 3 1  ON 26
ci_028                -1.497900e-02 3 1  ON 27
ci_029                -1.557774e-02 3 1  ON 28
ci_030                -8.925605e-03 3 1  ON 29
ci_031                -9.262337e-03 3 1  ON 30
ci_032                -1.472281e-02 3 1  ON 31
ci_033                 6.138962e-03 3 1  ON 32
ci_034                 5.703329e-03 3 1  ON 33
ci_035                -4.156536e-03 3 1  ON 34
ci_036                -1.202276e-02 3 1  ON 35
ci_037                -1.223646e-02 3 1  ON 36
ci_038                 1.745649e-03 3 1  ON 37
ci_039                 1.957468e-03 3 1  ON 38
ci_040                -2.422759e-03 3 1  ON 39
ci_041                 8.422386e-03 3 1  ON 40
ci_042                 8.444607e-03 3 1  ON 41
ci_043                -3.096651e-03 3 1  ON 42
ci_044                -4.853515e-03 3 1  ON 43
ci_045                -2.622967e-03 3 1  ON 44
ci_046                 5.347544e-03 3 1  ON 45
ci_047                 5.373594e-03 3 1  ON 46
ci_048                -1.252967e-02 3 1  ON 47
ci_049                -1.270365e-02 3 1  ON 48
ci_050                 3.506094e-03 3 1  ON 49
ci_051                 3.427638e-03 3 1  ON 50
ci_052                -2.748159e-03 3 1  ON 51
ci_053                -2.766346e-03 3 1  ON 52
ci_054                -2.865940e-03 3 1  ON 53
ci_055                -3.166813e-03 3 1  ON 54
ci_056                 5.130192e-03 3 1  ON 55
ci_057                 5.268438e-03 3 1  ON 56
ci_058                -2.475921e-03 3 1  ON 57
ci_059                -2.489997e-03 3 1  ON 58
ci_060                 5.242719e-03 3 1  ON 59
ci_061                 5.859830e-03 3 1  ON 60
ci_062                -3.578764e-03 3 1  ON 61
ci_063                -3.630472e-03 3 1  ON 62
ci_064                -2.713729e-03 3 1  ON 63
ci_065                -3.725412e-03 3 1  ON 64
ci_066                 4.258954e-03 3 1  ON 65
ci_067                 4.386646e-03 3 1  ON 66
ci_068                -4.987604e-03 3 1  ON 67
ci_069                -4.491090e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1402
    reference variance = 0.193495
====================================================
  Execution time = 1.3990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0016e-01
  Total weights = 1.957350382e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914604854
                                         uncertainty =       0.001872446121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285914604854
                                         uncertainty =       0.001872446121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378066326
  error estimate for blocks of size 2^( 2) =       0.000389106612
  error estimate for blocks of size 2^( 3) =       0.000398838539
  error estimate for blocks of size 2^( 4) =       0.000405450295
  error estimate for blocks of size 2^( 5) =       0.000410251755
  error estimate for blocks of size 2^( 6) =       0.000412087518
  error estimate for blocks of size 2^( 7) =       0.000413015348

      target function =      -0.901354328827
              le_mean =     -17.215329076074
             les_mean =     296.667713250614
             stat err =       0.000410201229
             autocorr =       1.177220783018
   target nu stat err =       0.000410201229
   target dn stat err =       0.003080586381
      target stat err =       0.003943407342
              std dev =       0.534666525687
             le_variance =       0.285868293690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721532907607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901370943437       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901411699716       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901418138252       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901419872439       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901420126594       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901420085568       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901420040053       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901420054352       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901420049286       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901420042908       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.129232e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901370943437       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901381526420       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901383181063       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901383621948       residual = 9.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901383686088       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901383674910       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901383663646       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901383667255       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901383665934       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901383664378       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.906168e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901370943437       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901373615002       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901374031565       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901374142246       residual = 9.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901374158317       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901374155462       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901374152655       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901374153559       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901374153225       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901374152839       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 7.319289e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.481157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6547e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.020634e-02 3 1  ON 0
ci_002                -3.031848e-02 3 1  ON 1
ci_003                -2.488947e-02 3 1  ON 2
ci_004                 2.232221e-02 3 1  ON 3
ci_005                 2.274598e-02 3 1  ON 4
ci_006                -1.955972e-02 3 1  ON 5
ci_007                -1.956628e-02 3 1  ON 6
ci_008                -9.009640e-03 3 1  ON 7
ci_009                -1.476402e-02 3 1  ON 8
ci_010                -1.001324e-02 3 1  ON 9
ci_011                -1.036991e-02 3 1  ON 10
ci_012                -1.033304e-02 3 1  ON 11
ci_013                -2.002253e-02 3 1  ON 12
ci_014                 1.194837e-02 3 1  ON 13
ci_015                 1.213897e-02 3 1  ON 14
ci_016                 1.639700e-02 3 1  ON 15
ci_017                 1.630367e-02 3 1  ON 16
ci_018                 9.865348e-03 3 1  ON 17
ci_019                 1.011865e-02 3 1  ON 18
ci_020                 1.569313e-02 3 1  ON 19
ci_021                 1.572481e-02 3 1  ON 20
ci_022                 9.018061e-03 3 1  ON 21
ci_023                 8.995097e-03 3 1  ON 22
ci_024                 9.527955e-03 3 1  ON 23
ci_025                 9.448378e-03 3 1  ON 24
ci_026                 1.061342e-02 3 1  ON 25
ci_027                 1.088237e-02 3 1  ON 26
ci_028                -1.497396e-02 3 1  ON 27
ci_029                -1.556821e-02 3 1  ON 28
ci_030                -8.899118e-03 3 1  ON 29
ci_031                -9.257043e-03 3 1  ON 30
ci_032                -1.472189e-02 3 1  ON 31
ci_033                 6.128277e-03 3 1  ON 32
ci_034                 5.705159e-03 3 1  ON 33
ci_035                -4.144023e-03 3 1  ON 34
ci_036                -1.202639e-02 3 1  ON 35
ci_037                -1.222536e-02 3 1  ON 36
ci_038                 1.740591e-03 3 1  ON 37
ci_039                 1.945123e-03 3 1  ON 38
ci_040                -2.413505e-03 3 1  ON 39
ci_041                 8.421494e-03 3 1  ON 40
ci_042                 8.442299e-03 3 1  ON 41
ci_043                -3.084534e-03 3 1  ON 42
ci_044                -4.860061e-03 3 1  ON 43
ci_045                -2.628354e-03 3 1  ON 44
ci_046                 5.336618e-03 3 1  ON 45
ci_047                 5.363470e-03 3 1  ON 46
ci_048                -1.253350e-02 3 1  ON 47
ci_049                -1.271139e-02 3 1  ON 48
ci_050                 3.505709e-03 3 1  ON 49
ci_051                 3.422536e-03 3 1  ON 50
ci_052                -2.747537e-03 3 1  ON 51
ci_053                -2.769930e-03 3 1  ON 52
ci_054                -2.864275e-03 3 1  ON 53
ci_055                -3.163349e-03 3 1  ON 54
ci_056                 5.118402e-03 3 1  ON 55
ci_057                 5.261098e-03 3 1  ON 56
ci_058                -2.470501e-03 3 1  ON 57
ci_059                -2.484355e-03 3 1  ON 58
ci_060                 5.238734e-03 3 1  ON 59
ci_061                 5.840097e-03 3 1  ON 60
ci_062                -3.566759e-03 3 1  ON 61
ci_063                -3.630825e-03 3 1  ON 62
ci_064                -2.706993e-03 3 1  ON 63
ci_065                -3.718277e-03 3 1  ON 64
ci_066                 4.259239e-03 3 1  ON 65
ci_067                 4.392724e-03 3 1  ON 66
ci_068                -4.983691e-03 3 1  ON 67
ci_069                -4.490667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1575
    reference variance = 0.289793
====================================================
  Execution time = 1.3460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0483e-01
  Total weights = 1.9572e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291249549016
                                         uncertainty =       0.001545889974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291249549016
                                         uncertainty =       0.001545889974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381577978
  error estimate for blocks of size 2^( 2) =       0.000392190718
  error estimate for blocks of size 2^( 3) =       0.000401633904
  error estimate for blocks of size 2^( 4) =       0.000408930954
  error estimate for blocks of size 2^( 5) =       0.000413106963
  error estimate for blocks of size 2^( 6) =       0.000415509291
  error estimate for blocks of size 2^( 7) =       0.000417458727

      target function =      -0.894957460375
              le_mean =     -17.215255735391
             les_mean =     296.670265209763
             stat err =       0.000413751484
             autocorr =       1.175743330832
   target nu stat err =       0.000413751484
   target dn stat err =       0.002899350706
      target stat err =       0.003664932942
              std dev =       0.539632751669
             le_variance =       0.291203506674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291182473364
                                         uncertainty =       0.001545065209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291182473364
                                         uncertainty =       0.001545065209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381534069
  error estimate for blocks of size 2^( 2) =       0.000392158094
  error estimate for blocks of size 2^( 3) =       0.000401612590
  error estimate for blocks of size 2^( 4) =       0.000408918515
  error estimate for blocks of size 2^( 5) =       0.000413100359
  error estimate for blocks of size 2^( 6) =       0.000415504260
  error estimate for blocks of size 2^( 7) =       0.000417456221

      target function =      -0.895523074819
              le_mean =     -17.215256777014
             les_mean =     296.669848469258
             stat err =       0.000413744839
             autocorr =       1.175976194890
   target nu stat err =       0.000413744839
   target dn stat err =       0.002891258616
      target stat err =       0.003659526039
              std dev =       0.539570654600
             le_variance =       0.291136491305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291214246182
                                         uncertainty =       0.001545455093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291214246182
                                         uncertainty =       0.001545455093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381554868
  error estimate for blocks of size 2^( 2) =       0.000392173427
  error estimate for blocks of size 2^( 3) =       0.000401622443
  error estimate for blocks of size 2^( 4) =       0.000408924027
  error estimate for blocks of size 2^( 5) =       0.000413103039
  error estimate for blocks of size 2^( 6) =       0.000415506312
  error estimate for blocks of size 2^( 7) =       0.000417456866

      target function =      -0.895557359116
              le_mean =     -17.215256228626
             les_mean =     296.669802140508
             stat err =       0.000413747561
             autocorr =       1.175863460209
   target nu stat err =       0.000413747561
   target dn stat err =       0.002881957857
      target stat err =       0.003648320396
              std dev =       0.539600069595
             le_variance =       0.291168235107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291245023053
                                         uncertainty =       0.001545834048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291245023053
                                         uncertainty =       0.001545834048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381575015
  error estimate for blocks of size 2^( 2) =       0.000392188487
  error estimate for blocks of size 2^( 3) =       0.000401632407
  error estimate for blocks of size 2^( 4) =       0.000408930007
  error estimate for blocks of size 2^( 5) =       0.000413106395
  error estimate for blocks of size 2^( 6) =       0.000415508843
  error estimate for blocks of size 2^( 7) =       0.000417458401

      target function =      -0.895202342923
              le_mean =     -17.215255794357
             les_mean =     296.670071241823
             stat err =       0.000413750912
             autocorr =       1.175758336257
   target nu stat err =       0.000413750912
   target dn stat err =       0.002884377296
      target stat err =       0.003648446693
              std dev =       0.539628561780
             le_variance =       0.291198984689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894957460375        initial
     1.4901e+00     1.4901e+01             1.1292e-04        -0.895523074819
     5.9605e+00     5.9605e+01             2.9062e-05        -0.895557359116  <--
     2.3842e+01     2.3842e+02             7.3193e-06        -0.895202342923

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.2743e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.020634e-02 3 1  ON 0
ci_002                -3.031848e-02 3 1  ON 1
ci_003                -2.488947e-02 3 1  ON 2
ci_004                 2.232221e-02 3 1  ON 3
ci_005                 2.274598e-02 3 1  ON 4
ci_006                -1.955972e-02 3 1  ON 5
ci_007                -1.956628e-02 3 1  ON 6
ci_008                -9.009640e-03 3 1  ON 7
ci_009                -1.476402e-02 3 1  ON 8
ci_010                -1.001324e-02 3 1  ON 9
ci_011                -1.036991e-02 3 1  ON 10
ci_012                -1.033304e-02 3 1  ON 11
ci_013                -2.002253e-02 3 1  ON 12
ci_014                 1.194837e-02 3 1  ON 13
ci_015                 1.213897e-02 3 1  ON 14
ci_016                 1.639700e-02 3 1  ON 15
ci_017                 1.630367e-02 3 1  ON 16
ci_018                 9.865348e-03 3 1  ON 17
ci_019                 1.011865e-02 3 1  ON 18
ci_020                 1.569313e-02 3 1  ON 19
ci_021                 1.572481e-02 3 1  ON 20
ci_022                 9.018061e-03 3 1  ON 21
ci_023                 8.995097e-03 3 1  ON 22
ci_024                 9.527955e-03 3 1  ON 23
ci_025                 9.448378e-03 3 1  ON 24
ci_026                 1.061342e-02 3 1  ON 25
ci_027                 1.088237e-02 3 1  ON 26
ci_028                -1.497396e-02 3 1  ON 27
ci_029                -1.556821e-02 3 1  ON 28
ci_030                -8.899118e-03 3 1  ON 29
ci_031                -9.257043e-03 3 1  ON 30
ci_032                -1.472189e-02 3 1  ON 31
ci_033                 6.128277e-03 3 1  ON 32
ci_034                 5.705159e-03 3 1  ON 33
ci_035                -4.144023e-03 3 1  ON 34
ci_036                -1.202639e-02 3 1  ON 35
ci_037                -1.222536e-02 3 1  ON 36
ci_038                 1.740591e-03 3 1  ON 37
ci_039                 1.945123e-03 3 1  ON 38
ci_040                -2.413505e-03 3 1  ON 39
ci_041                 8.421494e-03 3 1  ON 40
ci_042                 8.442299e-03 3 1  ON 41
ci_043                -3.084534e-03 3 1  ON 42
ci_044                -4.860061e-03 3 1  ON 43
ci_045                -2.628354e-03 3 1  ON 44
ci_046                 5.336618e-03 3 1  ON 45
ci_047                 5.363470e-03 3 1  ON 46
ci_048                -1.253350e-02 3 1  ON 47
ci_049                -1.271139e-02 3 1  ON 48
ci_050                 3.505709e-03 3 1  ON 49
ci_051                 3.422536e-03 3 1  ON 50
ci_052                -2.747537e-03 3 1  ON 51
ci_053                -2.769930e-03 3 1  ON 52
ci_054                -2.864275e-03 3 1  ON 53
ci_055                -3.163349e-03 3 1  ON 54
ci_056                 5.118402e-03 3 1  ON 55
ci_057                 5.261098e-03 3 1  ON 56
ci_058                -2.470501e-03 3 1  ON 57
ci_059                -2.484355e-03 3 1  ON 58
ci_060                 5.238734e-03 3 1  ON 59
ci_061                 5.840097e-03 3 1  ON 60
ci_062                -3.566759e-03 3 1  ON 61
ci_063                -3.630825e-03 3 1  ON 62
ci_064                -2.706993e-03 3 1  ON 63
ci_065                -3.718277e-03 3 1  ON 64
ci_066                 4.259239e-03 3 1  ON 65
ci_067                 4.392724e-03 3 1  ON 66
ci_068                -4.983691e-03 3 1  ON 67
ci_069                -4.490667e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.232458
====================================================
  Execution time = 1.3599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9942e-01
  Total weights = 1.957621359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286371328172
                                         uncertainty =       0.001786357229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286371328172
                                         uncertainty =       0.001786357229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378375299
  error estimate for blocks of size 2^( 2) =       0.000389041868
  error estimate for blocks of size 2^( 3) =       0.000398538604
  error estimate for blocks of size 2^( 4) =       0.000406588811
  error estimate for blocks of size 2^( 5) =       0.000410348982
  error estimate for blocks of size 2^( 6) =       0.000412196334
  error estimate for blocks of size 2^( 7) =       0.000414510727

      target function =      -0.902288309892
              le_mean =     -17.215288233454
             les_mean =     296.665568370784
             stat err =       0.000410911213
             autocorr =       1.179370963183
   target nu stat err =       0.000410911213
   target dn stat err =       0.002397076700
      target stat err =       0.003095996783
              std dev =       0.535103479990
             le_variance =       0.286335734297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721528823345e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902298241078       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902341934297       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902350528381       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902353031866       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902353271707       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902353231674       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902353224584       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902353228171       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902353226924       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902353224901       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.202754e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902298241078       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902309584778       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902311793570       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902312429147       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902312489660       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902312479257       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902312477396       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902312478313       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902312477989       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902312477482       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.125614e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902298241078       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902301104552       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902301660638       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902301820137       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902301835298       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902301832672       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902301832201       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902301832432       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902301832350       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902301832223       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 7.891946e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8879e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.018778e-02 3 1  ON 0
ci_002                -3.029514e-02 3 1  ON 1
ci_003                -2.488377e-02 3 1  ON 2
ci_004                 2.230378e-02 3 1  ON 3
ci_005                 2.273402e-02 3 1  ON 4
ci_006                -1.954501e-02 3 1  ON 5
ci_007                -1.954288e-02 3 1  ON 6
ci_008                -8.978384e-03 3 1  ON 7
ci_009                -1.474601e-02 3 1  ON 8
ci_010                -9.998062e-03 3 1  ON 9
ci_011                -1.035439e-02 3 1  ON 10
ci_012                -1.032572e-02 3 1  ON 11
ci_013                -2.001289e-02 3 1  ON 12
ci_014                 1.193173e-02 3 1  ON 13
ci_015                 1.211957e-02 3 1  ON 14
ci_016                 1.639034e-02 3 1  ON 15
ci_017                 1.630320e-02 3 1  ON 16
ci_018                 9.868027e-03 3 1  ON 17
ci_019                 1.010404e-02 3 1  ON 18
ci_020                 1.567489e-02 3 1  ON 19
ci_021                 1.571065e-02 3 1  ON 20
ci_022                 9.003635e-03 3 1  ON 21
ci_023                 8.982718e-03 3 1  ON 22
ci_024                 9.517713e-03 3 1  ON 23
ci_025                 9.440476e-03 3 1  ON 24
ci_026                 1.060197e-02 3 1  ON 25
ci_027                 1.087344e-02 3 1  ON 26
ci_028                -1.496527e-02 3 1  ON 27
ci_029                -1.554294e-02 3 1  ON 28
ci_030                -8.897148e-03 3 1  ON 29
ci_031                -9.246928e-03 3 1  ON 30
ci_032                -1.472208e-02 3 1  ON 31
ci_033                 6.123577e-03 3 1  ON 32
ci_034                 5.690433e-03 3 1  ON 33
ci_035                -4.130269e-03 3 1  ON 34
ci_036                -1.203191e-02 3 1  ON 35
ci_037                -1.220372e-02 3 1  ON 36
ci_038                 1.725023e-03 3 1  ON 37
ci_039                 1.926628e-03 3 1  ON 38
ci_040                -2.408459e-03 3 1  ON 39
ci_041                 8.419759e-03 3 1  ON 40
ci_042                 8.432844e-03 3 1  ON 41
ci_043                -3.083697e-03 3 1  ON 42
ci_044                -4.857194e-03 3 1  ON 43
ci_045                -2.621686e-03 3 1  ON 44
ci_046                 5.332219e-03 3 1  ON 45
ci_047                 5.355439e-03 3 1  ON 46
ci_048                -1.253378e-02 3 1  ON 47
ci_049                -1.270748e-02 3 1  ON 48
ci_050                 3.501699e-03 3 1  ON 49
ci_051                 3.415640e-03 3 1  ON 50
ci_052                -2.748408e-03 3 1  ON 51
ci_053                -2.768224e-03 3 1  ON 52
ci_054                -2.858659e-03 3 1  ON 53
ci_055                -3.160224e-03 3 1  ON 54
ci_056                 5.109330e-03 3 1  ON 55
ci_057                 5.254746e-03 3 1  ON 56
ci_058                -2.467679e-03 3 1  ON 57
ci_059                -2.479862e-03 3 1  ON 58
ci_060                 5.233792e-03 3 1  ON 59
ci_061                 5.826700e-03 3 1  ON 60
ci_062                -3.558676e-03 3 1  ON 61
ci_063                -3.617472e-03 3 1  ON 62
ci_064                -2.704150e-03 3 1  ON 63
ci_065                -3.714520e-03 3 1  ON 64
ci_066                 4.256313e-03 3 1  ON 65
ci_067                 4.399102e-03 3 1  ON 66
ci_068                -4.981132e-03 3 1  ON 67
ci_069                -4.496838e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2038
    reference variance = 0.302885
====================================================
  Execution time = 1.3398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0174e-01
  Total weights = 1.9577e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287589610769
                                         uncertainty =       0.001682292371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287589610769
                                         uncertainty =       0.001682292371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379191372
  error estimate for blocks of size 2^( 2) =       0.000390244188
  error estimate for blocks of size 2^( 3) =       0.000400298699
  error estimate for blocks of size 2^( 4) =       0.000408040924
  error estimate for blocks of size 2^( 5) =       0.000412581097
  error estimate for blocks of size 2^( 6) =       0.000414487659
  error estimate for blocks of size 2^( 7) =       0.000412803723

      target function =      -0.899205933002
              le_mean =     -17.215146798844
             les_mean =     296.663112303845
             stat err =       0.000411978351
             autocorr =       1.180407325681
   target nu stat err =       0.000411978351
   target dn stat err =       0.002367940098
      target stat err =       0.003038799314
              std dev =       0.536257580444
             le_variance =       0.287572192584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287527095500
                                         uncertainty =       0.001680939287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287527095500
                                         uncertainty =       0.001680939287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379150238
  error estimate for blocks of size 2^( 2) =       0.000390218466
  error estimate for blocks of size 2^( 3) =       0.000400288305
  error estimate for blocks of size 2^( 4) =       0.000408042091
  error estimate for blocks of size 2^( 5) =       0.000412589562
  error estimate for blocks of size 2^( 6) =       0.000414502171
  error estimate for blocks of size 2^( 7) =       0.000412830990

      target function =      -0.899471204052
              le_mean =     -17.215148507283
             les_mean =     296.662961056791
             stat err =       0.000411991204
             autocorr =       1.180737128835
   target nu stat err =       0.000411991204
   target dn stat err =       0.002349126329
      target stat err =       0.003017287868
              std dev =       0.536199409417
             le_variance =       0.287509806659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287556647186
                                         uncertainty =       0.001681586825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287556647186
                                         uncertainty =       0.001681586825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379169682
  error estimate for blocks of size 2^( 2) =       0.000390230456
  error estimate for blocks of size 2^( 3) =       0.000400292884
  error estimate for blocks of size 2^( 4) =       0.000408041074
  error estimate for blocks of size 2^( 5) =       0.000412585052
  error estimate for blocks of size 2^( 6) =       0.000414494760
  error estimate for blocks of size 2^( 7) =       0.000412817449

      target function =      -0.899400549397
              le_mean =     -17.215147583261
             les_mean =     296.662985122044
             stat err =       0.000411984584
             autocorr =       1.180578096791
   target nu stat err =       0.000411984584
   target dn stat err =       0.002351051447
      target stat err =       0.003019198237
              std dev =       0.536226907297
             le_variance =       0.287539296110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287585381315
                                         uncertainty =       0.001682202997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287585381315
                                         uncertainty =       0.001682202997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379188589
  error estimate for blocks of size 2^( 2) =       0.000390242406
  error estimate for blocks of size 2^( 3) =       0.000400297914
  error estimate for blocks of size 2^( 4) =       0.000408040888
  error estimate for blocks of size 2^( 5) =       0.000412581546
  error estimate for blocks of size 2^( 6) =       0.000414488508
  error estimate for blocks of size 2^( 7) =       0.000412805412

      target function =      -0.899239496668
              le_mean =     -17.215146885560
             les_mean =     296.663088689883
             stat err =       0.000411979089
             autocorr =       1.180428880532
   target nu stat err =       0.000411979089
   target dn stat err =       0.002364267427
      target stat err =       0.003034479267
              std dev =       0.536253644850
             le_variance =       0.287567971614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899205933002        initial
     1.4901e+00     1.4901e+01             1.2028e-04        -0.899471204052  <--
     5.9605e+00     5.9605e+01             3.1256e-05        -0.899400549397
     2.3842e+01     2.3842e+02             7.8919e-06        -0.899239496668

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.2688e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.013428e-02 3 1  ON 0
ci_002                -3.022799e-02 3 1  ON 1
ci_003                -2.486715e-02 3 1  ON 2
ci_004                 2.225057e-02 3 1  ON 3
ci_005                 2.269953e-02 3 1  ON 4
ci_006                -1.950267e-02 3 1  ON 5
ci_007                -1.947546e-02 3 1  ON 6
ci_008                -8.889365e-03 3 1  ON 7
ci_009                -1.469443e-02 3 1  ON 8
ci_010                -9.954570e-03 3 1  ON 9
ci_011                -1.030994e-02 3 1  ON 10
ci_012                -1.030476e-02 3 1  ON 11
ci_013                -1.998503e-02 3 1  ON 12
ci_014                 1.188396e-02 3 1  ON 13
ci_015                 1.206385e-02 3 1  ON 14
ci_016                 1.637140e-02 3 1  ON 15
ci_017                 1.630205e-02 3 1  ON 16
ci_018                 9.875583e-03 3 1  ON 17
ci_019                 1.006216e-02 3 1  ON 18
ci_020                 1.562233e-02 3 1  ON 19
ci_021                 1.567007e-02 3 1  ON 20
ci_022                 8.962247e-03 3 1  ON 21
ci_023                 8.947211e-03 3 1  ON 22
ci_024                 9.488116e-03 3 1  ON 23
ci_025                 9.417609e-03 3 1  ON 24
ci_026                 1.056908e-02 3 1  ON 25
ci_027                 1.084783e-02 3 1  ON 26
ci_028                -1.494037e-02 3 1  ON 27
ci_029                -1.547020e-02 3 1  ON 28
ci_030                -8.891607e-03 3 1  ON 29
ci_031                -9.218046e-03 3 1  ON 30
ci_032                -1.472266e-02 3 1  ON 31
ci_033                 6.110084e-03 3 1  ON 32
ci_034                 5.648069e-03 3 1  ON 33
ci_035                -4.090962e-03 3 1  ON 34
ci_036                -1.204740e-02 3 1  ON 35
ci_037                -1.214183e-02 3 1  ON 36
ci_038                 1.680574e-03 3 1  ON 37
ci_039                 1.873803e-03 3 1  ON 38
ci_040                -2.394072e-03 3 1  ON 39
ci_041                 8.414788e-03 3 1  ON 40
ci_042                 8.405642e-03 3 1  ON 41
ci_043                -3.081312e-03 3 1  ON 42
ci_044                -4.848988e-03 3 1  ON 43
ci_045                -2.602666e-03 3 1  ON 44
ci_046                 5.319611e-03 3 1  ON 45
ci_047                 5.332397e-03 3 1  ON 46
ci_048                -1.253479e-02 3 1  ON 47
ci_049                -1.269628e-02 3 1  ON 48
ci_050                 3.490286e-03 3 1  ON 49
ci_051                 3.396002e-03 3 1  ON 50
ci_052                -2.751000e-03 3 1  ON 51
ci_053                -2.763469e-03 3 1  ON 52
ci_054                -2.842532e-03 3 1  ON 53
ci_055                -3.151274e-03 3 1  ON 54
ci_056                 5.083374e-03 3 1  ON 55
ci_057                 5.236584e-03 3 1  ON 56
ci_058                -2.459789e-03 3 1  ON 57
ci_059                -2.467188e-03 3 1  ON 58
ci_060                 5.219597e-03 3 1  ON 59
ci_061                 5.788248e-03 3 1  ON 60
ci_062                -3.535467e-03 3 1  ON 61
ci_063                -3.579178e-03 3 1  ON 62
ci_064                -2.696055e-03 3 1  ON 63
ci_065                -3.703797e-03 3 1  ON 64
ci_066                 4.247966e-03 3 1  ON 65
ci_067                 4.417415e-03 3 1  ON 66
ci_068                -4.973883e-03 3 1  ON 67
ci_069                -4.514646e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2619
    reference variance = 0.252815
====================================================
  Execution time = 1.3633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0105e-01
  Total weights = 1.957469277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287019957069
                                         uncertainty =       0.001914236460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287019957069
                                         uncertainty =       0.001914236460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378810059
  error estimate for blocks of size 2^( 2) =       0.000389615885
  error estimate for blocks of size 2^( 3) =       0.000399699128
  error estimate for blocks of size 2^( 4) =       0.000407194582
  error estimate for blocks of size 2^( 5) =       0.000412434861
  error estimate for blocks of size 2^( 6) =       0.000414303966
  error estimate for blocks of size 2^( 7) =       0.000415027839

      target function =      -0.900212465471
              le_mean =     -17.215259241796
             les_mean =     296.666198020578
             stat err =       0.000412240312
             autocorr =       1.184289589576
   target nu stat err =       0.000412240312
   target dn stat err =       0.003257555642
      target stat err =       0.004154741925
              std dev =       0.535718322422
             le_variance =       0.286994120979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721525924180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900231083757       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900406747159       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900429564104       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900435474063       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900436288119       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900436408415       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900436476771       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900436532853       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900436553179       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900436557374       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 4.507023e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900231083757       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900281376788       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900287685072       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900289252687       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900289458968       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900289487799       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900289505297       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900289519400       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900289524631       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900289525556       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.254251e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900231083757       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900244130562       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900245750012       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900246147490       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900246199091       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900246206188       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900246210581       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900246214107       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900246215419       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900246215642       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.226959e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.488290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6142e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.000886e-02 3 1  ON 0
ci_002                -3.014090e-02 3 1  ON 1
ci_003                -2.483452e-02 3 1  ON 2
ci_004                 2.221656e-02 3 1  ON 3
ci_005                 2.264081e-02 3 1  ON 4
ci_006                -1.945605e-02 3 1  ON 5
ci_007                -1.945604e-02 3 1  ON 6
ci_008                -8.892297e-03 3 1  ON 7
ci_009                -1.467035e-02 3 1  ON 8
ci_010                -9.957173e-03 3 1  ON 9
ci_011                -1.020740e-02 3 1  ON 10
ci_012                -1.028262e-02 3 1  ON 11
ci_013                -1.991584e-02 3 1  ON 12
ci_014                 1.182322e-02 3 1  ON 13
ci_015                 1.203876e-02 3 1  ON 14
ci_016                 1.628936e-02 3 1  ON 15
ci_017                 1.628368e-02 3 1  ON 16
ci_018                 9.848014e-03 3 1  ON 17
ci_019                 1.001929e-02 3 1  ON 18
ci_020                 1.562915e-02 3 1  ON 19
ci_021                 1.562494e-02 3 1  ON 20
ci_022                 8.940984e-03 3 1  ON 21
ci_023                 8.895769e-03 3 1  ON 22
ci_024                 9.473723e-03 3 1  ON 23
ci_025                 9.353308e-03 3 1  ON 24
ci_026                 1.052445e-02 3 1  ON 25
ci_027                 1.081458e-02 3 1  ON 26
ci_028                -1.491922e-02 3 1  ON 27
ci_029                -1.546206e-02 3 1  ON 28
ci_030                -8.832854e-03 3 1  ON 29
ci_031                -9.193091e-03 3 1  ON 30
ci_032                -1.470310e-02 3 1  ON 31
ci_033                 6.043127e-03 3 1  ON 32
ci_034                 5.652169e-03 3 1  ON 33
ci_035                -4.070358e-03 3 1  ON 34
ci_036                -1.200863e-02 3 1  ON 35
ci_037                -1.214489e-02 3 1  ON 36
ci_038                 1.622992e-03 3 1  ON 37
ci_039                 1.835709e-03 3 1  ON 38
ci_040                -2.350028e-03 3 1  ON 39
ci_041                 8.394784e-03 3 1  ON 40
ci_042                 8.292393e-03 3 1  ON 41
ci_043                -3.040048e-03 3 1  ON 42
ci_044                -4.796825e-03 3 1  ON 43
ci_045                -2.555831e-03 3 1  ON 44
ci_046                 5.277405e-03 3 1  ON 45
ci_047                 5.293067e-03 3 1  ON 46
ci_048                -1.254832e-02 3 1  ON 47
ci_049                -1.271908e-02 3 1  ON 48
ci_050                 3.528871e-03 3 1  ON 49
ci_051                 3.371356e-03 3 1  ON 50
ci_052                -2.732867e-03 3 1  ON 51
ci_053                -2.731598e-03 3 1  ON 52
ci_054                -2.823970e-03 3 1  ON 53
ci_055                -3.107855e-03 3 1  ON 54
ci_056                 4.997529e-03 3 1  ON 55
ci_057                 5.249291e-03 3 1  ON 56
ci_058                -2.424067e-03 3 1  ON 57
ci_059                -2.404693e-03 3 1  ON 58
ci_060                 5.144372e-03 3 1  ON 59
ci_061                 5.740658e-03 3 1  ON 60
ci_062                -3.511780e-03 3 1  ON 61
ci_063                -3.530839e-03 3 1  ON 62
ci_064                -2.672568e-03 3 1  ON 63
ci_065                -3.714428e-03 3 1  ON 64
ci_066                 4.227573e-03 3 1  ON 65
ci_067                 4.388383e-03 3 1  ON 66
ci_068                -4.898719e-03 3 1  ON 67
ci_069                -4.458251e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.294359
====================================================
  Execution time = 1.3296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0083e-01
  Total weights = 1.9575e+06
  Execution time = 1.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287846886226
                                         uncertainty =       0.001962863946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287846886226
                                         uncertainty =       0.001962863946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379386749
  error estimate for blocks of size 2^( 2) =       0.000390583435
  error estimate for blocks of size 2^( 3) =       0.000400457012
  error estimate for blocks of size 2^( 4) =       0.000408641238
  error estimate for blocks of size 2^( 5) =       0.000413555139
  error estimate for blocks of size 2^( 6) =       0.000415914785
  error estimate for blocks of size 2^( 7) =       0.000416946028

      target function =      -0.880259911432
              le_mean =     -17.215441584196
             les_mean =     296.688385174350
             stat err =       0.000413764297
             autocorr =       1.189437731807
   target nu stat err =       0.000413764297
   target dn stat err =       0.014512718683
      target stat err =       0.017546789216
              std dev =       0.536533886087
             le_variance =       0.287868610920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287736494447
                                         uncertainty =       0.001991203836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287736494447
                                         uncertainty =       0.001991203836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379314378
  error estimate for blocks of size 2^( 2) =       0.000390554320
  error estimate for blocks of size 2^( 3) =       0.000400472972
  error estimate for blocks of size 2^( 4) =       0.000408694581
  error estimate for blocks of size 2^( 5) =       0.000413636055
  error estimate for blocks of size 2^( 6) =       0.000416013123
  error estimate for blocks of size 2^( 7) =       0.000417059212

      target function =      -0.896926201326
              le_mean =     -17.215447162270
             les_mean =     296.675300095126
             stat err =       0.000413850743
             autocorr =       1.190388901257
   target nu stat err =       0.000413850743
   target dn stat err =       0.004347362113
      target stat err =       0.005483003352
              std dev =       0.536431537271
             le_variance =       0.287758794179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287773744126
                                         uncertainty =       0.001978271810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287773744126
                                         uncertainty =       0.001978271810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379338771
  error estimate for blocks of size 2^( 2) =       0.000390560004
  error estimate for blocks of size 2^( 3) =       0.000400458901
  error estimate for blocks of size 2^( 4) =       0.000408664728
  error estimate for blocks of size 2^( 5) =       0.000413593365
  error estimate for blocks of size 2^( 6) =       0.000415962944
  error estimate for blocks of size 2^( 7) =       0.000417002163

      target function =      -0.900237830781
              le_mean =     -17.215443009836
             les_mean =     296.672540497684
             stat err =       0.000413805800
             autocorr =       1.189977309304
   target nu stat err =       0.000413805800
   target dn stat err =       0.002840850846
      target stat err =       0.003635882633
              std dev =       0.536466034837
             le_variance =       0.287795806534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287834878145
                                         uncertainty =       0.001964872456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287834878145
                                         uncertainty =       0.001964872456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379378866
  error estimate for blocks of size 2^( 2) =       0.000390578926
  error estimate for blocks of size 2^( 3) =       0.000400455468
  error estimate for blocks of size 2^( 4) =       0.000408643095
  error estimate for blocks of size 2^( 5) =       0.000413558774
  error estimate for blocks of size 2^( 6) =       0.000415920231
  error estimate for blocks of size 2^( 7) =       0.000416951946

      target function =      -0.899897769436
              le_mean =     -17.215440851037
             les_mean =     296.672735482500
             stat err =       0.000413768512
             autocorr =       1.189511394639
   target nu stat err =       0.000413768512
   target dn stat err =       0.002784915315
      target stat err =       0.003563456868
              std dev =       0.536522737235
             le_variance =       0.287856647570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.880259911432        initial
     3.7253e-01     3.7253e+00             4.5070e-04        -0.896926201326
     1.4901e+00     1.4901e+01             1.2543e-04        -0.900237830781  <--
     5.9605e+00     5.9605e+01             3.2270e-05        -0.899897769436

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.2544e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.000886e-02 3 1  ON 0
ci_002                -3.014090e-02 3 1  ON 1
ci_003                -2.483452e-02 3 1  ON 2
ci_004                 2.221656e-02 3 1  ON 3
ci_005                 2.264081e-02 3 1  ON 4
ci_006                -1.945605e-02 3 1  ON 5
ci_007                -1.945604e-02 3 1  ON 6
ci_008                -8.892297e-03 3 1  ON 7
ci_009                -1.467035e-02 3 1  ON 8
ci_010                -9.957173e-03 3 1  ON 9
ci_011                -1.020740e-02 3 1  ON 10
ci_012                -1.028262e-02 3 1  ON 11
ci_013                -1.991584e-02 3 1  ON 12
ci_014                 1.182322e-02 3 1  ON 13
ci_015                 1.203876e-02 3 1  ON 14
ci_016                 1.628936e-02 3 1  ON 15
ci_017                 1.628368e-02 3 1  ON 16
ci_018                 9.848014e-03 3 1  ON 17
ci_019                 1.001929e-02 3 1  ON 18
ci_020                 1.562915e-02 3 1  ON 19
ci_021                 1.562494e-02 3 1  ON 20
ci_022                 8.940984e-03 3 1  ON 21
ci_023                 8.895769e-03 3 1  ON 22
ci_024                 9.473723e-03 3 1  ON 23
ci_025                 9.353308e-03 3 1  ON 24
ci_026                 1.052445e-02 3 1  ON 25
ci_027                 1.081458e-02 3 1  ON 26
ci_028                -1.491922e-02 3 1  ON 27
ci_029                -1.546206e-02 3 1  ON 28
ci_030                -8.832854e-03 3 1  ON 29
ci_031                -9.193091e-03 3 1  ON 30
ci_032                -1.470310e-02 3 1  ON 31
ci_033                 6.043127e-03 3 1  ON 32
ci_034                 5.652169e-03 3 1  ON 33
ci_035                -4.070358e-03 3 1  ON 34
ci_036                -1.200863e-02 3 1  ON 35
ci_037                -1.214489e-02 3 1  ON 36
ci_038                 1.622992e-03 3 1  ON 37
ci_039                 1.835709e-03 3 1  ON 38
ci_040                -2.350028e-03 3 1  ON 39
ci_041                 8.394784e-03 3 1  ON 40
ci_042                 8.292393e-03 3 1  ON 41
ci_043                -3.040048e-03 3 1  ON 42
ci_044                -4.796825e-03 3 1  ON 43
ci_045                -2.555831e-03 3 1  ON 44
ci_046                 5.277405e-03 3 1  ON 45
ci_047                 5.293067e-03 3 1  ON 46
ci_048                -1.254832e-02 3 1  ON 47
ci_049                -1.271908e-02 3 1  ON 48
ci_050                 3.528871e-03 3 1  ON 49
ci_051                 3.371356e-03 3 1  ON 50
ci_052                -2.732867e-03 3 1  ON 51
ci_053                -2.731598e-03 3 1  ON 52
ci_054                -2.823970e-03 3 1  ON 53
ci_055                -3.107855e-03 3 1  ON 54
ci_056                 4.997529e-03 3 1  ON 55
ci_057                 5.249291e-03 3 1  ON 56
ci_058                -2.424067e-03 3 1  ON 57
ci_059                -2.404693e-03 3 1  ON 58
ci_060                 5.144372e-03 3 1  ON 59
ci_061                 5.740658e-03 3 1  ON 60
ci_062                -3.511780e-03 3 1  ON 61
ci_063                -3.530839e-03 3 1  ON 62
ci_064                -2.672568e-03 3 1  ON 63
ci_065                -3.714428e-03 3 1  ON 64
ci_066                 4.227573e-03 3 1  ON 65
ci_067                 4.388383e-03 3 1  ON 66
ci_068                -4.898719e-03 3 1  ON 67
ci_069                -4.458251e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.376467
====================================================
  Execution time = 1.3748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0212e-01
  Total weights = 1.957500539e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286344969318
                                         uncertainty =       0.001550395519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286344969318
                                         uncertainty =       0.001550395519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378434886
  error estimate for blocks of size 2^( 2) =       0.000389800269
  error estimate for blocks of size 2^( 3) =       0.000399360367
  error estimate for blocks of size 2^( 4) =       0.000406486925
  error estimate for blocks of size 2^( 5) =       0.000411178583
  error estimate for blocks of size 2^( 6) =       0.000413595952
  error estimate for blocks of size 2^( 7) =       0.000414467882

      target function =      -0.899054866974
              le_mean =     -17.216182340198
             les_mean =     296.699058228043
             stat err =       0.000411432336
             autocorr =       1.181991930448
   target nu stat err =       0.000411432336
   target dn stat err =       0.003061850430
      target stat err =       0.003905626091
              std dev =       0.535187748658
             le_variance =       0.286425926313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618234020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899071140277       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899182864418       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899209171511       residual = 7.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899216928788       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899218130679       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899218271709       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899218175776       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899218171200       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899218151996       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899218147918       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 4.286049e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899071140277       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899103119132       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899110413681       residual = 6.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899112473456       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899112778803       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899112812892       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899112787503       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899112786721       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899112781799       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899112780797       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.197324e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899071140277       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899079435492       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899081309797       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899081832275       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899081908702       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899081917114       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899081910684       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899081910519       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899081909283       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899081909035       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 3.083850e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.491787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6240e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.991758e-02 3 1  ON 0
ci_002                -3.006694e-02 3 1  ON 1
ci_003                -2.473879e-02 3 1  ON 2
ci_004                 2.218121e-02 3 1  ON 3
ci_005                 2.259297e-02 3 1  ON 4
ci_006                -1.938468e-02 3 1  ON 5
ci_007                -1.938243e-02 3 1  ON 6
ci_008                -8.825239e-03 3 1  ON 7
ci_009                -1.463664e-02 3 1  ON 8
ci_010                -9.904091e-03 3 1  ON 9
ci_011                -1.012975e-02 3 1  ON 10
ci_012                -1.024822e-02 3 1  ON 11
ci_013                -1.990969e-02 3 1  ON 12
ci_014                 1.177904e-02 3 1  ON 13
ci_015                 1.196276e-02 3 1  ON 14
ci_016                 1.627353e-02 3 1  ON 15
ci_017                 1.625155e-02 3 1  ON 16
ci_018                 9.847565e-03 3 1  ON 17
ci_019                 9.962521e-03 3 1  ON 18
ci_020                 1.556305e-02 3 1  ON 19
ci_021                 1.554866e-02 3 1  ON 20
ci_022                 8.933686e-03 3 1  ON 21
ci_023                 8.856686e-03 3 1  ON 22
ci_024                 9.353991e-03 3 1  ON 23
ci_025                 9.288305e-03 3 1  ON 24
ci_026                 1.050312e-02 3 1  ON 25
ci_027                 1.077279e-02 3 1  ON 26
ci_028                -1.495678e-02 3 1  ON 27
ci_029                -1.541996e-02 3 1  ON 28
ci_030                -8.804521e-03 3 1  ON 29
ci_031                -9.150170e-03 3 1  ON 30
ci_032                -1.471816e-02 3 1  ON 31
ci_033                 5.996678e-03 3 1  ON 32
ci_034                 5.633954e-03 3 1  ON 33
ci_035                -4.033473e-03 3 1  ON 34
ci_036                -1.196393e-02 3 1  ON 35
ci_037                -1.211021e-02 3 1  ON 36
ci_038                 1.580838e-03 3 1  ON 37
ci_039                 1.785250e-03 3 1  ON 38
ci_040                -2.297296e-03 3 1  ON 39
ci_041                 8.342458e-03 3 1  ON 40
ci_042                 8.313105e-03 3 1  ON 41
ci_043                -2.993637e-03 3 1  ON 42
ci_044                -4.806546e-03 3 1  ON 43
ci_045                -2.512513e-03 3 1  ON 44
ci_046                 5.260691e-03 3 1  ON 45
ci_047                 5.278567e-03 3 1  ON 46
ci_048                -1.256139e-02 3 1  ON 47
ci_049                -1.272753e-02 3 1  ON 48
ci_050                 3.491129e-03 3 1  ON 49
ci_051                 3.361447e-03 3 1  ON 50
ci_052                -2.743849e-03 3 1  ON 51
ci_053                -2.744362e-03 3 1  ON 52
ci_054                -2.804171e-03 3 1  ON 53
ci_055                -3.078039e-03 3 1  ON 54
ci_056                 4.950980e-03 3 1  ON 55
ci_057                 5.213469e-03 3 1  ON 56
ci_058                -2.418733e-03 3 1  ON 57
ci_059                -2.432285e-03 3 1  ON 58
ci_060                 5.123135e-03 3 1  ON 59
ci_061                 5.684176e-03 3 1  ON 60
ci_062                -3.482318e-03 3 1  ON 61
ci_063                -3.476967e-03 3 1  ON 62
ci_064                -2.659371e-03 3 1  ON 63
ci_065                -3.704513e-03 3 1  ON 64
ci_066                 4.226285e-03 3 1  ON 65
ci_067                 4.408430e-03 3 1  ON 66
ci_068                -4.898234e-03 3 1  ON 67
ci_069                -4.426265e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.298
    reference variance = 0.163257
====================================================
  Execution time = 1.3504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9988e-01
  Total weights = 1.9574e+06
  Execution time = 1.8238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287424109904
                                         uncertainty =       0.001624235931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287424109904
                                         uncertainty =       0.001624235931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379098367
  error estimate for blocks of size 2^( 2) =       0.000390001009
  error estimate for blocks of size 2^( 3) =       0.000400112938
  error estimate for blocks of size 2^( 4) =       0.000407759691
  error estimate for blocks of size 2^( 5) =       0.000412131969
  error estimate for blocks of size 2^( 6) =       0.000414841756
  error estimate for blocks of size 2^( 7) =       0.000415236807

      target function =      -0.901657585990
              le_mean =     -17.215523156585
             les_mean =     296.674194972616
             stat err =       0.000412492556
             autocorr =       1.183936484626
   target nu stat err =       0.000412492556
   target dn stat err =       0.002456007751
      target stat err =       0.003166700554
              std dev =       0.536126051444
             le_variance =       0.287431143037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287209801103
                                         uncertainty =       0.001622436495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287209801103
                                         uncertainty =       0.001622436495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378957253
  error estimate for blocks of size 2^( 2) =       0.000389904908
  error estimate for blocks of size 2^( 3) =       0.000400066482
  error estimate for blocks of size 2^( 4) =       0.000407750007
  error estimate for blocks of size 2^( 5) =       0.000412143612
  error estimate for blocks of size 2^( 6) =       0.000414862200
  error estimate for blocks of size 2^( 7) =       0.000415268140

      target function =      -0.901370449433
              le_mean =     -17.215522043849
             les_mean =     296.674382792475
             stat err =       0.000412505990
             autocorr =       1.184895555789
   target nu stat err =       0.000412505990
   target dn stat err =       0.002495617573
      target stat err =       0.003214057107
              std dev =       0.535926487155
             le_variance =       0.287217199634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287296506111
                                         uncertainty =       0.001623156949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287296506111
                                         uncertainty =       0.001623156949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379014349
  error estimate for blocks of size 2^( 2) =       0.000389942236
  error estimate for blocks of size 2^( 3) =       0.000400082066
  error estimate for blocks of size 2^( 4) =       0.000407749504
  error estimate for blocks of size 2^( 5) =       0.000412133811
  error estimate for blocks of size 2^( 6) =       0.000414848218
  error estimate for blocks of size 2^( 7) =       0.000415249355

      target function =      -0.901643465529
              le_mean =     -17.215521457433
             les_mean =     296.674147212488
             stat err =       0.000412495222
             autocorr =       1.184476750756
   target nu stat err =       0.000412495222
   target dn stat err =       0.002470615539
      target stat err =       0.003184800194
              std dev =       0.536007232600
             le_variance =       0.287303753400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287406641592
                                         uncertainty =       0.001624086239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287406641592
                                         uncertainty =       0.001624086239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379086865
  error estimate for blocks of size 2^( 2) =       0.000389992746
  error estimate for blocks of size 2^( 3) =       0.000400108254
  error estimate for blocks of size 2^( 4) =       0.000407757648
  error estimate for blocks of size 2^( 5) =       0.000412131467
  error estimate for blocks of size 2^( 6) =       0.000414841832
  error estimate for blocks of size 2^( 7) =       0.000415237638

      target function =      -0.901696005162
              le_mean =     -17.215522803642
             les_mean =     296.674152443436
             stat err =       0.000412492146
             autocorr =       1.184005974605
   target nu stat err =       0.000412492146
   target dn stat err =       0.002457008615
      target stat err =       0.003168211409
              std dev =       0.536109786305
             le_variance =       0.287413702972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901657585990        initial
     3.7253e-01     3.7253e+00             4.2860e-04        -0.901370449433
     1.4901e+00     1.4901e+01             1.1973e-04        -0.901643465529
     5.9605e+00     5.9605e+01             3.0838e-05        -0.901696005162  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.2746e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -3.998537e-02 3 1  ON 0
ci_002                -3.012183e-02 3 1  ON 1
ci_003                -2.480990e-02 3 1  ON 2
ci_004                 2.220744e-02 3 1  ON 3
ci_005                 2.262850e-02 3 1  ON 4
ci_006                -1.943766e-02 3 1  ON 5
ci_007                -1.943706e-02 3 1  ON 6
ci_008                -8.874905e-03 3 1  ON 7
ci_009                -1.466162e-02 3 1  ON 8
ci_010                -9.943448e-03 3 1  ON 9
ci_011                -1.018731e-02 3 1  ON 10
ci_012                -1.027373e-02 3 1  ON 11
ci_013                -1.991423e-02 3 1  ON 12
ci_014                 1.181183e-02 3 1  ON 13
ci_015                 1.201914e-02 3 1  ON 14
ci_016                 1.628522e-02 3 1  ON 15
ci_017                 1.627537e-02 3 1  ON 16
ci_018                 9.847945e-03 3 1  ON 17
ci_019                 1.000461e-02 3 1  ON 18
ci_020                 1.561215e-02 3 1  ON 19
ci_021                 1.560526e-02 3 1  ON 20
ci_022                 8.939090e-03 3 1  ON 21
ci_023                 8.885672e-03 3 1  ON 22
ci_024                 9.442885e-03 3 1  ON 23
ci_025                 9.336595e-03 3 1  ON 24
ci_026                 1.051893e-02 3 1  ON 25
ci_027                 1.080377e-02 3 1  ON 26
ci_028                -1.492889e-02 3 1  ON 27
ci_029                -1.545114e-02 3 1  ON 28
ci_030                -8.825485e-03 3 1  ON 29
ci_031                -9.181951e-03 3 1  ON 30
ci_032                -1.470698e-02 3 1  ON 31
ci_033                 6.031136e-03 3 1  ON 32
ci_034                 5.647480e-03 3 1  ON 33
ci_035                -4.060799e-03 3 1  ON 34
ci_036                -1.199713e-02 3 1  ON 35
ci_037                -1.213600e-02 3 1  ON 36
ci_038                 1.612059e-03 3 1  ON 37
ci_039                 1.822620e-03 3 1  ON 38
ci_040                -2.336344e-03 3 1  ON 39
ci_041                 8.381162e-03 3 1  ON 40
ci_042                 8.297775e-03 3 1  ON 41
ci_043                -3.028022e-03 3 1  ON 42
ci_044                -4.799336e-03 3 1  ON 43
ci_045                -2.544590e-03 3 1  ON 44
ci_046                 5.273091e-03 3 1  ON 45
ci_047                 5.289317e-03 3 1  ON 46
ci_048                -1.255166e-02 3 1  ON 47
ci_049                -1.272123e-02 3 1  ON 48
ci_050                 3.519062e-03 3 1  ON 49
ci_051                 3.368780e-03 3 1  ON 50
ci_052                -2.735697e-03 3 1  ON 51
ci_053                -2.734909e-03 3 1  ON 52
ci_054                -2.818859e-03 3 1  ON 53
ci_055                -3.100150e-03 3 1  ON 54
ci_056                 4.985477e-03 3 1  ON 55
ci_057                 5.240013e-03 3 1  ON 56
ci_058                -2.422637e-03 3 1  ON 57
ci_059                -2.411818e-03 3 1  ON 58
ci_060                 5.138884e-03 3 1  ON 59
ci_061                 5.726076e-03 3 1  ON 60
ci_062                -3.504210e-03 3 1  ON 61
ci_063                -3.516929e-03 3 1  ON 62
ci_064                -2.669141e-03 3 1  ON 63
ci_065                -3.711855e-03 3 1  ON 64
ci_066                 4.227225e-03 3 1  ON 65
ci_067                 4.393569e-03 3 1  ON 66
ci_068                -4.898575e-03 3 1  ON 67
ci_069                -4.449962e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1476
    reference variance = 0.406887
====================================================
  Execution time = 1.3620e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0424e-01
  Total weights = 1.957284045e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288794999741
                                         uncertainty =       0.001995408134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288794999741
                                         uncertainty =       0.001995408134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379962744
  error estimate for blocks of size 2^( 2) =       0.000391202328
  error estimate for blocks of size 2^( 3) =       0.000400875745
  error estimate for blocks of size 2^( 4) =       0.000407639602
  error estimate for blocks of size 2^( 5) =       0.000412756664
  error estimate for blocks of size 2^( 6) =       0.000415714383
  error estimate for blocks of size 2^( 7) =       0.000417133012

      target function =      -0.896178493124
              le_mean =     -17.215164556854
             les_mean =     296.666134411747
             stat err =       0.000413310915
             autocorr =       1.183236940439
   target nu stat err =       0.000413310915
   target dn stat err =       0.002828884966
      target stat err =       0.003587127067
              std dev =       0.537348465325
             le_variance =       0.288743373187


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721516455685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896192071913       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896220217754       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896224918264       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896225637002       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896225909476       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896225918065       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896225926805       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896225931946       residual = 5.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896225930347       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896225930131       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 8.574851e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896192071913       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896199367881       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896200571908       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896200754831       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896200823636       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896200825468       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896200827601       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896200828863       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896200828460       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.205578e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896192071913       residual = 9.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896193912878       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896194215738       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896194261674       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896194278917       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896194279354       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896194279883       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896194280198       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896194280097       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 5.554428e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.494931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6127e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.996332e-02 3 1  ON 0
ci_002                -3.010287e-02 3 1  ON 1
ci_003                -2.479448e-02 3 1  ON 2
ci_004                 2.219890e-02 3 1  ON 3
ci_005                 2.260871e-02 3 1  ON 4
ci_006                -1.942636e-02 3 1  ON 5
ci_007                -1.943590e-02 3 1  ON 6
ci_008                -8.867377e-03 3 1  ON 7
ci_009                -1.466074e-02 3 1  ON 8
ci_010                -9.932617e-03 3 1  ON 9
ci_011                -1.018958e-02 3 1  ON 10
ci_012                -1.027454e-02 3 1  ON 11
ci_013                -1.990584e-02 3 1  ON 12
ci_014                 1.179649e-02 3 1  ON 13
ci_015                 1.200109e-02 3 1  ON 14
ci_016                 1.627519e-02 3 1  ON 15
ci_017                 1.628226e-02 3 1  ON 16
ci_018                 9.840863e-03 3 1  ON 17
ci_019                 9.997112e-03 3 1  ON 18
ci_020                 1.560826e-02 3 1  ON 19
ci_021                 1.559074e-02 3 1  ON 20
ci_022                 8.923840e-03 3 1  ON 21
ci_023                 8.887157e-03 3 1  ON 22
ci_024                 9.432651e-03 3 1  ON 23
ci_025                 9.320898e-03 3 1  ON 24
ci_026                 1.051212e-02 3 1  ON 25
ci_027                 1.079185e-02 3 1  ON 26
ci_028                -1.492239e-02 3 1  ON 27
ci_029                -1.543617e-02 3 1  ON 28
ci_030                -8.828252e-03 3 1  ON 29
ci_031                -9.170410e-03 3 1  ON 30
ci_032                -1.469916e-02 3 1  ON 31
ci_033                 6.024272e-03 3 1  ON 32
ci_034                 5.635479e-03 3 1  ON 33
ci_035                -4.046469e-03 3 1  ON 34
ci_036                -1.198681e-02 3 1  ON 35
ci_037                -1.212814e-02 3 1  ON 36
ci_038                 1.602862e-03 3 1  ON 37
ci_039                 1.818470e-03 3 1  ON 38
ci_040                -2.331368e-03 3 1  ON 39
ci_041                 8.377470e-03 3 1  ON 40
ci_042                 8.294199e-03 3 1  ON 41
ci_043                -3.019199e-03 3 1  ON 42
ci_044                -4.782238e-03 3 1  ON 43
ci_045                -2.535853e-03 3 1  ON 44
ci_046                 5.263684e-03 3 1  ON 45
ci_047                 5.283466e-03 3 1  ON 46
ci_048                -1.255219e-02 3 1  ON 47
ci_049                -1.271728e-02 3 1  ON 48
ci_050                 3.518626e-03 3 1  ON 49
ci_051                 3.371769e-03 3 1  ON 50
ci_052                -2.733138e-03 3 1  ON 51
ci_053                -2.721903e-03 3 1  ON 52
ci_054                -2.807788e-03 3 1  ON 53
ci_055                -3.091601e-03 3 1  ON 54
ci_056                 4.982993e-03 3 1  ON 55
ci_057                 5.224091e-03 3 1  ON 56
ci_058                -2.405969e-03 3 1  ON 57
ci_059                -2.406392e-03 3 1  ON 58
ci_060                 5.144326e-03 3 1  ON 59
ci_061                 5.722030e-03 3 1  ON 60
ci_062                -3.494227e-03 3 1  ON 61
ci_063                -3.506741e-03 3 1  ON 62
ci_064                -2.667803e-03 3 1  ON 63
ci_065                -3.706058e-03 3 1  ON 64
ci_066                 4.227879e-03 3 1  ON 65
ci_067                 4.392019e-03 3 1  ON 66
ci_068                -4.907387e-03 3 1  ON 67
ci_069                -4.445778e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2077
    reference variance = 0.220896
====================================================
  Execution time = 1.3855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0104e-01
  Total weights = 1.9572e+06
  Execution time = 1.8340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286879916560
                                         uncertainty =       0.001728202659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286879916560
                                         uncertainty =       0.001728202659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378736071
  error estimate for blocks of size 2^( 2) =       0.000389813866
  error estimate for blocks of size 2^( 3) =       0.000399717435
  error estimate for blocks of size 2^( 4) =       0.000407194490
  error estimate for blocks of size 2^( 5) =       0.000411750694
  error estimate for blocks of size 2^( 6) =       0.000413320738
  error estimate for blocks of size 2^( 7) =       0.000415474731

      target function =      -0.900205681302
              le_mean =     -17.215280357769
             les_mean =     296.666941570100
             stat err =       0.000411935163
             autocorr =       1.182999037139
   target nu stat err =       0.000411935163
   target dn stat err =       0.002303844230
      target stat err =       0.002966615950
              std dev =       0.535613688745
             le_variance =       0.286882023571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828135232
                                         uncertainty =       0.001727055757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286828135232
                                         uncertainty =       0.001727055757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378701865
  error estimate for blocks of size 2^( 2) =       0.000389790291
  error estimate for blocks of size 2^( 3) =       0.000399703640
  error estimate for blocks of size 2^( 4) =       0.000407188555
  error estimate for blocks of size 2^( 5) =       0.000411751085
  error estimate for blocks of size 2^( 6) =       0.000413324336
  error estimate for blocks of size 2^( 7) =       0.000415482438

      target function =      -0.900196668500
              le_mean =     -17.215282207479
             les_mean =     296.667012729400
             stat err =       0.000411936604
             autocorr =       1.183221029996
   target nu stat err =       0.000411936604
   target dn stat err =       0.002300288700
      target stat err =       0.002962162135
              std dev =       0.535565313560
             le_variance =       0.286830205088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286852733349
                                         uncertainty =       0.001727605442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286852733349
                                         uncertainty =       0.001727605442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378718115
  error estimate for blocks of size 2^( 2) =       0.000389801397
  error estimate for blocks of size 2^( 3) =       0.000399710017
  error estimate for blocks of size 2^( 4) =       0.000407191118
  error estimate for blocks of size 2^( 5) =       0.000411750583
  error estimate for blocks of size 2^( 6) =       0.000413322285
  error estimate for blocks of size 2^( 7) =       0.000415478419

      target function =      -0.900254757507
              le_mean =     -17.215281251583
             les_mean =     296.666933657717
             stat err =       0.000411935601
             autocorr =       1.183113734884
   target nu stat err =       0.000411935601
   target dn stat err =       0.002301235591
      target stat err =       0.002963705581
              std dev =       0.535588294802
             le_variance =       0.286854821529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876439732
                                         uncertainty =       0.001728126880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876439732
                                         uncertainty =       0.001728126880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378733775
  error estimate for blocks of size 2^( 2) =       0.000389812261
  error estimate for blocks of size 2^( 3) =       0.000399716466
  error estimate for blocks of size 2^( 4) =       0.000407194030
  error estimate for blocks of size 2^( 5) =       0.000411750644
  error estimate for blocks of size 2^( 6) =       0.000413320899
  error estimate for blocks of size 2^( 7) =       0.000415475162

      target function =      -0.900214574368
              le_mean =     -17.215280463431
             les_mean =     296.666938187035
             stat err =       0.000411935184
             autocorr =       1.183013501547
   target nu stat err =       0.000411935184
   target dn stat err =       0.002303483511
      target stat err =       0.002966227068
              std dev =       0.535610440905
             le_variance =       0.286878544406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900205681302        initial
     1.4901e+00     1.4901e+01             8.5749e-05        -0.900196668500
     5.9605e+00     5.9605e+01             2.2056e-05        -0.900254757507  <--
     2.3842e+01     2.3842e+02             5.5544e-06        -0.900214574368

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.3173e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -3.996332e-02 3 1  ON 0
ci_002                -3.010287e-02 3 1  ON 1
ci_003                -2.479448e-02 3 1  ON 2
ci_004                 2.219890e-02 3 1  ON 3
ci_005                 2.260871e-02 3 1  ON 4
ci_006                -1.942636e-02 3 1  ON 5
ci_007                -1.943590e-02 3 1  ON 6
ci_008                -8.867377e-03 3 1  ON 7
ci_009                -1.466074e-02 3 1  ON 8
ci_010                -9.932617e-03 3 1  ON 9
ci_011                -1.018958e-02 3 1  ON 10
ci_012                -1.027454e-02 3 1  ON 11
ci_013                -1.990584e-02 3 1  ON 12
ci_014                 1.179649e-02 3 1  ON 13
ci_015                 1.200109e-02 3 1  ON 14
ci_016                 1.627519e-02 3 1  ON 15
ci_017                 1.628226e-02 3 1  ON 16
ci_018                 9.840863e-03 3 1  ON 17
ci_019                 9.997112e-03 3 1  ON 18
ci_020                 1.560826e-02 3 1  ON 19
ci_021                 1.559074e-02 3 1  ON 20
ci_022                 8.923840e-03 3 1  ON 21
ci_023                 8.887157e-03 3 1  ON 22
ci_024                 9.432651e-03 3 1  ON 23
ci_025                 9.320898e-03 3 1  ON 24
ci_026                 1.051212e-02 3 1  ON 25
ci_027                 1.079185e-02 3 1  ON 26
ci_028                -1.492239e-02 3 1  ON 27
ci_029                -1.543617e-02 3 1  ON 28
ci_030                -8.828252e-03 3 1  ON 29
ci_031                -9.170410e-03 3 1  ON 30
ci_032                -1.469916e-02 3 1  ON 31
ci_033                 6.024272e-03 3 1  ON 32
ci_034                 5.635479e-03 3 1  ON 33
ci_035                -4.046469e-03 3 1  ON 34
ci_036                -1.198681e-02 3 1  ON 35
ci_037                -1.212814e-02 3 1  ON 36
ci_038                 1.602862e-03 3 1  ON 37
ci_039                 1.818470e-03 3 1  ON 38
ci_040                -2.331368e-03 3 1  ON 39
ci_041                 8.377470e-03 3 1  ON 40
ci_042                 8.294199e-03 3 1  ON 41
ci_043                -3.019199e-03 3 1  ON 42
ci_044                -4.782238e-03 3 1  ON 43
ci_045                -2.535853e-03 3 1  ON 44
ci_046                 5.263684e-03 3 1  ON 45
ci_047                 5.283466e-03 3 1  ON 46
ci_048                -1.255219e-02 3 1  ON 47
ci_049                -1.271728e-02 3 1  ON 48
ci_050                 3.518626e-03 3 1  ON 49
ci_051                 3.371769e-03 3 1  ON 50
ci_052                -2.733138e-03 3 1  ON 51
ci_053                -2.721903e-03 3 1  ON 52
ci_054                -2.807788e-03 3 1  ON 53
ci_055                -3.091601e-03 3 1  ON 54
ci_056                 4.982993e-03 3 1  ON 55
ci_057                 5.224091e-03 3 1  ON 56
ci_058                -2.405969e-03 3 1  ON 57
ci_059                -2.406392e-03 3 1  ON 58
ci_060                 5.144326e-03 3 1  ON 59
ci_061                 5.722030e-03 3 1  ON 60
ci_062                -3.494227e-03 3 1  ON 61
ci_063                -3.506741e-03 3 1  ON 62
ci_064                -2.667803e-03 3 1  ON 63
ci_065                -3.706058e-03 3 1  ON 64
ci_066                 4.227879e-03 3 1  ON 65
ci_067                 4.392019e-03 3 1  ON 66
ci_068                -4.907387e-03 3 1  ON 67
ci_069                -4.445778e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.291
    reference variance = 0.27966
====================================================
  Execution time = 1.3639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5329e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9739e-01
  Total weights = 1.957324407e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285604791190
                                         uncertainty =       0.001774285404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285604791190
                                         uncertainty =       0.001774285404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377894194
  error estimate for blocks of size 2^( 2) =       0.000389047088
  error estimate for blocks of size 2^( 3) =       0.000399133465
  error estimate for blocks of size 2^( 4) =       0.000405801902
  error estimate for blocks of size 2^( 5) =       0.000411848996
  error estimate for blocks of size 2^( 6) =       0.000415674048
  error estimate for blocks of size 2^( 7) =       0.000417250364

      target function =      -0.904808658763
              le_mean =     -17.215012170570
             les_mean =     296.654034683909
             stat err =       0.000412643828
             autocorr =       1.192367879571
   target nu stat err =       0.000412643828
   target dn stat err =       0.002202126576
      target stat err =       0.002868240786
              std dev =       0.534423094017
             le_variance =       0.285608043418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721501217057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904817061834       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904854407188       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904860595015       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904861460778       residual = 6.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904861604932       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904861630675       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904861678587       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904861683827       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904861689179       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904861689194       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 8.808841e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904817061834       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904826759551       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904828350796       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904828569088       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904828605557       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904828611895       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904828623938       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904828625250       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904828626585       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904828626593       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.267264e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904817061834       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904819509952       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904819910623       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904819965304       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904819974448       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904819976026       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904819979040       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904819979368       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904819979702       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904819979704       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 5.710343e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.498379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6132e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.994064e-02 3 1  ON 0
ci_002                -3.008475e-02 3 1  ON 1
ci_003                -2.479311e-02 3 1  ON 2
ci_004                 2.218995e-02 3 1  ON 3
ci_005                 2.260014e-02 3 1  ON 4
ci_006                -1.942197e-02 3 1  ON 5
ci_007                -1.941596e-02 3 1  ON 6
ci_008                -8.846093e-03 3 1  ON 7
ci_009                -1.464030e-02 3 1  ON 8
ci_010                -9.917948e-03 3 1  ON 9
ci_011                -1.017136e-02 3 1  ON 10
ci_012                -1.025577e-02 3 1  ON 11
ci_013                -1.991162e-02 3 1  ON 12
ci_014                 1.178196e-02 3 1  ON 13
ci_015                 1.199174e-02 3 1  ON 14
ci_016                 1.627149e-02 3 1  ON 15
ci_017                 1.628502e-02 3 1  ON 16
ci_018                 9.830332e-03 3 1  ON 17
ci_019                 9.992101e-03 3 1  ON 18
ci_020                 1.560353e-02 3 1  ON 19
ci_021                 1.558428e-02 3 1  ON 20
ci_022                 8.924893e-03 3 1  ON 21
ci_023                 8.879682e-03 3 1  ON 22
ci_024                 9.421714e-03 3 1  ON 23
ci_025                 9.314179e-03 3 1  ON 24
ci_026                 1.049501e-02 3 1  ON 25
ci_027                 1.077058e-02 3 1  ON 26
ci_028                -1.492220e-02 3 1  ON 27
ci_029                -1.543407e-02 3 1  ON 28
ci_030                -8.833038e-03 3 1  ON 29
ci_031                -9.157850e-03 3 1  ON 30
ci_032                -1.469758e-02 3 1  ON 31
ci_033                 6.011204e-03 3 1  ON 32
ci_034                 5.632543e-03 3 1  ON 33
ci_035                -4.032733e-03 3 1  ON 34
ci_036                -1.198243e-02 3 1  ON 35
ci_037                -1.212039e-02 3 1  ON 36
ci_038                 1.596869e-03 3 1  ON 37
ci_039                 1.809382e-03 3 1  ON 38
ci_040                -2.325402e-03 3 1  ON 39
ci_041                 8.373224e-03 3 1  ON 40
ci_042                 8.279276e-03 3 1  ON 41
ci_043                -3.010151e-03 3 1  ON 42
ci_044                -4.778508e-03 3 1  ON 43
ci_045                -2.530002e-03 3 1  ON 44
ci_046                 5.258314e-03 3 1  ON 45
ci_047                 5.271593e-03 3 1  ON 46
ci_048                -1.255605e-02 3 1  ON 47
ci_049                -1.271193e-02 3 1  ON 48
ci_050                 3.506957e-03 3 1  ON 49
ci_051                 3.364438e-03 3 1  ON 50
ci_052                -2.732193e-03 3 1  ON 51
ci_053                -2.723669e-03 3 1  ON 52
ci_054                -2.796528e-03 3 1  ON 53
ci_055                -3.080431e-03 3 1  ON 54
ci_056                 4.980080e-03 3 1  ON 55
ci_057                 5.222121e-03 3 1  ON 56
ci_058                -2.401258e-03 3 1  ON 57
ci_059                -2.396417e-03 3 1  ON 58
ci_060                 5.142682e-03 3 1  ON 59
ci_061                 5.711111e-03 3 1  ON 60
ci_062                -3.485313e-03 3 1  ON 61
ci_063                -3.499670e-03 3 1  ON 62
ci_064                -2.660031e-03 3 1  ON 63
ci_065                -3.697552e-03 3 1  ON 64
ci_066                 4.225108e-03 3 1  ON 65
ci_067                 4.394544e-03 3 1  ON 66
ci_068                -4.894400e-03 3 1  ON 67
ci_069                -4.444987e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1943
    reference variance = 0.194567
====================================================
  Execution time = 1.3700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0229e-01
  Total weights = 1.9578e+06
  Execution time = 1.8426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287519325786
                                         uncertainty =       0.001639915257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287519325786
                                         uncertainty =       0.001639915257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379158894
  error estimate for blocks of size 2^( 2) =       0.000389949783
  error estimate for blocks of size 2^( 3) =       0.000400065174
  error estimate for blocks of size 2^( 4) =       0.000407311830
  error estimate for blocks of size 2^( 5) =       0.000412475306
  error estimate for blocks of size 2^( 6) =       0.000415097091
  error estimate for blocks of size 2^( 7) =       0.000416814184

      target function =      -0.897496384393
              le_mean =     -17.215377530527
             les_mean =     296.672453016250
             stat err =       0.000412924603
             autocorr =       1.186039150615
   target nu stat err =       0.000412924603
   target dn stat err =       0.002629124630
      target stat err =       0.003351322870
              std dev =       0.536211649511
             le_variance =       0.287522933071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287442479589
                                         uncertainty =       0.001637759715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287442479589
                                         uncertainty =       0.001637759715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379108361
  error estimate for blocks of size 2^( 2) =       0.000389913122
  error estimate for blocks of size 2^( 3) =       0.000400044688
  error estimate for blocks of size 2^( 4) =       0.000407301578
  error estimate for blocks of size 2^( 5) =       0.000412470849
  error estimate for blocks of size 2^( 6) =       0.000415093007
  error estimate for blocks of size 2^( 7) =       0.000416803449

      target function =      -0.898118881643
              le_mean =     -17.215377559578
             les_mean =     296.671959611192
             stat err =       0.000412917221
             autocorr =       1.186312933272
   target nu stat err =       0.000412917221
   target dn stat err =       0.002482025414
      target stat err =       0.003173867080
              std dev =       0.536140186368
             le_variance =       0.287446299439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287479058488
                                         uncertainty =       0.001638797686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287479058488
                                         uncertainty =       0.001638797686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379132415
  error estimate for blocks of size 2^( 2) =       0.000389930478
  error estimate for blocks of size 2^( 3) =       0.000400054218
  error estimate for blocks of size 2^( 4) =       0.000407306167
  error estimate for blocks of size 2^( 5) =       0.000412472654
  error estimate for blocks of size 2^( 6) =       0.000415094664
  error estimate for blocks of size 2^( 7) =       0.000416808302

      target function =      -0.898658577483
              le_mean =     -17.215377477672
             les_mean =     296.671527874713
             stat err =       0.000412920447
             autocorr =       1.186180946188
   target nu stat err =       0.000412920447
   target dn stat err =       0.002468570405
      target stat err =       0.003160965983
              std dev =       0.536174202855
             le_variance =       0.287482775808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287514190232
                                         uncertainty =       0.001639773782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287514190232
                                         uncertainty =       0.001639773782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379155517
  error estimate for blocks of size 2^( 2) =       0.000389947309
  error estimate for blocks of size 2^( 3) =       0.000400063763
  error estimate for blocks of size 2^( 4) =       0.000407311083
  error estimate for blocks of size 2^( 5) =       0.000412474935
  error estimate for blocks of size 2^( 6) =       0.000415096749
  error estimate for blocks of size 2^( 7) =       0.000416813369

      target function =      -0.898624050202
              le_mean =     -17.215377513526
             les_mean =     296.671556487330
             stat err =       0.000412924034
             autocorr =       1.186057008959
   target nu stat err =       0.000412924034
   target dn stat err =       0.002475177941
      target stat err =       0.003168905758
              std dev =       0.536206873706
             le_variance =       0.287517811409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.897496384393        initial
     1.4901e+00     1.4901e+01             8.8088e-05        -0.898118881643
     5.9605e+00     5.9605e+01             2.2673e-05        -0.898658577483  <--
     2.3842e+01     2.3842e+02             5.7103e-06        -0.898624050202

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.3038e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -3.994064e-02 3 1  ON 0
ci_002                -3.008475e-02 3 1  ON 1
ci_003                -2.479311e-02 3 1  ON 2
ci_004                 2.218995e-02 3 1  ON 3
ci_005                 2.260014e-02 3 1  ON 4
ci_006                -1.942197e-02 3 1  ON 5
ci_007                -1.941596e-02 3 1  ON 6
ci_008                -8.846093e-03 3 1  ON 7
ci_009                -1.464030e-02 3 1  ON 8
ci_010                -9.917948e-03 3 1  ON 9
ci_011                -1.017136e-02 3 1  ON 10
ci_012                -1.025577e-02 3 1  ON 11
ci_013                -1.991162e-02 3 1  ON 12
ci_014                 1.178196e-02 3 1  ON 13
ci_015                 1.199174e-02 3 1  ON 14
ci_016                 1.627149e-02 3 1  ON 15
ci_017                 1.628502e-02 3 1  ON 16
ci_018                 9.830332e-03 3 1  ON 17
ci_019                 9.992101e-03 3 1  ON 18
ci_020                 1.560353e-02 3 1  ON 19
ci_021                 1.558428e-02 3 1  ON 20
ci_022                 8.924893e-03 3 1  ON 21
ci_023                 8.879682e-03 3 1  ON 22
ci_024                 9.421714e-03 3 1  ON 23
ci_025                 9.314179e-03 3 1  ON 24
ci_026                 1.049501e-02 3 1  ON 25
ci_027                 1.077058e-02 3 1  ON 26
ci_028                -1.492220e-02 3 1  ON 27
ci_029                -1.543407e-02 3 1  ON 28
ci_030                -8.833038e-03 3 1  ON 29
ci_031                -9.157850e-03 3 1  ON 30
ci_032                -1.469758e-02 3 1  ON 31
ci_033                 6.011204e-03 3 1  ON 32
ci_034                 5.632543e-03 3 1  ON 33
ci_035                -4.032733e-03 3 1  ON 34
ci_036                -1.198243e-02 3 1  ON 35
ci_037                -1.212039e-02 3 1  ON 36
ci_038                 1.596869e-03 3 1  ON 37
ci_039                 1.809382e-03 3 1  ON 38
ci_040                -2.325402e-03 3 1  ON 39
ci_041                 8.373224e-03 3 1  ON 40
ci_042                 8.279276e-03 3 1  ON 41
ci_043                -3.010151e-03 3 1  ON 42
ci_044                -4.778508e-03 3 1  ON 43
ci_045                -2.530002e-03 3 1  ON 44
ci_046                 5.258314e-03 3 1  ON 45
ci_047                 5.271593e-03 3 1  ON 46
ci_048                -1.255605e-02 3 1  ON 47
ci_049                -1.271193e-02 3 1  ON 48
ci_050                 3.506957e-03 3 1  ON 49
ci_051                 3.364438e-03 3 1  ON 50
ci_052                -2.732193e-03 3 1  ON 51
ci_053                -2.723669e-03 3 1  ON 52
ci_054                -2.796528e-03 3 1  ON 53
ci_055                -3.080431e-03 3 1  ON 54
ci_056                 4.980080e-03 3 1  ON 55
ci_057                 5.222121e-03 3 1  ON 56
ci_058                -2.401258e-03 3 1  ON 57
ci_059                -2.396417e-03 3 1  ON 58
ci_060                 5.142682e-03 3 1  ON 59
ci_061                 5.711111e-03 3 1  ON 60
ci_062                -3.485313e-03 3 1  ON 61
ci_063                -3.499670e-03 3 1  ON 62
ci_064                -2.660031e-03 3 1  ON 63
ci_065                -3.697552e-03 3 1  ON 64
ci_066                 4.225108e-03 3 1  ON 65
ci_067                 4.394544e-03 3 1  ON 66
ci_068                -4.894400e-03 3 1  ON 67
ci_069                -4.444987e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.737012
====================================================
  Execution time = 1.3608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0050e-01
  Total weights = 1.957521744e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288359968583
                                         uncertainty =       0.001634314431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288359968583
                                         uncertainty =       0.001634314431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379688920
  error estimate for blocks of size 2^( 2) =       0.000390840315
  error estimate for blocks of size 2^( 3) =       0.000401174801
  error estimate for blocks of size 2^( 4) =       0.000408254109
  error estimate for blocks of size 2^( 5) =       0.000413090193
  error estimate for blocks of size 2^( 6) =       0.000415662030
  error estimate for blocks of size 2^( 7) =       0.000418258364

      target function =      -0.900952421343
              le_mean =     -17.215440067141
             les_mean =     296.671876498078
             stat err =       0.000413816174
             autocorr =       1.187843087713
   target nu stat err =       0.000413816174
   target dn stat err =       0.002431696434
      target stat err =       0.003131529296
              std dev =       0.536961219854
             le_variance =       0.288327351627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721544006714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900962695890       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900986828884       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900991415053       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900992584392       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900992637161       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900992667098       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900992669892       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900992672480       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900992673827       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900992673679       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 1.154385e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900962695890       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900968954236       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900970132190       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900970429171       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900970441882       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900970449338       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900970450059       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900970450690       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900970451019       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900970450982       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.969830e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900962695890       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900964275207       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900964571722       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900964646258       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900964649403       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900964651264       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900964651446       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900964651603       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900964651685       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900964651675       residual = 2.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+01 is 7.478921e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.501764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6122e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.991095e-02 3 1  ON 0
ci_002                -3.006543e-02 3 1  ON 1
ci_003                -2.478608e-02 3 1  ON 2
ci_004                 2.217371e-02 3 1  ON 3
ci_005                 2.258171e-02 3 1  ON 4
ci_006                -1.940744e-02 3 1  ON 5
ci_007                -1.940931e-02 3 1  ON 6
ci_008                -8.832451e-03 3 1  ON 7
ci_009                -1.463842e-02 3 1  ON 8
ci_010                -9.901285e-03 3 1  ON 9
ci_011                -1.017094e-02 3 1  ON 10
ci_012                -1.024714e-02 3 1  ON 11
ci_013                -1.990175e-02 3 1  ON 12
ci_014                 1.177271e-02 3 1  ON 13
ci_015                 1.198544e-02 3 1  ON 14
ci_016                 1.627554e-02 3 1  ON 15
ci_017                 1.627257e-02 3 1  ON 16
ci_018                 9.832602e-03 3 1  ON 17
ci_019                 9.990025e-03 3 1  ON 18
ci_020                 1.559454e-02 3 1  ON 19
ci_021                 1.557746e-02 3 1  ON 20
ci_022                 8.926445e-03 3 1  ON 21
ci_023                 8.870970e-03 3 1  ON 22
ci_024                 9.401244e-03 3 1  ON 23
ci_025                 9.316013e-03 3 1  ON 24
ci_026                 1.048171e-02 3 1  ON 25
ci_027                 1.076716e-02 3 1  ON 26
ci_028                -1.491795e-02 3 1  ON 27
ci_029                -1.542637e-02 3 1  ON 28
ci_030                -8.830214e-03 3 1  ON 29
ci_031                -9.142625e-03 3 1  ON 30
ci_032                -1.469626e-02 3 1  ON 31
ci_033                 6.000735e-03 3 1  ON 32
ci_034                 5.626754e-03 3 1  ON 33
ci_035                -4.027176e-03 3 1  ON 34
ci_036                -1.196547e-02 3 1  ON 35
ci_037                -1.211330e-02 3 1  ON 36
ci_038                 1.588947e-03 3 1  ON 37
ci_039                 1.800281e-03 3 1  ON 38
ci_040                -2.313979e-03 3 1  ON 39
ci_041                 8.360044e-03 3 1  ON 40
ci_042                 8.270372e-03 3 1  ON 41
ci_043                -2.999987e-03 3 1  ON 42
ci_044                -4.771438e-03 3 1  ON 43
ci_045                -2.522857e-03 3 1  ON 44
ci_046                 5.255785e-03 3 1  ON 45
ci_047                 5.265174e-03 3 1  ON 46
ci_048                -1.256345e-02 3 1  ON 47
ci_049                -1.271652e-02 3 1  ON 48
ci_050                 3.501967e-03 3 1  ON 49
ci_051                 3.366668e-03 3 1  ON 50
ci_052                -2.722676e-03 3 1  ON 51
ci_053                -2.721266e-03 3 1  ON 52
ci_054                -2.791596e-03 3 1  ON 53
ci_055                -3.068437e-03 3 1  ON 54
ci_056                 4.977789e-03 3 1  ON 55
ci_057                 5.211528e-03 3 1  ON 56
ci_058                -2.393959e-03 3 1  ON 57
ci_059                -2.402554e-03 3 1  ON 58
ci_060                 5.135146e-03 3 1  ON 59
ci_061                 5.713252e-03 3 1  ON 60
ci_062                -3.474540e-03 3 1  ON 61
ci_063                -3.486949e-03 3 1  ON 62
ci_064                -2.655574e-03 3 1  ON 63
ci_065                -3.692701e-03 3 1  ON 64
ci_066                 4.225135e-03 3 1  ON 65
ci_067                 4.388390e-03 3 1  ON 66
ci_068                -4.888670e-03 3 1  ON 67
ci_069                -4.448675e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1798
    reference variance = 0.212489
====================================================
  Execution time = 1.3332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0365e-01
  Total weights = 1.9576e+06
  Execution time = 1.8389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289901741374
                                         uncertainty =       0.001935987913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289901741374
                                         uncertainty =       0.001935987913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380804943
  error estimate for blocks of size 2^( 2) =       0.000391999149
  error estimate for blocks of size 2^( 3) =       0.000401941950
  error estimate for blocks of size 2^( 4) =       0.000409107903
  error estimate for blocks of size 2^( 5) =       0.000413310751
  error estimate for blocks of size 2^( 6) =       0.000416449998
  error estimate for blocks of size 2^( 7) =       0.000417037507

      target function =      -0.896711819224
              le_mean =     -17.214673887056
             les_mean =     296.648732607546
             stat err =       0.000413976539
             autocorr =       1.181806313397
   target nu stat err =       0.000413976539
   target dn stat err =       0.002751214218
      target stat err =       0.003492802856
              std dev =       0.538539514923
             le_variance =       0.290024809133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852614831
                                         uncertainty =       0.001935008223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289852614831
                                         uncertainty =       0.001935008223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380772899
  error estimate for blocks of size 2^( 2) =       0.000391976631
  error estimate for blocks of size 2^( 3) =       0.000401930418
  error estimate for blocks of size 2^( 4) =       0.000409105154
  error estimate for blocks of size 2^( 5) =       0.000413311420
  error estimate for blocks of size 2^( 6) =       0.000416450965
  error estimate for blocks of size 2^( 7) =       0.000417039899

      target function =      -0.896914235370
              le_mean =     -17.214673845701
             les_mean =     296.648569543041
             stat err =       0.000413976860
             autocorr =       1.182007061974
   target nu stat err =       0.000413976860
   target dn stat err =       0.002750843684
      target stat err =       0.003493900431
              std dev =       0.538494197441
             le_variance =       0.289976000677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289875965027
                                         uncertainty =       0.001935475785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289875965027
                                         uncertainty =       0.001935475785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380788128
  error estimate for blocks of size 2^( 2) =       0.000391987251
  error estimate for blocks of size 2^( 3) =       0.000401935727
  error estimate for blocks of size 2^( 4) =       0.000409106220
  error estimate for blocks of size 2^( 5) =       0.000413310822
  error estimate for blocks of size 2^( 6) =       0.000416450221
  error estimate for blocks of size 2^( 7) =       0.000417038446

      target function =      -0.896863239080
              le_mean =     -17.214673810207
             les_mean =     296.648609033649
             stat err =       0.000413976427
             autocorr =       1.181910045299
   target nu stat err =       0.000413976427
   target dn stat err =       0.002750400627
      target stat err =       0.003492960996
              std dev =       0.538515735505
             le_variance =       0.289999197386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289898446150
                                         uncertainty =       0.001935922769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289898446150
                                         uncertainty =       0.001935922769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380802793
  error estimate for blocks of size 2^( 2) =       0.000391997617
  error estimate for blocks of size 2^( 3) =       0.000401941132
  error estimate for blocks of size 2^( 4) =       0.000409107656
  error estimate for blocks of size 2^( 5) =       0.000413310723
  error estimate for blocks of size 2^( 6) =       0.000416449983
  error estimate for blocks of size 2^( 7) =       0.000417037573

      target function =      -0.896760424058
              le_mean =     -17.214673869433
             les_mean =     296.648693183011
             stat err =       0.000413976484
             autocorr =       1.181819337284
   target nu stat err =       0.000413976484
   target dn stat err =       0.002750596657
      target stat err =       0.003492413566
              std dev =       0.538536474772
             le_variance =       0.290021534660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896711819224        initial
     1.4901e+00     1.4901e+01             1.1544e-04        -0.896914235370  <--
     5.9605e+00     5.9605e+01             2.9698e-05        -0.896863239080
     2.3842e+01     2.3842e+02             7.4789e-06        -0.896760424058

*****************************************************************************
Applying the update for shift_i =   1.4901e+00     and shift_s =   1.4901e+01
*****************************************************************************

  Execution time = 2.2664e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -3.982521e-02 3 1  ON 0
ci_002                -3.000984e-02 3 1  ON 1
ci_003                -2.476559e-02 3 1  ON 2
ci_004                 2.212676e-02 3 1  ON 3
ci_005                 2.252860e-02 3 1  ON 4
ci_006                -1.936563e-02 3 1  ON 5
ci_007                -1.939026e-02 3 1  ON 6
ci_008                -8.793494e-03 3 1  ON 7
ci_009                -1.463304e-02 3 1  ON 8
ci_010                -9.853525e-03 3 1  ON 9
ci_011                -1.016972e-02 3 1  ON 10
ci_012                -1.022241e-02 3 1  ON 11
ci_013                -1.987326e-02 3 1  ON 12
ci_014                 1.174608e-02 3 1  ON 13
ci_015                 1.196739e-02 3 1  ON 14
ci_016                 1.628744e-02 3 1  ON 15
ci_017                 1.623682e-02 3 1  ON 16
ci_018                 9.839072e-03 3 1  ON 17
ci_019                 9.984026e-03 3 1  ON 18
ci_020                 1.556870e-02 3 1  ON 19
ci_021                 1.555798e-02 3 1  ON 20
ci_022                 8.930961e-03 3 1  ON 21
ci_023                 8.846049e-03 3 1  ON 22
ci_024                 9.342186e-03 3 1  ON 23
ci_025                 9.321186e-03 3 1  ON 24
ci_026                 1.044354e-02 3 1  ON 25
ci_027                 1.075719e-02 3 1  ON 26
ci_028                -1.490564e-02 3 1  ON 27
ci_029                -1.540418e-02 3 1  ON 28
ci_030                -8.822249e-03 3 1  ON 29
ci_031                -9.099214e-03 3 1  ON 30
ci_032                -1.469252e-02 3 1  ON 31
ci_033                 5.970618e-03 3 1  ON 32
ci_034                 5.610143e-03 3 1  ON 33
ci_035                -4.011305e-03 3 1  ON 34
ci_036                -1.191689e-02 3 1  ON 35
ci_037                -1.209290e-02 3 1  ON 36
ci_038                 1.566325e-03 3 1  ON 37
ci_039                 1.774287e-03 3 1  ON 38
ci_040                -2.281401e-03 3 1  ON 39
ci_041                 8.322411e-03 3 1  ON 40
ci_042                 8.244912e-03 3 1  ON 41
ci_043                -2.970922e-03 3 1  ON 42
ci_044                -4.751190e-03 3 1  ON 43
ci_045                -2.502473e-03 3 1  ON 44
ci_046                 5.248528e-03 3 1  ON 45
ci_047                 5.246761e-03 3 1  ON 46
ci_048                -1.258501e-02 3 1  ON 47
ci_049                -1.272972e-02 3 1  ON 48
ci_050                 3.487764e-03 3 1  ON 49
ci_051                 3.373010e-03 3 1  ON 50
ci_052                -2.695563e-03 3 1  ON 51
ci_053                -2.714403e-03 3 1  ON 52
ci_054                -2.777365e-03 3 1  ON 53
ci_055                -3.034040e-03 3 1  ON 54
ci_056                 4.971235e-03 3 1  ON 55
ci_057                 5.181220e-03 3 1  ON 56
ci_058                -2.373162e-03 3 1  ON 57
ci_059                -2.420163e-03 3 1  ON 58
ci_060                 5.113486e-03 3 1  ON 59
ci_061                 5.719387e-03 3 1  ON 60
ci_062                -3.443562e-03 3 1  ON 61
ci_063                -3.450524e-03 3 1  ON 62
ci_064                -2.642874e-03 3 1  ON 63
ci_065                -3.678857e-03 3 1  ON 64
ci_066                 4.225254e-03 3 1  ON 65
ci_067                 4.370810e-03 3 1  ON 66
ci_068                -4.872259e-03 3 1  ON 67
ci_069                -4.459304e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1174
    reference variance = 0.183807
====================================================
  Execution time = 1.3769e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9979e-01
  Total weights = 1.957677963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287683210434
                                         uncertainty =       0.001624585391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287683210434
                                         uncertainty =       0.001624585391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379248574
  error estimate for blocks of size 2^( 2) =       0.000390881309
  error estimate for blocks of size 2^( 3) =       0.000400863685
  error estimate for blocks of size 2^( 4) =       0.000408479393
  error estimate for blocks of size 2^( 5) =       0.000412618617
  error estimate for blocks of size 2^( 6) =       0.000415907783
  error estimate for blocks of size 2^( 7) =       0.000417410896

      target function =      -0.901785466258
              le_mean =     -17.215154055945
             les_mean =     296.661323519976
             stat err =       0.000413604172
             autocorr =       1.189383502342
   target nu stat err =       0.000413604172
   target dn stat err =       0.002106999922
      target stat err =       0.002732500775
              std dev =       0.536338476530
             le_variance =       0.287658961406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721515405595e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901793062768       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901919260869       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901944617273       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901952344978       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901952743669       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901952669781       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901952767021       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901952774352       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901952807598       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901952803398       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-01 is 3.595774e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901793062768       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901829184111       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901836213240       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901838276759       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901838377437       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901838352700       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901838377008       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901838378100       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901838386322       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901838385141       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+00 is 9.996546e-05

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901793062768       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901802432494       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901804238456       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901804762749       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901804787926       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901804781275       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901804787332       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901804787547       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901804789591       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901804789286       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+00 is 2.571117e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.505221 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6276e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.972674e-02 3 1  ON 0
ci_002                -2.994914e-02 3 1  ON 1
ci_003                -2.466563e-02 3 1  ON 2
ci_004                 2.207482e-02 3 1  ON 3
ci_005                 2.245760e-02 3 1  ON 4
ci_006                -1.930457e-02 3 1  ON 5
ci_007                -1.935518e-02 3 1  ON 6
ci_008                -8.763676e-03 3 1  ON 7
ci_009                -1.456821e-02 3 1  ON 8
ci_010                -9.838124e-03 3 1  ON 9
ci_011                -1.014785e-02 3 1  ON 10
ci_012                -1.014226e-02 3 1  ON 11
ci_013                -1.983080e-02 3 1  ON 12
ci_014                 1.175466e-02 3 1  ON 13
ci_015                 1.190156e-02 3 1  ON 14
ci_016                 1.624313e-02 3 1  ON 15
ci_017                 1.618869e-02 3 1  ON 16
ci_018                 9.805417e-03 3 1  ON 17
ci_019                 9.911450e-03 3 1  ON 18
ci_020                 1.554792e-02 3 1  ON 19
ci_021                 1.552729e-02 3 1  ON 20
ci_022                 8.882101e-03 3 1  ON 21
ci_023                 8.811093e-03 3 1  ON 22
ci_024                 9.306061e-03 3 1  ON 23
ci_025                 9.266949e-03 3 1  ON 24
ci_026                 1.041128e-02 3 1  ON 25
ci_027                 1.077494e-02 3 1  ON 26
ci_028                -1.485027e-02 3 1  ON 27
ci_029                -1.534861e-02 3 1  ON 28
ci_030                -8.781785e-03 3 1  ON 29
ci_031                -9.113681e-03 3 1  ON 30
ci_032                -1.465646e-02 3 1  ON 31
ci_033                 5.948467e-03 3 1  ON 32
ci_034                 5.589823e-03 3 1  ON 33
ci_035                -3.978915e-03 3 1  ON 34
ci_036                -1.186158e-02 3 1  ON 35
ci_037                -1.205135e-02 3 1  ON 36
ci_038                 1.513632e-03 3 1  ON 37
ci_039                 1.719429e-03 3 1  ON 38
ci_040                -2.257590e-03 3 1  ON 39
ci_041                 8.323691e-03 3 1  ON 40
ci_042                 8.220829e-03 3 1  ON 41
ci_043                -2.919193e-03 3 1  ON 42
ci_044                -4.761839e-03 3 1  ON 43
ci_045                -2.468846e-03 3 1  ON 44
ci_046                 5.237771e-03 3 1  ON 45
ci_047                 5.187705e-03 3 1  ON 46
ci_048                -1.258787e-02 3 1  ON 47
ci_049                -1.273893e-02 3 1  ON 48
ci_050                 3.504674e-03 3 1  ON 49
ci_051                 3.319523e-03 3 1  ON 50
ci_052                -2.682605e-03 3 1  ON 51
ci_053                -2.694340e-03 3 1  ON 52
ci_054                -2.781859e-03 3 1  ON 53
ci_055                -2.992965e-03 3 1  ON 54
ci_056                 4.937231e-03 3 1  ON 55
ci_057                 5.148977e-03 3 1  ON 56
ci_058                -2.337109e-03 3 1  ON 57
ci_059                -2.439896e-03 3 1  ON 58
ci_060                 5.129326e-03 3 1  ON 59
ci_061                 5.642387e-03 3 1  ON 60
ci_062                -3.403118e-03 3 1  ON 61
ci_063                -3.405356e-03 3 1  ON 62
ci_064                -2.618214e-03 3 1  ON 63
ci_065                -3.675206e-03 3 1  ON 64
ci_066                 4.258501e-03 3 1  ON 65
ci_067                 4.372026e-03 3 1  ON 66
ci_068                -4.861457e-03 3 1  ON 67
ci_069                -4.456157e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.595093
====================================================
  Execution time = 1.3295e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0040e-01
  Total weights = 1.9572e+06
  Execution time = 1.8332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286408738923
                                         uncertainty =       0.001659563873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286408738923
                                         uncertainty =       0.001659563873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378430844
  error estimate for blocks of size 2^( 2) =       0.000389456020
  error estimate for blocks of size 2^( 3) =       0.000399359336
  error estimate for blocks of size 2^( 4) =       0.000406319011
  error estimate for blocks of size 2^( 5) =       0.000410681788
  error estimate for blocks of size 2^( 6) =       0.000413794506
  error estimate for blocks of size 2^( 7) =       0.000414167901

      target function =      -0.900904794466
              le_mean =     -17.215052965384
             les_mean =     296.658518995426
             stat err =       0.000411240802
             autocorr =       1.180916908200
   target nu stat err =       0.000411240802
   target dn stat err =       0.002434715347
      target stat err =       0.003132398343
              std dev =       0.535182032340
             le_variance =       0.286419807739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286229875091
                                         uncertainty =       0.001654592608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286229875091
                                         uncertainty =       0.001654592608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378313068
  error estimate for blocks of size 2^( 2) =       0.000389380128
  error estimate for blocks of size 2^( 3) =       0.000399327433
  error estimate for blocks of size 2^( 4) =       0.000406319967
  error estimate for blocks of size 2^( 5) =       0.000410702012
  error estimate for blocks of size 2^( 6) =       0.000413810728
  error estimate for blocks of size 2^( 7) =       0.000414212215

      target function =      -0.899470685457
              le_mean =     -17.215053214436
             les_mean =     296.659662379679
             stat err =       0.000411261230
             autocorr =       1.181769711469
   target nu stat err =       0.000411261230
   target dn stat err =       0.002601562323
      target stat err =       0.003329538606
              std dev =       0.535015471160
             le_variance =       0.286241554381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286301356456
                                         uncertainty =       0.001656649500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286301356456
                                         uncertainty =       0.001656649500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378360126
  error estimate for blocks of size 2^( 2) =       0.000389408874
  error estimate for blocks of size 2^( 3) =       0.000399337153
  error estimate for blocks of size 2^( 4) =       0.000406315414
  error estimate for blocks of size 2^( 5) =       0.000410689180
  error estimate for blocks of size 2^( 6) =       0.000413798984
  error estimate for blocks of size 2^( 7) =       0.000414187797

      target function =      -0.900806573487
              le_mean =     -17.215052034320
             les_mean =     296.658564520695
             stat err =       0.000411247844
             autocorr =       1.181398855225
   target nu stat err =       0.000411247844
   target dn stat err =       0.002426065344
      target stat err =       0.003120976215
              std dev =       0.535082021187
             le_variance =       0.286312769398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286393977317
                                         uncertainty =       0.001659176450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286393977317
                                         uncertainty =       0.001659176450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378421122
  error estimate for blocks of size 2^( 2) =       0.000389449300
  error estimate for blocks of size 2^( 3) =       0.000399355862
  error estimate for blocks of size 2^( 4) =       0.000406318020
  error estimate for blocks of size 2^( 5) =       0.000410682260
  error estimate for blocks of size 2^( 6) =       0.000413794754
  error estimate for blocks of size 2^( 7) =       0.000414170322

      target function =      -0.899654904542
              le_mean =     -17.215052645880
             les_mean =     296.659496267113
             stat err =       0.000411241339
             autocorr =       1.180980677424
   target nu stat err =       0.000411241339
   target dn stat err =       0.002645326892
      target stat err =       0.003385244641
              std dev =       0.535168282639
             le_variance =       0.286405090743


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900904794466        initial  <--
     3.7253e-01     3.7253e+00             3.5958e-04        -0.899470685457
     1.4901e+00     1.4901e+01             9.9965e-05        -0.900806573487
     5.9605e+00     5.9605e+01             2.5711e-05        -0.899654904542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5811
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -3.982521e-02 3 1  ON 0
ci_002                -3.000984e-02 3 1  ON 1
ci_003                -2.476559e-02 3 1  ON 2
ci_004                 2.212676e-02 3 1  ON 3
ci_005                 2.252860e-02 3 1  ON 4
ci_006                -1.936563e-02 3 1  ON 5
ci_007                -1.939026e-02 3 1  ON 6
ci_008                -8.793494e-03 3 1  ON 7
ci_009                -1.463304e-02 3 1  ON 8
ci_010                -9.853525e-03 3 1  ON 9
ci_011                -1.016972e-02 3 1  ON 10
ci_012                -1.022241e-02 3 1  ON 11
ci_013                -1.987326e-02 3 1  ON 12
ci_014                 1.174608e-02 3 1  ON 13
ci_015                 1.196739e-02 3 1  ON 14
ci_016                 1.628744e-02 3 1  ON 15
ci_017                 1.623682e-02 3 1  ON 16
ci_018                 9.839072e-03 3 1  ON 17
ci_019                 9.984026e-03 3 1  ON 18
ci_020                 1.556870e-02 3 1  ON 19
ci_021                 1.555798e-02 3 1  ON 20
ci_022                 8.930961e-03 3 1  ON 21
ci_023                 8.846049e-03 3 1  ON 22
ci_024                 9.342186e-03 3 1  ON 23
ci_025                 9.321186e-03 3 1  ON 24
ci_026                 1.044354e-02 3 1  ON 25
ci_027                 1.075719e-02 3 1  ON 26
ci_028                -1.490564e-02 3 1  ON 27
ci_029                -1.540418e-02 3 1  ON 28
ci_030                -8.822249e-03 3 1  ON 29
ci_031                -9.099214e-03 3 1  ON 30
ci_032                -1.469252e-02 3 1  ON 31
ci_033                 5.970618e-03 3 1  ON 32
ci_034                 5.610143e-03 3 1  ON 33
ci_035                -4.011305e-03 3 1  ON 34
ci_036                -1.191689e-02 3 1  ON 35
ci_037                -1.209290e-02 3 1  ON 36
ci_038                 1.566325e-03 3 1  ON 37
ci_039                 1.774287e-03 3 1  ON 38
ci_040                -2.281401e-03 3 1  ON 39
ci_041                 8.322411e-03 3 1  ON 40
ci_042                 8.244912e-03 3 1  ON 41
ci_043                -2.970922e-03 3 1  ON 42
ci_044                -4.751190e-03 3 1  ON 43
ci_045                -2.502473e-03 3 1  ON 44
ci_046                 5.248528e-03 3 1  ON 45
ci_047                 5.246761e-03 3 1  ON 46
ci_048                -1.258501e-02 3 1  ON 47
ci_049                -1.272972e-02 3 1  ON 48
ci_050                 3.487764e-03 3 1  ON 49
ci_051                 3.373010e-03 3 1  ON 50
ci_052                -2.695563e-03 3 1  ON 51
ci_053                -2.714403e-03 3 1  ON 52
ci_054                -2.777365e-03 3 1  ON 53
ci_055                -3.034040e-03 3 1  ON 54
ci_056                 4.971235e-03 3 1  ON 55
ci_057                 5.181220e-03 3 1  ON 56
ci_058                -2.373162e-03 3 1  ON 57
ci_059                -2.420163e-03 3 1  ON 58
ci_060                 5.113486e-03 3 1  ON 59
ci_061                 5.719387e-03 3 1  ON 60
ci_062                -3.443562e-03 3 1  ON 61
ci_063                -3.450524e-03 3 1  ON 62
ci_064                -2.642874e-03 3 1  ON 63
ci_065                -3.678857e-03 3 1  ON 64
ci_066                 4.225254e-03 3 1  ON 65
ci_067                 4.370810e-03 3 1  ON 66
ci_068                -4.872259e-03 3 1  ON 67
ci_069                -4.459304e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.195
    reference variance = 0.21606
====================================================
  Execution time = 1.3782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9543e-01
  Total weights = 1.957498339e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283989772581
                                         uncertainty =       0.001498340016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283989772581
                                         uncertainty =       0.001498340016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376801769
  error estimate for blocks of size 2^( 2) =       0.000388227538
  error estimate for blocks of size 2^( 3) =       0.000398216945
  error estimate for blocks of size 2^( 4) =       0.000406051377
  error estimate for blocks of size 2^( 5) =       0.000409877294
  error estimate for blocks of size 2^( 6) =       0.000411826155
  error estimate for blocks of size 2^( 7) =       0.000412498635

      target function =      -0.907164348289
              le_mean =     -17.214338391238
             les_mean =     296.628872606676
             stat err =       0.000410063365
             autocorr =       1.184339127627
   target nu stat err =       0.000410063365
   target dn stat err =       0.002095789922
      target stat err =       0.002745857490
              std dev =       0.532878171580
             le_variance =       0.283959145746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721433839124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907171982945       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907184182009       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907186955995       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907187785740       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907187878834       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907187918755       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907187922664       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907187919638       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907187921100       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907187921204       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 4.400314e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907171982945       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907175080747       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907175782465       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907175991091       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907176014421       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907176024390       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907176025390       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907176024624       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907176024988       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907176025015       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 1.113267e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907171982945       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907172760457       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907172936407       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907172988638       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907172994474       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907172996965       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907172997217       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907172997024       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907172997116       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907172997122       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+01 is 2.791534e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.508610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6295e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.981407e-02 3 1  ON 0
ci_002                -3.000502e-02 3 1  ON 1
ci_003                -2.475617e-02 3 1  ON 2
ci_004                 2.212000e-02 3 1  ON 3
ci_005                 2.252042e-02 3 1  ON 4
ci_006                -1.936585e-02 3 1  ON 5
ci_007                -1.938138e-02 3 1  ON 6
ci_008                -8.786538e-03 3 1  ON 7
ci_009                -1.463285e-02 3 1  ON 8
ci_010                -9.851229e-03 3 1  ON 9
ci_011                -1.016920e-02 3 1  ON 10
ci_012                -1.021802e-02 3 1  ON 11
ci_013                -1.986890e-02 3 1  ON 12
ci_014                 1.173830e-02 3 1  ON 13
ci_015                 1.196612e-02 3 1  ON 14
ci_016                 1.628141e-02 3 1  ON 15
ci_017                 1.623291e-02 3 1  ON 16
ci_018                 9.837467e-03 3 1  ON 17
ci_019                 9.980262e-03 3 1  ON 18
ci_020                 1.556042e-02 3 1  ON 19
ci_021                 1.556027e-02 3 1  ON 20
ci_022                 8.930564e-03 3 1  ON 21
ci_023                 8.843696e-03 3 1  ON 22
ci_024                 9.339343e-03 3 1  ON 23
ci_025                 9.320988e-03 3 1  ON 24
ci_026                 1.044305e-02 3 1  ON 25
ci_027                 1.075518e-02 3 1  ON 26
ci_028                -1.490608e-02 3 1  ON 27
ci_029                -1.540142e-02 3 1  ON 28
ci_030                -8.824576e-03 3 1  ON 29
ci_031                -9.095342e-03 3 1  ON 30
ci_032                -1.469031e-02 3 1  ON 31
ci_033                 5.969281e-03 3 1  ON 32
ci_034                 5.606173e-03 3 1  ON 33
ci_035                -4.005868e-03 3 1  ON 34
ci_036                -1.191910e-02 3 1  ON 35
ci_037                -1.209288e-02 3 1  ON 36
ci_038                 1.563453e-03 3 1  ON 37
ci_039                 1.768232e-03 3 1  ON 38
ci_040                -2.279677e-03 3 1  ON 39
ci_041                 8.319709e-03 3 1  ON 40
ci_042                 8.247858e-03 3 1  ON 41
ci_043                -2.967180e-03 3 1  ON 42
ci_044                -4.749249e-03 3 1  ON 43
ci_045                -2.498836e-03 3 1  ON 44
ci_046                 5.245944e-03 3 1  ON 45
ci_047                 5.244391e-03 3 1  ON 46
ci_048                -1.258328e-02 3 1  ON 47
ci_049                -1.273075e-02 3 1  ON 48
ci_050                 3.486611e-03 3 1  ON 49
ci_051                 3.371150e-03 3 1  ON 50
ci_052                -2.691985e-03 3 1  ON 51
ci_053                -2.716107e-03 3 1  ON 52
ci_054                -2.775381e-03 3 1  ON 53
ci_055                -3.030721e-03 3 1  ON 54
ci_056                 4.969553e-03 3 1  ON 55
ci_057                 5.178482e-03 3 1  ON 56
ci_058                -2.369820e-03 3 1  ON 57
ci_059                -2.415136e-03 3 1  ON 58
ci_060                 5.112589e-03 3 1  ON 59
ci_061                 5.713784e-03 3 1  ON 60
ci_062                -3.442977e-03 3 1  ON 61
ci_063                -3.446334e-03 3 1  ON 62
ci_064                -2.641357e-03 3 1  ON 63
ci_065                -3.676695e-03 3 1  ON 64
ci_066                 4.226220e-03 3 1  ON 65
ci_067                 4.371254e-03 3 1  ON 66
ci_068                -4.865853e-03 3 1  ON 67
ci_069                -4.459887e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.3139
    reference variance = 0.513313
====================================================
  Execution time = 1.3376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0012e-01
  Total weights = 1.9574e+06
  Execution time = 1.8410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287014841002
                                         uncertainty =       0.002980514433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287014841002
                                         uncertainty =       0.002980514433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378832101
  error estimate for blocks of size 2^( 2) =       0.000389711726
  error estimate for blocks of size 2^( 3) =       0.000400125388
  error estimate for blocks of size 2^( 4) =       0.000407469561
  error estimate for blocks of size 2^( 5) =       0.000411175300
  error estimate for blocks of size 2^( 6) =       0.000412828480
  error estimate for blocks of size 2^( 7) =       0.000414597403

      target function =      -0.901419112452
              le_mean =     -17.215543554064
             les_mean =     296.675077665855
             stat err =       0.000411517686
             autocorr =       1.180003960091
   target nu stat err =       0.000411517686
   target dn stat err =       0.003728392688
      target stat err =       0.004758989912
              std dev =       0.535749494867
             le_variance =       0.287027521250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286970690864
                                         uncertainty =       0.002961481926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286970690864
                                         uncertainty =       0.002961481926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378802842
  error estimate for blocks of size 2^( 2) =       0.000389687860
  error estimate for blocks of size 2^( 3) =       0.000400106684
  error estimate for blocks of size 2^( 4) =       0.000407454005
  error estimate for blocks of size 2^( 5) =       0.000411161759
  error estimate for blocks of size 2^( 6) =       0.000412815138
  error estimate for blocks of size 2^( 7) =       0.000414583534

      target function =      -0.901504964708
              le_mean =     -17.215543235346
             les_mean =     296.674999112436
             stat err =       0.000411503609
             autocorr =       1.180105513755
   target nu stat err =       0.000411503609
   target dn stat err =       0.003706091849
      target stat err =       0.004731834577
              std dev =       0.535708116906
             le_variance =       0.286983186519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286992333317
                                         uncertainty =       0.002970815303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286992333317
                                         uncertainty =       0.002970815303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378817185
  error estimate for blocks of size 2^( 2) =       0.000389699545
  error estimate for blocks of size 2^( 3) =       0.000400115822
  error estimate for blocks of size 2^( 4) =       0.000407461590
  error estimate for blocks of size 2^( 5) =       0.000411168350
  error estimate for blocks of size 2^( 6) =       0.000412821631
  error estimate for blocks of size 2^( 7) =       0.000414590286

      target function =      -0.901467497727
              le_mean =     -17.215543382426
             les_mean =     296.675033656626
             stat err =       0.000411510464
             autocorr =       1.180055466450
   target nu stat err =       0.000411510464
   target dn stat err =       0.003717008135
      target stat err =       0.004745175719
              std dev =       0.535728401187
             le_variance =       0.287004919838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012004941
                                         uncertainty =       0.002979293207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287012004941
                                         uncertainty =       0.002979293207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378830221
  error estimate for blocks of size 2^( 2) =       0.000389710189
  error estimate for blocks of size 2^( 3) =       0.000400124180
  error estimate for blocks of size 2^( 4) =       0.000407468553
  error estimate for blocks of size 2^( 5) =       0.000411174419
  error estimate for blocks of size 2^( 6) =       0.000412827612
  error estimate for blocks of size 2^( 7) =       0.000414596501

      target function =      -0.901426167392
              le_mean =     -17.215543531335
             les_mean =     296.675071325871
             stat err =       0.000411516771
             autocorr =       1.180010420697
   target nu stat err =       0.000411516771
   target dn stat err =       0.003726955088
      target stat err =       0.004757255532
              std dev =       0.535746837053
             le_variance =       0.287024673412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901419112452        initial
     3.7253e+00     3.7253e+01             4.4003e-05        -0.901504964708  <--
     1.4901e+01     1.4901e+02             1.1133e-05        -0.901467497727
     5.9605e+01     5.9605e+02             2.7915e-06        -0.901426167392

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.2696e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -3.978120e-02 3 1  ON 0
ci_002                -2.999080e-02 3 1  ON 1
ci_003                -2.472837e-02 3 1  ON 2
ci_004                 2.210007e-02 3 1  ON 3
ci_005                 2.249628e-02 3 1  ON 4
ci_006                -1.936650e-02 3 1  ON 5
ci_007                -1.935516e-02 3 1  ON 6
ci_008                -8.766107e-03 3 1  ON 7
ci_009                -1.463229e-02 3 1  ON 8
ci_010                -9.844472e-03 3 1  ON 9
ci_011                -1.016766e-02 3 1  ON 10
ci_012                -1.020509e-02 3 1  ON 11
ci_013                -1.985600e-02 3 1  ON 12
ci_014                 1.171540e-02 3 1  ON 13
ci_015                 1.196240e-02 3 1  ON 14
ci_016                 1.626364e-02 3 1  ON 15
ci_017                 1.622137e-02 3 1  ON 16
ci_018                 9.832765e-03 3 1  ON 17
ci_019                 9.969161e-03 3 1  ON 18
ci_020                 1.553598e-02 3 1  ON 19
ci_021                 1.556704e-02 3 1  ON 20
ci_022                 8.929392e-03 3 1  ON 21
ci_023                 8.836781e-03 3 1  ON 22
ci_024                 9.330944e-03 3 1  ON 23
ci_025                 9.320389e-03 3 1  ON 24
ci_026                 1.044157e-02 3 1  ON 25
ci_027                 1.074922e-02 3 1  ON 26
ci_028                -1.490737e-02 3 1  ON 27
ci_029                -1.539329e-02 3 1  ON 28
ci_030                -8.831422e-03 3 1  ON 29
ci_031                -9.083966e-03 3 1  ON 30
ci_032                -1.468379e-02 3 1  ON 31
ci_033                 5.965335e-03 3 1  ON 32
ci_034                 5.594470e-03 3 1  ON 33
ci_035                -3.989878e-03 3 1  ON 34
ci_036                -1.192554e-02 3 1  ON 35
ci_037                -1.209275e-02 3 1  ON 36
ci_038                 1.555009e-03 3 1  ON 37
ci_039                 1.750430e-03 3 1  ON 38
ci_040                -2.274612e-03 3 1  ON 39
ci_041                 8.311774e-03 3 1  ON 40
ci_042                 8.256518e-03 3 1  ON 41
ci_043                -2.956173e-03 3 1  ON 42
ci_044                -4.743534e-03 3 1  ON 43
ci_045                -2.488146e-03 3 1  ON 44
ci_046                 5.238333e-03 3 1  ON 45
ci_047                 5.237407e-03 3 1  ON 46
ci_048                -1.257823e-02 3 1  ON 47
ci_049                -1.273379e-02 3 1  ON 48
ci_050                 3.483229e-03 3 1  ON 49
ci_051                 3.365690e-03 3 1  ON 50
ci_052                -2.681475e-03 3 1  ON 51
ci_053                -2.721112e-03 3 1  ON 52
ci_054                -2.769528e-03 3 1  ON 53
ci_055                -3.020958e-03 3 1  ON 54
ci_056                 4.964604e-03 3 1  ON 55
ci_057                 5.170426e-03 3 1  ON 56
ci_058                -2.360001e-03 3 1  ON 57
ci_059                -2.400385e-03 3 1  ON 58
ci_060                 5.109946e-03 3 1  ON 59
ci_061                 5.697277e-03 3 1  ON 60
ci_062                -3.441249e-03 3 1  ON 61
ci_063                -3.434000e-03 3 1  ON 62
ci_064                -2.636899e-03 3 1  ON 63
ci_065                -3.670343e-03 3 1  ON 64
ci_066                 4.229064e-03 3 1  ON 65
ci_067                 4.372569e-03 3 1  ON 66
ci_068                -4.846983e-03 3 1  ON 67
ci_069                -4.461612e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2614
    reference variance = 0.237028
====================================================
  Execution time = 1.6157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0200e-01
  Total weights = 1.957373664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286176865868
                                         uncertainty =       0.001492664062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286176865868
                                         uncertainty =       0.001492664062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378291079
  error estimate for blocks of size 2^( 2) =       0.000389068353
  error estimate for blocks of size 2^( 3) =       0.000398568818
  error estimate for blocks of size 2^( 4) =       0.000405253130
  error estimate for blocks of size 2^( 5) =       0.000409819904
  error estimate for blocks of size 2^( 6) =       0.000412647657
  error estimate for blocks of size 2^( 7) =       0.000415389773

      target function =      -0.898996084458
              le_mean =     -17.215154286350
             les_mean =     296.663535925440
             stat err =       0.000410777616
             autocorr =       1.179129053928
   target nu stat err =       0.000410777616
   target dn stat err =       0.002656260281
      target stat err =       0.003394354504
              std dev =       0.534984374802
             le_variance =       0.286208281282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721515428635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899008220300       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899083868041       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899096486079       residual = 5.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899099516012       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899100113008       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899100210464       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899100228942       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899100212889       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899100213719       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899100211903       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 1.620007e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899008220300       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899028271800       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899031566201       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899032342451       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899032494459       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899032518346       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899032522862       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899032518851       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899032519059       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899032518602       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 4.257915e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899008220300       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899013309837       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899014142628       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899014337858       residual = 8.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899014376029       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899014381966       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899014383087       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899014382085       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899014382137       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899014382023       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 1.078320e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.512064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8641e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.975409e-02 3 1  ON 0
ci_002                -2.994921e-02 3 1  ON 1
ci_003                -2.471712e-02 3 1  ON 2
ci_004                 2.207279e-02 3 1  ON 3
ci_005                 2.247442e-02 3 1  ON 4
ci_006                -1.933836e-02 3 1  ON 5
ci_007                -1.933589e-02 3 1  ON 6
ci_008                -8.732499e-03 3 1  ON 7
ci_009                -1.460176e-02 3 1  ON 8
ci_010                -9.819217e-03 3 1  ON 9
ci_011                -1.015621e-02 3 1  ON 10
ci_012                -1.016970e-02 3 1  ON 11
ci_013                -1.986333e-02 3 1  ON 12
ci_014                 1.169152e-02 3 1  ON 13
ci_015                 1.191982e-02 3 1  ON 14
ci_016                 1.626639e-02 3 1  ON 15
ci_017                 1.622169e-02 3 1  ON 16
ci_018                 9.802514e-03 3 1  ON 17
ci_019                 9.955240e-03 3 1  ON 18
ci_020                 1.551349e-02 3 1  ON 19
ci_021                 1.555586e-02 3 1  ON 20
ci_022                 8.928123e-03 3 1  ON 21
ci_023                 8.829007e-03 3 1  ON 22
ci_024                 9.352864e-03 3 1  ON 23
ci_025                 9.313430e-03 3 1  ON 24
ci_026                 1.043036e-02 3 1  ON 25
ci_027                 1.073907e-02 3 1  ON 26
ci_028                -1.489802e-02 3 1  ON 27
ci_029                -1.537984e-02 3 1  ON 28
ci_030                -8.839972e-03 3 1  ON 29
ci_031                -9.055359e-03 3 1  ON 30
ci_032                -1.469145e-02 3 1  ON 31
ci_033                 5.938934e-03 3 1  ON 32
ci_034                 5.568623e-03 3 1  ON 33
ci_035                -3.970766e-03 3 1  ON 34
ci_036                -1.190887e-02 3 1  ON 35
ci_037                -1.206971e-02 3 1  ON 36
ci_038                 1.553975e-03 3 1  ON 37
ci_039                 1.731242e-03 3 1  ON 38
ci_040                -2.246695e-03 3 1  ON 39
ci_041                 8.321263e-03 3 1  ON 40
ci_042                 8.258082e-03 3 1  ON 41
ci_043                -2.944680e-03 3 1  ON 42
ci_044                -4.745521e-03 3 1  ON 43
ci_045                -2.477258e-03 3 1  ON 44
ci_046                 5.230198e-03 3 1  ON 45
ci_047                 5.225333e-03 3 1  ON 46
ci_048                -1.258187e-02 3 1  ON 47
ci_049                -1.274003e-02 3 1  ON 48
ci_050                 3.462877e-03 3 1  ON 49
ci_051                 3.349917e-03 3 1  ON 50
ci_052                -2.688294e-03 3 1  ON 51
ci_053                -2.709819e-03 3 1  ON 52
ci_054                -2.753458e-03 3 1  ON 53
ci_055                -3.000645e-03 3 1  ON 54
ci_056                 4.960497e-03 3 1  ON 55
ci_057                 5.146933e-03 3 1  ON 56
ci_058                -2.367201e-03 3 1  ON 57
ci_059                -2.375293e-03 3 1  ON 58
ci_060                 5.118431e-03 3 1  ON 59
ci_061                 5.707011e-03 3 1  ON 60
ci_062                -3.428341e-03 3 1  ON 61
ci_063                -3.414217e-03 3 1  ON 62
ci_064                -2.624117e-03 3 1  ON 63
ci_065                -3.665853e-03 3 1  ON 64
ci_066                 4.218866e-03 3 1  ON 65
ci_067                 4.362866e-03 3 1  ON 66
ci_068                -4.837010e-03 3 1  ON 67
ci_069                -4.497139e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2019
    reference variance = 0.255051
====================================================
  Execution time = 1.3394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0532e-01
  Total weights = 1.9572e+06
  Execution time = 1.8329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289190892764
                                         uncertainty =       0.001598946871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289190892764
                                         uncertainty =       0.001598946871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380377065
  error estimate for blocks of size 2^( 2) =       0.000391248976
  error estimate for blocks of size 2^( 3) =       0.000401041763
  error estimate for blocks of size 2^( 4) =       0.000408382652
  error estimate for blocks of size 2^( 5) =       0.000414237530
  error estimate for blocks of size 2^( 6) =       0.000416464059
  error estimate for blocks of size 2^( 7) =       0.000416637551

      target function =      -0.869634380075
              le_mean =     -17.215215858142
             les_mean =     296.689208292677
             stat err =       0.000413930448
             autocorr =       1.184202846693
   target nu stat err =       0.000413930448
   target dn stat err =       0.020467067934
      target stat err =       0.024146545307
              std dev =       0.537934404426
             le_variance =       0.289373423465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289097923372
                                         uncertainty =       0.001598661494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289097923372
                                         uncertainty =       0.001598661494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380314105
  error estimate for blocks of size 2^( 2) =       0.000391209111
  error estimate for blocks of size 2^( 3) =       0.000401025393
  error estimate for blocks of size 2^( 4) =       0.000408389554
  error estimate for blocks of size 2^( 5) =       0.000414256766
  error estimate for blocks of size 2^( 6) =       0.000416487214
  error estimate for blocks of size 2^( 7) =       0.000416648681

      target function =      -0.894741524276
              le_mean =     -17.215218648650
             les_mean =     296.669152711015
             stat err =       0.000413945554
             autocorr =       1.184681425580
   target nu stat err =       0.000413945554
   target dn stat err =       0.003196987449
      target stat err =       0.004030151326
              std dev =       0.537845364999
             le_variance =       0.289277636651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289140201895
                                         uncertainty =       0.001598772324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289140201895
                                         uncertainty =       0.001598772324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380342761
  error estimate for blocks of size 2^( 2) =       0.000391226895
  error estimate for blocks of size 2^( 3) =       0.000401032135
  error estimate for blocks of size 2^( 4) =       0.000408385549
  error estimate for blocks of size 2^( 5) =       0.000414247015
  error estimate for blocks of size 2^( 6) =       0.000416475360
  error estimate for blocks of size 2^( 7) =       0.000416642254

      target function =      -0.894817052113
              le_mean =     -17.215217211752
             les_mean =     296.669042456125
             stat err =       0.000413937544
             autocorr =       1.184457078911
   target nu stat err =       0.000413937544
   target dn stat err =       0.003197954522
      target stat err =       0.004032008506
              std dev =       0.537885891320
             le_variance =       0.289321232081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289184168903
                                         uncertainty =       0.001598933992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289184168903
                                         uncertainty =       0.001598933992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380372520
  error estimate for blocks of size 2^( 2) =       0.000391246095
  error estimate for blocks of size 2^( 3) =       0.000401040614
  error estimate for blocks of size 2^( 4) =       0.000408383595
  error estimate for blocks of size 2^( 5) =       0.000414239429
  error estimate for blocks of size 2^( 6) =       0.000416465823
  error estimate for blocks of size 2^( 7) =       0.000416638069

      target function =      -0.894799159664
              le_mean =     -17.215216208036
             les_mean =     296.669022040023
             stat err =       0.000413931729
             autocorr =       1.184238476961
   target nu stat err =       0.000413931729
   target dn stat err =       0.003201493579
      target stat err =       0.004036212106
              std dev =       0.537927976080
             le_variance =       0.289366507449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.869634380075        initial
     9.3132e-01     9.3132e+00             1.6200e-04        -0.894741524276
     3.7253e+00     3.7253e+01             4.2579e-05        -0.894817052113  <--
     1.4901e+01     1.4901e+02             1.0783e-05        -0.894799159664

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.2677e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -3.975409e-02 3 1  ON 0
ci_002                -2.994921e-02 3 1  ON 1
ci_003                -2.471712e-02 3 1  ON 2
ci_004                 2.207279e-02 3 1  ON 3
ci_005                 2.247442e-02 3 1  ON 4
ci_006                -1.933836e-02 3 1  ON 5
ci_007                -1.933589e-02 3 1  ON 6
ci_008                -8.732499e-03 3 1  ON 7
ci_009                -1.460176e-02 3 1  ON 8
ci_010                -9.819217e-03 3 1  ON 9
ci_011                -1.015621e-02 3 1  ON 10
ci_012                -1.016970e-02 3 1  ON 11
ci_013                -1.986333e-02 3 1  ON 12
ci_014                 1.169152e-02 3 1  ON 13
ci_015                 1.191982e-02 3 1  ON 14
ci_016                 1.626639e-02 3 1  ON 15
ci_017                 1.622169e-02 3 1  ON 16
ci_018                 9.802514e-03 3 1  ON 17
ci_019                 9.955240e-03 3 1  ON 18
ci_020                 1.551349e-02 3 1  ON 19
ci_021                 1.555586e-02 3 1  ON 20
ci_022                 8.928123e-03 3 1  ON 21
ci_023                 8.829007e-03 3 1  ON 22
ci_024                 9.352864e-03 3 1  ON 23
ci_025                 9.313430e-03 3 1  ON 24
ci_026                 1.043036e-02 3 1  ON 25
ci_027                 1.073907e-02 3 1  ON 26
ci_028                -1.489802e-02 3 1  ON 27
ci_029                -1.537984e-02 3 1  ON 28
ci_030                -8.839972e-03 3 1  ON 29
ci_031                -9.055359e-03 3 1  ON 30
ci_032                -1.469145e-02 3 1  ON 31
ci_033                 5.938934e-03 3 1  ON 32
ci_034                 5.568623e-03 3 1  ON 33
ci_035                -3.970766e-03 3 1  ON 34
ci_036                -1.190887e-02 3 1  ON 35
ci_037                -1.206971e-02 3 1  ON 36
ci_038                 1.553975e-03 3 1  ON 37
ci_039                 1.731242e-03 3 1  ON 38
ci_040                -2.246695e-03 3 1  ON 39
ci_041                 8.321263e-03 3 1  ON 40
ci_042                 8.258082e-03 3 1  ON 41
ci_043                -2.944680e-03 3 1  ON 42
ci_044                -4.745521e-03 3 1  ON 43
ci_045                -2.477258e-03 3 1  ON 44
ci_046                 5.230198e-03 3 1  ON 45
ci_047                 5.225333e-03 3 1  ON 46
ci_048                -1.258187e-02 3 1  ON 47
ci_049                -1.274003e-02 3 1  ON 48
ci_050                 3.462877e-03 3 1  ON 49
ci_051                 3.349917e-03 3 1  ON 50
ci_052                -2.688294e-03 3 1  ON 51
ci_053                -2.709819e-03 3 1  ON 52
ci_054                -2.753458e-03 3 1  ON 53
ci_055                -3.000645e-03 3 1  ON 54
ci_056                 4.960497e-03 3 1  ON 55
ci_057                 5.146933e-03 3 1  ON 56
ci_058                -2.367201e-03 3 1  ON 57
ci_059                -2.375293e-03 3 1  ON 58
ci_060                 5.118431e-03 3 1  ON 59
ci_061                 5.707011e-03 3 1  ON 60
ci_062                -3.428341e-03 3 1  ON 61
ci_063                -3.414217e-03 3 1  ON 62
ci_064                -2.624117e-03 3 1  ON 63
ci_065                -3.665853e-03 3 1  ON 64
ci_066                 4.218866e-03 3 1  ON 65
ci_067                 4.362866e-03 3 1  ON 66
ci_068                -4.837010e-03 3 1  ON 67
ci_069                -4.497139e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2421
    reference variance = 0.186344
====================================================
  Execution time = 1.3935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9671e-01
  Total weights = 1.957742475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284544127061
                                         uncertainty =       0.001541262955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284544127061
                                         uncertainty =       0.001541262955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377238837
  error estimate for blocks of size 2^( 2) =       0.000388465043
  error estimate for blocks of size 2^( 3) =       0.000398089425
  error estimate for blocks of size 2^( 4) =       0.000405165434
  error estimate for blocks of size 2^( 5) =       0.000409130944
  error estimate for blocks of size 2^( 6) =       0.000412086328
  error estimate for blocks of size 2^( 7) =       0.000414353247

      target function =      -0.905725280155
              le_mean =     -17.215220580239
             les_mean =     296.660529908839
             stat err =       0.000410183988
             autocorr =       1.182291620562
   target nu stat err =       0.000410183988
   target dn stat err =       0.002181629684
      target stat err =       0.002848505196
              std dev =       0.533496280234
             le_variance =       0.284618281023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522058024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905733468566       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905827152855       residual = 7.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905855902335       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905862923699       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905864031012       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905864269882       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905864335489       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905864315014       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905864304731       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905864303150       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-01 is 2.254900e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905733468566       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905758405671       residual = 7.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905765959382       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905767782783       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905768063061       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905768122390       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905768138702       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905768133390       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905768130836       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905768130452       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+00 is 5.963775e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905733468566       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905739805376       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905741718113       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905742178381       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905742248640       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905742263437       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905742267507       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905742266167       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905742265530       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905742265435       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+01 is 1.512852e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.515567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6431e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.970665e-02 3 1  ON 0
ci_002                -2.993266e-02 3 1  ON 1
ci_003                -2.468517e-02 3 1  ON 2
ci_004                 2.205778e-02 3 1  ON 3
ci_005                 2.246491e-02 3 1  ON 4
ci_006                -1.931256e-02 3 1  ON 5
ci_007                -1.931090e-02 3 1  ON 6
ci_008                -8.710698e-03 3 1  ON 7
ci_009                -1.454754e-02 3 1  ON 8
ci_010                -9.790817e-03 3 1  ON 9
ci_011                -1.009657e-02 3 1  ON 10
ci_012                -1.013747e-02 3 1  ON 11
ci_013                -1.985446e-02 3 1  ON 12
ci_014                 1.166926e-02 3 1  ON 13
ci_015                 1.188940e-02 3 1  ON 14
ci_016                 1.624636e-02 3 1  ON 15
ci_017                 1.621772e-02 3 1  ON 16
ci_018                 9.770539e-03 3 1  ON 17
ci_019                 9.932045e-03 3 1  ON 18
ci_020                 1.550269e-02 3 1  ON 19
ci_021                 1.555946e-02 3 1  ON 20
ci_022                 8.930311e-03 3 1  ON 21
ci_023                 8.825494e-03 3 1  ON 22
ci_024                 9.319949e-03 3 1  ON 23
ci_025                 9.287009e-03 3 1  ON 24
ci_026                 1.041041e-02 3 1  ON 25
ci_027                 1.072803e-02 3 1  ON 26
ci_028                -1.490726e-02 3 1  ON 27
ci_029                -1.537385e-02 3 1  ON 28
ci_030                -8.824005e-03 3 1  ON 29
ci_031                -9.044326e-03 3 1  ON 30
ci_032                -1.468836e-02 3 1  ON 31
ci_033                 5.931799e-03 3 1  ON 32
ci_034                 5.556537e-03 3 1  ON 33
ci_035                -3.955669e-03 3 1  ON 34
ci_036                -1.189457e-02 3 1  ON 35
ci_037                -1.208243e-02 3 1  ON 36
ci_038                 1.539142e-03 3 1  ON 37
ci_039                 1.715283e-03 3 1  ON 38
ci_040                -2.234365e-03 3 1  ON 39
ci_041                 8.309860e-03 3 1  ON 40
ci_042                 8.269297e-03 3 1  ON 41
ci_043                -2.925660e-03 3 1  ON 42
ci_044                -4.708090e-03 3 1  ON 43
ci_045                -2.464557e-03 3 1  ON 44
ci_046                 5.205594e-03 3 1  ON 45
ci_047                 5.216170e-03 3 1  ON 46
ci_048                -1.255561e-02 3 1  ON 47
ci_049                -1.273320e-02 3 1  ON 48
ci_050                 3.446391e-03 3 1  ON 49
ci_051                 3.350176e-03 3 1  ON 50
ci_052                -2.679065e-03 3 1  ON 51
ci_053                -2.718778e-03 3 1  ON 52
ci_054                -2.748782e-03 3 1  ON 53
ci_055                -2.981687e-03 3 1  ON 54
ci_056                 4.949810e-03 3 1  ON 55
ci_057                 5.123034e-03 3 1  ON 56
ci_058                -2.354160e-03 3 1  ON 57
ci_059                -2.362895e-03 3 1  ON 58
ci_060                 5.115608e-03 3 1  ON 59
ci_061                 5.732312e-03 3 1  ON 60
ci_062                -3.428261e-03 3 1  ON 61
ci_063                -3.403583e-03 3 1  ON 62
ci_064                -2.610871e-03 3 1  ON 63
ci_065                -3.659332e-03 3 1  ON 64
ci_066                 4.213431e-03 3 1  ON 65
ci_067                 4.348564e-03 3 1  ON 66
ci_068                -4.830250e-03 3 1  ON 67
ci_069                -4.510582e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1676
    reference variance = 0.244668
====================================================
  Execution time = 1.3324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9780e-01
  Total weights = 1.9572e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284383879041
                                         uncertainty =       0.001916358763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284383879041
                                         uncertainty =       0.001916358763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377096056
  error estimate for blocks of size 2^( 2) =       0.000388585869
  error estimate for blocks of size 2^( 3) =       0.000398694083
  error estimate for blocks of size 2^( 4) =       0.000406302188
  error estimate for blocks of size 2^( 5) =       0.000411089659
  error estimate for blocks of size 2^( 6) =       0.000413696227
  error estimate for blocks of size 2^( 7) =       0.000413618884

      target function =      -0.904254225818
              le_mean =     -17.214672824056
             les_mean =     296.642721361920
             stat err =       0.000411176740
             autocorr =       1.188921271904
   target nu stat err =       0.000411176740
   target dn stat err =       0.002816153023
      target stat err =       0.003631949590
              std dev =       0.533294356092
             le_variance =       0.284402870240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284291280136
                                         uncertainty =       0.001919463844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284291280136
                                         uncertainty =       0.001919463844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377034675
  error estimate for blocks of size 2^( 2) =       0.000388550187
  error estimate for blocks of size 2^( 3) =       0.000398685654
  error estimate for blocks of size 2^( 4) =       0.000406312134
  error estimate for blocks of size 2^( 5) =       0.000411106926
  error estimate for blocks of size 2^( 6) =       0.000413718188
  error estimate for blocks of size 2^( 7) =       0.000413646675

      target function =      -0.903778527553
              le_mean =     -17.214672767445
             les_mean =     296.643092646274
             stat err =       0.000411195981
             autocorr =       1.189419723452
   target nu stat err =       0.000411195981
   target dn stat err =       0.002888778482
      target stat err =       0.003719400725
              std dev =       0.533207550528
             le_variance =       0.284310291940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284332759205
                                         uncertainty =       0.001917764844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284332759205
                                         uncertainty =       0.001917764844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377062171
  error estimate for blocks of size 2^( 2) =       0.000388565464
  error estimate for blocks of size 2^( 3) =       0.000398688044
  error estimate for blocks of size 2^( 4) =       0.000406305837
  error estimate for blocks of size 2^( 5) =       0.000411097214
  error estimate for blocks of size 2^( 6) =       0.000413706321
  error estimate for blocks of size 2^( 7) =       0.000413632014

      target function =      -0.904106403687
              le_mean =     -17.214672539311
             les_mean =     296.642827414648
             stat err =       0.000411185346
             autocorr =       1.189184748330
   target nu stat err =       0.000411185346
   target dn stat err =       0.002843101912
      target stat err =       0.003664644045
              std dev =       0.533246436249
             le_variance =       0.284351761773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284377145641
                                         uncertainty =       0.001916517316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284377145641
                                         uncertainty =       0.001916517316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377091593
  error estimate for blocks of size 2^( 2) =       0.000388583105
  error estimate for blocks of size 2^( 3) =       0.000398693137
  error estimate for blocks of size 2^( 4) =       0.000406302468
  error estimate for blocks of size 2^( 5) =       0.000411090437
  error estimate for blocks of size 2^( 6) =       0.000413697336
  error estimate for blocks of size 2^( 7) =       0.000413620375

      target function =      -0.904250119672
              le_mean =     -17.214672758297
             les_mean =     296.642722290496
             stat err =       0.000411177654
             autocorr =       1.188954703671
   target nu stat err =       0.000411177654
   target dn stat err =       0.002818700672
      target stat err =       0.003635119150
              std dev =       0.533288044461
             le_variance =       0.284396138365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904254225818        initial  <--
     9.3132e-01     9.3132e+00             2.2549e-04        -0.903778527553
     3.7253e+00     3.7253e+01             5.9638e-05        -0.904106403687
     1.4901e+01     1.4901e+02             1.5129e-05        -0.904250119672

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6158
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -3.975409e-02 3 1  ON 0
ci_002                -2.994921e-02 3 1  ON 1
ci_003                -2.471712e-02 3 1  ON 2
ci_004                 2.207279e-02 3 1  ON 3
ci_005                 2.247442e-02 3 1  ON 4
ci_006                -1.933836e-02 3 1  ON 5
ci_007                -1.933589e-02 3 1  ON 6
ci_008                -8.732499e-03 3 1  ON 7
ci_009                -1.460176e-02 3 1  ON 8
ci_010                -9.819217e-03 3 1  ON 9
ci_011                -1.015621e-02 3 1  ON 10
ci_012                -1.016970e-02 3 1  ON 11
ci_013                -1.986333e-02 3 1  ON 12
ci_014                 1.169152e-02 3 1  ON 13
ci_015                 1.191982e-02 3 1  ON 14
ci_016                 1.626639e-02 3 1  ON 15
ci_017                 1.622169e-02 3 1  ON 16
ci_018                 9.802514e-03 3 1  ON 17
ci_019                 9.955240e-03 3 1  ON 18
ci_020                 1.551349e-02 3 1  ON 19
ci_021                 1.555586e-02 3 1  ON 20
ci_022                 8.928123e-03 3 1  ON 21
ci_023                 8.829007e-03 3 1  ON 22
ci_024                 9.352864e-03 3 1  ON 23
ci_025                 9.313430e-03 3 1  ON 24
ci_026                 1.043036e-02 3 1  ON 25
ci_027                 1.073907e-02 3 1  ON 26
ci_028                -1.489802e-02 3 1  ON 27
ci_029                -1.537984e-02 3 1  ON 28
ci_030                -8.839972e-03 3 1  ON 29
ci_031                -9.055359e-03 3 1  ON 30
ci_032                -1.469145e-02 3 1  ON 31
ci_033                 5.938934e-03 3 1  ON 32
ci_034                 5.568623e-03 3 1  ON 33
ci_035                -3.970766e-03 3 1  ON 34
ci_036                -1.190887e-02 3 1  ON 35
ci_037                -1.206971e-02 3 1  ON 36
ci_038                 1.553975e-03 3 1  ON 37
ci_039                 1.731242e-03 3 1  ON 38
ci_040                -2.246695e-03 3 1  ON 39
ci_041                 8.321263e-03 3 1  ON 40
ci_042                 8.258082e-03 3 1  ON 41
ci_043                -2.944680e-03 3 1  ON 42
ci_044                -4.745521e-03 3 1  ON 43
ci_045                -2.477258e-03 3 1  ON 44
ci_046                 5.230198e-03 3 1  ON 45
ci_047                 5.225333e-03 3 1  ON 46
ci_048                -1.258187e-02 3 1  ON 47
ci_049                -1.274003e-02 3 1  ON 48
ci_050                 3.462877e-03 3 1  ON 49
ci_051                 3.349917e-03 3 1  ON 50
ci_052                -2.688294e-03 3 1  ON 51
ci_053                -2.709819e-03 3 1  ON 52
ci_054                -2.753458e-03 3 1  ON 53
ci_055                -3.000645e-03 3 1  ON 54
ci_056                 4.960497e-03 3 1  ON 55
ci_057                 5.146933e-03 3 1  ON 56
ci_058                -2.367201e-03 3 1  ON 57
ci_059                -2.375293e-03 3 1  ON 58
ci_060                 5.118431e-03 3 1  ON 59
ci_061                 5.707011e-03 3 1  ON 60
ci_062                -3.428341e-03 3 1  ON 61
ci_063                -3.414217e-03 3 1  ON 62
ci_064                -2.624117e-03 3 1  ON 63
ci_065                -3.665853e-03 3 1  ON 64
ci_066                 4.218866e-03 3 1  ON 65
ci_067                 4.362866e-03 3 1  ON 66
ci_068                -4.837010e-03 3 1  ON 67
ci_069                -4.497139e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1892
    reference variance = 0.17527
====================================================
  Execution time = 1.3711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9823e-01
  Total weights = 1.957672401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284493857968
                                         uncertainty =       0.001803003623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284493857968
                                         uncertainty =       0.001803003623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377224994
  error estimate for blocks of size 2^( 2) =       0.000388271324
  error estimate for blocks of size 2^( 3) =       0.000398816002
  error estimate for blocks of size 2^( 4) =       0.000406367667
  error estimate for blocks of size 2^( 5) =       0.000412399658
  error estimate for blocks of size 2^( 6) =       0.000414834014
  error estimate for blocks of size 2^( 7) =       0.000416338916

      target function =      -0.903893363551
              le_mean =     -17.215709071189
             les_mean =     296.678868222783
             stat err =       0.000412485064
             autocorr =       1.195681568539
   target nu stat err =       0.000412485064
   target dn stat err =       0.002609557137
      target stat err =       0.003375641830
              std dev =       0.533476701973
             le_variance =       0.284597391548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721570907119e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903905343190       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903911114369       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903912137227       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903912447884       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903912481602       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903912482324       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903912479410       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903912479969       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903912480582       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903912480177       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.836637e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903905343190       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903906794872       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903907051775       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903907129638       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903907138075       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903907138249       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903907137520       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903907137659       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903907137813       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903907137712       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.618719e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903905343190       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903905706670       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903905770970       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903905790448       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903905792558       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903905792601       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903905792419       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903905792454       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903905792492       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903905792467       residual = 4.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.156388e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6222e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.975202e-02 3 1  ON 0
ci_002                -2.994692e-02 3 1  ON 1
ci_003                -2.471483e-02 3 1  ON 2
ci_004                 2.207002e-02 3 1  ON 3
ci_005                 2.247318e-02 3 1  ON 4
ci_006                -1.933688e-02 3 1  ON 5
ci_007                -1.933331e-02 3 1  ON 6
ci_008                -8.729973e-03 3 1  ON 7
ci_009                -1.460123e-02 3 1  ON 8
ci_010                -9.818274e-03 3 1  ON 9
ci_011                -1.015460e-02 3 1  ON 10
ci_012                -1.016622e-02 3 1  ON 11
ci_013                -1.986276e-02 3 1  ON 12
ci_014                 1.169206e-02 3 1  ON 13
ci_015                 1.192007e-02 3 1  ON 14
ci_016                 1.626643e-02 3 1  ON 15
ci_017                 1.621977e-02 3 1  ON 16
ci_018                 9.799731e-03 3 1  ON 17
ci_019                 9.954064e-03 3 1  ON 18
ci_020                 1.550944e-02 3 1  ON 19
ci_021                 1.555624e-02 3 1  ON 20
ci_022                 8.927778e-03 3 1  ON 21
ci_023                 8.827257e-03 3 1  ON 22
ci_024                 9.349375e-03 3 1  ON 23
ci_025                 9.309242e-03 3 1  ON 24
ci_026                 1.042933e-02 3 1  ON 25
ci_027                 1.073445e-02 3 1  ON 26
ci_028                -1.489722e-02 3 1  ON 27
ci_029                -1.537850e-02 3 1  ON 28
ci_030                -8.839863e-03 3 1  ON 29
ci_031                -9.053156e-03 3 1  ON 30
ci_032                -1.468924e-02 3 1  ON 31
ci_033                 5.939587e-03 3 1  ON 32
ci_034                 5.569454e-03 3 1  ON 33
ci_035                -3.969052e-03 3 1  ON 34
ci_036                -1.190762e-02 3 1  ON 35
ci_037                -1.206831e-02 3 1  ON 36
ci_038                 1.552125e-03 3 1  ON 37
ci_039                 1.729751e-03 3 1  ON 38
ci_040                -2.246488e-03 3 1  ON 39
ci_041                 8.320903e-03 3 1  ON 40
ci_042                 8.258408e-03 3 1  ON 41
ci_043                -2.943465e-03 3 1  ON 42
ci_044                -4.740933e-03 3 1  ON 43
ci_045                -2.475313e-03 3 1  ON 44
ci_046                 5.229077e-03 3 1  ON 45
ci_047                 5.224047e-03 3 1  ON 46
ci_048                -1.258393e-02 3 1  ON 47
ci_049                -1.273969e-02 3 1  ON 48
ci_050                 3.461466e-03 3 1  ON 49
ci_051                 3.348792e-03 3 1  ON 50
ci_052                -2.686250e-03 3 1  ON 51
ci_053                -2.711243e-03 3 1  ON 52
ci_054                -2.752993e-03 3 1  ON 53
ci_055                -2.999301e-03 3 1  ON 54
ci_056                 4.960442e-03 3 1  ON 55
ci_057                 5.144991e-03 3 1  ON 56
ci_058                -2.366536e-03 3 1  ON 57
ci_059                -2.375190e-03 3 1  ON 58
ci_060                 5.120359e-03 3 1  ON 59
ci_061                 5.707059e-03 3 1  ON 60
ci_062                -3.426860e-03 3 1  ON 61
ci_063                -3.413584e-03 3 1  ON 62
ci_064                -2.623263e-03 3 1  ON 63
ci_065                -3.665500e-03 3 1  ON 64
ci_066                 4.218773e-03 3 1  ON 65
ci_067                 4.363770e-03 3 1  ON 66
ci_068                -4.835225e-03 3 1  ON 67
ci_069                -4.497712e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.221115
====================================================
  Execution time = 1.3438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0172e-01
  Total weights = 1.9576e+06
  Execution time = 1.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287366848053
                                         uncertainty =       0.001746442647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287366848053
                                         uncertainty =       0.001746442647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379036907
  error estimate for blocks of size 2^( 2) =       0.000389735856
  error estimate for blocks of size 2^( 3) =       0.000399847555
  error estimate for blocks of size 2^( 4) =       0.000407534626
  error estimate for blocks of size 2^( 5) =       0.000411976199
  error estimate for blocks of size 2^( 6) =       0.000413838231
  error estimate for blocks of size 2^( 7) =       0.000415696971

      target function =      -0.899440863731
              le_mean =     -17.215629046297
             les_mean =     296.679611872601
             stat err =       0.000412261507
             autocorr =       1.182994084757
   target nu stat err =       0.000412261507
   target dn stat err =       0.002483447714
      target stat err =       0.003185907287
              std dev =       0.536039134765
             le_variance =       0.287337953999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287358667255
                                         uncertainty =       0.001746281928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287358667255
                                         uncertainty =       0.001746281928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379031465
  error estimate for blocks of size 2^( 2) =       0.000389732341
  error estimate for blocks of size 2^( 3) =       0.000399846230
  error estimate for blocks of size 2^( 4) =       0.000407534656
  error estimate for blocks of size 2^( 5) =       0.000411977350
  error estimate for blocks of size 2^( 6) =       0.000413839907
  error estimate for blocks of size 2^( 7) =       0.000415699105

      target function =      -0.899478114311
              le_mean =     -17.215629362469
             les_mean =     296.679593325943
             stat err =       0.000412262754
             autocorr =       1.183035219214
   target nu stat err =       0.000412262754
   target dn stat err =       0.002477645090
      target stat err =       0.003178969497
              std dev =       0.536031437803
             le_variance =       0.287329702314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287362718213
                                         uncertainty =       0.001746361620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287362718213
                                         uncertainty =       0.001746361620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379034160
  error estimate for blocks of size 2^( 2) =       0.000389734077
  error estimate for blocks of size 2^( 3) =       0.000399846878
  error estimate for blocks of size 2^( 4) =       0.000407534629
  error estimate for blocks of size 2^( 5) =       0.000411976765
  error estimate for blocks of size 2^( 6) =       0.000413839062
  error estimate for blocks of size 2^( 7) =       0.000415698028

      target function =      -0.899402183820
              le_mean =     -17.215629204073
             les_mean =     296.679648012049
             stat err =       0.000412262121
             autocorr =       1.183014761754
   target nu stat err =       0.000412262121
   target dn stat err =       0.002480908305
      target stat err =       0.003182488593
              std dev =       0.536035249279
             le_variance =       0.287333788470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287366329249
                                         uncertainty =       0.001746432483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287366329249
                                         uncertainty =       0.001746432483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379036562
  error estimate for blocks of size 2^( 2) =       0.000389735632
  error estimate for blocks of size 2^( 3) =       0.000399847469
  error estimate for blocks of size 2^( 4) =       0.000407534626
  error estimate for blocks of size 2^( 5) =       0.000411976269
  error estimate for blocks of size 2^( 6) =       0.000413838333
  error estimate for blocks of size 2^( 7) =       0.000415697102

      target function =      -0.899442954655
              le_mean =     -17.215629065690
             les_mean =     296.679610888759
             stat err =       0.000412261583
             autocorr =       1.182996674163
   target nu stat err =       0.000412261583
   target dn stat err =       0.002483075599
      target stat err =       0.003185460314
              std dev =       0.536038646672
             le_variance =       0.287337430726


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899440863731        initial
     9.3132e+00     9.3132e+01             1.8366e-05        -0.899478114311  <--
     3.7253e+01     3.7253e+02             4.6187e-06        -0.899402183820
     1.4901e+02     1.4901e+03             1.1564e-06        -0.899442954655

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.2729e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -3.974585e-02 3 1  ON 0
ci_002                -2.994010e-02 3 1  ON 1
ci_003                -2.470799e-02 3 1  ON 2
ci_004                 2.206177e-02 3 1  ON 3
ci_005                 2.246949e-02 3 1  ON 4
ci_006                -1.933245e-02 3 1  ON 5
ci_007                -1.932562e-02 3 1  ON 6
ci_008                -8.722457e-03 3 1  ON 7
ci_009                -1.459963e-02 3 1  ON 8
ci_010                -9.815467e-03 3 1  ON 9
ci_011                -1.014979e-02 3 1  ON 10
ci_012                -1.015589e-02 3 1  ON 11
ci_013                -1.986108e-02 3 1  ON 12
ci_014                 1.169367e-02 3 1  ON 13
ci_015                 1.192084e-02 3 1  ON 14
ci_016                 1.626655e-02 3 1  ON 15
ci_017                 1.621405e-02 3 1  ON 16
ci_018                 9.791451e-03 3 1  ON 17
ci_019                 9.950557e-03 3 1  ON 18
ci_020                 1.549737e-02 3 1  ON 19
ci_021                 1.555738e-02 3 1  ON 20
ci_022                 8.926751e-03 3 1  ON 21
ci_023                 8.822049e-03 3 1  ON 22
ci_024                 9.338975e-03 3 1  ON 23
ci_025                 9.296761e-03 3 1  ON 24
ci_026                 1.042627e-02 3 1  ON 25
ci_027                 1.072071e-02 3 1  ON 26
ci_028                -1.489483e-02 3 1  ON 27
ci_029                -1.537452e-02 3 1  ON 28
ci_030                -8.839543e-03 3 1  ON 29
ci_031                -9.046602e-03 3 1  ON 30
ci_032                -1.468266e-02 3 1  ON 31
ci_033                 5.941534e-03 3 1  ON 32
ci_034                 5.571927e-03 3 1  ON 33
ci_035                -3.963952e-03 3 1  ON 34
ci_036                -1.190390e-02 3 1  ON 35
ci_037                -1.206413e-02 3 1  ON 36
ci_038                 1.546622e-03 3 1  ON 37
ci_039                 1.725316e-03 3 1  ON 38
ci_040                -2.245872e-03 3 1  ON 39
ci_041                 8.319830e-03 3 1  ON 40
ci_042                 8.259376e-03 3 1  ON 41
ci_043                -2.939847e-03 3 1  ON 42
ci_044                -4.727273e-03 3 1  ON 43
ci_045                -2.469526e-03 3 1  ON 44
ci_046                 5.225738e-03 3 1  ON 45
ci_047                 5.220220e-03 3 1  ON 46
ci_048                -1.259008e-02 3 1  ON 47
ci_049                -1.273867e-02 3 1  ON 48
ci_050                 3.457272e-03 3 1  ON 49
ci_051                 3.345445e-03 3 1  ON 50
ci_052                -2.680171e-03 3 1  ON 51
ci_053                -2.715482e-03 3 1  ON 52
ci_054                -2.751605e-03 3 1  ON 53
ci_055                -2.995300e-03 3 1  ON 54
ci_056                 4.960278e-03 3 1  ON 55
ci_057                 5.139208e-03 3 1  ON 56
ci_058                -2.364557e-03 3 1  ON 57
ci_059                -2.374884e-03 3 1  ON 58
ci_060                 5.126102e-03 3 1  ON 59
ci_061                 5.707199e-03 3 1  ON 60
ci_062                -3.422449e-03 3 1  ON 61
ci_063                -3.411693e-03 3 1  ON 62
ci_064                -2.620722e-03 3 1  ON 63
ci_065                -3.664448e-03 3 1  ON 64
ci_066                 4.218493e-03 3 1  ON 65
ci_067                 4.366460e-03 3 1  ON 66
ci_068                -4.829911e-03 3 1  ON 67
ci_069                -4.499422e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8958e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.311
====================================================
  Execution time = 1.3702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0071e-01
  Total weights = 1.957547561e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287116470878
                                         uncertainty =       0.001741196914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287116470878
                                         uncertainty =       0.001741196914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378945478
  error estimate for blocks of size 2^( 2) =       0.000390003012
  error estimate for blocks of size 2^( 3) =       0.000400295555
  error estimate for blocks of size 2^( 4) =       0.000407586381
  error estimate for blocks of size 2^( 5) =       0.000413140698
  error estimate for blocks of size 2^( 6) =       0.000415512559
  error estimate for blocks of size 2^( 7) =       0.000414610957

      target function =      -0.900615352429
              le_mean =     -17.215096657358
             les_mean =     296.660258745113
             stat err =       0.000412712649
             autocorr =       1.186156795051
   target nu stat err =       0.000412712649
   target dn stat err =       0.002620709224
      target stat err =       0.003362303373
              std dev =       0.535909833976
             le_variance =       0.287199350152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721509665736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900626950013       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900658719702       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900664523507       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900665863697       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900666120773       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900666126238       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900666126964       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900666132058       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900666127473       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900666125941       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 6.729101e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900626950013       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900635092099       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900636570495       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900636909057       residual = 9.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900636973948       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900636975048       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900636975292       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900636976524       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900636975379       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900636975005       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.722959e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900626950013       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900628998408       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900629369760       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900629454620       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900629470881       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900629471139       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900629471204       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900629471509       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900629471223       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900629471130       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.333601e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.522425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6193e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.973385e-02 3 1  ON 0
ci_002                -2.993107e-02 3 1  ON 1
ci_003                -2.469756e-02 3 1  ON 2
ci_004                 2.206404e-02 3 1  ON 3
ci_005                 2.245957e-02 3 1  ON 4
ci_006                -1.933189e-02 3 1  ON 5
ci_007                -1.931579e-02 3 1  ON 6
ci_008                -8.709771e-03 3 1  ON 7
ci_009                -1.458620e-02 3 1  ON 8
ci_010                -9.812274e-03 3 1  ON 9
ci_011                -1.013927e-02 3 1  ON 10
ci_012                -1.015512e-02 3 1  ON 11
ci_013                -1.985368e-02 3 1  ON 12
ci_014                 1.167910e-02 3 1  ON 13
ci_015                 1.191661e-02 3 1  ON 14
ci_016                 1.625465e-02 3 1  ON 15
ci_017                 1.620711e-02 3 1  ON 16
ci_018                 9.782145e-03 3 1  ON 17
ci_019                 9.933327e-03 3 1  ON 18
ci_020                 1.549690e-02 3 1  ON 19
ci_021                 1.555440e-02 3 1  ON 20
ci_022                 8.915921e-03 3 1  ON 21
ci_023                 8.815511e-03 3 1  ON 22
ci_024                 9.333865e-03 3 1  ON 23
ci_025                 9.294439e-03 3 1  ON 24
ci_026                 1.042468e-02 3 1  ON 25
ci_027                 1.071004e-02 3 1  ON 26
ci_028                -1.488923e-02 3 1  ON 27
ci_029                -1.537618e-02 3 1  ON 28
ci_030                -8.834925e-03 3 1  ON 29
ci_031                -9.037051e-03 3 1  ON 30
ci_032                -1.468216e-02 3 1  ON 31
ci_033                 5.931506e-03 3 1  ON 32
ci_034                 5.572004e-03 3 1  ON 33
ci_035                -3.953602e-03 3 1  ON 34
ci_036                -1.190633e-02 3 1  ON 35
ci_037                -1.206587e-02 3 1  ON 36
ci_038                 1.542287e-03 3 1  ON 37
ci_039                 1.719678e-03 3 1  ON 38
ci_040                -2.234208e-03 3 1  ON 39
ci_041                 8.312158e-03 3 1  ON 40
ci_042                 8.257136e-03 3 1  ON 41
ci_043                -2.935242e-03 3 1  ON 42
ci_044                -4.713407e-03 3 1  ON 43
ci_045                -2.463571e-03 3 1  ON 44
ci_046                 5.218102e-03 3 1  ON 45
ci_047                 5.220652e-03 3 1  ON 46
ci_048                -1.259122e-02 3 1  ON 47
ci_049                -1.273584e-02 3 1  ON 48
ci_050                 3.449543e-03 3 1  ON 49
ci_051                 3.342507e-03 3 1  ON 50
ci_052                -2.684855e-03 3 1  ON 51
ci_053                -2.715155e-03 3 1  ON 52
ci_054                -2.747229e-03 3 1  ON 53
ci_055                -2.989121e-03 3 1  ON 54
ci_056                 4.952929e-03 3 1  ON 55
ci_057                 5.131830e-03 3 1  ON 56
ci_058                -2.360973e-03 3 1  ON 57
ci_059                -2.365896e-03 3 1  ON 58
ci_060                 5.129554e-03 3 1  ON 59
ci_061                 5.700388e-03 3 1  ON 60
ci_062                -3.421888e-03 3 1  ON 61
ci_063                -3.404445e-03 3 1  ON 62
ci_064                -2.613622e-03 3 1  ON 63
ci_065                -3.661746e-03 3 1  ON 64
ci_066                 4.217776e-03 3 1  ON 65
ci_067                 4.366327e-03 3 1  ON 66
ci_068                -4.821486e-03 3 1  ON 67
ci_069                -4.499594e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1571
    reference variance = 0.219101
====================================================
  Execution time = 1.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0162e-01
  Total weights = 1.9579e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287964498244
                                         uncertainty =       0.001861253893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287964498244
                                         uncertainty =       0.001861253893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379410799
  error estimate for blocks of size 2^( 2) =       0.000390592825
  error estimate for blocks of size 2^( 3) =       0.000400699791
  error estimate for blocks of size 2^( 4) =       0.000408271620
  error estimate for blocks of size 2^( 5) =       0.000411391892
  error estimate for blocks of size 2^( 6) =       0.000415123030
  error estimate for blocks of size 2^( 7) =       0.000417782551

      target function =      -0.899547503653
              le_mean =     -17.215685552287
             les_mean =     296.681480542389
             stat err =       0.000413142273
             autocorr =       1.185713851681
   target nu stat err =       0.000413142273
   target dn stat err =       0.002775287667
      target stat err =       0.003549947174
              std dev =       0.536567897700
             le_variance =       0.287905108843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287919096404
                                         uncertainty =       0.001859924920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287919096404
                                         uncertainty =       0.001859924920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379380848
  error estimate for blocks of size 2^( 2) =       0.000390572007
  error estimate for blocks of size 2^( 3) =       0.000400688976
  error estimate for blocks of size 2^( 4) =       0.000408267947
  error estimate for blocks of size 2^( 5) =       0.000411391172
  error estimate for blocks of size 2^( 6) =       0.000415126920
  error estimate for blocks of size 2^( 7) =       0.000417792804

      target function =      -0.899608968617
              le_mean =     -17.215685724526
             les_mean =     296.681437828033
             stat err =       0.000413144710
             autocorr =       1.185915068293
   target nu stat err =       0.000413144710
   target dn stat err =       0.002771269610
      target stat err =       0.003545424022
              std dev =       0.536525540716
             le_variance =       0.287859655840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287940996902
                                         uncertainty =       0.001860571942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287940996902
                                         uncertainty =       0.001860571942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379395296
  error estimate for blocks of size 2^( 2) =       0.000390581992
  error estimate for blocks of size 2^( 3) =       0.000400694069
  error estimate for blocks of size 2^( 4) =       0.000408269550
  error estimate for blocks of size 2^( 5) =       0.000411391381
  error estimate for blocks of size 2^( 6) =       0.000415124864
  error estimate for blocks of size 2^( 7) =       0.000417787556

      target function =      -0.899438825268
              le_mean =     -17.215685599051
             les_mean =     296.681568280967
             stat err =       0.000413143338
             autocorr =       1.185816867606
   target nu stat err =       0.000413143338
   target dn stat err =       0.002776629013
      target stat err =       0.003550771051
              std dev =       0.536545973275
             le_variance =       0.287881581438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961511538
                                         uncertainty =       0.001861167801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287961511538
                                         uncertainty =       0.001861167801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379408829
  error estimate for blocks of size 2^( 2) =       0.000390591440
  error estimate for blocks of size 2^( 3) =       0.000400699049
  error estimate for blocks of size 2^( 4) =       0.000408271335
  error estimate for blocks of size 2^( 5) =       0.000411391799
  error estimate for blocks of size 2^( 6) =       0.000415123237
  error estimate for blocks of size 2^( 7) =       0.000417783165

      target function =      -0.899562472787
              le_mean =     -17.215685555828
             les_mean =     296.681468806913
             stat err =       0.000413142384
             autocorr =       1.185726803358
   target nu stat err =       0.000413142384
   target dn stat err =       0.002774776967
      target stat err =       0.003549427918
              std dev =       0.536565111487
             le_variance =       0.287902118865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899547503653        initial
     2.3283e+00     2.3283e+01             6.7291e-05        -0.899608968617  <--
     9.3132e+00     9.3132e+01             1.7230e-05        -0.899438825268
     3.7253e+01     3.7253e+02             4.3336e-06        -0.899562472787

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.2816e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -3.969874e-02 3 1  ON 0
ci_002                -2.990472e-02 3 1  ON 1
ci_003                -2.466717e-02 3 1  ON 2
ci_004                 2.207071e-02 3 1  ON 3
ci_005                 2.243049e-02 3 1  ON 4
ci_006                -1.933033e-02 3 1  ON 5
ci_007                -1.928709e-02 3 1  ON 6
ci_008                -8.672994e-03 3 1  ON 7
ci_009                -1.454713e-02 3 1  ON 8
ci_010                -9.802981e-03 3 1  ON 9
ci_011                -1.010864e-02 3 1  ON 10
ci_012                -1.015287e-02 3 1  ON 11
ci_013                -1.983201e-02 3 1  ON 12
ci_014                 1.163665e-02 3 1  ON 13
ci_015                 1.190435e-02 3 1  ON 14
ci_016                 1.621987e-02 3 1  ON 15
ci_017                 1.618687e-02 3 1  ON 16
ci_018                 9.755095e-03 3 1  ON 17
ci_019                 9.883266e-03 3 1  ON 18
ci_020                 1.549541e-02 3 1  ON 19
ci_021                 1.554562e-02 3 1  ON 20
ci_022                 8.884354e-03 3 1  ON 21
ci_023                 8.796425e-03 3 1  ON 22
ci_024                 9.318928e-03 3 1  ON 23
ci_025                 9.287597e-03 3 1  ON 24
ci_026                 1.042011e-02 3 1  ON 25
ci_027                 1.067898e-02 3 1  ON 26
ci_028                -1.487283e-02 3 1  ON 27
ci_029                -1.538108e-02 3 1  ON 28
ci_030                -8.821519e-03 3 1  ON 29
ci_031                -9.009269e-03 3 1  ON 30
ci_032                -1.468072e-02 3 1  ON 31
ci_033                 5.902236e-03 3 1  ON 32
ci_034                 5.572227e-03 3 1  ON 33
ci_035                -3.923502e-03 3 1  ON 34
ci_036                -1.191328e-02 3 1  ON 35
ci_037                -1.207084e-02 3 1  ON 36
ci_038                 1.529691e-03 3 1  ON 37
ci_039                 1.703295e-03 3 1  ON 38
ci_040                -2.200336e-03 3 1  ON 39
ci_041                 8.289850e-03 3 1  ON 40
ci_042                 8.250675e-03 3 1  ON 41
ci_043                -2.921850e-03 3 1  ON 42
ci_044                -4.673037e-03 3 1  ON 43
ci_045                -2.446275e-03 3 1  ON 44
ci_046                 5.195841e-03 3 1  ON 45
ci_047                 5.221911e-03 3 1  ON 46
ci_048                -1.259463e-02 3 1  ON 47
ci_049                -1.272755e-02 3 1  ON 48
ci_050                 3.427143e-03 3 1  ON 49
ci_051                 3.333983e-03 3 1  ON 50
ci_052                -2.698501e-03 3 1  ON 51
ci_053                -2.714248e-03 3 1  ON 52
ci_054                -2.734459e-03 3 1  ON 53
ci_055                -2.971109e-03 3 1  ON 54
ci_056                 4.931554e-03 3 1  ON 55
ci_057                 5.110358e-03 3 1  ON 56
ci_058                -2.350587e-03 3 1  ON 57
ci_059                -2.339873e-03 3 1  ON 58
ci_060                 5.139614e-03 3 1  ON 59
ci_061                 5.680521e-03 3 1  ON 60
ci_062                -3.420240e-03 3 1  ON 61
ci_063                -3.383337e-03 3 1  ON 62
ci_064                -2.593016e-03 3 1  ON 63
ci_065                -3.653895e-03 3 1  ON 64
ci_066                 4.215716e-03 3 1  ON 65
ci_067                 4.365940e-03 3 1  ON 66
ci_068                -4.796952e-03 3 1  ON 67
ci_069                -4.500133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.186585
====================================================
  Execution time = 1.3763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9931e-01
  Total weights = 1.957129229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284586709024
                                         uncertainty =       0.001504227153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284586709024
                                         uncertainty =       0.001504227153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377250553
  error estimate for blocks of size 2^( 2) =       0.000388028434
  error estimate for blocks of size 2^( 3) =       0.000398179959
  error estimate for blocks of size 2^( 4) =       0.000405567989
  error estimate for blocks of size 2^( 5) =       0.000410427244
  error estimate for blocks of size 2^( 6) =       0.000411892037
  error estimate for blocks of size 2^( 7) =       0.000412187686

      target function =      -0.902342538683
              le_mean =     -17.214941806603
             les_mean =     296.653534794664
             stat err =       0.000410018739
             autocorr =       1.181265825886
   target nu stat err =       0.000410018739
   target dn stat err =       0.002753425743
      target stat err =       0.003539536108
              std dev =       0.533512849001
             le_variance =       0.284635960049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721494180660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902355681938       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902419407829       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902433926087       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902437716686       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902438626519       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902438825688       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902438848523       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902438834884       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902438847614       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902438846600       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 2.366350e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902355681938       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902373138954       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902377034644       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902378021324       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902378256412       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902378304099       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902378310552       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902378306834       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902378309916       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902378309699       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 6.347061e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902355681938       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902360153223       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902361145238       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902361394348       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902361453586       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902361465338       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902361467003       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902361466056       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902361466818       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902361466766       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.616213e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.525921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6291e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.963928e-02 3 1  ON 0
ci_002                -2.986524e-02 3 1  ON 1
ci_003                -2.464006e-02 3 1  ON 2
ci_004                 2.205712e-02 3 1  ON 3
ci_005                 2.236702e-02 3 1  ON 4
ci_006                -1.929837e-02 3 1  ON 5
ci_007                -1.925561e-02 3 1  ON 6
ci_008                -8.663478e-03 3 1  ON 7
ci_009                -1.452784e-02 3 1  ON 8
ci_010                -9.778547e-03 3 1  ON 9
ci_011                -1.007033e-02 3 1  ON 10
ci_012                -1.010890e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.161561e-02 3 1  ON 13
ci_015                 1.186278e-02 3 1  ON 14
ci_016                 1.622119e-02 3 1  ON 15
ci_017                 1.616642e-02 3 1  ON 16
ci_018                 9.723630e-03 3 1  ON 17
ci_019                 9.858699e-03 3 1  ON 18
ci_020                 1.547327e-02 3 1  ON 19
ci_021                 1.554457e-02 3 1  ON 20
ci_022                 8.879621e-03 3 1  ON 21
ci_023                 8.776984e-03 3 1  ON 22
ci_024                 9.282677e-03 3 1  ON 23
ci_025                 9.234180e-03 3 1  ON 24
ci_026                 1.038368e-02 3 1  ON 25
ci_027                 1.064675e-02 3 1  ON 26
ci_028                -1.486353e-02 3 1  ON 27
ci_029                -1.534909e-02 3 1  ON 28
ci_030                -8.857733e-03 3 1  ON 29
ci_031                -8.989488e-03 3 1  ON 30
ci_032                -1.466122e-02 3 1  ON 31
ci_033                 5.882584e-03 3 1  ON 32
ci_034                 5.583110e-03 3 1  ON 33
ci_035                -3.916977e-03 3 1  ON 34
ci_036                -1.189585e-02 3 1  ON 35
ci_037                -1.206010e-02 3 1  ON 36
ci_038                 1.508781e-03 3 1  ON 37
ci_039                 1.666516e-03 3 1  ON 38
ci_040                -2.186867e-03 3 1  ON 39
ci_041                 8.260329e-03 3 1  ON 40
ci_042                 8.232937e-03 3 1  ON 41
ci_043                -2.900973e-03 3 1  ON 42
ci_044                -4.668996e-03 3 1  ON 43
ci_045                -2.422040e-03 3 1  ON 44
ci_046                 5.186115e-03 3 1  ON 45
ci_047                 5.220908e-03 3 1  ON 46
ci_048                -1.257096e-02 3 1  ON 47
ci_049                -1.273013e-02 3 1  ON 48
ci_050                 3.388630e-03 3 1  ON 49
ci_051                 3.303476e-03 3 1  ON 50
ci_052                -2.684182e-03 3 1  ON 51
ci_053                -2.724278e-03 3 1  ON 52
ci_054                -2.719610e-03 3 1  ON 53
ci_055                -2.975437e-03 3 1  ON 54
ci_056                 4.925421e-03 3 1  ON 55
ci_057                 5.084574e-03 3 1  ON 56
ci_058                -2.352749e-03 3 1  ON 57
ci_059                -2.338881e-03 3 1  ON 58
ci_060                 5.128605e-03 3 1  ON 59
ci_061                 5.686580e-03 3 1  ON 60
ci_062                -3.397530e-03 3 1  ON 61
ci_063                -3.382448e-03 3 1  ON 62
ci_064                -2.595563e-03 3 1  ON 63
ci_065                -3.643267e-03 3 1  ON 64
ci_066                 4.241694e-03 3 1  ON 65
ci_067                 4.375160e-03 3 1  ON 66
ci_068                -4.773744e-03 3 1  ON 67
ci_069                -4.491705e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.219
    reference variance = 0.218079
====================================================
  Execution time = 1.3399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0044e-01
  Total weights = 1.9578e+06
  Execution time = 1.8237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287048182229
                                         uncertainty =       0.001778344027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287048182229
                                         uncertainty =       0.001778344027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378833116
  error estimate for blocks of size 2^( 2) =       0.000389789234
  error estimate for blocks of size 2^( 3) =       0.000399838526
  error estimate for blocks of size 2^( 4) =       0.000407487340
  error estimate for blocks of size 2^( 5) =       0.000412220980
  error estimate for blocks of size 2^( 6) =       0.000415142256
  error estimate for blocks of size 2^( 7) =       0.000417635234

      target function =      -0.900829563536
              le_mean =     -17.214847558395
             les_mean =     296.651468296859
             stat err =       0.000413121453
             autocorr =       1.189212933270
   target nu stat err =       0.000413121453
   target dn stat err =       0.002756789175
      target stat err =       0.003532221916
              std dev =       0.535750929981
             le_variance =       0.287029058976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286904683071
                                         uncertainty =       0.001762323741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286904683071
                                         uncertainty =       0.001762323741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378738330
  error estimate for blocks of size 2^( 2) =       0.000389723308
  error estimate for blocks of size 2^( 3) =       0.000399800924
  error estimate for blocks of size 2^( 4) =       0.000407472317
  error estimate for blocks of size 2^( 5) =       0.000412227301
  error estimate for blocks of size 2^( 6) =       0.000415151751
  error estimate for blocks of size 2^( 7) =       0.000417647299

      target function =      -0.900711797304
              le_mean =     -17.214845121251
             les_mean =     296.651477310648
             stat err =       0.000413124667
             autocorr =       1.189826763453
   target nu stat err =       0.000413124667
   target dn stat err =       0.002736622600
      target stat err =       0.003506163426
              std dev =       0.535616882827
             le_variance =       0.286885445169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286967732670
                                         uncertainty =       0.001769477925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286967732670
                                         uncertainty =       0.001769477925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378779978
  error estimate for blocks of size 2^( 2) =       0.000389751720
  error estimate for blocks of size 2^( 3) =       0.000399816263
  error estimate for blocks of size 2^( 4) =       0.000407477261
  error estimate for blocks of size 2^( 5) =       0.000412222413
  error estimate for blocks of size 2^( 6) =       0.000415145472
  error estimate for blocks of size 2^( 7) =       0.000417639905

      target function =      -0.900930778922
              le_mean =     -17.214845856676
             les_mean =     296.651329466723
             stat err =       0.000413121263
             autocorr =       1.189545526432
   target nu stat err =       0.000413121263
   target dn stat err =       0.002740048561
      target stat err =       0.003512120163
              std dev =       0.535675781416
             le_variance =       0.286948542796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287037572598
                                         uncertainty =       0.001777191714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287037572598
                                         uncertainty =       0.001777191714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378826108
  error estimate for blocks of size 2^( 2) =       0.000389784215
  error estimate for blocks of size 2^( 3) =       0.000399835447
  error estimate for blocks of size 2^( 4) =       0.000407485814
  error estimate for blocks of size 2^( 5) =       0.000412220921
  error estimate for blocks of size 2^( 6) =       0.000415142430
  error estimate for blocks of size 2^( 7) =       0.000417635604

      target function =      -0.900847309634
              le_mean =     -17.214847294235
             les_mean =     296.651445132859
             stat err =       0.000413121192
             autocorr =       1.189255428990
   target nu stat err =       0.000413121192
   target dn stat err =       0.002754523821
      target stat err =       0.003529533137
              std dev =       0.535741020063
             le_variance =       0.287018440578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900829563536        initial
     5.8208e-01     5.8208e+00             2.3663e-04        -0.900711797304
     2.3283e+00     2.3283e+01             6.3471e-05        -0.900930778922  <--
     9.3132e+00     9.3132e+01             1.6162e-05        -0.900847309634

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.2645e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -3.963928e-02 3 1  ON 0
ci_002                -2.986524e-02 3 1  ON 1
ci_003                -2.464006e-02 3 1  ON 2
ci_004                 2.205712e-02 3 1  ON 3
ci_005                 2.236702e-02 3 1  ON 4
ci_006                -1.929837e-02 3 1  ON 5
ci_007                -1.925561e-02 3 1  ON 6
ci_008                -8.663478e-03 3 1  ON 7
ci_009                -1.452784e-02 3 1  ON 8
ci_010                -9.778547e-03 3 1  ON 9
ci_011                -1.007033e-02 3 1  ON 10
ci_012                -1.010890e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.161561e-02 3 1  ON 13
ci_015                 1.186278e-02 3 1  ON 14
ci_016                 1.622119e-02 3 1  ON 15
ci_017                 1.616642e-02 3 1  ON 16
ci_018                 9.723630e-03 3 1  ON 17
ci_019                 9.858699e-03 3 1  ON 18
ci_020                 1.547327e-02 3 1  ON 19
ci_021                 1.554457e-02 3 1  ON 20
ci_022                 8.879621e-03 3 1  ON 21
ci_023                 8.776984e-03 3 1  ON 22
ci_024                 9.282677e-03 3 1  ON 23
ci_025                 9.234180e-03 3 1  ON 24
ci_026                 1.038368e-02 3 1  ON 25
ci_027                 1.064675e-02 3 1  ON 26
ci_028                -1.486353e-02 3 1  ON 27
ci_029                -1.534909e-02 3 1  ON 28
ci_030                -8.857733e-03 3 1  ON 29
ci_031                -8.989488e-03 3 1  ON 30
ci_032                -1.466122e-02 3 1  ON 31
ci_033                 5.882584e-03 3 1  ON 32
ci_034                 5.583110e-03 3 1  ON 33
ci_035                -3.916977e-03 3 1  ON 34
ci_036                -1.189585e-02 3 1  ON 35
ci_037                -1.206010e-02 3 1  ON 36
ci_038                 1.508781e-03 3 1  ON 37
ci_039                 1.666516e-03 3 1  ON 38
ci_040                -2.186867e-03 3 1  ON 39
ci_041                 8.260329e-03 3 1  ON 40
ci_042                 8.232937e-03 3 1  ON 41
ci_043                -2.900973e-03 3 1  ON 42
ci_044                -4.668996e-03 3 1  ON 43
ci_045                -2.422040e-03 3 1  ON 44
ci_046                 5.186115e-03 3 1  ON 45
ci_047                 5.220908e-03 3 1  ON 46
ci_048                -1.257096e-02 3 1  ON 47
ci_049                -1.273013e-02 3 1  ON 48
ci_050                 3.388630e-03 3 1  ON 49
ci_051                 3.303476e-03 3 1  ON 50
ci_052                -2.684182e-03 3 1  ON 51
ci_053                -2.724278e-03 3 1  ON 52
ci_054                -2.719610e-03 3 1  ON 53
ci_055                -2.975437e-03 3 1  ON 54
ci_056                 4.925421e-03 3 1  ON 55
ci_057                 5.084574e-03 3 1  ON 56
ci_058                -2.352749e-03 3 1  ON 57
ci_059                -2.338881e-03 3 1  ON 58
ci_060                 5.128605e-03 3 1  ON 59
ci_061                 5.686580e-03 3 1  ON 60
ci_062                -3.397530e-03 3 1  ON 61
ci_063                -3.382448e-03 3 1  ON 62
ci_064                -2.595563e-03 3 1  ON 63
ci_065                -3.643267e-03 3 1  ON 64
ci_066                 4.241694e-03 3 1  ON 65
ci_067                 4.375160e-03 3 1  ON 66
ci_068                -4.773744e-03 3 1  ON 67
ci_069                -4.491705e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1687
    reference variance = 0.239491
====================================================
  Execution time = 1.3949e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0113e-01
  Total weights = 1.957518440e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766495900
                                         uncertainty =       0.002021057266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288766495900
                                         uncertainty =       0.002021057266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380047563
  error estimate for blocks of size 2^( 2) =       0.000391055185
  error estimate for blocks of size 2^( 3) =       0.000401315454
  error estimate for blocks of size 2^( 4) =       0.000407613034
  error estimate for blocks of size 2^( 5) =       0.000412222292
  error estimate for blocks of size 2^( 6) =       0.000415690773
  error estimate for blocks of size 2^( 7) =       0.000414977697

      target function =      -0.900087367787
              le_mean =     -17.215117066340
             les_mean =     296.661382705287
             stat err =       0.000412625949
             autocorr =       1.178791967156
   target nu stat err =       0.000412625949
   target dn stat err =       0.002626220503
      target stat err =       0.003365361141
              std dev =       0.537468418330
             le_variance =       0.288872300702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721511706634e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900099298780       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900204917201       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900218354954       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900221997047       residual = 8.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900222412554       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900222515371       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900222492295       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900222495037       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900222487214       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900222478636       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 2.556542e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900099298780       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900128252465       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900131845962       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900132798254       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900132902850       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900132927719       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900132921486       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900132922193       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900132920189       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900132918006       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 6.970102e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900099298780       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900106716197       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900107630367       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900107871106       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900107897268       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900107903416       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900107901828       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900107902006       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900107901503       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900107900955       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.782889e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.529311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6451e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.957964e-02 3 1  ON 0
ci_002                -2.980718e-02 3 1  ON 1
ci_003                -2.466564e-02 3 1  ON 2
ci_004                 2.204444e-02 3 1  ON 3
ci_005                 2.232874e-02 3 1  ON 4
ci_006                -1.925559e-02 3 1  ON 5
ci_007                -1.923822e-02 3 1  ON 6
ci_008                -8.630109e-03 3 1  ON 7
ci_009                -1.447501e-02 3 1  ON 8
ci_010                -9.730909e-03 3 1  ON 9
ci_011                -1.000063e-02 3 1  ON 10
ci_012                -1.012668e-02 3 1  ON 11
ci_013                -1.979463e-02 3 1  ON 12
ci_014                 1.159247e-02 3 1  ON 13
ci_015                 1.183414e-02 3 1  ON 14
ci_016                 1.622186e-02 3 1  ON 15
ci_017                 1.616248e-02 3 1  ON 16
ci_018                 9.689055e-03 3 1  ON 17
ci_019                 9.850159e-03 3 1  ON 18
ci_020                 1.545632e-02 3 1  ON 19
ci_021                 1.556917e-02 3 1  ON 20
ci_022                 8.842813e-03 3 1  ON 21
ci_023                 8.760989e-03 3 1  ON 22
ci_024                 9.267332e-03 3 1  ON 23
ci_025                 9.193692e-03 3 1  ON 24
ci_026                 1.034975e-02 3 1  ON 25
ci_027                 1.062645e-02 3 1  ON 26
ci_028                -1.486213e-02 3 1  ON 27
ci_029                -1.533077e-02 3 1  ON 28
ci_030                -8.840860e-03 3 1  ON 29
ci_031                -9.016658e-03 3 1  ON 30
ci_032                -1.464857e-02 3 1  ON 31
ci_033                 5.869997e-03 3 1  ON 32
ci_034                 5.515036e-03 3 1  ON 33
ci_035                -3.910128e-03 3 1  ON 34
ci_036                -1.188636e-02 3 1  ON 35
ci_037                -1.204132e-02 3 1  ON 36
ci_038                 1.492657e-03 3 1  ON 37
ci_039                 1.647727e-03 3 1  ON 38
ci_040                -2.177783e-03 3 1  ON 39
ci_041                 8.231630e-03 3 1  ON 40
ci_042                 8.248647e-03 3 1  ON 41
ci_043                -2.875812e-03 3 1  ON 42
ci_044                -4.649832e-03 3 1  ON 43
ci_045                -2.393898e-03 3 1  ON 44
ci_046                 5.173950e-03 3 1  ON 45
ci_047                 5.187291e-03 3 1  ON 46
ci_048                -1.257788e-02 3 1  ON 47
ci_049                -1.268714e-02 3 1  ON 48
ci_050                 3.385886e-03 3 1  ON 49
ci_051                 3.271737e-03 3 1  ON 50
ci_052                -2.676834e-03 3 1  ON 51
ci_053                -2.706586e-03 3 1  ON 52
ci_054                -2.691549e-03 3 1  ON 53
ci_055                -2.958144e-03 3 1  ON 54
ci_056                 4.896352e-03 3 1  ON 55
ci_057                 5.068646e-03 3 1  ON 56
ci_058                -2.353085e-03 3 1  ON 57
ci_059                -2.324445e-03 3 1  ON 58
ci_060                 5.129677e-03 3 1  ON 59
ci_061                 5.659272e-03 3 1  ON 60
ci_062                -3.363978e-03 3 1  ON 61
ci_063                -3.368053e-03 3 1  ON 62
ci_064                -2.593669e-03 3 1  ON 63
ci_065                -3.632858e-03 3 1  ON 64
ci_066                 4.239624e-03 3 1  ON 65
ci_067                 4.340407e-03 3 1  ON 66
ci_068                -4.753364e-03 3 1  ON 67
ci_069                -4.491473e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.191294
====================================================
  Execution time = 1.3333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0019e-01
  Total weights = 1.9572e+06
  Execution time = 1.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286233408804
                                         uncertainty =       0.001454680305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286233408804
                                         uncertainty =       0.001454680305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378264724
  error estimate for blocks of size 2^( 2) =       0.000389458081
  error estimate for blocks of size 2^( 3) =       0.000399037013
  error estimate for blocks of size 2^( 4) =       0.000406762035
  error estimate for blocks of size 2^( 5) =       0.000410907982
  error estimate for blocks of size 2^( 6) =       0.000415493322
  error estimate for blocks of size 2^( 7) =       0.000415949588

      target function =      -0.901272920400
              le_mean =     -17.215380422021
             les_mean =     296.669560368241
             stat err =       0.000412278232
             autocorr =       1.187925280897
   target nu stat err =       0.000412278232
   target dn stat err =       0.002288187545
      target stat err =       0.002954635336
              std dev =       0.534947103358
             le_variance =       0.286168403391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286123145437
                                         uncertainty =       0.001453623621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286123145437
                                         uncertainty =       0.001453623621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378191820
  error estimate for blocks of size 2^( 2) =       0.000389416998
  error estimate for blocks of size 2^( 3) =       0.000399029152
  error estimate for blocks of size 2^( 4) =       0.000406776589
  error estimate for blocks of size 2^( 5) =       0.000410938875
  error estimate for blocks of size 2^( 6) =       0.000415524397
  error estimate for blocks of size 2^( 7) =       0.000415977674

      target function =      -0.900604210658
              le_mean =     -17.215384049997
             les_mean =     296.670213823858
             stat err =       0.000412304384
             autocorr =       1.188534090259
   target nu stat err =       0.000412304384
   target dn stat err =       0.002382816062
      target stat err =       0.003067769643
              std dev =       0.534844000624
             le_variance =       0.286058105003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286169624151
                                         uncertainty =       0.001453945959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286169624151
                                         uncertainty =       0.001453945959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378222554
  error estimate for blocks of size 2^( 2) =       0.000389433230
  error estimate for blocks of size 2^( 3) =       0.000399030152
  error estimate for blocks of size 2^( 4) =       0.000406767327
  error estimate for blocks of size 2^( 5) =       0.000410922194
  error estimate for blocks of size 2^( 6) =       0.000415507425
  error estimate for blocks of size 2^( 7) =       0.000415962159

      target function =      -0.901191556789
              le_mean =     -17.215381879889
             les_mean =     296.669675080743
             stat err =       0.000412289776
             autocorr =       1.188256735281
   target nu stat err =       0.000412289776
   target dn stat err =       0.002288863242
      target stat err =       0.002954960853
              std dev =       0.534887465700
             le_variance =       0.286104600963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286224719855
                                         uncertainty =       0.001454559916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286224719855
                                         uncertainty =       0.001454559916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378258980
  error estimate for blocks of size 2^( 2) =       0.000389454540
  error estimate for blocks of size 2^( 3) =       0.000399035750
  error estimate for blocks of size 2^( 4) =       0.000406762332
  error estimate for blocks of size 2^( 5) =       0.000410909408
  error estimate for blocks of size 2^( 6) =       0.000415494703
  error estimate for blocks of size 2^( 7) =       0.000415950714

      target function =      -0.901314218406
              le_mean =     -17.215380552005
             les_mean =     296.669532270290
             stat err =       0.000412279289
             autocorr =       1.187967454013
   target nu stat err =       0.000412279289
   target dn stat err =       0.002285269000
      target stat err =       0.002951277715
              std dev =       0.534938979974
             le_variance =       0.286159712296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901272920400        initial
     5.8208e-01     5.8208e+00             2.5565e-04        -0.900604210658
     2.3283e+00     2.3283e+01             6.9701e-05        -0.901191556789
     9.3132e+00     9.3132e+01             1.7829e-05        -0.901314218406  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.2590e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -3.962409e-02 3 1  ON 0
ci_002                -2.985044e-02 3 1  ON 1
ci_003                -2.464662e-02 3 1  ON 2
ci_004                 2.205390e-02 3 1  ON 3
ci_005                 2.235727e-02 3 1  ON 4
ci_006                -1.928746e-02 3 1  ON 5
ci_007                -1.925117e-02 3 1  ON 6
ci_008                -8.654922e-03 3 1  ON 7
ci_009                -1.451432e-02 3 1  ON 8
ci_010                -9.766375e-03 3 1  ON 9
ci_011                -1.005250e-02 3 1  ON 10
ci_012                -1.011346e-02 3 1  ON 11
ci_013                -1.980752e-02 3 1  ON 12
ci_014                 1.160969e-02 3 1  ON 13
ci_015                 1.185547e-02 3 1  ON 14
ci_016                 1.622134e-02 3 1  ON 15
ci_017                 1.616540e-02 3 1  ON 16
ci_018                 9.714759e-03 3 1  ON 17
ci_019                 9.856519e-03 3 1  ON 18
ci_020                 1.546895e-02 3 1  ON 19
ci_021                 1.555086e-02 3 1  ON 20
ci_022                 8.870209e-03 3 1  ON 21
ci_023                 8.772895e-03 3 1  ON 22
ci_024                 9.278782e-03 3 1  ON 23
ci_025                 9.223864e-03 3 1  ON 24
ci_026                 1.037500e-02 3 1  ON 25
ci_027                 1.064157e-02 3 1  ON 26
ci_028                -1.486318e-02 3 1  ON 27
ci_029                -1.534440e-02 3 1  ON 28
ci_030                -8.853410e-03 3 1  ON 29
ci_031                -8.996473e-03 3 1  ON 30
ci_032                -1.465799e-02 3 1  ON 31
ci_033                 5.879376e-03 3 1  ON 32
ci_034                 5.565722e-03 3 1  ON 33
ci_035                -3.915224e-03 3 1  ON 34
ci_036                -1.189341e-02 3 1  ON 35
ci_037                -1.205528e-02 3 1  ON 36
ci_038                 1.504654e-03 3 1  ON 37
ci_039                 1.661706e-03 3 1  ON 38
ci_040                -2.184540e-03 3 1  ON 39
ci_041                 8.252976e-03 3 1  ON 40
ci_042                 8.236964e-03 3 1  ON 41
ci_043                -2.894536e-03 3 1  ON 42
ci_044                -4.664092e-03 3 1  ON 43
ci_045                -2.414832e-03 3 1  ON 44
ci_046                 5.183007e-03 3 1  ON 45
ci_047                 5.212323e-03 3 1  ON 46
ci_048                -1.257271e-02 3 1  ON 47
ci_049                -1.271914e-02 3 1  ON 48
ci_050                 3.387929e-03 3 1  ON 49
ci_051                 3.295335e-03 3 1  ON 50
ci_052                -2.682297e-03 3 1  ON 51
ci_053                -2.719734e-03 3 1  ON 52
ci_054                -2.712418e-03 3 1  ON 53
ci_055                -2.971021e-03 3 1  ON 54
ci_056                 4.917985e-03 3 1  ON 55
ci_057                 5.080500e-03 3 1  ON 56
ci_058                -2.352825e-03 3 1  ON 57
ci_059                -2.335177e-03 3 1  ON 58
ci_060                 5.128879e-03 3 1  ON 59
ci_061                 5.679607e-03 3 1  ON 60
ci_062                -3.388958e-03 3 1  ON 61
ci_063                -3.378779e-03 3 1  ON 62
ci_064                -2.595080e-03 3 1  ON 63
ci_065                -3.640602e-03 3 1  ON 64
ci_066                 4.241162e-03 3 1  ON 65
ci_067                 4.366256e-03 3 1  ON 66
ci_068                -4.768532e-03 3 1  ON 67
ci_069                -4.491642e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2918
    reference variance = 0.183383
====================================================
  Execution time = 1.3904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0245e-01
  Total weights = 1.957272060e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288837520627
                                         uncertainty =       0.001821319687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288837520627
                                         uncertainty =       0.001821319687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380021262
  error estimate for blocks of size 2^( 2) =       0.000391437881
  error estimate for blocks of size 2^( 3) =       0.000401448639
  error estimate for blocks of size 2^( 4) =       0.000408392831
  error estimate for blocks of size 2^( 5) =       0.000412659717
  error estimate for blocks of size 2^( 6) =       0.000414783947
  error estimate for blocks of size 2^( 7) =       0.000414720675

      target function =      -0.898517824311
              le_mean =     -17.215569813036
             les_mean =     296.678293973611
             stat err =       0.000412639293
             autocorr =       1.179031390722
   target nu stat err =       0.000412639293
   target dn stat err =       0.002599192082
      target stat err =       0.003322666360
              std dev =       0.537431223192
             le_variance =       0.288832319662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721556981304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898529331579       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898551663808       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898555423764       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898556882438       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898556951101       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898556992658       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898557004265       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898557001523       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898557002618       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898557001754       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 6.104018e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898529331579       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898535050983       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898536008237       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898536376947       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898536393934       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898536404452       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898536407273       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898536406580       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898536406855       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898536406644       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.558666e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898529331579       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898530770213       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898531010629       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898531103059       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898531107294       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898531109932       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898531110632       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898531110458       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898531110527       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898531110474       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 3.917629e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.532752 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6401e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.961118e-02 3 1  ON 0
ci_002                -2.983984e-02 3 1  ON 1
ci_003                -2.464068e-02 3 1  ON 2
ci_004                 2.204599e-02 3 1  ON 3
ci_005                 2.234610e-02 3 1  ON 4
ci_006                -1.927762e-02 3 1  ON 5
ci_007                -1.924121e-02 3 1  ON 6
ci_008                -8.645082e-03 3 1  ON 7
ci_009                -1.450638e-02 3 1  ON 8
ci_010                -9.766038e-03 3 1  ON 9
ci_011                -1.004424e-02 3 1  ON 10
ci_012                -1.010541e-02 3 1  ON 11
ci_013                -1.981194e-02 3 1  ON 12
ci_014                 1.160727e-02 3 1  ON 13
ci_015                 1.184128e-02 3 1  ON 14
ci_016                 1.621364e-02 3 1  ON 15
ci_017                 1.615705e-02 3 1  ON 16
ci_018                 9.707116e-03 3 1  ON 17
ci_019                 9.845066e-03 3 1  ON 18
ci_020                 1.546494e-02 3 1  ON 19
ci_021                 1.554230e-02 3 1  ON 20
ci_022                 8.866776e-03 3 1  ON 21
ci_023                 8.760427e-03 3 1  ON 22
ci_024                 9.277111e-03 3 1  ON 23
ci_025                 9.213911e-03 3 1  ON 24
ci_026                 1.038099e-02 3 1  ON 25
ci_027                 1.063419e-02 3 1  ON 26
ci_028                -1.486255e-02 3 1  ON 27
ci_029                -1.534252e-02 3 1  ON 28
ci_030                -8.849174e-03 3 1  ON 29
ci_031                -8.996035e-03 3 1  ON 30
ci_032                -1.465224e-02 3 1  ON 31
ci_033                 5.877889e-03 3 1  ON 32
ci_034                 5.550136e-03 3 1  ON 33
ci_035                -3.911951e-03 3 1  ON 34
ci_036                -1.188944e-02 3 1  ON 35
ci_037                -1.205281e-02 3 1  ON 36
ci_038                 1.500792e-03 3 1  ON 37
ci_039                 1.652325e-03 3 1  ON 38
ci_040                -2.181127e-03 3 1  ON 39
ci_041                 8.249171e-03 3 1  ON 40
ci_042                 8.239585e-03 3 1  ON 41
ci_043                -2.889692e-03 3 1  ON 42
ci_044                -4.657604e-03 3 1  ON 43
ci_045                -2.410499e-03 3 1  ON 44
ci_046                 5.181226e-03 3 1  ON 45
ci_047                 5.207342e-03 3 1  ON 46
ci_048                -1.257894e-02 3 1  ON 47
ci_049                -1.271766e-02 3 1  ON 48
ci_050                 3.384002e-03 3 1  ON 49
ci_051                 3.296005e-03 3 1  ON 50
ci_052                -2.680402e-03 3 1  ON 51
ci_053                -2.721767e-03 3 1  ON 52
ci_054                -2.708687e-03 3 1  ON 53
ci_055                -2.968542e-03 3 1  ON 54
ci_056                 4.917632e-03 3 1  ON 55
ci_057                 5.080328e-03 3 1  ON 56
ci_058                -2.340260e-03 3 1  ON 57
ci_059                -2.341549e-03 3 1  ON 58
ci_060                 5.117225e-03 3 1  ON 59
ci_061                 5.674530e-03 3 1  ON 60
ci_062                -3.388561e-03 3 1  ON 61
ci_063                -3.372027e-03 3 1  ON 62
ci_064                -2.592530e-03 3 1  ON 63
ci_065                -3.639619e-03 3 1  ON 64
ci_066                 4.238750e-03 3 1  ON 65
ci_067                 4.361359e-03 3 1  ON 66
ci_068                -4.760341e-03 3 1  ON 67
ci_069                -4.494524e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.239088
====================================================
  Execution time = 1.3484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9597e-01
  Total weights = 1.9576e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283234905831
                                         uncertainty =       0.001429073425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283234905831
                                         uncertainty =       0.001429073425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376315325
  error estimate for blocks of size 2^( 2) =       0.000387543374
  error estimate for blocks of size 2^( 3) =       0.000397863108
  error estimate for blocks of size 2^( 4) =       0.000404817715
  error estimate for blocks of size 2^( 5) =       0.000408177479
  error estimate for blocks of size 2^( 6) =       0.000411214216
  error estimate for blocks of size 2^( 7) =       0.000414005808

      target function =      -0.906604061092
              le_mean =     -17.215042954283
             les_mean =     296.653695231890
             stat err =       0.000409553804
             autocorr =       1.184453783232
   target nu stat err =       0.000409553804
   target dn stat err =       0.002200143810
      target stat err =       0.002876171267
              std dev =       0.532190236333
             le_variance =       0.283226447648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283204186994
                                         uncertainty =       0.001428891337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283204186994
                                         uncertainty =       0.001428891337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376294847
  error estimate for blocks of size 2^( 2) =       0.000387532322
  error estimate for blocks of size 2^( 3) =       0.000397861060
  error estimate for blocks of size 2^( 4) =       0.000404823495
  error estimate for blocks of size 2^( 5) =       0.000408185023
  error estimate for blocks of size 2^( 6) =       0.000411223793
  error estimate for blocks of size 2^( 7) =       0.000414014700

      target function =      -0.906621453289
              le_mean =     -17.215042254697
             les_mean =     296.653657419452
             stat err =       0.000409561753
             autocorr =       1.184628680859
   target nu stat err =       0.000409561753
   target dn stat err =       0.002203030757
      target stat err =       0.002879900149
              std dev =       0.532161276206
             le_variance =       0.283195623893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283219013609
                                         uncertainty =       0.001428976747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283219013609
                                         uncertainty =       0.001428976747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376304731
  error estimate for blocks of size 2^( 2) =       0.000387537595
  error estimate for blocks of size 2^( 3) =       0.000397861920
  error estimate for blocks of size 2^( 4) =       0.000404820527
  error estimate for blocks of size 2^( 5) =       0.000408181189
  error estimate for blocks of size 2^( 6) =       0.000411218964
  error estimate for blocks of size 2^( 7) =       0.000414010212

      target function =      -0.906641856541
              le_mean =     -17.215042565778
             les_mean =     296.653652266442
             stat err =       0.000409557723
             autocorr =       1.184543139523
   target nu stat err =       0.000409557723
   target dn stat err =       0.002200944504
      target stat err =       0.002877410093
              std dev =       0.532175254446
             le_variance =       0.283210501444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283232885279
                                         uncertainty =       0.001429060843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283232885279
                                         uncertainty =       0.001429060843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376313978
  error estimate for blocks of size 2^( 2) =       0.000387542633
  error estimate for blocks of size 2^( 3) =       0.000397862950
  error estimate for blocks of size 2^( 4) =       0.000404818060
  error estimate for blocks of size 2^( 5) =       0.000408177934
  error estimate for blocks of size 2^( 6) =       0.000411214803
  error estimate for blocks of size 2^( 7) =       0.000414006348

      target function =      -0.906533928125
              le_mean =     -17.215042899419
             les_mean =     296.653748099179
             stat err =       0.000409554286
             autocorr =       1.184465046775
   target nu stat err =       0.000409554286
   target dn stat err =       0.002201290747
      target stat err =       0.002877173696
              std dev =       0.532188331599
             le_variance =       0.283224420290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906604061092        initial
     2.3283e+00     2.3283e+01             6.1040e-05        -0.906621453289
     9.3132e+00     9.3132e+01             1.5587e-05        -0.906641856541  <--
     3.7253e+01     3.7253e+02             3.9176e-06        -0.906533928125

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.2856e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -3.961118e-02 3 1  ON 0
ci_002                -2.983984e-02 3 1  ON 1
ci_003                -2.464068e-02 3 1  ON 2
ci_004                 2.204599e-02 3 1  ON 3
ci_005                 2.234610e-02 3 1  ON 4
ci_006                -1.927762e-02 3 1  ON 5
ci_007                -1.924121e-02 3 1  ON 6
ci_008                -8.645082e-03 3 1  ON 7
ci_009                -1.450638e-02 3 1  ON 8
ci_010                -9.766038e-03 3 1  ON 9
ci_011                -1.004424e-02 3 1  ON 10
ci_012                -1.010541e-02 3 1  ON 11
ci_013                -1.981194e-02 3 1  ON 12
ci_014                 1.160727e-02 3 1  ON 13
ci_015                 1.184128e-02 3 1  ON 14
ci_016                 1.621364e-02 3 1  ON 15
ci_017                 1.615705e-02 3 1  ON 16
ci_018                 9.707116e-03 3 1  ON 17
ci_019                 9.845066e-03 3 1  ON 18
ci_020                 1.546494e-02 3 1  ON 19
ci_021                 1.554230e-02 3 1  ON 20
ci_022                 8.866776e-03 3 1  ON 21
ci_023                 8.760427e-03 3 1  ON 22
ci_024                 9.277111e-03 3 1  ON 23
ci_025                 9.213911e-03 3 1  ON 24
ci_026                 1.038099e-02 3 1  ON 25
ci_027                 1.063419e-02 3 1  ON 26
ci_028                -1.486255e-02 3 1  ON 27
ci_029                -1.534252e-02 3 1  ON 28
ci_030                -8.849174e-03 3 1  ON 29
ci_031                -8.996035e-03 3 1  ON 30
ci_032                -1.465224e-02 3 1  ON 31
ci_033                 5.877889e-03 3 1  ON 32
ci_034                 5.550136e-03 3 1  ON 33
ci_035                -3.911951e-03 3 1  ON 34
ci_036                -1.188944e-02 3 1  ON 35
ci_037                -1.205281e-02 3 1  ON 36
ci_038                 1.500792e-03 3 1  ON 37
ci_039                 1.652325e-03 3 1  ON 38
ci_040                -2.181127e-03 3 1  ON 39
ci_041                 8.249171e-03 3 1  ON 40
ci_042                 8.239585e-03 3 1  ON 41
ci_043                -2.889692e-03 3 1  ON 42
ci_044                -4.657604e-03 3 1  ON 43
ci_045                -2.410499e-03 3 1  ON 44
ci_046                 5.181226e-03 3 1  ON 45
ci_047                 5.207342e-03 3 1  ON 46
ci_048                -1.257894e-02 3 1  ON 47
ci_049                -1.271766e-02 3 1  ON 48
ci_050                 3.384002e-03 3 1  ON 49
ci_051                 3.296005e-03 3 1  ON 50
ci_052                -2.680402e-03 3 1  ON 51
ci_053                -2.721767e-03 3 1  ON 52
ci_054                -2.708687e-03 3 1  ON 53
ci_055                -2.968542e-03 3 1  ON 54
ci_056                 4.917632e-03 3 1  ON 55
ci_057                 5.080328e-03 3 1  ON 56
ci_058                -2.340260e-03 3 1  ON 57
ci_059                -2.341549e-03 3 1  ON 58
ci_060                 5.117225e-03 3 1  ON 59
ci_061                 5.674530e-03 3 1  ON 60
ci_062                -3.388561e-03 3 1  ON 61
ci_063                -3.372027e-03 3 1  ON 62
ci_064                -2.592530e-03 3 1  ON 63
ci_065                -3.639619e-03 3 1  ON 64
ci_066                 4.238750e-03 3 1  ON 65
ci_067                 4.361359e-03 3 1  ON 66
ci_068                -4.760341e-03 3 1  ON 67
ci_069                -4.494524e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9267e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.264
    reference variance = 0.184733
====================================================
  Execution time = 1.3923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0295e-01
  Total weights = 1.957456202e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288546945844
                                         uncertainty =       0.001738030489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288546945844
                                         uncertainty =       0.001738030489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379800276
  error estimate for blocks of size 2^( 2) =       0.000390860614
  error estimate for blocks of size 2^( 3) =       0.000401059815
  error estimate for blocks of size 2^( 4) =       0.000409441353
  error estimate for blocks of size 2^( 5) =       0.000414556980
  error estimate for blocks of size 2^( 6) =       0.000415928600
  error estimate for blocks of size 2^( 7) =       0.000418075504

      target function =      -0.897991900824
              le_mean =     -17.216074833913
             les_mean =     296.696184271204
             stat err =       0.000414500609
             autocorr =       1.191076881030
   target nu stat err =       0.000414500609
   target dn stat err =       0.002790731833
      target stat err =       0.003559478312
              std dev =       0.537118700790
             le_variance =       0.288496498739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721607483391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898005373424       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898026027846       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898029708437       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898030755159       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898030738266       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898030740808       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898030762094       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898030760810       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898030759782       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898030760059       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 7.793123e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898005373424       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898010664641       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898011601519       residual = 6.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898011865173       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898011860525       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898011861094       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898011866386       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898011866120       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898011865829       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898011865908       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.984867e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898005373424       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898006704451       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898006939738       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898007005773       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898007004584       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898007004722       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898007006043       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898007005980       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898007005905       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898007005925       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.985577e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.536252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6413e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.959133e-02 3 1  ON 0
ci_002                -2.982632e-02 3 1  ON 1
ci_003                -2.463204e-02 3 1  ON 2
ci_004                 2.203106e-02 3 1  ON 3
ci_005                 2.234168e-02 3 1  ON 4
ci_006                -1.926530e-02 3 1  ON 5
ci_007                -1.923453e-02 3 1  ON 6
ci_008                -8.630985e-03 3 1  ON 7
ci_009                -1.451270e-02 3 1  ON 8
ci_010                -9.752157e-03 3 1  ON 9
ci_011                -1.004671e-02 3 1  ON 10
ci_012                -1.009943e-02 3 1  ON 11
ci_013                -1.981200e-02 3 1  ON 12
ci_014                 1.160377e-02 3 1  ON 13
ci_015                 1.183271e-02 3 1  ON 14
ci_016                 1.621423e-02 3 1  ON 15
ci_017                 1.615368e-02 3 1  ON 16
ci_018                 9.700256e-03 3 1  ON 17
ci_019                 9.826955e-03 3 1  ON 18
ci_020                 1.545585e-02 3 1  ON 19
ci_021                 1.553735e-02 3 1  ON 20
ci_022                 8.864672e-03 3 1  ON 21
ci_023                 8.760978e-03 3 1  ON 22
ci_024                 9.269773e-03 3 1  ON 23
ci_025                 9.215504e-03 3 1  ON 24
ci_026                 1.037895e-02 3 1  ON 25
ci_027                 1.063149e-02 3 1  ON 26
ci_028                -1.486160e-02 3 1  ON 27
ci_029                -1.534432e-02 3 1  ON 28
ci_030                -8.847400e-03 3 1  ON 29
ci_031                -8.985560e-03 3 1  ON 30
ci_032                -1.465372e-02 3 1  ON 31
ci_033                 5.872214e-03 3 1  ON 32
ci_034                 5.548901e-03 3 1  ON 33
ci_035                -3.905822e-03 3 1  ON 34
ci_036                -1.187780e-02 3 1  ON 35
ci_037                -1.204731e-02 3 1  ON 36
ci_038                 1.494988e-03 3 1  ON 37
ci_039                 1.643284e-03 3 1  ON 38
ci_040                -2.179030e-03 3 1  ON 39
ci_041                 8.252109e-03 3 1  ON 40
ci_042                 8.245939e-03 3 1  ON 41
ci_043                -2.887965e-03 3 1  ON 42
ci_044                -4.661322e-03 3 1  ON 43
ci_045                -2.408856e-03 3 1  ON 44
ci_046                 5.180296e-03 3 1  ON 45
ci_047                 5.202029e-03 3 1  ON 46
ci_048                -1.257573e-02 3 1  ON 47
ci_049                -1.271858e-02 3 1  ON 48
ci_050                 3.379864e-03 3 1  ON 49
ci_051                 3.291681e-03 3 1  ON 50
ci_052                -2.675135e-03 3 1  ON 51
ci_053                -2.714363e-03 3 1  ON 52
ci_054                -2.706506e-03 3 1  ON 53
ci_055                -2.965053e-03 3 1  ON 54
ci_056                 4.912217e-03 3 1  ON 55
ci_057                 5.077107e-03 3 1  ON 56
ci_058                -2.340255e-03 3 1  ON 57
ci_059                -2.339131e-03 3 1  ON 58
ci_060                 5.125230e-03 3 1  ON 59
ci_061                 5.676462e-03 3 1  ON 60
ci_062                -3.379911e-03 3 1  ON 61
ci_063                -3.370354e-03 3 1  ON 62
ci_064                -2.589318e-03 3 1  ON 63
ci_065                -3.635156e-03 3 1  ON 64
ci_066                 4.236201e-03 3 1  ON 65
ci_067                 4.361271e-03 3 1  ON 66
ci_068                -4.761330e-03 3 1  ON 67
ci_069                -4.495418e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.229571
====================================================
  Execution time = 1.5862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0234e-01
  Total weights = 1.9574e+06
  Execution time = 1.9844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289511825473
                                         uncertainty =       0.001983097659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289511825473
                                         uncertainty =       0.001983097659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380443563
  error estimate for blocks of size 2^( 2) =       0.000391972292
  error estimate for blocks of size 2^( 3) =       0.000401938485
  error estimate for blocks of size 2^( 4) =       0.000409101166
  error estimate for blocks of size 2^( 5) =       0.000414053213
  error estimate for blocks of size 2^( 6) =       0.000415846971
  error estimate for blocks of size 2^( 7) =       0.000417404931

      target function =      -0.898470005751
              le_mean =     -17.214737967053
             les_mean =     296.649546309675
             stat err =       0.000414101570
             autocorr =       1.184767889350
   target nu stat err =       0.000414101570
   target dn stat err =       0.002966811293
      target stat err =       0.003774279189
              std dev =       0.538028445807
             le_variance =       0.289474608497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289486532102
                                         uncertainty =       0.001985179851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289486532102
                                         uncertainty =       0.001985179851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380426927
  error estimate for blocks of size 2^( 2) =       0.000391962450
  error estimate for blocks of size 2^( 3) =       0.000401936502
  error estimate for blocks of size 2^( 4) =       0.000409106208
  error estimate for blocks of size 2^( 5) =       0.000414059469
  error estimate for blocks of size 2^( 6) =       0.000415852572
  error estimate for blocks of size 2^( 7) =       0.000417411638

      target function =      -0.898458492035
              le_mean =     -17.214737879948
             les_mean =     296.649552360230
             stat err =       0.000414107472
             autocorr =       1.184905282242
   target nu stat err =       0.000414107472
   target dn stat err =       0.002978127097
      target stat err =       0.003788241469
              std dev =       0.538004919072
             le_variance =       0.289449292946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289498698002
                                         uncertainty =       0.001984150434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289498698002
                                         uncertainty =       0.001984150434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380434929
  error estimate for blocks of size 2^( 2) =       0.000391967129
  error estimate for blocks of size 2^( 3) =       0.000401937332
  error estimate for blocks of size 2^( 4) =       0.000409103597
  error estimate for blocks of size 2^( 5) =       0.000414056257
  error estimate for blocks of size 2^( 6) =       0.000415849674
  error estimate for blocks of size 2^( 7) =       0.000417408217

      target function =      -0.898470949502
              le_mean =     -17.214737896861
             les_mean =     296.649543085489
             stat err =       0.000414104436
             autocorr =       1.184838066825
   target nu stat err =       0.000414104436
   target dn stat err =       0.002972138592
      target stat err =       0.003780905124
              std dev =       0.538016235796
             le_variance =       0.289461469980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289510152096
                                         uncertainty =       0.001983228996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289510152096
                                         uncertainty =       0.001983228996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380442462
  error estimate for blocks of size 2^( 2) =       0.000391971628
  error estimate for blocks of size 2^( 3) =       0.000401938324
  error estimate for blocks of size 2^( 4) =       0.000409101455
  error estimate for blocks of size 2^( 5) =       0.000414053579
  error estimate for blocks of size 2^( 6) =       0.000415847294
  error estimate for blocks of size 2^( 7) =       0.000417405326

      target function =      -0.898471576958
              le_mean =     -17.214737954830
             les_mean =     296.649544631563
             stat err =       0.000414101913
             autocorr =       1.184776707155
   target nu stat err =       0.000414101913
   target dn stat err =       0.002967438788
      target stat err =       0.003775071735
              std dev =       0.538026889434
             le_variance =       0.289472933754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898470005751        initial
     2.3283e+00     2.3283e+01             7.7931e-05        -0.898458492035
     9.3132e+00     9.3132e+01             1.9849e-05        -0.898470949502
     3.7253e+01     3.7253e+02             4.9856e-06        -0.898471576958  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.5301e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -3.960619e-02 3 1  ON 0
ci_002                -2.983644e-02 3 1  ON 1
ci_003                -2.463851e-02 3 1  ON 2
ci_004                 2.204224e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923953e-02 3 1  ON 6
ci_008                -8.641536e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762548e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010390e-02 3 1  ON 11
ci_013                -1.981196e-02 3 1  ON 12
ci_014                 1.160639e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621379e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840511e-03 3 1  ON 18
ci_020                 1.546266e-02 3 1  ON 19
ci_021                 1.554106e-02 3 1  ON 20
ci_022                 8.866246e-03 3 1  ON 21
ci_023                 8.760565e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214311e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534297e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993400e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876463e-03 3 1  ON 32
ci_034                 5.549825e-03 3 1  ON 33
ci_035                -3.910409e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205143e-02 3 1  ON 36
ci_038                 1.499332e-03 3 1  ON 37
ci_039                 1.650051e-03 3 1  ON 38
ci_040                -2.180599e-03 3 1  ON 39
ci_041                 8.249909e-03 3 1  ON 40
ci_042                 8.241182e-03 3 1  ON 41
ci_043                -2.889258e-03 3 1  ON 42
ci_044                -4.658538e-03 3 1  ON 43
ci_045                -2.410085e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206007e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382961e-03 3 1  ON 49
ci_051                 3.294917e-03 3 1  ON 50
ci_052                -2.679077e-03 3 1  ON 51
ci_053                -2.719905e-03 3 1  ON 52
ci_054                -2.708140e-03 3 1  ON 53
ci_055                -2.967665e-03 3 1  ON 54
ci_056                 4.916270e-03 3 1  ON 55
ci_057                 5.079518e-03 3 1  ON 56
ci_058                -2.340258e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119237e-03 3 1  ON 59
ci_061                 5.675016e-03 3 1  ON 60
ci_062                -3.386387e-03 3 1  ON 61
ci_063                -3.371606e-03 3 1  ON 62
ci_064                -2.591722e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238109e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760589e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2546
    reference variance = 0.229824
====================================================
  Execution time = 1.3950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1103e-01
  Total weights = 1.957480353e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289175608639
                                         uncertainty =       0.001732723003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289175608639
                                         uncertainty =       0.001732723003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380302713
  error estimate for blocks of size 2^( 2) =       0.000391237448
  error estimate for blocks of size 2^( 3) =       0.000401200159
  error estimate for blocks of size 2^( 4) =       0.000409603155
  error estimate for blocks of size 2^( 5) =       0.000414105647
  error estimate for blocks of size 2^( 6) =       0.000416565926
  error estimate for blocks of size 2^( 7) =       0.000419423974

      target function =      -0.887730026778
              le_mean =     -17.215554598252
             les_mean =     296.686348601543
             stat err =       0.000414924675
             autocorr =       1.190363710040
   target nu stat err =       0.000414924675
   target dn stat err =       0.008602442020
      target stat err =       0.010587387580
              std dev =       0.537829254733
             le_variance =       0.289260307247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721555459825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887855501634       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887894057142       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887897499333       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887898109017       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887898267250       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887898321055       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887898325359       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887898327934       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887898327908       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887898328594       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887898328354       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 4.963124e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887855501634       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887865201745       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887866066369       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887866219196       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887866258806       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887866272253       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887866273325       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887866273967       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887866273960       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887866274132       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887866274072       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 1.247894e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.887855501634       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887857930519       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887858146931       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887858185163       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887858195069       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887858198430       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887858198698       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887858198858       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887858198857       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887858198900       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887858198885       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 3.124213e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.540232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6450e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.960204e-02 3 1  ON 0
ci_002                -2.983534e-02 3 1  ON 1
ci_003                -2.463695e-02 3 1  ON 2
ci_004                 2.204137e-02 3 1  ON 3
ci_005                 2.234143e-02 3 1  ON 4
ci_006                -1.927210e-02 3 1  ON 5
ci_007                -1.923786e-02 3 1  ON 6
ci_008                -8.638743e-03 3 1  ON 7
ci_009                -1.450266e-02 3 1  ON 8
ci_010                -9.756002e-03 3 1  ON 9
ci_011                -1.004222e-02 3 1  ON 10
ci_012                -1.009990e-02 3 1  ON 11
ci_013                -1.980574e-02 3 1  ON 12
ci_014                 1.160696e-02 3 1  ON 13
ci_015                 1.183742e-02 3 1  ON 14
ci_016                 1.621582e-02 3 1  ON 15
ci_017                 1.615419e-02 3 1  ON 16
ci_018                 9.704010e-03 3 1  ON 17
ci_019                 9.838955e-03 3 1  ON 18
ci_020                 1.546276e-02 3 1  ON 19
ci_021                 1.554071e-02 3 1  ON 20
ci_022                 8.869585e-03 3 1  ON 21
ci_023                 8.760725e-03 3 1  ON 22
ci_024                 9.271447e-03 3 1  ON 23
ci_025                 9.211245e-03 3 1  ON 24
ci_026                 1.038046e-02 3 1  ON 25
ci_027                 1.063130e-02 3 1  ON 26
ci_028                -1.486263e-02 3 1  ON 27
ci_029                -1.533999e-02 3 1  ON 28
ci_030                -8.847414e-03 3 1  ON 29
ci_031                -9.002116e-03 3 1  ON 30
ci_032                -1.465241e-02 3 1  ON 31
ci_033                 5.875502e-03 3 1  ON 32
ci_034                 5.540773e-03 3 1  ON 33
ci_035                -3.908563e-03 3 1  ON 34
ci_036                -1.188615e-02 3 1  ON 35
ci_037                -1.204918e-02 3 1  ON 36
ci_038                 1.497178e-03 3 1  ON 37
ci_039                 1.648392e-03 3 1  ON 38
ci_040                -2.177788e-03 3 1  ON 39
ci_041                 8.248996e-03 3 1  ON 40
ci_042                 8.242128e-03 3 1  ON 41
ci_043                -2.888423e-03 3 1  ON 42
ci_044                -4.659698e-03 3 1  ON 43
ci_045                -2.408996e-03 3 1  ON 44
ci_046                 5.180006e-03 3 1  ON 45
ci_047                 5.204400e-03 3 1  ON 46
ci_048                -1.257925e-02 3 1  ON 47
ci_049                -1.270541e-02 3 1  ON 48
ci_050                 3.384388e-03 3 1  ON 49
ci_051                 3.296377e-03 3 1  ON 50
ci_052                -2.677366e-03 3 1  ON 51
ci_053                -2.723290e-03 3 1  ON 52
ci_054                -2.702397e-03 3 1  ON 53
ci_055                -2.967359e-03 3 1  ON 54
ci_056                 4.914440e-03 3 1  ON 55
ci_057                 5.078446e-03 3 1  ON 56
ci_058                -2.338279e-03 3 1  ON 57
ci_059                -2.342027e-03 3 1  ON 58
ci_060                 5.118887e-03 3 1  ON 59
ci_061                 5.672016e-03 3 1  ON 60
ci_062                -3.387281e-03 3 1  ON 61
ci_063                -3.371449e-03 3 1  ON 62
ci_064                -2.590581e-03 3 1  ON 63
ci_065                -3.637994e-03 3 1  ON 64
ci_066                 4.238092e-03 3 1  ON 65
ci_067                 4.358822e-03 3 1  ON 66
ci_068                -4.760576e-03 3 1  ON 67
ci_069                -4.482563e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.420294
====================================================
  Execution time = 1.3421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0186e-01
  Total weights = 1.9577e+06
  Execution time = 1.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287754108994
                                         uncertainty =       0.002134585727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287754108994
                                         uncertainty =       0.002134585727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379342361
  error estimate for blocks of size 2^( 2) =       0.000391014749
  error estimate for blocks of size 2^( 3) =       0.000401284437
  error estimate for blocks of size 2^( 4) =       0.000409475264
  error estimate for blocks of size 2^( 5) =       0.000414306250
  error estimate for blocks of size 2^( 6) =       0.000417418087
  error estimate for blocks of size 2^( 7) =       0.000416855008

      target function =      -0.898979066343
              le_mean =     -17.214242993975
             les_mean =     296.632016639168
             stat err =       0.000414513652
             autocorr =       1.194029324434
   target nu stat err =       0.000414513652
   target dn stat err =       0.002756169263
      target stat err =       0.003514162430
              std dev =       0.536471111130
             le_variance =       0.287801253077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744820634
                                         uncertainty =       0.002135034592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287744820634
                                         uncertainty =       0.002135034592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379336300
  error estimate for blocks of size 2^( 2) =       0.000391011260
  error estimate for blocks of size 2^( 3) =       0.000401283420
  error estimate for blocks of size 2^( 4) =       0.000409476697
  error estimate for blocks of size 2^( 5) =       0.000414308419
  error estimate for blocks of size 2^( 6) =       0.000417419849
  error estimate for blocks of size 2^( 7) =       0.000416859441

      target function =      -0.898926678548
              le_mean =     -17.214242886884
             les_mean =     296.632054571867
             stat err =       0.000414516101
             autocorr =       1.194081591058
   target nu stat err =       0.000414516101
   target dn stat err =       0.002759348504
      target stat err =       0.003517701357
              std dev =       0.536462539624
             le_variance =       0.287792056420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287749378350
                                         uncertainty =       0.002134810767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287749378350
                                         uncertainty =       0.002134810767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379339273
  error estimate for blocks of size 2^( 2) =       0.000391012955
  error estimate for blocks of size 2^( 3) =       0.000401283885
  error estimate for blocks of size 2^( 4) =       0.000409475943
  error estimate for blocks of size 2^( 5) =       0.000414307301
  error estimate for blocks of size 2^( 6) =       0.000417418933
  error estimate for blocks of size 2^( 7) =       0.000416857196

      target function =      -0.898956283359
              le_mean =     -17.214242932113
             les_mean =     296.632032604906
             stat err =       0.000414514843
             autocorr =       1.194055621379
   target nu stat err =       0.000414514843
   target dn stat err =       0.002757709145
      target stat err =       0.003515896568
              std dev =       0.536466745035
             le_variance =       0.287796568529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287753510176
                                         uncertainty =       0.002134613799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287753510176
                                         uncertainty =       0.002134613799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379341970
  error estimate for blocks of size 2^( 2) =       0.000391014520
  error estimate for blocks of size 2^( 3) =       0.000401284363
  error estimate for blocks of size 2^( 4) =       0.000409475344
  error estimate for blocks of size 2^( 5) =       0.000414306377
  error estimate for blocks of size 2^( 6) =       0.000417418189
  error estimate for blocks of size 2^( 7) =       0.000416855277

      target function =      -0.898976595481
              le_mean =     -17.214242985373
             les_mean =     296.632018304961
             stat err =       0.000414513797
             autocorr =       1.194032618259
   target nu stat err =       0.000414513797
   target dn stat err =       0.002756356126
      target stat err =       0.003514375135
              std dev =       0.536470558399
             le_variance =       0.287800660028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898979066343        initial  <--
     9.3132e+00     9.3132e+01             4.9631e-05        -0.898926678548
     3.7253e+01     3.7253e+02             1.2479e-05        -0.898956283359
     1.4901e+02     1.4901e+03             3.1242e-06        -0.898976595481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6942
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -3.960619e-02 3 1  ON 0
ci_002                -2.983644e-02 3 1  ON 1
ci_003                -2.463851e-02 3 1  ON 2
ci_004                 2.204224e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923953e-02 3 1  ON 6
ci_008                -8.641536e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762548e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010390e-02 3 1  ON 11
ci_013                -1.981196e-02 3 1  ON 12
ci_014                 1.160639e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621379e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840511e-03 3 1  ON 18
ci_020                 1.546266e-02 3 1  ON 19
ci_021                 1.554106e-02 3 1  ON 20
ci_022                 8.866246e-03 3 1  ON 21
ci_023                 8.760565e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214311e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534297e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993400e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876463e-03 3 1  ON 32
ci_034                 5.549825e-03 3 1  ON 33
ci_035                -3.910409e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205143e-02 3 1  ON 36
ci_038                 1.499332e-03 3 1  ON 37
ci_039                 1.650051e-03 3 1  ON 38
ci_040                -2.180599e-03 3 1  ON 39
ci_041                 8.249909e-03 3 1  ON 40
ci_042                 8.241182e-03 3 1  ON 41
ci_043                -2.889258e-03 3 1  ON 42
ci_044                -4.658538e-03 3 1  ON 43
ci_045                -2.410085e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206007e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382961e-03 3 1  ON 49
ci_051                 3.294917e-03 3 1  ON 50
ci_052                -2.679077e-03 3 1  ON 51
ci_053                -2.719905e-03 3 1  ON 52
ci_054                -2.708140e-03 3 1  ON 53
ci_055                -2.967665e-03 3 1  ON 54
ci_056                 4.916270e-03 3 1  ON 55
ci_057                 5.079518e-03 3 1  ON 56
ci_058                -2.340258e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119237e-03 3 1  ON 59
ci_061                 5.675016e-03 3 1  ON 60
ci_062                -3.386387e-03 3 1  ON 61
ci_063                -3.371606e-03 3 1  ON 62
ci_064                -2.591722e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238109e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760589e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1487
    reference variance = 0.204432
====================================================
  Execution time = 1.3892e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9953e-01
  Total weights = 1.957468041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287313449104
                                         uncertainty =       0.001647784949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287313449104
                                         uncertainty =       0.001647784949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378982135
  error estimate for blocks of size 2^( 2) =       0.000390113876
  error estimate for blocks of size 2^( 3) =       0.000400127692
  error estimate for blocks of size 2^( 4) =       0.000408197419
  error estimate for blocks of size 2^( 5) =       0.000412854749
  error estimate for blocks of size 2^( 6) =       0.000415455518
  error estimate for blocks of size 2^( 7) =       0.000415292385

      target function =      -0.902241640856
              le_mean =     -17.215720499950
             les_mean =     296.680565426741
             stat err =       0.000412950018
             autocorr =       1.187291893494
   target nu stat err =       0.000412950018
   target dn stat err =       0.002155231154
      target stat err =       0.002797294469
              std dev =       0.535961675004
             le_variance =       0.287254917073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572049995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902249683718       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902250229505       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902250327361       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902250355574       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902250360247       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902250360329       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902250360568       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902250360591       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902250360664       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902250360681       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.659692e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902249683718       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902249820251       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902249844726       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902249851781       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902249852949       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902249852970       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902249853030       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902249853035       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902249853054       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902249853058       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 4.151380e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902249683718       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902249717857       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902249723976       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902249725740       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902249726033       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902249726037       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902249726052       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902249726053       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902249726060       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902249726059       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+03 is 1.037980e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.543633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6396e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.960594e-02 3 1  ON 0
ci_002                -2.983624e-02 3 1  ON 1
ci_003                -2.463815e-02 3 1  ON 2
ci_004                 2.204221e-02 3 1  ON 3
ci_005                 2.234468e-02 3 1  ON 4
ci_006                -1.927434e-02 3 1  ON 5
ci_007                -1.923940e-02 3 1  ON 6
ci_008                -8.641330e-03 3 1  ON 7
ci_009                -1.450776e-02 3 1  ON 8
ci_010                -9.762411e-03 3 1  ON 9
ci_011                -1.004495e-02 3 1  ON 10
ci_012                -1.010379e-02 3 1  ON 11
ci_013                -1.981170e-02 3 1  ON 12
ci_014                 1.160627e-02 3 1  ON 13
ci_015                 1.183896e-02 3 1  ON 14
ci_016                 1.621368e-02 3 1  ON 15
ci_017                 1.615614e-02 3 1  ON 16
ci_018                 9.705325e-03 3 1  ON 17
ci_019                 9.840528e-03 3 1  ON 18
ci_020                 1.546224e-02 3 1  ON 19
ci_021                 1.554077e-02 3 1  ON 20
ci_022                 8.866099e-03 3 1  ON 21
ci_023                 8.760512e-03 3 1  ON 22
ci_024                 9.275151e-03 3 1  ON 23
ci_025                 9.214161e-03 3 1  ON 24
ci_026                 1.038021e-02 3 1  ON 25
ci_027                 1.063321e-02 3 1  ON 26
ci_028                -1.486234e-02 3 1  ON 27
ci_029                -1.534280e-02 3 1  ON 28
ci_030                -8.848650e-03 3 1  ON 29
ci_031                -8.993198e-03 3 1  ON 30
ci_032                -1.465252e-02 3 1  ON 31
ci_033                 5.876233e-03 3 1  ON 32
ci_034                 5.549907e-03 3 1  ON 33
ci_035                -3.910339e-03 3 1  ON 34
ci_036                -1.188637e-02 3 1  ON 35
ci_037                -1.205160e-02 3 1  ON 36
ci_038                 1.499234e-03 3 1  ON 37
ci_039                 1.649924e-03 3 1  ON 38
ci_040                -2.180495e-03 3 1  ON 39
ci_041                 8.249975e-03 3 1  ON 40
ci_042                 8.241198e-03 3 1  ON 41
ci_043                -2.889151e-03 3 1  ON 42
ci_044                -4.658506e-03 3 1  ON 43
ci_045                -2.409864e-03 3 1  ON 44
ci_046                 5.180928e-03 3 1  ON 45
ci_047                 5.205902e-03 3 1  ON 46
ci_048                -1.257793e-02 3 1  ON 47
ci_049                -1.271793e-02 3 1  ON 48
ci_050                 3.382975e-03 3 1  ON 49
ci_051                 3.294788e-03 3 1  ON 50
ci_052                -2.679086e-03 3 1  ON 51
ci_053                -2.719543e-03 3 1  ON 52
ci_054                -2.708091e-03 3 1  ON 53
ci_055                -2.967513e-03 3 1  ON 54
ci_056                 4.916251e-03 3 1  ON 55
ci_057                 5.079395e-03 3 1  ON 56
ci_058                -2.340238e-03 3 1  ON 57
ci_059                -2.340853e-03 3 1  ON 58
ci_060                 5.119222e-03 3 1  ON 59
ci_061                 5.674712e-03 3 1  ON 60
ci_062                -3.386159e-03 3 1  ON 61
ci_063                -3.371494e-03 3 1  ON 62
ci_064                -2.591633e-03 3 1  ON 63
ci_065                -3.638477e-03 3 1  ON 64
ci_066                 4.238083e-03 3 1  ON 65
ci_067                 4.361277e-03 3 1  ON 66
ci_068                -4.760551e-03 3 1  ON 67
ci_069                -4.494565e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1411
    reference variance = 0.224226
====================================================
  Execution time = 1.3721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0150e-01
  Total weights = 1.9577e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012660765
                                         uncertainty =       0.001844205201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012660765
                                         uncertainty =       0.001844205201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380129130
  error estimate for blocks of size 2^( 2) =       0.000390996042
  error estimate for blocks of size 2^( 3) =       0.000400830063
  error estimate for blocks of size 2^( 4) =       0.000407522366
  error estimate for blocks of size 2^( 5) =       0.000412104902
  error estimate for blocks of size 2^( 6) =       0.000414636620
  error estimate for blocks of size 2^( 7) =       0.000414162169

      target function =      -0.899453587122
              le_mean =     -17.214390063623
             les_mean =     296.636728071835
             stat err =       0.000412106514
             autocorr =       1.175321430993
   target nu stat err =       0.000412106514
   target dn stat err =       0.002799533024
      target stat err =       0.003571949334
              std dev =       0.537583771220
             le_variance =       0.288996311079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289011729198
                                         uncertainty =       0.001844165996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289011729198
                                         uncertainty =       0.001844165996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380128517
  error estimate for blocks of size 2^( 2) =       0.000390995620
  error estimate for blocks of size 2^( 3) =       0.000400829856
  error estimate for blocks of size 2^( 4) =       0.000407522291
  error estimate for blocks of size 2^( 5) =       0.000412104942
  error estimate for blocks of size 2^( 6) =       0.000414636676
  error estimate for blocks of size 2^( 7) =       0.000414162346

      target function =      -0.899447768752
              le_mean =     -17.214390061512
             les_mean =     296.636732619112
             stat err =       0.000412106564
             autocorr =       1.175325506995
   target nu stat err =       0.000412106564
   target dn stat err =       0.002799620736
      target stat err =       0.003572012718
              std dev =       0.537582904052
             le_variance =       0.288995378729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012194569
                                         uncertainty =       0.001844185578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012194569
                                         uncertainty =       0.001844185578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380128823
  error estimate for blocks of size 2^( 2) =       0.000390995831
  error estimate for blocks of size 2^( 3) =       0.000400829959
  error estimate for blocks of size 2^( 4) =       0.000407522328
  error estimate for blocks of size 2^( 5) =       0.000412104922
  error estimate for blocks of size 2^( 6) =       0.000414636648
  error estimate for blocks of size 2^( 7) =       0.000414162258

      target function =      -0.899452412117
              le_mean =     -17.214390062526
             les_mean =     296.636728966773
             stat err =       0.000412106539
             autocorr =       1.175323470506
   target nu stat err =       0.000412106539
   target dn stat err =       0.002799573868
      target stat err =       0.003571990878
              std dev =       0.537583337252
             le_variance =       0.288995844491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012602467
                                         uncertainty =       0.001844202747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289012602467
                                         uncertainty =       0.001844202747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380129092
  error estimate for blocks of size 2^( 2) =       0.000390996015
  error estimate for blocks of size 2^( 3) =       0.000400830050
  error estimate for blocks of size 2^( 4) =       0.000407522361
  error estimate for blocks of size 2^( 5) =       0.000412104904
  error estimate for blocks of size 2^( 6) =       0.000414636623
  error estimate for blocks of size 2^( 7) =       0.000414162180

      target function =      -0.899453508187
              le_mean =     -17.214390063483
             les_mean =     296.636728129632
             stat err =       0.000412106517
             autocorr =       1.175321685984
   target nu stat err =       0.000412106517
   target dn stat err =       0.002799538025
      target stat err =       0.003571954929
              std dev =       0.537583716952
             le_variance =       0.288996252732


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899453587122        initial  <--
     9.3132e+01     9.3132e+02             1.6597e-06        -0.899447768752
     3.7253e+02     3.7253e+03             4.1514e-07        -0.899452412117
     1.4901e+03     1.4901e+04             1.0380e-07        -0.899453508187

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0068
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -3.960619e-02 3 1  ON 0
ci_002                -2.983644e-02 3 1  ON 1
ci_003                -2.463851e-02 3 1  ON 2
ci_004                 2.204224e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923953e-02 3 1  ON 6
ci_008                -8.641536e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762548e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010390e-02 3 1  ON 11
ci_013                -1.981196e-02 3 1  ON 12
ci_014                 1.160639e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621379e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840511e-03 3 1  ON 18
ci_020                 1.546266e-02 3 1  ON 19
ci_021                 1.554106e-02 3 1  ON 20
ci_022                 8.866246e-03 3 1  ON 21
ci_023                 8.760565e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214311e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534297e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993400e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876463e-03 3 1  ON 32
ci_034                 5.549825e-03 3 1  ON 33
ci_035                -3.910409e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205143e-02 3 1  ON 36
ci_038                 1.499332e-03 3 1  ON 37
ci_039                 1.650051e-03 3 1  ON 38
ci_040                -2.180599e-03 3 1  ON 39
ci_041                 8.249909e-03 3 1  ON 40
ci_042                 8.241182e-03 3 1  ON 41
ci_043                -2.889258e-03 3 1  ON 42
ci_044                -4.658538e-03 3 1  ON 43
ci_045                -2.410085e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206007e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382961e-03 3 1  ON 49
ci_051                 3.294917e-03 3 1  ON 50
ci_052                -2.679077e-03 3 1  ON 51
ci_053                -2.719905e-03 3 1  ON 52
ci_054                -2.708140e-03 3 1  ON 53
ci_055                -2.967665e-03 3 1  ON 54
ci_056                 4.916270e-03 3 1  ON 55
ci_057                 5.079518e-03 3 1  ON 56
ci_058                -2.340258e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119237e-03 3 1  ON 59
ci_061                 5.675016e-03 3 1  ON 60
ci_062                -3.386387e-03 3 1  ON 61
ci_063                -3.371606e-03 3 1  ON 62
ci_064                -2.591722e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238109e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760589e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.653545
====================================================
  Execution time = 1.3789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9701e-01
  Total weights = 1.957443587e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284309109497
                                         uncertainty =       0.001557969730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284309109497
                                         uncertainty =       0.001557969730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376987939
  error estimate for blocks of size 2^( 2) =       0.000387828859
  error estimate for blocks of size 2^( 3) =       0.000398094527
  error estimate for blocks of size 2^( 4) =       0.000405858807
  error estimate for blocks of size 2^( 5) =       0.000410538980
  error estimate for blocks of size 2^( 6) =       0.000411459998
  error estimate for blocks of size 2^( 7) =       0.000413021300

      target function =      -0.905531070076
              le_mean =     -17.216040741233
             les_mean =     296.689066776830
             stat err =       0.000410219771
             autocorr =       1.184072415087
   target nu stat err =       0.000410219771
   target dn stat err =       0.002244796910
      target stat err =       0.002930146055
              std dev =       0.533141456313
             le_variance =       0.284239812439


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604074123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905539817202       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905539877777       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905539886897       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905539889287       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905539889459       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905539889605       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905539889605       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905539889613       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905539889617       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905539889617       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.772295e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905539817202       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905539832347       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905539834627       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905539835225       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905539835271       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905539835304       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905539835304       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905539835309       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905539835303       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905539835307       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 4.430957e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905539817202       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905539820988       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905539821559       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905539821708       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905539821716       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905539821734       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905539821722       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905539821727       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905539821687       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905539821694       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+04 is 1.107753e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.547089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6286e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.960616e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463849e-02 3 1  ON 2
ci_004                 2.204223e-02 3 1  ON 3
ci_005                 2.234496e-02 3 1  ON 4
ci_006                -1.927450e-02 3 1  ON 5
ci_007                -1.923951e-02 3 1  ON 6
ci_008                -8.641528e-03 3 1  ON 7
ci_009                -1.450795e-02 3 1  ON 8
ci_010                -9.762538e-03 3 1  ON 9
ci_011                -1.004484e-02 3 1  ON 10
ci_012                -1.010389e-02 3 1  ON 11
ci_013                -1.981194e-02 3 1  ON 12
ci_014                 1.160637e-02 3 1  ON 13
ci_015                 1.183911e-02 3 1  ON 14
ci_016                 1.621378e-02 3 1  ON 15
ci_017                 1.615619e-02 3 1  ON 16
ci_018                 9.705405e-03 3 1  ON 17
ci_019                 9.840507e-03 3 1  ON 18
ci_020                 1.546264e-02 3 1  ON 19
ci_021                 1.554104e-02 3 1  ON 20
ci_022                 8.866214e-03 3 1  ON 21
ci_023                 8.760556e-03 3 1  ON 22
ci_024                 9.275224e-03 3 1  ON 23
ci_025                 9.214270e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063349e-02 3 1  ON 26
ci_028                -1.486229e-02 3 1  ON 27
ci_029                -1.534294e-02 3 1  ON 28
ci_030                -8.848717e-03 3 1  ON 29
ci_031                -8.993382e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876430e-03 3 1  ON 32
ci_034                 5.549811e-03 3 1  ON 33
ci_035                -3.910389e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205141e-02 3 1  ON 36
ci_038                 1.499313e-03 3 1  ON 37
ci_039                 1.650028e-03 3 1  ON 38
ci_040                -2.180591e-03 3 1  ON 39
ci_041                 8.249909e-03 3 1  ON 40
ci_042                 8.241200e-03 3 1  ON 41
ci_043                -2.889240e-03 3 1  ON 42
ci_044                -4.658542e-03 3 1  ON 43
ci_045                -2.410076e-03 3 1  ON 44
ci_046                 5.180969e-03 3 1  ON 45
ci_047                 5.205994e-03 3 1  ON 46
ci_048                -1.257814e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382971e-03 3 1  ON 49
ci_051                 3.294901e-03 3 1  ON 50
ci_052                -2.679078e-03 3 1  ON 51
ci_053                -2.719886e-03 3 1  ON 52
ci_054                -2.708133e-03 3 1  ON 53
ci_055                -2.967659e-03 3 1  ON 54
ci_056                 4.916250e-03 3 1  ON 55
ci_057                 5.079512e-03 3 1  ON 56
ci_058                -2.340241e-03 3 1  ON 57
ci_059                -2.340937e-03 3 1  ON 58
ci_060                 5.119265e-03 3 1  ON 59
ci_061                 5.675010e-03 3 1  ON 60
ci_062                -3.386381e-03 3 1  ON 61
ci_063                -3.371612e-03 3 1  ON 62
ci_064                -2.591717e-03 3 1  ON 63
ci_065                -3.638494e-03 3 1  ON 64
ci_066                 4.238108e-03 3 1  ON 65
ci_067                 4.361328e-03 3 1  ON 66
ci_068                -4.760564e-03 3 1  ON 67
ci_069                -4.494749e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2736
    reference variance = 0.196923
====================================================
  Execution time = 1.3812e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9891e-01
  Total weights = 1.9578e+06
  Execution time = 1.8307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729198888
                                         uncertainty =       0.002091624963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729198888
                                         uncertainty =       0.002091624963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378693643
  error estimate for blocks of size 2^( 2) =       0.000389945931
  error estimate for blocks of size 2^( 3) =       0.000400150886
  error estimate for blocks of size 2^( 4) =       0.000407071393
  error estimate for blocks of size 2^( 5) =       0.000411710877
  error estimate for blocks of size 2^( 6) =       0.000413732570
  error estimate for blocks of size 2^( 7) =       0.000415863818

      target function =      -0.902759799826
              le_mean =     -17.214487971554
             les_mean =     296.637499347402
             stat err =       0.000412094665
             autocorr =       1.184180633164
   target nu stat err =       0.000412094665
   target dn stat err =       0.002900501368
      target stat err =       0.003724942303
              std dev =       0.535553685813
             le_variance =       0.286817750388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729092124
                                         uncertainty =       0.002091614366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729092124
                                         uncertainty =       0.002091614366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378693572
  error estimate for blocks of size 2^( 2) =       0.000389945880
  error estimate for blocks of size 2^( 3) =       0.000400150857
  error estimate for blocks of size 2^( 4) =       0.000407071378
  error estimate for blocks of size 2^( 5) =       0.000411710872
  error estimate for blocks of size 2^( 6) =       0.000413732569
  error estimate for blocks of size 2^( 7) =       0.000415863824

      target function =      -0.902744322803
              le_mean =     -17.214487973260
             les_mean =     296.637511602709
             stat err =       0.000412094661
             autocorr =       1.184181053260
   target nu stat err =       0.000412094661
   target dn stat err =       0.002901008093
      target stat err =       0.003725451162
              std dev =       0.535553585807
             le_variance =       0.286817643271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729145502
                                         uncertainty =       0.002091619664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729145502
                                         uncertainty =       0.002091619664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378693608
  error estimate for blocks of size 2^( 2) =       0.000389945905
  error estimate for blocks of size 2^( 3) =       0.000400150872
  error estimate for blocks of size 2^( 4) =       0.000407071386
  error estimate for blocks of size 2^( 5) =       0.000411710875
  error estimate for blocks of size 2^( 6) =       0.000413732570
  error estimate for blocks of size 2^( 7) =       0.000415863821

      target function =      -0.902752363489
              le_mean =     -17.214487972407
             les_mean =     296.637505236921
             stat err =       0.000412094663
             autocorr =       1.184180843216
   target nu stat err =       0.000412094663
   target dn stat err =       0.002900738112
      target stat err =       0.003725178374
              std dev =       0.535553635806
             le_variance =       0.286817696825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729192215
                                         uncertainty =       0.002091624300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286729192215
                                         uncertainty =       0.002091624300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378693639
  error estimate for blocks of size 2^( 2) =       0.000389945928
  error estimate for blocks of size 2^( 3) =       0.000400150884
  error estimate for blocks of size 2^( 4) =       0.000407071392
  error estimate for blocks of size 2^( 5) =       0.000411710877
  error estimate for blocks of size 2^( 6) =       0.000413732570
  error estimate for blocks of size 2^( 7) =       0.000415863819

      target function =      -0.902758901327
              le_mean =     -17.214487971661
             les_mean =     296.637500059128
             stat err =       0.000412094664
             autocorr =       1.184180659419
   target nu stat err =       0.000412094664
   target dn stat err =       0.002900529309
      target stat err =       0.003724969995
              std dev =       0.535553679562
             le_variance =       0.286817743692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902759799826        initial  <--
     9.3132e+02     9.3132e+03             1.7723e-07        -0.902744322803
     3.7253e+03     3.7253e+04             4.4310e-08        -0.902752363489
     1.4901e+04     1.4901e+05             1.1078e-08        -0.902758901327

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0827
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -3.960619e-02 3 1  ON 0
ci_002                -2.983644e-02 3 1  ON 1
ci_003                -2.463851e-02 3 1  ON 2
ci_004                 2.204224e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923953e-02 3 1  ON 6
ci_008                -8.641536e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762548e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010390e-02 3 1  ON 11
ci_013                -1.981196e-02 3 1  ON 12
ci_014                 1.160639e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621379e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840511e-03 3 1  ON 18
ci_020                 1.546266e-02 3 1  ON 19
ci_021                 1.554106e-02 3 1  ON 20
ci_022                 8.866246e-03 3 1  ON 21
ci_023                 8.760565e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214311e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534297e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993400e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876463e-03 3 1  ON 32
ci_034                 5.549825e-03 3 1  ON 33
ci_035                -3.910409e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205143e-02 3 1  ON 36
ci_038                 1.499332e-03 3 1  ON 37
ci_039                 1.650051e-03 3 1  ON 38
ci_040                -2.180599e-03 3 1  ON 39
ci_041                 8.249909e-03 3 1  ON 40
ci_042                 8.241182e-03 3 1  ON 41
ci_043                -2.889258e-03 3 1  ON 42
ci_044                -4.658538e-03 3 1  ON 43
ci_045                -2.410085e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206007e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382961e-03 3 1  ON 49
ci_051                 3.294917e-03 3 1  ON 50
ci_052                -2.679077e-03 3 1  ON 51
ci_053                -2.719905e-03 3 1  ON 52
ci_054                -2.708140e-03 3 1  ON 53
ci_055                -2.967665e-03 3 1  ON 54
ci_056                 4.916270e-03 3 1  ON 55
ci_057                 5.079518e-03 3 1  ON 56
ci_058                -2.340258e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119237e-03 3 1  ON 59
ci_061                 5.675016e-03 3 1  ON 60
ci_062                -3.386387e-03 3 1  ON 61
ci_063                -3.371606e-03 3 1  ON 62
ci_064                -2.591722e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238109e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760589e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2572
    reference variance = 0.216783
====================================================
  Execution time = 1.3883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0356e-01
  Total weights = 1.957402840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287305970176
                                         uncertainty =       0.002113632490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287305970176
                                         uncertainty =       0.002113632490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378990604
  error estimate for blocks of size 2^( 2) =       0.000390084948
  error estimate for blocks of size 2^( 3) =       0.000400135095
  error estimate for blocks of size 2^( 4) =       0.000408208385
  error estimate for blocks of size 2^( 5) =       0.000413263426
  error estimate for blocks of size 2^( 6) =       0.000415974175
  error estimate for blocks of size 2^( 7) =       0.000416861694

      target function =      -0.896840360695
              le_mean =     -17.214292443640
             les_mean =     296.635421720691
             stat err =       0.000413576920
             autocorr =       1.190846278957
   target nu stat err =       0.000413576920
   target dn stat err =       0.003915665423
      target stat err =       0.004935028087
              std dev =       0.535973651948
             le_variance =       0.287267755582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721429244364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896866658824       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896866663120       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896866664069       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896866664300       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896866664306       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896866664331       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896866664308       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896866664332       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896866664311       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896866664308       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 1.355677e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896866658824       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896866659898       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896866660136       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896866660193       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896866660195       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896866660195       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896866660202       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896866660197       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896866660235       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896866660215       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 3.389210e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896866658824       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896866659093       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896866659152       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896866659192       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896866659217       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896866659344       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896866659328       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896866659049       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896866659416       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896866659221       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+05 is 8.473036e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.550487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6390e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.960619e-02 3 1  ON 0
ci_002                -2.983644e-02 3 1  ON 1
ci_003                -2.463851e-02 3 1  ON 2
ci_004                 2.204224e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923953e-02 3 1  ON 6
ci_008                -8.641532e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762550e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010390e-02 3 1  ON 11
ci_013                -1.981196e-02 3 1  ON 12
ci_014                 1.160639e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621378e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840511e-03 3 1  ON 18
ci_020                 1.546265e-02 3 1  ON 19
ci_021                 1.554106e-02 3 1  ON 20
ci_022                 8.866245e-03 3 1  ON 21
ci_023                 8.760563e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214310e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534297e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993400e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876459e-03 3 1  ON 32
ci_034                 5.549826e-03 3 1  ON 33
ci_035                -3.910409e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205143e-02 3 1  ON 36
ci_038                 1.499333e-03 3 1  ON 37
ci_039                 1.650049e-03 3 1  ON 38
ci_040                -2.180598e-03 3 1  ON 39
ci_041                 8.249908e-03 3 1  ON 40
ci_042                 8.241180e-03 3 1  ON 41
ci_043                -2.889256e-03 3 1  ON 42
ci_044                -4.658537e-03 3 1  ON 43
ci_045                -2.410084e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206006e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382961e-03 3 1  ON 49
ci_051                 3.294916e-03 3 1  ON 50
ci_052                -2.679077e-03 3 1  ON 51
ci_053                -2.719904e-03 3 1  ON 52
ci_054                -2.708137e-03 3 1  ON 53
ci_055                -2.967663e-03 3 1  ON 54
ci_056                 4.916271e-03 3 1  ON 55
ci_057                 5.079520e-03 3 1  ON 56
ci_058                -2.340257e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119236e-03 3 1  ON 59
ci_061                 5.675015e-03 3 1  ON 60
ci_062                -3.386385e-03 3 1  ON 61
ci_063                -3.371605e-03 3 1  ON 62
ci_064                -2.591720e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238108e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760588e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.563738
====================================================
  Execution time = 1.3685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9790e-01
  Total weights = 1.9575e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972898272
                                         uncertainty =       0.001503770696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972898272
                                         uncertainty =       0.001503770696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378121527
  error estimate for blocks of size 2^( 2) =       0.000389138838
  error estimate for blocks of size 2^( 3) =       0.000399721432
  error estimate for blocks of size 2^( 4) =       0.000407766315
  error estimate for blocks of size 2^( 5) =       0.000413092693
  error estimate for blocks of size 2^( 6) =       0.000416580164
  error estimate for blocks of size 2^( 7) =       0.000417139052

      target function =      -0.904232511862
              le_mean =     -17.215318948572
             les_mean =     296.665104085897
             stat err =       0.000413644556
             autocorr =       1.196717992090
   target nu stat err =       0.000413644556
   target dn stat err =       0.002128680312
      target stat err =       0.002774740105
              std dev =       0.534744591459
             le_variance =       0.285951778094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972892004
                                         uncertainty =       0.001503770610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972892004
                                         uncertainty =       0.001503770610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378121523
  error estimate for blocks of size 2^( 2) =       0.000389138835
  error estimate for blocks of size 2^( 3) =       0.000399721431
  error estimate for blocks of size 2^( 4) =       0.000407766315
  error estimate for blocks of size 2^( 5) =       0.000413092695
  error estimate for blocks of size 2^( 6) =       0.000416580167
  error estimate for blocks of size 2^( 7) =       0.000417139054

      target function =      -0.904232533639
              le_mean =     -17.215318948451
             les_mean =     296.665104064634
             stat err =       0.000413644558
             autocorr =       1.196718026440
   target nu stat err =       0.000413644558
   target dn stat err =       0.002128678836
      target stat err =       0.002774738397
              std dev =       0.534744585593
             le_variance =       0.285951771821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972895138
                                         uncertainty =       0.001503770653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972895138
                                         uncertainty =       0.001503770653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378121525
  error estimate for blocks of size 2^( 2) =       0.000389138837
  error estimate for blocks of size 2^( 3) =       0.000399721431
  error estimate for blocks of size 2^( 4) =       0.000407766315
  error estimate for blocks of size 2^( 5) =       0.000413092694
  error estimate for blocks of size 2^( 6) =       0.000416580165
  error estimate for blocks of size 2^( 7) =       0.000417139053

      target function =      -0.904232522751
              le_mean =     -17.215318948512
             les_mean =     296.665104075264
             stat err =       0.000413644557
             autocorr =       1.196718009267
   target nu stat err =       0.000413644557
   target dn stat err =       0.002128679574
      target stat err =       0.002774739251
              std dev =       0.534744588526
             le_variance =       0.285951774958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972897880
                                         uncertainty =       0.001503770691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285972897880
                                         uncertainty =       0.001503770691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378121527
  error estimate for blocks of size 2^( 2) =       0.000389138838
  error estimate for blocks of size 2^( 3) =       0.000399721432
  error estimate for blocks of size 2^( 4) =       0.000407766315
  error estimate for blocks of size 2^( 5) =       0.000413092693
  error estimate for blocks of size 2^( 6) =       0.000416580165
  error estimate for blocks of size 2^( 7) =       0.000417139052

      target function =      -0.904232513223
              le_mean =     -17.215318948564
             les_mean =     296.665104084567
             stat err =       0.000413644556
             autocorr =       1.196717994244
   target nu stat err =       0.000413644556
   target dn stat err =       0.002128680220
      target stat err =       0.002774739998
              std dev =       0.534744591092
             le_variance =       0.285951777702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904232511862        initial
     9.3132e+03     9.3132e+04             1.3557e-08        -0.904232533639  <--
     3.7253e+04     3.7253e+05             3.3892e-09        -0.904232522751
     1.4901e+05     1.4901e+06             8.4730e-10        -0.904232513223

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.2930e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -3.960618e-02 3 1  ON 0
ci_002                -2.983643e-02 3 1  ON 1
ci_003                -2.463850e-02 3 1  ON 2
ci_004                 2.204223e-02 3 1  ON 3
ci_005                 2.234499e-02 3 1  ON 4
ci_006                -1.927452e-02 3 1  ON 5
ci_007                -1.923952e-02 3 1  ON 6
ci_008                -8.641523e-03 3 1  ON 7
ci_009                -1.450797e-02 3 1  ON 8
ci_010                -9.762553e-03 3 1  ON 9
ci_011                -1.004487e-02 3 1  ON 10
ci_012                -1.010389e-02 3 1  ON 11
ci_013                -1.981195e-02 3 1  ON 12
ci_014                 1.160638e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621378e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705391e-03 3 1  ON 17
ci_019                 9.840509e-03 3 1  ON 18
ci_020                 1.546265e-02 3 1  ON 19
ci_021                 1.554105e-02 3 1  ON 20
ci_022                 8.866241e-03 3 1  ON 21
ci_023                 8.760557e-03 3 1  ON 22
ci_024                 9.275268e-03 3 1  ON 23
ci_025                 9.214307e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063352e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848728e-03 3 1  ON 29
ci_031                -8.993398e-03 3 1  ON 30
ci_032                -1.465261e-02 3 1  ON 31
ci_033                 5.876449e-03 3 1  ON 32
ci_034                 5.549827e-03 3 1  ON 33
ci_035                -3.910406e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205142e-02 3 1  ON 36
ci_038                 1.499335e-03 3 1  ON 37
ci_039                 1.650043e-03 3 1  ON 38
ci_040                -2.180595e-03 3 1  ON 39
ci_041                 8.249906e-03 3 1  ON 40
ci_042                 8.241173e-03 3 1  ON 41
ci_043                -2.889251e-03 3 1  ON 42
ci_044                -4.658534e-03 3 1  ON 43
ci_045                -2.410080e-03 3 1  ON 44
ci_046                 5.180989e-03 3 1  ON 45
ci_047                 5.206005e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271789e-02 3 1  ON 48
ci_050                 3.382960e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679076e-03 3 1  ON 51
ci_053                -2.719904e-03 3 1  ON 52
ci_054                -2.708131e-03 3 1  ON 53
ci_055                -2.967659e-03 3 1  ON 54
ci_056                 4.916271e-03 3 1  ON 55
ci_057                 5.079524e-03 3 1  ON 56
ci_058                -2.340256e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119234e-03 3 1  ON 59
ci_061                 5.675012e-03 3 1  ON 60
ci_062                -3.386379e-03 3 1  ON 61
ci_063                -3.371603e-03 3 1  ON 62
ci_064                -2.591716e-03 3 1  ON 63
ci_065                -3.638497e-03 3 1  ON 64
ci_066                 4.238105e-03 3 1  ON 65
ci_067                 4.361337e-03 3 1  ON 66
ci_068                -4.760582e-03 3 1  ON 67
ci_069                -4.494748e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.268
    reference variance = 0.266445
====================================================
  Execution time = 1.3972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9722e-01
  Total weights = 1.957668897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285225125804
                                         uncertainty =       0.001598558745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285225125804
                                         uncertainty =       0.001598558745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377655638
  error estimate for blocks of size 2^( 2) =       0.000389042509
  error estimate for blocks of size 2^( 3) =       0.000399238560
  error estimate for blocks of size 2^( 4) =       0.000406557999
  error estimate for blocks of size 2^( 5) =       0.000410824937
  error estimate for blocks of size 2^( 6) =       0.000413769986
  error estimate for blocks of size 2^( 7) =       0.000414824337

      target function =      -0.905119331707
              le_mean =     -17.215401640466
             les_mean =     296.667271906073
             stat err =       0.000411494315
             autocorr =       1.187232384857
   target nu stat err =       0.000411494315
   target dn stat err =       0.001931381940
      target stat err =       0.002533923591
              std dev =       0.534085724653
             le_variance =       0.285247561279


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721540164047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905125744272       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905125758087       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905125761588       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905125762374       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905125762338       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905125762358       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905125762362       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905125762352       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905125762356       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905125762357       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 6.678435e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905125744272       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905125747726       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905125748601       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905125748797       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905125748779       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905125748799       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905125748795       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905125748771       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905125748772       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905125748797       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 1.669641e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905125744272       residual = 7.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905125745136       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905125745354       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905125745404       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905125745372       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905125745500       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905125745340       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905125745414       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905125745401       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905125745425       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+04 is 4.174123e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.553952 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6492e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.960616e-02 3 1  ON 0
ci_002                -2.983642e-02 3 1  ON 1
ci_003                -2.463848e-02 3 1  ON 2
ci_004                 2.204222e-02 3 1  ON 3
ci_005                 2.234498e-02 3 1  ON 4
ci_006                -1.927451e-02 3 1  ON 5
ci_007                -1.923951e-02 3 1  ON 6
ci_008                -8.641514e-03 3 1  ON 7
ci_009                -1.450796e-02 3 1  ON 8
ci_010                -9.762556e-03 3 1  ON 9
ci_011                -1.004486e-02 3 1  ON 10
ci_012                -1.010388e-02 3 1  ON 11
ci_013                -1.981195e-02 3 1  ON 12
ci_014                 1.160638e-02 3 1  ON 13
ci_015                 1.183913e-02 3 1  ON 14
ci_016                 1.621378e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705385e-03 3 1  ON 17
ci_019                 9.840500e-03 3 1  ON 18
ci_020                 1.546264e-02 3 1  ON 19
ci_021                 1.554104e-02 3 1  ON 20
ci_022                 8.866240e-03 3 1  ON 21
ci_023                 8.760554e-03 3 1  ON 22
ci_024                 9.275265e-03 3 1  ON 23
ci_025                 9.214301e-03 3 1  ON 24
ci_026                 1.038048e-02 3 1  ON 25
ci_027                 1.063351e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848732e-03 3 1  ON 29
ci_031                -8.993391e-03 3 1  ON 30
ci_032                -1.465260e-02 3 1  ON 31
ci_033                 5.876448e-03 3 1  ON 32
ci_034                 5.549828e-03 3 1  ON 33
ci_035                -3.910401e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205141e-02 3 1  ON 36
ci_038                 1.499333e-03 3 1  ON 37
ci_039                 1.650038e-03 3 1  ON 38
ci_040                -2.180590e-03 3 1  ON 39
ci_041                 8.249904e-03 3 1  ON 40
ci_042                 8.241174e-03 3 1  ON 41
ci_043                -2.889245e-03 3 1  ON 42
ci_044                -4.658532e-03 3 1  ON 43
ci_045                -2.410076e-03 3 1  ON 44
ci_046                 5.180990e-03 3 1  ON 45
ci_047                 5.206006e-03 3 1  ON 46
ci_048                -1.257813e-02 3 1  ON 47
ci_049                -1.271787e-02 3 1  ON 48
ci_050                 3.382962e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679078e-03 3 1  ON 51
ci_053                -2.719894e-03 3 1  ON 52
ci_054                -2.708125e-03 3 1  ON 53
ci_055                -2.967652e-03 3 1  ON 54
ci_056                 4.916267e-03 3 1  ON 55
ci_057                 5.079518e-03 3 1  ON 56
ci_058                -2.340253e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119237e-03 3 1  ON 59
ci_061                 5.675005e-03 3 1  ON 60
ci_062                -3.386375e-03 3 1  ON 61
ci_063                -3.371602e-03 3 1  ON 62
ci_064                -2.591713e-03 3 1  ON 63
ci_065                -3.638496e-03 3 1  ON 64
ci_066                 4.238106e-03 3 1  ON 65
ci_067                 4.361336e-03 3 1  ON 66
ci_068                -4.760583e-03 3 1  ON 67
ci_069                -4.494746e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2737
    reference variance = 0.207253
====================================================
  Execution time = 1.3269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9910e-01
  Total weights = 1.9577e+06
  Execution time = 1.8471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290646734
                                         uncertainty =       0.001774690605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290646734
                                         uncertainty =       0.001774690605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377005206
  error estimate for blocks of size 2^( 2) =       0.000387973377
  error estimate for blocks of size 2^( 3) =       0.000398158595
  error estimate for blocks of size 2^( 4) =       0.000405550304
  error estimate for blocks of size 2^( 5) =       0.000411193367
  error estimate for blocks of size 2^( 6) =       0.000412790656
  error estimate for blocks of size 2^( 7) =       0.000413533288

      target function =      -0.902608800089
              le_mean =     -17.214929161143
             les_mean =     296.652885313603
             stat err =       0.000410766904
             autocorr =       1.187124298938
   target nu stat err =       0.000410766904
   target dn stat err =       0.002999667631
      target stat err =       0.003850362859
              std dev =       0.533165874993
             le_variance =       0.284265850257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290618563
                                         uncertainty =       0.001774691394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290618563
                                         uncertainty =       0.001774691394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377005187
  error estimate for blocks of size 2^( 2) =       0.000387973363
  error estimate for blocks of size 2^( 3) =       0.000398158588
  error estimate for blocks of size 2^( 4) =       0.000405550304
  error estimate for blocks of size 2^( 5) =       0.000411193372
  error estimate for blocks of size 2^( 6) =       0.000412790662
  error estimate for blocks of size 2^( 7) =       0.000413533296

      target function =      -0.902608818181
              le_mean =     -17.214929160984
             les_mean =     296.652885293849
             stat err =       0.000410766908
             autocorr =       1.187124444864
   target nu stat err =       0.000410766908
   target dn stat err =       0.002999670314
      target stat err =       0.003850366379
              std dev =       0.533165848516
             le_variance =       0.284265822024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290632648
                                         uncertainty =       0.001774690999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290632648
                                         uncertainty =       0.001774690999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377005196
  error estimate for blocks of size 2^( 2) =       0.000387973370
  error estimate for blocks of size 2^( 3) =       0.000398158591
  error estimate for blocks of size 2^( 4) =       0.000405550304
  error estimate for blocks of size 2^( 5) =       0.000411193369
  error estimate for blocks of size 2^( 6) =       0.000412790659
  error estimate for blocks of size 2^( 7) =       0.000413533292

      target function =      -0.902608809147
              le_mean =     -17.214929161064
             les_mean =     296.652885303716
             stat err =       0.000410766906
             autocorr =       1.187124371912
   target nu stat err =       0.000410766906
   target dn stat err =       0.002999668972
      target stat err =       0.003850364619
              std dev =       0.533165861754
             le_variance =       0.284265836140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290644973
                                         uncertainty =       0.001774690654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284290644973
                                         uncertainty =       0.001774690654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377005205
  error estimate for blocks of size 2^( 2) =       0.000387973376
  error estimate for blocks of size 2^( 3) =       0.000398158594
  error estimate for blocks of size 2^( 4) =       0.000405550304
  error estimate for blocks of size 2^( 5) =       0.000411193367
  error estimate for blocks of size 2^( 6) =       0.000412790656
  error estimate for blocks of size 2^( 7) =       0.000413533288

      target function =      -0.902608801222
              le_mean =     -17.214929161133
             les_mean =     296.652885312366
             stat err =       0.000410766904
             autocorr =       1.187124308066
   target nu stat err =       0.000410766904
   target dn stat err =       0.002999667798
      target stat err =       0.003850363079
              std dev =       0.533165873338
             le_variance =       0.284265848492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902608800089        initial
     2.3283e+03     2.3283e+04             6.6784e-08        -0.902608818181  <--
     9.3132e+03     9.3132e+04             1.6696e-08        -0.902608809147
     3.7253e+04     3.7253e+05             4.1741e-09        -0.902608801222

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.2627e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679084e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1542
    reference variance = 0.192118
====================================================
  Execution time = 1.4247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0223e-01
  Total weights = 1.957240259e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287388041404
                                         uncertainty =       0.001820187950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287388041404
                                         uncertainty =       0.001820187950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379038414
  error estimate for blocks of size 2^( 2) =       0.000390114835
  error estimate for blocks of size 2^( 3) =       0.000400112711
  error estimate for blocks of size 2^( 4) =       0.000407717845
  error estimate for blocks of size 2^( 5) =       0.000411630612
  error estimate for blocks of size 2^( 6) =       0.000413950993
  error estimate for blocks of size 2^( 7) =       0.000414567562

      target function =      -0.898653577685
              le_mean =     -17.214923748523
             les_mean =     296.655824837168
             stat err =       0.000411966753
             autocorr =       1.181293689431
   target nu stat err =       0.000411966753
   target dn stat err =       0.003407705876
      target stat err =       0.004325415830
              std dev =       0.536041266415
             le_variance =       0.287340239299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721492374852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898673643397       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898673706662       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898673718933       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898673721010       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898673721657       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898673721654       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898673721676       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898673721666       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898673721667       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898673721666       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 2.631709e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898673643397       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898673659215       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898673662283       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898673662802       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898673662963       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898673662962       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898673662968       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898673662966       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898673662966       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898673662966       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 6.579733e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898673643397       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898673647352       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898673648119       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898673648246       residual = 4.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898673648287       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898673648280       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898673648293       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898673648290       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898673648285       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898673648273       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+03 is 1.644962e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.557445 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6794e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.960605e-02 3 1  ON 0
ci_002                -2.983636e-02 3 1  ON 1
ci_003                -2.463839e-02 3 1  ON 2
ci_004                 2.204216e-02 3 1  ON 3
ci_005                 2.234488e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641493e-03 3 1  ON 7
ci_009                -1.450793e-02 3 1  ON 8
ci_010                -9.762560e-03 3 1  ON 9
ci_011                -1.004482e-02 3 1  ON 10
ci_012                -1.010380e-02 3 1  ON 11
ci_013                -1.981190e-02 3 1  ON 12
ci_014                 1.160634e-02 3 1  ON 13
ci_015                 1.183907e-02 3 1  ON 14
ci_016                 1.621378e-02 3 1  ON 15
ci_017                 1.615616e-02 3 1  ON 16
ci_018                 9.705344e-03 3 1  ON 17
ci_019                 9.840478e-03 3 1  ON 18
ci_020                 1.546260e-02 3 1  ON 19
ci_021                 1.554101e-02 3 1  ON 20
ci_022                 8.866227e-03 3 1  ON 21
ci_023                 8.760537e-03 3 1  ON 22
ci_024                 9.275220e-03 3 1  ON 23
ci_025                 9.214274e-03 3 1  ON 24
ci_026                 1.038049e-02 3 1  ON 25
ci_027                 1.063344e-02 3 1  ON 26
ci_028                -1.486230e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848751e-03 3 1  ON 29
ci_031                -8.993364e-03 3 1  ON 30
ci_032                -1.465258e-02 3 1  ON 31
ci_033                 5.876459e-03 3 1  ON 32
ci_034                 5.549803e-03 3 1  ON 33
ci_035                -3.910383e-03 3 1  ON 34
ci_036                -1.188653e-02 3 1  ON 35
ci_037                -1.205137e-02 3 1  ON 36
ci_038                 1.499312e-03 3 1  ON 37
ci_039                 1.650005e-03 3 1  ON 38
ci_040                -2.180543e-03 3 1  ON 39
ci_041                 8.249891e-03 3 1  ON 40
ci_042                 8.241174e-03 3 1  ON 41
ci_043                -2.889203e-03 3 1  ON 42
ci_044                -4.658490e-03 3 1  ON 43
ci_045                -2.410054e-03 3 1  ON 44
ci_046                 5.180968e-03 3 1  ON 45
ci_047                 5.205990e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271784e-02 3 1  ON 48
ci_050                 3.382972e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679107e-03 3 1  ON 51
ci_053                -2.719887e-03 3 1  ON 52
ci_054                -2.708091e-03 3 1  ON 53
ci_055                -2.967616e-03 3 1  ON 54
ci_056                 4.916228e-03 3 1  ON 55
ci_057                 5.079497e-03 3 1  ON 56
ci_058                -2.340224e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119266e-03 3 1  ON 59
ci_061                 5.674959e-03 3 1  ON 60
ci_062                -3.386345e-03 3 1  ON 61
ci_063                -3.371588e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638482e-03 3 1  ON 64
ci_066                 4.238125e-03 3 1  ON 65
ci_067                 4.361334e-03 3 1  ON 66
ci_068                -4.760574e-03 3 1  ON 67
ci_069                -4.494759e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.188982
====================================================
  Execution time = 1.3274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0023e-01
  Total weights = 1.9577e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217492463
                                         uncertainty =       0.001730967732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217492463
                                         uncertainty =       0.001730967732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378951746
  error estimate for blocks of size 2^( 2) =       0.000390073764
  error estimate for blocks of size 2^( 3) =       0.000400597381
  error estimate for blocks of size 2^( 4) =       0.000408100764
  error estimate for blocks of size 2^( 5) =       0.000413463685
  error estimate for blocks of size 2^( 6) =       0.000416359852
  error estimate for blocks of size 2^( 7) =       0.000417690893

      target function =      -0.901174303491
              le_mean =     -17.214896623816
             les_mean =     296.652896765968
             stat err =       0.000413903799
             autocorr =       1.192974056107
   target nu stat err =       0.000413903799
   target dn stat err =       0.002298117110
      target stat err =       0.002964539626
              std dev =       0.535918698925
             le_variance =       0.287208851858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217409363
                                         uncertainty =       0.001730967436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217409363
                                         uncertainty =       0.001730967436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378951692
  error estimate for blocks of size 2^( 2) =       0.000390073728
  error estimate for blocks of size 2^( 3) =       0.000400597364
  error estimate for blocks of size 2^( 4) =       0.000408100760
  error estimate for blocks of size 2^( 5) =       0.000413463687
  error estimate for blocks of size 2^( 6) =       0.000416359861
  error estimate for blocks of size 2^( 7) =       0.000417690908

      target function =      -0.901173568512
              le_mean =     -17.214896625326
             les_mean =     296.652897399208
             stat err =       0.000413903804
             autocorr =       1.192974431025
   target nu stat err =       0.000413903804
   target dn stat err =       0.002298127346
      target stat err =       0.002964547589
              std dev =       0.535918621743
             le_variance =       0.287208769131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217450907
                                         uncertainty =       0.001730967584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217450907
                                         uncertainty =       0.001730967584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378951719
  error estimate for blocks of size 2^( 2) =       0.000390073746
  error estimate for blocks of size 2^( 3) =       0.000400597372
  error estimate for blocks of size 2^( 4) =       0.000408100762
  error estimate for blocks of size 2^( 5) =       0.000413463686
  error estimate for blocks of size 2^( 6) =       0.000416359857
  error estimate for blocks of size 2^( 7) =       0.000417690900

      target function =      -0.901173939182
              le_mean =     -17.214896624571
             les_mean =     296.652897080070
             stat err =       0.000413903801
             autocorr =       1.192974243581
   target nu stat err =       0.000413903801
   target dn stat err =       0.002298122169
      target stat err =       0.002964543555
              std dev =       0.535918660328
             le_variance =       0.287208810488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217487268
                                         uncertainty =       0.001730967714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287217487268
                                         uncertainty =       0.001730967714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378951743
  error estimate for blocks of size 2^( 2) =       0.000390073761
  error estimate for blocks of size 2^( 3) =       0.000400597380
  error estimate for blocks of size 2^( 4) =       0.000408100764
  error estimate for blocks of size 2^( 5) =       0.000413463685
  error estimate for blocks of size 2^( 6) =       0.000416359853
  error estimate for blocks of size 2^( 7) =       0.000417690894

      target function =      -0.901174258300
              le_mean =     -17.214896623911
             les_mean =     296.652896804956
             stat err =       0.000413903799
             autocorr =       1.192974079543
   target nu stat err =       0.000413903799
   target dn stat err =       0.002298117736
      target stat err =       0.002964540112
              std dev =       0.535918694100
             le_variance =       0.287208846686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901174303491        initial  <--
     5.8208e+02     5.8208e+03             2.6317e-07        -0.901173568512
     2.3283e+03     2.3283e+04             6.5797e-08        -0.901173939182
     9.3132e+03     9.3132e+04             1.6450e-08        -0.901174258300

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5445
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679084e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1589
    reference variance = 0.184548
====================================================
  Execution time = 1.4161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9851e-01
  Total weights = 1.957427356e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287380753157
                                         uncertainty =       0.001686596273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287380753157
                                         uncertainty =       0.001686596273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379133649
  error estimate for blocks of size 2^( 2) =       0.000390401692
  error estimate for blocks of size 2^( 3) =       0.000400657468
  error estimate for blocks of size 2^( 4) =       0.000408210213
  error estimate for blocks of size 2^( 5) =       0.000413057935
  error estimate for blocks of size 2^( 6) =       0.000416624565
  error estimate for blocks of size 2^( 7) =       0.000416413000

      target function =      -0.903365169233
              le_mean =     -17.214957478757
             les_mean =     296.653275452877
             stat err =       0.000413576428
             autocorr =       1.189945016834
   target nu stat err =       0.000413576428
   target dn stat err =       0.002233657031
      target stat err =       0.002898563454
              std dev =       0.536175948549
             le_variance =       0.287484647803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721495747876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903373687937       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903373696810       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903373698621       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903373698960       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903373698995       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903373698978       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903373698980       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903373698986       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903373698977       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903373698980       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 2.157294e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903373687937       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903373690155       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903373690608       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903373690689       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903373690712       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903373690690       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903373690665       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903373690712       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903373690692       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903373690653       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+04 is 5.393292e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903373687937       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903373688491       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903373688605       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903373688627       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903373688601       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903373688618       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903373688719       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903373688678       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903373688679       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903373688861       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+04 is 1.348326e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.560835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6641e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463844e-02 3 1  ON 2
ci_004                 2.204219e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641484e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762563e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621379e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705368e-03 3 1  ON 17
ci_019                 9.840472e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554102e-02 3 1  ON 20
ci_022                 8.866239e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063349e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465258e-02 3 1  ON 31
ci_033                 5.876440e-03 3 1  ON 32
ci_034                 5.549828e-03 3 1  ON 33
ci_035                -3.910385e-03 3 1  ON 34
ci_036                -1.188651e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499324e-03 3 1  ON 37
ci_039                 1.650021e-03 3 1  ON 38
ci_040                -2.180571e-03 3 1  ON 39
ci_041                 8.249897e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889222e-03 3 1  ON 42
ci_044                -4.658523e-03 3 1  ON 43
ci_045                -2.410066e-03 3 1  ON 44
ci_046                 5.180990e-03 3 1  ON 45
ci_047                 5.206007e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382963e-03 3 1  ON 49
ci_051                 3.294913e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719867e-03 3 1  ON 52
ci_054                -2.708107e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916252e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340248e-03 3 1  ON 57
ci_059                -2.340939e-03 3 1  ON 58
ci_060                 5.119244e-03 3 1  ON 59
ci_061                 5.674984e-03 3 1  ON 60
ci_062                -3.386361e-03 3 1  ON 61
ci_063                -3.371598e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238104e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760582e-03 3 1  ON 67
ci_069                -4.494734e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1702
    reference variance = 0.183199
====================================================
  Execution time = 1.3347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0456e-01
  Total weights = 1.9578e+06
  Execution time = 1.9147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298469306
                                         uncertainty =       0.001717825151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298469306
                                         uncertainty =       0.001717825151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380347712
  error estimate for blocks of size 2^( 2) =       0.000391564701
  error estimate for blocks of size 2^( 3) =       0.000401803194
  error estimate for blocks of size 2^( 4) =       0.000408920890
  error estimate for blocks of size 2^( 5) =       0.000413635655
  error estimate for blocks of size 2^( 6) =       0.000415496570
  error estimate for blocks of size 2^( 7) =       0.000416048212

      target function =      -0.895889105363
              le_mean =     -17.215674492793
             les_mean =     296.684008490269
             stat err =       0.000413525332
             autocorr =       1.182068434322
   target nu stat err =       0.000413525332
   target dn stat err =       0.002789257188
      target stat err =       0.003538793138
              std dev =       0.537892893342
             le_variance =       0.289328764707

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298456753
                                         uncertainty =       0.001717825231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298456753
                                         uncertainty =       0.001717825231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380347704
  error estimate for blocks of size 2^( 2) =       0.000391564696
  error estimate for blocks of size 2^( 3) =       0.000401803191
  error estimate for blocks of size 2^( 4) =       0.000408920891
  error estimate for blocks of size 2^( 5) =       0.000413635657
  error estimate for blocks of size 2^( 6) =       0.000415496572
  error estimate for blocks of size 2^( 7) =       0.000416048214

      target function =      -0.895889090084
              le_mean =     -17.215674492699
             les_mean =     296.684008499231
             stat err =       0.000413525334
             autocorr =       1.182068496454
   target nu stat err =       0.000413525334
   target dn stat err =       0.002789259507
      target stat err =       0.003538795882
              std dev =       0.537892881601
             le_variance =       0.289328752077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298463030
                                         uncertainty =       0.001717825191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298463030
                                         uncertainty =       0.001717825191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380347708
  error estimate for blocks of size 2^( 2) =       0.000391564698
  error estimate for blocks of size 2^( 3) =       0.000401803193
  error estimate for blocks of size 2^( 4) =       0.000408920890
  error estimate for blocks of size 2^( 5) =       0.000413635656
  error estimate for blocks of size 2^( 6) =       0.000415496571
  error estimate for blocks of size 2^( 7) =       0.000416048213

      target function =      -0.895889097726
              le_mean =     -17.215674492746
             les_mean =     296.684008494748
             stat err =       0.000413525333
             autocorr =       1.182068465396
   target nu stat err =       0.000413525333
   target dn stat err =       0.002789258348
      target stat err =       0.003538794510
              std dev =       0.537892887471
             le_variance =       0.289328758392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298468521
                                         uncertainty =       0.001717825156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289298468521
                                         uncertainty =       0.001717825156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380347712
  error estimate for blocks of size 2^( 2) =       0.000391564701
  error estimate for blocks of size 2^( 3) =       0.000401803193
  error estimate for blocks of size 2^( 4) =       0.000408920890
  error estimate for blocks of size 2^( 5) =       0.000413635655
  error estimate for blocks of size 2^( 6) =       0.000415496570
  error estimate for blocks of size 2^( 7) =       0.000416048212

      target function =      -0.895889104409
              le_mean =     -17.215674492787
             les_mean =     296.684008490829
             stat err =       0.000413525332
             autocorr =       1.182068438209
   target nu stat err =       0.000413525332
   target dn stat err =       0.002789257333
      target stat err =       0.003538793310
              std dev =       0.537892892608
             le_variance =       0.289328763918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.895889105363        initial  <--
     5.8208e+03     5.8208e+04             2.1573e-08        -0.895889090084
     2.3283e+04     2.3283e+05             5.3933e-09        -0.895889097726
     9.3132e+04     9.3132e+05             1.3483e-09        -0.895889104409

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6726
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679084e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.245199
====================================================
  Execution time = 1.6342e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0470e-01
  Total weights = 1.957387245e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288865190871
                                         uncertainty =       0.002077426226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288865190871
                                         uncertainty =       0.002077426226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380039286
  error estimate for blocks of size 2^( 2) =       0.000391339526
  error estimate for blocks of size 2^( 3) =       0.000401414061
  error estimate for blocks of size 2^( 4) =       0.000409439007
  error estimate for blocks of size 2^( 5) =       0.000415202176
  error estimate for blocks of size 2^( 6) =       0.000417863102
  error estimate for blocks of size 2^( 7) =       0.000415914950

      target function =      -0.895627408594
              le_mean =     -17.215317512076
             les_mean =     296.671859696202
             stat err =       0.000414604809
             autocorr =       1.190177354419
   target nu stat err =       0.000414604809
   target dn stat err =       0.003614894164
      target stat err =       0.004556555478
              std dev =       0.537456712567
             le_variance =       0.288859717884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721531751208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895649928051       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895649930287       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895649930490       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895649930523       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895649930535       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895649930532       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895649930598       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895649930535       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895649930535       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895649930535       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+04 is 3.803506e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895649928051       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895649928610       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895649928661       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895649928669       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895649928672       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895649928672       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895649928672       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895649928829       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895649928672       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895649928672       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+05 is 9.508775e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895649928051       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895649928191       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895649928204       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895649928206       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895649927765       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895649928206       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895649928207       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895649928193       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895649930278       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895649928812       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+05 is 2.377195e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.564206 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8829e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762566e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554102e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760545e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214283e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993371e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876442e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249899e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889225e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719865e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916253e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340246e-03 3 1  ON 57
ci_059                -2.340939e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371599e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238108e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494737e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.317165
====================================================
  Execution time = 1.3232e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0233e-01
  Total weights = 1.9578e+06
  Execution time = 1.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652794455
                                         uncertainty =       0.001956498291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652794455
                                         uncertainty =       0.001956498291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379876304
  error estimate for blocks of size 2^( 2) =       0.000391277614
  error estimate for blocks of size 2^( 3) =       0.000401574859
  error estimate for blocks of size 2^( 4) =       0.000410197204
  error estimate for blocks of size 2^( 5) =       0.000414786962
  error estimate for blocks of size 2^( 6) =       0.000416798100
  error estimate for blocks of size 2^( 7) =       0.000418245747

      target function =      -0.898396011272
              le_mean =     -17.214337613988
             les_mean =     296.635752128502
             stat err =       0.000415007003
             autocorr =       1.193511048181
   target nu stat err =       0.000415007003
   target dn stat err =       0.003050454390
      target stat err =       0.003875357937
              std dev =       0.537226221137
             le_variance =       0.288612012677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652792559
                                         uncertainty =       0.001956498117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652792559
                                         uncertainty =       0.001956498117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379876303
  error estimate for blocks of size 2^( 2) =       0.000391277613
  error estimate for blocks of size 2^( 3) =       0.000401574859
  error estimate for blocks of size 2^( 4) =       0.000410197204
  error estimate for blocks of size 2^( 5) =       0.000414786962
  error estimate for blocks of size 2^( 6) =       0.000416798100
  error estimate for blocks of size 2^( 7) =       0.000418245747

      target function =      -0.898396011160
              le_mean =     -17.214337614001
             les_mean =     296.635752129056
             stat err =       0.000415007003
             autocorr =       1.193511056178
   target nu stat err =       0.000415007003
   target dn stat err =       0.003050454080
      target stat err =       0.003875357552
              std dev =       0.537226219376
             le_variance =       0.288612010785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652793507
                                         uncertainty =       0.001956498204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652793507
                                         uncertainty =       0.001956498204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379876303
  error estimate for blocks of size 2^( 2) =       0.000391277613
  error estimate for blocks of size 2^( 3) =       0.000401574859
  error estimate for blocks of size 2^( 4) =       0.000410197204
  error estimate for blocks of size 2^( 5) =       0.000414786962
  error estimate for blocks of size 2^( 6) =       0.000416798100
  error estimate for blocks of size 2^( 7) =       0.000418245747

      target function =      -0.898396011216
              le_mean =     -17.214337613995
             les_mean =     296.635752128779
             stat err =       0.000415007003
             autocorr =       1.193511052180
   target nu stat err =       0.000415007003
   target dn stat err =       0.003050454235
      target stat err =       0.003875357744
              std dev =       0.537226220256
             le_variance =       0.288612011731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652794336
                                         uncertainty =       0.001956498280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288652794336
                                         uncertainty =       0.001956498280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379876304
  error estimate for blocks of size 2^( 2) =       0.000391277613
  error estimate for blocks of size 2^( 3) =       0.000401574859
  error estimate for blocks of size 2^( 4) =       0.000410197204
  error estimate for blocks of size 2^( 5) =       0.000414786962
  error estimate for blocks of size 2^( 6) =       0.000416798100
  error estimate for blocks of size 2^( 7) =       0.000418245747

      target function =      -0.898396011265
              le_mean =     -17.214337613989
             les_mean =     296.635752128537
             stat err =       0.000415007003
             autocorr =       1.193511048676
   target nu stat err =       0.000415007003
   target dn stat err =       0.003050454370
      target stat err =       0.003875357913
              std dev =       0.537226221027
             le_variance =       0.288612012559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898396011272        initial  <--
     5.8208e+04     5.8208e+05             3.8035e-09        -0.898396011160
     2.3283e+05     2.3283e+06             9.5088e-10        -0.898396011216
     9.3132e+05     9.3132e+06             2.3772e-10        -0.898396011265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.5046
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679084e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.135251
====================================================
  Execution time = 1.3719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0375e-01
  Total weights = 1.957572435e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4756e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289555532455
                                         uncertainty =       0.001757339382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289555532455
                                         uncertainty =       0.001757339382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380445625
  error estimate for blocks of size 2^( 2) =       0.000391173919
  error estimate for blocks of size 2^( 3) =       0.000401137306
  error estimate for blocks of size 2^( 4) =       0.000408863434
  error estimate for blocks of size 2^( 5) =       0.000413370649
  error estimate for blocks of size 2^( 6) =       0.000415612505
  error estimate for blocks of size 2^( 7) =       0.000417482256

      target function =      -0.896622076799
              le_mean =     -17.214311893140
             les_mean =     296.636280500387
             stat err =       0.000413832211
             autocorr =       1.183214259134
   target nu stat err =       0.000413832211
   target dn stat err =       0.002668589078
      target stat err =       0.003388206061
              std dev =       0.538031362409
             le_variance =       0.289477746936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721431189314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896634081999       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896634082101       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896634082118       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896634082122       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896634082340       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896634082006       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896634082879       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896634082676       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896634081749       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896634081234       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+05 is 3.621564e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896634081999       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896634082025       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896634082029       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896634082524       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896634082321       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896634082652       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896634083923       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896634084926       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896634082024       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896634079966       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+06 is 9.053913e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896634081999       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896634082006       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896634082007       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896634081940       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896634078453       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896634078694       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896634084817       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896634079320       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896634077065       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896634076453       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+06 is 2.263481e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.567628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6204e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.16822
====================================================
  Execution time = 1.3339e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0416e-01
  Total weights = 1.9574e+06
  Execution time = 1.8313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910065
                                         uncertainty =       0.002233712714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910065
                                         uncertainty =       0.002233712714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379101736
  error estimate for blocks of size 2^( 2) =       0.000390066339
  error estimate for blocks of size 2^( 3) =       0.000400488429
  error estimate for blocks of size 2^( 4) =       0.000406959601
  error estimate for blocks of size 2^( 5) =       0.000411966705
  error estimate for blocks of size 2^( 6) =       0.000415055052
  error estimate for blocks of size 2^( 7) =       0.000416292776

      target function =      -0.896067487432
              le_mean =     -17.214244522092
             les_mean =     296.634370654747
             stat err =       0.000412568533
             autocorr =       1.184351614701
   target nu stat err =       0.000412568533
   target dn stat err =       0.004823596946
      target stat err =       0.006054230094
              std dev =       0.536130816255
             le_variance =       0.287436252139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497909993
                                         uncertainty =       0.002233712723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497909993
                                         uncertainty =       0.002233712723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379101736
  error estimate for blocks of size 2^( 2) =       0.000390066339
  error estimate for blocks of size 2^( 3) =       0.000400488429
  error estimate for blocks of size 2^( 4) =       0.000406959601
  error estimate for blocks of size 2^( 5) =       0.000411966705
  error estimate for blocks of size 2^( 6) =       0.000415055052
  error estimate for blocks of size 2^( 7) =       0.000416292776

      target function =      -0.896067486737
              le_mean =     -17.214244522094
             les_mean =     296.634370655346
             stat err =       0.000412568533
             autocorr =       1.184351615402
   target nu stat err =       0.000412568533
   target dn stat err =       0.004823597552
      target stat err =       0.006054230839
              std dev =       0.536130816189
             le_variance =       0.287436252067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910029
                                         uncertainty =       0.002233712719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910029
                                         uncertainty =       0.002233712719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379101736
  error estimate for blocks of size 2^( 2) =       0.000390066339
  error estimate for blocks of size 2^( 3) =       0.000400488429
  error estimate for blocks of size 2^( 4) =       0.000406959601
  error estimate for blocks of size 2^( 5) =       0.000411966705
  error estimate for blocks of size 2^( 6) =       0.000415055052
  error estimate for blocks of size 2^( 7) =       0.000416292776

      target function =      -0.896067487084
              le_mean =     -17.214244522093
             les_mean =     296.634370655046
             stat err =       0.000412568533
             autocorr =       1.184351615056
   target nu stat err =       0.000412568533
   target dn stat err =       0.004823597249
      target stat err =       0.006054230466
              std dev =       0.536130816222
             le_variance =       0.287436252103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910060
                                         uncertainty =       0.002233712715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287497910060
                                         uncertainty =       0.002233712715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379101736
  error estimate for blocks of size 2^( 2) =       0.000390066339
  error estimate for blocks of size 2^( 3) =       0.000400488429
  error estimate for blocks of size 2^( 4) =       0.000406959601
  error estimate for blocks of size 2^( 5) =       0.000411966705
  error estimate for blocks of size 2^( 6) =       0.000415055052
  error estimate for blocks of size 2^( 7) =       0.000416292776

      target function =      -0.896067487388
              le_mean =     -17.214244522092
             les_mean =     296.634370654784
             stat err =       0.000412568533
             autocorr =       1.184351614753
   target nu stat err =       0.000412568533
   target dn stat err =       0.004823596984
      target stat err =       0.006054230141
              std dev =       0.536130816251
             le_variance =       0.287436252134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896067487432        initial  <--
     5.8208e+05     5.8208e+06             3.6216e-10        -0.896067486737
     2.3283e+06     2.3283e+07             9.0539e-11        -0.896067487084
     9.3132e+06     9.3132e+07             2.2635e-11        -0.896067487388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.6171
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275258e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679084e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.8834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2216
    reference variance = 0.247279
====================================================
  Execution time = 1.3879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0197e-01
  Total weights = 1.957630617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288341138946
                                         uncertainty =       0.001636791133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288341138946
                                         uncertainty =       0.001636791133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379733520
  error estimate for blocks of size 2^( 2) =       0.000390955006
  error estimate for blocks of size 2^( 3) =       0.000400386114
  error estimate for blocks of size 2^( 4) =       0.000407987206
  error estimate for blocks of size 2^( 5) =       0.000412858556
  error estimate for blocks of size 2^( 6) =       0.000413835232
  error estimate for blocks of size 2^( 7) =       0.000417021092

      target function =      -0.898903261116
              le_mean =     -17.214556851171
             les_mean =     296.642940479940
             stat err =       0.000412925521
             autocorr =       1.182457614739
   target nu stat err =       0.000412925521
   target dn stat err =       0.002235831950
      target stat err =       0.002871282550
              std dev =       0.537024293652
             le_variance =       0.288395091973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721455685117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898911735474       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898911735482       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898911735483       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898911735483       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898911735483       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898911736957       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898911733660       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898911746947       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898911737162       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898911733658       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 2.262445e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898911735474       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898911735476       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898911735476       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898911734067       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898911745899       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898911751603       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898911695949       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898911750699       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898911717839       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898911724520       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+07 is 5.656138e-12

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898911735474       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898911735474       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898911735474       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898911735474       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898911735474       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898911763429       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898911667736       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898911436810       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898911737044       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898911849721       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+07 is 1.414076e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.570987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6432e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2277
    reference variance = 0.195095
====================================================
  Execution time = 1.3542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9596e-01
  Total weights = 1.9578e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170758
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170758
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377142234
  error estimate for blocks of size 2^( 2) =       0.000388591456
  error estimate for blocks of size 2^( 3) =       0.000398763160
  error estimate for blocks of size 2^( 4) =       0.000406034180
  error estimate for blocks of size 2^( 5) =       0.000411609915
  error estimate for blocks of size 2^( 6) =       0.000414372617
  error estimate for blocks of size 2^( 7) =       0.000415481311

      target function =      -0.906816986822
              le_mean =     -17.215807783440
             les_mean =     296.680000836420
             stat err =       0.000411874506
             autocorr =       1.192667769278
   target nu stat err =       0.000411874506
   target dn stat err =       0.002156086380
      target stat err =       0.002826267146
              std dev =       0.533359662675
             le_variance =       0.284472529769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170743
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170743
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377142234
  error estimate for blocks of size 2^( 2) =       0.000388591456
  error estimate for blocks of size 2^( 3) =       0.000398763160
  error estimate for blocks of size 2^( 4) =       0.000406034180
  error estimate for blocks of size 2^( 5) =       0.000411609915
  error estimate for blocks of size 2^( 6) =       0.000414372617
  error estimate for blocks of size 2^( 7) =       0.000415481311

      target function =      -0.906816986852
              le_mean =     -17.215807783440
             les_mean =     296.680000836393
             stat err =       0.000411874506
             autocorr =       1.192667769364
   target nu stat err =       0.000411874506
   target dn stat err =       0.002156086379
      target stat err =       0.002826267144
              std dev =       0.533359662661
             le_variance =       0.284472529754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170750
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170750
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377142234
  error estimate for blocks of size 2^( 2) =       0.000388591456
  error estimate for blocks of size 2^( 3) =       0.000398763160
  error estimate for blocks of size 2^( 4) =       0.000406034180
  error estimate for blocks of size 2^( 5) =       0.000411609915
  error estimate for blocks of size 2^( 6) =       0.000414372617
  error estimate for blocks of size 2^( 7) =       0.000415481311

      target function =      -0.906816986837
              le_mean =     -17.215807783440
             les_mean =     296.680000836407
             stat err =       0.000411874506
             autocorr =       1.192667769317
   target nu stat err =       0.000411874506
   target dn stat err =       0.002156086380
      target stat err =       0.002826267145
              std dev =       0.533359662668
             le_variance =       0.284472529762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170757
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284542170757
                                         uncertainty =       0.001625641470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377142234
  error estimate for blocks of size 2^( 2) =       0.000388591456
  error estimate for blocks of size 2^( 3) =       0.000398763160
  error estimate for blocks of size 2^( 4) =       0.000406034180
  error estimate for blocks of size 2^( 5) =       0.000411609915
  error estimate for blocks of size 2^( 6) =       0.000414372617
  error estimate for blocks of size 2^( 7) =       0.000415481311

      target function =      -0.906816986824
              le_mean =     -17.215807783440
             les_mean =     296.680000836419
             stat err =       0.000411874506
             autocorr =       1.192667769284
   target nu stat err =       0.000411874506
   target dn stat err =       0.002156086380
      target stat err =       0.002826267146
              std dev =       0.533359662675
             le_variance =       0.284472529768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.906816986822        initial
     5.8208e+06     5.8208e+07             2.2624e-11        -0.906816986852  <--
     2.3283e+07     2.3283e+08             5.6561e-12        -0.906816986837
     9.3132e+07     9.3132e+08             1.4141e-12        -0.906816986824

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 2.2863e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641488e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1196
    reference variance = 0.32674
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0082e-01
  Total weights = 1.957368790e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288694526355
                                         uncertainty =       0.001576457662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288694526355
                                         uncertainty =       0.001576457662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380023150
  error estimate for blocks of size 2^( 2) =       0.000391211226
  error estimate for blocks of size 2^( 3) =       0.000401215523
  error estimate for blocks of size 2^( 4) =       0.000408514166
  error estimate for blocks of size 2^( 5) =       0.000413671707
  error estimate for blocks of size 2^( 6) =       0.000416390916
  error estimate for blocks of size 2^( 7) =       0.000417159539

      target function =      -0.900377398920
              le_mean =     -17.214622564398
             les_mean =     296.644045947784
             stat err =       0.000413934082
             autocorr =       1.186430397744
   target nu stat err =       0.000413934082
   target dn stat err =       0.001987957496
      target stat err =       0.002575406985
              std dev =       0.537433892821
             le_variance =       0.288835189152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721462256440e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900383954120       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900383954150       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900383954157       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900383953403       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900383952940       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900383953870       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900383953128       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900383950802       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900383951931       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900383950427       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 9.637592e-11

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900383954120       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900383954127       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900383954129       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900383955420       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900383954147       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900383956318       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900383966366       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900383954677       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900383960697       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900383948663       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 2.409402e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900383954120       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900383954121       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900383954122       residual = 6.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900383954122       residual = 7.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900383954124       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900384010749       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900383950141       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900384001498       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900383949342       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900383963181       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+07 is 6.023471e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.574424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6615e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.284149
====================================================
  Execution time = 1.3639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9855e-01
  Total weights = 1.9574e+06
  Execution time = 1.8283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523484
                                         uncertainty =       0.001843479228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523484
                                         uncertainty =       0.001843479228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378988969
  error estimate for blocks of size 2^( 2) =       0.000389879940
  error estimate for blocks of size 2^( 3) =       0.000400062267
  error estimate for blocks of size 2^( 4) =       0.000407319263
  error estimate for blocks of size 2^( 5) =       0.000411140566
  error estimate for blocks of size 2^( 6) =       0.000410962220
  error estimate for blocks of size 2^( 7) =       0.000412668687

      target function =      -0.903470593269
              le_mean =     -17.215643112055
             les_mean =     296.676919346851
             stat err =       0.000410522684
             autocorr =       1.173332718488
   target nu stat err =       0.000410522684
   target dn stat err =       0.002363735769
      target stat err =       0.003063901730
              std dev =       0.535971339541
             le_variance =       0.287265276809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523437
                                         uncertainty =       0.001843479232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523437
                                         uncertainty =       0.001843479232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378988969
  error estimate for blocks of size 2^( 2) =       0.000389879940
  error estimate for blocks of size 2^( 3) =       0.000400062267
  error estimate for blocks of size 2^( 4) =       0.000407319263
  error estimate for blocks of size 2^( 5) =       0.000411140566
  error estimate for blocks of size 2^( 6) =       0.000410962220
  error estimate for blocks of size 2^( 7) =       0.000412668687

      target function =      -0.903470593396
              le_mean =     -17.215643112054
             les_mean =     296.676919346733
             stat err =       0.000410522684
             autocorr =       1.173332718748
   target nu stat err =       0.000410522684
   target dn stat err =       0.002363735774
      target stat err =       0.003063901737
              std dev =       0.535971339497
             le_variance =       0.287265276762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523461
                                         uncertainty =       0.001843479230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523461
                                         uncertainty =       0.001843479230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378988969
  error estimate for blocks of size 2^( 2) =       0.000389879940
  error estimate for blocks of size 2^( 3) =       0.000400062267
  error estimate for blocks of size 2^( 4) =       0.000407319263
  error estimate for blocks of size 2^( 5) =       0.000411140566
  error estimate for blocks of size 2^( 6) =       0.000410962220
  error estimate for blocks of size 2^( 7) =       0.000412668687

      target function =      -0.903470593333
              le_mean =     -17.215643112055
             les_mean =     296.676919346792
             stat err =       0.000410522684
             autocorr =       1.173332718626
   target nu stat err =       0.000410522684
   target dn stat err =       0.002363735771
      target stat err =       0.003063901734
              std dev =       0.535971339519
             le_variance =       0.287265276785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523481
                                         uncertainty =       0.001843479229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287231523481
                                         uncertainty =       0.001843479229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378988969
  error estimate for blocks of size 2^( 2) =       0.000389879940
  error estimate for blocks of size 2^( 3) =       0.000400062267
  error estimate for blocks of size 2^( 4) =       0.000407319263
  error estimate for blocks of size 2^( 5) =       0.000411140566
  error estimate for blocks of size 2^( 6) =       0.000410962220
  error estimate for blocks of size 2^( 7) =       0.000412668687

      target function =      -0.903470593277
              le_mean =     -17.215643112055
             les_mean =     296.676919346843
             stat err =       0.000410522684
             autocorr =       1.173332718503
   target nu stat err =       0.000410522684
   target dn stat err =       0.002363735769
      target stat err =       0.003063901731
              std dev =       0.535971339538
             le_variance =       0.287265276806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903470593269        initial
     1.4552e+06     1.4552e+07             9.6376e-11        -0.903470593396  <--
     5.8208e+06     5.8208e+07             2.4094e-11        -0.903470593333
     2.3283e+07     2.3283e+08             6.0235e-12        -0.903470593277

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 2.2903e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9528e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.37876
====================================================
  Execution time = 1.4004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9986e-01
  Total weights = 1.956991767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287245893363
                                         uncertainty =       0.001695538623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287245893363
                                         uncertainty =       0.001695538623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379043582
  error estimate for blocks of size 2^( 2) =       0.000390303268
  error estimate for blocks of size 2^( 3) =       0.000400655484
  error estimate for blocks of size 2^( 4) =       0.000407867461
  error estimate for blocks of size 2^( 5) =       0.000413655050
  error estimate for blocks of size 2^( 6) =       0.000416496041
  error estimate for blocks of size 2^( 7) =       0.000418180549

      target function =      -0.901786174503
              le_mean =     -17.215515142369
             les_mean =     296.673817813273
             stat err =       0.000414049775
             autocorr =       1.193237274043
   target nu stat err =       0.000414049775
   target dn stat err =       0.002185182487
      target stat err =       0.002831112663
              std dev =       0.536048574169
             le_variance =       0.287348073868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721551514237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901794419102       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901794419252       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901794419274       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901794419281       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901794419369       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901794419615       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901794418895       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901794419160       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901794419154       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901794419152       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+05 is 4.707487e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901794419102       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901794419139       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901794419145       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901794419147       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901794419182       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901794418343       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901794419288       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901794419087       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901794421517       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901794421014       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+06 is 1.176872e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901794419102       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901794419111       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901794419113       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901794419113       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901794417264       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901794421563       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901794434080       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901794417352       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901794445703       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901794406845       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+06 is 2.942178e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.577878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6508e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705368e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340246e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.296
    reference variance = 0.296736
====================================================
  Execution time = 1.3519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9811e-01
  Total weights = 1.9576e+06
  Execution time = 1.8260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440879
                                         uncertainty =       0.001794087740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440879
                                         uncertainty =       0.001794087740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377753752
  error estimate for blocks of size 2^( 2) =       0.000388919340
  error estimate for blocks of size 2^( 3) =       0.000398837525
  error estimate for blocks of size 2^( 4) =       0.000406345319
  error estimate for blocks of size 2^( 5) =       0.000410976511
  error estimate for blocks of size 2^( 6) =       0.000414671722
  error estimate for blocks of size 2^( 7) =       0.000415813205

      target function =      -0.903861237514
              le_mean =     -17.214864349576
             les_mean =     296.649661768009
             stat err =       0.000411951689
             autocorr =       1.189255045664
   target nu stat err =       0.000411951689
   target dn stat err =       0.002349148719
      target stat err =       0.003044940924
              std dev =       0.534224479380
             le_variance =       0.285395794369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440657
                                         uncertainty =       0.001794087737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440657
                                         uncertainty =       0.001794087737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377753752
  error estimate for blocks of size 2^( 2) =       0.000388919339
  error estimate for blocks of size 2^( 3) =       0.000398837525
  error estimate for blocks of size 2^( 4) =       0.000406345319
  error estimate for blocks of size 2^( 5) =       0.000410976511
  error estimate for blocks of size 2^( 6) =       0.000414671722
  error estimate for blocks of size 2^( 7) =       0.000415813205

      target function =      -0.903861236997
              le_mean =     -17.214864349581
             les_mean =     296.649661768601
             stat err =       0.000411951689
             autocorr =       1.189255046880
   target nu stat err =       0.000411951689
   target dn stat err =       0.002349148715
      target stat err =       0.003044940915
              std dev =       0.534224479173
             le_variance =       0.285395794148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440768
                                         uncertainty =       0.001794087738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440768
                                         uncertainty =       0.001794087738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377753752
  error estimate for blocks of size 2^( 2) =       0.000388919339
  error estimate for blocks of size 2^( 3) =       0.000398837525
  error estimate for blocks of size 2^( 4) =       0.000406345319
  error estimate for blocks of size 2^( 5) =       0.000410976511
  error estimate for blocks of size 2^( 6) =       0.000414671722
  error estimate for blocks of size 2^( 7) =       0.000415813205

      target function =      -0.903861237256
              le_mean =     -17.214864349578
             les_mean =     296.649661768305
             stat err =       0.000411951689
             autocorr =       1.189255046269
   target nu stat err =       0.000411951689
   target dn stat err =       0.002349148717
      target stat err =       0.003044940919
              std dev =       0.534224479277
             le_variance =       0.285395794259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440865
                                         uncertainty =       0.001794087740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285411440865
                                         uncertainty =       0.001794087740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377753752
  error estimate for blocks of size 2^( 2) =       0.000388919340
  error estimate for blocks of size 2^( 3) =       0.000398837525
  error estimate for blocks of size 2^( 4) =       0.000406345319
  error estimate for blocks of size 2^( 5) =       0.000410976511
  error estimate for blocks of size 2^( 6) =       0.000414671722
  error estimate for blocks of size 2^( 7) =       0.000415813205

      target function =      -0.903861237482
              le_mean =     -17.214864349576
             les_mean =     296.649661768046
             stat err =       0.000411951689
             autocorr =       1.189255045735
   target nu stat err =       0.000411951689
   target dn stat err =       0.002349148719
      target stat err =       0.003044940923
              std dev =       0.534224479367
             le_variance =       0.285395794355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903861237514        initial  <--
     3.6380e+05     3.6380e+06             4.7075e-10        -0.903861236997
     1.4552e+06     1.4552e+07             1.1769e-10        -0.903861237256
     5.8208e+06     5.8208e+07             2.9422e-11        -0.903861237482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.7797
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9298e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.141368
====================================================
  Execution time = 1.3766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0130e-01
  Total weights = 1.957640548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287295032936
                                         uncertainty =       0.002600680114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287295032936
                                         uncertainty =       0.002600680114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379020665
  error estimate for blocks of size 2^( 2) =       0.000390122966
  error estimate for blocks of size 2^( 3) =       0.000400519684
  error estimate for blocks of size 2^( 4) =       0.000408117854
  error estimate for blocks of size 2^( 5) =       0.000413335527
  error estimate for blocks of size 2^( 6) =       0.000416117924
  error estimate for blocks of size 2^( 7) =       0.000419438589

      target function =      -0.899827727194
              le_mean =     -17.214944407495
             les_mean =     296.655611099581
             stat err =       0.000414252473
             autocorr =       1.194550300561
   target nu stat err =       0.000414252473
   target dn stat err =       0.003022573202
      target stat err =       0.003856326473
              std dev =       0.536016164885
             le_variance =       0.287313329018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721494440750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899843331362       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899843331380       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899843331383       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899843331385       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899843333329       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899843332052       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899843335885       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899843330073       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899843329526       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899843330735       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 5.946788e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899843331362       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899843331367       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899843331368       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899843331368       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899843331250       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899843335545       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899843370038       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899843346669       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899843327050       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899843325714       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 1.486697e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899843331362       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899843331364       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899843331364       residual = 7.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899843331364       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899843331225       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899843333355       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899843281101       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899843344715       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899843281465       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899843283160       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+07 is 3.716763e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.581281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6262e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1736
    reference variance = 0.215678
====================================================
  Execution time = 1.3564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0672e-01
  Total weights = 1.9576e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193896
                                         uncertainty =       0.001918870398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193896
                                         uncertainty =       0.001918870398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636877
  error estimate for blocks of size 2^( 2) =       0.000388519733
  error estimate for blocks of size 2^( 3) =       0.000398543062
  error estimate for blocks of size 2^( 4) =       0.000405596901
  error estimate for blocks of size 2^( 5) =       0.000411151805
  error estimate for blocks of size 2^( 6) =       0.000414322512
  error estimate for blocks of size 2^( 7) =       0.000415292719

      target function =      -0.892796202662
              le_mean =     -17.214218367147
             les_mean =     296.636034660635
             stat err =       0.000411590984
             autocorr =       1.187908283824
   target nu stat err =       0.000411590984
   target dn stat err =       0.008106801779
      target stat err =       0.010071872453
              std dev =       0.534059193742
             le_variance =       0.285219222420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193861
                                         uncertainty =       0.001918870392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193861
                                         uncertainty =       0.001918870392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636877
  error estimate for blocks of size 2^( 2) =       0.000388519733
  error estimate for blocks of size 2^( 3) =       0.000398543062
  error estimate for blocks of size 2^( 4) =       0.000405596901
  error estimate for blocks of size 2^( 5) =       0.000411151805
  error estimate for blocks of size 2^( 6) =       0.000414322512
  error estimate for blocks of size 2^( 7) =       0.000415292719

      target function =      -0.892796202811
              le_mean =     -17.214218367148
             les_mean =     296.636034660555
             stat err =       0.000411590984
             autocorr =       1.187908283982
   target nu stat err =       0.000411590984
   target dn stat err =       0.008106801675
      target stat err =       0.010071872328
              std dev =       0.534059193709
             le_variance =       0.285219222385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193878
                                         uncertainty =       0.001918870395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193878
                                         uncertainty =       0.001918870395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636877
  error estimate for blocks of size 2^( 2) =       0.000388519733
  error estimate for blocks of size 2^( 3) =       0.000398543062
  error estimate for blocks of size 2^( 4) =       0.000405596901
  error estimate for blocks of size 2^( 5) =       0.000411151805
  error estimate for blocks of size 2^( 6) =       0.000414322512
  error estimate for blocks of size 2^( 7) =       0.000415292719

      target function =      -0.892796202737
              le_mean =     -17.214218367147
             les_mean =     296.636034660595
             stat err =       0.000411590984
             autocorr =       1.187908283895
   target nu stat err =       0.000411590984
   target dn stat err =       0.008106801727
      target stat err =       0.010071872391
              std dev =       0.534059193725
             le_variance =       0.285219222402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193893
                                         uncertainty =       0.001918870398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285272193893
                                         uncertainty =       0.001918870398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377636877
  error estimate for blocks of size 2^( 2) =       0.000388519733
  error estimate for blocks of size 2^( 3) =       0.000398543062
  error estimate for blocks of size 2^( 4) =       0.000405596901
  error estimate for blocks of size 2^( 5) =       0.000411151805
  error estimate for blocks of size 2^( 6) =       0.000414322512
  error estimate for blocks of size 2^( 7) =       0.000415292719

      target function =      -0.892796202672
              le_mean =     -17.214218367147
             les_mean =     296.636034660630
             stat err =       0.000411590984
             autocorr =       1.187908283833
   target nu stat err =       0.000411590984
   target dn stat err =       0.008106801773
      target stat err =       0.010071872446
              std dev =       0.534059193739
             le_variance =       0.285219222417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.892796202662        initial
     3.6380e+06     3.6380e+07             5.9468e-11        -0.892796202811  <--
     1.4552e+07     1.4552e+08             1.4867e-11        -0.892796202737
     5.8208e+07     5.8208e+08             3.7168e-12        -0.892796202672

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 2.2843e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.320498
====================================================
  Execution time = 1.3762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 2.9948e-01
  Total weights = 1.957464834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284899618160
                                         uncertainty =       0.001413624305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284899618160
                                         uncertainty =       0.001413624305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377396535
  error estimate for blocks of size 2^( 2) =       0.000388528559
  error estimate for blocks of size 2^( 3) =       0.000398658346
  error estimate for blocks of size 2^( 4) =       0.000405559057
  error estimate for blocks of size 2^( 5) =       0.000410929449
  error estimate for blocks of size 2^( 6) =       0.000414324026
  error estimate for blocks of size 2^( 7) =       0.000414768064

      target function =      -0.902315828526
              le_mean =     -17.215751015417
             les_mean =     296.681558555693
             stat err =       0.000411395149
             autocorr =       1.188290200993
   target nu stat err =       0.000411395149
   target dn stat err =       0.002794469987
      target stat err =       0.003595545318
              std dev =       0.533719298341
             le_variance =       0.284856289421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721575101542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902329517395       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902329517443       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902329517452       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902329517455       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902329517379       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902329517625       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902329517455       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902329518333       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902329517650       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902329518061       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+05 is 1.693192e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902329517395       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902329517407       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902329517409       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902329519128       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902329517410       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902329519364       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902329517410       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902329517410       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902329517410       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902329515038       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+06 is 4.232983e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902329517395       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902329517398       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902329517398       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902329519314       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902329517399       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902329528124       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902329520906       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902329500027       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902329495219       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902329519724       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+07 is 1.058248e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.584673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6253e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.287393
====================================================
  Execution time = 1.3752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9844e-01
  Total weights = 1.9574e+06
  Execution time = 1.8332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555593
                                         uncertainty =       0.001915452326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555593
                                         uncertainty =       0.001915452326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378688867
  error estimate for blocks of size 2^( 2) =       0.000390048061
  error estimate for blocks of size 2^( 3) =       0.000400340747
  error estimate for blocks of size 2^( 4) =       0.000407906194
  error estimate for blocks of size 2^( 5) =       0.000412877333
  error estimate for blocks of size 2^( 6) =       0.000415047141
  error estimate for blocks of size 2^( 7) =       0.000415132512

      target function =      -0.903477444035
              le_mean =     -17.215049953385
             les_mean =     296.656383425711
             stat err =       0.000412740795
             autocorr =       1.187926901458
   target nu stat err =       0.000412740795
   target dn stat err =       0.002781202021
      target stat err =       0.003584404716
              std dev =       0.535546931599
             le_variance =       0.286810515945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555519
                                         uncertainty =       0.001915452318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555519
                                         uncertainty =       0.001915452318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378688867
  error estimate for blocks of size 2^( 2) =       0.000390048060
  error estimate for blocks of size 2^( 3) =       0.000400340747
  error estimate for blocks of size 2^( 4) =       0.000407906194
  error estimate for blocks of size 2^( 5) =       0.000412877333
  error estimate for blocks of size 2^( 6) =       0.000415047141
  error estimate for blocks of size 2^( 7) =       0.000415132512

      target function =      -0.903477443977
              le_mean =     -17.215049953388
             les_mean =     296.656383425836
             stat err =       0.000412740795
             autocorr =       1.187926901780
   target nu stat err =       0.000412740795
   target dn stat err =       0.002781202004
      target stat err =       0.003584404695
              std dev =       0.535546931529
             le_variance =       0.286810515871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555556
                                         uncertainty =       0.001915452322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555556
                                         uncertainty =       0.001915452322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378688867
  error estimate for blocks of size 2^( 2) =       0.000390048060
  error estimate for blocks of size 2^( 3) =       0.000400340747
  error estimate for blocks of size 2^( 4) =       0.000407906194
  error estimate for blocks of size 2^( 5) =       0.000412877333
  error estimate for blocks of size 2^( 6) =       0.000415047141
  error estimate for blocks of size 2^( 7) =       0.000415132512

      target function =      -0.903477444006
              le_mean =     -17.215049953386
             les_mean =     296.656383425773
             stat err =       0.000412740795
             autocorr =       1.187926901617
   target nu stat err =       0.000412740795
   target dn stat err =       0.002781202012
      target stat err =       0.003584404706
              std dev =       0.535546931564
             le_variance =       0.286810515908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555589
                                         uncertainty =       0.001915452326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286812555589
                                         uncertainty =       0.001915452326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378688867
  error estimate for blocks of size 2^( 2) =       0.000390048060
  error estimate for blocks of size 2^( 3) =       0.000400340747
  error estimate for blocks of size 2^( 4) =       0.000407906194
  error estimate for blocks of size 2^( 5) =       0.000412877333
  error estimate for blocks of size 2^( 6) =       0.000415047141
  error estimate for blocks of size 2^( 7) =       0.000415132512

      target function =      -0.903477444031
              le_mean =     -17.215049953385
             les_mean =     296.656383425718
             stat err =       0.000412740795
             autocorr =       1.187926901470
   target nu stat err =       0.000412740795
   target dn stat err =       0.002781202020
      target stat err =       0.003584404715
              std dev =       0.535546931594
             le_variance =       0.286810515940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903477444035        initial  <--
     9.0949e+05     9.0949e+06             1.6932e-10        -0.903477443977
     3.6380e+06     3.6380e+07             4.2330e-11        -0.903477444006
     1.4552e+07     1.4552e+08             1.0582e-11        -0.903477444031

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1335
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.234649
====================================================
  Execution time = 1.3782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9497e-01
  Total weights = 1.957581933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283020369298
                                         uncertainty =       0.001497887670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283020369298
                                         uncertainty =       0.001497887670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376197045
  error estimate for blocks of size 2^( 2) =       0.000387446321
  error estimate for blocks of size 2^( 3) =       0.000397826323
  error estimate for blocks of size 2^( 4) =       0.000405344866
  error estimate for blocks of size 2^( 5) =       0.000409981522
  error estimate for blocks of size 2^( 6) =       0.000413289900
  error estimate for blocks of size 2^( 7) =       0.000414501325

      target function =      -0.907794904567
              le_mean =     -17.214548274604
             les_mean =     296.635645932195
             stat err =       0.000410779403
             autocorr =       1.192302788051
   target nu stat err =       0.000410779403
   target dn stat err =       0.001970562641
      target stat err =       0.002593882861
              std dev =       0.532022963353
             le_variance =       0.283048433535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721454827460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907801530699       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907801530704       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907801530706       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907801530706       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907801530706       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907801530706       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907801530706       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907801551952       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907801532019       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907801524169       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+06 is 1.724948e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907801530699       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907801530700       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907801530700       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907801530701       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907801527444       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907801509655       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907801529544       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907801522307       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907801591628       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907801548236       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+07 is 4.312381e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907801530699       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907801530699       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907801530699       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907801530699       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907801530699       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907801530294       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907801621715       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907801937712       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907801560221       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907801770760       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+08 is 1.078101e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.588163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6276e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.223303
====================================================
  Execution time = 1.3726e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0014e-01
  Total weights = 1.9575e+06
  Execution time = 2.2715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733509
                                         uncertainty =       0.002033111008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733509
                                         uncertainty =       0.002033111008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378704757
  error estimate for blocks of size 2^( 2) =       0.000389866389
  error estimate for blocks of size 2^( 3) =       0.000400407993
  error estimate for blocks of size 2^( 4) =       0.000408279048
  error estimate for blocks of size 2^( 5) =       0.000413171741
  error estimate for blocks of size 2^( 6) =       0.000415588282
  error estimate for blocks of size 2^( 7) =       0.000416632257

      target function =      -0.901273717870
              le_mean =     -17.214867636258
             les_mean =     296.651812654042
             stat err =       0.000413417832
             autocorr =       1.191727306432
   target nu stat err =       0.000413417832
   target dn stat err =       0.002638123864
      target stat err =       0.003387824538
              std dev =       0.535569402937
             le_variance =       0.286834585363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733499
                                         uncertainty =       0.002033111007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733499
                                         uncertainty =       0.002033111007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378704757
  error estimate for blocks of size 2^( 2) =       0.000389866389
  error estimate for blocks of size 2^( 3) =       0.000400407993
  error estimate for blocks of size 2^( 4) =       0.000408279048
  error estimate for blocks of size 2^( 5) =       0.000413171741
  error estimate for blocks of size 2^( 6) =       0.000415588282
  error estimate for blocks of size 2^( 7) =       0.000416632257

      target function =      -0.901273717858
              le_mean =     -17.214867636259
             les_mean =     296.651812654054
             stat err =       0.000413417832
             autocorr =       1.191727306477
   target nu stat err =       0.000413417832
   target dn stat err =       0.002638123862
      target stat err =       0.003387824536
              std dev =       0.535569402928
             le_variance =       0.286834585352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733504
                                         uncertainty =       0.002033111007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733504
                                         uncertainty =       0.002033111007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378704757
  error estimate for blocks of size 2^( 2) =       0.000389866389
  error estimate for blocks of size 2^( 3) =       0.000400407993
  error estimate for blocks of size 2^( 4) =       0.000408279048
  error estimate for blocks of size 2^( 5) =       0.000413171741
  error estimate for blocks of size 2^( 6) =       0.000415588282
  error estimate for blocks of size 2^( 7) =       0.000416632257

      target function =      -0.901273717864
              le_mean =     -17.214867636259
             les_mean =     296.651812654048
             stat err =       0.000413417832
             autocorr =       1.191727306462
   target nu stat err =       0.000413417832
   target dn stat err =       0.002638123863
      target stat err =       0.003387824537
              std dev =       0.535569402932
             le_variance =       0.286834585357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733509
                                         uncertainty =       0.002033111008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286876733509
                                         uncertainty =       0.002033111008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378704757
  error estimate for blocks of size 2^( 2) =       0.000389866389
  error estimate for blocks of size 2^( 3) =       0.000400407993
  error estimate for blocks of size 2^( 4) =       0.000408279048
  error estimate for blocks of size 2^( 5) =       0.000413171741
  error estimate for blocks of size 2^( 6) =       0.000415588282
  error estimate for blocks of size 2^( 7) =       0.000416632257

      target function =      -0.901273717870
              le_mean =     -17.214867636258
             les_mean =     296.651812654042
             stat err =       0.000413417832
             autocorr =       1.191727306433
   target nu stat err =       0.000413417832
   target dn stat err =       0.002638123864
      target stat err =       0.003387824538
              std dev =       0.535569402937
             le_variance =       0.286834585362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901273717870        initial  <--
     9.0949e+06     9.0949e+07             1.7249e-11        -0.901273717858
     3.6380e+07     3.6380e+08             4.3124e-12        -0.901273717864
     1.4552e+08     1.4552e+09             1.0781e-12        -0.901273717870

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4200
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.18247
====================================================
  Execution time = 1.3667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5332e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.957704252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287783626640
                                         uncertainty =       0.001727274550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287783626640
                                         uncertainty =       0.001727274550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379395132
  error estimate for blocks of size 2^( 2) =       0.000390491197
  error estimate for blocks of size 2^( 3) =       0.000400648423
  error estimate for blocks of size 2^( 4) =       0.000407913983
  error estimate for blocks of size 2^( 5) =       0.000412248929
  error estimate for blocks of size 2^( 6) =       0.000415296601
  error estimate for blocks of size 2^( 7) =       0.000416370788

      target function =      -0.900499030551
              le_mean =     -17.214300626191
             les_mean =     296.632807805036
             stat err =       0.000412957575
             autocorr =       1.184751772599
   target nu stat err =       0.000412957575
   target dn stat err =       0.002246598881
      target stat err =       0.002893451102
              std dev =       0.536545740523
             le_variance =       0.287881331673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721430062619e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900507678541       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900507678542       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900507678542       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900507678542       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900507678542       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900507678542       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900507678542       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900507678542       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900507678542       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900507678542       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 1.697718e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900507678541       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900507678542       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900507678542       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900507678542       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900507678542       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900507678542       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900507678542       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900507678542       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900507678542       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900507351080       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 4.244185e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900507678541       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900507678541       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900507678541       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900507678541       residual = 7.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900506238659       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900508002088       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900506096984       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900506031005       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900508620795       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900511032584       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+09 is 1.061683e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.591546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6174e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.191675
====================================================
  Execution time = 1.3681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9837e-01
  Total weights = 1.9572e+06
  Execution time = 1.8267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464734
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464734
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378701206
  error estimate for blocks of size 2^( 2) =       0.000389716343
  error estimate for blocks of size 2^( 3) =       0.000399869189
  error estimate for blocks of size 2^( 4) =       0.000407598396
  error estimate for blocks of size 2^( 5) =       0.000411500053
  error estimate for blocks of size 2^( 6) =       0.000413827855
  error estimate for blocks of size 2^( 7) =       0.000415526585

      target function =      -0.903495945402
              le_mean =     -17.214696638899
             les_mean =     296.644146651182
             stat err =       0.000412113222
             autocorr =       1.184239986489
   target nu stat err =       0.000412113222
   target dn stat err =       0.002076211161
      target stat err =       0.002702006018
              std dev =       0.535564381217
             le_variance =       0.286829206429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464733
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464733
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378701206
  error estimate for blocks of size 2^( 2) =       0.000389716343
  error estimate for blocks of size 2^( 3) =       0.000399869189
  error estimate for blocks of size 2^( 4) =       0.000407598396
  error estimate for blocks of size 2^( 5) =       0.000411500053
  error estimate for blocks of size 2^( 6) =       0.000413827855
  error estimate for blocks of size 2^( 7) =       0.000415526585

      target function =      -0.903495945404
              le_mean =     -17.214696638899
             les_mean =     296.644146651180
             stat err =       0.000412113222
             autocorr =       1.184239986498
   target nu stat err =       0.000412113222
   target dn stat err =       0.002076211161
      target stat err =       0.002702006018
              std dev =       0.535564381216
             le_variance =       0.286829206427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464733
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464733
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378701206
  error estimate for blocks of size 2^( 2) =       0.000389716343
  error estimate for blocks of size 2^( 3) =       0.000399869189
  error estimate for blocks of size 2^( 4) =       0.000407598396
  error estimate for blocks of size 2^( 5) =       0.000411500053
  error estimate for blocks of size 2^( 6) =       0.000413827855
  error estimate for blocks of size 2^( 7) =       0.000415526585

      target function =      -0.903495945403
              le_mean =     -17.214696638899
             les_mean =     296.644146651181
             stat err =       0.000412113222
             autocorr =       1.184239986493
   target nu stat err =       0.000412113222
   target dn stat err =       0.002076211161
      target stat err =       0.002702006018
              std dev =       0.535564381217
             le_variance =       0.286829206428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464734
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286808464734
                                         uncertainty =       0.001645160023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378701206
  error estimate for blocks of size 2^( 2) =       0.000389716343
  error estimate for blocks of size 2^( 3) =       0.000399869189
  error estimate for blocks of size 2^( 4) =       0.000407598396
  error estimate for blocks of size 2^( 5) =       0.000411500053
  error estimate for blocks of size 2^( 6) =       0.000413827855
  error estimate for blocks of size 2^( 7) =       0.000415526585

      target function =      -0.903495945402
              le_mean =     -17.214696638899
             les_mean =     296.644146651182
             stat err =       0.000412113222
             autocorr =       1.184239986485
   target nu stat err =       0.000412113222
   target dn stat err =       0.002076211161
      target stat err =       0.002702006018
              std dev =       0.535564381217
             le_variance =       0.286829206428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903495945402        initial
     9.0949e+07     9.0949e+08             1.6977e-12        -0.903495945404  <--
     3.6380e+08     3.6380e+09             4.2442e-13        -0.903495945403
     1.4552e+09     1.4552e+10             1.0617e-13        -0.903495945402

*****************************************************************************
Applying the update for shift_i =   9.0949e+07     and shift_s =   9.0949e+08
*****************************************************************************

  Execution time = 2.2932e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.175585
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0031e-01
  Total weights = 1.957468337e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286007442958
                                         uncertainty =       0.002069360747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286007442958
                                         uncertainty =       0.002069360747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378301395
  error estimate for blocks of size 2^( 2) =       0.000389643920
  error estimate for blocks of size 2^( 3) =       0.000399618878
  error estimate for blocks of size 2^( 4) =       0.000407336707
  error estimate for blocks of size 2^( 5) =       0.000411208282
  error estimate for blocks of size 2^( 6) =       0.000414386831
  error estimate for blocks of size 2^( 7) =       0.000418809885

      target function =      -0.901201484720
              le_mean =     -17.215487324350
             les_mean =     296.673309919951
             stat err =       0.000412935426
             autocorr =       1.191484509233
   target nu stat err =       0.000412935426
   target dn stat err =       0.003103877638
      target stat err =       0.003972794225
              std dev =       0.534998963623
             le_variance =       0.286223891078


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721548732435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+07, overlap shift 2.2737e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901218228423       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901218228425       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901218228425       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901218228425       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901218228364       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901218219458       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901218207560       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901218223662       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901218208935       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+07 is 7.243282e-12

solving harmonic davidson linear method for identity shift 9.0949e+07, overlap shift 9.0949e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901218228423       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901218228423       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901218228423       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901218228423       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901218222241       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901218228423       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901218152537       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901218158220       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901218380039       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+07 is 1.810823e-12

solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901218228423       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901218228423       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901218228423       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901218228423       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901218371402       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901218228423       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901218344430       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901218216738       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901218228423       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+08 is 4.527180e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.594523 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6305e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.1185
    reference variance = 0.288192
====================================================
  Execution time = 1.3533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0066e-01
  Total weights = 1.9577e+06
  Execution time = 1.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837535
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837535
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379528385
  error estimate for blocks of size 2^( 2) =       0.000390765159
  error estimate for blocks of size 2^( 3) =       0.000400967931
  error estimate for blocks of size 2^( 4) =       0.000408307806
  error estimate for blocks of size 2^( 5) =       0.000412251959
  error estimate for blocks of size 2^( 6) =       0.000414167277
  error estimate for blocks of size 2^( 7) =       0.000414048019

      target function =      -0.900644835146
              le_mean =     -17.214948482537
             les_mean =     296.655109196589
             stat err =       0.000412193765
             autocorr =       1.179544454053
   target nu stat err =       0.000412193765
   target dn stat err =       0.002426392438
      target stat err =       0.003120023479
              std dev =       0.536734188765
             le_variance =       0.288083589389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837532
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837532
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379528385
  error estimate for blocks of size 2^( 2) =       0.000390765159
  error estimate for blocks of size 2^( 3) =       0.000400967931
  error estimate for blocks of size 2^( 4) =       0.000408307806
  error estimate for blocks of size 2^( 5) =       0.000412251959
  error estimate for blocks of size 2^( 6) =       0.000414167277
  error estimate for blocks of size 2^( 7) =       0.000414048019

      target function =      -0.900644835128
              le_mean =     -17.214948482537
             les_mean =     296.655109196600
             stat err =       0.000412193765
             autocorr =       1.179544454071
   target nu stat err =       0.000412193765
   target dn stat err =       0.002426392438
      target stat err =       0.003120023479
              std dev =       0.536734188762
             le_variance =       0.288083589386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837533
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837533
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379528385
  error estimate for blocks of size 2^( 2) =       0.000390765159
  error estimate for blocks of size 2^( 3) =       0.000400967931
  error estimate for blocks of size 2^( 4) =       0.000408307806
  error estimate for blocks of size 2^( 5) =       0.000412251959
  error estimate for blocks of size 2^( 6) =       0.000414167277
  error estimate for blocks of size 2^( 7) =       0.000414048019

      target function =      -0.900644835137
              le_mean =     -17.214948482537
             les_mean =     296.655109196594
             stat err =       0.000412193765
             autocorr =       1.179544454059
   target nu stat err =       0.000412193765
   target dn stat err =       0.002426392438
      target stat err =       0.003120023479
              std dev =       0.536734188764
             le_variance =       0.288083589388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837535
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288037837535
                                         uncertainty =       0.001696773217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379528385
  error estimate for blocks of size 2^( 2) =       0.000390765159
  error estimate for blocks of size 2^( 3) =       0.000400967931
  error estimate for blocks of size 2^( 4) =       0.000408307806
  error estimate for blocks of size 2^( 5) =       0.000412251959
  error estimate for blocks of size 2^( 6) =       0.000414167277
  error estimate for blocks of size 2^( 7) =       0.000414048019

      target function =      -0.900644835145
              le_mean =     -17.214948482537
             les_mean =     296.655109196590
             stat err =       0.000412193765
             autocorr =       1.179544454060
   target nu stat err =       0.000412193765
   target dn stat err =       0.002426392438
      target stat err =       0.003120023479
              std dev =       0.536734188765
             le_variance =       0.288083589389


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900644835146        initial  <--
     2.2737e+07     2.2737e+08             7.2433e-12        -0.900644835128
     9.0949e+07     9.0949e+08             1.8108e-12        -0.900644835137
     3.6380e+08     3.6380e+09             4.5272e-13        -0.900644835145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8002
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2995
    reference variance = 0.195585
====================================================
  Execution time = 1.3950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9852e-01
  Total weights = 1.957501234e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590010441
                                         uncertainty =       0.001665572302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590010441
                                         uncertainty =       0.001665572302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377860427
  error estimate for blocks of size 2^( 2) =       0.000389342559
  error estimate for blocks of size 2^( 3) =       0.000399362844
  error estimate for blocks of size 2^( 4) =       0.000406770210
  error estimate for blocks of size 2^( 5) =       0.000410893568
  error estimate for blocks of size 2^( 6) =       0.000412811172
  error estimate for blocks of size 2^( 7) =       0.000414505500

      target function =      -0.903414153928
              le_mean =     -17.215223242157
             les_mean =     296.662431580481
             stat err =       0.000411245112
             autocorr =       1.184509849917
   target nu stat err =       0.000411245112
   target dn stat err =       0.002611403171
      target stat err =       0.003371575607
              std dev =       0.534375340826
             le_variance =       0.285557004883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721522324216e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903425968597       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903425968597       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903425968597       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903425968596       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903425943668       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903425959267       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903426087322       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903426038511       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903425904242       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903426223436       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 7.656723e-13

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903425968597       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903425968597       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903425968597       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903425968597       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903425968307       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903426638752       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903425039520       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903428239117       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903427189563       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903425784633       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 1.913890e-13

solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903425968597       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903425968597       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903425968597       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903425964050       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903427010003       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903426145227       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903419970859       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903416714894       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903429516176       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903430679076       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+09 is 4.785958e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.597894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6455e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.147
    reference variance = 0.316846
====================================================
  Execution time = 1.3765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.0425e-01
  Total weights = 1.9573e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380194156
  error estimate for blocks of size 2^( 2) =       0.000391503587
  error estimate for blocks of size 2^( 3) =       0.000401786469
  error estimate for blocks of size 2^( 4) =       0.000408369195
  error estimate for blocks of size 2^( 5) =       0.000412831134
  error estimate for blocks of size 2^( 6) =       0.000414890185
  error estimate for blocks of size 2^( 7) =       0.000417876022

      target function =      -0.896022132464
              le_mean =     -17.214460559397
             les_mean =     296.641901905116
             stat err =       0.000413491634
             autocorr =       1.182830680023
   target nu stat err =       0.000413491634
   target dn stat err =       0.002911936431
      target stat err =       0.003684480150
              std dev =       0.537675731725
             le_variance =       0.289095192486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380194156
  error estimate for blocks of size 2^( 2) =       0.000391503587
  error estimate for blocks of size 2^( 3) =       0.000401786469
  error estimate for blocks of size 2^( 4) =       0.000408369195
  error estimate for blocks of size 2^( 5) =       0.000412831134
  error estimate for blocks of size 2^( 6) =       0.000414890185
  error estimate for blocks of size 2^( 7) =       0.000417876022

      target function =      -0.896022132465
              le_mean =     -17.214460559397
             les_mean =     296.641901905115
             stat err =       0.000413491634
             autocorr =       1.182830680031
   target nu stat err =       0.000413491634
   target dn stat err =       0.002911936431
      target stat err =       0.003684480150
              std dev =       0.537675731725
             le_variance =       0.289095192486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380194156
  error estimate for blocks of size 2^( 2) =       0.000391503587
  error estimate for blocks of size 2^( 3) =       0.000401786469
  error estimate for blocks of size 2^( 4) =       0.000408369195
  error estimate for blocks of size 2^( 5) =       0.000412831134
  error estimate for blocks of size 2^( 6) =       0.000414890185
  error estimate for blocks of size 2^( 7) =       0.000417876022

      target function =      -0.896022132464
              le_mean =     -17.214460559397
             les_mean =     296.641901905116
             stat err =       0.000413491634
             autocorr =       1.182830680037
   target nu stat err =       0.000413491634
   target dn stat err =       0.002911936431
      target stat err =       0.003684480150
              std dev =       0.537675731725
             le_variance =       0.289095192486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289107841616
                                         uncertainty =       0.001791519695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380194156
  error estimate for blocks of size 2^( 2) =       0.000391503587
  error estimate for blocks of size 2^( 3) =       0.000401786469
  error estimate for blocks of size 2^( 4) =       0.000408369195
  error estimate for blocks of size 2^( 5) =       0.000412831134
  error estimate for blocks of size 2^( 6) =       0.000414890185
  error estimate for blocks of size 2^( 7) =       0.000417876022

      target function =      -0.896022132464
              le_mean =     -17.214460559397
             les_mean =     296.641901905116
             stat err =       0.000413491634
             autocorr =       1.182830680030
   target nu stat err =       0.000413491634
   target dn stat err =       0.002911936431
      target stat err =       0.003684480150
              std dev =       0.537675731725
             le_variance =       0.289095192486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896022132464        initial
     2.2737e+08     2.2737e+09             7.6567e-13        -0.896022132465  <--
     9.0949e+08     9.0949e+09             1.9139e-13        -0.896022132464
     3.6380e+09     3.6380e+10             4.7860e-14        -0.896022132464

*****************************************************************************
Applying the update for shift_i =   2.2737e+08     and shift_s =   2.2737e+09
*****************************************************************************

  Execution time = 2.3030e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2165
    reference variance = 0.177952
====================================================
  Execution time = 1.4162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9862e-01
  Total weights = 1.957526106e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287334882309
                                         uncertainty =       0.001590937918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287334882309
                                         uncertainty =       0.001590937918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378986811
  error estimate for blocks of size 2^( 2) =       0.000390098824
  error estimate for blocks of size 2^( 3) =       0.000399827539
  error estimate for blocks of size 2^( 4) =       0.000407684575
  error estimate for blocks of size 2^( 5) =       0.000411350228
  error estimate for blocks of size 2^( 6) =       0.000414617216
  error estimate for blocks of size 2^( 7) =       0.000414604563

      target function =      -0.903251563212
              le_mean =     -17.215065645766
             les_mean =     296.657109830995
             stat err =       0.000412064145
             autocorr =       1.182174159356
   target nu stat err =       0.000412064145
   target dn stat err =       0.001944801370
      target stat err =       0.002539217942
              std dev =       0.535968287592
             le_variance =       0.287262005304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721506564577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903257923806       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903257923806       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903257923807       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903257923801       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903257924814       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903258069754       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903257903942       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903257996719       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903258000972       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903257877513       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 3.224368e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903257923806       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903257923806       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903257923806       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903257930386       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903257964644       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903257943119       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903258313718       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903257648037       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903257832001       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903258199735       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 8.060473e-13

solving harmonic davidson linear method for identity shift 9.0949e+08, overlap shift 9.0949e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.903257923806       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.903257923806       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.903257923806       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.903257923805       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.903257758720       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.903258176018       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.903258001538       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.903258323937       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.903260333527       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.903257877040       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+08 is 2.015485e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.601596 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6653e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.317
    reference variance = 0.430654
====================================================
  Execution time = 1.3806e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9859e-01
  Total weights = 1.9577e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661199
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661199
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377434637
  error estimate for blocks of size 2^( 2) =       0.000388641931
  error estimate for blocks of size 2^( 3) =       0.000398455440
  error estimate for blocks of size 2^( 4) =       0.000406337139
  error estimate for blocks of size 2^( 5) =       0.000410332408
  error estimate for blocks of size 2^( 6) =       0.000413037197
  error estimate for blocks of size 2^( 7) =       0.000412201593

      target function =      -0.903202624940
              le_mean =     -17.214656721133
             les_mean =     296.642991209068
             stat err =       0.000410477084
             autocorr =       1.182753731570
   target nu stat err =       0.000410477084
   target dn stat err =       0.002783871363
      target stat err =       0.003582890890
              std dev =       0.533773183211
             le_variance =       0.284913811115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661198
                                         uncertainty =       0.001722808129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661198
                                         uncertainty =       0.001722808129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377434637
  error estimate for blocks of size 2^( 2) =       0.000388641931
  error estimate for blocks of size 2^( 3) =       0.000398455440
  error estimate for blocks of size 2^( 4) =       0.000406337139
  error estimate for blocks of size 2^( 5) =       0.000410332408
  error estimate for blocks of size 2^( 6) =       0.000413037197
  error estimate for blocks of size 2^( 7) =       0.000412201593

      target function =      -0.903202624941
              le_mean =     -17.214656721133
             les_mean =     296.642991209068
             stat err =       0.000410477084
             autocorr =       1.182753731577
   target nu stat err =       0.000410477084
   target dn stat err =       0.002783871363
      target stat err =       0.003582890890
              std dev =       0.533773183210
             le_variance =       0.284913811114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661198
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661198
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377434637
  error estimate for blocks of size 2^( 2) =       0.000388641931
  error estimate for blocks of size 2^( 3) =       0.000398455440
  error estimate for blocks of size 2^( 4) =       0.000406337139
  error estimate for blocks of size 2^( 5) =       0.000410332408
  error estimate for blocks of size 2^( 6) =       0.000413037197
  error estimate for blocks of size 2^( 7) =       0.000412201593

      target function =      -0.903202624941
              le_mean =     -17.214656721133
             les_mean =     296.642991209068
             stat err =       0.000410477084
             autocorr =       1.182753731572
   target nu stat err =       0.000410477084
   target dn stat err =       0.002783871363
      target stat err =       0.003582890890
              std dev =       0.533773183210
             le_variance =       0.284913811114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661199
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284952661199
                                         uncertainty =       0.001722808130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377434637
  error estimate for blocks of size 2^( 2) =       0.000388641931
  error estimate for blocks of size 2^( 3) =       0.000398455440
  error estimate for blocks of size 2^( 4) =       0.000406337139
  error estimate for blocks of size 2^( 5) =       0.000410332408
  error estimate for blocks of size 2^( 6) =       0.000413037197
  error estimate for blocks of size 2^( 7) =       0.000412201593

      target function =      -0.903202624940
              le_mean =     -17.214656721133
             les_mean =     296.642991209068
             stat err =       0.000410477084
             autocorr =       1.182753731565
   target nu stat err =       0.000410477084
   target dn stat err =       0.002783871363
      target stat err =       0.003582890890
              std dev =       0.533773183211
             le_variance =       0.284913811115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903202624940        initial
     5.6843e+07     5.6843e+08             3.2244e-12        -0.903202624941  <--
     2.2737e+08     2.2737e+09             8.0605e-13        -0.903202624941
     9.0949e+08     9.0949e+09             2.0155e-13        -0.903202624940

*****************************************************************************
Applying the update for shift_i =   5.6843e+07     and shift_s =   5.6843e+08
*****************************************************************************

  Execution time = 2.3225e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2617
    reference variance = 0.300456
====================================================
  Execution time = 1.4233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9760e-01
  Total weights = 1.957293569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284946596863
                                         uncertainty =       0.001796666074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284946596863
                                         uncertainty =       0.001796666074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377413808
  error estimate for blocks of size 2^( 2) =       0.000388349269
  error estimate for blocks of size 2^( 3) =       0.000398733142
  error estimate for blocks of size 2^( 4) =       0.000405851765
  error estimate for blocks of size 2^( 5) =       0.000410013922
  error estimate for blocks of size 2^( 6) =       0.000413826327
  error estimate for blocks of size 2^( 7) =       0.000415062714

      target function =      -0.904551995324
              le_mean =     -17.215058961236
             les_mean =     296.655854647351
             stat err =       0.000411188682
             autocorr =       1.186989108733
   target nu stat err =       0.000411188682
   target dn stat err =       0.002311414498
      target stat err =       0.003003018539
              std dev =       0.533743725868
             le_variance =       0.284882364904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721505896124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+07, overlap shift 1.4211e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904561258508       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904561258513       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904561258513       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904561256614       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904561257979       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904561258403       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904561246572       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904561250934       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904561279550       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904561283919       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+07 is 9.430867e-12

solving harmonic davidson linear method for identity shift 5.6843e+07, overlap shift 5.6843e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904561258508       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904561258509       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904561258509       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904561258509       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904561258454       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904561165922       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904561252592       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904561185407       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904561268684       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904561210567       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+07 is 2.357710e-12

solving harmonic davidson linear method for identity shift 2.2737e+08, overlap shift 2.2737e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904561258508       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904561258508       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904561258508       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904561258509       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904561258506       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904561326363       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904561404641       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904561325675       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904561469517       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904561016996       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+08 is 5.894266e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.605112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6790e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.19257
====================================================
  Execution time = 1.3771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0014e-01
  Total weights = 1.9574e+06
  Execution time = 1.8327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624784
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624784
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379188312
  error estimate for blocks of size 2^( 2) =       0.000390297793
  error estimate for blocks of size 2^( 3) =       0.000400643781
  error estimate for blocks of size 2^( 4) =       0.000407580841
  error estimate for blocks of size 2^( 5) =       0.000413511103
  error estimate for blocks of size 2^( 6) =       0.000414637188
  error estimate for blocks of size 2^( 7) =       0.000416552408

      target function =      -0.901373633605
              le_mean =     -17.215284777586
             les_mean =     296.666171270513
             stat err =       0.000413070385
             autocorr =       1.186692601122
   target nu stat err =       0.000413070385
   target dn stat err =       0.002269344310
      target stat err =       0.002931667442
              std dev =       0.536253253440
             le_variance =       0.287567551824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624780
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624780
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379188312
  error estimate for blocks of size 2^( 2) =       0.000390297793
  error estimate for blocks of size 2^( 3) =       0.000400643781
  error estimate for blocks of size 2^( 4) =       0.000407580841
  error estimate for blocks of size 2^( 5) =       0.000413511103
  error estimate for blocks of size 2^( 6) =       0.000414637188
  error estimate for blocks of size 2^( 7) =       0.000416552408

      target function =      -0.901373633600
              le_mean =     -17.215284777586
             les_mean =     296.666171270522
             stat err =       0.000413070385
             autocorr =       1.186692601150
   target nu stat err =       0.000413070385
   target dn stat err =       0.002269344311
      target stat err =       0.002931667443
              std dev =       0.536253253435
             le_variance =       0.287567551820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624782
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624782
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379188312
  error estimate for blocks of size 2^( 2) =       0.000390297793
  error estimate for blocks of size 2^( 3) =       0.000400643781
  error estimate for blocks of size 2^( 4) =       0.000407580841
  error estimate for blocks of size 2^( 5) =       0.000413511103
  error estimate for blocks of size 2^( 6) =       0.000414637188
  error estimate for blocks of size 2^( 7) =       0.000416552408

      target function =      -0.901373633602
              le_mean =     -17.215284777586
             les_mean =     296.666171270517
             stat err =       0.000413070385
             autocorr =       1.186692601140
   target nu stat err =       0.000413070385
   target dn stat err =       0.002269344311
      target stat err =       0.002931667442
              std dev =       0.536253253437
             le_variance =       0.287567551822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624784
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287498624784
                                         uncertainty =       0.001820307494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379188312
  error estimate for blocks of size 2^( 2) =       0.000390297793
  error estimate for blocks of size 2^( 3) =       0.000400643781
  error estimate for blocks of size 2^( 4) =       0.000407580841
  error estimate for blocks of size 2^( 5) =       0.000413511103
  error estimate for blocks of size 2^( 6) =       0.000414637188
  error estimate for blocks of size 2^( 7) =       0.000416552408

      target function =      -0.901373633605
              le_mean =     -17.215284777586
             les_mean =     296.666171270513
             stat err =       0.000413070385
             autocorr =       1.186692601122
   target nu stat err =       0.000413070385
   target dn stat err =       0.002269344310
      target stat err =       0.002931667442
              std dev =       0.536253253439
             le_variance =       0.287567551824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901373633605        initial  <--
     1.4211e+07     1.4211e+08             9.4309e-12        -0.901373633600
     5.6843e+07     5.6843e+08             2.3577e-12        -0.901373633602
     2.2737e+08     2.2737e+09             5.8943e-13        -0.901373633605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0520
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2724
    reference variance = 0.274938
====================================================
  Execution time = 1.4310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0202e-01
  Total weights = 1.957457458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286988859884
                                         uncertainty =       0.001558026382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286988859884
                                         uncertainty =       0.001558026382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378822126
  error estimate for blocks of size 2^( 2) =       0.000389764830
  error estimate for blocks of size 2^( 3) =       0.000399859040
  error estimate for blocks of size 2^( 4) =       0.000407848495
  error estimate for blocks of size 2^( 5) =       0.000413009141
  error estimate for blocks of size 2^( 6) =       0.000414088742
  error estimate for blocks of size 2^( 7) =       0.000418114875

      target function =      -0.898921741849
              le_mean =     -17.214937067099
             les_mean =     296.656075572593
             stat err =       0.000413265313
             autocorr =       1.190110361315
   target nu stat err =       0.000413265313
   target dn stat err =       0.003065795720
      target stat err =       0.003902199874
              std dev =       0.535735387925
             le_variance =       0.287012405875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721493706710e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898938034404       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898938034404       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898938034405       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898938034405       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898938034630       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898938048412       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898938028653       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898938174928       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898938039061       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898938295180       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 1.007994e-12

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898938034404       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898938034404       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898938034404       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898938034404       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898938034390       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898938035757       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898938449870       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898938932827       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898939129545       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898937604846       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+08 is 2.519950e-13

solving harmonic davidson linear method for identity shift 2.2737e+09, overlap shift 2.2737e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898938034404       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898938034404       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898938034404       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898938034404       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898938034404       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898938025275       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898936111855       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898939745506       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898937464505       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898940296285       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898934406464       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+09 is 6.301554e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.608786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6857e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2564
    reference variance = 0.187807
====================================================
  Execution time = 1.3453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9784e-01
  Total weights = 1.9575e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377715564
  error estimate for blocks of size 2^( 2) =       0.000388941778
  error estimate for blocks of size 2^( 3) =       0.000398735996
  error estimate for blocks of size 2^( 4) =       0.000405927629
  error estimate for blocks of size 2^( 5) =       0.000410686123
  error estimate for blocks of size 2^( 6) =       0.000412778823
  error estimate for blocks of size 2^( 7) =       0.000413447569

      target function =      -0.904270344465
              le_mean =     -17.215161961180
             les_mean =     296.659640425822
             stat err =       0.000410710036
             autocorr =       1.182335877725
   target nu stat err =       0.000410710036
   target dn stat err =       0.002282991338
      target stat err =       0.002966005364
              std dev =       0.534170473879
             le_variance =       0.285338095164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766949
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766949
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377715564
  error estimate for blocks of size 2^( 2) =       0.000388941778
  error estimate for blocks of size 2^( 3) =       0.000398735996
  error estimate for blocks of size 2^( 4) =       0.000405927629
  error estimate for blocks of size 2^( 5) =       0.000410686123
  error estimate for blocks of size 2^( 6) =       0.000412778823
  error estimate for blocks of size 2^( 7) =       0.000413447569

      target function =      -0.904270344466
              le_mean =     -17.215161961180
             les_mean =     296.659640425821
             stat err =       0.000410710036
             autocorr =       1.182335877728
   target nu stat err =       0.000410710036
   target dn stat err =       0.002282991338
      target stat err =       0.002966005365
              std dev =       0.534170473879
             le_variance =       0.285338095164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377715564
  error estimate for blocks of size 2^( 2) =       0.000388941778
  error estimate for blocks of size 2^( 3) =       0.000398735996
  error estimate for blocks of size 2^( 4) =       0.000405927629
  error estimate for blocks of size 2^( 5) =       0.000410686123
  error estimate for blocks of size 2^( 6) =       0.000412778823
  error estimate for blocks of size 2^( 7) =       0.000413447569

      target function =      -0.904270344465
              le_mean =     -17.215161961180
             les_mean =     296.659640425822
             stat err =       0.000410710036
             autocorr =       1.182335877729
   target nu stat err =       0.000410710036
   target dn stat err =       0.002282991338
      target stat err =       0.002966005365
              std dev =       0.534170473879
             le_variance =       0.285338095164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285364766950
                                         uncertainty =       0.001771189431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377715564
  error estimate for blocks of size 2^( 2) =       0.000388941778
  error estimate for blocks of size 2^( 3) =       0.000398735996
  error estimate for blocks of size 2^( 4) =       0.000405927629
  error estimate for blocks of size 2^( 5) =       0.000410686123
  error estimate for blocks of size 2^( 6) =       0.000412778823
  error estimate for blocks of size 2^( 7) =       0.000413447569

      target function =      -0.904270344465
              le_mean =     -17.215161961180
             les_mean =     296.659640425822
             stat err =       0.000410710036
             autocorr =       1.182335877721
   target nu stat err =       0.000410710036
   target dn stat err =       0.002282991338
      target stat err =       0.002966005364
              std dev =       0.534170473879
             le_variance =       0.285338095164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904270344465        initial
     1.4211e+08     1.4211e+09             1.0080e-12        -0.904270344466  <--
     5.6843e+08     5.6843e+09             2.5199e-13        -0.904270344465
     2.2737e+09     2.2737e+10             6.3016e-14        -0.904270344465

*****************************************************************************
Applying the update for shift_i =   1.4211e+08     and shift_s =   1.4211e+09
*****************************************************************************

  Execution time = 2.2749e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.194866
====================================================
  Execution time = 1.4102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9963e-01
  Total weights = 1.957461666e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286733647310
                                         uncertainty =       0.001612824942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286733647310
                                         uncertainty =       0.001612824942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378676720
  error estimate for blocks of size 2^( 2) =       0.000389986311
  error estimate for blocks of size 2^( 3) =       0.000400385171
  error estimate for blocks of size 2^( 4) =       0.000407464685
  error estimate for blocks of size 2^( 5) =       0.000411230599
  error estimate for blocks of size 2^( 6) =       0.000412422793
  error estimate for blocks of size 2^( 7) =       0.000411370640

      target function =      -0.901851874492
              le_mean =     -17.214500617940
             les_mean =     296.638657868692
             stat err =       0.000410622179
             autocorr =       1.175838276417
   target nu stat err =       0.000410622179
   target dn stat err =       0.002279651736
      target stat err =       0.002943254543
              std dev =       0.535529753218
             le_variance =       0.286792116582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721450061794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+07, overlap shift 3.5527e+08 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901860778383       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901860778385       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901860778385       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901860778385       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901860778385       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901860778385       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901860778385       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901860778385       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901860778385       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901860778385       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+07 is 5.821424e-12

solving harmonic davidson linear method for identity shift 1.4211e+08, overlap shift 1.4211e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901860778383       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901860778383       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901860778383       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901860778383       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901860778383       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901860778383       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901860778383       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901860778383       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901860987961       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901860778383       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+08 is 1.455351e-12

solving harmonic davidson linear method for identity shift 5.6843e+08, overlap shift 5.6843e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901860778383       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901860778383       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901860778383       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901860778383       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901860778383       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901860936577       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901859908347       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901860778383       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901861908048       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901860446515       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+08 is 3.638210e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.612259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6594e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.329799
====================================================
  Execution time = 1.3868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9774e-01
  Total weights = 1.9576e+06
  Execution time = 1.8291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962069
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962069
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378614924
  error estimate for blocks of size 2^( 2) =       0.000389721177
  error estimate for blocks of size 2^( 3) =       0.000399410382
  error estimate for blocks of size 2^( 4) =       0.000406930921
  error estimate for blocks of size 2^( 5) =       0.000411101483
  error estimate for blocks of size 2^( 6) =       0.000414434591
  error estimate for blocks of size 2^( 7) =       0.000413578556

      target function =      -0.904353791738
              le_mean =     -17.214994694875
             les_mean =     296.653786719384
             stat err =       0.000411511388
             autocorr =       1.181321908948
   target nu stat err =       0.000411511388
   target dn stat err =       0.002205729445
      target stat err =       0.002869511217
              std dev =       0.535442360592
             le_variance =       0.286698521516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962067
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962067
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378614924
  error estimate for blocks of size 2^( 2) =       0.000389721177
  error estimate for blocks of size 2^( 3) =       0.000399410382
  error estimate for blocks of size 2^( 4) =       0.000406930921
  error estimate for blocks of size 2^( 5) =       0.000411101483
  error estimate for blocks of size 2^( 6) =       0.000414434591
  error estimate for blocks of size 2^( 7) =       0.000413578556

      target function =      -0.904353791727
              le_mean =     -17.214994694875
             les_mean =     296.653786719392
             stat err =       0.000411511388
             autocorr =       1.181321908953
   target nu stat err =       0.000411511388
   target dn stat err =       0.002205729448
      target stat err =       0.002869511220
              std dev =       0.535442360590
             le_variance =       0.286698521515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962068
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962068
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378614924
  error estimate for blocks of size 2^( 2) =       0.000389721177
  error estimate for blocks of size 2^( 3) =       0.000399410382
  error estimate for blocks of size 2^( 4) =       0.000406930921
  error estimate for blocks of size 2^( 5) =       0.000411101483
  error estimate for blocks of size 2^( 6) =       0.000414434591
  error estimate for blocks of size 2^( 7) =       0.000413578556

      target function =      -0.904353791733
              le_mean =     -17.214994694875
             les_mean =     296.653786719388
             stat err =       0.000411511388
             autocorr =       1.181321908947
   target nu stat err =       0.000411511388
   target dn stat err =       0.002205729446
      target stat err =       0.002869511218
              std dev =       0.535442360591
             le_variance =       0.286698521515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962069
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286692962069
                                         uncertainty =       0.001774511837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378614924
  error estimate for blocks of size 2^( 2) =       0.000389721177
  error estimate for blocks of size 2^( 3) =       0.000399410382
  error estimate for blocks of size 2^( 4) =       0.000406930921
  error estimate for blocks of size 2^( 5) =       0.000411101483
  error estimate for blocks of size 2^( 6) =       0.000414434591
  error estimate for blocks of size 2^( 7) =       0.000413578556

      target function =      -0.904353791737
              le_mean =     -17.214994694875
             les_mean =     296.653786719384
             stat err =       0.000411511388
             autocorr =       1.181321908950
   target nu stat err =       0.000411511388
   target dn stat err =       0.002205729445
      target stat err =       0.002869511217
              std dev =       0.535442360592
             le_variance =       0.286698521516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904353791738        initial  <--
     3.5527e+07     3.5527e+08             5.8214e-12        -0.904353791727
     1.4211e+08     1.4211e+09             1.4554e-12        -0.904353791733
     5.6843e+08     5.6843e+09             3.6382e-13        -0.904353791737

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1440
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2713
    reference variance = 0.24009
====================================================
  Execution time = 1.5541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9957e-01
  Total weights = 1.957221808e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285822477503
                                         uncertainty =       0.001628354959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285822477503
                                         uncertainty =       0.001628354959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378052421
  error estimate for blocks of size 2^( 2) =       0.000388969131
  error estimate for blocks of size 2^( 3) =       0.000399523157
  error estimate for blocks of size 2^( 4) =       0.000406556725
  error estimate for blocks of size 2^( 5) =       0.000411149844
  error estimate for blocks of size 2^( 6) =       0.000414258525
  error estimate for blocks of size 2^( 7) =       0.000416129754

      target function =      -0.901979760713
              le_mean =     -17.214788468439
             les_mean =     296.648516543788
             stat err =       0.000412023712
             autocorr =       1.187791941111
   target nu stat err =       0.000412023712
   target dn stat err =       0.002501239338
      target stat err =       0.003221541517
              std dev =       0.534646860656
             le_variance =       0.285847265610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721478846844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901990490521       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901990490521       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901990490521       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901990490521       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901990490521       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901990680022       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901990490521       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901990903957       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901990490521       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901990374793       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+08 is 5.476771e-13

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901990490521       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901990490521       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901990490521       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901990176841       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901990490521       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901990827643       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901990820648       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901989807772       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901990651686       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901991480549       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+09 is 1.369316e-13

solving harmonic davidson linear method for identity shift 5.6843e+09, overlap shift 5.6843e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901990490521       residual = 9.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901990490521       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901990490521       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901990490523       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901990505528       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901992268182       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901997652743       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901985540103       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901993341417       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901990704888       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901978647628       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901997127672       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+09 is 3.425590e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.616167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8273e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2234
    reference variance = 0.736893
====================================================
  Execution time = 1.3576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0035e-01
  Total weights = 1.9573e+06
  Execution time = 1.8300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379190525
  error estimate for blocks of size 2^( 2) =       0.000390358323
  error estimate for blocks of size 2^( 3) =       0.000400338516
  error estimate for blocks of size 2^( 4) =       0.000406848914
  error estimate for blocks of size 2^( 5) =       0.000411378014
  error estimate for blocks of size 2^( 6) =       0.000412820218
  error estimate for blocks of size 2^( 7) =       0.000411465844

      target function =      -0.901011474791
              le_mean =     -17.214847540240
             les_mean =     296.651328324192
             stat err =       0.000410628248
             autocorr =       1.172688565696
   target nu stat err =       0.000410628248
   target dn stat err =       0.002110495422
      target stat err =       0.002730049569
              std dev =       0.536256382626
             le_variance =       0.287570907907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379190525
  error estimate for blocks of size 2^( 2) =       0.000390358323
  error estimate for blocks of size 2^( 3) =       0.000400338516
  error estimate for blocks of size 2^( 4) =       0.000406848914
  error estimate for blocks of size 2^( 5) =       0.000411378014
  error estimate for blocks of size 2^( 6) =       0.000412820218
  error estimate for blocks of size 2^( 7) =       0.000411465844

      target function =      -0.901011474790
              le_mean =     -17.214847540240
             les_mean =     296.651328324192
             stat err =       0.000410628248
             autocorr =       1.172688565697
   target nu stat err =       0.000410628248
   target dn stat err =       0.002110495422
      target stat err =       0.002730049569
              std dev =       0.536256382626
             le_variance =       0.287570907907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379190525
  error estimate for blocks of size 2^( 2) =       0.000390358323
  error estimate for blocks of size 2^( 3) =       0.000400338516
  error estimate for blocks of size 2^( 4) =       0.000406848914
  error estimate for blocks of size 2^( 5) =       0.000411378014
  error estimate for blocks of size 2^( 6) =       0.000412820218
  error estimate for blocks of size 2^( 7) =       0.000411465844

      target function =      -0.901011474790
              le_mean =     -17.214847540240
             les_mean =     296.651328324192
             stat err =       0.000410628248
             autocorr =       1.172688565700
   target nu stat err =       0.000410628248
   target dn stat err =       0.002110495422
      target stat err =       0.002730049569
              std dev =       0.536256382626
             le_variance =       0.287570907907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287638377147
                                         uncertainty =       0.001619854985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379190525
  error estimate for blocks of size 2^( 2) =       0.000390358323
  error estimate for blocks of size 2^( 3) =       0.000400338516
  error estimate for blocks of size 2^( 4) =       0.000406848914
  error estimate for blocks of size 2^( 5) =       0.000411378014
  error estimate for blocks of size 2^( 6) =       0.000412820218
  error estimate for blocks of size 2^( 7) =       0.000411465844

      target function =      -0.901011474791
              le_mean =     -17.214847540240
             les_mean =     296.651328324192
             stat err =       0.000410628248
             autocorr =       1.172688565700
   target nu stat err =       0.000410628248
   target dn stat err =       0.002110495422
      target stat err =       0.002730049569
              std dev =       0.536256382626
             le_variance =       0.287570907907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901011474791        initial  <--
     3.5527e+08     3.5527e+09             5.4768e-13        -0.901011474790
     1.4211e+09     1.4211e+10             1.3693e-13        -0.901011474790
     5.6843e+09     5.6843e+10             3.4256e-14        -0.901011474791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9537
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2718
    reference variance = 0.236273
====================================================
  Execution time = 1.4024e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9785e-01
  Total weights = 1.957342567e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285817181200
                                         uncertainty =       0.001623061301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285817181200
                                         uncertainty =       0.001623061301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378000536
  error estimate for blocks of size 2^( 2) =       0.000389546912
  error estimate for blocks of size 2^( 3) =       0.000399341039
  error estimate for blocks of size 2^( 4) =       0.000406603982
  error estimate for blocks of size 2^( 5) =       0.000410944301
  error estimate for blocks of size 2^( 6) =       0.000412583885
  error estimate for blocks of size 2^( 7) =       0.000415591504

      target function =      -0.904245176294
              le_mean =     -17.215124439136
             les_mean =     296.658362713621
             stat err =       0.000411430918
             autocorr =       1.184701714814
   target nu stat err =       0.000411430918
   target dn stat err =       0.002114662626
      target stat err =       0.002755858726
              std dev =       0.534573485127
             le_variance =       0.285768811001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721512443914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904252845656       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904252845656       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904252845656       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904252845654       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904250480510       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904250095819       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904257925331       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904259426277       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904253662631       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904257191702       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 4.997821e-14

solving harmonic davidson linear method for identity shift 1.4211e+10, overlap shift 1.4211e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904252845656       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904252845656       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904252845656       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904252845625       residual = 8.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904254384092       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904257235803       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904242410208       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904254583640       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904217922813       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904252845656       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904267907227       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904246092241       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904246967636       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904250132228       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904219635395       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904252104037       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904244711591       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904256441486       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904303321733       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904285334106       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904252669671       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904253504269       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904273035688       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904251297932       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904244000004       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904275529862       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904238582787       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904250898836       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904251797251       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904245716108       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904236844027       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904242021227       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904255349119       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904234917283       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904255553265       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904258332666       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904255064110       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904250761522       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904260613677       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.904257105892       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904246913801       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904262621395       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904261343923       residual = 9.06e-07           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904246365231       residual = 2.40e-08           smallest_sin_value = 9.97e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904266308546       residual = 1.96e-07           smallest_sin_value = 9.93e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904229281413       residual = 2.23e-08           smallest_sin_value = 9.92e-01
davidson iteration   46 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         46 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+10 is 1.250220e-14

solving harmonic davidson linear method for identity shift 5.6843e+10, overlap shift 5.6843e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904252845656       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.904252845656       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.904252845656       residual = 5.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.904256098363       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.904234972248       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.904252845656       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.904299597011       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.904353058470       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.904151875418       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.904389528573       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.904280458508       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.904374739491       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.904206908519       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.904178076701       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.904323896819       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.904032198876       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.904325182701       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.904319948377       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.904293585991       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.904198021546       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.904289746501       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.904212004750       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.904210388197       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.904276330966       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.904294351631       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.904299659467       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.904262486950       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.904197187351       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.904342354123       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.904236896729       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.904279486099       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.904195031432       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.904246815099       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.904298901075       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.904274473483       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.904217338673       residual = 8.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904207190430       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.904230034944       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.904353627799       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.904252129078       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904421085670       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.904307996313       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.904265411168       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.904316074118       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.904275834940       residual = 1.06e-06           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.904247294825       residual = 3.95e-06           smallest_sin_value = 9.98e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.904231013256       residual = 5.81e-07           smallest_sin_value = 9.98e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+10 is 3.147166e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.708779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6627e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.1955
    reference variance = 0.162997
====================================================
  Execution time = 1.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0529e-01
  Total weights = 1.9574e+06
  Execution time = 1.8366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380100641
  error estimate for blocks of size 2^( 2) =       0.000391340158
  error estimate for blocks of size 2^( 3) =       0.000401170419
  error estimate for blocks of size 2^( 4) =       0.000408857298
  error estimate for blocks of size 2^( 5) =       0.000413413810
  error estimate for blocks of size 2^( 6) =       0.000416864023
  error estimate for blocks of size 2^( 7) =       0.000418074137

      target function =      -0.894761579438
              le_mean =     -17.214682153676
             les_mean =     296.650574827083
             stat err =       0.000414302317
             autocorr =       1.188057663390
   target nu stat err =       0.000414302317
   target dn stat err =       0.003332256496
      target stat err =       0.004193999426
              std dev =       0.537543481653
             le_variance =       0.288952994668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380100641
  error estimate for blocks of size 2^( 2) =       0.000391340158
  error estimate for blocks of size 2^( 3) =       0.000401170419
  error estimate for blocks of size 2^( 4) =       0.000408857298
  error estimate for blocks of size 2^( 5) =       0.000413413810
  error estimate for blocks of size 2^( 6) =       0.000416864023
  error estimate for blocks of size 2^( 7) =       0.000418074137

      target function =      -0.894761579438
              le_mean =     -17.214682153676
             les_mean =     296.650574827082
             stat err =       0.000414302317
             autocorr =       1.188057663390
   target nu stat err =       0.000414302317
   target dn stat err =       0.003332256496
      target stat err =       0.004193999426
              std dev =       0.537543481653
             le_variance =       0.288952994668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380100641
  error estimate for blocks of size 2^( 2) =       0.000391340158
  error estimate for blocks of size 2^( 3) =       0.000401170419
  error estimate for blocks of size 2^( 4) =       0.000408857298
  error estimate for blocks of size 2^( 5) =       0.000413413810
  error estimate for blocks of size 2^( 6) =       0.000416864023
  error estimate for blocks of size 2^( 7) =       0.000418074137

      target function =      -0.894761579438
              le_mean =     -17.214682153676
             les_mean =     296.650574827082
             stat err =       0.000414302317
             autocorr =       1.188057663389
   target nu stat err =       0.000414302317
   target dn stat err =       0.003332256496
      target stat err =       0.004193999426
              std dev =       0.537543481653
             le_variance =       0.288952994668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288990415636
                                         uncertainty =       0.001578566315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380100641
  error estimate for blocks of size 2^( 2) =       0.000391340158
  error estimate for blocks of size 2^( 3) =       0.000401170419
  error estimate for blocks of size 2^( 4) =       0.000408857298
  error estimate for blocks of size 2^( 5) =       0.000413413810
  error estimate for blocks of size 2^( 6) =       0.000416864023
  error estimate for blocks of size 2^( 7) =       0.000418074137

      target function =      -0.894761579438
              le_mean =     -17.214682153676
             les_mean =     296.650574827083
             stat err =       0.000414302317
             autocorr =       1.188057663394
   target nu stat err =       0.000414302317
   target dn stat err =       0.003332256496
      target stat err =       0.004193999426
              std dev =       0.537543481653
             le_variance =       0.288952994668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894761579438        initial
     3.5527e+09     3.5527e+10             4.9978e-14        -0.894761579438  <--
     1.4211e+10     1.4211e+11             1.2502e-14        -0.894761579438
     5.6843e+10     5.6843e+11             3.1472e-15        -0.894761579438

*****************************************************************************
Applying the update for shift_i =   3.5527e+09     and shift_s =   3.5527e+10
*****************************************************************************

  Execution time = 2.2836e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9501e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2985
    reference variance = 1.34686
====================================================
  Execution time = 1.3715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 2.9912e-01
  Total weights = 1.957738000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286049541059
                                         uncertainty =       0.002019673992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286049541059
                                         uncertainty =       0.002019673992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378198913
  error estimate for blocks of size 2^( 2) =       0.000389148343
  error estimate for blocks of size 2^( 3) =       0.000399036738
  error estimate for blocks of size 2^( 4) =       0.000406237233
  error estimate for blocks of size 2^( 5) =       0.000409989208
  error estimate for blocks of size 2^( 6) =       0.000413085227
  error estimate for blocks of size 2^( 7) =       0.000414685331

      target function =      -0.902539754564
              le_mean =     -17.214714837029
             les_mean =     296.645525149040
             stat err =       0.000410999250
             autocorr =       1.180977177996
   target nu stat err =       0.000410999250
   target dn stat err =       0.002705887209
      target stat err =       0.003480556284
              std dev =       0.534854032120
             le_variance =       0.286068835675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721471483703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902552541048       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902552541048       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902552541048       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902552541048       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902552603702       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902552541048       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902552064591       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902552541048       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902551724550       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902552342170       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+08 is 1.804066e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902552541048       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902552541048       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902552541048       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902552541048       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902554566858       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902551547587       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902544177692       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902546860956       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902556743196       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902556002704       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+09 is 4.513302e-14

solving harmonic davidson linear method for identity shift 1.4211e+10, overlap shift 1.4211e+11 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902552541048       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902552541048       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902552541048       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902552541048       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902553265641       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902565776635       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902569018344       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902570915855       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902510631766       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902536619954       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902571609127       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902540119157       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.902561575233       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902558024352       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.902554587155       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.902552146281       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.902577966001       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.902551163458       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.902550279542       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.902550632533       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.902551160331       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.902552597200       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.902553220210       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.902553097989       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.902554880885       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.902555174251       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.902551399987       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.902553414891       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.902550099528       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.902555143671       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902555236119       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.902553798306       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.902550438664       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.902547597254       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.902549888782       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.902541399588       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.902549519382       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.902550464607       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.902550369751       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.902551867267       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.902552661226       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.902551464408       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -0.902553330002       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   tar_fn =      -0.902554159926       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   tar_fn =      -0.902550195466       residual = 8.43e-08           smallest_sin_value = 9.99e-01
davidson iteration   45:   krylov dim =  46   tar_fn =      -0.902551278298       residual = 8.26e-08           smallest_sin_value = 9.99e-01
davidson iteration   46:   krylov dim =  47   tar_fn =      -0.902558659329       residual = 6.91e-07           smallest_sin_value = 9.96e-01
davidson iteration   47 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         47 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+10 is 1.125459e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.754579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6245e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1542
    reference variance = 0.424872
====================================================
  Execution time = 1.3683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0075e-01
  Total weights = 1.9574e+06
  Execution time = 1.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378405642
  error estimate for blocks of size 2^( 2) =       0.000389669420
  error estimate for blocks of size 2^( 3) =       0.000399456666
  error estimate for blocks of size 2^( 4) =       0.000406726461
  error estimate for blocks of size 2^( 5) =       0.000411268878
  error estimate for blocks of size 2^( 6) =       0.000412729523
  error estimate for blocks of size 2^( 7) =       0.000414257655

      target function =      -0.900688064997
              le_mean =     -17.215674923917
             les_mean =     296.680208078056
             stat err =       0.000411245629
             autocorr =       1.181101942754
   target nu stat err =       0.000411245629
   target dn stat err =       0.003004616080
      target stat err =       0.003844927175
              std dev =       0.535146391300
             le_variance =       0.286381660121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378405642
  error estimate for blocks of size 2^( 2) =       0.000389669420
  error estimate for blocks of size 2^( 3) =       0.000399456666
  error estimate for blocks of size 2^( 4) =       0.000406726461
  error estimate for blocks of size 2^( 5) =       0.000411268878
  error estimate for blocks of size 2^( 6) =       0.000412729523
  error estimate for blocks of size 2^( 7) =       0.000414257655

      target function =      -0.900688064998
              le_mean =     -17.215674923917
             les_mean =     296.680208078055
             stat err =       0.000411245629
             autocorr =       1.181101942750
   target nu stat err =       0.000411245629
   target dn stat err =       0.003004616080
      target stat err =       0.003844927175
              std dev =       0.535146391300
             le_variance =       0.286381660121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378405642
  error estimate for blocks of size 2^( 2) =       0.000389669420
  error estimate for blocks of size 2^( 3) =       0.000399456666
  error estimate for blocks of size 2^( 4) =       0.000406726461
  error estimate for blocks of size 2^( 5) =       0.000411268878
  error estimate for blocks of size 2^( 6) =       0.000412729523
  error estimate for blocks of size 2^( 7) =       0.000414257655

      target function =      -0.900688064997
              le_mean =     -17.215674923917
             les_mean =     296.680208078056
             stat err =       0.000411245629
             autocorr =       1.181101942757
   target nu stat err =       0.000411245629
   target dn stat err =       0.003004616080
      target stat err =       0.003844927175
              std dev =       0.535146391300
             le_variance =       0.286381660121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286468544469
                                         uncertainty =       0.001812957151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378405642
  error estimate for blocks of size 2^( 2) =       0.000389669420
  error estimate for blocks of size 2^( 3) =       0.000399456666
  error estimate for blocks of size 2^( 4) =       0.000406726461
  error estimate for blocks of size 2^( 5) =       0.000411268878
  error estimate for blocks of size 2^( 6) =       0.000412729523
  error estimate for blocks of size 2^( 7) =       0.000414257655

      target function =      -0.900688064997
              le_mean =     -17.215674923917
             les_mean =     296.680208078056
             stat err =       0.000411245629
             autocorr =       1.181101942759
   target nu stat err =       0.000411245629
   target dn stat err =       0.003004616080
      target stat err =       0.003844927175
              std dev =       0.535146391300
             le_variance =       0.286381660121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900688064997        initial
     8.8818e+08     8.8818e+09             1.8041e-13        -0.900688064998  <--
     3.5527e+09     3.5527e+10             4.5133e-14        -0.900688064997
     1.4211e+10     1.4211e+11             1.1255e-14        -0.900688064997

*****************************************************************************
Applying the update for shift_i =   8.8818e+08     and shift_s =   8.8818e+09
*****************************************************************************

  Execution time = 2.2938e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -3.960611e-02 3 1  ON 0
ci_002                -2.983640e-02 3 1  ON 1
ci_003                -2.463845e-02 3 1  ON 2
ci_004                 2.204220e-02 3 1  ON 3
ci_005                 2.234495e-02 3 1  ON 4
ci_006                -1.927448e-02 3 1  ON 5
ci_007                -1.923949e-02 3 1  ON 6
ci_008                -8.641487e-03 3 1  ON 7
ci_009                -1.450794e-02 3 1  ON 8
ci_010                -9.762565e-03 3 1  ON 9
ci_011                -1.004485e-02 3 1  ON 10
ci_012                -1.010385e-02 3 1  ON 11
ci_013                -1.981192e-02 3 1  ON 12
ci_014                 1.160636e-02 3 1  ON 13
ci_015                 1.183912e-02 3 1  ON 14
ci_016                 1.621380e-02 3 1  ON 15
ci_017                 1.615620e-02 3 1  ON 16
ci_018                 9.705369e-03 3 1  ON 17
ci_019                 9.840475e-03 3 1  ON 18
ci_020                 1.546261e-02 3 1  ON 19
ci_021                 1.554103e-02 3 1  ON 20
ci_022                 8.866238e-03 3 1  ON 21
ci_023                 8.760546e-03 3 1  ON 22
ci_024                 9.275257e-03 3 1  ON 23
ci_025                 9.214282e-03 3 1  ON 24
ci_026                 1.038045e-02 3 1  ON 25
ci_027                 1.063350e-02 3 1  ON 26
ci_028                -1.486231e-02 3 1  ON 27
ci_029                -1.534298e-02 3 1  ON 28
ci_030                -8.848744e-03 3 1  ON 29
ci_031                -8.993372e-03 3 1  ON 30
ci_032                -1.465259e-02 3 1  ON 31
ci_033                 5.876443e-03 3 1  ON 32
ci_034                 5.549831e-03 3 1  ON 33
ci_035                -3.910388e-03 3 1  ON 34
ci_036                -1.188652e-02 3 1  ON 35
ci_037                -1.205139e-02 3 1  ON 36
ci_038                 1.499326e-03 3 1  ON 37
ci_039                 1.650023e-03 3 1  ON 38
ci_040                -2.180574e-03 3 1  ON 39
ci_041                 8.249900e-03 3 1  ON 40
ci_042                 8.241176e-03 3 1  ON 41
ci_043                -2.889226e-03 3 1  ON 42
ci_044                -4.658528e-03 3 1  ON 43
ci_045                -2.410065e-03 3 1  ON 44
ci_046                 5.180992e-03 3 1  ON 45
ci_047                 5.206009e-03 3 1  ON 46
ci_048                -1.257811e-02 3 1  ON 47
ci_049                -1.271783e-02 3 1  ON 48
ci_050                 3.382968e-03 3 1  ON 49
ci_051                 3.294914e-03 3 1  ON 50
ci_052                -2.679083e-03 3 1  ON 51
ci_053                -2.719866e-03 3 1  ON 52
ci_054                -2.708108e-03 3 1  ON 53
ci_055                -2.967630e-03 3 1  ON 54
ci_056                 4.916254e-03 3 1  ON 55
ci_057                 5.079499e-03 3 1  ON 56
ci_058                -2.340247e-03 3 1  ON 57
ci_059                -2.340940e-03 3 1  ON 58
ci_060                 5.119246e-03 3 1  ON 59
ci_061                 5.674985e-03 3 1  ON 60
ci_062                -3.386363e-03 3 1  ON 61
ci_063                -3.371600e-03 3 1  ON 62
ci_064                -2.591704e-03 3 1  ON 63
ci_065                -3.638492e-03 3 1  ON 64
ci_066                 4.238107e-03 3 1  ON 65
ci_067                 4.361333e-03 3 1  ON 66
ci_068                -4.760587e-03 3 1  ON 67
ci_069                -4.494738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9529e+01 secs
  Total Execution time = 3.9648e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
